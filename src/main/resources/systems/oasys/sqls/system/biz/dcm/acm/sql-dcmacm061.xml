<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="dcm/acm/061">
	<select id="DCMACM061QMainSelect" parameterClass="paramMap" resultClass="resultMap">
		<include refid = "include.pageSelct"/>
		<![CDATA[
			SELECT 	T1.RWD_NO
					,T1.RWD_DT
					,T1.RWD_SER_CD
					,T1.RWD_SER_DTL_CD
					,F_CODE_NM('1000822',T1.RWD_SER_DTL_CD) AS RWD_SER_DTL_NM
					,T1.RWD_TG_CD
					,F_CODE_NM('1000823',T1.RWD_TG_CD) AS RWD_TG_NM
					,(	SELECT	F_DPT_INFO(MIN(S1.RWD_TG_DPT_CD) ,'1')
                                || CASE WHEN COUNT(S1.RWD_TG_DPT_CD) > 1 THEN ' 외 '|| (COUNT(1)-1)
                                ELSE ''
                                END
						FROM	TBDCMACM043D S1
						WHERE	S1.RWD_NO = T1.RWD_NO
					) AS RWD_TG_DPT_CD
                    ,(	SELECT	F_USR_INFO(MIN(S1.RWD_TG_STF_CNB) ,'2')
                                || CASE WHEN COUNT(S1.RWD_TG_STF_CNB) > 1 THEN ' 외 '|| (COUNT(1)-1)
                                ELSE ''
                                END
						FROM	TBDCMACM043D S1
						WHERE	S1.RWD_NO = T1.RWD_NO
					) AS RWD_TG_STF_CNB
			FROM  	TBDCMACM042M T1
			WHERE 	1=1
		]]>
		<isNotEmpty property="strRWD_DTS">
			<![CDATA[
				AND	RWD_DT >= #strRWD_DTS#
			]]>
		</isNotEmpty>
		<isNotEmpty property="strRWD_DTE">
			<![CDATA[
				AND	RWD_DT <= #strRWD_DTE#
			]]>
		</isNotEmpty>
		
		<isNotEmpty property="strRWD_SER_CD">
			<![CDATA[
				AND	RWD_SER_CD = #strRWD_SER_CD#
			]]>
		</isNotEmpty>
		
		<isNotEmpty property="strRWD_SER_DTL_CD">
			<![CDATA[
				AND	RWD_SER_DTL_CD = #strRWD_SER_DTL_CD#
			]]>
		</isNotEmpty>
		
		<isNotEmpty property="strRWD_TG_DPT_CD">
			<![CDATA[
				AND	RWD_NO IN	(
									SELECT	RWD_NO
									FROM	TBDCMACM043D S1
									WHERE	S1.RWD_TG_DPT_CD = #strRWD_TG_DPT_CD#
								)
			]]>
		</isNotEmpty>
		
		<isNotEmpty property="strRWD_TG_STF_CNB">
			<![CDATA[
				AND	RWD_NO IN	(
									SELECT	RWD_NO
									FROM	TBDCMACM043D S1
									WHERE	S1.RWD_TG_STF_CNB = #strRWD_TG_STF_CNB#
								)
			]]>
		</isNotEmpty>
		
		<include refid = "include.pageOrder"/> 
	</select>
	
	
</sqlMap> 