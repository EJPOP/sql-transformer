<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/iit/045">
	
	<select id="CSPIIT045PMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<include refid = "include.pageSelct"/> 
        <![CDATA[
			SELECT 	A.SW_SRNO,
					A.SW_MNG_CD,
					A.PC_SRNO,
			 		A.SW_NM,
			 		A.CNB,
			 		(	SELECT CD_NM 
                		FROM    TBDCMACM013C S1
               			WHERE   S1.CMM_CD_DVSN_CD ='1000144'
                		AND     S1.CD <> '000000000'
                		AND     S1.CD = A.DPT_CD
                	) AS DPT_NM,
                	(	SELECT S1.USR_NAM
			 			FROM	TBDCMACM001M S1
			 			WHERE	S1.CNB = A.CNB
			 		) AS USR_NAM,
			 		(	SELECT CD_NM 
                		FROM    TBDCMACM013C S1
               			WHERE   S1.CMM_CD_DVSN_CD ='1000144'
                		AND     S1.CD <> '000000000'
                		AND     S1.CD = A.DPT_CD
                	) AS DPT_NM,
			 		A.ISL_DT,
			 		A.DPT_CD		/*부서코드*/
			FROM   	TBCSPIIT025M A	
			WHERE	1=1
			  AND	A.SW_MNG_CD = #strSW_MNG_CD#
        ]]>
        <include refid = "include.pageOrder"/> 
	</select>        
	
	
	<!-- PC장비관리 엑셀다운 -->
	<select id="CSPIIT045PExcelExportSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT 	A.SW_SRNO,
					A.SW_MNG_CD,
					A.PC_SRNO,
			 		A.SW_NM,
			 		A.CNB,
			 		(	SELECT CD_NM 
                		FROM    TBDCMACM013C S1
               			WHERE   S1.CMM_CD_DVSN_CD ='1000144'
                		AND     S1.CD <> '000000000'
                		AND     S1.CD = A.DPT_CD
                	) AS DPT_NM,
                	(	SELECT S1.USR_NAM
			 			FROM	TBDCMACM001M S1
			 			WHERE	S1.CNB = A.CNB
			 		) AS USR_NAM,
			 		A.ISL_DT,
			 		A.DPT_CD		/*부서코드*/
			FROM   	TBCSPIIT025M A	
			WHERE	1=1
			  AND	A.SW_MNG_CD = #strSW_MNG_CD#
		]]>
	</select>    
	
	<insert id="CSPIIT045PMainInsert" parameterClass="paramMap">
        <![CDATA[
			INSERT INTO TBCSPIIT025M       
			(
					SW_SRNO,	
					SW_MNG_CD,          /*소프트웨어 고유번호     */
					DPT_CD,              /*부서코드       */
					PC_SRNO,
					SW_NM,
					CNB,
					ISL_DT,
					FRT_USR_ID,
					FNL_USR_ID,
					FNL_DEAL_DPT_CD,
					FNL_MNU_ID,
					FRT_REGI_DH,
					FNL_MDF_DH
			) VALUES (
					(SELECT NVL(MAX(TO_NUMBER(SW_SRNO)),0)+1 FROM TBCSPIIT025M),
					#SW_MNG_CD#,                      
					#DPT_CD#, 
					#PC_SRNO#,
					#SW_NM#, 
					#CNB#, 
					#ISL_DT#, 
					#FRT_USR_ID#,
					#FNL_USR_ID#,
					#FNL_DEAL_DPT_CD#,
					#FNL_MNU_ID#,
					SYSDATE,
					SYSDATE
			)
        ]]>
	</insert>        
	<update id="CSPIIT045PMainUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPIIT025M  					/*소프트웨어 관리 대장 테이블*/
			SET		DPT_CD = #DPT_CD#, 				/*부서코드*/
					SW_NM = #SW_NM#,		
					PC_SRNO = #PC_SRNO#,			
					ITDC_DT = #ITDC_DT#,			
					CNB = #CNB#,
					FNL_USR_ID = #FNL_USR_ID#,
					FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#,
					FNL_MNU_ID = #FNL_MNU_ID#,
					FNL_MDF_DH = SYSDATE
			WHERE	SW_MNG_CD = #SW_MNG_CD#
			  AND   SW_SRNO = #SW_SRNO#	
		]]>
	</update>
	
	<delete id="CSPIIT045PMainDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE	FROM TBCSPIIT025M
			WHERE	SW_MNG_CD = #SW_MNG_CD#
			  AND   SW_SRNO = #SW_SRNO#	
		]]>
	</delete>

	
	<select id="CSPIIT045PKeySelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
        	SELECT	SW_MNG_CD
        	FROM	TBCSPIIT025M
        	WHERE	SW_MNG_CD = #SW_MNG_CD#
			  AND   SW_SRNO = #SW_SRNO#	
        ]]> 
	</select>
	
	<select id="ReportSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT 	A.SW_SRNO,
					A.SW_MNG_CD,
					A.PC_SRNO,
			 		A.SW_NM,
			 		A.CNB,
			 		(	SELECT CD_NM 
                		FROM    TBDCMACM013C S1
               			WHERE   S1.CMM_CD_DVSN_CD ='1000144'
                		AND     S1.CD <> '000000000'
                		AND     S1.CD = A.DPT_CD
                	) AS DPT_NM,
                	(	SELECT S1.USR_NAM
			 			FROM	TBDCMACM001M S1
			 			WHERE	S1.CNB = A.CNB
			 		) AS USR_NAM,
			 		A.ISL_DT,
			 		A.DPT_CD		/*부서코드*/
			FROM   	TBCSPIIT025M A	
			WHERE	1=1
			  AND	A.SW_MNG_CD = #strSW_MNG_CD#
		]]>
	</select>
</sqlMap> 
