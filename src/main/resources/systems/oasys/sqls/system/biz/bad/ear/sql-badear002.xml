<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="bad/ear/002">

	<!--공개문 생성 치환기호조회 -->
	<select id="BADEAR002EMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
		 select D1.PSN_INF_HNDL_SYM_NO,
		        D1.PSN_INF_HNDL_SYM_TXT,
		        D1.REGI_DT,
		        (select COUNT(PSN_INF_HNDL_SYM_TXT) from TBBADEAR010L) AS CNT
		   from TBBADEAR010L D1
		  where 1=1
		]]>
	</select>
	
	<!--파일업로드 insert-->
	<insert id="BADEAR002PFileUploadInsert" parameterClass="paramMap">
		<![CDATA[  
			INSERT
			  INTO TBBADDED021M( 
			       AUD_YR
			     , AUD_NO
			     , DOC_ID
			     , DOC_TYP_CD
			     , CSD_CHG_ID
			     , CSD_CHG_CMPT_YN
			     , FRT_USR_ID
			     , FNL_USR_ID
			     , FNL_DEAL_DPT_CD
			     , FNL_MNU_ID
			     , FRT_REGI_DH
			     , FNL_MDF_DH  
			)
			VALUES( #AUD_YR#
			     , #AUD_NO#
			     , #DOC_ID#
			     , #DOC_TYP_CD#
			     , #CSD_CHG_ID#
			     , #CSD_CHG_CMPT_YN#
			     , #FRT_USR_ID#
			     , #FNL_USR_ID#
			     , #FNL_DEAL_DPT_CD#
			     , #FNL_MNU_ID#
			     , SYSDATE
			     , SYSDATE 
			) 	
		]]>
	</insert>
	
	<!--파일업로드 update-->
	<update id="BADEAR002PFileUploadUpdate" parameterClass="paramMap">
		<![CDATA[ 	
			UPDATE TBBADDED021M
			   SET AUD_YR        = #AUD_YR# 
			     , AUD_NO        = #AUD_NO# 		
			     , DOC_ID        = #DOC_ID#
		]]>	 
		<isNotEmpty property="DOC_TYP_CD">	 	
			     , DOC_TYP_CD      = #DOC_TYP_CD#
		</isNotEmpty>		
		<isNotEmpty property="CSD_CHG_ID">	 	
			     , CSD_CHG_ID      = #CSD_CHG_ID#
			     , CSD_CHG_CMPT_YN = #CSD_CHG_CMPT_YN#  /*변환요청이 다시 일어나면 null로 업데이트 되어야 한다. */ 
		</isNotEmpty>				     
		<isNotNull  property="FNL_USR_ID">	       
			     , FNL_USR_ID      = #FNL_USR_ID#
		</isNotNull>	
		<isNotNull  property="FNL_DEAL_DPT_CD">	       
			     , FNL_DEAL_DPT_CD  = #FNL_DEAL_DPT_CD#
		</isNotNull>		
		<isNotNull  property="FNL_MNU_ID">	       
			     , FNL_MNU_ID        = #FNL_MNU_ID#
		</isNotNull>
		<![CDATA[ 	
				 , FNL_MDF_DH        = SYSDATE			
			  WHERE 1=1
			    AND AUD_YR = #AUD_YR# 
			    AND AUD_NO = #AUD_NO# 	
			    AND DOC_ID = #DOC_ID#
		]]>			    					        
	</update>	

	<!--파일업로드 delete-->
	<update id="BADEAR002PFileUploadDelete" parameterClass="paramMap">
		   DELETE 
			 FROM TBBADDED021M
			WHERE 1=1
			  AND AUD_YR = #AUD_YR# 
			  AND AUD_NO = #AUD_NO# 		
			  AND DOC_ID = #DOC_ID#
	</update>



	<select id="BADEAR002PFileInfoSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[      
			SELECT AUD_YR
			     , AUD_NO
			     , DOC_ID
			     , DOC_TYP_CD
			     , CSD_CHG_ID
			     , CSD_CHG_CMPT_YN
			  FROM TBBADDED021M
			 WHERE 1=1
		]]>
		<isNotNull  property="AUD_YR">	
			   AND AUD_YR     = #AUD_YR#
		</isNotNull>
		<isNotNull  property="AUD_NO">
			   AND AUD_NO     = #AUD_NO#
		</isNotNull>
		<isNotNull  property="DOC_ID">			   
			   AND DOC_ID     = #DOC_ID#
		</isNotNull>
		<isNotNull  property="DOC_TYP_CD">	   
			   AND DOC_TYP_CD = #DOC_TYP_CD#
		</isNotNull>
		<isNotNull  property="CSD_CHG_ID">	   
			   AND CSD_CHG_ID = #CSD_CHG_ID#
		</isNotNull>	   
	</select>		   

	
</sqlMap> 
