<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/hpm/003">
	
	<!--칭찬합시다 정보를 조회한다.-->
	<select id="CSPHPM003Qmainselect" parameterClass="paramMap" 	resultClass="resultMap">
		<include refid = "include.pageSelct"/><!-- 페이징 -->
        <![CDATA[
			SELECT
				a.NTT_ID, a.NTT_SJ, a.FRST_REGISTER_ID, NVL(b.USR_NAM, a.NTCR_NM) AS FRST_REGISTER_NM,
				TO_CHAR(a.FRST_REGIST_PNTTM, 'YYYY-MM-DD') AS FRST_REGIST_PNTTM,
				a.RDCNT,a.NTT_CN,a.CATEGORY, a.PARNTSCTT_NO, a.ANSWER_AT, a.ANSWER_LC, a.USE_AT, a.DOC_ID  ,
				a.BBS_ID, RTRIM(a.NTCE_BGNDE) NTCE_BGNDE, RTRIM(a.NTCE_ENDDE) NTCE_ENDDE,  a.NTCR_NM
			FROM
				TBCSPTSM002L a
			LEFT OUTER JOIN 
				TBDCMACM001M b
			ON a.FRST_REGISTER_ID = b.USR_ID 
			WHERE BBS_ID='BBSMSTR_100000000053'
			AND a.USE_AT = 'Y' 
		]]>				
		<isEqual property="strSearchCd" compareValue="1"> <!-- 제목 -->
		 	AND a.NTT_SJ  LIKE '%' || #strSearchBox# || '%'	
		</isEqual>
		<isEqual property="strSearchCd" compareValue="2"> <!-- 내용 -->
			AND a.NTT_CN  LIKE '%' || #strSearchBox# || '%'	
		</isEqual> 
		<isEqual property="strSearchCd" compareValue="3"> <!-- 작성자 -->
			AND a.NTCR_NM  LIKE '%' || #strSearchBox# || '%'	
		</isEqual>
		
		 <isNotEmpty property="strYr" > <!-- 연도별 -->
				AND SUBSTR(a.FRST_REGIST_PNTTM,1,4) = #strYr#	
		</isNotEmpty>
		
		<isNotEmpty property="strFRST_REGIST_PNTTMS">  <!-- 시작 작성일 -->
			AND (TO_CHAR(a.FRST_REGIST_PNTTM,'YYYYMMDD') <![CDATA[ >= ]]> #strFRST_REGIST_PNTTMS# OR  a.FRST_REGIST_PNTTM IS NULL)
		</isNotEmpty>
		
		<isNotEmpty  property="strFRST_REGIST_PNTTME">   <!-- 종료 작성일 -->
			AND (TO_CHAR(a.FRST_REGIST_PNTTM,'YYYYMMDD') <![CDATA[ <= ]]> #strFRST_REGIST_PNTTME# OR a.FRST_REGIST_PNTTM IS NULL)
		</isNotEmpty>
		<include refid = "include.pageOrder"/> <!-- 페이징 -->
		
	</select>	
</sqlMap> 
