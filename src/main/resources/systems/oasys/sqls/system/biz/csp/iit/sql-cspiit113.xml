<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/iit/113">
	<select id="CSPIIT113QComboList" parameterClass="paramMap" resultClass="resultMap">
		SELECT  A.CD,
		        A.CD_NM
		FROM    TBDCMACM013C A,
		        TBDCMACM013C B
		WHERE   A.CMM_CD_DVSN_CD = #strSecMnu#
		AND     B.CMM_CD_DVSN_CD = #strFstMnu#
		AND     A.CD NOT IN ('000000000')
		AND     B.CD NOT IN ('000000000')
		AND     B.USE_YN = 'Y'
		AND     A.USE_YN = 'Y'
		AND     A.USR_DFN_TXT_2 = B.USR_DFN_TXT_1||B.CD 
		AND     B.USR_DFN_TXT_1 = 'LV1'
		<isNotEmpty property="strFST_MNU_DVSN_CD">
		AND		B.CD = #strFST_MNU_DVSN_CD#
		</isNotEmpty>
	</select>
	
	
	<select id="CSPIIT113QMainSelect" parameterClass="paramMap"	resultClass="resultMap">
<include refid = "include.pageSelct"/>
        <![CDATA[
			SELECT 	SUBSTR(F_CODE_NM('1000793',A.CSR_BRD_DVSN_CD),3,4) AS COPUT_BRD_DVSN_NM, 	/*게시판구분코드 */
			        F_CODE_NM('1000809',A.CSR_HNDL_WRK_DVSN_CD) AS WORK_DVSN_CD,      /*작업구분코드*/
			        A.CSR_RQS_DT AS RQS_DT,				/*요청일*/
			        F_DPT_INFO(A.CSR_RQS_DPT_CD,'4') AS RQS_DPT_NM,	/*요청자부서명*/
			        F_USR_INFO(A.CSR_RQR_CNB,'2') AS RQR_NAM,	/*요청자명*/
			        A.CSR_RQS_TIT AS RQS_TIT_NM,			/*요청제목*/
			        F_USR_INFO(A.CSR_HNDL_CHGR_CNB,'2') AS HNDL_PEN_NAM,	/*처리담당자명*/
			        A.CSR_SVC_BEGIN_DT AS HNDL_DT,				/*처리완료일자*/
			        A.CSR_MTRL_RQS_SNO AS MTRL_RQS_SNO,			/*자료요청순번*/
			        A.CSR_RQR_CNB AS RQR_CNB,				/*요청자전산번호*/
			        A.CSR_HNDL_CHGR_CNB AS HNDL_PEN_CNB,			/*처리자전산번호*/
			        A.CSR_RQS_DPT_CD AS RQS_DPT_CD,       	/*요청부서코드*/
			        F_CODE_NM('1000794',A.CSR_REL_TSK_DVSN_CD) AS DGE1_MNU_DVSN_NM,	/*관련업무구분코드*/
			        A.CSR_BRD_DVSN_CD AS COPUT_BRD_DVSN_CD,
			        F_CODE_NM('1000813',A.CSR_MNU_CD_1) AS MNU_CD_1, 
			        F_CODE_NM('1000814',A.CSR_MNU_CD_2) AS MNU_CD_2,
			        CASE WHEN A.CSR_HNDL_YR IS NOT NULL THEN A.CSR_HNDL_YR||'-'||A.CSR_HNDL_WRK_SNO ELSE '' END WORK_SRNO,
			        A.CSR_HNDL_YR AS WORK_YE,
			        A.CSR_HNDL_WRK_SNO AS WORK_SNO,
			        F_CODE_NM('1000333',NVL(A.CSR_APV_STA_CD,'1')) AS APV_STA_NM,  /*요청결재상태*/			        
			        A.CSR_APV_DOC_NO AS APV_DOC_NO,							/*요청결재문서번호*/
			        F_CODE_NM('1001005',A.CSR_PRSS_STA_CD) AS PRSS_STA_NM,  
			        A.CSR_STSFDG_OPRTN_YN AS STSFDG_OPRTN_YN,				/*만족도 설문여부*/
			        F_USR_INFO(A.CSR_RCEP_CNB,'2') AS RCEP_NM,				/*접수자명*/
			        A.CSR_ACP_DT AS RCEP_DT,								/*접수일자*/
			        F_CODE_NM('1001004',A.CSR_RQS_DVSN_CD) AS RQS_DVSN_NM,
			        F_CODE_NM('1001002',A.CSR_MNG_TSK_DVSN_CD) AS MNG_TSK_DVSN_NM,
			        F_CODE_NM('1001006',A.CSR_HNDL_DVSN_CD) AS HNDL_DVSN_NM,
			        F_DPT_INFO(A.CSR_HNDL_DPT_CD,'4') AS HNDL_DPT_NM,
			        A.CSR_HNDL_APT_DT AS HNDL_APT_DT,
			        F_CODE_NM('1000333',NVL(A.CSR_HNDL_APV_STA_CD,'1')) AS HNDL_APV_STA_NM,  /*처리결재상태*/
			        A.CSR_HNDL_APV_DOC_NO AS HNDL_APV_DOC_NO							/*처리결재문서번호*/
			FROM   	TBCSPIIT100M A					
			WHERE	A.CSR_BRD_DVSN_CD IN ('01','02') /*게시판구분코드 - 전산개선,자료요청*/
			AND     A.CSR_MNG_DVSN_CD = '04'         /*유지관리구분코드 - 사이버보안센터*/
			
        ]]>
        <dynamic>
        	<isNotEmpty property="strBRD_DVSN_CD">
        		AND	A.CSR_BRD_DVSN_CD = #strBRD_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strRQS_DVSN_CD">
        		AND	A.CSR_RQS_DVSN_CD = #strRQS_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strMNG_TSK_DVSN_CD">
        		AND	A.CSR_MNG_TSK_DVSN_CD = #strMNG_TSK_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strRQS_DTS">
        		AND	A.CSR_RQS_DT &gt;= #strRQS_DTS#
        	</isNotEmpty>
        	<isNotEmpty property="strRQS_DTE">
        		AND	A.CSR_RQS_DT &lt;= #strRQS_DTE#
        	</isNotEmpty>
        	<isNotEmpty property="strRCEP_DTS">
        		AND	A.CSR_ACP_DT &gt;= #strRCEP_DTS#
        	</isNotEmpty>
        	<isNotEmpty property="strRCEP_DTE">
        		AND	A.CSR_ACP_DT &lt;= #strRCEP_DTE#
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_DVSN_CD">
        		AND	A.CSR_HNDL_DVSN_CD = #strHNDL_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strWORK_DVSN_CD">
        		AND	A.CSR_HNDL_WRK_DVSN_CD = #strWORK_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strSTSFDG_OPRTN_YN">
        		AND	A.CSR_STSFDG_OPRTN_YN = #strSTSFDG_OPRTN_YN#
        	</isNotEmpty>
        	<isNotEmpty property="strSEARCH_NM">
        		AND	(F_DPT_INFO(A.CSR_RQS_DPT_CD,'1') LIKE '%'||#strSEARCH_NM#||'%'
        				OR F_DPT_INFO(A.CSR_ACP_DPT_CD,'1') LIKE '%'||#strSEARCH_NM#||'%'
        				OR F_DPT_INFO(A.CSR_HNDL_DPT_CD,'1') LIKE '%'||#strSEARCH_NM#||'%'
        				OR A.CSR_RQS_TIT LIKE '%'||#strSEARCH_NM#||'%'
        				OR A.CSR_RQS_TXT LIKE '%'||#strSEARCH_NM#||'%'
        				OR A.CSR_HNDL_TXT LIKE '%'||#strSEARCH_NM#||'%')
        	</isNotEmpty>
        	<isNotEmpty property="strRQR_NAM">
        		AND F_USR_INFO(A.CSR_RQR_CNB,'2') LIKE '%'||#strRQR_NAM#||'%'
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_PEN_NAM">
        		AND	F_USR_INFO(A.CSR_HNDL_CHGR_CNB,'2') LIKE '%'||#strHNDL_PEN_NAM#||'%'
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_DPT_NM">
        		AND	F_DPT_INFO(A.CSR_HNDL_DPT_CD,'1') LIKE '%'||#strHNDL_DPT_NM#||'%'
        	</isNotEmpty>
        	<isEqual property="strAUTH_CD" compareValue="DEPT">
        		AND	( A.CSR_RQS_OPEN_YN = 'Y' OR  A.CSR_RQR_CNB = #strCNB#)
        	</isEqual>
        	<isEqual property="strRESULT_CD" compareValue="1">
        		AND	A.CSR_SVC_BEGIN_DT IS NULL
        		AND A.CSR_PRSS_STA_CD > '01'
        	</isEqual>       	        	
        	<isNotEmpty property="strRESULT_CD">
        		<isNotEqual property="strRESULT_CD" compareValue="1">
        			AND A.CSR_PRSS_STA_CD = #strRESULT_CD#
        		</isNotEqual>
        	</isNotEmpty>        	
        	<isNotEmpty property="strMNU_CD_1">
        		AND A.CSR_MNU_CD_1 = #strMNU_CD_1#
        	</isNotEmpty>
        	<isNotEmpty property="strMNU_CD_2">
        		AND A.CSR_MNU_CD_2 = #strMNU_CD_2#
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_DTS">
        		AND	(A.CSR_SVC_BEGIN_DT &gt;= #strHNDL_DTS# OR A.CSR_SVC_BEGIN_DT IS NULL)
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_DTE">
        		AND	(A.CSR_SVC_BEGIN_DT &lt;= #strHNDL_DTE# OR A.CSR_SVC_BEGIN_DT IS NULL)
        	</isNotEmpty>
        </dynamic>
        <![CDATA[
        	ORDER BY A.CSR_HNDL_YR DESC, A.CSR_HNDL_WRK_SNO DESC, A.CSR_RQS_DT DESC, A.CSR_MTRL_RQS_SNO DESC 
        ]]>
        <include refid = "include.pageOrder"/>
	</select>     
	
	<resultMap class="java.util.HashMap" id="MainSelectMap">
     <result property="BRD_DVSN_CD"                column="BRD_DVSN_CD"                  jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="MTRL_RQS_SNO"               column="MTRL_RQS_SNO"                 jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="MNG_DVSN_CD"                column="MNG_DVSN_CD"                  jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="MNG_TSK_DVSN_CD"            column="MNG_TSK_DVSN_CD"              jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="DTS_TSK_DVSN_CD"            column="DTS_TSK_DVSN_CD"              jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RQS_DVSN_CD"                column="RQS_DVSN_CD"                  jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="PRSS_STA_CD"                column="PRSS_STA_CD"                  jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="PRSS_STA_NM"                column="PRSS_STA_NM"                  jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RQS_DT"                	   column="RQS_DT"  	                 jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RQR_CNB"                	   column="RQR_CNB"  	                 jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RQR_NAM"                	   column="RQR_NAM"  	                 jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="OPEN_YN"                	   column="OPEN_YN"  	                 jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RQS_TIT_NM"                 column="RQS_TIT_NM"                   jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RQS_TXT"                	   column="RQS_TXT"  	                 jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HNDL_DT"                	   column="HNDL_DT"  	                 jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HNDL_CHGR_CNB"              column="HNDL_CHGR_CNB"                jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HNDL_CHGR_NAM"              column="HNDL_CHGR_NAM"                jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HNDL_TXT"                   column="HNDL_TXT"  	                 jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RQS_DOC_ID"                 column="RQS_DOC_ID"  	             jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HNDL_DOC_ID"                column="HNDL_DOC_ID"  	             jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="PRPS_YE"                	   column="PRPS_YE"  	    	         jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="PRPS_SLN"                   column="PRPS_SLN"  	    	         jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RQS_DPT_NM"                 column="RQS_DPT_NM"      	         jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="DGE1_MNU_DVSN_CD"           column="DGE1_MNU_DVSN_CD"             jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="TNB"                 	   column="TNB"      	 		         jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="SEN_YN"                	   column="SEN_YN"  	    	         jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="OLD_HNDL_CHGR_CNB"          column="OLD_HNDL_CHGR_CNB"            jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="WORK_YE"                	   column="WORK_YE"  	    	         jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="WORK_SNO"                   column="WORK_SNO"  	    	         jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="WORK_DVSN_CD"               column="WORK_DVSN_CD"  	             jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="MNU_CD_1"                   column="MNU_CD_1"  	    	         jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="MNU_CD_2"                   column="MNU_CD_2"  	         	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="DIST_DT"                    column="DIST_DT"  	         	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="DIST_CHGR_CNB"              column="DIST_CHGR_CNB"          	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="DIST_CHGR_NAM"              column="DIST_CHGR_NAM"          	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="WORK_SRNO"              	   column="WORK_SRNO"    	      	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="WORK_TXT"              	   column="WORK_TXT"    	      	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HNDL_ORD_TXT"               column="HNDL_ORD_TXT"   	      	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RCEP_CNB"                   column="RCEP_CNB"  	 	      	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RCEP_NAM"                   column="RCEP_NAM"  	 	      	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="ACP_DT"                     column="ACP_DT"  	 	      	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RET_RSN_TXT"                column="RET_RSN_TXT"   	      	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HNDL_DVSN_CD"               column="HNDL_DVSN_CD"   	      	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="TSK_IPTC"     	           column="TSK_IPTC"   	    	  	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="TSK_DFFLY"     	           column="TSK_DFFLY"  	    	  	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="TSK_INFL"     	           column="TSK_INFL"  	    	  	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HNDL_APT_DT"    	           column="HNDL_APT_DT"  	   	  	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RQR_CFM_TXT"    	           column="RQR_CFM_TXT"  	   	  	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="DIST_DVSN_CD"               column="DIST_DVSN_CD"  	   	  	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="RM_TXT"               	   column="RM_TXT"  		   	  	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HWP_DOC"         		   column="HWP_DOC"        			  	 jdbcType="CLOB"           javaType="java.lang.String"/>                  
     <result property="HNDL_APV_DOC_NO"            column="HNDL_APV_DOC_NO"    	  	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="APV_DOC_NO"            	   column="APV_DOC_NO"    	  	     	 jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
     <result property="HNDL_APV_STA_NM"            column="HNDL_APV_STA_NM"    	  	     jdbcType="VARCHAR2"       javaType="java.lang.String"/>              
  </resultMap>
	
	
	<select id="CSPIIT114EMainSelect" parameterClass="paramMap"	resultMap="MainSelectMap">
        <![CDATA[
        	SELECT	A.CSR_BRD_DVSN_CD AS BRD_DVSN_CD, 										/*게시판구분 (개선,자료)*/
        			A.CSR_MTRL_RQS_SNO AS MTRL_RQS_SNO,		    							/*자료요청순번*/
        			A.CSR_MNG_DVSN_CD AS MNG_DVSN_CD,		    							/*유지관리구분코드*/
        			A.CSR_MNG_TSK_DVSN_CD AS MNG_TSK_DVSN_CD,								/*업무구분코드*/	
       				A.CSR_DTS_TSK_DVSN_CD AS DTS_TSK_DVSN_CD,								/*업무구분상세코드*/        			
        			A.CSR_RQS_DVSN_CD AS RQS_DVSN_CD, 										/*자료요청구분코드*/
        			A.CSR_PRSS_STA_CD AS PRSS_STA_CD,										/*진행상태코드*/
       				F_CODE_NM('1001005',A.CSR_PRSS_STA_CD) AS PRSS_STA_NM,					/*진행상태*/
        			A.CSR_RQS_DT AS RQS_DT,	                   								/*요청일*/ 
        			A.CSR_RQR_CNB AS RQR_CNB,		            							/*요청자전산번호*/
        			F_USR_INFO(A.CSR_RQR_CNB,'2') AS RQR_NAM,								/*요청자명*/
        			A.CSR_RQS_OPEN_YN AS OPEN_YN,											/*공개여부*/ 
        			A.CSR_RQS_TIT AS RQS_TIT_NM,											/*요청제목명*/
			 		A.CSR_RQS_TXT AS RQS_TXT, 												/*요청내용*/
			 		A.CSR_SVC_BEGIN_DT AS HNDL_DT,											/*완료일*/
			 		A.CSR_HNDL_CHGR_CNB AS HNDL_CHGR_CNB, 									/*처리자전산번호*/
			 		F_USR_INFO(A.CSR_HNDL_CHGR_CNB,'2') AS HNDL_CHGR_NAM,					/*처리자명*/
			 		A.CSR_HNDL_TXT AS HNDL_TXT, 											/*처리내용*/
			 		(SELECT DOC_ID FROM TBCSPIIT009M Z 										
			 		WHERE Z.MTRL_RQS_SNO = A.CSR_MTRL_RQS_SNO 
			 		AND Z.MTRL_RQS_ATT_FL_DVSN_CD = '3'										/*1(구)개선,2(구)자료,3개선,4자료*/
			 		AND	Z.COPUT_BRD_DVSN_CD = A.CSR_BRD_DVSN_CD) AS RQS_DOC_ID ,			/*요청첨부파일*/
			 		(SELECT DOC_ID FROM TBCSPIIT009M Z 
			 		WHERE Z.MTRL_RQS_SNO = A.CSR_MTRL_RQS_SNO 
			 		AND	Z.COPUT_BRD_DVSN_CD = A.CSR_BRD_DVSN_CD
			 		AND Z.MTRL_RQS_ATT_FL_DVSN_CD = '4') AS HNDL_DOC_ID ,					/*처리첨부파일*/
			 		A.CSR_PRPS_YR AS PRPS_YE,												/*제안연도*/
			 		A.CSR_PRPS_SLN AS PRPS_SLN,												/*제안번호*/
			 		F_DPT_INFO(A.CSR_RQS_DPT_CD,'1') AS RQS_DPT_NM,							/*요청자부서*/
			 		A.CSR_REL_TSK_DVSN_CD AS DGE1_MNU_DVSN_CD,								/*관련업무구분코드*/
			 		F_USR_INFO(A.CSR_RQR_CNB,'6') AS TNB,									/*내선번호*/
			 		NVL(A.CSR_HNDL_RESULT_SEN_YN,'N') AS SEN_YN,							/*요청결과메시지전송여부 */			 		
			 		A.CSR_HNDL_CHGR_CNB AS OLD_HNDL_CHGR_CNB,								
			 		A.CSR_HNDL_YR AS WORK_YE,												/*처리연도*/
			 		A.CSR_HNDL_WRK_SNO AS WORK_SNO,											/*처리순번*/
			 		A.CSR_HNDL_WRK_DVSN_CD AS WORK_DVSN_CD,									/*작업구분*/
			 		A.CSR_MNU_CD_1 AS MNU_CD_1,												/*1차메뉴*/
			 		A.CSR_MNU_CD_2 AS MNU_CD_2,												/*2차메뉴*/
			 		A.CSR_DIST_DT AS DIST_DT,												/*배포일*/
			 		A.CSR_DIST_CHGR_CNB AS DIST_CHGR_CNB,									/*배포자전산번호*/
			 		F_USR_INFO(A.CSR_DIST_CHGR_CNB,'2') AS DIST_CHGR_NAM,					/*배포자명*/
        			CASE WHEN A.CSR_HNDL_YR IS NOT NULL THEN A.CSR_HNDL_YR||'-'||A.CSR_HNDL_WRK_SNO ELSE '' END WORK_SRNO, /*작업번호*/
        			A.CSR_HNDL_WRK_DTL_TXT AS WORK_TXT,										/*작업세부내용*/	
        			A.CSR_HNDL_ORD_TXT AS HNDL_ORD_TXT,										/*처리지시내용*/	
        			A.CSR_RCEP_CNB AS RCEP_CNB,												/*접수자전산번호*/
        			F_USR_INFO(A.CSR_RCEP_CNB,'2') AS RCEP_NAM,								/*접수자명*/
        			A.CSR_ACP_DT AS ACP_DT,													/*접수일*/
        			A.CSR_RET_RSN_TXT AS RET_RSN_TXT,										/*보완필요사유*/
        			A.CSR_HNDL_DVSN_CD AS HNDL_DVSN_CD,										/*SR처리구분*/
        			A.CSR_TSK_IPTC AS TSK_IPTC,												/*업무중요도*/
        			A.CSR_TSK_DFFLY AS TSK_DFFLY,											/*업무난이도*/
        			A.CSR_TSK_INFL AS TSK_INFL,												/*업무영향도*/
        			A.CSR_HNDL_APT_DT AS HNDL_APT_DT,										/*처리예정일*/
        			A.CSR_RQR_CFM_TXT AS RQR_CFM_TXT,										/*요청확인내용*/
        			A.CSR_DIST_DVSN_CD AS DIST_DVSN_CD,										/*배포구분코드*/
        			A.CSR_RM_TXT AS RM_TXT,        											/*비고*/
        			A.CSR_HWP_DOC AS HWP_DOC,												/*별지서식*/
        			A.CSR_HNDL_APV_DOC_NO AS HNDL_APV_DOC_NO,								/*처리결재문서번호*/
        			A.CSR_APV_DOC_NO AS APV_DOC_NO,											/*요청결재문서번호*/
        			F_CODE_NM('1000333',NVL(A.CSR_HNDL_APV_STA_CD,'1')) AS HNDL_APV_STA_NM	/*요청처리결재상태*/
        	FROM	TBCSPIIT100M A
        	WHERE 	A.CSR_MTRL_RQS_SNO = #strMTRL_RQS_SNO#
        	AND		A.CSR_BRD_DVSN_CD = #strBRD_DVSN_CD# /*게시판구분코드 - 개선요청01, 자료요청02*/        	
		]]>
	</select>
	
	<update id="CSPIIT114EMainUpdate" parameterClass="paramMap">		
			UPDATE 	TBCSPIIT100M
			SET		CSR_MNG_DVSN_CD = #MNG_DVSN_CD#,		    							/*유지관리구분코드*/
					CSR_MNG_TSK_DVSN_CD = #MNG_TSK_DVSN_CD#,								/*업무구분코드*/
					CSR_DTS_TSK_DVSN_CD = #DTS_TSK_DVSN_CD#,								/*업무구분상세코드*/
					CSR_RQS_DVSN_CD = #RQS_DVSN_CD#, 										/*자료요청구분코드*/
					CSR_PRSS_STA_CD = #PRSS_STA_CD#,										/*진행상태코드*/
					CSR_RQS_DT = #RQS_DT#,	                   								/*요청일*/ 
					CSR_RQR_CNB = #RQR_CNB#,		            							/*요청자전산번호*/
					CSR_RQS_DPT_CD = F_USR_INFO(#RQR_CNB#,'5'),								/*요청자부서*/
					CSR_RQS_OPEN_YN = #OPEN_YN#,											/*공개여부*/ 									
					CSR_RQS_TIT = #RQS_TIT_NM#, 											/*요청제목명*/
					CSR_RQS_TXT = #RQS_TXT#, 												/*요청내용*/
					CSR_SVC_BEGIN_DT = #HNDL_DT#,											/*완료일*/
					CSR_HNDL_CHGR_CNB = #HNDL_CHGR_CNB#, 									/*처리자전산번호*/
					CSR_HNDL_DPT_CD = F_USR_INFO(#HNDL_CHGR_CNB#,'5'),						/*처리자부서*/
					CSR_HNDL_TXT = #HNDL_TXT#, 											    /*처리내용*/
					CSR_REL_TSK_DVSN_CD = #DGE1_MNU_DVSN_CD#,								/*관련업무구분코드*/
					CSR_HNDL_WRK_DVSN_CD = #WORK_DVSN_CD#,									/*작업구분*/
					CSR_MNU_CD_1 = #MNU_CD_1#,												/*1차메뉴*/
					CSR_MNU_CD_2 = #MNU_CD_2#,												/*2차메뉴*/
					CSR_DIST_DT = #DIST_DT#,												/*배포일*/
					CSR_DIST_CHGR_CNB = #DIST_CHGR_CNB#,									/*배포자전산번호*/
					CSR_DIST_DPT_CD = F_USR_INFO(#DIST_CHGR_CNB#,'5'),						/*배포자부서*/
					CSR_HNDL_WRK_DTL_TXT = #WORK_TXT#,										/*작업세부내용*/
					CSR_HNDL_ORD_TXT = #HNDL_ORD_TXT#,										/*처리지시내용*/
					CSR_RCEP_CNB = #RCEP_CNB#,												/*접수자전산번호*/
					CSR_ACP_DPT_CD = F_USR_INFO(#RCEP_CNB#,'5'),							/*접수자부서*/
					CSR_ACP_DT = #ACP_DT#,													/*접수일*/
					CSR_RET_RSN_TXT = #RET_RSN_TXT#,										/*보완필요사유*/
					CSR_HNDL_DVSN_CD = #HNDL_DVSN_CD#,										/*SR처리구분*/
					CSR_TSK_IPTC = #TSK_IPTC#,												/*업무중요도*/
					CSR_TSK_DFFLY = #TSK_DFFLY#,											/*업무난이도*/
					CSR_TSK_INFL = #TSK_INFL#,												/*업무영향도*/
					CSR_HNDL_APT_DT = #HNDL_APT_DT#,										/*처리예정일*/
					CSR_RQR_CFM_TXT = #RQR_CFM_TXT#,										/*요청확인내용*/
					CSR_DIST_DVSN_CD = #DIST_DVSN_CD#,										/*배포구분코드*/
					CSR_RM_TXT = #RM_TXT#,        											/*비고*/
					CSR_HWP_DOC = #HWP_DOC#,        										/*별지서식*/
					FNL_USR_ID = #FNL_USR_ID#,
					FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#,
					FNL_MNU_ID = #FNL_MNU_ID#,
					FNL_MDF_DH = SYSDATE					
			WHERE	CSR_MTRL_RQS_SNO = #MTRL_RQS_SNO#
			AND		CSR_BRD_DVSN_CD = #BRD_DVSN_CD#	/*게시판구분코드 - 전산개선요청*/		
	</update>
	
	<delete id="CSPIIT004EMainDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE	
			FROM	TBCSPIIT100M
			WHERE	CSR_MTRL_RQS_SNO = #MTRL_RQS_SNO#
			AND		CSR_BRD_DVSN_CD = #BRD_DVSN_CD#	/*게시판구분코드 - 전산개선요청*/
		]]>
	</delete>
	
	<insert id="CSPIIT114ERqsFileInsert" parameterClass="paramMap">
        <![CDATA[
        	INSERT INTO TBCSPIIT009M
        	(
        			COPUT_BRD_DVSN_CD,	/*게시판구분코드 - 전산개선요청*/
        			MTRL_RQS_SNO,			/*자료요청순번*/
        			MTRL_RQS_ATT_FL_DVSN_CD,		/*자료요청첨부파일구분코드*/
        			DOC_ID,			/*요청일*/
        			FRT_USR_ID,
        			FNL_USR_ID,
        			FNL_DEAL_DPT_CD,
        			FNL_MNU_ID,
        			FRT_REGI_DH,
        			FNL_MDF_DH
        	) VALUES (
        			#BRD_DVSN_CD#,
	        		#MTRL_RQS_SNO#,
	        		'3',
	        		#RQS_DOC_ID#,
	        		#FRT_USR_ID#,
	        		#FNL_USR_ID#,
	        		#FNL_DEAL_DPT_CD#,
	        		#FNL_MNU_ID#,
	        		SYSDATE,
	        		SYSDATE
        	)
        ]]>
	</insert>
	
	<insert id="CSPIIT114EHndlFileInsert" parameterClass="paramMap">
        <![CDATA[
        	INSERT INTO TBCSPIIT009M
        	(	
        			COPUT_BRD_DVSN_CD,	/*게시판구분코드 - 전산개선요청*/
        			MTRL_RQS_SNO,			/*자료요청순번*/
        			MTRL_RQS_ATT_FL_DVSN_CD,		/*자료요청첨부파일구분코드*/
        			DOC_ID,			/*요청일*/
        			FRT_USR_ID,
        			FNL_USR_ID,
        			FNL_DEAL_DPT_CD,
        			FNL_MNU_ID,
        			FRT_REGI_DH,
        			FNL_MDF_DH
        	) VALUES (
        			#BRD_DVSN_CD#,
	        		#MTRL_RQS_SNO#,
	        		'4',
	        		#HNDL_DOC_ID#,
	        		#FRT_USR_ID#,
	        		#FNL_USR_ID#,
	        		#FNL_DEAL_DPT_CD#,
	        		#FNL_MNU_ID#,
	        		SYSDATE,
	        		SYSDATE
        	)
        ]]>
	</insert>
	
	<delete id="CSPIIT004EFileDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE	
			FROM	TBCSPIIT009M
			WHERE	MTRL_RQS_SNO = #MTRL_RQS_SNO#
			AND		COPUT_BRD_DVSN_CD = #BRD_DVSN_CD#	/*게시판구분코드 - 전산개선요청*/
		]]>
	</delete>
	
	<!-- 전산개선 및 자료요청 엑셀다운로드 -->
	<select id="CSPIIT113QExcelExportSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
        SELECT 	F_CODE_NM('1000793',A.CSR_BRD_DVSN_CD) AS COPUT_BRD_DVSN_NM, 	/*게시판구분코드 */
			        F_CODE_NM('1000809',A.CSR_HNDL_WRK_DVSN_CD) AS WORK_DVSN_CD,      /*작업구분코드*/
			        A.CSR_RQS_DT AS RQS_DT,				/*요청일*/
			        F_DPT_INFO(A.CSR_RQS_DPT_CD,'4') AS RQS_DPT_NM,	/*요청자부서명*/
			        F_USR_INFO(A.CSR_RQR_CNB,'2') AS RQR_NAM,	/*요청자명*/
			        A.CSR_RQS_TIT AS RQS_TIT_NM,			/*요청제목*/
			        F_USR_INFO(A.CSR_HNDL_CHGR_CNB,'2') AS HNDL_PEN_NAM,	/*처리담당자명*/
			        A.CSR_SVC_BEGIN_DT AS HNDL_DT,				/*처리완료일자*/
			        A.CSR_MTRL_RQS_SNO AS MTRL_RQS_SNO,			/*자료요청순번*/
			        A.CSR_RQR_CNB AS RQR_CNB,				/*요청자전산번호*/
			        A.CSR_HNDL_CHGR_CNB AS HNDL_PEN_CNB,			/*처리자전산번호*/
			        A.CSR_RQS_DPT_CD AS RQS_DPT_CD,       	/*요청부서코드*/
			        F_CODE_NM('1000794',A.CSR_REL_TSK_DVSN_CD) AS DGE1_MNU_DVSN_NM,	/*관련업무구분코드*/
			        A.CSR_BRD_DVSN_CD AS COPUT_BRD_DVSN_CD,
			        F_CODE_NM('1000813',A.CSR_MNU_CD_1) AS MNU_CD_1, 
			        F_CODE_NM('1000814',A.CSR_MNU_CD_2) AS MNU_CD_2,
			        CASE WHEN A.CSR_HNDL_YR IS NOT NULL THEN A.CSR_HNDL_YR||'-'||A.CSR_HNDL_WRK_SNO ELSE '' END WORK_SRNO,
			        A.CSR_HNDL_YR AS WORK_YE,
			        A.CSR_HNDL_WRK_SNO AS WORK_SNO,
			        F_CODE_NM('1000333',NVL(A.CSR_APV_STA_CD,'1')) AS APV_STA_NM,
			        A.CSR_STSFDG_OPRTN_YN AS STSFDG_OPRTN_YN,				/*만족도 설문여부*/
			        F_CODE_NM('1001005',A.CSR_PRSS_STA_CD) AS PRSS_STA_NM,  
			        F_USR_INFO(A.CSR_RCEP_CNB,'2') AS RCEP_NM,				/*접수자명*/
			        A.CSR_ACP_DT AS RCEP_DT,								/*접수일자*/
			        F_CODE_NM('1001004',A.CSR_RQS_DVSN_CD) AS RQS_DVSN_NM,
			        F_CODE_NM('1001002',A.CSR_MNG_TSK_DVSN_CD) AS MNG_TSK_DVSN_NM,
			        F_CODE_NM('1001006',A.CSR_HNDL_DVSN_CD) AS HNDL_DVSN_NM,
			        F_DPT_INFO(A.CSR_HNDL_DPT_CD,'4') AS HNDL_DPT_NM,
			        A.CSR_HNDL_APT_DT AS HNDL_APT_DT,
			        F_CODE_NM('1000333',NVL(A.CSR_HNDL_APV_STA_CD,'1')) AS HNDL_APV_STA_NM,  /*처리결재상태*/
			        A.CSR_HNDL_APV_DOC_NO AS HNDL_APV_DOC_NO							/*처리결재문서번호*/
			FROM   	TBCSPIIT100M A					
			WHERE	A.CSR_BRD_DVSN_CD IN ('01','02') /*게시판구분코드 - 전산개선,자료요청*/
			AND     A.CSR_MNG_DVSN_CD = '04'         /*유지관리구분코드 - 사이버보안요청*/			
        ]]>
        <dynamic>
        	<isNotEmpty property="strBRD_DVSN_CD">
        		AND	A.CSR_BRD_DVSN_CD = #strBRD_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strRQS_DVSN_CD">
        		AND	A.CSR_RQS_DVSN_CD = #strRQS_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strMNG_TSK_DVSN_CD">
        		AND	A.CSR_MNG_TSK_DVSN_CD = #strMNG_TSK_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strRQS_DTS">
        		AND	A.CSR_RQS_DT &gt;= #strRQS_DTS#
        	</isNotEmpty>
        	<isNotEmpty property="strRQS_DTE">
        		AND	A.CSR_RQS_DT &lt;= #strRQS_DTE#
        	</isNotEmpty>
        	<isNotEmpty property="strRCEP_DTS">
        		AND	A.CSR_ACP_DT &gt;= #strRCEP_DTS#
        	</isNotEmpty>
        	<isNotEmpty property="strRCEP_DTE">
        		AND	A.CSR_ACP_DT &lt;= #strRCEP_DTE#
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_DVSN_CD">
        		AND	A.CSR_HNDL_DVSN_CD = #strHNDL_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strWORK_DVSN_CD">
        		AND	A.CSR_HNDL_WRK_DVSN_CD = #strWORK_DVSN_CD#
        	</isNotEmpty>
        	<isNotEmpty property="strSTSFDG_OPRTN_YN">
        		AND	A.CSR_STSFDG_OPRTN_YN = #strSTSFDG_OPRTN_YN#
        	</isNotEmpty>
        	<isNotEmpty property="strSEARCH_NM">
        		AND	(F_DPT_INFO(A.CSR_RQS_DPT_CD,'1') LIKE '%'||#strSEARCH_NM#||'%'
        				OR F_DPT_INFO(A.CSR_ACP_DPT_CD,'1') LIKE '%'||#strSEARCH_NM#||'%'
        				OR F_DPT_INFO(A.CSR_HNDL_DPT_CD,'1') LIKE '%'||#strSEARCH_NM#||'%'
        				OR A.CSR_RQS_TIT LIKE '%'||#strSEARCH_NM#||'%'
        				OR A.CSR_RQS_TXT LIKE '%'||#strSEARCH_NM#||'%'
        				OR A.CSR_HNDL_TXT LIKE '%'||#strSEARCH_NM#||'%')
        	</isNotEmpty>
        	<isNotEmpty property="strRQR_NAM">
        		AND F_USR_INFO(A.CSR_RQR_CNB,'2') LIKE '%'||#strRQR_NAM#||'%'
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_PEN_NAM">
        		AND	F_USR_INFO(A.CSR_HNDL_CHGR_CNB,'2') LIKE '%'||#strHNDL_PEN_NAM#||'%'
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_DPT_NM">
        		AND	F_DPT_INFO(A.CSR_HNDL_DPT_CD,'1') LIKE '%'||#strHNDL_DPT_NM#||'%'
        	</isNotEmpty>
        	<isEqual property="strAUTH_CD" compareValue="DEPT">
        		AND	( A.CSR_RQS_OPEN_YN = 'Y' OR  A.CSR_RQR_CNB = #strCNB#)
        	</isEqual>
        	<isEqual property="strRESULT_CD" compareValue="1">
        		AND	A.CSR_SVC_BEGIN_DT IS NULL
        		AND A.CSR_PRSS_STA_CD > '01'
        	</isEqual>       	        	
        	<isNotEmpty property="strRESULT_CD">
        		<isNotEqual property="strRESULT_CD" compareValue="1">
        			AND A.CSR_PRSS_STA_CD = #strRESULT_CD#
        		</isNotEqual>
        	</isNotEmpty>        	
        	<isNotEmpty property="strMNU_CD_1">
        		AND A.CSR_MNU_CD_1 = #strMNU_CD_1#
        	</isNotEmpty>
        	<isNotEmpty property="strMNU_CD_2">
        		AND A.CSR_MNU_CD_2 = #strMNU_CD_2#
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_DTS">
        		AND	(A.CSR_SVC_BEGIN_DT &gt;= #strHNDL_DTS# OR A.CSR_SVC_BEGIN_DT IS NULL)
        	</isNotEmpty>
        	<isNotEmpty property="strHNDL_DTE">
        		AND	(A.CSR_SVC_BEGIN_DT &lt;= #strHNDL_DTE# OR A.CSR_SVC_BEGIN_DT IS NULL)
        	</isNotEmpty>
        </dynamic>
        <![CDATA[
        	ORDER BY A.CSR_HNDL_YR DESC, A.CSR_HNDL_WRK_SNO DESC
        ]]>
	</select>
	
	<select id="CSPIIT115PMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
        	SELECT	A.CSR_BRD_DVSN_CD AS BRD_DVSN_CD, 										/*게시판구분 (개선,자료)*/
        			F_CODE_NM('1000793',A.CSR_BRD_DVSN_CD) AS BRD_DVSN_NM, 					/*게시판구분 (개선,자료)*/
        			A.CSR_MTRL_RQS_SNO AS MTRL_RQS_SNO,		    							/*자료요청순번*/
        			A.CSR_MNG_DVSN_CD AS MNG_DVSN_CD,		    							/*유지관리구분코드*/
        			A.CSR_MNG_TSK_DVSN_CD AS MNG_TSK_DVSN_CD,								/*업무구분코드*/	
       				A.CSR_DTS_TSK_DVSN_CD AS DTS_TSK_DVSN_CD,								/*업무구분상세코드*/        			
        			A.CSR_RQS_DVSN_CD AS RQS_DVSN_CD, 										/*자료요청구분코드*/
        			A.CSR_PRSS_STA_CD AS PRSS_STA_CD,										/*진행상태코드*/
       				F_CODE_NM('1001005',A.CSR_PRSS_STA_CD) AS PRSS_STA_NM,					/*진행상태*/
        			TO_CHAR(TO_DATE(A.CSR_RQS_DT),'YYYY-MM-DD') AS RQS_DT,	       			/*요청일*/ 
        			A.CSR_RQR_CNB AS RQR_CNB,		            							/*요청자전산번호*/
        			F_DPT_INFO(A.CSR_RQS_DPT_CD,'1')||' '||F_USR_INFO(A.CSR_RQR_CNB,'2') AS RQR_NAM,								/*요청자명*/
        			A.CSR_RQS_OPEN_YN AS OPEN_YN,											/*공개여부*/ 
        			A.CSR_RQS_TIT AS RQS_TIT_NM,											/*요청제목명*/
			 		A.CSR_RQS_TXT AS RQS_TXT, 												/*요청내용*/
			 		TO_CHAR(TO_DATE(A.CSR_SVC_BEGIN_DT),'YYYY-MM-DD') AS HNDL_DT,											/*완료일*/
			 		A.CSR_HNDL_CHGR_CNB AS HNDL_CHGR_CNB, 									/*처리자전산번호*/
			 		F_DPT_INFO(A.CSR_HNDL_DPT_CD,'1')||' '||F_USR_INFO(A.CSR_HNDL_CHGR_CNB,'2') AS HNDL_CHGR_NAM,					/*처리자명*/
			 		A.CSR_HNDL_TXT AS HNDL_TXT, 											/*처리내용*/
			 		(SELECT DOC_ID FROM TBCSPIIT009M Z 										
			 		WHERE Z.MTRL_RQS_SNO = A.CSR_MTRL_RQS_SNO 
			 		AND Z.MTRL_RQS_ATT_FL_DVSN_CD = '3'										/*1(구)개선,2(구)자료,3개선,4자료*/
			 		AND	Z.COPUT_BRD_DVSN_CD = A.CSR_BRD_DVSN_CD) AS RQS_DOC_ID ,			/*요청첨부파일*/
			 		(SELECT DOC_ID FROM TBCSPIIT009M Z 
			 		WHERE Z.MTRL_RQS_SNO = A.CSR_MTRL_RQS_SNO 
			 		AND	Z.COPUT_BRD_DVSN_CD = A.CSR_BRD_DVSN_CD
			 		AND Z.MTRL_RQS_ATT_FL_DVSN_CD = '4') AS HNDL_DOC_ID ,					/*처리첨부파일*/
			 		A.CSR_PRPS_YR AS PRPS_YE,												/*제안연도*/
			 		A.CSR_PRPS_SLN AS PRPS_SLN,												/*제안번호*/
			 		F_DPT_INFO(A.CSR_RQS_DPT_CD,'1') AS RQS_DPT_NM,							/*요청자부서*/
			 		F_CODE_NM('1000794',A.CSR_REL_TSK_DVSN_CD) AS DGE1_MNU_DVSN_CD,			/*관련업무구분코드*/
			 		F_USR_INFO(A.CSR_RQR_CNB,'6') AS TNB,									/*내선번호*/
			 		NVL(A.CSR_HNDL_RESULT_SEN_YN,'N') AS SEN_YN,							/*요청결과메시지전송여부 */			 		
			 		A.CSR_HNDL_CHGR_CNB AS OLD_HNDL_CHGR_CNB,								
			 		A.CSR_HNDL_YR AS WORK_YE,												/*처리연도*/
			 		A.CSR_HNDL_WRK_SNO AS WORK_SNO,											/*처리순번*/
			 		F_CODE_NM('1000809',A.CSR_HNDL_WRK_DVSN_CD) AS WORK_DVSN_CD,									/*작업구분*/
			 		A.CSR_MNU_CD_1 AS MNU_CD_1,												/*1차메뉴*/
			 		A.CSR_MNU_CD_2 AS MNU_CD_2,												/*2차메뉴*/
			 		TO_CHAR(TO_DATE(A.CSR_DIST_DT),'YYYY-MM-DD') AS DIST_DT,												/*배포일*/
			 		A.CSR_DIST_CHGR_CNB AS DIST_CHGR_CNB,									/*배포자전산번호*/
			 		F_DPT_INFO(A.CSR_DIST_DPT_CD,'1')||' '||F_USR_INFO(A.CSR_DIST_CHGR_CNB,'2') AS DIST_CHGR_NAM,					/*배포자명*/
        			CASE WHEN A.CSR_HNDL_YR IS NOT NULL THEN A.CSR_HNDL_YR||'-'||A.CSR_HNDL_WRK_SNO ELSE '' END WORK_SRNO, /*작업번호*/
        			A.CSR_HNDL_WRK_DTL_TXT AS WORK_TXT,										/*작업세부내용*/	
        			A.CSR_HNDL_ORD_TXT AS HNDL_ORD_TXT,										/*처리지시내용*/	
        			A.CSR_RCEP_CNB AS RCEP_CNB,												/*접수자전산번호*/
        			F_DPT_INFO(A.CSR_ACP_DPT_CD,'1')||' '||F_USR_INFO(A.CSR_RCEP_CNB,'2') AS RCEP_NAM,								/*접수자명*/
        			TO_CHAR(TO_DATE(A.CSR_ACP_DT),'YYYY-MM-DD') AS ACP_DT,													/*접수일*/
        			A.CSR_RET_RSN_TXT AS RET_RSN_TXT,										/*보완필요사유*/
        			A.CSR_HNDL_DVSN_CD AS HNDL_DVSN_CD,										/*SR처리구분*/
        			A.CSR_TSK_IPTC AS TSK_IPTC,												/*업무중요도*/
        			A.CSR_TSK_DFFLY AS TSK_DFFLY,											/*업무난이도*/
        			A.CSR_TSK_INFL AS TSK_INFL,												/*업무영향도*/
        			TO_CHAR(TO_DATE(A.CSR_HNDL_APT_DT),'YYYY-MM-DD') AS HNDL_APT_DT,		/*처리예정일*/
        			A.CSR_RQR_CFM_TXT AS RQR_CFM_TXT,										/*요청확인내용*/
        			A.CSR_DIST_DVSN_CD AS DIST_DVSN_CD,										/*배포구분코드*/
        			A.CSR_RM_TXT AS RM_TXT,        											/*비고*/
        			A.CSR_HNDL_APV_DOC_NO AS HNDL_APV_DOC_NO								/*처리결재문서번호*/
        	FROM	TBCSPIIT100M A
        	WHERE 	1=1
        ]]>
        	<isNotEmpty property="strMTRL_RQS_SNO">
				AND 	A.CSR_MTRL_RQS_SNO = #strMTRL_RQS_SNO#
			</isNotEmpty>
			<isNotEmpty property="strBRD_DVSN_CD">
				AND		A.CSR_BRD_DVSN_CD = #strBRD_DVSN_CD# /*게시판구분코드 - 개선요청01, 자료요청02*/
			</isNotEmpty>
			<isNotEmpty property="strDOC_NO">
				AND 	A.CSR_HNDL_APV_DOC_NO = #strDOC_NO#
			</isNotEmpty>
	</select>
	
	
	<insert id="CSPIIT114EMsgInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO
			TBDCMACM026L
			(
			  MSG_SNO
			, TSK_CAT_CD
			, FUNC_CAT_CD
			, SEND_ID
	        , MSG_TP_YN
	  
	        , MSG_TXT_2
	        , RCNT_CNT
	        , RCNT_HIS
	        , MSG_REGI_DH
	
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			,
			FNL_MDF_DH
	
			)
			VALUES
			(
			  (SELECT NVL(MAX(MSG_SNO),0)+1 FROM TBDCMACM026L)
			, 'SP'
			, 'BO'
			, #FNL_USR_ID#
	        , '0'
	     
	        , #MSG_TXT#
	        , 1
	        , #RCNT_HIS#
	        , SYSDATE
	        
	        
			, #FNL_USR_ID#
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
			, SYSDATE
			, SYSDATE
	
			);
			
		]]>
	</insert>	
		
	<update id="CSPIIT114EMsgUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE 	TBCSPIIT100M
			SET		CSR_HNDL_RESULT_SEN_YN = 'Y'
			WHERE	CSR_MTRL_RQS_SNO = #MTRL_RQS_SNO#
			AND		CSR_BRD_DVSN_CD = #BRD_DVSN_CD#
		]]>
	</update>		
	
	<update id="CSPIIT114EHndlApvSave" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPIIT100M
			SET		CSR_HNDL_APV_STA_CD = #APV_STA_CD#
					,CSR_HNDL_APV_DOC_NO = #APV_DOC_NO#
			WHERE	CSR_BRD_DVSN_CD = #brdDvsnCd#
			AND		CSR_MTRL_RQS_SNO = #mtrlRqsSno#
		]]>
	</update>
	
	<select id="CSPIIT114ESelectKey" parameterClass="paramMap"	resultClass="resultMap">
        	SELECT	A.CSR_BRD_DVSN_CD 
        			,A.CSR_MTRL_RQS_SNO	        			
        	FROM	TBCSPIIT100M A 
        	WHERE   A.CSR_HNDL_APV_DOC_NO = #APV_DOC_NO#
	</select>
	
	<select id="CSPIIT114ESelectPrssStaCd" parameterClass="paramMap"	resultClass="java.lang.String">
        	SELECT	A.CSR_PRSS_STA_CD         				        			
        	FROM	TBCSPIIT100M A 
        	WHERE   A.CSR_MTRL_RQS_SNO = #MTRL_RQS_SNO#
			AND		A.CSR_BRD_DVSN_CD = #BRD_DVSN_CD#
	</select>
</sqlMap> 
