<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/dcp/113">
 	
 	<select id="CSPDCP113PMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.RM_CVPT_ACP_NO
   					,A.REQR_KND_CD
   					,A.CVPTR_NM
   					,A.RPST_PEN_NM
   					,A.ZCD
   					,A.AD
   					,A.DTL_AD
   					,DECODE(A.TNB,NULL,'',SUBSTR(A.TNB,1,INSTR(A.TNB,'-',1,1)-1)) TNB1
   					,DECODE(A.TNB,NULL,'',SUBSTR(A.TNB,INSTR(A.TNB,'-',1,1)+1,INSTR(A.TNB,'-',1,2)-INSTR(A.TNB,'-',1,1)-1)) AS TNB2
   					,DECODE(A.TNB,NULL,'',SUBSTR(A.TNB,INSTR(A.TNB,'-',1,2)+1)) TNB3
   					,DECODE(A.HPN,NULL,'',SUBSTR(HPN,1,INSTR(HPN,'-',1,1)-1)) HPN1
   					,DECODE(A.HPN,NULL,'',SUBSTR(A.HPN,INSTR(A.HPN,'-',1,1)+1,INSTR(A.HPN,'-',1,2)-INSTR(A.HPN,'-',1,1)-1)) AS HPN2
   					,DECODE(A.HPN,NULL,'',SUBSTR(A.HPN,INSTR(A.HPN,'-',1,2)+1)) HPN3
   					,A.HPN
   					,A.EML_ID
   					,A.EML_DMI_NM
   					,A.MNG_TYP_CD
   					,A.RSLT_NTF_WAY_CD
   					,A.TIT_NM
   					,A.ACP_RUT_CD
   			FROM	TBCSPDCP101M A
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #strREQ_DVSN_CD#
   			AND		A.ACP_YR = #strACP_YR#
   			AND	A.CVPT_ACP_NO = #strCVPT_ACP_NO#
		]]>
			
	</select>
	
	<update id="CSPDCP113EMainUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		CVPTR_NM = #CVPTR_NM#
					,RPST_PEN_NM = #RPST_PEN_NM#
					,ZCD = #ZCD#
					,AD = #AD#
   					,DTL_AD = #DTL_AD#
   					,TNB = DECODE(#TNB1#,NULL,'',#TNB1#||'-'||#TNB2#||'-'||#TNB3#)
   					,HPN = DECODE(#HPN1#,NULL,'',#HPN1#||'-'||#HPN2#||'-'||#HPN3#)
   					,EML_ID = #EML_ID#
   					,EML_DMI_NM = #EML_DMI_NM#
   					,RSLT_NTF_WAY_CD = NVL(#RSLT_NTF_WAY_CD#,'003')
   					,TIT_NM = #TIT_NM#
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</update>
	
</sqlMap> 
