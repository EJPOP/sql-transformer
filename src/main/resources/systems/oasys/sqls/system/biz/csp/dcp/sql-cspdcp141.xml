<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/dcp/141">
 	
 	<!-- #################################### 감사제보 접수현황 기관별 ################################# -->
 	<select id="CSPDCP141QSelect1" parameterClass="paramMap"  resultClass="resultMap">
 	<![CDATA[
 		WITH
			DATA AS
			(
				SELECT	D1.CVPT_KND_CD
					  , D2.CVPT_KND_DVSN_CD 
			          , D3.PUB_DVSN_CD
			          , D1.CVPT_HNDL_STA_CD
				FROM	TBCSPDCP101M D1
			          , TBCSPDCP201M D2
			          , (SELECT S1.REQ_DVSN_CD
                               ,S1.ACP_YR
                               ,S1.CVPT_ACP_NO
                               ,S1.PUB_DVSN_CD
                           FROM TBCSPDCP206L S1
                          WHERE S1.ORG_HIS_DVSN_CD = 1
                            AND ( S1.REQ_DVSN_CD, S1.ACP_YR, S1.CVPT_ACP_NO, S1.HNDL_ORG_SRNO ) IN  (
                            		SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(HNDL_ORG_SRNO)
                            		FROM	TBCSPDCP206L
                            		WHERE	ORG_HIS_DVSN_CD = 1
                            		GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
                            	)
                            ) D3
			 WHERE 1=1
			   AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
			   AND D1.ACP_YR      = D2.ACP_YR(+)
			   AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
			   AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
			   AND D1.ACP_YR      = D3.ACP_YR(+)
			   AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
			   AND D1.REQ_DVSN_CD = 1
		 ]]>
		  <dynamic>
		  		<isEqual property="SEARCHDTKEY" compareValue="1">
		  		  AND TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(#STARTDT#, 'YYYYMMDD'), 'YYYYMMDD') AND TO_CHAR(TO_DATE(#ENDDT#, 'YYYYMMDD'), 'YYYYMMDD')
		  		</isEqual>
		  		<isEqual property="SEARCHDTKEY" compareValue="2">
		  		  AND TO_CHAR(D2.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(#STARTDT#, 'YYYYMMDD'), 'YYYYMMDD') AND TO_CHAR(TO_DATE(#ENDDT#, 'YYYYMMDD'), 'YYYYMMDD')
		  		</isEqual>
		  </dynamic>
			),
			PRE_DATA AS
			(
				SELECT	D1.CVPT_KND_CD
					  , D2.CVPT_KND_DVSN_CD 
			          , D3.PUB_DVSN_CD
			          , D1.CVPT_HNDL_STA_CD
				FROM	TBCSPDCP101M D1
			          , TBCSPDCP201M D2
			          , (SELECT S1.REQ_DVSN_CD
                               ,S1.ACP_YR
                               ,S1.CVPT_ACP_NO
                               ,S1.PUB_DVSN_CD
                           FROM TBCSPDCP206L S1
                          WHERE S1.ORG_HIS_DVSN_CD = 1
                            AND ( S1.REQ_DVSN_CD, S1.ACP_YR, S1.CVPT_ACP_NO, S1.HNDL_ORG_SRNO ) IN  (
                            		SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(HNDL_ORG_SRNO)
                            		FROM	TBCSPDCP206L
                            		WHERE	ORG_HIS_DVSN_CD = 1
                            		GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
                            	)
                            ) D3
			    WHERE 1=1
			      AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
			      AND D1.ACP_YR      = D2.ACP_YR(+)
			      AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
			      AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
			      AND D1.ACP_YR      = D3.ACP_YR(+)
			      AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
			      AND D1.REQ_DVSN_CD = 1
			   <dynamic>
		  		<isEqual property="SEARCHDTKEY" compareValue="1">
				  AND TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
				</isEqual>
				
				<isEqual property="SEARCHDTKEY" compareValue="2">
				  AND TO_CHAR(D2.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
				</isEqual>
			  </dynamic>
			)
			SELECT	NULL AS CD
					, '합계' AS CD_NM
					, COUNT(1) AS CNT
			        , CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END AS PER
					, NVL(SUM(CASE WHEN PUB_DVSN_CD = '10' THEN 1 ELSE 0 END),0)                      AS CNT_GUK    /*국가기관*/
					, NVL(SUM(CASE WHEN PUB_DVSN_CD IN ('20', '21','22', '23') THEN 1 ELSE 0 END),0) AS CNT_JIBANG /*지방자치단체*/
					, NVL(SUM(CASE WHEN PUB_DVSN_CD IN ('30', '31', '32', '33') THEN 1 ELSE 0 END),0) AS CNT_GONG   /*공공기관*/
					, NVL(SUM(CASE WHEN PUB_DVSN_CD = '40' THEN 1 ELSE 0 END),0)                      AS CNT_ETC    /*기타단체*/
					, NVL(SUM(CASE WHEN PUB_DVSN_CD NOT IN ('10', '20', '21','22', '23','30', '31', '32', '33', '40') OR PUB_DVSN_CD IS NULL THEN 1 ELSE 0 END),0)                              AS CNT_ING    /*미분류*/
			
			FROM	DATA
			
			UNION ALL
			
			 SELECT NULL AS CD ,
			       '감사민원' AS CD_NM ,
			       NVL(SUM( CASE WHEN CVPT_KND_CD != '카' THEN 1 ELSE 0 END), 0) AS CNT ,
			       CASE WHEN COUNT(1) = 0 THEN 0 ELSE (NVL(SUM( CASE WHEN CVPT_KND_CD != '카' THEN 1 ELSE 0 END),0) / COUNT(1)) * 100 END AS PER ,
			       NVL(SUM( CASE WHEN PUB_DVSN_CD = '10' AND CVPT_KND_CD != '카' THEN 1 ELSE 0 END), 0) AS CNT_GUK /*국가기관*/,
			       NVL(SUM( CASE WHEN PUB_DVSN_CD IN ('20','21','22','23') AND CVPT_KND_CD != '카' THEN 1 ELSE 0 END), 0) AS CNT_JIBANG /*지방자치단체*/,
			       NVL(SUM( CASE WHEN PUB_DVSN_CD IN ('30','31','32','33') AND CVPT_KND_CD != '카' THEN 1 ELSE 0 END), 0) AS CNT_GONG /*공공기관*/,
			       NVL(SUM( CASE WHEN PUB_DVSN_CD = '40' AND CVPT_KND_CD != '카' THEN 1 ELSE 0 END), 0) AS CNT_ETC /*기타단체*/,
			       NVL(SUM( CASE WHEN PUB_DVSN_CD NOT IN ('10', '20', '21','22', '23','30', '31', '32', '33', '40') OR PUB_DVSN_CD IS NULL AND CVPT_KND_CD != '카' THEN 1 ELSE 0 END), 0) AS CNT_ING /*미분류*/
			  FROM DATA
			  
			UNION ALL  
			
			SELECT	D3.CD
					, D3.CD_NM
					, NVL(D4.CNT, 0) AS CNT
			        , CASE WHEN NVL(D4.CNTALL, 0) = 0 THEN 0 ELSE NVL(ROUND((D4.CNT/D4.CNTALL)*100, 2),0) END AS PER
					, NVL(D4.CNT_GUK   , 0) AS CNT_GUK
					, NVL(D4.CNT_JIBANG, 0) AS CNT_JIBANG
					, NVL(D4.CNT_GONG  , 0) AS CNT_GONG
					, NVL(D4.CNT_ETC   , 0) AS CNT_ETC
					, NVL(D4.CNT_ING   , 0) AS CNT_ING
			FROM	(
						SELECT	CD
								, CD_NM
						FROM	TBDCMACM013C D2
						WHERE	D2.CMM_CD_DVSN_CD = '1000047'
						AND		D2.CD != '000000000'
						AND     D2.CD != '카'
						ORDER BY OTPT_SEQ
					) D3,
					(
						SELECT	D1.CVPT_KND_CD 
								, COUNT(1) AS CNT
			                    , (SELECT COUNT(1) FROM DATA S1 WHERE 1=1) AS CNTALL
								, NVL(SUM(CASE WHEN PUB_DVSN_CD = '10' THEN 1 ELSE 0 END),0)                      AS CNT_GUK
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD IN ('20', '21','22', '23') THEN 1 ELSE 0 END),0) AS CNT_JIBANG
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD IN ('30', '31', '32', '33') THEN 1 ELSE 0 END),0) AS CNT_GONG
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD = '40' THEN 1 ELSE 0 END),0)                      AS CNT_ETC
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD NOT IN ('10', '20', '21','22', '23','30', '31', '32', '33', '40') OR PUB_DVSN_CD IS NULL THEN 1 ELSE 0 END),0)                              AS CNT_ING
						FROM	DATA D1
						GROUP BY ROLLUP(D1.CVPT_KND_CD)
					) D4
			WHERE	D3.CD = D4.CVPT_KND_CD(+)
			
			UNION ALL
			
		 SELECT NULL AS CD ,
		       '일반민원' AS CD_NM ,
		       NVL(SUM( CASE WHEN CVPT_KND_CD = '카' THEN 1 ELSE 0 END), 0) AS CNT ,
		       CASE WHEN COUNT(1) = 0 THEN 0 ELSE (NVL(SUM( CASE WHEN CVPT_KND_CD = '카' THEN 1 ELSE 0 END), 0) / COUNT(1)) * 100 END AS PER ,
		       NVL(SUM( CASE WHEN PUB_DVSN_CD = '10' AND CVPT_KND_CD = '카' THEN 1 ELSE 0 END), 0) AS CNT_GUK /*국가기관*/,
		       NVL(SUM( CASE WHEN PUB_DVSN_CD IN ('20','21','22','23') AND CVPT_KND_CD = '카' THEN 1 ELSE 0 END), 0) AS CNT_JIBANG /*지방자치단체*/,
		       NVL(SUM( CASE WHEN PUB_DVSN_CD IN ('30','31','32','33') AND CVPT_KND_CD = '카' THEN 1 ELSE 0 END), 0) AS CNT_GONG /*공공기관*/,
		       NVL(SUM( CASE WHEN PUB_DVSN_CD = '40' AND CVPT_KND_CD = '카' THEN 1 ELSE 0 END), 0) AS CNT_ETC /*기타단체*/,
		       NVL(SUM( CASE WHEN PUB_DVSN_CD NOT IN ('10', '20', '21','22', '23','30', '31', '32', '33', '40') OR PUB_DVSN_CD IS NULL AND CVPT_KND_CD = '카' THEN 1 ELSE 0 END), 0) AS CNT_ING /*미분류*/
		  FROM DATA
		  
			UNION ALL
			
			SELECT	NULL AS CD
					, '전년 동기간 증감' AS CD_NM
					, NVL(D5.CNT-D6.CNT, 0) AS CNT
			        , NVL(D5.PER-D6.PER, 0) AS PER
					, NVL(D5.CNT_GUK - D6.CNT_GUK      , 0) AS CNT_GUK
					, NVL(D5.CNT_JIBANG - D6.CNT_JIBANG, 0) AS CNT_JIBANG
					, NVL(D5.CNT_GONG - D6.CNT_GONG    , 0) AS CNT_GONG
					, NVL(D5.CNT_ETC - D6.CNT_ETC      , 0) AS CNT_ETC
					, NVL(D5.CNT_ING - D6.CNT_ING      , 0) AS CNT_ING
			FROM	(
						SELECT	'A' AS PK
								, COUNT(1) AS CNT
			                    , CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END AS PER
								, NVL(SUM(CASE WHEN PUB_DVSN_CD = '10' THEN 1 ELSE 0 END),0)                      AS CNT_GUK
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD IN ('20', '21','22', '23')  THEN 1 ELSE 0 END),0) AS CNT_JIBANG
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD IN ('30', '31', '32', '33') THEN 1 ELSE 0 END),0) AS CNT_GONG
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD = '40' THEN 1 ELSE 0 END),0)                      AS CNT_ETC
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD NOT IN ('10', '20', '21','22', '23','30', '31', '32', '33', '40') OR PUB_DVSN_CD IS NULL THEN 1 ELSE 0 END),0)                              AS CNT_ING
						FROM	DATA
					) D5
					, (
						SELECT	'A' AS PK
								, COUNT(1) AS CNT
			                    , CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END AS PER
								, NVL(SUM(CASE WHEN PUB_DVSN_CD = '10' THEN 1 ELSE 0 END),0)                      AS CNT_GUK
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD IN ('20', '21','22', '23')  THEN 1 ELSE 0 END),0) AS CNT_JIBANG
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD IN ('30', '31', '32', '33') THEN 1 ELSE 0 END),0) AS CNT_GONG
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD = '40' THEN 1 ELSE 0 END),0)                      AS CNT_ETC
			                    , NVL(SUM(CASE WHEN PUB_DVSN_CD NOT IN ('10', '20', '21','22', '23','30', '31', '32', '33', '40') OR PUB_DVSN_CD IS NULL THEN 1 ELSE 0 END),0)                              AS CNT_ING
						FROM	PRE_DATA
					) D6
			WHERE	D5.PK = D6.PK(+)
 	
	</select>
	
	
	<!-- #################################### 감사제보 접수현황 접수경로별 ################################# -->
	<select id="CSPDCP141QSelect2" parameterClass="paramMap"  resultClass="resultMap">
 	<![CDATA[
	 	WITH
		DATA AS
		(
			SELECT	D1.CVPT_KND_CD
				  , D1.ACP_RUT_CD
			FROM	TBCSPDCP101M D1
			      , TBCSPDCP201M D2
			WHERE	1=1
			  AND   D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
			  AND   D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
			  AND   D1.ACP_YR      = D2.ACP_YR(+)
			  AND   D1.REQ_DVSN_CD = '1'
			 /* AND   D1.CVPT_HNDL_STA_CD = '60'*/
    ]]>					
     <dynamic>
			<isEqual property="SEARCHDTKEY" compareValue="1">     
			  AND		TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(#STARTDT#, 'YYYYMMDD'), 'YYYYMMDD') AND TO_CHAR(TO_DATE(#ENDDT#, 'YYYYMMDD'), 'YYYYMMDD')
			</isEqual>
			<isEqual property="SEARCHDTKEY" compareValue="2">
			  AND		TO_CHAR(D2.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(#STARTDT#, 'YYYYMMDD'), 'YYYYMMDD') AND TO_CHAR(TO_DATE(#ENDDT#, 'YYYYMMDD'), 'YYYYMMDD')
			</isEqual>
     </dynamic>
		),
		PRE_DATA AS
		(
			SELECT	D1.CVPT_KND_CD
				  , D1.ACP_RUT_CD
			FROM	TBCSPDCP101M D1
			      , TBCSPDCP201M D2
			WHERE	1=1
			  AND   D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
			  AND   D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
			  AND   D1.ACP_YR      = D2.ACP_YR(+)
			  AND   D1.REQ_DVSN_CD = '1'
			/*AND   D1.CVPT_HNDL_STA_CD = '60'*/
		  <dynamic>
			<isEqual property="SEARCHDTKEY" compareValue="1">					  
		      AND D1.ACP_DH BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
		    </isEqual>
		    <isEqual property="SEARCHDTKEY" compareValue="2">					  
		      AND D2.FNL_HNDL_DH BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
		    </isEqual>
		  </dynamic>
			  
		)
	    SELECT NULL AS CD ,
		     '합계' AS CD_NM ,
		     COUNT(1) AS CNT ,
		     CASE
		       WHEN COUNT(1) = 0 THEN 0
		       ELSE (COUNT(1)/COUNT(1)) * 100
		     END AS PER ,
		     NVL(SUM(DECODE(ACP_RUT_CD, '1', 1, 0 )), 0) AS ACP_RUT_CD_1 /*서신*/,
		     NVL(SUM(DECODE(ACP_RUT_CD, '2', 1, 0 )), 0) AS ACP_RUT_CD_2 /*방문*/,
		     NVL(SUM(DECODE(ACP_RUT_CD, '3', 1, 0 )), 0) AS ACP_RUT_CD_3 /*이첩*/,
		     NVL(SUM(DECODE(ACP_RUT_CD, '4', 1, 0 )), 0) AS ACP_RUT_CD_4 /*전화*/,
		     NVL(SUM(DECODE(ACP_RUT_CD, '5', 1, 0 )), 0) AS ACP_RUT_CD_5 /*Fax*/,
		     NVL(SUM(DECODE(ACP_RUT_CD, '7', 1, 0 )), 0) AS ACP_RUT_CD_7 /*홈페이지*/,
		     NVL(SUM(DECODE(ACP_RUT_CD, '8', 1, 0 )), 0) AS ACP_RUT_CD_8 /*신문고*/
		FROM DATA
	  UNION ALL
	     SELECT NULL AS CD ,
	         '감사민원' AS CD_NM ,
	           COUNT(1) AS CNT ,
	           CASE
	             WHEN COUNT(1) = 0 THEN 0
	             ELSE (COUNT(1)/(SELECT COUNT(1) FROM DATA)) * 100
	           END AS PER ,
	           NVL(SUM(DECODE(ACP_RUT_CD, '1', 1, 0 )), 0) AS ACP_RUT_CD_1 /*서신*/,
	           NVL(SUM(DECODE(ACP_RUT_CD, '2', 1, 0 )), 0) AS ACP_RUT_CD_2 /*방문*/,
	           NVL(SUM(DECODE(ACP_RUT_CD, '3', 1, 0 )), 0) AS ACP_RUT_CD_3 /*이첩*/,
	           NVL(SUM(DECODE(ACP_RUT_CD, '4', 1, 0 )), 0) AS ACP_RUT_CD_4 /*전화*/,
	           NVL(SUM(DECODE(ACP_RUT_CD, '5', 1, 0 )), 0) AS ACP_RUT_CD_5 /*Fax*/,
	           NVL(SUM(DECODE(ACP_RUT_CD, '7', 1, 0 )), 0) AS ACP_RUT_CD_7 /*홈페이지*/,
	           NVL(SUM(DECODE(ACP_RUT_CD, '8', 1, 0 )), 0) AS ACP_RUT_CD_8 /*신문고*/
	      FROM DATA
	      WHERE CVPT_KND_CD != '카'
	 UNION ALL
	SELECT D3.CD ,
	       D3.CD_NM ,
	       NVL(D4.CNT, 0) AS CNT ,
	       CASE
	         WHEN NVL(D4.CNTALL, 0) = 0 THEN 0
	         ELSE ROUND((D4.CNT/D4.CNTALL) * 100, 2)
	       END AS PER ,
	       NVL(D4.ACP_RUT_CD_1, 0 ) AS ACP_RUT_CD_1 ,
	       NVL(D4.ACP_RUT_CD_2, 0 ) AS ACP_RUT_CD_2 ,
	       NVL(D4.ACP_RUT_CD_3, 0 ) AS ACP_RUT_CD_3 ,
	       NVL(D4.ACP_RUT_CD_4, 0 ) AS ACP_RUT_CD_4 ,
	       NVL(D4.ACP_RUT_CD_5, 0 ) AS ACP_RUT_CD_5 ,
	       NVL(D4.ACP_RUT_CD_7, 0 ) AS ACP_RUT_CD_7 ,
	       NVL(D4.ACP_RUT_CD_8, 0 ) AS ACP_RUT_CD_8
	  FROM (SELECT CD ,
	               CD_NM
	          FROM TBDCMACM013C D2
	         WHERE D2.CMM_CD_DVSN_CD = '1000047'
	           AND D2.CD != '000000000'
	           AND D2.CD != '카'
	         ORDER BY OTPT_SEQ ) D3,
	       (SELECT D1.CVPT_KND_CD ,
	               COUNT(1) AS CNT ,
	               (SELECT COUNT(1)
	                  FROM DATA S1
	                 WHERE 1=1) AS CNTALL ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '1', 1, 0 )), 0) AS ACP_RUT_CD_1 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '2', 1, 0 )), 0) AS ACP_RUT_CD_2 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '3', 1, 0 )), 0) AS ACP_RUT_CD_3 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '4', 1, 0 )), 0) AS ACP_RUT_CD_4 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '5', 1, 0 )), 0) AS ACP_RUT_CD_5 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '7', 1, 0 )), 0) AS ACP_RUT_CD_7 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '8', 1, 0 )), 0) AS ACP_RUT_CD_8
	          FROM DATA D1
	         GROUP BY D1.CVPT_KND_CD ) D4
	 WHERE D3.CD = D4.CVPT_KND_CD(+)
	 UNION ALL 
	 SELECT NULL AS CD ,
	       '일반민원' AS CD_NM ,
	       NVL(D4.CNT, 0) AS CNT ,
	       CASE
	         WHEN NVL(D4.CNTALL, 0) = 0 THEN 0
	         ELSE ROUND((D4.CNT/D4.CNTALL) * 100, 2)
	       END AS PER ,
	       NVL(D4.ACP_RUT_CD_1, 0 ) AS ACP_RUT_CD_1 ,
	       NVL(D4.ACP_RUT_CD_2, 0 ) AS ACP_RUT_CD_2 ,
	       NVL(D4.ACP_RUT_CD_3, 0 ) AS ACP_RUT_CD_3 ,
	       NVL(D4.ACP_RUT_CD_4, 0 ) AS ACP_RUT_CD_4 ,
	       NVL(D4.ACP_RUT_CD_5, 0 ) AS ACP_RUT_CD_5 ,
	       NVL(D4.ACP_RUT_CD_7, 0 ) AS ACP_RUT_CD_7 ,
	       NVL(D4.ACP_RUT_CD_8, 0 ) AS ACP_RUT_CD_8
	  FROM (SELECT CD ,
	               CD_NM
	          FROM TBDCMACM013C D2
	         WHERE D2.CMM_CD_DVSN_CD = '1000047'
	           AND D2.CD != '000000000'
	           AND D2.CD = '카'
	         ORDER BY OTPT_SEQ ) D3,
	       (SELECT D1.CVPT_KND_CD ,
	               COUNT(1) AS CNT ,
	               (SELECT COUNT(1)
	                  FROM DATA S1
	                 WHERE 1=1) AS CNTALL ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '1', 1, 0 )), 0) AS ACP_RUT_CD_1 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '2', 1, 0 )), 0) AS ACP_RUT_CD_2 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '3', 1, 0 )), 0) AS ACP_RUT_CD_3 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '4', 1, 0 )), 0) AS ACP_RUT_CD_4 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '5', 1, 0 )), 0) AS ACP_RUT_CD_5 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '7', 1, 0 )), 0) AS ACP_RUT_CD_7 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '8', 1, 0 )), 0) AS ACP_RUT_CD_8
	          FROM DATA D1
	          WHERE D1.CVPT_KND_CD = '카'
	         GROUP BY D1.CVPT_KND_CD ) D4
	 WHERE D3.CD = D4.CVPT_KND_CD(+)
	 UNION ALL
	SELECT NULL AS CD ,
	       '전년 동기간 증감' AS CD_NM ,
	       D5.CNT-D6.CNT AS CNT ,
	       NVL(D5.PER-D6.PER, 0) AS PER ,
	       D5.ACP_RUT_CD_1 - D6.ACP_RUT_CD_1 AS ACP_RUT_CD_1 ,
	       D5.ACP_RUT_CD_2 - D6.ACP_RUT_CD_2 AS ACP_RUT_CD_2 ,
	       D5.ACP_RUT_CD_3 - D6.ACP_RUT_CD_3 AS ACP_RUT_CD_3 ,
	       D5.ACP_RUT_CD_4 - D6.ACP_RUT_CD_4 AS ACP_RUT_CD_4 ,
	       D5.ACP_RUT_CD_5 - D6.ACP_RUT_CD_5 AS ACP_RUT_CD_5 ,
	       D5.ACP_RUT_CD_7 - D6.ACP_RUT_CD_7 AS ACP_RUT_CD_7 ,
	       D5.ACP_RUT_CD_8 - D6.ACP_RUT_CD_8 AS ACP_RUT_CD_8
	  FROM (SELECT 'A' AS PK ,
	               COUNT(1) AS CNT ,
	                       CASE
	                         WHEN COUNT(1) = 0 THEN 0
	                         ELSE (COUNT(1) / COUNT(1)) * 100
	                       END AS PER ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '1', 1, 0 )), 0) AS ACP_RUT_CD_1 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '2', 1, 0 )), 0) AS ACP_RUT_CD_2 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '3', 1, 0 )), 0) AS ACP_RUT_CD_3 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '4', 1, 0 )), 0) AS ACP_RUT_CD_4 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '5', 1, 0 )), 0) AS ACP_RUT_CD_5 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '7', 1, 0 )), 0) AS ACP_RUT_CD_7 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '8', 1, 0 )), 0) AS ACP_RUT_CD_8
	          FROM DATA ) D5 ,
	       (SELECT 'A' AS PK ,
	               COUNT(1) AS CNT ,
	                       CASE
	                         WHEN COUNT(1) = 0 THEN 0
	                         ELSE (COUNT(1) / COUNT(1)) * 100
	                       END AS PER ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '1', 1, 0 )), 0) AS ACP_RUT_CD_1 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '2', 1, 0 )), 0) AS ACP_RUT_CD_2 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '3', 1, 0 )), 0) AS ACP_RUT_CD_3 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '4', 1, 0 )), 0) AS ACP_RUT_CD_4 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '5', 1, 0 )), 0) AS ACP_RUT_CD_5 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '7', 1, 0 )), 0) AS ACP_RUT_CD_7 ,
	               NVL(SUM(DECODE(ACP_RUT_CD, '8', 1, 0 )), 0) AS ACP_RUT_CD_8
	          FROM PRE_DATA ) D6
	 WHERE D5.PK = D6.PK(+) 	
 	</select>
 	
 	<!-- #################################### 감사제보 접수현황 부서별 일반민원################################# -->
	<select id="CSPDCP141QSelect3_1" parameterClass="paramMap"  resultClass="resultMap">
	<![CDATA[
		WITH
		DATA AS
		(
			SELECT NVL(D3.HNDL_DPT_CD,D1.ACP_DPT_CD) AS HNDL_DPT_CD
		          ,D2.CVPT_HNDL_DVSN_CD
		          ,D1.CVPT_HNDL_STA_CD
		          ,D4.CVPT_OPM_APV_HNDL_STA_CD
		      FROM TBCSPDCP101M D1	
		          ,(
		          	SELECT	D4.REQ_DVSN_CD
		          			, D4.CVPT_ACP_NO
		          			, D4.ACP_YR
		          			, D4.CVPT_HNDL_DVSN_CD
		          	FROM	TBCSPDCP205L D4
		          	WHERE	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
           				SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
           				FROM	TBCSPDCP205L
           				GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
           			)
		          ) D2
		          ,TBCSPDCP201M D3
		          ,TBCSPDCP301M D4 
		     WHERE 1=1
		       AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
		       AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
		       AND D1.ACP_YR      = D2.ACP_YR(+)
		       AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
		       AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
		       AND D1.ACP_YR      = D3.ACP_YR(+)
		       AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD(+)
		       AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO(+)
		       AND D1.ACP_YR      = D4.ACP_YR(+)
		       AND D4.CVPT_IFM_DVSN_CD(+) = 'C'
		       AND D1.REQ_DVSN_CD = 1          
		       AND D1.CVPT_HNDL_STA_CD NOT IN ('10')
		       AND D1.RM_CVPT_ACP_NO IS NOT NULL	   
		       AND D1.CVPT_KND_CD IN (
			   							SELECT 	CD
			   							FROM	TBDCMACM013C
			   							WHERE	CMM_CD_DVSN_CD = '1000047'
			   							AND		CD != '000000000'
			   							AND		USR_DFN_TXT_1 = '2'
			   						)
	]]>
	<dynamic>
		<isEqual property="SEARCHDTKEY" compareValue="1">					  
		     AND	TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#
		</isEqual>
		<isEqual property="SEARCHDTKEY" compareValue="2">	
		     AND 	TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#				  
		</isEqual>
	</dynamic>
	<![CDATA[
		),
		PRE_DATA AS
		(
			SELECT NVL(D3.HNDL_DPT_CD,D1.ACP_DPT_CD) AS HNDL_DPT_CD
		          ,D2.CVPT_HNDL_DVSN_CD
		          ,D1.CVPT_HNDL_STA_CD
		          ,D4.CVPT_OPM_APV_HNDL_STA_CD
		      FROM TBCSPDCP101M D1	
		          ,(
		          	SELECT	D4.REQ_DVSN_CD
		          			, D4.CVPT_ACP_NO
		          			, D4.ACP_YR
		          			, D4.CVPT_HNDL_DVSN_CD
		          	FROM	TBCSPDCP205L D4
		          	WHERE	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
           				SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
           				FROM	TBCSPDCP205L
           				GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
           			)
		          ) D2
		          ,TBCSPDCP201M D3
		          ,TBCSPDCP301M D4 
		     WHERE 1=1
		       AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
		       AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
		       AND D1.ACP_YR      = D2.ACP_YR(+)
		       AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
		       AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
		       AND D1.ACP_YR      = D3.ACP_YR(+)
		       AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD(+)
		       AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO(+)
		       AND D1.ACP_YR      = D4.ACP_YR(+)
		       AND D4.CVPT_IFM_DVSN_CD(+) = 'C'
		       AND D1.REQ_DVSN_CD = 1          	   
		       AND D1.CVPT_HNDL_STA_CD NOT IN ('10')
		       AND D1.RM_CVPT_ACP_NO IS NOT NULL
		       AND D1.CVPT_KND_CD IN (
			   							SELECT 	CD
			   							FROM	TBDCMACM013C
			   							WHERE	CMM_CD_DVSN_CD = '1000047'
			   							AND		CD != '000000000'
			   							AND		USR_DFN_TXT_1 = '2'
			   						)
	]]>
	<dynamic>
		<isEqual property="SEARCHDTKEY" compareValue="1">					  
		     AND TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
		</isEqual>
		<isEqual property="SEARCHDTKEY" compareValue="2">					  
		     AND TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
		</isEqual>
	</dynamic>
	<![CDATA[
		)
		SELECT	NULL AS DPT_CD
				, '합계' AS DPT_NM
				, COUNT(1) AS CNT
		        , CASE WHEN COUNT(1) = 0 THEN 0 ELSE  (COUNT(1)/COUNT(1)) * 100 END AS PER
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT1 /*직접처리*/
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '61') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '61') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT8 /*직접처리-시정*/
                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '62') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '62') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT9 /*직접처리-해소*/
                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '63') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '63') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT10  /*직접처리-조사종결*/
                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '50') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '50') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT11 /*직접처리-대내이송*/
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT2 /*종결*/
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '80') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT3 /*반려*/
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '40') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '40') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT6 /*이송대외*/
		        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT12 /*재분류*/
		        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT7 /*처리중*/
		FROM	DATA
		
		UNION ALL
		
		SELECT	D3.DPT_CD
				, D3.DPT_NM
				, NVL(D4.CNT, 0) AS CNT
		        , CASE WHEN NVL(D4.CNTALL, 0) = 0 THEN 0 ELSE NVL(ROUND((D4.CNT/D4.CNTALL) * 100,2), 0) END AS PER
		        , NVL(D4.CVPT_HNDL_DVSN_CNT1, 0) AS CVPT_HNDL_DVSN_CNT1
		        , NVL(D4.CVPT_HNDL_DVSN_CNT8, 0) AS CVPT_HNDL_DVSN_CNT8
		        , NVL(D4.CVPT_HNDL_DVSN_CNT9, 0) AS CVPT_HNDL_DVSN_CNT9
		        , NVL(D4.CVPT_HNDL_DVSN_CNT10, 0) AS CVPT_HNDL_DVSN_CNT10
		        , NVL(D4.CVPT_HNDL_DVSN_CNT11, 0) AS CVPT_HNDL_DVSN_CNT11
		        , NVL(D4.CVPT_HNDL_DVSN_CNT2, 0) AS CVPT_HNDL_DVSN_CNT2
		        , NVL(D4.CVPT_HNDL_DVSN_CNT3, 0) AS CVPT_HNDL_DVSN_CNT3
		        , NVL(D4.CVPT_HNDL_DVSN_CNT6, 0) AS CVPT_HNDL_DVSN_CNT6
		        , NVL(D4.CVPT_HNDL_DVSN_CNT12, 0) AS CVPT_HNDL_DVSN_CNT12
		        , NVL(D4.CVPT_HNDL_DVSN_CNT7, 0) AS CVPT_HNDL_DVSN_CNT7
		FROM	(
					SELECT DPT_CD 
		                  ,DPT_NM
		              FROM TBDCMACM002M
		             WHERE HIRK_DPT_CD = '071000'
		              AND USE_YN = 'Y'
		              AND DPT_TP_CD = 'S'
				) D3,
				(
					SELECT	D1.HNDL_DPT_CD 
							, COUNT(1) AS CNT
		                    , (SELECT COUNT(1) FROM DATA S1 WHERE 1=1) AS CNTALL
		                    , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT1 /*직접처리*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '61') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '61') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT8 /*직접처리-시정*/
			                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '62') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '62') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT9 /*직접처리-해소*/
			                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '63') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '63') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT10  /*직접처리-조사종결*/
			                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '50') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '50') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT11 /*직접처리-대내이송*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT2 /*종결*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '80') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT3 /*반려*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '40') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '40') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT6 /*이송대외*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT12 /*재분류*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT7 /*처리중*/
					FROM	DATA D1
					GROUP BY D1.HNDL_DPT_CD
				) D4
		WHERE	D3.DPT_CD = D4.HNDL_DPT_CD(+)
		
		UNION ALL
		
		SELECT	NULL AS DPT_CD
				, '전년 동기간 증감' AS DPT_NM
				, D5.CNT-D6.CNT AS CNT
		        , NVL(D5.PER-D6.PER, 0) AS PER
		        , D5.CVPT_HNDL_DVSN_CNT1-D6.CVPT_HNDL_DVSN_CNT1 AS CVPT_HNDL_DVSN_CNT1
		        , D5.CVPT_HNDL_DVSN_CNT8-D6.CVPT_HNDL_DVSN_CNT8 AS CVPT_HNDL_DVSN_CNT8
		        , D5.CVPT_HNDL_DVSN_CNT9-D6.CVPT_HNDL_DVSN_CNT9 AS CVPT_HNDL_DVSN_CNT9
		        , D5.CVPT_HNDL_DVSN_CNT10-D6.CVPT_HNDL_DVSN_CNT10 AS CVPT_HNDL_DVSN_CNT10
		        , D5.CVPT_HNDL_DVSN_CNT11-D6.CVPT_HNDL_DVSN_CNT11 AS CVPT_HNDL_DVSN_CNT11
		        , D5.CVPT_HNDL_DVSN_CNT2-D6.CVPT_HNDL_DVSN_CNT2 AS CVPT_HNDL_DVSN_CNT2
		        , D5.CVPT_HNDL_DVSN_CNT3-D6.CVPT_HNDL_DVSN_CNT3 AS CVPT_HNDL_DVSN_CNT3
		        , D5.CVPT_HNDL_DVSN_CNT6-D6.CVPT_HNDL_DVSN_CNT6 AS CVPT_HNDL_DVSN_CNT6
		        , D5.CVPT_HNDL_DVSN_CNT12-D6.CVPT_HNDL_DVSN_CNT12 AS CVPT_HNDL_DVSN_CNT12
		        , D5.CVPT_HNDL_DVSN_CNT7-D6.CVPT_HNDL_DVSN_CNT7 AS CVPT_HNDL_DVSN_CNT7
		FROM	(
					SELECT	'A' AS PK
							, COUNT(1) AS CNT
		                    , CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END AS PER
		                    , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63' ,'50')) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT1 /*직접처리*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '61') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '61') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT8 /*직접처리-시정*/
			                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '62') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '62') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT9 /*직접처리-해소*/
			                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '63') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '63') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT10  /*직접처리-조사종결*/
			                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '50') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '50') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT11 /*직접처리-대내이송*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT2 /*종결*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '80') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT3 /*반려*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '40') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '40') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT6 /*이송대외*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT12 /*재분류*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT7 /*처리중*/
		
					FROM	DATA
				) D5
				, (
					SELECT	'A' AS PK
							, COUNT(1) AS CNT
		                    , CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END AS PER
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT1 /*직접처리*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '61') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '61') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT8 /*직접처리-시정*/
			                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '62') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '62') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT9 /*직접처리-해소*/
			                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '63') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '63') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT10  /*직접처리-조사종결*/
			                , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '50') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '50') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT11 /*직접처리-대내이송*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT2 /*종결*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '80') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT3 /*반려*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '40') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '40') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT6 /*이송대외*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT12 /*재분류*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT7 /*처리중*/
					FROM	PRE_DATA
				) D6
		WHERE	D5.PK = D6.PK(+)
	]]>
	</select>
	
	<!-- #################################### 감사제보 접수현황 부서별 감사민원################################# -->
	<select id="CSPDCP141QSelect3_2" parameterClass="paramMap"  resultClass="resultMap">
	<![CDATA[
		WITH DATA AS (
		SELECT NVL(D3.HNDL_DPT_CD, D1.ACP_DPT_CD) AS HNDL_DPT_CD ,
		       D2.CVPT_HNDL_DVSN_CD ,
		       D1.CVPT_HNDL_STA_CD,
		       D4.CVPT_OPM_APV_HNDL_STA_CD
		  FROM TBCSPDCP101M D1
		       ,(
		      	SELECT	D4.REQ_DVSN_CD
		      			, D4.CVPT_ACP_NO
		      			, D4.ACP_YR
		      			, D4.CVPT_HNDL_DVSN_CD
		      	FROM	TBCSPDCP205L D4
		      	WHERE	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
						SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
						FROM	TBCSPDCP205L
						GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
					)
		       ) D2
		       , TBCSPDCP201M D3
		       , TBCSPDCP301M D4
		 WHERE 1=1
		   AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
		   AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
		   AND D1.ACP_YR = D2.ACP_YR(+)
		   AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
		   AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
		   AND D1.ACP_YR = D3.ACP_YR(+)
		   AND D1.REQ_DVSN_CD = 1
		   AND D1.CVPT_HNDL_STA_CD NOT IN ('10')
		   AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD(+)
           AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO(+)
           AND D1.ACP_YR = D4.ACP_YR(+)
           AND D4.CVPT_IFM_DVSN_CD(+) = 'C'
	       AND D1.RM_CVPT_ACP_NO IS NOT NULL
		   AND D1.CVPT_KND_CD IN (
			   							SELECT 	CD
			   							FROM	TBDCMACM013C
			   							WHERE	CMM_CD_DVSN_CD = '1000047'
			   							AND		CD != '000000000'
			   							AND		USR_DFN_TXT_1 = '1'
			   						)
	]]>
	<dynamic>
		<isEqual property="SEARCHDTKEY" compareValue="1">					  
	      AND TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#
	   	</isEqual>
		<isEqual property="SEARCHDTKEY" compareValue="2">	
		  AND TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#			  
		</isEqual>
	</dynamic> 
	<![CDATA[
           ),
       PRE_DATA AS (
       	SELECT NVL(D3.HNDL_DPT_CD, D1.ACP_DPT_CD) AS HNDL_DPT_CD ,
		       D2.CVPT_HNDL_DVSN_CD ,
		       D1.CVPT_HNDL_STA_CD,
		       D4.CVPT_OPM_APV_HNDL_STA_CD
		  FROM TBCSPDCP101M D1
		       ,(
		      	SELECT	D4.REQ_DVSN_CD
		      			, D4.CVPT_ACP_NO
		      			, D4.ACP_YR
		      			, D4.CVPT_HNDL_DVSN_CD
		      	FROM	TBCSPDCP205L D4
		      	WHERE	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
						SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
						FROM	TBCSPDCP205L
						GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
					)
		      ) D2
		       ,TBCSPDCP201M D3
		       ,TBCSPDCP301M D4
		 WHERE 1=1
		   AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
		   AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
		   AND D1.ACP_YR = D2.ACP_YR(+)
		   AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
		   AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
		   AND D1.ACP_YR = D3.ACP_YR(+)
		   AND D1.REQ_DVSN_CD = 1
		   AND D1.CVPT_HNDL_STA_CD NOT IN ('10')
	       AND D1.RM_CVPT_ACP_NO IS NOT NULL
	       AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD(+)
           AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO(+)
           AND D1.ACP_YR = D4.ACP_YR(+)
           AND D4.CVPT_IFM_DVSN_CD(+) = 'C'
		   AND D1.CVPT_KND_CD IN (
		   							SELECT 	CD
		   							FROM	TBDCMACM013C
		   							WHERE	CMM_CD_DVSN_CD = '1000047'
		   							AND		CD != '000000000'
		   							AND		USR_DFN_TXT_1 = '1'
		   						)
	]]>
	<dynamic>
		<isEqual property="SEARCHDTKEY" compareValue="1">					  
     	  AND TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
   		</isEqual>
   		<isEqual property="SEARCHDTKEY" compareValue="2">					  
     	  AND TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
		</isEqual>
	</dynamic>
	<![CDATA[
            )
		 SELECT NULL AS DPT_CD ,
		       '합계' AS DPT_NM ,
		       COUNT(1) AS CNT ,
		       CASE
		         WHEN COUNT(1) = 0 THEN 0
		         ELSE (COUNT(1)/COUNT(1)) * 100
		       END AS PER ,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN ( '11', '12','13', '14' )) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '11', '12', '13','14')) OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1 /*직접조사-소계*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '11') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '11') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_1 /*직접조사-즉시시정*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '12') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '12') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_2 /*직접조사-즉시해소*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_3 /*직접조사-즉시종결*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '14') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '14') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_4 /*직접조사-실지감사*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '20') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '20') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT2 /*위탁조사*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '30') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '30') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT3 /*감사참고자료*/,
		       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT5, /*재분류*/
		       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT4 /*처리중*/
		  FROM DATA
		 UNION ALL
		SELECT D3.DPT_CD ,
		       D3.DPT_NM ,
		       NVL(D4.CNT, 0) AS CNT ,
		       CASE
		         WHEN D4.CNTALL = 0 THEN 0
		         ELSE NVL(ROUND((D4.CNT/D4.CNTALL) * 100, 2), 0)
		       END AS PER ,
		       NVL(D4.CVPT_HNDL_DVSN_CNT1, 0) AS CVPT_HNDL_DVSN_CNT1 ,
		       NVL(D4.CVPT_HNDL_DVSN_CNT1_1, 0) AS CVPT_HNDL_DVSN_CNT1_1 ,
		       NVL(D4.CVPT_HNDL_DVSN_CNT1_2, 0) AS CVPT_HNDL_DVSN_CNT1_2 ,
		       NVL(D4.CVPT_HNDL_DVSN_CNT1_3, 0) AS CVPT_HNDL_DVSN_CNT1_3 ,
		       NVL(D4.CVPT_HNDL_DVSN_CNT1_4, 0) AS CVPT_HNDL_DVSN_CNT1_4 ,
		       NVL(D4.CVPT_HNDL_DVSN_CNT2, 0) AS CVPT_HNDL_DVSN_CNT2 ,
		       NVL(D4.CVPT_HNDL_DVSN_CNT3, 0) AS CVPT_HNDL_DVSN_CNT3 ,
		       NVL(D4.CVPT_HNDL_DVSN_CNT5, 0) AS CVPT_HNDL_DVSN_CNT5 ,
		       NVL(D4.CVPT_HNDL_DVSN_CNT4, 0) AS CVPT_HNDL_DVSN_CNT4
		  FROM (SELECT DPT_CD ,
		               DPT_NM
		          FROM TBDCMACM002M
		         WHERE HIRK_DPT_CD = '071000'
		           AND USE_YN = 'Y'
		           AND DPT_TP_CD = 'S' ) D3,
		       (SELECT D1.HNDL_DPT_CD ,
		               COUNT(1) AS CNT ,
		               (SELECT COUNT(1)
		                  FROM DATA S1
		                 WHERE 1=1) AS CNTALL ,
		               NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN ( '11', '12','13', '14' )) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '11', '12', '13','14')) OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1 /*직접조사-소계*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '11') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '11') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_1 /*직접조사-즉시시정*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '12') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '12') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_2 /*직접조사-즉시해소*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_3 /*직접조사-즉시종결*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '14') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '14') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_4 /*직접조사-실지감사*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '20') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '20') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT2 /*위탁조사*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '30') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '30') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT3 /*감사참고자료*/,
				       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT5, /*재분류*/
				       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT4 /*처리중*/
		          FROM DATA D1
		         GROUP BY D1.HNDL_DPT_CD ) D4
		 WHERE D3.DPT_CD = D4.HNDL_DPT_CD(+)
		 UNION ALL
		SELECT NULL AS DPT_CD ,
		       '전년 동기간 증감' AS DPT_NM ,
		       D5.CNT-D6.CNT AS CNT ,
		       NVL(D5.PER-D6.PER, 0) AS PER ,
		       D5.CVPT_HNDL_DVSN_CNT1-D6.CVPT_HNDL_DVSN_CNT1 AS CVPT_HNDL_DVSN_CNT1 ,
		       D5.CVPT_HNDL_DVSN_CNT1_1-D6.CVPT_HNDL_DVSN_CNT1_1 AS CVPT_HNDL_DVSN_CNT1_1 ,
		       D5.CVPT_HNDL_DVSN_CNT1_2-D6.CVPT_HNDL_DVSN_CNT1_2 AS CVPT_HNDL_DVSN_CNT1_2 ,
		       D5.CVPT_HNDL_DVSN_CNT1_3-D6.CVPT_HNDL_DVSN_CNT1_3 AS CVPT_HNDL_DVSN_CNT1_3 ,
		       D5.CVPT_HNDL_DVSN_CNT1_4-D6.CVPT_HNDL_DVSN_CNT1_4 AS CVPT_HNDL_DVSN_CNT1_4 ,
		       D5.CVPT_HNDL_DVSN_CNT2-D6.CVPT_HNDL_DVSN_CNT2 AS CVPT_HNDL_DVSN_CNT2 ,
		       D5.CVPT_HNDL_DVSN_CNT3-D6.CVPT_HNDL_DVSN_CNT3 AS CVPT_HNDL_DVSN_CNT3 ,
		       D5.CVPT_HNDL_DVSN_CNT5-D6.CVPT_HNDL_DVSN_CNT5 AS CVPT_HNDL_DVSN_CNT5 ,
		       D5.CVPT_HNDL_DVSN_CNT4-D6.CVPT_HNDL_DVSN_CNT4 AS CVPT_HNDL_DVSN_CNT4 
		      
		  FROM (SELECT 'A' AS PK ,
		               COUNT(1) AS CNT ,
                       CASE
                         WHEN COUNT(1) = 0 THEN 0
                         ELSE (COUNT(1) / COUNT(1)) * 100
                       END AS PER ,
		               NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN ( '11', '12','13', '14' )) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '11', '12', '13','14')) OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1 /*직접조사-소계*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '11') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '11') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_1 /*직접조사-즉시시정*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '12') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '12') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_2 /*직접조사-즉시해소*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_3 /*직접조사-즉시종결*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '14') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '14') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_4 /*직접조사-실지감사*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '20') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '20') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT2 /*위탁조사*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '30') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '30') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT3 /*감사참고자료*/,
				       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT5, /*재분류*/
				       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT4 /*처리중*/
		          FROM DATA ) D5 ,
		       (SELECT 'A' AS PK ,
		               COUNT(1) AS CNT ,
                       CASE
                         WHEN COUNT(1) = 0 THEN 0
                         ELSE (COUNT(1) / COUNT(1)) * 100
                       END AS PER ,
		               NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN ( '11', '12','13', '14' )) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '11', '12','13', '14'))  THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1 /*직접조사-소계*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '11') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '11') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_1 /*직접조사-즉시시정*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '12') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '12') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_2 /*직접조사-즉시해소*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_3 /*직접조사-즉시종결*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '14') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '14') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_4 /*직접조사-실지감사*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '20') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '20') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT2 /*위탁조사*/,
				       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '30') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '30') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT3 /*감사참고자료*/,
				       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT5, /*재분류*/
				       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT4 /*처리중*/
		          FROM PRE_DATA ) D6
		 WHERE D5.PK = D6.PK(+)
	]]>
	</select>
	
	<!-- #################################### 감사제보 접수현황 부서별 직접처리상세현황 ################################# -->
	<select id="CSPDCP141QSelect3_3" parameterClass="paramMap"  resultClass="resultMap">
	<![CDATA[
		WITH 
		DATA AS (
			SELECT	D9.REQ_DVSN_CD
					, D9.ACP_YR
					, D9.CVPT_ACP_NO
					, D9.HNDL_DPT_CD
					, D9.CVPT_HNDL_DVSN_CD
					, D9.DGE
					, D9.AUD_YR
					, D9.AUD_NO
					, D9.DSP_RQ_SNO
					, D10.DSP_RQ_KND_CD
					, NVL(SUM(D11.AM),0) AS AM
					, COUNT(D11.DFNT_SNO) AS CNT
			FROM	(
						SELECT	D1.REQ_DVSN_CD
								, D1.ACP_YR
								, D1.CVPT_ACP_NO
								, D2.HNDL_DPT_CD
								, D3.CVPT_HNDL_DVSN_CD
								, D7.DGE
								, D8.AUD_YR
								, D8.AUD_NO
								, D8.DSP_RQ_SNO
						FROM	TBCSPDCP101M D1
								, TBCSPDCP201M D2
								, (
									SELECT	*
									FROM	TBCSPDCP205L D4
									WHERE	D4.REQ_DVSN_CD = '1'
									AND 	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
						           				SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
						           				FROM	TBCSPDCP205L
						           				GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
						           			)
									AND		D4.CVPT_HNDL_DVSN_CD = '14'
								) D3
								, (
									SELECT	*
									FROM	TBCSPDCP402L D5
									WHERE	( D5.REQ_DVSN_CD, D5.ACP_YR, D5.CVPT_ACP_NO, D5.DGE ) IN (
													SELECT	D6.REQ_DVSN_CD, D6.ACP_YR, D6.CVPT_ACP_NO, MIN(D6.DGE)
													FROM	TBCSPDCP401H D6
													GROUP BY D6.REQ_DVSN_CD, D6.ACP_YR, D6.CVPT_ACP_NO
												)
									AND		D5.RSLT_RPRT_HNDL_RSLT_CD = '10'
								) D7
								, TBCSPDCP403L D8
						WHERE	D1.REQ_DVSN_CD = D2.REQ_DVSN_CD
						AND		D1.ACP_YR = D2.ACP_YR
						AND		D1.CVPT_ACP_NO = D2.CVPT_ACP_NO
						AND		D2.REQ_DVSN_CD = D3.REQ_DVSN_CD
						AND		D2.ACP_YR = D3.ACP_YR
						AND		D2.CVPT_ACP_NO = D3.CVPT_ACP_NO
						AND		D1.REQ_DVSN_CD = D7.REQ_DVSN_CD
						AND		D1.ACP_YR = D7.ACP_YR
						AND		D1.CVPT_ACP_NO = D7.CVPT_ACP_NO
						AND		D7.REQ_DVSN_CD = D8.REQ_DVSN_CD
						AND		D7.ACP_YR = D8.ACP_YR
						AND		D7.CVPT_ACP_NO = D8.CVPT_ACP_NO
						AND		D7.DGE = D8.DGE
						AND		D1.REQ_DVSN_CD = '1'
						AND		D1.CVPT_HNDL_STA_CD = '60'
			]]>
			<dynamic>
			<isEqual property="SEARCHDTKEY" compareValue="1">					  
		      			AND 	TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#
		    </isEqual>
		    <isEqual property="SEARCHDTKEY" compareValue="2">	
		      			AND 	TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#				  
		    </isEqual>
		  </dynamic>
			<![CDATA[
					) D9
					, TBBADEAR001M D10
					, TBBADEAR007M D11
			WHERE	D9.AUD_YR = D10.AUD_YR
			AND		D9.AUD_NO = D10.AUD_NO
			AND		D9.DSP_RQ_SNO = D10.DSP_RQ_SNO
			AND		D10.AUD_YR = D11.AUD_YR(+)
			AND		D10.AUD_NO = D11.AUD_NO(+)
			AND		D10.DSP_RQ_SNO = D11.DSP_RQ_SNO(+)
			GROUP BY D9.REQ_DVSN_CD
					, D9.ACP_YR
					, D9.CVPT_ACP_NO
					, D9.HNDL_DPT_CD
					, D9.CVPT_HNDL_DVSN_CD
					, D9.DGE
					, D9.AUD_YR
					, D9.AUD_NO
					, D9.DSP_RQ_SNO
					, D10.DSP_RQ_KND_CD
		)
		, PRE_DATA AS (
			SELECT	D9.REQ_DVSN_CD
					, D9.ACP_YR
					, D9.CVPT_ACP_NO
					, D9.HNDL_DPT_CD 
					, D9.CVPT_HNDL_DVSN_CD
					, D9.DGE
					, D9.AUD_YR
					, D9.AUD_NO
					, D9.DSP_RQ_SNO
					, D10.DSP_RQ_KND_CD
					, NVL(SUM(D11.AM),0) AS AM
					, COUNT(D11.DFNT_SNO) AS CNT
			FROM	(
						SELECT	D1.REQ_DVSN_CD
								, D1.ACP_YR
								, D1.CVPT_ACP_NO
								, D2.HNDL_DPT_CD
								, D3.CVPT_HNDL_DVSN_CD
								, D7.DGE
								, D8.AUD_YR
								, D8.AUD_NO
								, D8.DSP_RQ_SNO
						FROM	TBCSPDCP101M D1
								, TBCSPDCP201M D2
								, (
									SELECT	*
									FROM	TBCSPDCP205L D4
									WHERE	D4.REQ_DVSN_CD = '1'
					          	    AND 	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
						           				SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
						           				FROM	TBCSPDCP205L
						           				GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
						           			)
									AND		D4.CVPT_HNDL_DVSN_CD = '14'
								) D3
								, (
									SELECT	*
									FROM	TBCSPDCP402L D5
									WHERE	( D5.REQ_DVSN_CD, D5.ACP_YR, D5.CVPT_ACP_NO, D5.DGE ) IN (
													SELECT	D6.REQ_DVSN_CD, D6.ACP_YR, D6.CVPT_ACP_NO, MIN(D6.DGE)
													FROM	TBCSPDCP401H D6
													GROUP BY D6.REQ_DVSN_CD, D6.ACP_YR, D6.CVPT_ACP_NO
												)
									AND		D5.RSLT_RPRT_HNDL_RSLT_CD = '10'
								) D7
								, TBCSPDCP403L D8
						WHERE	D1.REQ_DVSN_CD = D2.REQ_DVSN_CD
						AND		D1.ACP_YR = D2.ACP_YR
						AND		D1.CVPT_ACP_NO = D2.CVPT_ACP_NO
						AND		D2.REQ_DVSN_CD = D3.REQ_DVSN_CD
						AND		D2.ACP_YR = D3.ACP_YR
						AND		D2.CVPT_ACP_NO = D3.CVPT_ACP_NO
						AND		D1.REQ_DVSN_CD = D7.REQ_DVSN_CD
						AND		D1.ACP_YR = D7.ACP_YR
						AND		D1.CVPT_ACP_NO = D7.CVPT_ACP_NO
						AND		D7.REQ_DVSN_CD = D8.REQ_DVSN_CD
						AND		D7.ACP_YR = D8.ACP_YR
						AND		D7.CVPT_ACP_NO = D8.CVPT_ACP_NO
						AND		D7.DGE = D8.DGE
						AND		D1.REQ_DVSN_CD = '1'
						AND		D1.CVPT_HNDL_STA_CD = '60'
			]]>
			<dynamic>
				<isEqual property="SEARCHDTKEY" compareValue="1">					  
			      		AND 	TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
			    </isEqual>
			    <isEqual property="SEARCHDTKEY" compareValue="2">					  
			      		AND 	TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
			    </isEqual>
			</dynamic>
			<![CDATA[						
					) D9
					, TBBADEAR001M D10
					, TBBADEAR007M D11
			WHERE	D9.AUD_YR = D10.AUD_YR
			AND		D9.AUD_NO = D10.AUD_NO
			AND		D9.DSP_RQ_SNO = D10.DSP_RQ_SNO
			AND		D10.AUD_YR = D11.AUD_YR(+)
			AND		D10.AUD_NO = D11.AUD_NO(+)
			AND		D10.DSP_RQ_SNO = D11.DSP_RQ_SNO(+)
			GROUP BY D9.REQ_DVSN_CD
					, D9.ACP_YR
					, D9.CVPT_ACP_NO
					, D9.HNDL_DPT_CD
					, D9.CVPT_HNDL_DVSN_CD
					, D9.DGE
					, D9.AUD_YR
					, D9.AUD_NO
					, D9.DSP_RQ_SNO
					, D10.DSP_RQ_KND_CD
		)
		SELECT NULL AS DPT_CD
		      ,'합계' AS DPT_NM
		      ,NULL AS CD
		      ,NULL AS CD_NM
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120', '210', '310', '320', '410', '510', '520', '530', '611', '610', '630', '620', '621', '623', '810', '820', '830', '840', '850', '916', '390', '391', '490', '710', '720', '730') THEN 1 ELSE 0 END),0) AS TOTAL /*합계*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN 1 ELSE 0 END),0)                   AS COLUMN1 /*판정*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN AM ELSE 0 END),0)                  AS COLUMN1_AM /*판정_금액*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN CNT ELSE 0 END),0)                 AS COLUMN1_CNT /*판정_인원*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('210') THEN 1 ELSE 0 END),0)                          AS COLUMN2 /*징계*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('210') THEN CNT ELSE 0 END),0)                  		 AS COLUMN2_CNT /*징계_인원*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('310', '320') THEN 1 ELSE 0 END),0) 					 AS COLUMN3 /*시정*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('310', '320') THEN AM ELSE 0 END),0)                  AS COLUMN3_AM /*시정_금액*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('410') THEN 1 ELSE 0 END),0)            			     AS COLUMN4 /*주의*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('410') THEN CNT ELSE 0 END),0)                  		 AS COLUMN4_CNT /*주의_인원*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('510', '520', '530') THEN 1 ELSE 0 END),0)            AS COLUMN5 /*개선*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('611') THEN 1 ELSE 0 END),0)                          AS COLUMN6 /*권고*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('610', '630') THEN 1 ELSE 0 END),0)     				 AS COLUMN7 /*통보*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('620', '621', '623') THEN 1 ELSE 0 END),0)			 AS COLUMN7_1 /*통보(인사자료)*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('810', '820', '830', '840', '850') THEN 1 ELSE 0 END),0) AS COLUMN7_2 /*통보(모범사례)*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('916') THEN 1 ELSE 0 END),0)                          AS COLUMN8 /*불문*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('390', '391') THEN 1 ELSE 0 END),0)                   AS COLUMN9 /*현지시정*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('490') THEN 1 ELSE 0 END),0)                          AS COLUMN10 /*현지주의*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('710', '720') THEN 1 ELSE 0 END),0)                   AS COLUMN11 /*고발*/
		      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('730') THEN 1 ELSE 0 END),0)                          AS COLUMN12 /*수사요청*/
		FROM DATA
		UNION ALL
		SELECT 	T1.DPT_CD
		      	,T1.DPT_NM
		      	,T1.CD
		      	,T1.CD_NM
		      	,(NVL(T2.COLUMN1, 0)+NVL(T2.COLUMN2, 0)+NVL(T2.COLUMN3, 0)+NVL(T2.COLUMN4, 0)+
		        	NVL(T2.COLUMN5, 0)+NVL(T2.COLUMN6, 0)+NVL(T2.COLUMN7, 0)+NVL(T2.COLUMN7_1, 0)+NVL(T2.COLUMN8, 0)+NVL(T2.COLUMN9, 0)+NVL(T2.COLUMN10, 0)+NVL(T2.COLUMN11, 0)+NVL(T2.COLUMN12, 0)) AS TOTAL
		      	, NVL(T2.COLUMN1, 0) AS COLUMN1
		      	, NVL(T2.COLUMN1_AM, 0) AS COLUMN1_AM
		      	, NVL(T2.COLUMN1_CNT, 0) AS COLUMN1_CNT
		      	, NVL(T2.COLUMN2, 0) AS COLUMN2
		      	, NVL(T2.COLUMN2_CNT, 0) AS COLUMN2_CNT
		      	, NVL(T2.COLUMN3, 0) AS COLUMN3
		      	, NVL(T2.COLUMN3_AM, 0) AS COLUMN3_AM
		      	, NVL(T2.COLUMN4, 0) AS COLUMN4
		      	, NVL(T2.COLUMN4_CNT, 0) AS COLUMN4_CNT
		      	, NVL(T2.COLUMN5, 0) AS COLUMN5
		      	, NVL(T2.COLUMN6, 0) AS COLUMN6
		     	, NVL(T2.COLUMN7, 0) AS COLUMN7
		     	, NVL(T2.COLUMN7_1, 0) AS COLUMN7_1
		     	, NVL(T2.COLUMN7_2, 0) AS COLUMN7_2
		      	, NVL(T2.COLUMN8, 0) AS COLUMN8
		      	, NVL(T2.COLUMN9, 0) AS COLUMN9
		      	, NVL(T2.COLUMN10, 0) AS COLUMN10
		      	, NVL(T2.COLUMN11, 0) AS COLUMN11
		      	, NVL(T2.COLUMN12, 0) AS COLUMN12
		FROM 	(
				    SELECT 	DISTINCT DPT_CD
				          	, DPT_NM
				          	, CD
				          	, CD_NM
				    FROM 	(
							    SELECT 	DPT_CD 
							          	, DPT_NM
							          	, 'A' AS PKKEY
							    FROM 	TBDCMACM002M
							    WHERE 	HIRK_DPT_CD = '071000'
							    AND 	USE_YN = 'Y'
							    AND 	DPT_TP_CD = 'S'
							) D1,
					       (
					       		SELECT 	'10' AS CD
					              		,'직접조사(A)' AS CD_NM
					              		, 'A' AS PKKEY
					          	FROM 	DUAL
					        	UNION ALL
					        	SELECT 	'20' AS CD
					              		,'위탁조사(B)' AS CD_NM
					              		, 'A' AS PKKEY
					          	FROM 	DUAL
					          	/*
					        	UNION ALL
					        	SELECT 	'30' AS CD
					              		,'조사종결(C)' AS CD_NM
					              		, 'A' AS PKKEY
					          	FROM 	DUAL
					          	*/
					       )D2
					WHERE D1.PKKEY = D2.PKKEY 
				    ORDER BY DPT_CD
				) T1,
				(	
					SELECT HNDL_DPT_CD
						  , CVPT_HNDL_DVSN_CD
					      ,COUNT(1) AS CNT
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN 1 ELSE 0 END),0)                   AS COLUMN1 /*판정*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN AM ELSE 0 END),0)                  AS COLUMN1_AM /*판정_금액*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN CNT ELSE 0 END),0)                  AS COLUMN1_CNT /*판정_인원*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('210') THEN 1 ELSE 0 END),0)                          AS COLUMN2 /*징계*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('210') THEN CNT ELSE 0 END),0)                  		 AS COLUMN2_CNT /*징계_인원*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('310', '320') THEN 1 ELSE 0 END),0) 					 AS COLUMN3 /*시정*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('310', '320') THEN AM ELSE 0 END),0)                  AS COLUMN3_AM /*시정_금액*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('410') THEN 1 ELSE 0 END),0)            			     AS COLUMN4 /*주의*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('410') THEN CNT ELSE 0 END),0)                  		 AS COLUMN4_CNT /*주의_인원*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('510', '520', '530') THEN 1 ELSE 0 END),0)            AS COLUMN5 /*개선*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('611') THEN 1 ELSE 0 END),0)                          AS COLUMN6 /*권고*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('610', '630') THEN 1 ELSE 0 END),0)     				 AS COLUMN7 /*통보*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('620', '621', '623') THEN 1 ELSE 0 END),0)			 AS COLUMN7_1 /*통보(인사자료)*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('810', '820', '830', '840', '850') THEN 1 ELSE 0 END),0) AS COLUMN7_2 /*통보(모범사례)*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('916') THEN 1 ELSE 0 END),0)                          AS COLUMN8 /*불문*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('390', '391') THEN 1 ELSE 0 END),0)                   AS COLUMN9 /*현지시정*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('490') THEN 1 ELSE 0 END),0)                          AS COLUMN10 /*현지주의*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('710', '720') THEN 1 ELSE 0 END),0)                   AS COLUMN11 /*고발*/
					      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('730') THEN 1 ELSE 0 END),0)                          AS COLUMN12 /*수사요청*/
					  FROM DATA
					 GROUP BY HNDL_DPT_CD, CVPT_HNDL_DVSN_CD
		         )T2
		WHERE 	T1.DPT_CD = T2.HNDL_DPT_CD(+)
		AND		T1.CD = T2.CVPT_HNDL_DVSN_CD(+)
		UNION ALL 
		SELECT 	NULL AS DPT_CD
			    ,'전년동기간 증감' AS DPT_NM
			    ,T1.CD
			    ,T1.CD_NM
			    ,NVL(T2.TOTAL, 0) AS TOTAL
			    ,NVL(T2.COLUMN1, 0) AS COLUMN1
			    ,NVL(T2.COLUMN1_AM, 0) AS COLUMN1_AM
			    ,NVL(T2.COLUMN1_CNT, 0) AS COLUMN1_CNT
			    ,NVL(T2.COLUMN2, 0) AS COLUMN2
			    ,NVL(T2.COLUMN2_CNT, 0) AS COLUMN2_CNT
			    ,NVL(T2.COLUMN3, 0) AS COLUMN3
			    ,NVL(T2.COLUMN3_AM, 0) AS COLUMN3_AM
			    ,NVL(T2.COLUMN4, 0) AS COLUMN4
			    ,NVL(T2.COLUMN4_CNT, 0) AS COLUMN4_CNT
			    ,NVL(T2.COLUMN5, 0) AS COLUMN5
			    ,NVL(T2.COLUMN6, 0) AS COLUMN6
			    ,NVL(T2.COLUMN7, 0) AS COLUMN7
			    ,NVL(T2.COLUMN7_1, 0) AS COLUMN7_1
			    ,NVL(T2.COLUMN7_2, 0) AS COLUMN7_2
			    ,NVL(T2.COLUMN8, 0) AS COLUMN8
			    ,NVL(T2.COLUMN9, 0) AS COLUMN9
			    ,NVL(T2.COLUMN10, 0) AS COLUMN10
			    ,NVL(T2.COLUMN11, 0) AS COLUMN11
			    ,NVL(T2.COLUMN12, 0) AS COLUMN12
		FROM 
		(
		       SELECT '10' AS CD
		              ,'직접조사(A)' AS CD_NM
		              , 'A' AS PKKEY
		          FROM DUAL
		        UNION ALL
		        SELECT '20' AS CD
		              ,'위탁조사(B)' AS CD_NM
		              , 'A' AS PKKEY
		          FROM DUAL
		        UNION ALL
		        SELECT '30' AS CD
		              ,'조사종결(C)' AS CD_NM
		              , 'A' AS PKKEY
		          FROM DUAL
		)T1,
		(
		   SELECT S1.PK
		   		 ,S1.CVPT_HNDL_DVSN_CD
		         ,NVL(NVL(S1.TOTAL,0) - NVL(S2.TOTAL,0), 0) AS TOTAL
		         ,NVL(NVL(S1.COLUMN1,0) - NVL(S2.COLUMN1,0), 0) AS COLUMN1
		         ,NVL(NVL(S1.COLUMN1_AM,0) - NVL(S2.COLUMN1_AM,0), 0) AS COLUMN1_AM
		         ,NVL(NVL(S1.COLUMN1_CNT,0) - NVL(S2.COLUMN1_CNT,0), 0) AS COLUMN1_CNT
		         ,NVL(NVL(S1.COLUMN2,0) - NVL(S2.COLUMN2,0), 0) AS COLUMN2
		         ,NVL(NVL(S1.COLUMN2_CNT,0) - NVL(S2.COLUMN2_CNT,0), 0) AS COLUMN2_CNT
		         ,NVL(NVL(S1.COLUMN3,0) - NVL(S2.COLUMN3,0), 0) AS COLUMN3
		         ,NVL(NVL(S1.COLUMN3_AM,0) - NVL(S2.COLUMN3_AM,0), 0) AS COLUMN3_AM
		         ,NVL(NVL(S1.COLUMN4,0) - NVL(S2.COLUMN4,0), 0) AS COLUMN4
		         ,NVL(NVL(S1.COLUMN4_CNT,0) - NVL(S2.COLUMN4_CNT,0), 0) AS COLUMN4_CNT
		         ,NVL(NVL(S1.COLUMN5,0) - NVL(S2.COLUMN5,0), 0) AS COLUMN5
		         ,NVL(NVL(S1.COLUMN6,0) - NVL(S2.COLUMN6,0), 0) AS COLUMN6
		         ,NVL(NVL(S1.COLUMN7,0) - NVL(S2.COLUMN7,0), 0) AS COLUMN7
		         ,NVL(NVL(S1.COLUMN7_1,0) - NVL(S2.COLUMN7_1,0), 0) AS COLUMN7_1
		         ,NVL(NVL(S1.COLUMN7_2,0) - NVL(S2.COLUMN7_2,0), 0) AS COLUMN7_2
		         ,NVL(NVL(S1.COLUMN8,0) - NVL(S2.COLUMN8,0), 0) AS COLUMN8
		         ,NVL(NVL(S1.COLUMN9,0) - NVL(S2.COLUMN9,0), 0) AS COLUMN9
		         ,NVL(NVL(S1.COLUMN10,0) - NVL(S2.COLUMN10,0), 0) AS COLUMN10
		         ,NVL(NVL(S1.COLUMN11,0) - NVL(S2.COLUMN11,0), 0) AS COLUMN11
		         ,NVL(NVL(S1.COLUMN12,0) - NVL(S2.COLUMN12,0), 0) AS COLUMN12
		     FROM
		        (
		        SELECT 'A' AS PK
		              ,CVPT_HNDL_DVSN_CD
		              ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120', '210', '310', '320', '410', '510', '520', '530', '611', '610', '630', '620', '621', '623', '810', '820', '830', '840', '850', '916', '390', '391', '490', '710', '720', '730') THEN 1 ELSE 0 END),0) AS TOTAL /*합계*/
		              ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN 1 ELSE 0 END),0)                   AS COLUMN1 /*판정*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN AM ELSE 0 END),0)                  AS COLUMN1_AM /*판정_금액*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN CNT ELSE 0 END),0)                  AS COLUMN1_CNT /*판정_인원*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('210') THEN 1 ELSE 0 END),0)                          AS COLUMN2 /*징계*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('210') THEN CNT ELSE 0 END),0)                  		 AS COLUMN2_CNT /*징계_인원*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('310', '320') THEN 1 ELSE 0 END),0) 					 AS COLUMN3 /*시정*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('310', '320') THEN AM ELSE 0 END),0)                  AS COLUMN3_AM /*시정_금액*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('410') THEN 1 ELSE 0 END),0)            			     AS COLUMN4 /*주의*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('410') THEN CNT ELSE 0 END),0)                  		 AS COLUMN4_CNT /*주의_인원*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('510', '520', '530') THEN 1 ELSE 0 END),0)            AS COLUMN5 /*개선*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('611') THEN 1 ELSE 0 END),0)                          AS COLUMN6 /*권고*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('610', '630') THEN 1 ELSE 0 END),0)     				 AS COLUMN7 /*통보*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('620', '621', '623') THEN 1 ELSE 0 END),0)			 AS COLUMN7_1 /*통보(인사자료)*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('810', '820', '830', '840', '850') THEN 1 ELSE 0 END),0) AS COLUMN7_2 /*통보(모범사례)*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('916') THEN 1 ELSE 0 END),0)                          AS COLUMN8 /*불문*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('390', '391') THEN 1 ELSE 0 END),0)                   AS COLUMN9 /*현지시정*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('490') THEN 1 ELSE 0 END),0)                          AS COLUMN10 /*현지주의*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('710', '720') THEN 1 ELSE 0 END),0)                   AS COLUMN11 /*고발*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('730') THEN 1 ELSE 0 END),0)                          AS COLUMN12 /*수사요청*/
		          FROM DATA
		          GROUP BY CVPT_HNDL_DVSN_CD
		        )S1,
		        (
		        SELECT 'A' AS PK
		              ,CVPT_HNDL_DVSN_CD
		              ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120', '210', '310', '320', '410', '510', '520', '530', '611', '610', '630', '620', '621', '623', '810', '820', '830', '840', '850', '916', '390', '391', '490', '710', '720', '730') THEN 1 ELSE 0 END),0) AS TOTAL /*합계*/
		              ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN 1 ELSE 0 END),0)                   AS COLUMN1 /*판정*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN AM ELSE 0 END),0)                  AS COLUMN1_AM /*판정_금액*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('110', '120') THEN CNT ELSE 0 END),0)                  AS COLUMN1_CNT /*판정_인원*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('210') THEN 1 ELSE 0 END),0)                          AS COLUMN2 /*징계*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('210') THEN CNT ELSE 0 END),0)                  		 AS COLUMN2_CNT /*징계_인원*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('310', '320') THEN 1 ELSE 0 END),0) 					 AS COLUMN3 /*시정*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('310', '320') THEN AM ELSE 0 END),0)                  AS COLUMN3_AM /*시정_금액*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('410') THEN 1 ELSE 0 END),0)            			     AS COLUMN4 /*주의*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('410') THEN CNT ELSE 0 END),0)                  		 AS COLUMN4_CNT /*주의_인원*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('510', '520', '530') THEN 1 ELSE 0 END),0)            AS COLUMN5 /*개선*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('611') THEN 1 ELSE 0 END),0)                          AS COLUMN6 /*권고*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('610', '630') THEN 1 ELSE 0 END),0)     				 AS COLUMN7 /*통보*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('620', '621', '623') THEN 1 ELSE 0 END),0)			 AS COLUMN7_1 /*통보(인사자료)*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('810', '820', '830', '840', '850') THEN 1 ELSE 0 END),0) AS COLUMN7_2 /*통보(모범사례)*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('916') THEN 1 ELSE 0 END),0)                          AS COLUMN8 /*불문*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('390', '391') THEN 1 ELSE 0 END),0)                   AS COLUMN9 /*현지시정*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('490') THEN 1 ELSE 0 END),0)                          AS COLUMN10 /*현지주의*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('710', '720') THEN 1 ELSE 0 END),0)                   AS COLUMN11 /*고발*/
				      ,NVL(SUM(CASE WHEN DSP_RQ_KND_CD IN ('730') THEN 1 ELSE 0 END),0)                          AS COLUMN12 /*수사요청*/
		          FROM PRE_DATA
		          GROUP BY CVPT_HNDL_DVSN_CD
		          )S2
		     WHERE S1.PK = S2.PK(+)
		)T2
		WHERE T1.CD = T2.CVPT_HNDL_DVSN_CD(+)
	]]>
	</select>
	
	<select id="CSPDCP141QSelect4_1" parameterClass="paramMap"  resultClass="resultMap">
	<![CDATA[
	WITH
	DATA AS
	(
		SELECT D1.CVPT_KND_CD
	          ,D2.CVPT_HNDL_DVSN_CD
	          ,D1.CVPT_HNDL_STA_CD
	          ,D4.CVPT_OPM_APV_HNDL_STA_CD
	      FROM TBCSPDCP101M D1
	          ,(
		      	SELECT	D4.REQ_DVSN_CD
		      			, D4.CVPT_ACP_NO
		      			, D4.ACP_YR
		      			, D4.CVPT_HNDL_DVSN_CD
		      	FROM	TBCSPDCP205L D4
		      	WHERE	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
						SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
						FROM	TBCSPDCP205L
						GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
					)
		       ) D2
	          ,TBCSPDCP201M D3
	          ,TBCSPDCP301M D4 
	     WHERE 1=1
	       AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D2.ACP_YR(+)
	       AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D3.ACP_YR(+)
	       AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D4.ACP_YR(+)
	       AND D4.CVPT_IFM_DVSN_CD(+) = 'C'
	       AND D1.CVPT_HNDL_STA_CD NOT IN ('10')
	       AND D1.RM_CVPT_ACP_NO IS NOT NULL	   
	       AND D1.REQ_DVSN_CD = 1
	       AND D1.CVPT_KND_CD IN (
		   							SELECT 	CD
		   							FROM	TBDCMACM013C
		   							WHERE	CMM_CD_DVSN_CD = '1000047'
		   							AND		CD != '000000000'
		   							AND		USR_DFN_TXT_1 = '2'
		   						)
	]]>
	<dynamic>
		<isEqual property="SEARCHDTKEY" compareValue="1">					  
		  AND TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#
		</isEqual>
		<isEqual property="SEARCHDTKEY" compareValue="2">	
		  AND TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#
		</isEqual>
	</dynamic>
	<![CDATA[
	),
	PRE_DATA AS
	(
		SELECT D1.CVPT_KND_CD
	          ,D2.CVPT_HNDL_DVSN_CD
	          ,D1.CVPT_HNDL_STA_CD
	          ,D4.CVPT_OPM_APV_HNDL_STA_CD
	      FROM TBCSPDCP101M D1
	          ,(
		      	SELECT	D4.REQ_DVSN_CD
		      			, D4.CVPT_ACP_NO
		      			, D4.ACP_YR
		      			, D4.CVPT_HNDL_DVSN_CD
		      	FROM	TBCSPDCP205L D4
		      	WHERE	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
						SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
						FROM	TBCSPDCP205L
						GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
					)
		       ) D2
	          ,TBCSPDCP201M D3
	          ,TBCSPDCP301M D4 
	     WHERE 1=1
	       AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D2.ACP_YR(+)
	       AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D3.ACP_YR(+)
	       AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D4.ACP_YR(+)
	       AND D4.CVPT_IFM_DVSN_CD(+) = 'C'
	       AND D1.REQ_DVSN_CD = 1          
	       AND D1.CVPT_HNDL_STA_CD NOT IN ('10')
	       AND D1.RM_CVPT_ACP_NO IS NOT NULL	   
	       AND D1.CVPT_KND_CD IN (
		   							SELECT 	CD
		   							FROM	TBDCMACM013C
		   							WHERE	CMM_CD_DVSN_CD = '1000047'
		   							AND		CD != '000000000'
		   							AND		USR_DFN_TXT_1 = '2'
		   						)
	]]>
	<dynamic>
		<isEqual property="SEARCHDTKEY" compareValue="1">					  
		  AND TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
		</isEqual>
		<isEqual property="SEARCHDTKEY" compareValue="2">					  
		  AND TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
		</isEqual>
	</dynamic>
	<![CDATA[
		)
		SELECT	NULL AS DPT_CD
				, '합계' AS DPT_NM
				, COUNT(1) AS CNT
		        , CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1)/COUNT(1)) * 100 END AS PER
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT1 /*직접처리*/
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '61') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '61') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT8 /*직접처리-시정*/
				, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '62') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '62') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT9 /*직접처리-해소*/
				, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '63') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '63') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT10 /*직접처리-조사종결*/
				, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '50') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '50') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT11 /*직접처리-대내이송*/
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT2 /*종결*/
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '80') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT3 /*반려*/
		        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '40') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '40') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT6 /*이송대외*/
		        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT12 /*재분류*/
		        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('10','60','70','80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT7 /*처리중*/
		FROM	DATA
		
		UNION ALL
		
		SELECT	D3.CD
				, D3.CD_NM
				, NVL(D4.CNT, 0) AS CNT
		        , CASE WHEN D4.CNTALL = 0 THEN 0 ELSE NVL(ROUND((D4.CNT/D4.CNTALL) * 100,2), 0) END AS PER
		        , NVL(D4.CVPT_HNDL_DVSN_CNT1, 0) AS CVPT_HNDL_DVSN_CNT1
		        , NVL(D4.CVPT_HNDL_DVSN_CNT8, 0) AS CVPT_HNDL_DVSN_CNT8
		        , NVL(D4.CVPT_HNDL_DVSN_CNT9, 0) AS CVPT_HNDL_DVSN_CNT9
		        , NVL(D4.CVPT_HNDL_DVSN_CNT10, 0) AS CVPT_HNDL_DVSN_CNT10
		        , NVL(D4.CVPT_HNDL_DVSN_CNT11, 0) AS CVPT_HNDL_DVSN_CNT11
		        , NVL(D4.CVPT_HNDL_DVSN_CNT2, 0) AS CVPT_HNDL_DVSN_CNT2
		        , NVL(D4.CVPT_HNDL_DVSN_CNT3, 0) AS CVPT_HNDL_DVSN_CNT3
		        , NVL(D4.CVPT_HNDL_DVSN_CNT6, 0) AS CVPT_HNDL_DVSN_CNT6
		        , NVL(D4.CVPT_HNDL_DVSN_CNT12, 0) AS CVPT_HNDL_DVSN_CNT12
		        , NVL(D4.CVPT_HNDL_DVSN_CNT7, 0) AS CVPT_HNDL_DVSN_CNT7
		FROM	(
					SELECT	CD
		                  , CD_NM
		            FROM	TBDCMACM013C D2
		            WHERE	D2.CMM_CD_DVSN_CD = '1000047'
		            AND		D2.CD = '카'
		            ORDER BY OTPT_SEQ
				) D3,
				(
					SELECT	D1.CVPT_KND_CD 
							, COUNT(1) AS CNT
		                    , (SELECT COUNT(1) FROM DATA S1 WHERE 1=1) AS CNTALL
		                    , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT1 /*직접처리*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '61') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '61') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT8 /*직접처리-시정*/
							, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '62') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '62') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT9 /*직접처리-해소*/
							, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '63') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '63') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT10 /*직접처리-조사종결*/
							, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '50') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '50') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT11 /*직접처리-대내이송*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT2 /*종결*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '80') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT3 /*반려*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '40') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '40') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT6 /*이송대외*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT12 /*재분류*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('10','60','70','80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT7 /*처리중*/
					FROM	DATA D1
					GROUP BY D1.CVPT_KND_CD
				) D4
		WHERE	D3.CD = D4.CVPT_KND_CD(+)
		
		UNION ALL
		
		SELECT	NULL AS CD_CD
				, '전년 동기간 증감' AS DPT_NM
				, D5.CNT-D6.CNT AS CNT
		        , NVL(D5.PER-D6.PER, 0) AS PER
		        , D5.CVPT_HNDL_DVSN_CNT1-D6.CVPT_HNDL_DVSN_CNT1 AS CVPT_HNDL_DVSN_CNT1
		        , D5.CVPT_HNDL_DVSN_CNT8-D6.CVPT_HNDL_DVSN_CNT8 AS CVPT_HNDL_DVSN_CNT8
		        , D5.CVPT_HNDL_DVSN_CNT9-D6.CVPT_HNDL_DVSN_CNT9 AS CVPT_HNDL_DVSN_CNT9
		        , D5.CVPT_HNDL_DVSN_CNT10-D6.CVPT_HNDL_DVSN_CNT10 AS CVPT_HNDL_DVSN_CNT10
		        , D5.CVPT_HNDL_DVSN_CNT11-D6.CVPT_HNDL_DVSN_CNT11 AS CVPT_HNDL_DVSN_CNT11
		        , D5.CVPT_HNDL_DVSN_CNT2-D6.CVPT_HNDL_DVSN_CNT2 AS CVPT_HNDL_DVSN_CNT2
		        , D5.CVPT_HNDL_DVSN_CNT3-D6.CVPT_HNDL_DVSN_CNT3 AS CVPT_HNDL_DVSN_CNT3
		        , D5.CVPT_HNDL_DVSN_CNT6-D6.CVPT_HNDL_DVSN_CNT6 AS CVPT_HNDL_DVSN_CNT6
		        , D5.CVPT_HNDL_DVSN_CNT12-D6.CVPT_HNDL_DVSN_CNT12 AS CVPT_HNDL_DVSN_CNT12
		        , D5.CVPT_HNDL_DVSN_CNT7-D6.CVPT_HNDL_DVSN_CNT7 AS CVPT_HNDL_DVSN_CNT7
		FROM	(
					SELECT	'A' AS PK
							, COUNT(1) AS CNT
		                    , (CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END) AS PER
		                    , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT1 /*직접처리*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '61') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '61') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT8 /*직접처리-시정*/
							, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '62') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '62') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT9 /*직접처리-해소*/
							, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '63') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '63') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT10 /*직접처리-조사종결*/
							, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '50') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '50') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT11 /*직접처리-대내이송*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT2 /*종결*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '80') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT3 /*반려*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '40') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '40') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT6 /*이송대외*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT12 /*재분류*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('10','60','70','80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT7 /*처리중*/
		
					FROM	DATA
				) D5
				, (
					SELECT	'A' AS PK
							, COUNT(1) AS CNT
		                    , (CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END)  AS PER
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '61', '62', '63', '50')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT1 /*직접처리*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '61') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '61') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT8 /*직접처리-시정*/
							, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '62') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '62') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT9 /*직접처리-해소*/
							, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '63') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '63') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT10 /*직접처리-조사종결*/
							, NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '50') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '50') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT11 /*직접처리-대내이송*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '70') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT2 /*종결*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '80') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT3 /*반려*/
					        , NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '40') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '40') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT6 /*이송대외*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT12 /*재분류*/
					        , NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('10','60','70','80') THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT7 /*처리중*/
					FROM	PRE_DATA
				) D6
		WHERE	D5.PK = D6.PK(+)
	]]>
	</select>
	
	<select id="CSPDCP141QSelect4_2" parameterClass="paramMap"  resultClass="resultMap">
	<![CDATA[
    WITH
	DATA AS
	(
		SELECT D1.CVPT_KND_CD
	          ,D2.CVPT_HNDL_DVSN_CD
	          ,D1.CVPT_HNDL_STA_CD
	          ,D4.CVPT_OPM_APV_HNDL_STA_CD
	      FROM TBCSPDCP101M D1
	          ,(
		      	SELECT	D4.REQ_DVSN_CD
		      			, D4.CVPT_ACP_NO
		      			, D4.ACP_YR
		      			, D4.CVPT_HNDL_DVSN_CD
		      	FROM	TBCSPDCP205L D4
		      	WHERE	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
						SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
						FROM	TBCSPDCP205L
						GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
					)
		       ) D2
	          ,TBCSPDCP201M D3
	          ,TBCSPDCP301M D4 
	     WHERE 1=1
	       AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D2.ACP_YR(+)
	       AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D3.ACP_YR(+)
	       AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D4.ACP_YR(+)
	       AND D4.CVPT_IFM_DVSN_CD(+) = 'C'
	       AND D1.REQ_DVSN_CD = 1          
	       AND D1.CVPT_HNDL_STA_CD NOT IN ('10')
	       AND D1.RM_CVPT_ACP_NO IS NOT NULL	
	       AND D1.CVPT_KND_CD IN (
		   							SELECT 	CD
		   							FROM	TBDCMACM013C
		   							WHERE	CMM_CD_DVSN_CD = '1000047'
		   							AND		CD != '000000000'
		   							AND		USR_DFN_TXT_1 = '1'
		   						)
	]]>
	<dynamic>
		<isEqual property="SEARCHDTKEY" compareValue="1">					  
		  AND TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#
		</isEqual>
		<isEqual property="SEARCHDTKEY" compareValue="2">	
		  AND TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN #STARTDT# AND #ENDDT#
		</isEqual>
	</dynamic>
	<![CDATA[
	),
	PRE_DATA AS
	(
		SELECT D1.CVPT_KND_CD
	          ,D2.CVPT_HNDL_DVSN_CD
	          ,D1.CVPT_HNDL_STA_CD
	          ,D4.CVPT_OPM_APV_HNDL_STA_CD
	      FROM TBCSPDCP101M D1
	          ,(
		      	SELECT	D4.REQ_DVSN_CD
		      			, D4.CVPT_ACP_NO
		      			, D4.ACP_YR
		      			, D4.CVPT_HNDL_DVSN_CD
		      	FROM	TBCSPDCP205L D4
		      	WHERE	( D4.REQ_DVSN_CD, D4.ACP_YR, D4.CVPT_ACP_NO, D4.SRNO ) IN (
						SELECT	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO, MIN(SRNO)
						FROM	TBCSPDCP205L
						GROUP BY REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
					)
		       ) D2
	          ,TBCSPDCP201M D3
	          ,TBCSPDCP301M D4 
	     WHERE 1=1
	       AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D2.ACP_YR(+)
	       AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D3.ACP_YR(+)
	       AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD(+)
	       AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO(+)
	       AND D1.ACP_YR      = D4.ACP_YR(+)
	       AND D4.CVPT_IFM_DVSN_CD(+) = 'C'
	       AND D1.REQ_DVSN_CD = 1          
	       AND D1.CVPT_HNDL_STA_CD NOT IN ('10')
	       AND D1.RM_CVPT_ACP_NO IS NOT NULL	   
	       AND D1.CVPT_KND_CD IN (
		   							SELECT 	CD
		   							FROM	TBDCMACM013C
		   							WHERE	CMM_CD_DVSN_CD = '1000047'
		   							AND		CD != '000000000'
		   							AND		USR_DFN_TXT_1 = '1'
		   						)
	]]>
	<dynamic>
		<isEqual property="SEARCHDTKEY" compareValue="1">					  
		  AND TO_CHAR(D1.ACP_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
		</isEqual>
		<isEqual property="SEARCHDTKEY" compareValue="2">					  
		  AND TO_CHAR(D3.FNL_HNDL_DH, 'YYYYMMDD') BETWEEN TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#STARTDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD') AND TO_CHAR(TRUNC(ADD_MONTHS(TO_DATE(#ENDDT#, 'YYYYMMDD'), -12),'dd'), 'YYYYMMDD')
		</isEqual>
	</dynamic>
	<![CDATA[
	)
	SELECT	NULL AS DPT_CD
			, '합계' AS DPT_NM
			, COUNT(1) AS CNT
	        , (CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1)/COUNT(1)) * 100 END ) AS PER,
	        NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN ( '11', '12','13', '14' )) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '11', '12','13', '14'))  THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1 /*직접조사-소계*/,
	       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '11') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '11') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_1 /*직접조사-즉시시정*/,
	       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '12') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '12') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_2 /*직접조사-즉시해소*/,
	       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_3 /*직접조사-즉시종결*/,
	       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '14') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '14') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_4 /*직접조사-실지감사*/,
	       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '20') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '20') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT2 /*위탁조사*/,
	       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '30') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '30') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT3 /*감사참고자료*/,
	       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT5, /*재분류*/
	       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT4 /*처리중*/
	FROM	DATA
	
	UNION ALL
	
	SELECT	D3.CD
			, D3.CD_NM
			, NVL(D4.CNT, 0) AS CNT
	        , (CASE WHEN D4.CNTALL = 0 THEN 0 ELSE NVL(ROUND((D4.CNT/D4.CNTALL) * 100,2), 0) END) AS PER
	        , NVL(D4.CVPT_HNDL_DVSN_CNT1, 0) AS CVPT_HNDL_DVSN_CNT1
			, NVL(D4.CVPT_HNDL_DVSN_CNT1_1, 0) AS CVPT_HNDL_DVSN_CNT1_1
			, NVL(D4.CVPT_HNDL_DVSN_CNT1_2, 0) AS CVPT_HNDL_DVSN_CNT1_2
			, NVL(D4.CVPT_HNDL_DVSN_CNT1_3, 0) AS CVPT_HNDL_DVSN_CNT1_3
			, NVL(D4.CVPT_HNDL_DVSN_CNT1_4, 0) AS CVPT_HNDL_DVSN_CNT1_4
			, NVL(D4.CVPT_HNDL_DVSN_CNT2, 0) AS CVPT_HNDL_DVSN_CNT2
			, NVL(D4.CVPT_HNDL_DVSN_CNT3, 0) AS CVPT_HNDL_DVSN_CNT3
			, NVL(D4.CVPT_HNDL_DVSN_CNT5, 0) AS CVPT_HNDL_DVSN_CNT5
			, NVL(D4.CVPT_HNDL_DVSN_CNT4, 0) AS CVPT_HNDL_DVSN_CNT4
	FROM	(
				SELECT	CD
	                  , CD_NM
	            FROM	TBDCMACM013C D2
	            WHERE	D2.CMM_CD_DVSN_CD = '1000047'
	            AND		D2.CD != '000000000'
	            AND		D2.CD != '카'
	            ORDER BY OTPT_SEQ
			) D3,
			(
				SELECT	D1.CVPT_KND_CD 
						, COUNT(1) AS CNT
	                    , (SELECT COUNT(1) FROM DATA S1 WHERE 1=1) AS CNTALL,
	                    NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN ( '11', '12','13', '14' )) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '11', '12','13', '14'))  THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1 /*직접조사-소계*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '11') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '11') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_1 /*직접조사-즉시시정*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '12') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '12') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_2 /*직접조사-즉시해소*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_3 /*직접조사-즉시종결*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '14') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '14') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_4 /*직접조사-실지감사*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '20') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '20') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT2 /*위탁조사*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '30') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '30') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT3 /*감사참고자료*/,
		       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT5, /*재분류*/
		       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT4 /*처리중*/
				FROM	DATA D1
				GROUP BY D1.CVPT_KND_CD
			) D4
	WHERE	D3.CD = D4.CVPT_KND_CD(+)
	
	UNION ALL
	
	SELECT	NULL AS CD_CD
			, '전년 동기간 증감' AS DPT_NM
			, D5.CNT-D6.CNT AS CNT
	        , NVL(D5.PER-D6.PER, 0) AS PER
	        , D5.CVPT_HNDL_DVSN_CNT1-D6.CVPT_HNDL_DVSN_CNT1 AS CVPT_HNDL_DVSN_CNT1
			, D5.CVPT_HNDL_DVSN_CNT1_1-D6.CVPT_HNDL_DVSN_CNT1_1 AS CVPT_HNDL_DVSN_CNT1_1
			, D5.CVPT_HNDL_DVSN_CNT1_2-D6.CVPT_HNDL_DVSN_CNT1_2 AS CVPT_HNDL_DVSN_CNT1_2
			, D5.CVPT_HNDL_DVSN_CNT1_3-D6.CVPT_HNDL_DVSN_CNT1_3 AS CVPT_HNDL_DVSN_CNT1_3
			, D5.CVPT_HNDL_DVSN_CNT1_4-D6.CVPT_HNDL_DVSN_CNT1_4 AS CVPT_HNDL_DVSN_CNT1_4
			, D5.CVPT_HNDL_DVSN_CNT2-D6.CVPT_HNDL_DVSN_CNT2 AS CVPT_HNDL_DVSN_CNT2
			, D5.CVPT_HNDL_DVSN_CNT3-D6.CVPT_HNDL_DVSN_CNT3 AS CVPT_HNDL_DVSN_CNT3
			, D5.CVPT_HNDL_DVSN_CNT5-D6.CVPT_HNDL_DVSN_CNT5 AS CVPT_HNDL_DVSN_CNT5
			, D5.CVPT_HNDL_DVSN_CNT4-D6.CVPT_HNDL_DVSN_CNT4 AS CVPT_HNDL_DVSN_CNT4
	FROM	(
				SELECT	'A' AS PK
						, COUNT(1) AS CNT
	                    , (CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END) AS PER,
	                    NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN ( '11', '12','13', '14' )) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '11', '12','13', '14'))  THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1 /*직접조사-소계*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '11') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '11') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_1 /*직접조사-즉시시정*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '12') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '12') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_2 /*직접조사-즉시해소*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_3 /*직접조사-즉시종결*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '14') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '14') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_4 /*직접조사-실지감사*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '20') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '20') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT2 /*위탁조사*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '30') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '30') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT3 /*감사참고자료*/,
		       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT5, /*재분류*/
		       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT4 /*처리중*/
	
				FROM	DATA
			) D5
			, (
				SELECT	'A' AS PK
						, COUNT(1) AS CNT
	                    , (CASE WHEN COUNT(1) = 0 THEN 0 ELSE (COUNT(1) / COUNT(1)) * 100 END) AS PER,
				        NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD IN ( '11', '12','13', '14' )) OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD IN( '11', '12','13', '14'))  THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1 /*직접조사-소계*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '11') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '11') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_1 /*직접조사-즉시시정*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '12') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '12') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_2 /*직접조사-즉시해소*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '13') OR (CVPT_HNDL_STA_CD = '70' AND (CVPT_OPM_APV_HNDL_STA_CD IS NULL OR CVPT_OPM_APV_HNDL_STA_CD != '30')) THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_3 /*직접조사-즉시종결*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '14') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '14') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT1_4 /*직접조사-실지감사*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '20') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '20') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT2 /*위탁조사*/,
		       NVL(SUM(CASE WHEN (CVPT_HNDL_STA_CD = '60' AND CVPT_HNDL_DVSN_CD = '30') OR (CVPT_HNDL_STA_CD = '70' AND CVPT_OPM_APV_HNDL_STA_CD = '30' AND CVPT_HNDL_DVSN_CD = '30') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT3 /*감사참고자료*/,
		       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD = '80' THEN 1 ELSE 0 END),0) AS CVPT_HNDL_DVSN_CNT5, /*재분류*/
		       NVL(SUM(CASE WHEN CVPT_HNDL_STA_CD NOT IN ('60','70','10','80') THEN 1 ELSE 0 END), 0) AS CVPT_HNDL_DVSN_CNT4 /*처리중*/
				FROM	PRE_DATA
			) D6
	WHERE	D5.PK = D6.PK(+)
	]]>
	</select>
	
	<select id="CSPDCP411ReportCSPDCP1415RSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		WITH /* CSPDCP411ReportCSPDCP1415RSelect */
		RCP_DATA AS
		(
			SELECT	D1.REQ_DVSN_CD
					, D1.ACP_YR
					, D1.CVPT_ACP_NO
					, D1.CVPT_HNDL_STA_CD
					, ROUND(SYSDATE - D1.ACP_DH) AS TERM
					, (
						SELECT	USR_DFN_TXT_1
						FROM	TBDCMACM013C D3
						WHERE	D3.CMM_CD_DVSN_CD = '1000047'
						AND		D3.CD = D1.CVPT_KND_CD
					) AS CVPT_KND_DVSN_CD
					, DECODE( D1.CVPT_HNDL_STA_CD, '20', D1.ACP_DPT_CD, D2.HNDL_DPT_CD ) AS DPT_CD
			FROM	TBCSPDCP101M D1
					, TBCSPDCP201M D2
			WHERE	D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
			AND		D1.ACP_YR = D2.ACP_YR(+)
			AND		D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
			AND		D1.REQ_DVSN_CD = '1'
			AND		D1.CVPT_HNDL_STA_CD NOT IN ( '10', '20', '21', '30', '60', '70' )	/* 처리중인 것만 계산 */
	]]>
		<dynamic>
			<isEqual property="SEARCHDTKEY" compareValue="1">					  
		    AND		D1.ACP_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		    <isEqual property="SEARCHDTKEY" compareValue="2">	
		    AND		D2.FNL_HNDL_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		</dynamic>
	<![CDATA[
		)
		SELECT	'합계' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		
		UNION ALL
		
		SELECT	'10일 이하 경과' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		WHERE	D5.TERM <= 10
		
		UNION ALL
		
		SELECT	'11일 이상 30일 이하 경과' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		WHERE	D5.TERM BETWEEN 11 AND 30
		
		UNION ALL
		
		SELECT	'31일 이상 60일 이하 경과' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		WHERE	D5.TERM BETWEEN 31 AND 60
		
		UNION ALL
		
		SELECT	'61일 이상 90일 이하 경과' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		WHERE	D5.TERM BETWEEN 61 AND 90
		
		UNION ALL
		
		SELECT	'91일 이상 120일 이하 경과' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		WHERE	D5.TERM BETWEEN 91 AND 120
		
		UNION ALL
		
		SELECT	'121일 이상 150일 이하 경과' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		WHERE	D5.TERM BETWEEN 121 AND 150
		
		UNION ALL
		
		SELECT	'151일 이상 180일 이하 경과' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		WHERE	D5.TERM BETWEEN 151 AND 180
		
		UNION ALL
		
		SELECT	'181일 이상 1년 이하 경과' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		WHERE	D5.TERM BETWEEN 181 AND 365
		
		UNION ALL
		
		SELECT	'1년 초과 경과' AS GUBUN
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' THEN 1 ELSE 0 END),0) AS AUD_080110_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080110_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071100' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080110_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' THEN 1 ELSE 0 END),0) AS AUD_080200_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080200_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071110' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080200_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' THEN 1 ELSE 0 END),0) AS AUD_080210_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080210_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071300' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080210_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' THEN 1 ELSE 0 END),0) AS AUD_080180_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080180_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071130' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080180_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' THEN 1 ELSE 0 END),0) AS AUD_080190_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080190_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071120' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080190_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' THEN 1 ELSE 0 END),0) AS AUD_080220_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080220_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071140' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080220_2_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' THEN 1 ELSE 0 END),0) AS AUD_080170_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_080170_1_CNT
				, NVL(SUM(CASE WHEN D5.DPT_CD = '071200' AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS AUD_080170_2_CNT
		FROM	RCP_DATA D5
		WHERE	D5.TERM > 365
	]]>
	</select>
	
	<select id="CSPDCP411ReportCSPDCP1416RSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		SELECT	/* CSPDCP411ReportCSPDCP1416RSelect */
				D4.DPT_CD
				, D6.DPT_NM
				, D4.USR_ID
				, D5.USR_NAM
				, D4.CVPT_KND_DVSN_CD
				, ( SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000599' AND CD = D4.CVPT_KND_DVSN_CD ) AS CVPT_KND_DVSN_CD_NM
				, D4.ACP_DT
				, D4.REQ_DVSN_CD
				, D4.CVPT_ACP_NO
				, D4.CVPT_HNDL_STA_CD
				, ( SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000051' AND CD = D4.CVPT_HNDL_DVSN_CD ) AS CVPT_HNDL_DVSN_CD_NM
				, D4.TERM
				, D4.TIT_NM
		FROM	(
					SELECT	DECODE( D1.CVPT_HNDL_STA_CD, '20', D1.ACP_DPT_CD, D2.HNDL_DPT_CD ) AS DPT_CD
							, DECODE( D1.CVPT_HNDL_STA_CD, '20', D1.RCEP_ID, D2.HNDL_CHGR_ID ) AS USR_ID
							, (
								SELECT	USR_DFN_TXT_1
								FROM	TBDCMACM013C D3
								WHERE	D3.CMM_CD_DVSN_CD = '1000047'
								AND		D3.CD = D1.CVPT_KND_CD
							) AS CVPT_KND_DVSN_CD
							, TO_CHAR(D1.ACP_DH, 'YYYYMMDD') AS ACP_DT
							, D1.REQ_DVSN_CD
							, D1.ACP_YR || '-민원-' || LPAD(D1.RM_CVPT_ACP_NO, 5, '0') AS CVPT_ACP_NO
							, D1.CVPT_HNDL_STA_CD
							, D3.CVPT_HNDL_DVSN_CD
							, ROUND(SYSDATE - D1.ACP_DH) AS TERM
							, D1.TIT_NM
					FROM	TBCSPDCP101M D1
							, TBCSPDCP201M D2
							, TBCSPDCP205L D3
					WHERE	D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
					AND		D1.ACP_YR = D2.ACP_YR(+)
					AND		D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
					AND		D2.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
					AND		D2.ACP_YR = D3.ACP_YR(+)
					AND		D2.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
					AND		1 = D3.SRNO(+)
					AND		D1.REQ_DVSN_CD = '1'
					AND		D1.CVPT_HNDL_STA_CD NOT IN ( '10', '20', '21', '30', '60', '70' )	/* 처리중인 것만 계산 */
	]]>
		<dynamic>
			<isEqual property="SEARCHDTKEY" compareValue="1">					  
		    		AND		D1.ACP_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		    <isEqual property="SEARCHDTKEY" compareValue="2">	
		    		AND		D2.FNL_HNDL_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		</dynamic>
	<![CDATA[
				) D4
				, TBDCMACM001M D5
				, TBDCMACM002M D6
		WHERE	D4.DPT_CD = D6.DPT_CD
		AND		D4.USR_ID = D5.USR_ID
		ORDER BY DPT_CD, USR_NAM
	]]>
	</select>
	
	<select id="CSPDCP411ReportCSPDCP1417RNoChgrTotalSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		WITH /* CSPDCP411ReportCSPDCP1417RNoChgrTotalSelect */
		RCP_DATA AS
		(
			SELECT	D1.REQ_DVSN_CD
					, D1.ACP_YR
					, D1.CVPT_ACP_NO
					, D1.CVPT_HNDL_STA_CD
					, ROUND(SYSDATE - D1.ACP_DH) AS TERM
					, (
						SELECT	USR_DFN_TXT_1
						FROM	TBDCMACM013C D3
						WHERE	D3.CMM_CD_DVSN_CD = '1000047'
						AND		D3.CD = D1.CVPT_KND_CD
					) AS CVPT_KND_DVSN_CD
					, D2.HNDL_CHGR_ID
			FROM	TBCSPDCP101M D1
					, TBCSPDCP201M D2
			WHERE	D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
			AND		D1.ACP_YR = D2.ACP_YR(+)
			AND		D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
			AND		D1.REQ_DVSN_CD = '1'
			AND		D1.CVPT_HNDL_STA_CD IN ( '20', '30' )	/* 신청, 접수, 배부중(담당자 없는것) 인 것만 계산 */
			AND		D2.HNDL_CHGR_ID IS NULL
	]]>
		<dynamic>
			<isEqual property="SEARCHDTKEY" compareValue="1">					  
		    AND		D1.ACP_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		    <isEqual property="SEARCHDTKEY" compareValue="2">	
		    AND		D2.FNL_HNDL_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		</dynamic>
	<![CDATA[
		)
		SELECT	COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.TERM <= 3 THEN 1 ELSE 0 END),0) AS TOT_3_CNT
				, NVL(SUM(CASE WHEN D5.TERM <= 3 AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_3_CNT
				, NVL(SUM(CASE WHEN D5.TERM <= 3 AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS GE_3_CNT
				, NVL(SUM(CASE WHEN D5.TERM >= 4 THEN 1 ELSE 0 END),0) AS TOT_4_CNT
				, NVL(SUM(CASE WHEN D5.TERM >= 4 AND D5.CVPT_KND_DVSN_CD = '1' THEN 1 ELSE 0 END),0) AS AUD_4_CNT
				, NVL(SUM(CASE WHEN D5.TERM >= 4 AND D5.CVPT_KND_DVSN_CD = '2' THEN 1 ELSE 0 END),0) AS GE_4_CNT
		FROM	RCP_DATA D5
	]]>
	</select>
	
	<select id="CSPDCP411ReportCSPDCP1417RCmplTotalSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		WITH /* CSPDCP411ReportCSPDCP1417RCmplTotalSelect */
		RCP_DATA AS
		(
			SELECT	D1.REQ_DVSN_CD
					, D1.ACP_YR
					, D1.CVPT_ACP_NO
					, D1.CVPT_HNDL_STA_CD
					, (
						SELECT	USR_DFN_TXT_1
						FROM	TBDCMACM013C D3
						WHERE	D3.CMM_CD_DVSN_CD = '1000047'
						AND		D3.CD = D1.CVPT_KND_CD
					) AS CVPT_KND_DVSN_CD
					, D2.HNDL_CHGR_ID
			FROM	TBCSPDCP101M D1
					, TBCSPDCP201M D2
			WHERE	D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
			AND		D1.ACP_YR = D2.ACP_YR(+)
			AND		D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
			AND		D1.REQ_DVSN_CD = '1'
			AND		D1.CVPT_HNDL_STA_CD IN ( '30', '40', '41', '50', '60', '70' )	/* 처리중, 시행문작성중, 조사결과, 처리완료 중 담당자가 있는 것만 계산 */
			AND		D2.HNDL_CHGR_ID IS NOT NULL
	]]>
		<dynamic>
			<isEqual property="SEARCHDTKEY" compareValue="1">					  
		    AND		D1.ACP_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		    <isEqual property="SEARCHDTKEY" compareValue="2">	
		    AND		D2.FNL_HNDL_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		</dynamic>
	<![CDATA[
		)
		SELECT	NULL AS HNDL_CHGR_ID
				, '합계' AS HNDL_CHGR_NM
				, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
				, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
				, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD NOT IN ('60','70') THEN 1 ELSE 0 END),0) AS TOT_ING_CNT
				, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD NOT IN ('60','70') AND D5.CVPT_KND_DVSN_CD = 1 THEN 1 ELSE 0 END),0) AS TOT_ING_1_CNT
				, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD NOT IN ('60','70') AND D5.CVPT_KND_DVSN_CD = 2 THEN 1 ELSE 0 END),0) AS TOT_ING_2_CNT
				, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD IN ('60','70') THEN 1 ELSE 0 END),0) AS TOT_CMP_CNT
				, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD IN ('60','70') AND D5.CVPT_KND_DVSN_CD = 1 THEN 1 ELSE 0 END),0) AS TOT_CMP_1_CNT
				, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD IN ('60','70') AND D5.CVPT_KND_DVSN_CD = 2 THEN 1 ELSE 0 END),0) AS TOT_CMP_2_CNT
				, 1 AS ORD
		FROM	RCP_DATA D5
		
		UNION ALL
		
		SELECT	D6.HNDL_CHGR_ID
				, D7.USR_NAM AS HNDL_CHGR_NM
				, D6.TOT_CNT
				, D6.TOT_AUD_CNT
				, D6.TOT_GE_CNT
				, D6.TOT_ING_CNT
				, D6.TOT_ING_1_CNT
				, D6.TOT_ING_2_CNT
				, D6.TOT_CMP_CNT
				, D6.TOT_CMP_1_CNT
				, D6.TOT_CMP_2_CNT
				, D6.ORD
		FROM	(
					SELECT	D5.HNDL_CHGR_ID
							, COUNT(D5.CVPT_ACP_NO) AS TOT_CNT
							, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '1', 1, 0)),0) AS TOT_AUD_CNT
							, NVL(SUM(DECODE(D5.CVPT_KND_DVSN_CD, '2', 1, 0)),0) AS TOT_GE_CNT
							, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD NOT IN ('60','70') THEN 1 ELSE 0 END),0) AS TOT_ING_CNT
							, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD NOT IN ('60','70') AND D5.CVPT_KND_DVSN_CD = 1 THEN 1 ELSE 0 END),0) AS TOT_ING_1_CNT
							, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD NOT IN ('60','70') AND D5.CVPT_KND_DVSN_CD = 2 THEN 1 ELSE 0 END),0) AS TOT_ING_2_CNT
							, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD IN ('60','70') THEN 1 ELSE 0 END),0) AS TOT_CMP_CNT
							, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD IN ('60','70') AND D5.CVPT_KND_DVSN_CD = 1 THEN 1 ELSE 0 END),0) AS TOT_CMP_1_CNT
							, NVL(SUM(CASE WHEN D5.CVPT_HNDL_STA_CD IN ('60','70') AND D5.CVPT_KND_DVSN_CD = 2 THEN 1 ELSE 0 END),0) AS TOT_CMP_2_CNT
							, 2 AS ORD
					FROM	RCP_DATA D5
					GROUP BY D5.HNDL_CHGR_ID
				) D6
				, TBDCMACM001M D7
		WHERE	D6.HNDL_CHGR_ID = D7.USR_ID
		ORDER BY ORD, HNDL_CHGR_NM
	]]>
	</select>
	
	<select id="CSPDCP411ReportCSPDCP1418RSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		SELECT	/* CSPDCP411ReportCSPDCP1418RSelect */
				D4.USR_ID
				, D5.USR_NAM
				, D4.CVPT_KND_DVSN_CD
				, ( SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000599' AND CD = D4.CVPT_KND_DVSN_CD ) AS CVPT_KND_DVSN_CD_NM
				, D4.ACP_RUT_CD
				, ( SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000056' AND CD = D4.ACP_RUT_CD ) AS ACP_RUT_CD_NM
				, D4.CVPT_ACP_NO
				, D4.ACP_DT
				, ( SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000361' AND CD = D4.CVPT_HNDL_STA_CD ) AS CVPT_HNDL_STA_CD_NM
				, D4.CVPT_HNDL_STA_CD
				, D4.CVPTR_NM
				, D4.ORG_NM
				, D4.TIT_NM
		FROM	(
					SELECT	DECODE( D1.CVPT_HNDL_STA_CD, '20', D1.ACP_DPT_CD, D2.HNDL_DPT_CD ) AS DPT_CD
							, DECODE( D1.CVPT_HNDL_STA_CD, '20', D1.RCEP_ID, D2.HNDL_CHGR_ID ) AS USR_ID
							, (
								SELECT	USR_DFN_TXT_1
								FROM	TBDCMACM013C D3
								WHERE	D3.CMM_CD_DVSN_CD = '1000047'
								AND		D3.CD = D1.CVPT_KND_CD
							) AS CVPT_KND_DVSN_CD
							, TO_CHAR(D1.ACP_DH, 'YYYYMMDD') AS ACP_DT
							, D1.ACP_YR || '-민원-' || LPAD(D1.RM_CVPT_ACP_NO, 5, '0') AS CVPT_ACP_NO
							, D1.CVPT_HNDL_STA_CD
							, D3.CVPT_HNDL_DVSN_CD
							, D7.ORG_NM
							, D1.TIT_NM
							, D1.ACP_RUT_CD
							, D1.REQR_KND_CD
							, (
								CASE
									WHEN D1.REQR_KND_CD IN ('1', '4')
									THEN D1.CVPTR_NM
									ELSE D1.RPST_PEN_NM
								END
							) AS CVPTR_NM
					FROM	TBCSPDCP101M D1
							, TBCSPDCP201M D2
							, TBCSPDCP205L D3
							, (
								SELECT	D5.REQ_DVSN_CD
										, D5.ACP_YR
										, D5.CVPT_ACP_NO
										, AGGR_CONCAT( DECODE(D5.OGN_ORG_DVSN_CD,'10',D6.ORG_NM,'20',D5.ORG_NM), ', ') AS ORG_NM
								FROM	TBCSPDCP206L D5
										, TBDCMACM015M D6
								WHERE	D5.ORG_CD = D6.ORG_CD
								AND		D5.ORG_HIS_DVSN_CD = '1'
								GROUP BY D5.REQ_DVSN_CD, D5.ACP_YR, D5.CVPT_ACP_NO
							) D7
					WHERE	D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
					AND		D1.ACP_YR = D2.ACP_YR(+)
					AND		D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
					AND		D2.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
					AND		D2.ACP_YR = D3.ACP_YR(+)
					AND		D2.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
					AND		1 = D3.SRNO(+)
					AND		D1.REQ_DVSN_CD = D7.REQ_DVSN_CD(+)
					AND		D1.ACP_YR = D7.ACP_YR(+)
					AND		D1.CVPT_ACP_NO = D7.CVPT_ACP_NO(+)
					AND		D1.REQ_DVSN_CD = '1'
					AND		D1.CVPT_HNDL_STA_CD IN ( '30', '40', '41', '50', '60' ,'70')	/* 처리중, 시행문작성중, 조사결과, 처리완료 중 담당자가 있는 것만 계산 */
	]]>
		<dynamic>
			<isEqual property="SEARCHDTKEY" compareValue="1">					  
		    		AND		D1.ACP_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		    <isEqual property="SEARCHDTKEY" compareValue="2">	
		    		AND		D2.FNL_HNDL_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		</dynamic>
	<![CDATA[
				) D4
				, TBDCMACM001M D5
		WHERE	D4.USR_ID = D5.USR_ID
		ORDER BY  USR_NAM
	]]>
	</select>
	
	
	<select id="CSPDCP411ReportselectGridList" parameterClass="paramMap" resultClass="resultMap">
	<include refid = "include.pageSelct"/>
	<![CDATA[
		SELECT	/* CSPDCP411ReportCSPDCP1418RSelect */
				D4.USR_ID
				, D5.USR_NAM
				, D4.CVPT_KND_DVSN_CD
				, ( SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000599' AND CD = D4.CVPT_KND_DVSN_CD ) AS CVPT_KND_DVSN_CD_NM
				, D4.ACP_RUT_CD
				, ( SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000056' AND CD = D4.ACP_RUT_CD ) AS ACP_RUT_CD_NM
				, D4.CVPT_ACP_NO
				, D4.ACP_DT
				, ( SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000361' AND CD = D4.CVPT_HNDL_STA_CD ) AS CVPT_HNDL_STA_CD_NM
				, D4.CVPT_HNDL_STA_CD
				, D4.CVPTR_NM
				, D4.ORG_NM
				, D4.TIT_NM
		FROM	(
					SELECT	DECODE( D1.CVPT_HNDL_STA_CD, '20', D1.ACP_DPT_CD, D2.HNDL_DPT_CD ) AS DPT_CD
							, DECODE( D1.CVPT_HNDL_STA_CD, '20', D1.RCEP_ID, D2.HNDL_CHGR_ID ) AS USR_ID
							, (
								SELECT	USR_DFN_TXT_1
								FROM	TBDCMACM013C D3
								WHERE	D3.CMM_CD_DVSN_CD = '1000047'
								AND		D3.CD = D1.CVPT_KND_CD
							) AS CVPT_KND_DVSN_CD
							, TO_CHAR(D1.ACP_DH, 'YYYYMMDD') AS ACP_DT
							, D1.ACP_YR || '-민원-' || LPAD(D1.RM_CVPT_ACP_NO, 5, '0') AS CVPT_ACP_NO
							, D1.CVPT_HNDL_STA_CD
							, D3.CVPT_HNDL_DVSN_CD
							, D7.ORG_NM
							, D1.TIT_NM
							, D1.ACP_RUT_CD
							, D1.REQR_KND_CD
							, (
								CASE
									WHEN D1.REQR_KND_CD IN ('1', '4')
									THEN D1.CVPTR_NM
									ELSE D1.RPST_PEN_NM
								END
							) AS CVPTR_NM
					FROM	TBCSPDCP101M D1
							, TBCSPDCP201M D2
							, TBCSPDCP205L D3
							, (
								SELECT	D5.REQ_DVSN_CD
										, D5.ACP_YR
										, D5.CVPT_ACP_NO
										, AGGR_CONCAT( DECODE(D5.OGN_ORG_DVSN_CD,'10',D6.ORG_NM,'20',D5.ORG_NM), ', ') AS ORG_NM
								FROM	TBCSPDCP206L D5
										, TBDCMACM015M D6
								WHERE	D5.ORG_CD = D6.ORG_CD
								AND		D5.ORG_HIS_DVSN_CD = '1'
								GROUP BY D5.REQ_DVSN_CD, D5.ACP_YR, D5.CVPT_ACP_NO
							) D7
					WHERE	D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
					AND		D1.ACP_YR = D2.ACP_YR(+)
					AND		D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
					AND		D2.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
					AND		D2.ACP_YR = D3.ACP_YR(+)
					AND		D2.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
					AND		1 = D3.SRNO(+)
					AND		D1.REQ_DVSN_CD = D7.REQ_DVSN_CD(+)
					AND		D1.ACP_YR = D7.ACP_YR(+)
					AND		D1.CVPT_ACP_NO = D7.CVPT_ACP_NO(+)
					AND		D1.REQ_DVSN_CD = '1'
					AND		D1.CVPT_HNDL_STA_CD IN ( '30', '40', '41', '50', '60' ,'70')	/* 처리중, 시행문작성중, 조사결과, 처리완료 중 담당자가 있는 것만 계산 */
	]]>
		<dynamic>
			<isEqual property="SEARCHDTKEY" compareValue="1">					  
		    		AND		D1.ACP_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		    <isEqual property="SEARCHDTKEY" compareValue="2">	
		    		AND		D2.FNL_HNDL_DH BETWEEN TO_DATE(#STARTDT# || '000000', 'YYYYMMDDHH24MISS') AND TO_DATE(#ENDDT# || '235959', 'YYYYMMDDHH24MISS')
		    </isEqual>
		</dynamic>
	<![CDATA[
				) D4
				, TBDCMACM001M D5
		WHERE	D4.USR_ID = D5.USR_ID
	]]>
	
	<include refid = "include.pageOrder"/> 
	</select>
</sqlMap> 
