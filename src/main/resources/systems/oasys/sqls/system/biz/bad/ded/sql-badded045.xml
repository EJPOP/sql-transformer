<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="bad/ded/045">

	<select id="badded045EOffselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[       
        SELECT YE
             , MD
             , YE||MD AS YMD
             , HLDY_DVSN_CD
             , HLDY_NM
             , LNR_YN
          FROM TBBADDED013B
          WHERE 1=1
        ]]>
        <isNotEmpty property="strFrom">	 
			  AND YE||MD BETWEEN  #strFrom#	AND #strTo#	 /*지역코드*/
		</isNotEmpty>   
		<isNotEmpty property="strHldyDvsnCd">	 
			  AND HLDY_DVSN_CD = #strHldyDvsnCd#		 /*지역코드*/
		</isNotEmpty>  
			<isNotEmpty property="strRefYear">	 
			  AND YE = #strRefYear#		 /*지역코드*/
		</isNotEmpty>   
		 
        </select>
        
	<insert id="badded045EOffinsert" parameterClass="paramMap">
		INSERT
		INTO
		TBBADDED013B
		( YE
        , MD
        , HLDY_DVSN_CD
        , HLDY_NM
        , LNR_YN
		
		, FNL_MNU_ID
		, FRT_USR_ID
		, FNL_USR_ID
		, FNL_DEAL_DPT_CD
		, FRT_REGI_DH
		, FNL_MDF_DH
		)
		VALUES
		( #YE#
        , #MD#
        , #HLDY_DVSN_CD#
        , #HLDY_NM#
        , #LNR_YN#
        
		, #FNL_MNU_ID#
		, #FRT_USR_ID#
		, #FNL_USR_ID#
		, #FNL_DEAL_DPT_CD#
		, SYSDATE
		, SYSDATE

		)
	</insert>
	
	
	<update id="badded045EOffupdate" parameterClass="paramMap">
		UPDATE TBBADDED013B
		SET YE = #YE#
        , MD   = #MD#	
        , LNR_YN = #LNR_YN#
		, FNL_MDF_DH = SYSDATE
		, FNL_USR_ID = #FNL_USR_ID#
		, FNL_DEAL_DPT_CD =	#FNL_DEAL_DPT_CD#
		, FNL_MNU_ID = #FNL_MNU_ID#

		<isNotNull prepend="," property="HLDY_DVSN_CD">
			HLDY_DVSN_CD = #HLDY_DVSN_CD#
		</isNotNull>
		<isNotNull prepend="," property="HLDY_NM">
			HLDY_NM = #HLDY_NM#
		</isNotNull>
		<isNotNull prepend="," property="LNR_YN">
			
		</isNotNull>
				WHERE 1 = 1
		AND YE =  #YE#
		AND MD = #MD#


	</update>
	
	
	<delete id="badded045EOffdelete" parameterClass="paramMap">
		DELETE
		TBBADDED013B
		WHERE 1 = 1
		AND YE =  #YE#
		AND MD = #MD#

	</delete>
	
	
	<delete id="badded045EOffNewYeardelete" parameterClass="paramMap">
		DELETE
		TBBADDED013B
		WHERE 1 = 1
		AND YE =  #YE#


	</delete>
	
	
	<select id="badded045EOffNewselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[       
        SELECT YE
             , MD
             , HLDY_DVSN_CD
             , HLDY_NM
             , LNR_YN
          FROM TBBADDED013B
          WHERE 1=1
            AND YE >= #strRefYear#
			AND YE <= #strNewYear#
			AND MD >='0101'
			AND MD <= '1231'
			AND HLDY_DVSN_CD =3
        ]]>
     	ORDER BY YE,MD
        </select>
		
</sqlMap> 
