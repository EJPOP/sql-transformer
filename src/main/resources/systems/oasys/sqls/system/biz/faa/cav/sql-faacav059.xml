<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/059"> 
	<!-- 증명책임자부호 상세 조회 -->
	<select id="FAACAV059EMainselect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/059/FAACAV059EMainselect */ ]]>
		<![CDATA[
		SELECT	COPT_CD,
				ACNT_CD,
				BLL_CD,
				PROF_DRTR_SRNO,
				DL_XPN_RCDB_PBSVT_SRNO,
				F_AV_BLL_COPT_CD_NM(COPT_CD) AS COPT_NM,
				F_AV_ACNT_CD_NM(ACNT_CD) AS ACNT_NM,
				F_AV_BLL_CD_NM(BLL_CD, DL_XPN_RCDB_PBSVT_SRNO) AS BLL_NM,
				F_ORG_INFO(ORG_CD, 1) AS ORG_NM,
				ORG_CD,
				ORGCHF_NM,
				DOC_ENF_NO,
				DOC_ENF_DT,
				PST_NM,
				CRE_DT,
				ABLT_DT,
				BR_CD,
				DIV_CD,
				FNCR_NM,
				FNCR_EIN,
				EXPN_SSEC_NM,
				EXPN_SSEC_EIN,
				MDF_PEN_NM,
				MDF_PEN_EIN,
				BZN,
				ZCD,
				TNB,
				AD,
				MDF_DT,
				ACP_DVSN_CD,
				MDF_DVSN_CD,
				ENS_USE_YN,
				PROF_DRTR_RMK,
				APV_LIN_CHGR_NM,
				APV_EXAM_PEN_NM,
				APVR_NM,
				PRSS_STA_CD
		FROM	TWFAACAV003M
		WHERE	1=1
		]]>
		<isNotEmpty property="strCoptCd">
		AND     COPT_CD = #strCoptCd#
		</isNotEmpty>	   
		<isNotEmpty property="strAcntCd">
		AND     ACNT_CD = #strAcntCd#
		</isNotEmpty>	   
		<isNotEmpty property="strBllCd">
		<isEqual property="strBllCd" compareValue="17">
		AND     BLL_CD IN ('17', '18')
		</isEqual>
		<isEqual property="strBllCd" compareValue="22">
		AND     BLL_CD IN ('22', '23')
		</isEqual>
		AND     BLL_CD = #strBllCd#
		</isNotEmpty>	   
		<isNotEmpty property="strProfDrtrSrno">
		AND     PROF_DRTR_SRNO = #strProfDrtrSrno#
		</isNotEmpty>	   		
		<isNotEmpty property="strDlXpnRcdbPbsvtSrno">
		AND     DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		</isNotEmpty>
		<isNotEmpty property="strUseYn">
		<isEqual property="strUseYn" compareValue="Y">
		AND		ABLT_DT = '999999'
		</isEqual> 
		</isNotEmpty>
		
	</select>
	
	
	<!-- 비밀번호 초기화 -->
	<insert id="FAACAV059E_EN_ENAIS_TWFAACAV003M_ResetPw" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/059/FAACAV059E_EN_ENAIS_TWFAACAV003M_ResetPw */ ]]>
		INSERT INTO EN_ENAIS_TWFAACAV003M (
			IF_SEQ
			,COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,CRE_DT
			,ACP_DVSN_CD
			,FLAG
			,IF_STATUS
			,IF_TRY
			,IF_RAISE_DT
			,IF_DEAL_DT
			,IF_MESSG
			,IF_SIID
			,ENS_USE_YN
		) VALUES (
			#IF_SEQ#
			,#strCoptCd#
			,#strAcntCd#
			,#strBllCd#
			,#strProfDrtrSrno#
			,#strDlXpnRcdbPbsvtSrno#
			,REPLACE(#strCrtDt#,'-','')
			,#strAcpDvsnCd#
			,'R'
			,'SS'
			,'0'
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,''
			,''
			,#strEnsUseYn#
		)
	</insert>	
	
	
	<!-- 증명책임자부호 연계-->
	<insert id="FAACAV059E_EN_ENAIS_TWFAACAV003M_Insert" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/059/FAACAV059E_EN_ENAIS_TWFAACAV003M_Insert */ ]]>
		INSERT INTO EN_ENAIS_TWFAACAV003M (
			IF_SEQ
            ,COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,CRE_DT
			,ORG_CD
			,ORG_NM
			,ORGCHF_NM
			,PST_NM
			,ABLT_DT
			,BR_CD
			,DIV_CD
			,MDF_DT
			,MDF_DVSN_CD
			,DOC_ENF_NO
			,DOC_ENF_DT
			,FNCR_EIN
			,FNCR_NM
			,EXPN_SSEC_EIN
			,EXPN_SSEC_NM
			,MDF_PEN_EIN
			,MDF_PEN_NM
			,TNB
			,ZCD
			,AD
			,BZN
			,ACP_DVSN_CD
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
            ,FLAG
            ,IF_STATUS
            ,IF_TRY
            ,IF_RAISE_DT
            ,IF_DEAL_DT
            ,IF_MESSG
            ,IF_SIID
            ,ENS_USE_YN
		) VALUES (
			#IF_SEQ#
			,#COPT_CD#
            ,#ACNT_CD#
            ,#BLL_CD#
            ,#PROF_DRTR_SRNO#
            ,#DL_XPN_RCDB_PBSVT_SRNO#
            ,REPLACE(#CRE_DT#,'-','')
            ,#ORG_CD#
            ,#ORG_NM#
            ,#ORGCHF_NM#
            ,#PST_NM#
            ,NVL(DECODE(#ABLT_DT#, '', '999999', #ABLT_DT#), '999999')
            ,RPAD(#BR_CD#,3,'0')
            ,RPAD(#DIV_CD#,3,'0')
            ,REPLACE(#MDF_DT#,'-','')
            ,#MDF_DVSN_CD#
            ,#DOC_ENF_NO#
            ,REPLACE(#DOC_ENF_DT#,'-','')
            ,REPLACE(#FNCR_EIN#,'-','')
            ,#FNCR_NM#
            ,REPLACE(#EXPN_SSEC_EIN#,'-','')
            ,#EXPN_SSEC_NM#
            ,REPLACE(#MDF_PEN_EIN#,'-','')
            ,#MDF_PEN_NM#
            ,REPLACE(#TNB#,'-','')
            ,#ZCD#
            ,#AD#
            ,#BZN#
            ,#ACP_DVSN_CD#
            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            ,#FRT_USR_ID#
            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            ,#FNL_USR_ID#
            ,#FNL_DEAL_DPT_CD#
            ,#FNL_MNU_ID#
            ,'U'
            ,'SS'
            ,'0'
            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            ,''
            ,''
            ,#ENS_USE_YN#
		)
	</insert>	

</sqlMap> 
