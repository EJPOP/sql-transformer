<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="csp/bii/120">
	
	<select id="CSPBII120QMainSelect" parameterClass="paramMap" resultClass="resultMap">
	<include refid = "include.pageSelct"/>
		<![CDATA[
			SELECT /* csp.bii.service.impl.CSPBII120QServiceImpl.CSPBII120QMainSelect */
			       A.YE || '-' || A.SRNO                                           AS INF_NO
			     , A.SMT_DT
			     , A.PRSR_CNB
			     , (SELECT B.USR_NAM
			          FROM TBDCMACM001M B
			         WHERE B.CNB = A.PRSR_CNB)                                     AS PRSR_NAM
			     , CASE WHEN SUBSTR(F_CODE_NM('1000097', A.INF_DVSN_CD), 1, 2) is not null THEN '(' || SUBSTR(F_CODE_NM('1000097', A.INF_DVSN_CD), 1, 2) || ')' || A.TIT_TXT
			            ELSE A.TIT_TXT
			             END AS TIT_TXT
			     , (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.REL_ORG_CD)                                AS REL_ORG_NM
			     , A.HNDL_DPT_CD
			     , (SELECT B.DPT_NM
			                 FROM TBDCMACM002M B
			                WHERE B.DPT_CD = A.HNDL_DPT_CD)                        AS HNDL_DPT_NM
			     , F_CODE_NM('1000039', A.HNDL_ORD_CD)                             AS HNDL_ORD_NM		
			     , A.AUD_INF_PRSS_STA_CD	    
			     , F_CODE_NM('1000085', A.AUD_INF_PRSS_STA_CD)                     AS AUD_INF_PRSS_STA_NM
			     , A.CMPT_DT
			     , F_CODE_NM('1000042', A.HNDL_RSLT_CD)                            AS HNDL_RSLT_NM
			     , A.OPEN_YN 
			     , A.YE
			     , A.SRNO
			     , F_DPT_INFO(A.PRSR_DPT_CD,'4') AS PRSR_DPT_NM
                 , F_CODE_NM('1000173',A.PRSR_RANK_CD) AS PRSR_RANK_NM
                 , A.HNDL_DT
                 , F_USR_INFO(A.HNDL_PEN_CNB,'2') AS HNDL_PEN_NM
                 , F_CODE_NM('1000173',A.HNDL_RANK_CD) AS HNDL_PEN_RANK_NM
                 , A.HNDL_PEN_CNB
                 , DECODE(A.OPEN_YN,'1','공개','2','비공개') AS OPEN_NM
                 , F_CODE_NM('1000040', A.SRC_DVSN_CD) as SRC_DVSN_NM
                 ,CLC_DVSN_CD
                 , (SELECT E.SPCF_AUD_SBJ
			          FROM TBCSPBII140M E
			         WHERE E.SPCF_INF_CLC_NO = A.CLC_DVSN_CD) AS CLC_DVSN_NM
                 ,F_CODE_NM('1000097', A.INF_DVSN_CD) AS INF_DVSN_NM
                 ,ACP_DT
                 ,TRNF_DT
                 ,TRNF_ACP_DT
                 ,(SELECT F_CODE_NM('1000852',GEN_ADMN_DVSN_CD)
			     	FROM	TBDCMACM001M  S1
			     	WHERE	A.PRSR_CNB = S1.CNB 
			     	)
			      AS GEN_ADMN_DVSN_NM
			  FROM TBCSPBII100M A
			 WHERE 1=1
		]]>
		
		<!-- 시작 연도 -->
		<isNotEmpty property="strStrYe">
			AND A.YE >= #strStrYe#
		</isNotEmpty>
		
		<!-- 종료 연도 -->
		<isNotEmpty property="strEndYe">
			AND A.YE &lt;= #strEndYe#
		</isNotEmpty>
		
		<!-- 시작 일련번호 -->
		<isNotEmpty property="strStrSrno">
			AND A.SRNO >= #strStrSrno#
		</isNotEmpty>
		
		<!-- 종료 일련번호 -->
		<isNotEmpty property="strEndSrno">
			AND A.SRNO &lt;= #strEndSrno#
		</isNotEmpty>
		
		<!-- 제목/내용 -->
		<isNotEmpty property="strSrhTxt">
			AND (A.TIT_TXT LIKE '%' || #strSrhTxt# || '%'		
			  OR EXISTS (SELECT 1
			                FROM TBCSPBII101L B
			               WHERE INSTR(B.SCH_AUD_INF_TXT, #strSrhTxt#, 1, 1) > 0
			                 AND B.YE   = A.YE
			                 AND B.SRNO = A.SRNO))
		</isNotEmpty>
		
		<!-- 시작 기간 -->
		<isNotEmpty property="strStrDt">
			AND A.$strDtDvsnCd$ >= #strStrDt#
		</isNotEmpty>
		
		<!-- 종료 기간 -->
		<isNotEmpty property="strEndDt">
			AND A.$strDtDvsnCd$ &lt;= #strEndDt#
		</isNotEmpty>
		
		<isNotEmpty property="strStrDt2">
			AND A.$strDtDvsnCd2$ >= #strStrDt2#
		</isNotEmpty>
		
		<!-- 종료 기간 -->
		<isNotEmpty property="strEndDt2">
			AND A.$strDtDvsnCd2$ &lt;= #strEndDt2#
		</isNotEmpty>
		
		<isNotEqual property="strOrgNmSh" compareValue="Y">
		<!-- 시작관련기관 -->
		<isNotEmpty property="strStrRelOrgCd">
			<isEmpty property="strEndRelOrgCd">
				<isEqual property="strRelOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   LIKE SUBSTR(#strStrRelOrgCd#, 0, INSTR(#strStrRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_1 LIKE SUBSTR(#strStrRelOrgCd#, 0, INSTR(#strStrRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_2 LIKE SUBSTR(#strStrRelOrgCd#, 0, INSTR(#strStrRelOrgCd#, '000') -1) || '%')
				</isEqual>
				<isNotEqual property="strRelOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   = #strStrRelOrgCd#
					  OR A.REL_ORG_CD_1 = #strStrRelOrgCd#
					  OR A.REL_ORG_CD_2 = #strStrRelOrgCd#)
				</isNotEqual>	
			</isEmpty>
			<isNotEmpty property="strEndRelOrgCd">
				AND (A.REL_ORG_CD   BETWEEN #strStrRelOrgCd# AND #strEndRelOrgCd#
				  OR A.REL_ORG_CD_1 BETWEEN #strStrRelOrgCd# AND #strEndRelOrgCd#
				  OR A.REL_ORG_CD_2 BETWEEN #strStrRelOrgCd# AND #strEndRelOrgCd#)
			</isNotEmpty>
		</isNotEmpty>
		
		<!-- 종료 관련기관 -->
		<isNotEmpty property="strEndRelOrgCd">
			<isEmpty property="strStrRelOrgCd">
				<isEqual property="strRelOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   LIKE SUBSTR(#strEndRelOrgCd#, 0, INSTR(#strEndRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_1 LIKE SUBSTR(#strEndRelOrgCd#, 0, INSTR(#strEndRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_2 LIKE SUBSTR(#strEndRelOrgCd#, 0, INSTR(#strEndRelOrgCd#, '000') -1) || '%')
				</isEqual>
				<isNotEqual property="bltOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   = #strEndRelOrgCd#
					  OR A.REL_ORG_CD_1 = #strEndRelOrgCd#
					  OR A.REL_ORG_CD_2 = #strEndRelOrgCd#)
				</isNotEqual>	
			</isEmpty>
		</isNotEmpty>
		</isNotEqual>
		
		<isEqual property="strOrgNmSh" compareValue="Y">
		AND (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.REL_ORG_CD) like '%'||#strStrRelOrgNm#||'%'
		</isEqual>
		
		<!-- 정보구분 -->
		<isNotEmpty property="strInfDvsnCd">
			AND A.INF_DVSN_CD = #strInfDvsnCd#
		</isNotEmpty>

		<!-- 관련자명 -->
		<isNotEmpty property="strRelPenNam">
			AND EXISTS (SELECT 1
			              FROM TBCSPBII130L B /* 감사정보관련자내역 */
			             WHERE B.NAM  = #strRelPenNam#
			               AND B.YE   = A.YE
			               AND B.SRNO = A.SRNO
			            UNION ALL
			            SELECT 1
			              FROM TBCSPBII120L B /* 감사정보관련처분내역 */
			                 , TBBADEAR007M C /* 관계자기본 */
			             WHERE B.AUD_YR   = C.AUD_YR
			               AND B.AUD_NO   = C.AUD_NO
			               AND C.DFNT_NAM = #strRelPenNam#
			               AND B.YE       = A.YE
			               AND B.SRNO     = A.SRNO)
		</isNotEmpty>
		
		<!-- 처리지시1~3 -->
		AND CASE WHEN #strHndlOrdCd1# IS NULL AND #strHndlOrdCd2# IS NULL AND #strHndlOrdCd3# IS NULL AND #strHndlOrdCd4# IS NULL AND #strHndlOrdCd5# IS NULL THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd1#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd2#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd3#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd4#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd5#                                                 THEN '1'  
		         ELSE '0'
		    END = '1'            
			                                   
		<!-- 수집구분 -->
		<isNotEmpty property="strClcDvsnCd">
			AND A.CLC_DVSN_CD = #strClcDvsnCd#
		</isNotEmpty>
		
		<!-- 출처구분 -->
		<isNotEmpty property="strSrcDvsnCd">
			AND A.SRC_DVSN_CD = #strSrcDvsnCd#
		</isNotEmpty>
		
		<!-- 제출과 -->
		<isNotEmpty property="strSmtDptCd">
			AND A.PRSR_DPT_CD LIKE NVL(SUBSTR(#strSmtDptCd#, 0, INSTR(#strSmtDptCd#, '0000') -1), #strSmtDptCd#) || '%'
		</isNotEmpty>
		
		<!-- 소관(처리)과 -->
		<isNotEmpty property="strHndlDptCd">
			AND A.HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
		</isNotEmpty>
		
		<!-- 찜한과 -->
		<isNotEmpty property="strPopDptCd">
			AND A.AUD_DPT_CD LIKE NVL(SUBSTR(#strPopDptCd#, 0, INSTR(#strPopDptCd#, '0000') -1), #strPopDptCd#) || '%'
		</isNotEmpty>
		
		<!-- 입건과 -->
		<isNotEmpty property="strEnfDptCd">
			AND EXISTS (SELECT 1
			              FROM TBCSPBII120L B /* 감사정보관련처분내역 */
			                 , TBBADEAR002D C /* 처분요구사항상세 */
			             WHERE B.AUD_YR         = C.AUD_YR
			               AND B.AUD_NO         = C.AUD_NO
			               AND B.DSP_RQ_SNO     = C.DSP_RQ_SNO
			               AND C.ENF_BRDV_CD LIKE NVL(SUBSTR(#strEnfDptCd#, 0, INSTR(#strEnfDptCd#, '0000') -1), #strEnfDptCd#) || '%'
			               AND B.YE   = A.YE
			               AND B.SRNO = A.SRNO)			          
		</isNotEmpty>
		
		<!-- 제출자 -->
		<isNotEmpty property="strPrsrCnb">
			AND A.PRSR_CNB = #strPrsrCnb#
		</isNotEmpty>
		
		<!-- 처리자 -->
		<isNotEmpty property="strHndlPenCnb">
			AND A.HNDL_PEN_CNB = #strHndlPenCnb#
		</isNotEmpty>
		
		<!-- 찜한자 -->
		<isNotEmpty property="strPopPenCnb">
			AND A.AUD_PEN_CNB = #strPopPenCnb#
		</isNotEmpty>
		
		<!-- 입건자 -->
		<isNotEmpty property="strEnfPenCnb">
			AND EXISTS (SELECT 1
			              FROM TBCSPBII120L B /* 감사정보관련처분내역 */
			                 , TBBADEAR004M C /* 감사자기본 */
			             WHERE B.AUD_YR     = C.AUD_YR
			               AND B.AUD_NO     = C.AUD_NO
			               AND B.DSP_RQ_SNO = C.DSP_RQ_SNO
			               AND C.ETR_PEN_ID = #strEnfPenCnb#
			               AND B.YE         = A.YE
			               AND B.SRNO       = A.SRNO)			          
		</isNotEmpty>
		
		<!-- 처리결과 -->
		AND CASE WHEN #strHndlRslt1#  IS NULL AND #strHndlRslt2#  IS NULL AND #strHndlRslt3# IS NULL AND 
		              #strHndlRslt4#  IS NULL AND #strHndlRslt5#  IS NULL AND #strHndlRslt6# IS NULL AND
		              #strHndlRslt7#  IS NULL                                                            THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt1#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt2#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt3#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt4#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt5#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt6#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt7#                                                    THEN '1'
		         ELSE '0'
		    END = '1'       
		
		<!-- 진행상황 -->
		AND CASE WHEN #strPrssSta1#  IS NULL AND #strPrssSta2#  IS NULL AND #strPrssSta3# IS NULL AND 
		              #strPrssSta4#  IS NULL AND #strPrssSta5#  IS NULL AND #strPrssSta6# IS NULL AND
		              #strPrssSta7#  IS NULL AND #strPrssSta8#  IS NULL AND #strPrssSta9# IS NULL AND
		              #strPrssSta10# IS NULL AND #strPrssSta11# IS NULL AND #strPrssSta12# IS NULL AND #strPrssSta13# IS NULL AND 
		              #strPrssSta14# IS NULL AND #strPrssSta15# IS NULL    THEN '1'
		         WHEN #strPrssSta1# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('05')             THEN '1'
		         WHEN #strPrssSta2# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('10')             THEN '1'
		         WHEN #strPrssSta3# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('13')             THEN '1'
		         WHEN #strPrssSta4# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('20') THEN '1'
		         WHEN #strPrssSta5# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('15')             THEN '1'
		         WHEN #strPrssSta6# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('21', '22', '23','24','30','31','32') THEN '1'
		         WHEN #strPrssSta7# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('99')             THEN '1'
		         WHEN #strPrssSta8# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('10', '13') THEN '1'
		         WHEN #strPrssSta9# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('15')              THEN '1'
		         WHEN #strPrssSta10# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('21', '22', '23','24','30','31','32') THEN '1'
		         WHEN #strPrssSta11# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('99')             THEN '1'
		         WHEN #strPrssSta12# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('05')             THEN '1'
		         WHEN #strPrssSta13# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('02')             THEN '1'
		         WHEN #strPrssSta14# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('02')             THEN '1'
		         WHEN #strPrssSta15# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('20')             THEN '1'
		         ELSE '0'
		    END = '1'     

		<!-- 제출여부 [개인별마일리지현황>감사정보 검색 팝업화면에서 사용]-->
		<isEqual property="strUtlYn" compareValue="Y">
			AND A.UTL_ADT_SC > 0
		</isEqual>		    

		<isNotEmpty property="strGEN_ADMN_DVSN_CD">
			AND A.PRSR_CNB IN (SELECT CNB FROM TBDCMACM001M WHERE GEN_ADMN_DVSN_CD = #strGEN_ADMN_DVSN_CD#)
		</isNotEmpty>
		
		<isNotEmpty property="strBLE_CHGR_CNB">
			AND A.BLE_CHGR_CNB = #strBLE_CHGR_CNB#
		</isNotEmpty>
			AND A.OPEN_YN = CASE WHEN A.OPEN_YN = '2' and (A.PRSR_CNB = #strCnb# or A.HNDL_DPT_CD = #strDptCd# or '150120' = #strDptCd# or '150150' = #strDptCd#) THEN '2'
                 ELSE '1'		
                  END	
		
		<include refid = "include.pageOrder"/> 
	</select>	
	
	
	<select id="CSPBII120QExcelSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT /* csp.bii.service.impl.CSPBII120QServiceImpl.CSPBII120QMainSelect */
			       A.YE || '-' || A.SRNO                                           AS INF_NO
			     , A.SMT_DT
			     , A.PRSR_CNB
			     , (SELECT B.USR_NAM
			          FROM TBDCMACM001M B
			         WHERE B.CNB = A.PRSR_CNB)                                     AS PRSR_NAM
			     , CASE WHEN SUBSTR(F_CODE_NM('1000097', A.INF_DVSN_CD), 1, 2) is not null THEN '(' || SUBSTR(F_CODE_NM('1000097', A.INF_DVSN_CD), 1, 2) || ')' || A.TIT_TXT
			            ELSE A.TIT_TXT
			             END AS TIT_TXT
			     , (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.REL_ORG_CD)                                AS REL_ORG_NM
			     , A.HNDL_DPT_CD
			     , (SELECT B.DPT_NM
			                 FROM TBDCMACM002M B
			                WHERE B.DPT_CD = A.HNDL_DPT_CD)                        AS HNDL_DPT_NM
			     , F_CODE_NM('1000039', A.HNDL_ORD_CD)                             AS HNDL_ORD_NM		
			     , A.AUD_INF_PRSS_STA_CD	    
			     , F_CODE_NM('1000085', A.AUD_INF_PRSS_STA_CD)                     AS AUD_INF_PRSS_STA_NM
			     , A.CMPT_DT
			     , F_CODE_NM('1000042', A.HNDL_RSLT_CD)                            AS HNDL_RSLT_NM
			     , A.OPEN_YN 
			     , A.YE
			     , A.SRNO
			     , F_DPT_INFO(A.PRSR_DPT_CD,'1') AS PRSR_DPT_NM
                 , F_CODE_NM('1000173',A.PRSR_RANK_CD) AS PRSR_RANK_NM
                 , A.HNDL_DT
                 , F_USR_INFO(A.HNDL_PEN_CNB,'2') AS HNDL_PEN_NM
                 , F_CODE_NM('1000173',A.HNDL_RANK_CD) AS HNDL_PEN_RANK_NM
                 , A.HNDL_PEN_CNB
                 , DECODE(A.OPEN_YN,'1','공개','2','비공개') AS OPEN_NM
                 , F_CODE_NM('1000040', A.SRC_DVSN_CD) as SRC_DVSN_NM
                 ,CLC_DVSN_CD
                 , (SELECT E.SPCF_AUD_SBJ
			          FROM TBCSPBII140M E
			         WHERE E.SPCF_INF_CLC_NO = A.CLC_DVSN_CD) AS CLC_DVSN_NM
                 ,F_CODE_NM('1000097', A.INF_DVSN_CD) AS INF_DVSN_NM
                 ,ACP_DT
                 ,TRNF_DT
                 ,TRNF_ACP_DT
                 ,F_CODE_NM('1000459',A.PRSR_DPT_TP_CD) AS DPT_TP_NM
			     , nvl(A.UTL_SC,0) AS UTL_SC /* 활용가능성 */
			     , nvl(A.FDLTY_SC,0) AS FDLTY_SC /* 충실성 */
			     , nvl(A.RIBLY_SC,0) AS RIBLY_SC /* 신뢰성 */
			     , nvl(A.UTL_SC,0) + nvl(A.FDLTY_SC,0) + nvl(A.RIBLY_SC,0) AS TOT_CNT
			     ,DECODE(A.PRE_EVL_CD, '10','상','20','중','30','하','') AS PRE_EVL_CD
			     ,F_USR_INFO(A.BLE_CHGR_CNB,'2') AS BLE_CHGR_NAM
			     ,A.DTB_DT 
			     ,(SELECT F_CODE_NM('1000852',GEN_ADMN_DVSN_CD)
			     	FROM	TBDCMACM001M  S1
			     	WHERE	A.PRSR_CNB = S1.CNB 
			     	)
			      AS GEN_ADMN_DVSN_NM
			  FROM TBCSPBII100M A
			 WHERE 1=1
		]]>
		
		<!-- 시작 연도 -->
		<!-- 시작 연도 -->
		<isNotEmpty property="strStrYe">
			AND A.YE >= #strStrYe#
		</isNotEmpty>
		
		<!-- 종료 연도 -->
		<isNotEmpty property="strEndYe">
			AND A.YE &lt;= #strEndYe#
		</isNotEmpty>
		
		<!-- 시작 일련번호 -->
		<isNotEmpty property="strStrSrno">
			AND A.SRNO >= #strStrSrno#
		</isNotEmpty>
		
		<!-- 종료 일련번호 -->
		<isNotEmpty property="strEndSrno">
			AND A.SRNO &lt;= #strEndSrno#
		</isNotEmpty>
		
		<!-- 제목/내용 -->
		<isNotEmpty property="strSrhTxt">
			AND (A.TIT_TXT LIKE '%' || #strSrhTxt# || '%'		
			  OR EXISTS (SELECT 1
			                FROM TBCSPBII101L B
			               WHERE INSTR(B.SCH_AUD_INF_TXT, #strSrhTxt#, 1, 1) > 0
			                 AND B.YE   = A.YE
			                 AND B.SRNO = A.SRNO))
		</isNotEmpty>
		
		<!-- 시작 기간 -->
		<isNotEmpty property="strStrDt">
			AND A.$strDtDvsnCd$ >= #strStrDt#
		</isNotEmpty>
		
		<!-- 종료 기간 -->
		<isNotEmpty property="strEndDt">
			AND A.$strDtDvsnCd$ &lt;= #strEndDt#
		</isNotEmpty>
		
		<!-- 시작 기간 -->
		<isNotEmpty property="strTrnfStrDt">
			AND ((A.TRNF_DT BETWEEN #strTrnfStrDt# AND #strTrnfEndDt#) OR (substr(TRNF_DT,0,4) <![CDATA[<]]> substr(#strTrnfStrDt#, 0, 4) AND A.HNDL_RSLT_CD IS NULL))
		</isNotEmpty>
		
		<!-- 종료 기간 -->
		<isNotEmpty property="strEndDt">
			AND A.$strDtDvsnCd$ &lt;= #strEndDt#
		</isNotEmpty>		
		
		<isNotEmpty property="strStrDt2">
			AND A.$strDtDvsnCd2$ >= #strStrDt2#
		</isNotEmpty>
		
		<!-- 종료 기간 -->
		<isNotEmpty property="strEndDt2">
			AND A.$strDtDvsnCd2$ &lt;= #strEndDt2#
		</isNotEmpty>
		
		<isEqual property="strOrgNmSh" compareValue="">
		<!-- 시작관련기관 -->
		<isNotEmpty property="strStrRelOrgCd">
			<isEmpty property="strEndRelOrgCd">
				<isEqual property="strRelOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   LIKE SUBSTR(#strStrRelOrgCd#, 0, INSTR(#strStrRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_1 LIKE SUBSTR(#strStrRelOrgCd#, 0, INSTR(#strStrRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_2 LIKE SUBSTR(#strStrRelOrgCd#, 0, INSTR(#strStrRelOrgCd#, '000') -1) || '%')
				</isEqual>
				<isNotEqual property="strRelOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   = #strStrRelOrgCd#
					  OR A.REL_ORG_CD_1 = #strStrRelOrgCd#
					  OR A.REL_ORG_CD_2 = #strStrRelOrgCd#)
				</isNotEqual>	
			</isEmpty>
			<isNotEmpty property="strEndRelOrgCd">
				AND (A.REL_ORG_CD   BETWEEN #strStrRelOrgCd# AND #strEndRelOrgCd#
				  OR A.REL_ORG_CD_1 BETWEEN #strStrRelOrgCd# AND #strEndRelOrgCd#
				  OR A.REL_ORG_CD_2 BETWEEN #strStrRelOrgCd# AND #strEndRelOrgCd#)
			</isNotEmpty>
		</isNotEmpty>
		
		<!-- 종료 관련기관 -->
		<isNotEmpty property="strEndRelOrgCd">
			<isEmpty property="strStrRelOrgCd">
				<isEqual property="strRelOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   LIKE SUBSTR(#strEndRelOrgCd#, 0, INSTR(#strEndRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_1 LIKE SUBSTR(#strEndRelOrgCd#, 0, INSTR(#strEndRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_2 LIKE SUBSTR(#strEndRelOrgCd#, 0, INSTR(#strEndRelOrgCd#, '000') -1) || '%')
				</isEqual>
				<isNotEqual property="bltOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   = #strEndRelOrgCd#
					  OR A.REL_ORG_CD_1 = #strEndRelOrgCd#
					  OR A.REL_ORG_CD_2 = #strEndRelOrgCd#)
				</isNotEqual>	
			</isEmpty>
		</isNotEmpty>
		</isEqual>
		
		<isEqual property="strOrgNmSh" compareValue="Y">
		(SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.REL_ORG_CD) like '%'||#strStrRelOrgNm#||'%'
		</isEqual>
		
		<!-- 정보구분 -->
		<isNotEmpty property="strInfDvsnCd">
			AND A.INF_DVSN_CD = #strInfDvsnCd#
		</isNotEmpty>

		<!-- 관련자명 -->
		<isNotEmpty property="strRelPenNam">
			AND EXISTS (SELECT 1
			              FROM TBCSPBII130L B /* 감사정보관련자내역 */
			             WHERE B.NAM  = #strRelPenNam#
			               AND B.YE   = A.YE
			               AND B.SRNO = A.SRNO
			            UNION ALL
			            SELECT 1
			              FROM TBCSPBII120L B /* 감사정보관련처분내역 */
			                 , TBBADEAR007M C /* 관계자기본 */
			             WHERE B.AUD_YR   = C.AUD_YR
			               AND B.AUD_NO   = C.AUD_NO
			               AND C.DFNT_NAM = #strRelPenNam#
			               AND B.YE       = A.YE
			               AND B.SRNO     = A.SRNO)
		</isNotEmpty>
		
		<!-- 처리지시1~3 -->
		AND CASE WHEN #strHndlOrdCd1# IS NULL AND #strHndlOrdCd2# IS NULL AND #strHndlOrdCd3# IS NULL THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd1#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd2#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd3#                                                 THEN '1'  
		         ELSE '0'
		    END = '1'            
			                                   
		<!-- 수집구분 -->
		<isNotEmpty property="strClcDvsnCd">
			AND A.CLC_DVSN_CD = #strClcDvsnCd#
		</isNotEmpty>
		
		<!-- 출처구분 -->
		<isNotEmpty property="strSrcDvsnCd">
			AND A.SRC_DVSN_CD = #strSrcDvsnCd#
		</isNotEmpty>
		
		<!-- 제출과 -->
		<isNotEmpty property="strSmtDptCd">
			AND A.PRSR_DPT_CD LIKE NVL(SUBSTR(#strSmtDptCd#, 0, INSTR(#strSmtDptCd#, '0000') -1), #strSmtDptCd#) || '%'
		</isNotEmpty>
		
		<!-- 소관(처리)과 -->
		<isNotEmpty property="strHndlDptCd">
			AND A.HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
		</isNotEmpty>
		
		<!-- 찜한과 -->
		<isNotEmpty property="strPopDptCd">
			AND A.AUD_DPT_CD LIKE NVL(SUBSTR(#strPopDptCd#, 0, INSTR(#strPopDptCd#, '0000') -1), #strPopDptCd#) || '%'
		</isNotEmpty>
		
		<!-- 입건과 -->
		<isNotEmpty property="strEnfDptCd">
			AND EXISTS (SELECT 1
			              FROM TBCSPBII120L B /* 감사정보관련처분내역 */
			                 , TBBADEAR002D C /* 처분요구사항상세 */
			             WHERE B.AUD_YR         = C.AUD_YR
			               AND B.AUD_NO         = C.AUD_NO
			               AND B.DSP_RQ_SNO     = C.DSP_RQ_SNO
			               AND C.ENF_BRDV_CD LIKE NVL(SUBSTR(#strEnfDptCd#, 0, INSTR(#strEnfDptCd#, '0000') -1), #strEnfDptCd#) || '%'
			               AND B.YE   = A.YE
			               AND B.SRNO = A.SRNO)			          
		</isNotEmpty>
		
		<!-- 제출자 -->
		<isNotEmpty property="strPrsrCnb">
			AND A.PRSR_CNB = #strPrsrCnb#
		</isNotEmpty>
		
		<!-- 처리자 -->
		<isNotEmpty property="strHndlPenCnb">
			AND A.HNDL_PEN_CNB = #strHndlPenCnb#
		</isNotEmpty>
		
		<!-- 찜한자 -->
		<isNotEmpty property="strPopPenCnb">
			AND A.AUD_PEN_CNB = #strPopPenCnb#
		</isNotEmpty>
		
		<!-- 입건자 -->
		<isNotEmpty property="strEnfPenCnb">
			AND EXISTS (SELECT 1
			              FROM TBCSPBII120L B /* 감사정보관련처분내역 */
			                 , TBBADEAR004M C /* 감사자기본 */
			             WHERE B.AUD_YR     = C.AUD_YR
			               AND B.AUD_NO     = C.AUD_NO
			               AND B.DSP_RQ_SNO = C.DSP_RQ_SNO
			               AND C.ETR_PEN_ID = #strEnfPenCnb#
			               AND B.YE         = A.YE
			               AND B.SRNO       = A.SRNO)			          
		</isNotEmpty>
		
		<!-- 처리결과 -->
		AND CASE WHEN #strHndlRslt1#  IS NULL AND #strHndlRslt2#  IS NULL AND #strHndlRslt3# IS NULL AND 
		              #strHndlRslt4#  IS NULL AND #strHndlRslt5#  IS NULL AND #strHndlRslt6# IS NULL AND
		              #strHndlRslt7#  IS NULL                                                            THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt1#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt2#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt3#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt4#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt5#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt6#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt7#                                                    THEN '1'
		         ELSE '0'
		    END = '1'       
		
		<!-- 진행상황 -->
		AND CASE WHEN #strPrssSta1#  IS NULL AND #strPrssSta2#  IS NULL AND #strPrssSta3# IS NULL AND 
		              #strPrssSta4#  IS NULL AND #strPrssSta5#  IS NULL AND #strPrssSta6# IS NULL AND
		              #strPrssSta7#  IS NULL AND #strPrssSta8#  IS NULL AND #strPrssSta9# IS NULL AND
		              #strPrssSta10# IS NULL AND #strPrssSta11# IS NULL AND #strPrssSta12# IS NULL AND #strPrssSta13# IS NULL AND 
		              #strPrssSta14# IS NULL AND #strPrssSta15# IS NULL    THEN '1'
		         WHEN #strPrssSta1# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('05')             THEN '1'
		         WHEN #strPrssSta2# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('10')             THEN '1'
		         WHEN #strPrssSta3# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('13')             THEN '1'
		         WHEN #strPrssSta4# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('20') THEN '1'
		         WHEN #strPrssSta5# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('15')             THEN '1'
		         WHEN #strPrssSta6# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('21', '22', '23','24','30','31','32') THEN '1'
		         WHEN #strPrssSta7# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('99')             THEN '1'
		         WHEN #strPrssSta8# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('10', '13') THEN '1'
		         WHEN #strPrssSta9# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('15')              THEN '1'
		         WHEN #strPrssSta10# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('21', '22', '23','24','30','31','32') THEN '1'
		         WHEN #strPrssSta11# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('99')             THEN '1'
		         WHEN #strPrssSta12# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('05')             THEN '1'
		         WHEN #strPrssSta13# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('02')             THEN '1'
		         WHEN #strPrssSta14# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('02')             THEN '1'
		         WHEN #strPrssSta15# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('20')             THEN '1'
		         ELSE '0'
		    END = '1'     

		<!-- 제출여부 [개인별마일리지현황>감사정보 검색 팝업화면에서 사용]-->
		<isEqual property="strUtlYn" compareValue="Y">
			AND A.UTL_ADT_SC > 0
		</isEqual>		    

		<isNotEmpty property="strGEN_ADMN_DVSN_CD">
			AND A.PRSR_CNB IN (SELECT CNB FROM TBDCMACM001M WHERE GEN_ADMN_DVSN_CD = #strGEN_ADMN_DVSN_CD#)
		</isNotEmpty>
		
		<isNotEmpty property="strBLE_CHGR_CNB">
			AND A.BLE_CHGR_CNB = #strBLE_CHGR_CNB#
		</isNotEmpty>

		ORDER BY A.YE DESC, A.SRNO DESC
	</select>	
	
	<!-- 감사정보관련자내역 목록 조회 -->   
	<select id="CSPBII120QSpcfInfSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[       
			SELECT A.SPCF_INF_CLC_NO AS CD    /* 특정정보수집번호 */
			     , A.SPCF_AUD_SBJ    AS CD_NM /* 특정감사사항 */
			  FROM TBCSPBII140M A  /* 특정정보수집기간기본 */
			 WHERE SPCF_INF_CLC_NO IN ('1','2','4') /* 기본정보 */
			
			UNION
			
			SELECT A.SPCF_INF_CLC_NO AS CD    /* 특정정보수집번호 */
			     , A.SPCF_AUD_SBJ    AS CD_NM /* 특정감사사항 */
			  FROM TBCSPBII140M A  /* 특정정보수집기간기본 */
			 /*WHERE A.STR_DT BETWEEN TO_CHAR(ADD_MONTHS(SYSDATE, -12), 'YYYYMMDD') AND TO_CHAR(SYSDATE, 'YYYYMMDD') */
			 WHERE A.STR_DT BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1||'0101' AND TO_CHAR(SYSDATE, 'YYYYMMDD') /* 전년도 특정정보 부터 현재 특정정보 까지 표시 되도록 변경 2016.05.27*/
		  ORDER BY DECODE(CD, '1', '999999', '2', '99998', '4', '99997', CD) DESC 
		]]>
	</select>
	
	<!-- 중점감사정보 목록 조회 -->   
	<select id="CSPBII120QStatusSelect" parameterClass="paramMap" resultClass="resultMap">
		SELECT TOT1 + TOT2 AS TRNF_TOT /* 이송접수 총합계  */
	    	 , TOT1 /* 금년신규 */
	    	 , TOT2 /* 전년이월 */
	    	 , TOT3 + TOT4 + TOT5 + TOT6 AS HNDL_TOT /* 처리완료 총합계 */
	    	 , TOT3 /* 입건 */
	    	 , TOT4 /* 유용 */
	    	 , TOT5 /* 불용 */
	    	 , TOT6 /* 종결 */
	    	 , TOT7 AS PDY_TOT /* 미결 */
	    FROM (
	    	   SELECT (SELECT count(*) FROM TBCSPBII100M 
	    	   						  WHERE HNDL_ORD_CD = '6' AND TRNF_DT BETWEEN #strTrnfStrDt# AND #strTrnfEndDt#
	    	   							<isNotEmpty property="strSrhTxt">
											AND TIT_TXT LIKE '%' || #strSrhTxt# || '%'
										</isNotEmpty>
										<isNotEmpty property="strHndlDptCd">
											AND HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
										</isNotEmpty>
										) AS TOT1
				 	, (SELECT count(*) FROM TBCSPBII100M 
				 					  WHERE HNDL_ORD_CD = '6' AND TRNF_DT <![CDATA[<]]> substr(#strTrnfStrDt#,0,4) AND HNDL_DT IS NULL AND HNDL_RSLT_CD IS NULL
				 						<isNotEmpty property="strSrhTxt">
											AND TIT_TXT LIKE '%' || #strSrhTxt# || '%'
										</isNotEmpty>
										<isNotEmpty property="strHndlDptCd">
											AND HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
										</isNotEmpty>
										) AS TOT2
				 	, (SELECT count(*) FROM TBCSPBII100M 
				 					  WHERE HNDL_ORD_CD = '6' AND TRNF_DT BETWEEN #strTrnfStrDt# AND #strTrnfEndDt# AND HNDL_RSLT_CD = '31'
				 						<isNotEmpty property="strSrhTxt">
											AND TIT_TXT LIKE '%' || #strSrhTxt# || '%'
										</isNotEmpty>
										<isNotEmpty property="strHndlDptCd">
											AND HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
										</isNotEmpty>
										) AS TOT3
				 	, (SELECT count(*) FROM TBCSPBII100M 
				 					  WHERE HNDL_ORD_CD = '6' AND TRNF_DT BETWEEN #strTrnfStrDt# AND #strTrnfEndDt# AND HNDL_RSLT_CD = '35'
				 						<isNotEmpty property="strSrhTxt">
											AND TIT_TXT LIKE '%' || #strSrhTxt# || '%'
										</isNotEmpty>
										<isNotEmpty property="strHndlDptCd">
											AND HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
										</isNotEmpty>
										) AS TOT4
				 	, (SELECT count(*) FROM TBCSPBII100M 
				 					  WHERE HNDL_ORD_CD = '6' AND TRNF_DT BETWEEN #strTrnfStrDt# AND #strTrnfEndDt# AND HNDL_RSLT_CD = '36'
				 						<isNotEmpty property="strSrhTxt">
											AND TIT_TXT LIKE '%' || #strSrhTxt# || '%'
										</isNotEmpty>
										<isNotEmpty property="strHndlDptCd">
											AND HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
										</isNotEmpty>
										) AS TOT5
				 	, (SELECT count(*) FROM TBCSPBII100M 
				 					  WHERE HNDL_ORD_CD = '6' AND TRNF_DT BETWEEN #strTrnfStrDt# AND #strTrnfEndDt# AND HNDL_RSLT_CD = '88'
				 						<isNotEmpty property="strSrhTxt">
											AND TIT_TXT LIKE '%' || #strSrhTxt# || '%'
										</isNotEmpty>
										<isNotEmpty property="strHndlDptCd">
											AND HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
										</isNotEmpty>
										) AS TOT6
				 	, (SELECT count(*) FROM TBCSPBII100M 
				 					  WHERE HNDL_ORD_CD = '6' AND TRNF_DT BETWEEN #strTrnfStrDt# AND #strTrnfEndDt# AND HNDL_RSLT_CD IS NULL
				 						<isNotEmpty property="strSrhTxt">
											AND TIT_TXT LIKE '%' || #strSrhTxt# || '%'
										</isNotEmpty>
										<isNotEmpty property="strHndlDptCd">
											AND HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
										</isNotEmpty>
										) AS TOT7 
				FROM DUAL
	        )
		
	</select>	
	
	
	
	<select id="CSPBII124PMainSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT /* csp.bii.service.impl.CSPBII120QServiceImpl.CSPBII120QMainSelect */
			       A.YE || '-' || A.SRNO                                           AS INF_NO
			     , A.SMT_DT
			     , A.PRSR_CNB
			     , (SELECT B.USR_NAM
			          FROM TBDCMACM001M B
			         WHERE B.CNB = A.PRSR_CNB)                                     AS PRSR_NAM
			     , CASE WHEN SUBSTR(F_CODE_NM('1000097', A.INF_DVSN_CD), 1, 2) is not null THEN '(' || SUBSTR(F_CODE_NM('1000097', A.INF_DVSN_CD), 1, 2) || ')' || A.TIT_TXT
			            ELSE A.TIT_TXT
			             END AS TIT_TXT
			     , (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.REL_ORG_CD)                                AS REL_ORG_NM
			     , A.HNDL_DPT_CD
			     , (SELECT B.ABR_DPT_NM_1
			                 FROM TBDCMACM002M B
			                WHERE B.DPT_CD = A.HNDL_DPT_CD)                        AS HNDL_DPT_NM
			     , F_CODE_NM('1000039', A.HNDL_ORD_CD)                             AS HNDL_ORD_NM		
			     , A.AUD_INF_PRSS_STA_CD	    
			     , F_CODE_NM('1000085', A.AUD_INF_PRSS_STA_CD)                     AS AUD_INF_PRSS_STA_NM
			     , A.CMPT_DT
			     , F_CODE_NM('1000042', A.HNDL_RSLT_CD)                            AS HNDL_RSLT_NM
			     , A.OPEN_YN 
			     , A.YE
			     , A.SRNO
			  FROM TBCSPBII100M A
			 WHERE 1=1
		]]>
		
		<!-- 시작 연도 -->
		<isNotEmpty property="strStrYe">
			AND A.YE >= #strStrYe#
		</isNotEmpty>
		
		<!-- 종료 연도 -->
		<isNotEmpty property="strEndYe">
			AND A.YE &lt;= #strEndYe#
		</isNotEmpty>
		
		<!-- 시작 일련번호 -->
		<isNotEmpty property="strStrSrno">
			AND A.SRNO >= #strStrSrno#
		</isNotEmpty>
		
		<!-- 종료 일련번호 -->
		<isNotEmpty property="strEndSrno">
			AND A.SRNO &lt;= #strEndSrno#
		</isNotEmpty>
		
		<!-- 제목/내용 -->
		<isNotEmpty property="strSrhTxt">
			AND (A.TIT_TXT LIKE '%' || #strSrhTxt# || '%'		
			  OR EXISTS (SELECT 1
			                FROM TBCSPBII101L B
			               WHERE INSTR(B.SCH_AUD_INF_TXT, #strSrhTxt#, 1, 1) > 0
			                 AND B.YE   = A.YE
			                 AND B.SRNO = A.SRNO))
		</isNotEmpty>
		
		<!-- 시작 기간 -->
		<isNotEmpty property="strStrDt">
			AND A.$strDtDvsnCd$ >= #strStrDt#
		</isNotEmpty>
		
		<!-- 종료 기간 -->
		<isNotEmpty property="strEndDt">
			AND A.$strDtDvsnCd$ &lt;= #strEndDt#
		</isNotEmpty>
		
		<!-- 시작관련기관 -->
		<isNotEmpty property="strStrRelOrgCd">
			<isEmpty property="strEndRelOrgCd">
				<isEqual property="strRelOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   LIKE SUBSTR(#strStrRelOrgCd#, 0, INSTR(#strStrRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_1 LIKE SUBSTR(#strStrRelOrgCd#, 0, INSTR(#strStrRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_2 LIKE SUBSTR(#strStrRelOrgCd#, 0, INSTR(#strStrRelOrgCd#, '000') -1) || '%')
				</isEqual>
				<isNotEqual property="strRelOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   = #strStrRelOrgCd#
					  OR A.REL_ORG_CD_1 = #strStrRelOrgCd#
					  OR A.REL_ORG_CD_2 = #strStrRelOrgCd#)
				</isNotEqual>	
			</isEmpty>
			<isNotEmpty property="strEndRelOrgCd">
				AND (A.REL_ORG_CD   BETWEEN #strStrRelOrgCd# AND #strEndRelOrgCd#
				  OR A.REL_ORG_CD_1 BETWEEN #strStrRelOrgCd# AND #strEndRelOrgCd#
				  OR A.REL_ORG_CD_2 BETWEEN #strStrRelOrgCd# AND #strEndRelOrgCd#)
			</isNotEmpty>
		</isNotEmpty>
		
		<!-- 종료 관련기관 -->
		<isNotEmpty property="strEndRelOrgCd">
			<isEmpty property="strStrRelOrgCd">
				<isEqual property="strRelOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   LIKE SUBSTR(#strEndRelOrgCd#, 0, INSTR(#strEndRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_1 LIKE SUBSTR(#strEndRelOrgCd#, 0, INSTR(#strEndRelOrgCd#, '000') -1) || '%'
					  OR A.REL_ORG_CD_2 LIKE SUBSTR(#strEndRelOrgCd#, 0, INSTR(#strEndRelOrgCd#, '000') -1) || '%')
				</isEqual>
				<isNotEqual property="bltOrgIclsAt" compareValue="Y">
					AND (A.REL_ORG_CD   = #strEndRelOrgCd#
					  OR A.REL_ORG_CD_1 = #strEndRelOrgCd#
					  OR A.REL_ORG_CD_2 = #strEndRelOrgCd#)
				</isNotEqual>	
			</isEmpty>
		</isNotEmpty>
		
		<!-- 정보구분 -->
		<isNotEmpty property="strInfDvsnCd">
			AND A.INF_DVSN_CD = #strInfDvsnCd#
		</isNotEmpty>

		<!-- 관련자명 -->
		<isNotEmpty property="strRelPenNam">
			AND EXISTS (SELECT 1
			              FROM TBCSPBII130L B /* 감사정보관련자내역 */
			             WHERE B.NAM  = #strRelPenNam#
			               AND B.YE   = A.YE
			               AND B.SRNO = A.SRNO
			            UNION ALL
			            SELECT 1
			              FROM TBCSPBII120L B /* 감사정보관련처분내역 */
			                 , TBBADEAR007M C /* 관계자기본 */
			             WHERE B.AUD_YR   = C.AUD_YR
			               AND B.AUD_NO   = C.AUD_NO
			               AND C.DFNT_NAM = #strRelPenNam#
			               AND B.YE       = A.YE
			               AND B.SRNO     = A.SRNO)
		</isNotEmpty>
		
		<!-- 처리지시1~3 -->
		AND CASE WHEN #strHndlOrdCd1# IS NULL AND #strHndlOrdCd2# IS NULL AND #strHndlOrdCd3# IS NULL AND #strHndlOrdCd4# IS NULL AND #strHndlOrdCd5# IS NULL THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd1#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd2#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd3#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd4#                                                 THEN '1'
		         WHEN A.HNDL_ORD_CD = #strHndlOrdCd5#                                                 THEN '1'  
		         ELSE '0'
		    END = '1'            
			                                   
		<!-- 수집구분 -->
		<isNotEmpty property="strClcDvsnCd">
			AND A.CLC_DVSN_CD = #strClcDvsnCd#
		</isNotEmpty>
		
		<!-- 출처구분 -->
		<isNotEmpty property="strSrcDvsnCd">
			AND A.SRC_DVSN_CD = #strSrcDvsnCd#
		</isNotEmpty>
		
		<!-- 제출과 -->
		<isNotEmpty property="strSmtDptCd">
			AND A.PRSR_DPT_CD LIKE NVL(SUBSTR(#strSmtDptCd#, 0, INSTR(#strSmtDptCd#, '0000') -1), #strSmtDptCd#) || '%'
		</isNotEmpty>
		
		<!-- 소관(처리)과 -->
		<isNotEmpty property="strHndlDptCd">
			AND A.HNDL_DPT_CD LIKE NVL(SUBSTR(#strHndlDptCd#, 0, INSTR(#strHndlDptCd#, '0000') -1), #strHndlDptCd#) || '%'
		</isNotEmpty>
		
		<!-- 찜한과 -->
		<isNotEmpty property="strPopDptCd">
			AND A.AUD_DPT_CD LIKE NVL(SUBSTR(#strPopDptCd#, 0, INSTR(#strPopDptCd#, '0000') -1), #strPopDptCd#) || '%'
		</isNotEmpty>
		
		<!-- 입건과 -->
		<isNotEmpty property="strEnfDptCd">
			AND EXISTS (SELECT 1
			              FROM TBCSPBII120L B /* 감사정보관련처분내역 */
			                 , TBBADEAR002D C /* 처분요구사항상세 */
			             WHERE B.AUD_YR         = C.AUD_YR
			               AND B.AUD_NO         = C.AUD_NO
			               AND B.DSP_RQ_SNO     = C.DSP_RQ_SNO
			               AND C.ENF_BRDV_CD LIKE NVL(SUBSTR(#strEnfDptCd#, 0, INSTR(#strEnfDptCd#, '0000') -1), #strEnfDptCd#) || '%'
			               AND B.YE   = A.YE
			               AND B.SRNO = A.SRNO)			          
		</isNotEmpty>
		
		<!-- 제출자 -->
		<isNotEmpty property="strPrsrCnb">
			AND A.PRSR_CNB = #strPrsrCnb#
		</isNotEmpty>
		
		<!-- 처리자 -->
		<isNotEmpty property="strHndlPenCnb">
			AND A.HNDL_PEN_CNB = #strHndlPenCnb#
		</isNotEmpty>
		
		<!-- 찜한자 -->
		<isNotEmpty property="strPopPenCnb">
			AND A.AUD_PEN_CNB = #strPopPenCnb#
		</isNotEmpty>
		
		<!-- 입건자 -->
		<isNotEmpty property="strEnfPenCnb">
			AND ((EXISTS (SELECT 1
			              FROM TBCSPBII120L B /* 감사정보관련처분내역 */
			                 , TBBADEAR004M C /* 감사자기본 */
			             WHERE B.AUD_YR     = C.AUD_YR
			               AND B.AUD_NO     = C.AUD_NO
			               AND B.DSP_RQ_SNO = C.DSP_RQ_SNO
			               AND C.ETR_PEN_ID = #strEnfPenCnb#
			               AND B.YE         = A.YE
			               AND B.SRNO       = A.SRNO)) OR (AUD_INF_PRSS_STA_CD = '36' AND AUD_PEN_CNB = #strEnfPenCnb#))			          
		</isNotEmpty>
		
		<!-- 처리결과 -->
		AND CASE WHEN #strHndlRslt1#  IS NULL AND #strHndlRslt2#  IS NULL AND #strHndlRslt3# IS NULL AND 
		              #strHndlRslt4#  IS NULL AND #strHndlRslt5#  IS NULL AND #strHndlRslt6# IS NULL AND
		              #strHndlRslt7#  IS NULL                                                            THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt1#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt2#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt3#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt4#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt5#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt6#                                                    THEN '1'
		         WHEN A.HNDL_RSLT_CD = #strHndlRslt7#                                                    THEN '1'
		         ELSE '0'
		    END = '1'       
		
		<!-- 진행상황 -->
		AND CASE WHEN #strPrssSta1#  IS NULL AND #strPrssSta2#  IS NULL AND #strPrssSta3# IS NULL AND 
		              #strPrssSta4#  IS NULL AND #strPrssSta5#  IS NULL AND #strPrssSta6# IS NULL AND
		              #strPrssSta7#  IS NULL AND #strPrssSta8#  IS NULL AND #strPrssSta9# IS NULL AND
		              #strPrssSta10# IS NULL AND #strPrssSta11# IS NULL AND #strPrssSta12# IS NULL                  THEN '1'
		         WHEN #strPrssSta1# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('05')             THEN '1'
		         WHEN #strPrssSta2# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('10')             THEN '1'
		         WHEN #strPrssSta3# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('15')             THEN '1'
		         WHEN #strPrssSta4# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('20', '32', '24') THEN '1'
		         WHEN #strPrssSta5# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('31')             THEN '1'
		         WHEN #strPrssSta6# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('21', '22', '23') THEN '1'
		         WHEN #strPrssSta7# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('99')             THEN '1'
		         WHEN #strPrssSta8# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('15', '20', '24', '32') THEN '1'
		         WHEN #strPrssSta9# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('31')              THEN '1'
		         WHEN #strPrssSta10# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('21', '22', '23') THEN '1'
		         WHEN #strPrssSta11# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('99')             THEN '1'
		         WHEN #strPrssSta12# = 'Y' AND A.AUD_INF_PRSS_STA_CD IN ('05','10')             THEN '1'
		         ELSE '0'
		    END = '1'     

		<!-- 제출여부 [개인별마일리지현황>감사정보 검색 팝업화면에서 사용]-->
		<isEqual property="strUtlYn" compareValue="Y">
			AND A.UTL_ADT_SC > 0
		</isEqual>		    

		ORDER BY A.YE DESC, A.SRNO DESC
	</select>	
</sqlMap>