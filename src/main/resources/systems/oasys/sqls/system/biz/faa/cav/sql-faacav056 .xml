<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/056"> 
	 
	<!--공지사항-->
	<select id="FAACAV056EMainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/056/FAACAV056EMainselect */ ]]>
		<include refid="include.pageSelct" />		
        <![CDATA[       
			SELECT ROWNUM AS KEY,
				   BRD_DVSN_CD,
				   SRNO,
				   GRP_NO,
			       TIT_NM,
			       REGI_DH,
			       REGI_ORG_NM,
			       REGN_ID,
			       REGN_NM,
			       SRCH_CNT,
			       TO_CHAR(TXT) AS TXT,
			       DOC_ID
			  FROM TWFAACAV065L
              WHERE 1 = 1
              AND TO_CHAR(REGI_DH,'YYYYMMDD') BETWEEN #strSrchFrom# AND #strSrchTo#
              AND BRD_DVSN_CD = 'NO'
		]]>
        <isNotEmpty property="strSrno">	 	   
			   AND SRNO     = #strSrno#
		</isNotEmpty>	
		
		<isNotEmpty property="strSrchNm">
			<isEqual property="strSndCd" compareValue="0">
			   AND  (TIT_NM like '%'||#strSrchNm#||'%' OR TXT like '%'||#strSrchNm#||'%')
			</isEqual>		
			<isEqual property="strSndCd" compareValue="1">
			   AND  TIT_NM like '%'||#strSrchNm#||'%'
			</isEqual>
			<isEqual property="strSndCd" compareValue="2">
			   AND  TXT like '%'||#strSrchNm#||'%'
			</isEqual>			
		</isNotEmpty> 
		<include refid="include.pageOrder" />		
 		ORDER BY KEY DESC
	</select>

	
	<!--게시판 insert-->
	<insert id="FAACAV056EMaininsert" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/056/FAACAV056EMaininsert */ ]]>
		INSERT INTO TWFAACAV065L
		(
			 BRD_DVSN_CD
			,SRNO
			,GRP_NO
			,RPL_SNO
			,LVL_CNT
			,TIT_NM
			,REGI_DH
			,REGI_ORG_NM
			,REGN_ID
			,REGN_NM
			,SRCH_CNT
			,TXT
			,DOC_ID
			,TNB
			,EML_AD
			,RMK
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID			
		) VALUES (
			 'NO'
			,#SRNO#
			,#GRP_NO#
			,#RPL_SNO#
			,#LVL_CNT#
			,#TIT_NM#
			,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
			,#REGI_ORG_NM#
			,#REGN_ID#
			,#REGN_NM#
			,0
			,#TXT#
			,#DOC_ID#
			,#TNB#
			,#EML_AD#
			,#RMK#
			,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
			,'TEST'
			,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
			,'TEST'
			,'TEST'
			,'TEST'			
		)
	</insert>	

	<!-- 일련번호 Max값 찾기 -->
	<select id="FAACAV056EMainMaxSnoSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/056/FAACAV056EMainMaxSnoSelect */ ]]>
        <![CDATA[     	
			    SELECT TO_CHAR(NVL(MAX(TO_NUMBER(SRNO)),0)+1) AS MAX_SEQ
				  FROM TWFAACAV065L
				 WHERE BRD_DVSN_CD = 'NO'
		]]>
	</select>

	<!-- 조회수 구하기 -->
	<select id="FAACAV056ESrchCntSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/056/FAACAV056ESrchCntSelect */ ]]>
        <![CDATA[     	
			     SELECT TO_CHAR(NVL(TO_NUMBER(SRCH_CNT),0)+1) AS CNT
				  FROM TWFAACAV065L
				 WHERE BRD_DVSN_CD = 'NO'
				 AND SRNO        = #SRNO# 
		]]>
	</select>
		
	<!--게시판 delete-->
	<delete id="FAACAV056EMainDelete" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/056/FAACAV056EMainDelete */ ]]>
		   DELETE 
			 FROM 	TWFAACAV065L
			WHERE 1=1
			  AND BRD_DVSN_CD         = 'NO' 
		      AND SRNO                = #SRNO# 
	</delete>	
	
			<!--게시판 update-->
	<update id="FAACAV056EMainUpdate" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/056/FAACAV056EMainUpdate */ ]]>
		<![CDATA[ 	
			UPDATE	TWFAACAV065L
			SET		TIT_NM = #TIT_NM#,
					TXT = #TXT#,
					DOC_ID = #DOC_ID#
		]]>	    
			WHERE	1=1
			AND		BRD_DVSN_CD = 'NO' 
			AND		SRNO = #SRNO# 
	</update>
	
	<!--조회수 update-->
	<update id="FAACAV056EMainSrchCntUpdate" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/056/FAACAV056EMainSrchCntUpdate */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV065L
			   SET SRCH_CNT                 = #SRCH_CNT# 
			  WHERE 1=1
			  AND BRD_DVSN_CD                = 'NO' 
		      AND SRNO                = #SRNO#
		]]>	    
	</update>
	
	<insert id="FAACAV056E_ENAIS_BOARD_Insert" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/056/FAACAV056E_ENAIS_BOARD_Insert */ ]]>
		<![CDATA[
			INSERT INTO EN_ENAIS_BOARD
			(
				IF_SEQ
	            ,BRD_DVSN_CD
				,SRNO
				,GRP_NO
				,TIT_NM
				,REGI_DH
				,REGI_ORG_NM
				,REGN_ID
				,REGN_NM
				,SRCH_CNT
				,TXT
				,DOC_ID
				,FRT_REGI_DH
				,FRT_USR_ID
				,FNL_MDF_DH
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
	            ,ATCH_FILE_ID
	            ,FILE_PATH
	            ,FILE_NAME
	            ,S_FILE_NAME
	            ,FILE_SIZE
	            ,FLAG
	            ,IF_STATUS
	            ,IF_TRY
	            ,IF_RAISE_DT
	            ,IF_DEAL_DT
	            ,IF_MESSG
	            ,IF_SIID
			) VALUES (
	            #IF_SEQ#
				,#BRD_DVSN_CD#
				,#SRNO#
				,#GRP_NO#
				,#TIT_NM#
				,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
				,#REGI_ORG_NM#
				,#REGN_ID#
				,#REGN_NM#
				,#SRCH_CNT#
				,#TXT#
				,#DOC_ID#
				,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
				,#REGN_ID#
				,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
				,#REGN_ID#
				,''
				,''
				,#ATCH_FILE_ID#
	            ,#FILE_PATH#
	            ,#FILE_NAME#
	            ,#S_FILE_NAME#
	            ,#FILE_SIZE#
	            ,#FLAG#
	            ,'SS'
	            ,0
	            ,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
	            ,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
	            ,''
	            ,''
			)
		]]>
	</insert>

	<update id="FAACAV056E_EH_ENAIS_BOARD_Delete">
		<![CDATA[  /* faa/cav/056/FAACAV056E_EH_ENAIS_BOARD_Delete */ ]]>
		<![CDATA[ 
			DELETE 
			 FROM EN_ENAIS_BOARD
			WHERE 1=1
			  AND BRD_DVSN_CD  = 'NO' 
		      AND SRNO         = #SRNO# 
		]]>
	</update>
	
	<!-- 공지사항 게시판 상세 데이터 조회-->
	<select id="FAACAV056EDetailselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/056/FAACAV056EDetailselect */ ]]>
        <![CDATA[       
			SELECT ROWNUM AS KEY,
				   BRD_DVSN_CD,
				   SRNO,
				   GRP_NO,
			       TIT_NM,
			       TO_CHAR(REGI_DH,'YYYYMMDD') AS REGI_DH,
			       REGN_NM,
			       SRCH_CNT,
			       TO_CHAR(TXT) AS TXT,
			       DOC_ID
			  FROM TWFAACAV065L
              WHERE 1 = 1
              AND  BRD_DVSN_CD = #strBrdDvsnCd#
		]]>
        <isNotEmpty property="strSrno">	 	   
			   AND SRNO     = #strSrno#
		</isNotEmpty>		
 			ORDER BY SRNO DESC
	</select>
	
</sqlMap> 
