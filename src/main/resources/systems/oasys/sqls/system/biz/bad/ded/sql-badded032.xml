<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="bad/ded/032">

	<!-- #################################### 월별/국과별/감사종류별/직급별/지역구분별 통계 조회 시작 ################################# -->
		<select id="BADDED032Qselect1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
                   SELECT T1.MONTH              AS MONTH
                         ,T1.MONTH              AS MONTH1
                         ,T1.BRU_NM             AS BRU_NM
                         ,T1.BRU_NM             AS BRU_NM1
                         ,T1.BRU_CD             AS BRU_CD      
                         ,T1.DPT_NM             AS DPT_NM
                         ,T1.DPT_CD             AS DPT_CD      
                         ,T1.GEN_TRIP_CATE_NM   AS GEN_TRIP_CATE_NM
                         ,T1.GEN_TRIP_CATE_CD   AS GEN_BZT_KND_CD      
                         ,T1.POS_CLASS_NM       AS POS_RANK_CD_NM
                         ,T1.AREA_KIND_NM       AS AREA_KIND_NM
                         ,SUM(T1.MAN_DAY)       AS MAN_DAY
                         ,SUM(T1.RL_FR_EXS)     AS RL_FR_EXS
                         ,SUM(T1.IN_EXP)        AS IN_EXP
                         ,SUM(T1.LEAD_EXS)      AS LEAD_EXS
                         ,SUM(T1.SPM_XPN)       AS SPM_XPN            
                     FROM TBBADDED028L T1
                    WHERE 1=1
                      AND T1.BZT_STR_DT >= #strBztStrDt#    /*출장일자FROM*/
                      AND T1.BZT_END_DT <= #strBztEndDt#    /*출장일자TO*/
 		]]>   
        <isNotEmpty property="strBruCd">	   
                      AND T1.BRU_CD      =  #strBruCd#      /*출장실국*/
        </isNotEmpty> 
        <isNotEmpty property="strDptCd">	   
                      AND T1.DPT_CD      =  #strDptCd#      /*출장부서*/  
        </isNotEmpty>
        
        <![CDATA[ 			    
                 GROUP BY T1.MONTH
                         ,T1.BRU_CD
                         ,T1.BRU_NM
                         ,T1.DPT_CD
                         ,T1.DPT_NM
                         ,T1.GEN_TRIP_CATE_CD
                         ,T1.GEN_TRIP_CATE_NM
                         ,T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM 
                 ORDER BY T1.MONTH
                         ,T1.BRU_CD
                         ,T1.DPT_CD
                         ,T1.GEN_TRIP_CATE_CD
                         ,T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM        
        ]]> 
	</select>	
	
	<select id="BADDED032EMainSelectPage1" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />	
        <![CDATA[       
                   SELECT T1.MONTH              AS MONTH
                         ,T1.MONTH              AS MONTH1
                         ,T1.BRU_NM             AS BRU_NM
                         ,T1.BRU_NM             AS BRU_NM1
                         ,T1.BRU_CD             AS BRU_CD      
                         ,T1.DPT_NM             AS DPT_NM
                         ,T1.DPT_CD             AS DPT_CD      
                         ,T1.GEN_TRIP_CATE_NM   AS GEN_TRIP_CATE_NM
                         ,T1.GEN_TRIP_CATE_CD   AS GEN_BZT_KND_CD      
                         ,T1.POS_CLASS_NM       AS POS_RANK_CD_NM
                         ,T1.AREA_KIND_NM       AS AREA_KIND_NM
                         ,SUM(T1.MAN_DAY)       AS MAN_DAY
                         ,SUM(T1.RL_FR_EXS)     AS RL_FR_EXS
                         ,SUM(T1.IN_EXP)        AS IN_EXP
                         ,SUM(T1.LEAD_EXS)      AS LEAD_EXS
                         ,SUM(T1.SPM_XPN)       AS SPM_XPN            
                     FROM TBBADDED028L T1
                    WHERE 1=1
                      AND T1.BZT_STR_DT >= #strBztStrDt#    /*출장일자FROM*/
                      AND T1.BZT_END_DT <= #strBztEndDt#    /*출장일자TO*/
 		]]>   
        <isNotEmpty property="strBruCd">	   
                      AND T1.BRU_CD      =  #strBruCd#      /*출장실국*/
        </isNotEmpty> 
        <isNotEmpty property="strDptCd">	   
                      AND T1.DPT_CD      =  #strDptCd#      /*출장부서*/  
        </isNotEmpty>
        
        <![CDATA[ 			    
                 GROUP BY T1.MONTH
                         ,T1.BRU_CD
                         ,T1.BRU_NM
                         ,T1.DPT_CD
                         ,T1.DPT_NM
                         ,T1.GEN_TRIP_CATE_CD
                         ,T1.GEN_TRIP_CATE_NM
                         ,T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM 
        ]]> 
        <include refid="include.pageOrder" />        
	</select>	
	
	
	<select id="BADDED032Qselect1_backup" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT F_DPT_INFO(AGGR.BRU_CD,'1') BRU_NM,
			       F_DPT_INFO(AGGR.BRU_CD,'1') BRU_NM1,
			       F_DPT_INFO(AGGR.DPT_CD,'1') DPT_NM ,        
			       F_CODE_NM('1000021',GEN_BZT_KND_CD) GEN_TRIP_CATE_NM,
			       AGGR.MONTH MONTH1,
			       AGGR.MONTH MONTH,
			       AGGR.BRU_CD,
			       AGGR.DPT_CD,
			       AGGR.GEN_BZT_KND_CD,
			       AGGR.POS_RANK_CD_NM,
			       AGGR.AREA_KIND_NM,
			       AGGR.MAN_DAY,
			       AGGR.RL_FR_EXS,
			       AGGR.IN_EXP,
			       AGGR.LEAD_EXS,
			       AGGR.SPM_XPN       
			  FROM (SELECT SUBSTR(TE.BZT_STR_DT, 5, 2) AS MONTH,
			               BL.BRU_CD,
			               BL.DPT_CD,
			               SITU.GEN_BZT_KND_CD,
			               NVL(F_CODE_NM('1000173',TER.PCT_RANK_CD),TER.PCT_RANK_CD) POS_RANK_CD_NM,
			               NVL(F_CODE_NM('1000023',TE.RGN_DVSN_CD),'UNKNOWN') AREA_KIND_NM,
			               SUM(TE.BZT_DCN) AS MAN_DAY,
			               NVL(SUM(TFD.RL_FR_EXS), 0) + NVL(SUM(TE.CPRG_FR_EXS),0)  AS RL_FR_EXS,    /*수도권운임추가 - 2015.05.13 yyh*/
			               SUM(TE.FDEX) + SUM(TE.LDC) + SUM(TE.DT_EXS) AS IN_EXP,
			               SUM(TE.LEAD_EXS) AS LEAD_EXS,
			               SUM(TE.SPM_XPN) AS SPM_XPN
			          FROM TBBADDED011L TE,
			               TBBADDED010L TER,
			               TBBADDED017L TFD,
			               TBBADDED002M SITU,
			               (SELECT /*+ INDEX(A KBBADBADDED005001) */
			                       PCT_CNB,
			                       SUBSTRB(MAX(BLT_BRDV_CD), 1, 3) || '000' AS BRU_CD ,
			                       MAX(BLT_BRDV_CD) AS DPT_CD
			                  FROM TBBADDED005L
			                 WHERE BZT_YR = #strBztYe#
			                 GROUP BY PCT_CNB) BL
			         WHERE TER.BZT_YR = SITU.BZT_YR
			           AND TER.BZT_SNO = SITU.BZT_SNO
			           AND BL.PCT_CNB(+) = TER.PCT_CNB
			           AND TE.BZT_YR = TER.BZT_YR
			           AND TE.BZT_SNO = TER.BZT_SNO
			           AND TE.PCT_CNB = TER.PCT_CNB
			           AND TFD.BZT_YR(+) = TE.BZT_YR
			           AND TFD.BZT_SNO(+) = TE.BZT_SNO
			           AND TFD.PCT_CNB(+) = TE.PCT_CNB
			           AND TFD.BZT_EXS_SNO(+) = TE.BZT_EXS_SNO
			           AND TFD.CALC_YN(+) = TE.CALC_YN
			           AND TE.FNL_YN = 'Y'
			           AND TE.BZT_STR_DT >= #strBztStrDt# /*출장일자FROM*/
			           AND TE.BZT_END_DT <= #strBztEndDt# /*출장일자TO*/
			           AND SITU.BZT_DVSN_CD = '2'
	
			         GROUP BY SUBSTR(TE.BZT_STR_DT, 5, 2),
			               BL.BRU_CD,
			               BL.DPT_CD,
			               SITU.GEN_BZT_KND_CD ,
			               TER.PCT_RANK_CD,
			               TE.RGN_DVSN_CD ) AGGR
			   WHERE 1=1
			     ]]>
			<isNotEmpty prepend="AND" property="strBruCd">	   
			    AGGR.BRU_CD LIKE #strBruCd#||'%'
			  </isNotEmpty> 
			<isNotEmpty prepend="AND" property="strDptCd">	   
			    AGGR.DPT_CD LIKE #strDptCd#||'%' 
			 </isNotEmpty>
			    
			    ORDER BY 5,6,7,8,10,11
      
	</select>	
	<!-- #################################### 월별/국과별/감사종류별/직급별/지역구분별 통계 조회 끝 ################################# -->
	
	<!-- #################################### 월별/국별/직급별/지역구분별 통계 조회 시작 ################################# -->
	<select id="BADDED032Qselect2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
                   SELECT T1.MONTH              AS MONTH
                         ,T1.MONTH              AS MONTH1
                         ,T1.BRU_NM             AS DPT_NM
                         ,T1.BRU_NM             AS DPT_NM1
                         ,T1.BRU_CD             AS BRU_CD
                         ,T1.POS_CLASS_NM       AS POS_RANK_CD_NM
                         ,T1.AREA_KIND_NM       AS AREA_KIND_NM
                         ,SUM(T1.MAN_DAY)       AS MAN_DAY
                         ,SUM(T1.RL_FR_EXS)     AS RL_FR_EXS
                         ,SUM(T1.IN_EXP)        AS IN_EXP
                         ,SUM(T1.LEAD_EXS)      AS LEAD_EXS
                         ,SUM(T1.SPM_XPN)       AS SPM_XPN            
                     FROM TBBADDED028L T1
                    WHERE 1=1
                      AND T1.BZT_STR_DT >= #strBztStrDt#    /*출장일자FROM*/
                      AND T1.BZT_END_DT <= #strBztEndDt#    /*출장일자TO*/
 		]]>   
        <isNotEmpty property="strBruCd">	   
                      AND T1.BRU_CD      =  #strBruCd#      /*출장실국*/
        </isNotEmpty> 

        <![CDATA[ 			    
                 GROUP BY T1.MONTH
                         ,T1.BRU_CD
                         ,T1.BRU_NM
                         ,T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM 
                 ORDER BY T1.MONTH
                         ,T1.BRU_CD
                         ,T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM        
        ]]> 	
	</select>		
	
	<select id="BADDED032EMainSelectPage2" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />		
        <![CDATA[       
                   SELECT T1.MONTH              AS MONTH
                         ,T1.MONTH              AS MONTH1
                         ,T1.BRU_NM             AS BRU_NM
                         ,T1.BRU_NM             AS BRU_NM1
                         ,T1.BRU_CD             AS BRU_CD
                         ,T1.POS_CLASS_NM       AS POS_RANK_CD_NM
                         ,T1.AREA_KIND_NM       AS AREA_KIND_NM
                         ,SUM(T1.MAN_DAY)       AS MAN_DAY
                         ,SUM(T1.RL_FR_EXS)     AS RL_FR_EXS
                         ,SUM(T1.IN_EXP)        AS IN_EXP
                         ,SUM(T1.LEAD_EXS)      AS LEAD_EXS
                         ,SUM(T1.SPM_XPN)       AS SPM_XPN            
                     FROM TBBADDED028L T1
                    WHERE 1=1
                      AND T1.BZT_STR_DT >= #strBztStrDt#    /*출장일자FROM*/
                      AND T1.BZT_END_DT <= #strBztEndDt#    /*출장일자TO*/
 		]]>   
        <isNotEmpty property="strBruCd">	   
                      AND T1.BRU_CD      =  #strBruCd#      /*출장실국*/
        </isNotEmpty> 

        <![CDATA[ 			    
                 GROUP BY T1.MONTH
                         ,T1.BRU_CD
                         ,T1.BRU_NM
                         ,T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM     
        ]]>
         	
		<include refid="include.pageOrder" /> 
	</select>	
	
	<select id="BADDED032Qselect2_backup" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT AGGR.MONTH , /*월별*/
			       AGGR.MONTH AS MONTH1 ,  /*월별1*/
			       F_DPT_INFO(AGGR.DPT_CD,'1') DPT_NM,  /*국별*/
			       F_DPT_INFO(AGGR.DPT_CD,'1') DPT_NM1,  /* 국별1*/
			       AGGR.DPT_CD ,  /*부서코드*/
			       AGGR.POS_RANK_CD_NM , /*직급*/
			       AGGR.AREA_KIND_NM , /*지역*/
			       SUM(NVL(AGGR.MAN_DAY, 0)) AS MAN_DAY ,  /*연인원*/
			       SUM(NVL(AGGR.RL_FR_EXS, 0)) + SUM(NVL(AGGR.CPRG_FR_EXS,0))  AS RL_FR_EXS ,  /*철도임 + 수도권운임추가 - 2015.05.13 yyh*/
			       SUM(AGGR.IN_EXP) AS IN_EXP ,  /*여비*/
			       SUM(AGGR.LEAD_EXS) AS LEAD_EXS ,  /*지휘비*/
			       SUM(AGGR.SPM_XPN) AS SPM_XPN  /*현장보충경비*/
			  FROM (SELECT TE.BZT_YR ,
			               TE.BZT_SNO ,
			               TE.PCT_CNB ,
			               SUBSTRB(SITU.BZT_BRDV_CD, 1, 3) || '000' AS DPT_CD ,
			               SUBSTRB(TE.BZT_STR_DT, 5, 2) AS MONTH ,
			               TE.BZT_EXS_SNO ,
			               TE.CALC_YN ,
			               SITU.BZT_TL_CNB ,
			               NVL(F_CODE_NM('1000173',TER.PCT_RANK_CD),TER.PCT_RANK_CD) POS_RANK_CD_NM,
			               NVL(F_CODE_NM('1000023',TE.RGN_DVSN_CD),'UNKNOWN') AREA_KIND_NM,
			               SUM(NVL(TE.BZT_DCN, 0)) AS MAN_DAY ,
			               (SELECT SUM(NVL(RL_FR_EXS, 0))
			                  FROM TBBADDED017L
			                 WHERE TE.PCT_CNB = PCT_CNB
			                   AND TE.BZT_EXS_SNO = BZT_EXS_SNO
			                   AND TE.CALC_YN = CALC_YN
			                   AND TE.BZT_SNO = BZT_SNO
			                   AND TE.BZT_YR= BZT_YR) AS RL_FR_EXS ,
			               SUM(NVL(TE.FDEX, 0)) + SUM(NVL(TE.LDC, 0)) + SUM(NVL(TE.DT_EXS, 0)) AS IN_EXP ,
			               SUM(NVL(TE.CPRG_FR_EXS, 0)) AS CPRG_FR_EXS,    /*수도권운임추가 - 2015.05.13 yyh*/
			               SUM(NVL(LEAD_EXS, 0)) AS LEAD_EXS ,
			               SUM(NVL(TE.SPM_XPN, 0)) AS SPM_XPN
			          FROM TBBADDED011L TE ,
			               TBBADDED010L TER ,
			               TBBADDED002M SITU
			         WHERE 1 = 1
			           AND TE.BZT_YR = TER.BZT_YR
			           AND TE.BZT_SNO = TER.BZT_SNO
			           AND TE.PCT_CNB = TER.PCT_CNB
			           AND TER.BZT_YR = SITU.BZT_YR
			           AND TER.BZT_SNO = SITU.BZT_SNO
			           AND TE.FNL_YN = 'Y'
			           AND TE.BZT_STR_DT >= #strBztStrDt#  /*화면 출장기간 from */
			           AND TE.BZT_END_DT <= #strBztEndDt# /*화면 출장기간 to*/
			           AND SITU.BZT_DVSN_CD = '2'
			         GROUP BY TE.BZT_YR,
			               TE.BZT_SNO,
			               TE.PCT_CNB,
			               SITU.BZT_BRDV_CD,
			               TE.BZT_STR_DT,
			               TE.BZT_EXS_SNO,
			               TE.CALC_YN,
			               SITU.BZT_TL_CNB,
			               TER.PCT_RANK_CD,
			               TE.RGN_DVSN_CD ) AGGR
			 WHERE 1 = 1
			 		     ]]>
			<isNotEmpty prepend="AND" property="strBruCd">	
			    AGGR.DPT_CD like #strBruCd#||'%'
			</isNotEmpty>   
			 GROUP BY AGGR.MONTH,
			       AGGR.DPT_CD,
			       AGGR.POS_RANK_CD_NM,
			       AGGR.AREA_KIND_NM
			 ORDER BY AGGR.MONTH,
			       AGGR.DPT_CD,
			       AGGR.POS_RANK_CD_NM ,
			       AGGR.AREA_KIND_NM
     
	</select>	
	<!-- #################################### 월별/국별/직급별/지역구분별 통계 조회 끝 ################################# -->
	
	<!-- #################################### 국별/직급별/ 지역구분별 통계 조회 시작 ################################# -->
	<select id="BADDED032Qselect3" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
                   SELECT T1.BRU_NM             AS GUBUN
                         ,T1.BRU_NM             AS DPT_NM
                         ,T1.BRU_CD             AS BRU_CD
                         ,T1.POS_CLASS_NM       AS POS_CLASS_NM
                         ,T1.AREA_KIND_NM       AS AREA_KIND_NM
                         ,SUM(T1.MAN_DAY)       AS MAN_DAY
                         ,SUM(T1.RL_FR_EXS)     AS RL_FR_EXS
                         ,SUM(T1.IN_EXP)        AS IN_EXP
                         ,SUM(T1.LEAD_EXS)      AS LEAD_EXS
                         ,SUM(T1.SPM_XPN)       AS SPM_XPN            
                     FROM TBBADDED028L T1
                    WHERE 1=1
                      AND T1.BZT_STR_DT >= #strBztStrDt#    /*출장일자FROM*/
                      AND T1.BZT_END_DT <= #strBztEndDt#    /*출장일자TO*/
 		]]>   
        <isNotEmpty property="strBruCd">	   
                      AND T1.BRU_CD      =  #strBruCd#      /*출장실국*/
        </isNotEmpty> 

        <![CDATA[ 			    
                 GROUP BY T1.BRU_CD
                         ,T1.BRU_NM
                         ,T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM 
                 ORDER BY T1.BRU_CD
                         ,T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM        
        ]]> 	
	</select>		
	
	<select id="BADDED032EMainSelectPage3" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />		
        <![CDATA[       
                   SELECT T1.BRU_NM             AS BRU_NM
                         ,T1.BRU_NM             AS BRU_NM1
                         ,T1.BRU_CD             AS BRU_CD
                         ,T1.POS_CLASS_NM       AS POS_RANK_CD_NM
                         ,T1.AREA_KIND_NM       AS AREA_KIND_NM
                         ,SUM(T1.MAN_DAY)       AS MAN_DAY
                         ,SUM(T1.RL_FR_EXS)     AS RL_FR_EXS
                         ,SUM(T1.IN_EXP)        AS IN_EXP
                         ,SUM(T1.LEAD_EXS)      AS LEAD_EXS
                         ,SUM(T1.SPM_XPN)       AS SPM_XPN            
                     FROM TBBADDED028L T1
                    WHERE 1=1
                      AND T1.BZT_STR_DT >= #strBztStrDt#    /*출장일자FROM*/
                      AND T1.BZT_END_DT <= #strBztEndDt#    /*출장일자TO*/
 		]]>   
        <isNotEmpty property="strBruCd">	   
                      AND T1.BRU_CD      =  #strBruCd#      /*출장실국*/
        </isNotEmpty> 

        <![CDATA[ 			    
                 GROUP BY T1.BRU_CD
                         ,T1.BRU_NM
                         ,T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM 
        ]]>
		<include refid="include.pageOrder" />         
	</select>		
	
	
	<select id="BADDED032Qselect3_backup" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
		SELECT F_DPT_INFO(AGGR.DPT_CD, '1') GUBUN,
		       F_DPT_INFO(AGGR.DPT_CD, '1') DPT_NM,
		       AGGR.DPT_CD AS BRU_CD ,
		       AGGR.POS_CLASS_NM ,
		       AGGR.AREA_KIND_NM ,
		       SUM(NVL(AGGR.MAN_DAY, 0)) AS MAN_DAY ,
		       SUM(NVL(AGGR.RL_FR_EXS, 0)) + SUM(NVL(AGGR.CPRG_FR_EXS,0)) AS RL_FR_EXS ,    /*철도임 + 수도권운임추가 - 2015.05.13 yyh*/
		       SUM(NVL(AGGR.IN_EXP, 0)) AS IN_EXP ,
		       SUM(NVL(AGGR.LEAD_EXS, 0)) AS LEAD_EXS ,
		       SUM(NVL(AGGR.SPM_XPN, 0)) AS SPM_XPN
		  FROM (SELECT TE.BZT_YR ,
		               TE.BZT_SNO ,
		               TE.PCT_CNB ,
		               SUBSTRB(SITU.BZT_BRDV_CD, 1, 3) || '000' AS DPT_CD ,
		               TE.BZT_EXS_SNO ,
		               TE.CALC_YN ,
		               SITU.BZT_TL_CNB ,
		               NVL(F_CODE_NM('1000173',TER.PCT_RANK_CD),TER.PCT_RANK_CD) POS_CLASS_NM,
		               NVL(F_CODE_NM('1000023',TE.RGN_DVSN_CD),'UNKNOWN') AREA_KIND_NM,
		               SUM(NVL(TE.BZT_DCN, 0)) AS MAN_DAY ,
		               (SELECT SUM(RL_FR_EXS)
		                  FROM TBBADDED017L
		                 WHERE TE.PCT_CNB = PCT_CNB
		                   AND TE.BZT_EXS_SNO = BZT_EXS_SNO
		                   AND TE.CALC_YN = CALC_YN
		                   AND TE.BZT_SNO = BZT_SNO
		                   AND TE.BZT_YR= BZT_YR) AS RL_FR_EXS ,
		               SUM(NVL(TE.FDEX, 0)) + SUM(NVL(TE.LDC, 0)) + SUM(NVL(TE.DT_EXS, 0)) AS IN_EXP ,
		               SUM(NVL(TE.CPRG_FR_EXS, 0)) AS CPRG_FR_EXS , /*수도권운임추가 - 2015.05.13 yyh*/
		               SUM(NVL(LEAD_EXS, 0)) AS LEAD_EXS ,
		               SUM(NVL(TE.SPM_XPN, 0)) AS SPM_XPN
		          FROM TBBADDED011L TE ,
		               TBBADDED010L TER ,
		               TBBADDED002M SITU
		         WHERE 1 = 1
		           AND TE.BZT_YR = TER.BZT_YR
		           AND TE.BZT_SNO = TER.BZT_SNO
		           AND TE.PCT_CNB = TER.PCT_CNB
		           AND TER.BZT_YR = SITU.BZT_YR
		           AND TER.BZT_SNO = SITU.BZT_SNO
		           AND TE.FNL_YN = 'Y'
		           AND TE.BZT_STR_DT >=#strBztStrDt#
		           AND TE.BZT_END_DT <= #strBztEndDt#
		           AND SITU.BZT_DVSN_CD = '2'
		         GROUP BY TE.BZT_YR,
		               TE.BZT_SNO,
		               TE.PCT_CNB,
		               SITU.BZT_BRDV_CD,
		               TE.BZT_EXS_SNO,
		               TE.CALC_YN,
		               SITU.BZT_TL_CNB,
		               TER.PCT_RANK_CD,
		               TE.RGN_DVSN_CD) AGGR
		 WHERE 1 = 1
		    ]]>
		 <isNotEmpty prepend="AND" property="strBruCd">	
		   AGGR.DPT_CD LIKE #strBruCd#||'%'
		  </isNotEmpty>
		 GROUP BY AGGR.DPT_CD,
		       AGGR.POS_CLASS_NM,
		       AGGR.AREA_KIND_NM
		 ORDER BY AGGR.DPT_CD,
		       AGGR.POS_CLASS_NM,
		       AGGR.AREA_KIND_NM
     
	</select>	
	<!-- ####################################  국별/직급별/ 지역구분별 통계 조회 끝 ################################# -->
	
	<!-- #################################### 직급별/ 지역구분별 통계 조회  시작 ################################# -->
	<select id="BADDED032Qselect4" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
                   SELECT T1.POS_CLASS_NM       AS POS_RANK_CD_NM
                         ,T1.AREA_KIND_NM       AS AREA_KIND_NM
                         ,SUM(T1.MAN_DAY)       AS MAN_DAY
                         ,SUM(T1.RL_FR_EXS)     AS RL_FR_EXS
                         ,SUM(T1.IN_EXP)        AS IN_EXP
                         ,SUM(T1.LEAD_EXS)      AS LEAD_EXS
                         ,SUM(T1.SPM_XPN)       AS SPM_XPN            
                     FROM TBBADDED028L T1
                    WHERE 1=1
                      AND T1.BZT_STR_DT >= #strBztStrDt#    /*출장일자FROM*/
                      AND T1.BZT_END_DT <= #strBztEndDt#    /*출장일자TO*/
                 GROUP BY T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM 
                 ORDER BY T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM        
        ]]> 	
	</select>		
		
	<select id="BADDED032EMainSelectPage4" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" /> 	
        <![CDATA[       
                   SELECT T1.POS_CLASS_NM       AS POS_RANK_CD_NM
                         ,T1.AREA_KIND_NM       AS AREA_KIND_NM
                         ,SUM(T1.MAN_DAY)       AS MAN_DAY
                         ,SUM(T1.RL_FR_EXS)     AS RL_FR_EXS
                         ,SUM(T1.IN_EXP)        AS IN_EXP
                         ,SUM(T1.LEAD_EXS)      AS LEAD_EXS
                         ,SUM(T1.SPM_XPN)       AS SPM_XPN            
                     FROM TBBADDED028L T1
                    WHERE 1=1
                      AND T1.BZT_STR_DT >= #strBztStrDt#    /*출장일자FROM*/
                      AND T1.BZT_END_DT <= #strBztEndDt#    /*출장일자TO*/
                 GROUP BY T1.POS_CLASS_NM
                         ,T1.AREA_KIND_NM       
        ]]> 
		<include refid="include.pageOrder" />         
	</select>	
			
	<select id="BADDED032Qselect4_backup" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT AGGR.POS_RANK_CD_NM ,
			       AGGR.AREA_KIND_NM ,
			       SUM(NVL(AGGR.MAN_DAY, 0)) AS MAN_DAY ,
			       SUM(NVL(AGGR.RL_FR_EXS, 0)) + SUM(NVL(AGGR.CPRG_FR_EXS,0)) AS RL_FR_EXS ,    /*철도임 + 수도권운임추가 - 2015.05.13 yyh*/
			       SUM(NVL(AGGR.IN_EXP, 0)) AS IN_EXP ,
			       SUM(NVL(AGGR.LEAD_EXS, 0)) AS LEAD_EXS ,
			       SUM(NVL(AGGR.SPM_XPN, 0)) AS SPM_XPN
			  FROM (SELECT TE.BZT_YR ,
			               TE.BZT_SNO ,
			               TE.PCT_CNB, /*출장자전산번호*/
			               TE.BZT_EXS_SNO, /*찰장비순번*/
			               TE.CALC_YN, /*정산여부*/
			               SITU.BZT_TL_CNB, /*출장반장전산번호*/
			               NVL(F_CODE_NM('1000173',TER.PCT_RANK_CD),TER.PCT_RANK_CD) POS_RANK_CD_NM, /*직급명*/
			               NVL(F_CODE_NM('1000023',TE.RGN_DVSN_CD),'UNKNOWN') AREA_KIND_NM, /*지역구분명    */           
			               TE.RGN_DVSN_CD, /*지역구분코드               */
			               SUM(NVL(TE.BZT_DCN, 0)) AS MAN_DAY, /*출장일수*/
			               (SELECT SUM(NVL(RL_FR_EXS, 0))
			                  FROM TBBADDED017L
			                 WHERE TE.PCT_CNB = PCT_CNB
			                   AND TE.BZT_EXS_SNO = BZT_EXS_SNO
			                   AND TE.CALC_YN = CALC_YN
			                   AND TE.BZT_SNO = BZT_SNO
			                   AND TE.BZT_YR= BZT_YR) AS RL_FR_EXS, /*철도임*/
			               SUM(NVL(TE.FDEX, 0)) + SUM(NVL(TE.LDC, 0)) + SUM(NVL(TE.DT_EXS, 0)) AS IN_EXP, /*여비*/
			               SUM(NVL(TE.CPRG_FR_EXS, 0)) AS CPRG_FR_EXS , /*수도권운임추가 - 2015.05.13 yyh*/
			               SUM(NVL(LEAD_EXS, 0)) AS LEAD_EXS, /*지휘비*/
			               SUM(NVL(TE.SPM_XPN, 0)) AS SPM_XPN /*현장보충비*/
			          FROM TBBADDED011L TE ,
			               TBBADDED010L TER ,
			               TBBADDED002M SITU
			         WHERE 1 = 1
			           AND TE.BZT_YR = TER.BZT_YR
			           AND TE.BZT_SNO = TER.BZT_SNO
			           AND TE.PCT_CNB = TER.PCT_CNB
			           AND TER.BZT_YR = SITU.BZT_YR
			           AND TER.BZT_SNO = SITU.BZT_SNO
			           AND TE.FNL_YN = 'Y'
			           AND TE.BZT_STR_DT >= #strBztStrDt#  /*화면출장기간 from*/
			           AND TE.BZT_END_DT <= #strBztEndDt#  /*화면출장기간 to*/
			           AND SITU.BZT_DVSN_CD = '2'  /*일반출장*/
			         GROUP BY TE.BZT_YR,
			               TE.BZT_SNO,
			               TE.PCT_CNB,
			               TE.BZT_EXS_SNO,
			               TE.CALC_YN,
			               SITU.BZT_TL_CNB,
			               TER.PCT_RANK_CD,
			               TE.RGN_DVSN_CD
			                ) AGGR
			 GROUP BY AGGR.POS_RANK_CD_NM,
			          AGGR.AREA_KIND_NM 
			 order by 1,2
        ]]>
	</select>	
	<!-- #################################### 직급별/ 지역구분별 합계 조회 끝 ################################# -->
</sqlMap> 

