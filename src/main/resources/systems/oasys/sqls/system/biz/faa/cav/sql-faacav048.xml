<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/048"> 
	 
	<select id="FAACAV048ERselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/048/FAACAV048ERselect */ ]]>
		WITH AAA AS (
		    SELECT  'A' AS GUBUN,
		            ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWASITM_CD,
		            ACCT_CD,
		            CHIF_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            EXPN_AMT,
		            TOTAMT,
		            SUM(TOTAMT - EXPN_AMT) AS CHA
		    FROM   (SELECT  A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.COPT_CD||'-'||A.ACNT_CD AS TCODE,
		                    A.ACCT_CD||'-'||A.CHIF_CD||'-'||A.SSEC_CD||'-'||A.DITM_CD||'-'||A.SITM_CD AS TKWASITM_CD,
		                    A.ACCT_CD,
		                    A.CHIF_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    B.EXPN_AMT,
		                    SUM(A.TOT_CLSG_AMT_2) AS TOTAMT
		            FROM    TWFAACAV061L A,
		                    TWFAACAV039L B
		            WHERE   A.ACNT_YR = #strYr#
		            AND     A.CLSG_DVSN_CD = 'A'
		            AND     A.ACNT_YR = B.ACNT_YR
		            AND     A.COPT_CD = B.COPT_CD
		            AND     A.ACNT_CD = B.ACNT_CD
		            AND     A.ACCT_CD = B.ACCT_CD
		            AND     A.CHIF_CD = B.CHIF_CD
		            AND     A.SSEC_CD = B.SSEC_CD
		            AND     A.DITM_CD = B.DITM_CD
		            AND     A.SITM_CD = B.SITM_CD
		            GROUP BY A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.ACCT_CD,
		                    A.CHIF_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    B.EXPN_AMT
		            ) MST
		    WHERE   MST.EXPN_AMT != MST.TOTAMT
		    GROUP BY ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWASITM_CD,
		            ACCT_CD,
		            CHIF_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            EXPN_AMT,
		            TOTAMT
		            
		    UNION ALL
		
		    SELECT  'B' AS GUBUN,
		            ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWASITM_CD,
		            ACCT_CD,
		            CHIF_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            EXPN_AMT,
		            TOTAMT,
		            SUM(TOTAMT - EXPN_AMT) AS CHA
		    FROM   (SELECT  A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.COPT_CD||'-'||A.ACNT_CD AS TCODE,
		                    A.ACCT_CD||'-'||A.CHIF_CD||'-'||A.SSEC_CD||'-'||A.DITM_CD||'-'||A.SITM_CD AS TKWASITM_CD,
		                    A.ACCT_CD,
		                    A.CHIF_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    0 AS EXPN_AMT,
		                    SUM(A.TOT_CLSG_AMT_2) AS TOTAMT
		            FROM    TWFAACAV061L A
		            WHERE   A.ACNT_YR = #strYr#
		            AND     A.CLSG_DVSN_CD = 'A'
		            AND     A.SUM_DVSN_ID NOT IN ('49','51')
		            AND     NOT EXISTS (SELECT  'X'
		                                FROM    TWFAACAV039L B
		                                WHERE   A.ACNT_YR = B.ACNT_YR
		                                AND     A.COPT_CD = B.COPT_CD
		                                AND     A.ACNT_CD = B.ACNT_CD
		                                AND     A.ACCT_CD = B.ACCT_CD
		                                AND     A.CHIF_CD = B.CHIF_CD
		                                AND     A.SSEC_CD = B.SSEC_CD
		                                AND     A.DITM_CD = B.DITM_CD
		                                AND     A.SITM_CD = B.SITM_CD
		                                )
		            GROUP BY A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.ACCT_CD,
		                    A.CHIF_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD
		            ) SUB_1
		    GROUP BY ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWASITM_CD,
		            ACCT_CD,
		            CHIF_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            EXPN_AMT,
		            TOTAMT
		            
		    UNION ALL
		
		
		    SELECT  'C' AS GUBUN,
		            ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWASITM_CD,
		            ACCT_CD,
		            CHIF_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            EXPN_AMT,
		            TOTAMT,
		            SUM(TOTAMT - EXPN_AMT) AS CHA
		    FROM   (SELECT  A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.COPT_CD||'-'||A.ACNT_CD AS TCODE,
		                    A.ACCT_CD||'-'||A.CHIF_CD||'-'||A.SSEC_CD||'-'||A.DITM_CD||'-'||A.SITM_CD AS TKWASITM_CD,
		                    A.ACCT_CD,
		                    A.CHIF_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    A.EXPN_AMT AS EXPN_AMT,
		                    0 AS TOTAMT
		            FROM    TWFAACAV039L A
		            WHERE   A.ACNT_YR = #strYr#
		            AND     A.EXPN_AMT != 0
		            AND     NOT EXISTS (SELECT  'X'
		                                FROM    TWFAACAV061L B
		                                WHERE   A.ACNT_YR = B.ACNT_YR
		                                AND     A.COPT_CD = B.COPT_CD
		                                AND     A.ACNT_CD = B.ACNT_CD
		                                AND     A.ACCT_CD = B.ACCT_CD
		                                AND     A.CHIF_CD = B.CHIF_CD
		                                AND     A.SSEC_CD = B.SSEC_CD
		                                AND     A.DITM_CD = B.DITM_CD
		                                AND     A.SITM_CD = B.SITM_CD
		                                AND     B.CLSG_DVSN_CD = 'A'
		                                AND     B.SUM_DVSN_ID NOT IN ('49','51')
		                                )
		            GROUP BY A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.ACCT_CD,
		                    A.CHIF_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    A.EXPN_AMT
		            ) SUB_2
		    GROUP BY ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWASITM_CD,
		            ACCT_CD,
		            CHIF_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            EXPN_AMT,
		            TOTAMT
		    ORDER BY 1,3,4,6
		    )
		
		SELECT  A.GUBUN AS 구분,
		        A.TCODE||A.TKWASITM_CD AS 분류,
		        A.TCODE AS 소관회계,
		        A.TKWASITM_CD AS 예산과목,
		        A.EXPN_AMT AS 기재부제출자료,
		        B.TOT_CLSG_AMT_2 AS 당원제출자료,
		        A.TOTAMT AS 당원제출합계,
		        SUM(A.TOTAMT - A.EXPN_AMT) AS 차액,
		        B.COPT_CD||'-'||B.ACNT_CD||'-'||B.BLL_CD||'-'||B.PROF_DRTR_SRNO||'-'||B.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호,
		        B.ACCT_CD||'-'||B.CHIF_CD||'-'||B.SSEC_CD||'-'||B.DITM_CD||'-'||B.SITM_CD  as 예산과목DTL,
		        C.ORG_NM AS 기관명
		FROM    AAA A,
		        TWFAACAV061L B,
		        TWFAACAV003M C
		WHERE   B.ACNT_YR = #strYr#
		AND     B.CLSG_DVSN_CD = 'A'
		AND     A.COPT_CD = B.COPT_CD
		AND     A.ACNT_CD = B.ACNT_CD
		AND     A.ACCT_CD = B.ACCT_CD
		AND     A.CHIF_CD = B.CHIF_CD
		AND     A.SSEC_CD = B.SSEC_CD
		AND     A.DITM_CD = B.DITM_CD
		AND     A.SITM_CD = B.SITM_CD
		AND     C.COPT_CD = B.COPT_CD(+)
		AND     C.ACNT_CD = B.ACNT_CD(+)
		AND     C.BLL_CD = B.BLL_CD(+)
		AND     C.PROF_DRTR_SRNO = B.PROF_DRTR_SRNO(+)
		AND     C.DL_XPN_RCDB_PBSVT_SRNO = B.DL_XPN_RCDB_PBSVT_SRNO(+)
		AND     A.GUBUN IN ('A','B')
		GROUP BY A.GUBUN,
		        A.TCODE,
		        A.TKWASITM_CD,
		        A.EXPN_AMT,
		        A.TOTAMT,
		        B.TOT_CLSG_AMT_2,
		        B.COPT_CD||'-'||B.ACNT_CD||'-'||B.BLL_CD||'-'||B.PROF_DRTR_SRNO||'-'||B.DL_XPN_RCDB_PBSVT_SRNO,
		        B.ACCT_CD||'-'||B.CHIF_CD||'-'||B.SSEC_CD||'-'||B.DITM_CD||'-'||B.SITM_CD,
		        C.ORG_NM
		
		UNION ALL
		
		SELECT  A.GUBUN AS 구분,
		        A.TCODE||A.TKWASITM_CD AS 분류,
		        A.TCODE AS 소관회계,
		        A.TKWASITM_CD AS 예산과목,
		        A.EXPN_AMT AS 기재부제출자료,
		        A.TOTAMT AS 당원제출자료,
		        A.TOTAMT AS 당원제출합계,
		        A.CHA AS 차액,
		        '' AS 증명책임자부호,
		        ''  as 예산과목DTL,
		        '' AS 기관명
		FROM    AAA A,
		        TWFAACAV039L B
		WHERE   A.ACNT_YR = #strYr#
		AND     A.COPT_CD(+) = B.COPT_CD
		AND     A.ACNT_CD(+) = B.ACNT_CD
		AND     A.ACCT_CD(+) = B.ACCT_CD
		AND     A.CHIF_CD(+) = B.CHIF_CD
		AND     A.SSEC_CD(+) = B.SSEC_CD
		AND     A.DITM_CD(+) = B.DITM_CD
		AND     A.SITM_CD(+) = B.SITM_CD
		AND     A.GUBUN = 'C'
		GROUP BY A.GUBUN,
		        A.TCODE,
		        A.TKWASITM_CD,
		        A.EXPN_AMT,
		        A.TOTAMT,
		        A.CHA
	</select>
	
	<select id="FAACAV048ERselect2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/048/FAACAV048ERselect2 */ ]]>
		WITH MST AS(
		    SELECT  'A' AS GUBUN,
		            ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            CLCT_DCS_AMT,
		            JINGSU_AMT,
		            SUM(JINGSU_AMT - CLCT_DCS_AMT) AS CHAI_AMT
		    FROM   (SELECT  A.ACNT_YR,
		                    A.DTIL_COPT_CD AS COPT_CD,
		                    A.ACNT_CD,
		                    A.DTIL_COPT_CD||'-'||A.ACNT_CD AS TCODE,
		                    A.ACCT_CD||'-'||A.SSEC_CD||'-'||A.DITM_CD||'-'||A.SITM_CD AS TKWAMOK,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    B.CLCT_DCS_AMT,
		                    SUM(A.TOT_CLSG_AMT_1) AS JINGSU_AMT
		            FROM    TWFAACAV061L A,
		                    TWFAACAV038L B
		            WHERE   A.ACNT_YR = B.ACNT_YR
		            AND     A.DTIL_COPT_CD = B.COPT_CD
		            AND     A.ACNT_CD = B.ACNT_CD
		            AND     A.ACCT_CD = B.ACCT_CD
		            AND     A.SSEC_CD = LTRIM(RTRIM(B.SSEC_CD))
		            AND     A.DITM_CD = LTRIM(RTRIM(SUBSTR(B.DITM_CD,1,2)))
		            AND     A.SITM_CD = B.SITM_CD
		            AND     A.ACNT_YR = #strYr#
		            AND     A.CLSG_DVSN_CD = 'B'
		            AND    (A.TOT_CLSG_AMT_1 != 0
		            OR      B.CLCT_DCS_AMT != 0)
		            GROUP BY A.ACNT_YR,
		                    A.DTIL_COPT_CD,
		                    A.ACNT_CD,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    B.CLCT_DCS_AMT
		            ) M1
		    WHERE   M1.CLCT_DCS_AMT != M1.JINGSU_AMT
		    GROUP BY ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            CLCT_DCS_AMT,
		            JINGSU_AMT
		
		    UNION
		
		    SELECT  'B' AS GUBUN,
		            ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            CLCT_DCS_AMT,
		            JINGSU_AMT,
		            SUM(JINGSU_AMT - CLCT_DCS_AMT) AS CHAI_AMT
		    FROM   (SELECT  A.ACNT_YR,
		                    A.DTIL_COPT_CD AS COPT_CD,
		                    A.ACNT_CD,
		                    A.DTIL_COPT_CD||'-'||A.ACNT_CD AS TCODE,
		                    A.ACCT_CD||'-'||A.SSEC_CD||'-'||A.DITM_CD||'-'||A.SITM_CD AS TKWAMOK,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    0 AS CLCT_DCS_AMT,
		                    SUM(A.TOT_CLSG_AMT_1) AS JINGSU_AMT
		            FROM    TWFAACAV061L A
		            WHERE   A.ACNT_YR = #strYr#
		            AND     A.CLSG_DVSN_CD = 'B'
		            AND     A.SUM_DVSN_ID = '11'
		            AND     A.TOT_CLSG_AMT_1 != 0
		            AND     NOT EXISTS (SELECT  'X'
		                                FROM    TWFAACAV038L B
		                                WHERE   A.ACNT_YR = B.ACNT_YR
		                                AND     A.DTIL_COPT_CD = B.COPT_CD
		                                AND     A.ACNT_CD = B.ACNT_CD
		                                AND     A.ACCT_CD = B.ACCT_CD
		                                AND     A.SSEC_CD = LTRIM(RTRIM(B.SSEC_CD))
		                                AND     A.DITM_CD = LTRIM(RTRIM(SUBSTR(B.DITM_CD,1,2)))
		                                AND     A.SITM_CD = B.SITM_CD)
		            GROUP BY A.ACNT_YR,
		                    A.DTIL_COPT_CD,
		                    A.ACNT_CD,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD
		            ) M2
		    GROUP BY ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            CLCT_DCS_AMT,
		            JINGSU_AMT
		
		    UNION
		
		    SELECT  'C' AS GUBUN,
		            ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            CLCT_DCS_AMT,
		            JINGSU_AMT,
		            -CLCT_DCS_AMT AS CHAI_AMT
		    FROM   (SELECT  A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.COPT_CD||'-'||A.ACNT_CD AS TCODE,
		                    A.ACCT_CD||'-'||LTRIM(RTRIM(A.SSEC_CD))||'-'||LTRIM(RTRIM(SUBSTR(A.DITM_CD,1,2)))||'-'||A.SITM_CD AS TKWAMOK,
		                    A.ACCT_CD,
		                    LTRIM(RTRIM(A.SSEC_CD)) AS SSEC_CD,
		                    LTRIM(RTRIM(SUBSTR(A.DITM_CD,1,2))) AS DITM_CD,
		                    A.SITM_CD,
		                    A.CLCT_DCS_AMT,
		                    0 AS JINGSU_AMT
		            FROM    TWFAACAV038L A
		            WHERE   A.ACNT_YR = #strYr#
		            AND     A.CLCT_DCS_AMT != 0
		            AND     NOT EXISTS (SELECT  'X'
		                                FROM    TWFAACAV061L B
		                                WHERE   A.ACNT_YR = B.ACNT_YR
		                                AND     A.COPT_CD = B.DTIL_COPT_CD
		                                AND     A.ACNT_CD = B.ACNT_CD
		                                AND     A.ACCT_CD = B.ACCT_CD
		                                AND     LTRIM(RTRIM(A.SSEC_CD)) = B.SSEC_CD
		                                AND     LTRIM(RTRIM(SUBSTR(A.DITM_CD,1,2))) = B.DITM_CD
		                                AND     A.SITM_CD = B.SITM_CD
		                                AND     B.CLSG_DVSN_CD = 'B'
		                                AND     B.SUM_DVSN_ID = '11')
		            GROUP BY A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    A.CLCT_DCS_AMT
		            ) M3
		    GROUP BY ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            CLCT_DCS_AMT
		)
		
		SELECT  A.GUBUN AS 구분,
		        A.TCODE||A.TKWAMOK AS 분류,
		        A.TCODE AS 소관회계,
		        A.TKWAMOK AS 예산과목,
		        A.CLCT_DCS_AMT AS 기재부제출자료,
		        B.TOT_CLSG_AMT_1 AS 당원제출자료,
		        A.JINGSU_AMT AS 당원제출합계,
		        SUM(A.JINGSU_AMT - A.CLCT_DCS_AMT) 차액,
		        B.COPT_CD||'-'||B.ACNT_CD||'-'||B.BLL_CD||'-'||B.PROF_DRTR_SRNO||'-'||B.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호,
		        B.ACCT_CD||'-'||B.SSEC_CD||'-'||B.DITM_CD||'-'||B.SITM_CD AS 예산과목DTL,
		        C.ORG_NM AS 기관명
		FROM    MST AS A,
		        TWFAACAV061L B,
		        TWFAACAV003M C
		WHERE   A.ACNT_YR = B.ACNT_YR
		AND     A.COPT_CD = B.DTIL_COPT_CD
		AND     A.ACNT_CD = B.ACNT_CD
		AND     A.ACCT_CD = B.ACCT_CD
		AND     A.SSEC_CD = B.SSEC_CD
		AND     A.DITM_CD = B.DITM_CD
		AND     A.SITM_CD = B.SITM_CD
		AND     B.COPT_CD = C.COPT_CD
		AND     B.ACNT_CD = C.ACNT_CD
		AND     B.BLL_CD  = C.BLL_CD
		AND     B.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO
		AND     B.DL_XPN_RCDB_PBSVT_SRNO  = C.DL_XPN_RCDB_PBSVT_SRNO 
		AND     B.ACNT_YR = #strYr#
		AND     B.CLSG_DVSN_CD = 'B'
		AND     A.GUBUN IN ('A','B')
		AND     B.TOT_CLSG_AMT_1 != 0
		GROUP BY A.GUBUN,
		        A.TCODE,
		        A.TKWAMOK,
		        A.CLCT_DCS_AMT,
		        B.TOT_CLSG_AMT_1,
		        A.JINGSU_AMT,
		        B.COPT_CD||'-'||B.ACNT_CD||'-'||B.BLL_CD||'-'||B.PROF_DRTR_SRNO||'-'||B.DL_XPN_RCDB_PBSVT_SRNO,
		        B.ACCT_CD||'-'||B.SSEC_CD||'-'||B.DITM_CD||'-'||B.SITM_CD,
		        C.ORG_NM
		
		UNION
		
		SELECT  A.GUBUN AS 구분,
		        A.TCODE||A.TKWAMOK AS 분류,
		        A.TCODE AS 소관회계,
		        A.TKWAMOK AS 예산과목,
		        A.CLCT_DCS_AMT AS 기재부제출자료,
		        A.JINGSU_AMT AS 당원제출자료,
		        A.JINGSU_AMT AS 당원제출합계,
		        A.CHAI_AMT AS 차액,
		        '' AS 증명책임자부호,
		        '' AS 예산과목DTL,
		        '' AS 기관명
		FROM    MST AS A,
		        TWFAACAV038L B
		WHERE   A.ACNT_YR = B.ACNT_YR
		AND     A.COPT_CD = B.COPT_CD
		AND     A.ACNT_CD = B.ACNT_CD
		AND     A.ACCT_CD = B.ACCT_CD
		AND     A.SSEC_CD = LTRIM(RTRIM(B.SSEC_CD))
		AND     A.DITM_CD = LTRIM(RTRIM(SUBSTR(B.DITM_CD,1,2)))
		AND     A.SITM_CD = B.SITM_CD
		AND     B.ACNT_YR = #strYr#
		AND     A.GUBUN = 'C'
		ORDER BY 3,4,9
	</select>
	
	<select id="FAACAV048ERselect3" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/048/FAACAV048ERselect3 */ ]]>
		WITH MST AS(
		    SELECT  'A' AS GUBUN,
		            ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            RCP_AMT,
		            JINGSU_AMT,
		            SUM(JINGSU_AMT - RCP_AMT) AS CHAI_AMT
		    FROM   (SELECT  A.ACNT_YR,
		                    A.DTIL_COPT_CD AS COPT_CD,
		                    A.ACNT_CD,
		                    A.DTIL_COPT_CD||'-'||A.ACNT_CD AS TCODE,
		                    A.ACCT_CD||'-'||A.SSEC_CD||'-'||A.DITM_CD||'-'||A.SITM_CD AS TKWAMOK,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    B.RCP_AMT,
		                    SUM(A.TOT_CLSG_AMT_2) AS JINGSU_AMT
		            FROM    TWFAACAV061L A,
		                    TWFAACAV038L B
		            WHERE   A.ACNT_YR = B.ACNT_YR
		            AND     A.DTIL_COPT_CD = B.COPT_CD
		            AND     A.ACNT_CD = B.ACNT_CD
		            AND     A.ACCT_CD = B.ACCT_CD
		            AND     A.SSEC_CD = LTRIM(RTRIM(B.SSEC_CD))
		            AND     A.DITM_CD = LTRIM(RTRIM(SUBSTR(B.DITM_CD,1,2)))
		            AND     A.SITM_CD = B.SITM_CD
		            AND     A.ACNT_YR = #strYr#
		            AND     A.CLSG_DVSN_CD = 'B'
		            AND    (A.TOT_CLSG_AMT_2 != 0
		            OR      B.RCP_AMT != 0)
		            GROUP BY A.ACNT_YR,
		                    A.DTIL_COPT_CD,
		                    A.ACNT_CD,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    B.RCP_AMT
		            ) M1
		    WHERE   M1.RCP_AMT != M1.JINGSU_AMT
		    GROUP BY ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            RCP_AMT,
		            JINGSU_AMT
		
		    UNION
		
		    SELECT  'B' AS GUBUN,
		            ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            RCP_AMT,
		            JINGSU_AMT,
		            SUM(JINGSU_AMT - RCP_AMT) AS CHAI_AMT
		    FROM   (SELECT  A.ACNT_YR,
		                    A.DTIL_COPT_CD AS COPT_CD,
		                    A.ACNT_CD,
		                    A.DTIL_COPT_CD||'-'||A.ACNT_CD AS TCODE,
		                    A.ACCT_CD||'-'||A.SSEC_CD||'-'||A.DITM_CD||'-'||A.SITM_CD AS TKWAMOK,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    0 AS RCP_AMT,
		                    SUM(A.TOT_CLSG_AMT_2) AS JINGSU_AMT
		            FROM    TWFAACAV061L A
		            WHERE   A.ACNT_YR = #strYr#
		            AND     A.CLSG_DVSN_CD = 'B'
		            AND     A.SUM_DVSN_ID = '11'
		            AND     A.TOT_CLSG_AMT_2 != 0
		            AND     NOT EXISTS (SELECT  'X'
		                                FROM    TWFAACAV038L B
		                                WHERE   A.ACNT_YR = B.ACNT_YR
		                                AND     A.DTIL_COPT_CD = B.COPT_CD
		                                AND     A.ACNT_CD = B.ACNT_CD
		                                AND     A.ACCT_CD = B.ACCT_CD
		                                AND     A.SSEC_CD = LTRIM(RTRIM(B.SSEC_CD))
		                                AND     A.DITM_CD = LTRIM(RTRIM(SUBSTR(B.DITM_CD,1,2)))
		                                AND     A.SITM_CD = B.SITM_CD)
		            GROUP BY A.ACNT_YR,
		                    A.DTIL_COPT_CD,
		                    A.ACNT_CD,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD
		            ) M2
		    GROUP BY ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            RCP_AMT,
		            JINGSU_AMT
		
		    UNION
		
		    SELECT  'C' AS GUBUN,
		            ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            RCP_AMT,
		            JINGSU_AMT,
		            -RCP_AMT AS CHAI_AMT
		    FROM   (SELECT  A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.COPT_CD||'-'||A.ACNT_CD AS TCODE,
		                    A.ACCT_CD||'-'||LTRIM(RTRIM(A.SSEC_CD))||'-'||LTRIM(RTRIM(SUBSTR(A.DITM_CD,1,2)))||'-'||A.SITM_CD AS TKWAMOK,
		                    A.ACCT_CD,
		                    LTRIM(RTRIM(A.SSEC_CD)) AS SSEC_CD,
		                    LTRIM(RTRIM(SUBSTR(A.DITM_CD,1,2))) AS DITM_CD,
		                    A.SITM_CD,
		                    A.RCP_AMT,
		                    0 AS JINGSU_AMT
		            FROM    TWFAACAV038L A
		            WHERE   A.ACNT_YR = #strYr#
		            AND     A.RCP_AMT != 0
		            AND     NOT EXISTS (SELECT  'X'
		                                FROM    TWFAACAV061L B
		                                WHERE   A.ACNT_YR = B.ACNT_YR
		                                AND     A.COPT_CD = B.DTIL_COPT_CD
		                                AND     A.ACNT_CD = B.ACNT_CD
		                                AND     A.ACCT_CD = B.ACCT_CD
		                                AND     LTRIM(RTRIM(A.SSEC_CD)) = B.SSEC_CD
		                                AND     LTRIM(RTRIM(SUBSTR(A.DITM_CD,1,2))) = B.DITM_CD
		                                AND     A.SITM_CD = B.SITM_CD
		                                AND     B.CLSG_DVSN_CD = 'B'
		                                AND     B.SUM_DVSN_ID = '11')
		            GROUP BY A.ACNT_YR,
		                    A.COPT_CD,
		                    A.ACNT_CD,
		                    A.ACCT_CD,
		                    A.SSEC_CD,
		                    A.DITM_CD,
		                    A.SITM_CD,
		                    A.RCP_AMT
		            ) M3
		    GROUP BY ACNT_YR,
		            COPT_CD,
		            ACNT_CD,
		            TCODE,
		            TKWAMOK,
		            ACCT_CD,
		            SSEC_CD,
		            DITM_CD,
		            SITM_CD,
		            RCP_AMT
		)
		
		SELECT  A.GUBUN AS 구분,
		        A.TCODE||A.TKWAMOK AS 분류,
		        A.TCODE AS 소관회계,
		        A.TKWAMOK AS 예산과목,
		        A.RCP_AMT AS 기재부제출자료,
		        B.TOT_CLSG_AMT_2 AS 당원제출자료,
		        A.JINGSU_AMT AS 당원제출합계,
		        SUM(A.JINGSU_AMT - A.RCP_AMT) 차액,
		        B.COPT_CD||'-'||B.ACNT_CD||'-'||B.BLL_CD||'-'||B.PROF_DRTR_SRNO||'-'||B.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호,
		        B.ACCT_CD||'-'||B.SSEC_CD||'-'||B.DITM_CD||'-'||B.SITM_CD AS 예산과목DTL,
		        C.ORG_NM AS 기관명
		FROM    MST AS A,
		        TWFAACAV061L B,
		        TWFAACAV003M C
		WHERE   A.ACNT_YR = B.ACNT_YR
		AND     A.COPT_CD = B.DTIL_COPT_CD
		AND     A.ACNT_CD = B.ACNT_CD
		AND     A.ACCT_CD = B.ACCT_CD
		AND     A.SSEC_CD = B.SSEC_CD
		AND     A.DITM_CD = B.DITM_CD
		AND     A.SITM_CD = B.SITM_CD
		AND     B.DTIL_COPT_CD = C.COPT_CD
		AND     B.ACNT_CD = C.ACNT_CD
		AND     B.BLL_CD  = C.BLL_CD
		AND     B.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO
		AND     B.DL_XPN_RCDB_PBSVT_SRNO  = C.DL_XPN_RCDB_PBSVT_SRNO 
		AND     B.ACNT_YR = #strYr#
		AND     B.CLSG_DVSN_CD = 'B'
		AND     A.GUBUN IN ('A','B')
		AND     B.TOT_CLSG_AMT_2 != 0
		GROUP BY A.GUBUN,
		        A.TCODE,
		        A.TKWAMOK,
		        A.RCP_AMT,
		        B.TOT_CLSG_AMT_2,
		        A.JINGSU_AMT,
		        B.COPT_CD||'-'||B.ACNT_CD||'-'||B.BLL_CD||'-'||B.PROF_DRTR_SRNO||'-'||B.DL_XPN_RCDB_PBSVT_SRNO,
		        B.ACCT_CD||'-'||B.SSEC_CD||'-'||B.DITM_CD||'-'||B.SITM_CD,
		        C.ORG_NM
		
		UNION
		
		SELECT  A.GUBUN AS 구분,
		        A.TCODE||A.TKWAMOK AS 분류,
		        A.TCODE AS 소관회계,
		        A.TKWAMOK AS 예산과목,
		        A.RCP_AMT AS 기재부제출자료,
		        A.JINGSU_AMT AS 당원제출자료,
		        A.JINGSU_AMT AS 당원제출합계,
		        A.CHAI_AMT AS 차액,
		        '' AS 증명책임자부호,
		        '' AS 예산과목DTL,
		        '' AS 기관명
		FROM    MST AS A,
		        TWFAACAV038L B
		WHERE   A.ACNT_YR = B.ACNT_YR
		AND     A.COPT_CD = B.COPT_CD
		AND     A.ACNT_CD = B.ACNT_CD
		AND     A.ACCT_CD = B.ACCT_CD
		AND     A.SSEC_CD = LTRIM(RTRIM(B.SSEC_CD))
		AND     A.DITM_CD = LTRIM(RTRIM(SUBSTR(B.DITM_CD,1,2)))
		AND     A.SITM_CD = B.SITM_CD
		AND     B.ACNT_YR = #strYr#
		AND     A.GUBUN = 'C'
		ORDER BY 3,4,9
	</select>		
</sqlMap> 

