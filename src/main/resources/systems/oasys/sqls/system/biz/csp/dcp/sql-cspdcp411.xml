<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/dcp/411">

	
 	<select id="CSPDCP412ECodeSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	CD, USR_DFN_TXT_1 AS CD_NM
			FROM	TBDCMACM013C 
			WHERE	CMM_CD_DVSN_CD = '1000128'
			AND		CD <> '000000000'
			
		]]>
	</select>
	
	<select id="CSPDCP412EDptSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	DPT_CD
					,DPT_NM 
					,HIRK_DPT_CD AS HST_DPT_CD
			FROM	TBDCMACM002M 
			WHERE	DPT_CD NOT LIKE '%000'
			AND		USE_YN ='Y' 
		]]>
	</select>
	
	<select id="CSPDCP412EHstDptSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	DPT_CD
					,DPT_NM 
			FROM	TBDCMACM002M 
			WHERE	DPT_CD <>  '000000'
			AND		DPT_CD LIKE '%000'
			AND		USE_YN ='Y' 
		]]>
	</select>
	
 	<select id="CSPDCP411QMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.RM_CVPT_ACP_NO
   					,A.ACP_YR||'-민원-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,A.CVPT_KND_CD
   					,CASE WHEN (	SELECT COUNT(*)
			      					FROM TBCSPDCP105L S1
			      					WHERE S1.REQ_DVSN_CD = A.REQ_DVSN_CD
			      					AND S1.ACP_YR = A.ACP_YR
			      					AND S1.CVPT_ACP_NO = A.CVPT_ACP_NO
			      				) > 0 THEN A.TIT_NM||'(합건 : '||A.RM_CVPT_ACP_NO||', '||(	SELECT	AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
			      																			FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
			      																			WHERE	A.REQ_DVSN_CD = S2.REQ_DVSN_CD
			      																			AND		A.ACP_YR = S2.ACP_YR
			      																			AND		A.CVPT_ACP_NO = S2.CVPT_ACP_NO
			      																			AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
			      																			AND		S2.SUC_ACP_YR = S3.ACP_YR
			      																			AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO)
			      		ELSE A.TIT_NM END AS TIT_NM
   					,A.REQR_KND_CD
   					,A.ACP_RUT_CD
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,A.CVPT_HNDL_STA_CD
   					,A.ACP_DH
   					,TO_CHAR(C.FNL_HNDL_DH,'YYYY-MM-DD HH24:MI') AS FNL_HNDL_DH 
   					,(	SELECT	TO_CHAR(TO_DATE(TO_CHAR(D.ONR_APV_CMPT_DH, 'YYYYMMDD'), 'YYYYMMDD') + NVL( S1.USR_DFN_TXT_2, 30), 'YYYY-MM-DD')
                    	FROM	TBDCMACM013C S1, TBCSPDCP205L D3
                    	WHERE	S1.CMM_CD_DVSN_CD = '1000754'
                    	AND		S1.CD != '000000000'
                    	AND     S1.CD  = D3.CVPT_HNDL_DVSN_CD
                    	AND		A.REQ_DVSN_CD = D3.REQ_DVSN_CD
			   			AND		A.ACP_YR = D3.ACP_YR
			   			AND		A.CVPT_ACP_NO = D3.CVPT_ACP_NO
                    	AND (D3.REQ_DVSN_CD, D3.CVPT_ACP_NO, D3.ACP_YR, D3.SRNO ) IN (	SELECT	Z.REQ_DVSN_CD, Z.CVPT_ACP_NO, Z.ACP_YR, MIN(Z.SRNO)
			   																	FROM	TBCSPDCP205L Z
			   																	WHERE	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
			   																	AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
			   																	AND		A.ACP_YR = Z.ACP_YR
			   																	GROUP BY Z.REQ_DVSN_CD, Z.CVPT_ACP_NO, Z.ACP_YR
			   																)) AS HNDL_LIMIT__DT
					,F_DPT_INFO(A.ACP_DPT_CD,'1') AS ACP_DPT_NM
					,F_CODE_NM('1000056',A.ACP_RUT_CD) AS ACP_RUT_NM
					,TO_CHAR(A.CVPT_WDW_DH,'YYYY-MM-DD HH24:MI') AS CVPT_WDW_DH
					,A.WDW_RQS_YN
   			FROM	TBCSPDCP101M A
   					,TBCSPDCP102M B
   					,TBCSPDCP201M C
   					,TBCSPDCP301M D
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = '1'
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
   			AND		A.ACP_YR = C.ACP_YR
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = D.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
   			AND		D.CVPT_IFM_DVSN_CD(+) = 'C'
   			AND		D.CVPT_OPM_APV_HNDL_STA_CD(+) = '30'
   			
   			AND		(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) 
   					NOT IN (
   						SELECT	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
   						FROM	TBCSPDCP105L
   					)
		]]>
		<dynamic>
		
		<isNotEqual property="strUSR_ID" compareValue="haahaasch">
			AND		C.HNDL_DPT_CD = #strDPT_CD#
   			AND		C.HNDL_CHGR_ID = #strUSR_ID#
		</isNotEqual>
			
			<isNotEmpty property="strACP_DHS">
				AND	TO_CHAR(A.ACP_DH,'YYYYMMDD') &gt;= #strACP_DHS#
			</isNotEmpty>
			<isNotEmpty property="strACP_DHE">
				AND	TO_CHAR(A.ACP_DH,'YYYYMMDD') &lt;= #strACP_DHE#
			</isNotEmpty>
			<isNotEmpty property="strCVPT_HNDL_STA_CD">
				AND	A.CVPT_HNDL_STA_CD = #strCVPT_HNDL_STA_CD#
			</isNotEmpty>
			<isEqual property="strSEARCH_CD" compareValue="1">
				<isNotEmpty property="strTIT_NM">
					AND	A.TIT_NM LIKE '%'||#strTIT_NM#||'%'
				</isNotEmpty>
			</isEqual>
			<isEqual property="strSEARCH_CD" compareValue="2">
				<isNotEmpty property="strTIT_NM">
					AND	B.CVPT_SBT LIKE '%'||#strTIT_NM#||'%'
				</isNotEmpty>
			</isEqual>
			<isNotEmpty property="strACP_YR">
				AND	A.ACP_YR = #strACP_YR#
			</isNotEmpty>
			<isNotEmpty property="strRM_CVPT_ACP_NO">
				AND	A.RM_CVPT_ACP_NO = #strRM_CVPT_ACP_NO#
			</isNotEmpty>
			<isNotEmpty property="strSMG_CVPT_APL_NO">
				AND	A.SMG_CVPT_APL_NO = #strSMG_CVPT_APL_NO#
			</isNotEmpty>
			<isNotEmpty property="strCVPTR_NM">
				AND	(A.CVPTR_NM LIKE '%'||#strCVPTR_NM#||'%' OR A.RPST_PEN_NM LIKE '%'||#strCVPTR_NM#||'%')
			</isNotEmpty>
			<isNotEmpty property="strREQR_KND_CD"> 
			  	AND A.REQR_KND_CD IN 
			  		(SELECT 	SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
                     FROM 	DUAL A
                     CROSS JOIN(SELECT ','|| #strREQR_KND_CD# ||',' AS CODE FROM DUAL) B
                     CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )				
			</isNotEmpty>
			
			<isNotEmpty property="strCVPT_KND_CD"> 
			  	AND A.CVPT_KND_CD IN 
			  		(SELECT 	SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
                     FROM 	DUAL A
                     CROSS JOIN(SELECT ','|| #strCVPT_KND_CD# ||',' AS CODE FROM DUAL) B
                     CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )				
			</isNotEmpty>
			
			<isNotEmpty property="strACP_RUT_CD"> 
			  	AND A.ACP_RUT_CD IN 
			  		(SELECT 	SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
                     FROM 	DUAL A
                     CROSS JOIN(SELECT ','|| #strACP_RUT_CD# ||',' AS CODE FROM DUAL) B
                     CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )				
			</isNotEmpty>
			
			<isNotEmpty property="strMNG_TYP_CD"> 
			  	AND A.MNG_TYP_CD IN 
			  		(SELECT 	SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
                     FROM 	DUAL A
                     CROSS JOIN(SELECT ','|| #strMNG_TYP_CD# ||',' AS CODE FROM DUAL) B
                     CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )				
			</isNotEmpty>
			
			<isEqual property="strPASV_ADMN_YN"  compareValue="Y">
				AND	C.PASV_ADMN_YN = 'Y'
			</isEqual>
			<isEqual property="strPASV_ADMN_YN"  compareValue="N">
				AND	( C.PASV_ADMN_YN = 'N' OR C.PASV_ADMN_YN IS NULL )
			</isEqual>
			<isEqual property="strREF_YN"  compareValue="Y">
				AND	C.REF_YN = 'Y'
			</isEqual>
			<isEqual property="strREF_YN"  compareValue="N">
				AND	( C.REF_YN = 'N' OR C.REF_YN IS NULL )
			</isEqual>
			<isEqual property="strRESULT_YN"  compareValue="Y">
				AND	A.CVPT_HNDL_STA_CD IN ('50','60','70','80')
			</isEqual>
			<isEqual property="strRESULT_YN"  compareValue="N">
				AND	A.CVPT_HNDL_STA_CD NOT IN ('50','60','70','80')
			</isEqual>
		</dynamic>
		<![CDATA[
			ORDER BY A.ACP_YR DESC, A.RM_CVPT_ACP_NO DESC
		]]>
	</select>
	
	
	<resultMap class="java.util.HashMap" id="cspdcpMap">
 		<result property="REQ_DVSN_CD" column="REQ_DVSN_CD"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ACP_YR" column="ACP_YR"                             jdbcType="VARCHAR2"  javaType="java.lang.String" /> 
		<result property="CVPT_ACP_NO" column="CVPT_ACP_NO"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_NO" column="ACP_NO"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_KND_NM" column="CVPT_KND_NM"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_NM" column="ACP_NM"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_DH" column="ACP_DH"                     jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_RUT_NM" column="ACP_RUT_NM"             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_RUT_CD" column="ACP_RUT_CD"             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="REQR_KND_NM" column="REQR_KND_NM"                         jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPTR_NM" column="CVPTR_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="OPEN_YN" column="OPEN_YN"                               jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="WIDW_YN" column="WIDW_YN"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="AD" column="AD"                                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="TNB" column="TNB"                           jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="HPN" column="HPN"                                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="RSLT_NTF_WAY_NM" column="RSLT_NTF_WAY_NM"                                     jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CLM_NM" column="CLM_NM"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="WRK_PLAC_NM" column="WRK_PLAC_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CLM_TNB" column="CLM_TNB"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CLM_AD" column="CLM_AD"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_TXT" column="CVPT_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_HNDL_STA_CD" column="CVPT_HNDL_STA_CD"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="DOC_ID" column="DOC_ID"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_KND_CD" column="CVPT_KND_CD"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_KND_DVSN_CD" column="CVPT_KND_DVSN_CD"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_YN" column="CVPT_DOC_YN"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="TIT_NM" column="TIT_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="PASV_ADMN_YN" column="PASV_ADMN_YN"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="REF_YN" column="REF_YN"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="HNDL_YN" column="HNDL_YN"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_HNDL_STA_NM" column="CVPT_HNDL_STA_NM"         jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ONR_APV_RQS_DH" column="ONR_APV_RQS_DH"      jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ONR_APV_CMPT_DH" column="ONR_APV_CMPT_DH"      jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_WDW_DH" column="CVPT_WDW_DH"      jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_WDW_RSN" column="CVPT_WDW_RSN"      jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="RPET_YN" column="RPET_YN"      jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ATCH_YN" column="ATCH_YN"      jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="WDW_RQS_YN" column="WDW_RQS_YN"      jdbcType="VARCHAR2"  javaType="java.lang.String" />
 	</resultMap>
	
	<select id="CSPDCP412EMainSelect" parameterClass="paramMap"
		resultMap="cspdcpMap">
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.ACP_YR||'-민원-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,F_CODE_NM('1000047',A.CVPT_KND_CD) AS CVPT_KND_NM
   					,F_DPT_INFO(A.ACP_DPT_CD,'1')||'/'||F_USR_INFO_BY_ID(A.RCEP_ID,'2') AS ACP_NM 
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,F_CODE_NM('1000056',A.ACP_RUT_CD) AS ACP_RUT_NM
   					,A.ACP_RUT_CD
   					,F_CODE_NM('1000358',A.REQR_KND_CD) AS REQR_KND_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,A.OPEN_YN
   					,DECODE(A.CVPT_WDW_DH,NULL,'N','Y') AS WIDW_YN
   					,DECODE(A.ZCD,NULL,'','(우)'||A.ZCD||' '||A.AD||' '||A.DTL_AD) AS AD
   					,A.TNB
   					,A.HPN
   					,CASE WHEN A.ACP_RUT_CD = '8' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD) 
   						WHEN A.ACP_RUT_CD <> '8' AND A.RSLT_NTF_WAY_CD = '003' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD) 
   						ELSE '홈페이지+'||F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)  END AS RSLT_NTF_WAY_NM
   					,C.CLM_NM
   					,C.WRK_PLAC_NM
   					,C.TNB AS CLM_TNB
   					,DECODE(C.ZCD,NULL,'','(우)'||C.ZCD||' '||C.AD||' '||C.DTL_AD) AS CLM_AD
   					,B.CVPT_TXT
   					,A.CVPT_HNDL_STA_CD
   					,A.DOC_ID
   					,A.CVPT_KND_CD
   					,D.CVPT_KND_DVSN_CD
   					,CASE WHEN E.ONR_DOC_MNG_CRD_ID IS NOT NULL THEN 'Y' ELSE 'N' END AS CVPT_DOC_YN
   					,A.TIT_NM
   					,D.PASV_ADMN_YN
   					,D.REF_YN
   					,CASE WHEN  E.CVPT_OPM_APV_HNDL_STA_CD <> '30' OR E.CVPT_OPM_APV_HNDL_STA_CD IS NULL THEN '1'
   							WHEN E.CVPT_OPM_APV_HNDL_STA_CD = '30' THEN '2'
   							ELSE '3' END AS HNDL_YN
   					,F_CODE_NM('1000361',A.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
   					,TO_CHAR(E.ONR_APV_RQS_DH,'YYYY-MM-DD HH24:MI') AS ONR_APV_RQS_DH
   					,TO_CHAR(E.ONR_APV_CMPT_DH,'YYYY-MM-DD HH24:MI') AS ONR_APV_CMPT_DH
   					,TO_CHAR(A.CVPT_WDW_DH,'YYYY-MM-DD HH24:MI') AS CVPT_WDW_DH
   					,A.CVPT_WDW_RSN
   					,A.RPET_YN AS RPET_YN
   					,CASE WHEN	(	SELECT	COUNT(FILE_ID)
  			 						FROM	ECM_FILE_LIST_VIEW2 X
   									WHERE	A.DOC_ID = X.DOC_ID
			   					) > 0 THEN '첨부파일 있음' 
			   		ELSE '첨부파일 없음' END AS ATCH_YN
			   		,A.WDW_RQS_YN
   			FROM	TBCSPDCP101M A
   					,TBCSPDCP102M B
   					,TBCSPDCP103M C
   					,TBCSPDCP201M D
   					,TBCSPDCP301M E
   					,TBCSPDCP205L F
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD ='1'
   			AND		A.REQ_DVSN_CD = #strREQ_DVSN_CD#
   			AND		A.ACP_YR = #strACP_YR#
   			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = C.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO(+)
   			AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD
   			AND		A.ACP_YR = D.ACP_YR
   			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = F.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = F.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = F.CVPT_ACP_NO(+)
   			AND		( F.SRNO = (SELECT 	MIN(SRNO) 
								FROM 	TBCSPDCP205L A
								WHERE 	A.REQ_DVSN_CD = #strREQ_DVSN_CD#
								AND		A.ACP_YR = #strACP_YR#
								AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO# ) OR F.SRNO IS NULL )
   			AND		A.REQ_DVSN_CD = E.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = E.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = E.CVPT_ACP_NO(+)
   			AND		E.CVPT_IFM_DVSN_CD(+) = 'C'
		]]>
			
	</select>
	
	<select id="CSPDCP412ESucSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	B.REQ_DVSN_CD
					,B.ACP_YR
   					,B.CVPT_ACP_NO
   					,A.RM_CVPT_ACP_NO
   					,A.ACP_YR||'-민원-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,A.CVPT_KND_CD
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,A.TIT_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,B.SUC_REQ_DVSN_CD
   					,B.SUC_ACP_YR
   					,B.SUC_CVPT_ACP_NO
   					,A.CVPT_HNDL_STA_CD
   			FROM	TBCSPDCP101M A, TBCSPDCP105L B
   			WHERE	B.REQ_DVSN_CD = #strREQ_DVSN_CD#
   			AND		B.ACP_YR = #strACP_YR#
   			AND		B.CVPT_ACP_NO = #strCVPT_ACP_NO#
   			AND		B.SUC_REQ_DVSN_CD = A.REQ_DVSN_CD
   			AND		B.SUC_ACP_YR = A.ACP_YR
   			AND		B.SUC_CVPT_ACP_NO = A.CVPT_ACP_NO
   		]]>
   	</select>
   	
   	<select id="CSPDCP412EOrgSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	B.REQ_DVSN_CD
					,B.ACP_YR
   					,B.CVPT_ACP_NO
   					,B.HNDL_ORG_SRNO
   					,B.ORG_HIS_DVSN_CD
   					,B.SRNO
   					,B.ORG_CD
   					,B.PUB_DVSN_CD
   					,B.COPT_SG_CD
   					,F_ORG_HRK_NM(B.COPT_SG_CD) AS COPT_SG_NM
   					,CASE WHEN B.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(B.ORG_CD,'1')
   						ELSE B.ORG_NM END AS ORG_NM 
   					,B.OGN_ORG_DVSN_CD
   			FROM	TBCSPDCP201M A, TBCSPDCP206L B
   			WHERE	A.REQ_DVSN_CD = #strREQ_DVSN_CD#
   			AND		A.ACP_YR = #strACP_YR#
   			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
   			AND		B.ORG_HIS_DVSN_CD ='1'
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   		]]>
   	</select>
   	
   	<select id="CSPDCP412EHndlSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[	
			SELECT	B.REQ_DVSN_CD
					,B.ACP_YR
   					,B.CVPT_ACP_NO
   					,B.SRNO
   					,B.CVPT_HNDL_DVSN_CD
   					,B.AUD_RFR_MTRL_TRNF_DPT_CD
   					,DECODE(B.AUD_RFR_MTRL_TRNF_DPT_CD,NULL,'',SUBSTR(B.AUD_RFR_MTRL_TRNF_DPT_CD,1,3)||'000') AS AUD_RFR_MTRL_TRNF_HST_DPT_CD
   					,B.TRNF_DPT_CD
   					,DECODE(B.TRNF_DPT_CD,NULL,'',SUBSTR(B.TRNF_DPT_CD,1,3)||'000') AS TRNF_HST_DPT_CD
   					/*,CASE WHEN A.CVPT_KND_DVSN_CD = '1' AND B.CVPT_HNDL_DVSN_CD IN ('11','12','13','14') THEN '10'
   							WHEN A.CVPT_KND_DVSN_CD = '1' THEN B.CVPT_HNDL_DVSN_CD
   							ELSE '' END AS CVPT_HNDL_DVSN_CD1
   					,CASE WHEN A.CVPT_KND_DVSN_CD = '2' AND B.CVPT_HNDL_DVSN_CD IN ('61','62','63') THEN '60'
   							WHEN A.CVPT_KND_DVSN_CD = '2' THEN B.CVPT_HNDL_DVSN_CD
   							ELSE '' END AS CVPT_HNDL_DVSN_CD2
   					,B.CVPT_HNDL_DVSN_CD AS CVPT_HNDL_DVSN_CD_S*/
   					,B.CVPT_HNDL_DVSN_CD AS OLD_CVPT_HNDL_DVSN_CD
   					,B.DOC_ID AS HNDL_DOC_ID
   					,'첨부파일보기' AS DOC_NM
   			FROM	TBCSPDCP201M A, TBCSPDCP205L B
   			WHERE	A.REQ_DVSN_CD = #strREQ_DVSN_CD#
   			AND		A.ACP_YR = #strACP_YR#
   			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			ORDER BY B.SRNO ASC
   		]]>
   	</select>
	
	<select id="CSPDCP416PMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.ACP_YR||'-민원-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,A.CVPT_KND_CD
   					,A.TIT_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,A.CVPT_HNDL_STA_CD
   					,A.ACP_RUT_CD
   					,A.HPN
   					,A.RM_CVPT_ACP_NO
   			FROM	TBCSPDCP101M A
   					,TBCSPDCP102M B
   					,TBCSPDCP201M C
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = '1'
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
   			AND		A.ACP_YR = C.ACP_YR
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
   			AND		C.HNDL_DPT_CD = #strDPT_CD#
   			AND		C.HNDL_CHGR_ID = #strUSR_ID#
   			AND		(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) NOT IN (	SELECT 	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO 
   																		FROM	TBCSPDCP203M) 
   			AND		A.CVPT_HNDL_STA_CD IN ('30','40')
   			AND		(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) NOT IN (	SELECT	#paREQ_DVSN_CD#,#paACP_YR#,#paCVPT_ACP_NO#
   																		FROM	DUAL )
   			AND		((A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) NOT IN (	SELECT 	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO 
   																		FROM	TBCSPDCP105L) 
   					AND (A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) NOT IN (	SELECT 	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO 
   																			FROM	TBCSPDCP105L) )
		]]>
		<dynamic>
			<isNotEmpty property="strACP_DHS">
				AND	A.ACP_DH &gt;= #strACP_DHS#
			</isNotEmpty>
			<isNotEmpty property="strACP_DHE">
				AND	TO_CHAR(A.ACP_DH,'YYYYMMDD') &lt;= #strACP_DHE#
			</isNotEmpty>
			<isEqual property="strSEARCH_CD" compareValue="1">
				<isNotEmpty property="strTIT_NM">
					AND	A.TIT_NM LIKE '%'||#strTIT_NM#||'%'
				</isNotEmpty>
			</isEqual>
			<isEqual property="strSEARCH_CD" compareValue="2">
				<isNotEmpty property="strTIT_NM">
					AND	B.CVPT_SBT LIKE '%'||#strTIT_NM#||'%'
				</isNotEmpty>
			</isEqual>
			<isNotEmpty property="strACP_YR">
				AND	A.ACP_YR = #strACP_YR#
			</isNotEmpty>
			<isNotEmpty property="strRM_CVPT_ACP_NO">
				AND	A.RM_CVPT_ACP_NO = #strRM_CVPT_ACP_NO#
			</isNotEmpty>
			<isNotEmpty property="strCVPTR_NM">
				AND	(A.CVPTR_NM LIKE '%'||#strCVPTR_NM#||'%' OR A.RPST_PEN_NM LIKE '%'||#strCVPTR_NM#||'%')
			</isNotEmpty>
		</dynamic>
	</select>
	
	<select id="CSPDCP416PSucSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	B.REQ_DVSN_CD
					,B.ACP_YR
   					,B.CVPT_ACP_NO
   					,A.ACP_YR||'-민원-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,A.CVPT_KND_CD
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,A.TIT_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,B.SUC_REQ_DVSN_CD
   					,B.SUC_ACP_YR
   					,B.SUC_CVPT_ACP_NO
   					,A.CVPT_HNDL_STA_CD
   					,A.ACP_RUT_CD
   					,A.HPN
   			FROM	TBCSPDCP101M A, TBCSPDCP105L B
   			WHERE	B.REQ_DVSN_CD = #paREQ_DVSN_CD#
   			AND		B.ACP_YR = #paACP_YR#
   			AND		B.CVPT_ACP_NO = #paCVPT_ACP_NO#
   			AND		B.SUC_REQ_DVSN_CD = A.REQ_DVSN_CD
   			AND		B.SUC_ACP_YR = A.ACP_YR
   			AND		B.SUC_CVPT_ACP_NO = A.CVPT_ACP_NO
   		]]>
   	</select>
	
   	<insert id="CSPDCP416P105SucInsert" parameterClass="paramMap">
   		<![CDATA[
   			INSERT INTO	TBCSPDCP105L
	   					(	REQ_DVSN_CD
	   						,ACP_YR
	   						,CVPT_ACP_NO
	   						,SUC_REQ_DVSN_CD
	   						,SUC_ACP_YR
	   						,SUC_CVPT_ACP_NO
	   						,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
       			VALUES	(	#REQ_DVSN_CD#
	   						,#ACP_YR#
	   						,#CVPT_ACP_NO#
	   						,#SUC_REQ_DVSN_CD#
	   						,#SUC_ACP_YR#
	   						,#SUC_CVPT_ACP_NO#
	   						,#FRT_USR_ID#
	       					,#FNL_USR_ID#
	       					,#FNL_DEAL_DPT_CD#
	       					,#FNL_MNU_ID#
	       					,SYSDATE
	       					,SYSDATE
	       				)
   		]]>
   	</insert>
   	
   	<update id="CSPDCP416P201SucUpdate" parameterClass="paramMap">
   		<![CDATA[
   			UPDATE	TBCSPDCP201M A
   			SET		A.CVPT_KND_DVSN_CD = (SELECT 	Z.CVPT_KND_DVSN_CD 
   										FROM 	TBCSPDCP201M Z 
   										WHERE 	Z.REQ_DVSN_CD = #REQ_DVSN_CD#
   										AND		Z.ACP_YR = #ACP_YR#
   										AND		Z.CVPT_ACP_NO = #CVPT_ACP_NO#)
   					,A.PASV_ADMN_YN = (SELECT 	Z.PASV_ADMN_YN 
   										FROM 	TBCSPDCP201M Z 
   										WHERE 	Z.REQ_DVSN_CD = #REQ_DVSN_CD#
   										AND		Z.ACP_YR = #ACP_YR#
   										AND		Z.CVPT_ACP_NO = #CVPT_ACP_NO#)
   					,A.REF_YN = (SELECT 	Z.REF_YN 
   										FROM 	TBCSPDCP201M Z 
   										WHERE 	Z.REQ_DVSN_CD = #REQ_DVSN_CD#
   										AND		Z.ACP_YR = #ACP_YR#
   										AND		Z.CVPT_ACP_NO = #CVPT_ACP_NO#)
   					,A.DOC_ID = (SELECT 	Z.DOC_ID 
   										FROM 	TBCSPDCP201M Z 
   										WHERE 	Z.REQ_DVSN_CD = #REQ_DVSN_CD#
   										AND		Z.ACP_YR = #ACP_YR#
   										AND		Z.CVPT_ACP_NO = #CVPT_ACP_NO#)
   					,A.DOC_TYP_CD = (SELECT 	Z.DOC_TYP_CD 
   										FROM 	TBCSPDCP201M Z 
   										WHERE 	Z.REQ_DVSN_CD = #REQ_DVSN_CD#
   										AND		Z.ACP_YR = #ACP_YR#
   										AND		Z.CVPT_ACP_NO = #CVPT_ACP_NO#)
   			WHERE	A.REQ_DVSN_CD = #SUC_REQ_DVSN_CD#
   			AND		A.ACP_YR = #SUC_ACP_YR#
   			AND		A.CVPT_ACP_NO = #SUC_CVPT_ACP_NO#
   		]]>
   	</update>
   	
   	<delete id="CSPDCP416P105SucDelete" parameterClass="paramMap">
	   	<![CDATA[
	   		DELETE	/*CSPDCP416P105SucDelete*/
	   		FROM	TBCSPDCP105L
	   		WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
	   		AND		ACP_YR = #ACP_YR#
	   		AND		CVPT_ACP_NO = #CVPT_ACP_NO#
	   		AND		SUC_REQ_DVSN_CD = #SUC_REQ_DVSN_CD#
	   		AND		SUC_ACP_YR = #SUC_ACP_YR#
	   		AND		SUC_CVPT_ACP_NO = #SUC_CVPT_ACP_NO#
	   	]]>
   	</delete>
   	
   	<update id="CSPDCP416P101Update" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP101M A
			SET		A.CVPT_HNDL_STA_CD = #HNDL_STA_CD#
					,A.CVPT_KND_CD = (SELECT	Z.CVPT_KND_CD
									FROM	TBCSPDCP101M Z 
									WHERE 	Z.REQ_DVSN_CD = #REQ_DVSN_CD#
									AND		Z.ACP_YR = #ACP_YR#
 									AND		Z.CVPT_ACP_NO = #CVPT_ACP_NO#)
					,A.FNL_USR_ID = #FNL_USR_ID#
   					,A.FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
   					,A.FNL_MNU_ID = #FNL_MNU_ID#
   					,A.FNL_MDF_DH = SYSDATE
			WHERE	A.REQ_DVSN_CD = #SUC_REQ_DVSN_CD#
			AND		A.ACP_YR = #SUC_ACP_YR#
			AND		A.CVPT_ACP_NO = #SUC_CVPT_ACP_NO#
		]]>
	</update>
	
	<update id="CSPDCP416E202DtbInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,HNDL_DPT_CD
        					,HNDL_CHGR_ID
        					,RDTB_RQS_RSN
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#SUC_REQ_DVSN_CD#
							,#SUC_ACP_YR#
							,#SUC_CVPT_ACP_NO#
							,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
								  FROM TBCSPDCP202H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #SUC_REQ_DVSN_CD#
							       AND ACP_YR = #SUC_ACP_YR#
							       AND CVPT_ACP_NO = #SUC_CVPT_ACP_NO#
							 )
							,F_USR_INFO(#S_CNB#,'5')
							,F_USR_INFO(#S_CNB#,'1')
							,#HNDL_STA_CD#
							,#HNDL_DPT_CD#
							,#HNDL_CHGR_ID#
							,#RDTB_RQS_RSN#
							,F_USR_INFO(#S_CNB#,'1')
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
		]]>
	</update>
	
	<!-- 합건될때 배부확인 안한 감사제보는 SMS 발송한다. -->
	<insert id="CSPDCP416PMsgInsert" parameterClass ="paramMap">
		<![CDATA[
			INSERT INTO MSG_DATA
				 	(	MSG_SEQ
				 		, CUR_STATE
				 		, REQ_DATE
				 		, CALL_TO
				 		, CALL_FROM
				 		, SMS_TXT
				 		, MSG_TYPE
				 		, CONT_SEQ
				 	) 
			VALUES (	MSG_DATA_SEQ.NEXTVAL
						, 0
						, SYSDATE
						, REPLACE(#HPN#,'-','') 
						, '01027766577' 
						, ''
						, 6
						, #CONT_SEQ#
					)
		]]>
	</insert>
	
	
	<insert id="CSPDCP416P304MsgInsert" parameterClass ="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP304L
						(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_SMS_TRNM_HIS_SRNO
							,TRNM_HPN
							,RPL_TNB
							,SMS_TXT
							,TRNM_DH
							,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
       			VALUES	(	#SUC_REQ_DVSN_CD#
       						,#SUC_ACP_YR#
       						,#SUC_CVPT_ACP_NO#
							,(	SELECT NVL(MAX(CVPT_SMS_TRNM_HIS_SRNO),0)+1
								  FROM TBCSPDCP304L
								 WHERE 1=1
							       AND REQ_DVSN_CD = #SUC_REQ_DVSN_CD#
							       AND ACP_YR = #SUC_ACP_YR#
							       AND CVPT_ACP_NO = #SUC_CVPT_ACP_NO#
							 )
							,'010-1111-1111'
							,#HPN#
							,#SMS_TXT#
							,SYSDATE
							,F_USR_INFO(#S_CNB#,'1')
							,F_USR_INFO(#S_CNB#,'1')
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
						
		]]>
	</insert>
	
	<delete id="CSPDCP416P205Delete" parameterClass="paramMap">
		<![CDATA[
			DELETE	/*CSPDCP416P205Delete*/
			FROM	TBCSPDCP205L
			WHERE	REQ_DVSN_CD = #SUC_REQ_DVSN_CD#
			AND		ACP_YR = #SUC_ACP_YR#
			AND		CVPT_ACP_NO = #SUC_CVPT_ACP_NO#
		]]>
	</delete>
	
	<delete id="CSPDCP416P206Delete" parameterClass="paramMap">
		<![CDATA[
			DELETE	/*CSPDCP416P206Delete*/
			FROM	TBCSPDCP206L
			WHERE	REQ_DVSN_CD = #SUC_REQ_DVSN_CD#
			AND		ACP_YR = #SUC_ACP_YR#
			AND		CVPT_ACP_NO = #SUC_CVPT_ACP_NO#
		]]>
	</delete>
	
	<!-- 민원 처리 내역 저장 시 처리기본 테이블 UPDATE -->
	<update id="CSPDCP412E201MainUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP201M
			SET		CVPT_KND_DVSN_CD = #CVPT_KND_DVSN_CD#
					,PASV_ADMN_YN = #PASV_ADMN_YN#
					,REF_YN = #REF_YN#
					,FNL_USR_ID = #FNL_USR_ID#
   					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
   					,FNL_MNU_ID = #FNL_MNU_ID#
   					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</update>
	
	<!-- 민원 처리 내역 저장 시 합건된 감사제보들 처리기본 테이블 UPDATE -->
	<update id="CSPDCP412E201SucUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP201M
			SET		CVPT_KND_DVSN_CD = #CVPT_KND_DVSN_CD#
					,PASV_ADMN_YN = #PASV_ADMN_YN#
					,REF_YN = #REF_YN#
					,FNL_USR_ID = #FNL_USR_ID#
   					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
   					,FNL_MNU_ID = #FNL_MNU_ID#
   					,FNL_MDF_DH = SYSDATE
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
															)
		]]>
	</update>
	
	<!-- 민원 처리결과 저장시 민원 접수 테이블 update -->
	<update id="CSPDCP412E101Update" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD = #HNDL_STA_CD#
					,CVPT_KND_CD = #CVPT_KND_CD#
					,RPET_YN = #RPET_YN#
					,FNL_USR_ID = #FNL_USR_ID#
   					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
   					,FNL_MNU_ID = #FNL_MNU_ID#
   					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</update>
	
	<!-- 민원 처리결과 저장시 합건된 민원 접수 테이블 update -->
	<update id="CSPDCP412E101SucUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD = #HNDL_STA_CD#
					,CVPT_KND_CD = #CVPT_KND_CD#
					,RPET_YN = #RPET_YN#
					,FNL_USR_ID = #FNL_USR_ID#
   					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
   					,FNL_MNU_ID = #FNL_MNU_ID#
   					,FNL_MDF_DH = SYSDATE
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
															)
		]]>
	</update>
	
	<insert id="CSPDCP412E206Insert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP206L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,HNDL_ORG_SRNO
        					,ORG_HIS_DVSN_CD
        					,SRNO
        					,ORG_CD
        					,PUB_DVSN_CD
        					,COPT_SG_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        					,ORG_NM
        					,OGN_ORG_DVSN_CD
        				)
        		VALUES	(	#REQ_DVSN_CD#
        					,#ACP_YR#
        					,#CVPT_ACP_NO#
        					,(	SELECT	NVL(MAX(HNDL_ORG_SRNO),0)+1
        						FROM	TBCSPDCP206L
        						WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
        						AND		ACP_YR = #ACP_YR#
        						AND		CVPT_ACP_NO = #CVPT_ACP_NO#
        					)
        					,#ORG_HIS_DVSN_CD#
        					,#SRNO#
        					,DECODE(#OGN_ORG_DVSN_CD#,'20','',#ORG_CD#)
        					,#PUB_DVSN_CD#
        					,#COPT_SG_CD#
        					,#FRT_USR_ID#
        					,#FNL_USR_ID#
        					,#FNL_DEAL_DPT_CD#
        					,#FNL_MNU_ID#
        					,SYSDATE
        					,SYSDATE
        					,DECODE(#OGN_ORG_DVSN_CD#,'20',#ORG_NM#,'')
        					,#OGN_ORG_DVSN_CD#
        				)
        						
		]]>
	</insert>
	
	<insert id="CSPDCP412E206SucInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	/*CSPDCP412E206SucInsert*/
						TBCSPDCP206L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,HNDL_ORG_SRNO
        					,ORG_HIS_DVSN_CD
        					,SRNO
        					,ORG_CD
        					,PUB_DVSN_CD
        					,COPT_SG_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        					,ORG_NM
        					,OGN_ORG_DVSN_CD
        				)
        	SELECT	SUC_REQ_DVSN_CD
        			,SUC_ACP_YR
        			,SUC_CVPT_ACP_NO
        			,(	SELECT	NVL(MAX(HNDL_ORG_SRNO),0)+1
        						FROM	TBCSPDCP206L
        						WHERE	REQ_DVSN_CD = SUC_REQ_DVSN_CD
        						AND		ACP_YR = SUC_ACP_YR
        						AND		CVPT_ACP_NO = SUC_CVPT_ACP_NO
        			)
        			,#ORG_HIS_DVSN_CD#
        			,#SRNO#
  					,#ORG_CD#
  					,#PUB_DVSN_CD#
  					,#COPT_SG_CD#
  					,#FRT_USR_ID#
  					,#FNL_USR_ID#
  					,#FNL_DEAL_DPT_CD#
  					,#FNL_MNU_ID#
  					,SYSDATE
  					,SYSDATE
  					,DECODE(#OGN_ORG_DVSN_CD#,'20',#ORG_NM#,'')
     				,#OGN_ORG_DVSN_CD#
        	FROM	TBCSPDCP105L
        	WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN ( 	SELECT	#REQ_DVSN_CD#,#ACP_YR#,#CVPT_ACP_NO# 
        													FROM 	DUAL )
		]]>
	</insert>
	
	<delete id="CSPDCP412E206Delete" parameterClass="paramMap"> 
		<![CDATA[
			DELETE
			FROM	TBCSPDCP206L
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
		  	AND 	ACP_YR = #ACP_YR#
		    AND 	CVPT_ACP_NO = #CVPT_ACP_NO#
		    AND		ORG_HIS_DVSN_CD = #ORG_HIS_DVSN_CD#
		    AND		HNDL_ORG_SRNO = #HNDL_ORG_SRNO#
		]]>
	</delete>
	
	<delete id="CSPDCP412E206SucDelete" parameterClass="paramMap"> 
		<![CDATA[
			DELETE
			FROM	TBCSPDCP206L
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
															)
		    AND		ORG_HIS_DVSN_CD = #ORG_HIS_DVSN_CD#
		    AND		HNDL_ORG_SRNO = #HNDL_ORG_SRNO#
		]]>
	</delete>
	
	<select id="CSPDCP412E206HndlOrgSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.HNDL_ORG_SRNO
   					,A.ORG_HIS_DVSN_CD
   					,A.SRNO
   					,A.ORG_CD
   					,A.PUB_DVSN_CD
   					,A.COPT_SG_CD
   					,F_ORG_HRK_NM(A.COPT_SG_CD) AS COPT_SG_NM
   					, F_ORG_INFO(A.ORG_CD,'1') AS ORG_NM 
   			FROM	TBCSPDCP206L A
   			WHERE	A.REQ_DVSN_CD = #strREQ_DVSN_CD#
   			AND		A.ACP_YR = #strACP_YR#
   			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
   			AND		A.SRNO = #strSRNO#
   			AND		A.ORG_HIS_DVSN_CD = #strORG_HIS_DVSN_CD#
   		]]>
   	</select>
   	
   	<select id="CSPDCP412E205KeySelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[     	
			SELECT	TO_CHAR(NVL(MAX(SRNO),0)+1) AS SRNO
			FROM	TBCSPDCP205L A
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		A.ACP_YR = #ACP_YR#
			AND		A.CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</select>
	
	<insert id="CSPDCP412E205Insert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	/*CSPDCP412E205Insert*/ 
						TBCSPDCP205L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,SRNO
        					,CVPT_HNDL_DVSN_CD
        					,AUD_RFR_MTRL_TRNF_DPT_CD
        					,TRNF_DPT_CD
        					,DOC_ID
        					,DOC_TYP_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#REQ_DVSN_CD#
        					,#ACP_YR#
        					,#CVPT_ACP_NO#
        					,#SRNO#
        					,#CVPT_HNDL_DVSN_CD#
        					,#AUD_RFR_MTRL_TRNF_DPT_CD#
        					,#TRNF_DPT_CD#
        					,#HNDL_DOC_ID#
        					,#HNDL_DOC_TYP_CD#
        					,#FRT_USR_ID#
        					,#FNL_USR_ID#
        					,#FNL_DEAL_DPT_CD#
        					,#FNL_MNU_ID#
        					,SYSDATE
        					,SYSDATE
        				)
		]]>
	</insert>
	
	<insert id="CSPDCP412E205SucInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	/*CSPDCP412E205SucInsert*/
						TBCSPDCP205L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,SRNO
        					,CVPT_HNDL_DVSN_CD
        					,AUD_RFR_MTRL_TRNF_DPT_CD
        					,TRNF_DPT_CD
        					,DOC_ID
        					,DOC_TYP_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		SELECT	SUC_REQ_DVSN_CD
	        			,SUC_ACP_YR
	        			,SUC_CVPT_ACP_NO
       					,#SRNO#
       					,#CVPT_HNDL_DVSN_CD#
       					,#AUD_RFR_MTRL_TRNF_DPT_CD#
       					,#TRNF_DPT_CD#
       					,#HNDL_DOC_ID#
       					,#HNDL_DOC_TYP_CD#
       					,#FRT_USR_ID#
       					,#FNL_USR_ID#
       					,#FNL_DEAL_DPT_CD#
       					,#FNL_MNU_ID#
       					,SYSDATE
       					,SYSDATE
        		FROM	TBCSPDCP105L
        		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN ( 	SELECT	#REQ_DVSN_CD#,#ACP_YR#,#CVPT_ACP_NO# 
        														FROM 	DUAL )
		]]>
	</insert>
	
	<!-- 처리결과내역 수정 -->
	<update id="CSPDCP412E205Update" parameterClass="paramMap">
		<![CDATA[
			UPDATE	/*CSPDCP412E205Update*/ TBCSPDCP205L
			SET		CVPT_HNDL_DVSN_CD = #CVPT_HNDL_DVSN_CD#
					,AUD_RFR_MTRL_TRNF_DPT_CD = #AUD_RFR_MTRL_TRNF_DPT_CD#
					,TRNF_DPT_CD = #TRNF_DPT_CD#
					,DOC_ID = #HNDL_DOC_ID#
					,DOC_TYP_CD = #DOC_TYP_CD#
					,FNL_USR_ID = #FNL_USR_ID#
   					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
   					,FNL_MNU_ID = #FNL_MNU_ID#
   					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
			AND		SRNO = #SRNO#
		]]>
	</update>
	
	<!-- 합건자료 처리결과내역 수정 -->
	<update id="CSPDCP412E205SucUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	/*CSPDCP412E205SucUpdate*/ TBCSPDCP205L
			SET		CVPT_HNDL_DVSN_CD = #CVPT_HNDL_DVSN_CD#
					,AUD_RFR_MTRL_TRNF_DPT_CD = #AUD_RFR_MTRL_TRNF_DPT_CD#
					,TRNF_DPT_CD = #TRNF_DPT_CD#
					,DOC_ID = #HNDL_DOC_ID#
					,DOC_TYP_CD = #DOC_TYP_CD#
					,FNL_USR_ID = #FNL_USR_ID#
   					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
   					,FNL_MNU_ID = #FNL_MNU_ID#
   					,FNL_MDF_DH = SYSDATE
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
															)
			AND		SRNO = #SRNO#
		]]>
	</update>
	
	<delete id="CSPDCP412E205Delete" parameterClass="paramMap"> 
		<![CDATA[
			DELETE	/*CSPDCP412E205Delete*/
			FROM	TBCSPDCP205L
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
		  	AND 	ACP_YR = #ACP_YR#
		    AND 	CVPT_ACP_NO = #CVPT_ACP_NO#
		    AND		SRNO = #SRNO#
		]]>
	</delete>
	
	<delete id="CSPDCP412E205SucDelete" parameterClass="paramMap"> 
		<![CDATA[
			DELETE	/*"CSPDCP412E205SucDelete"*/
			FROM	TBCSPDCP205L
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
															)
		    AND		SRNO = #SRNO#
		]]>
	</delete>
	
	<delete id="CSPDCP412E205206Delete" parameterClass="paramMap"> 
		<![CDATA[
			DELETE	/*CSPDCP412E205206Delete*/
			FROM	TBCSPDCP206L
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
		  	AND 	ACP_YR = #ACP_YR#
		    AND 	CVPT_ACP_NO = #CVPT_ACP_NO#
		    AND		ORG_HIS_DVSN_CD = DECODE( #CVPT_HNDL_DVSN_CD#, '60','2','80','3','' )
		    AND		SRNO = #SRNO#
		]]>
	</delete>
	
	<delete id="CSPDCP412E205206SucDelete" parameterClass="paramMap"> 
		<![CDATA[
			DELETE	/*CSPDCP412E205206SucDelete*/
			FROM	TBCSPDCP206L
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
															)
		    AND		ORG_HIS_DVSN_CD = DECODE( #CVPT_HNDL_DVSN_CD#, '60','2','80','3','' )
		    AND		SRNO = #SRNO#
		]]>
	</delete>
	
	<resultMap class="java.util.HashMap" id="cspdcpMap2">
 		<result property="REQ_DVSN_CD" column="REQ_DVSN_CD"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ACP_YR" column="ACP_YR"                             jdbcType="VARCHAR2"  javaType="java.lang.String" /> 
		<result property="CVPT_ACP_NO" column="CVPT_ACP_NO"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_NO" column="ACP_NO"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_DT" column="ACP_DT"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPTR_NM" column="CVPTR_NM"             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="REQR_KND_NM" column="REQR_KND_NM"                         jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="AD" column="AD"                                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="TNB" column="TNB"                           jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="TIT_NM" column="TIT_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_DVSN_CD" column="CVPT_DOC_DVSN_CD"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_DVSN_CD2" column="CVPT_DOC_DVSN_CD2"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_DVSN_CD3" column="CVPT_DOC_DVSN_CD3"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_DVSN_CD4" column="CVPT_DOC_DVSN_CD4"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ORG_NM" column="ORG_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="COPT_SG_NM" column="COPT_SG_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="DGE" column="DGE"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_TXT" column="CVPT_DOC_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_DOC_TXT2" column="CVPT_DOC_TXT2"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_DOC_TXT3" column="CVPT_DOC_TXT3"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_DOC_TXT4" column="CVPT_DOC_TXT4"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_OPM_APV_HNDL_STA_CD" column="CVPT_OPM_APV_HNDL_STA_CD"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="OPM_TXT" column="OPM_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_OPM_SRNO" column="CVPT_OPM_SRNO"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="FL_RUT_NM" column="FL_RUT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="SYS_FL_NM" column="SYS_FL_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="ONR_DOC_MNG_CRD_ID" column="ONR_DOC_MNG_CRD_ID"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="CVPT_HNDL_DVSN_CD" column="CVPT_HNDL_DVSN_CD"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="ONR_APV_CMPT_DH" column="ONR_APV_CMPT_DH"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="ACP_RUT_NM" column="ACP_RUT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="ACP_DPT_NM" column="ACP_DPT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="HNDL_DPT_NM" column="HNDL_DPT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="RSLT_NTF_WAY_NM" column="RSLT_NTF_WAY_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TRNF_DPT_NM" column="TRNF_DPT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TRNF_ORG_NM" column="TRNF_ORG_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="JEBOCNT" column="JEBOCNT"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TITLE" column="TITLE"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="RPET_YN" column="RPET_YN"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="RPET_YN_CVPT_DOC_TXT" column="RPET_YN_CVPT_DOC_TXT"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="FNL_HNDL_DH" column="FNL_HNDL_DH"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="ANS_TXT" column="ANS_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		
 	</resultMap>
 	
	<select id="CSPDCP415PMainSelect" parameterClass="paramMap"
		resultMap="cspdcpMap2">
        <![CDATA[     	
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, A.ACP_YR||'-민원-'||C.RM_CVPT_ACP_NO AS ACP_NO
					, TO_CHAR(C.ACP_DH,'YYYY.MM.DD') AS ACP_DT
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) AS CVPTR_NM
					, DECODE(C.REQR_KND_CD,'2','(기업)','') AS REQR_KND_NM
					, DECODE(C.ZCD,NULL,'','(우)'||C.ZCD||' '||C.AD||' '||C.DTL_AD) AS AD
   					, DECODE(C.TNB,NULL,C.HPN,C.TNB) AS TNB
   					, CASE WHEN	H.SUC_CNT > 0 AND H.SUC_CNT <= 5 THEN C.TIT_NM||(	SELECT	'(합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
							   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
							   								 						WHERE	C.REQ_DVSN_CD = S2.REQ_DVSN_CD
												   								 	AND		C.ACP_YR = S2.ACP_YR
												   								 	AND		C.CVPT_ACP_NO = S2.CVPT_ACP_NO
												   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
												   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
												   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
												   								 ) 
							WHEN H.SUC_CNT > 5 THEN C.TIT_NM||(	SELECT	'(합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' 외 '||(H.SUC_CNT-5)||'건)'
			   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
			   								 						WHERE	C.REQ_DVSN_CD = S2.REQ_DVSN_CD
								   								 	AND		C.ACP_YR = S2.ACP_YR
								   								 	AND		C.CVPT_ACP_NO = S2.CVPT_ACP_NO
								   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
								   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
								   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
								   								 	AND		ROWNUM <= 5
								   								 ) 
						ELSE C.TIT_NM END AS TIT_NM
   					, 'A1' AS CVPT_DOC_DVSN_CD
   					, 'A2' AS CVPT_DOC_DVSN_CD2
   					, 'A3' AS CVPT_DOC_DVSN_CD3
   					, 'A4' AS CVPT_DOC_DVSN_CD4
   					, Z.ORG_NM
   					, Z.COPT_SG_NM
   					, #strDGE# AS DGE
   					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO 
						AND		D1.CVPT_DOC_DVSN_CD = 'A1') AS CVPT_DOC_TXT
					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO 
						AND		D1.CVPT_DOC_DVSN_CD = 'A2') AS CVPT_DOC_TXT2
					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO 
						AND		D1.CVPT_DOC_DVSN_CD = 'A3') AS CVPT_DOC_TXT3
					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO 
						AND		D1.CVPT_DOC_DVSN_CD = 'A4') AS CVPT_DOC_TXT4
					, D.CVPT_OPM_APV_HNDL_STA_CD
					, E.OPM_TXT
					, D.CVPT_OPM_SRNO
					, F.FL_RUT_NM
					, F.SYS_FL_NM
					, D.ONR_DOC_MNG_CRD_ID
					, G.CVPT_HNDL_DVSN_CD
					, TO_CHAR(D.ONR_APV_CMPT_DH,'YYYY-MM-DD') AS ONR_APV_CMPT_DH 
					, F_CODE_NM('1000056',C.ACP_RUT_CD) AS ACP_RUT_NM
					, F_DPT_INFO(C.ACP_DPT_CD,'1') AS ACP_DPT_NM
					, F_DPT_INFO(A.HNDL_DPT_CD,'1') AS HNDL_DPT_NM
					,CASE WHEN C.ACP_RUT_CD = '8' THEN F_CODE_NM('1000089',C.RSLT_NTF_WAY_CD) 
   						WHEN C.ACP_RUT_CD <> '8' AND C.RSLT_NTF_WAY_CD = '003' THEN F_CODE_NM('1000089',C.RSLT_NTF_WAY_CD) 
   						ELSE '홈페이지+'||F_CODE_NM('1000089',C.RSLT_NTF_WAY_CD)  END AS RSLT_NTF_WAY_NM
   					,F_DPT_INFO(G.TRNF_DPT_CD,'1') AS TRNF_DPT_NM
   					,(	SELECT	F_ORG_INFO(MIN(S1.ORG_CD),'1') AS ORG_NM
   						FROM	TBCSPDCP206L S1
   						WHERE	G.REQ_DVSN_CD = S1.REQ_DVSN_CD
   						AND		G.ACP_YR = S1.ACP_YR
   						AND		G.CVPT_ACP_NO = S1.CVPT_ACP_NO
   						AND		G.SRNO = S1.SRNO
   						AND		S1.ORG_HIS_DVSN_CD IN ('2','3')
   					) AS TRNF_ORG_NM
   					,(	SELECT	COUNT(*)
   						FROM	TBCSPDCP101M S1
   						WHERE	S1.REQ_DVSN_CD = '1' 
   						AND		S1.HPN IS NOT NULL
   						AND		S1.CVPTR_NM = C.CVPTR_NM
   						AND		S1.HPN = C.HPN
   					) AS JEBOCNT
   					,CASE WHEN	H.SUC_CNT > 0 AND H.SUC_CNT <= 5 THEN F_CODE_NM('1000370','C')||' (제'||C.ACP_YR||'-민원-'||C.RM_CVPT_ACP_NO||'호) 보고'||(	SELECT	' (합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
																								   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
																								   								 						WHERE	C.REQ_DVSN_CD = S2.REQ_DVSN_CD
																													   								 	AND		C.ACP_YR = S2.ACP_YR
																													   								 	AND		C.CVPT_ACP_NO = S2.CVPT_ACP_NO
																													   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
																													   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
																													   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
					   								 																								) 
						WHEN H.SUC_CNT > 5 THEN F_CODE_NM('1000370','C')||' (제'||C.ACP_YR||'-민원-'||C.RM_CVPT_ACP_NO||'호) 보고'||(	SELECT	' (합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' 외 '||(H.SUC_CNT-5)||'건)'
																		   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
																		   								 						WHERE	C.REQ_DVSN_CD = S2.REQ_DVSN_CD
																							   								 	AND		C.ACP_YR = S2.ACP_YR
																							   								 	AND		C.CVPT_ACP_NO = S2.CVPT_ACP_NO
																							   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
																							   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
																							   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
																							   								 	AND		ROWNUM <= 5
  								 																								) 
						ELSE F_CODE_NM('1000370','C')||' (제'||C.ACP_YR||'-민원-'||C.RM_CVPT_ACP_NO||'호) 보고' END AS TITLE
					,C.RPET_YN AS RPET_YN
					,CASE WHEN RPET_YN = '101' THEN '귀하께서 제출하신 감사요청사항을 취하하여 감사요청사항의 처리에 관한 규정 제14조제3항에 따라 회신하지 않습니다.'
						WHEN RPET_YN = '102' THEN '귀하께서 제출하신 감사요청사항은 가명․차명․ 무기명 또는 주소가 불분명한 경우로 감사요청사항의 처리에 관한 규정 제14조제3항에 따라 회신하지 않습니다.'
						WHEN RPET_YN = '103' THEN '귀하께서 제출하신 감사요청사항은 3회 이상 반복 제출된 동일한 감사요청사항으로 종결처리되어 감사요청사항의 처리에 관한 규정 제14조제3항에 따라 회신하지 않습니다.'
						WHEN RPET_YN = '104' THEN '귀하께서 제출하신 감사요청사항에 대해 회신을 원하지 않아 감사요청사항의 처리에 관한 규정 제14조제3항에 따라 회신하지 않습니다.'
					ELSE NULL END AS RPET_YN_CVPT_DOC_TXT
					,TO_CHAR(A.FNL_HNDL_DH,'YYYY-MM-DD') AS FNL_HNDL_DH
					,A.ANS_TXT
			FROM	TBCSPDCP201M A
					, TBCSPDCP101M C
					,(	SELECT	Z.REQ_DVSN_CD, Z.ACP_YR, Z.CVPT_ACP_NO
								,CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(ORG_CD,'1') 
								ELSE Z.ORG_NM END AS ORG_NM
								, CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_HRK_NM(COPT_SG_CD)
								ELSE NULL END AS COPT_SG_NM
   						FROM	TBCSPDCP206L Z
   						WHERE	Z.REQ_DVSN_CD = #strREQ_DVSN_CD#
   						AND		Z.ACP_YR = #strACP_YR#
   						AND		Z.CVPT_ACP_NO = #strCVPT_ACP_NO#
   						AND		Z.ORG_HIS_DVSN_CD ='1'
   						AND		Z.HNDL_ORG_SRNO = (SELECT	MIN(S1.HNDL_ORG_SRNO)
   													FROM	TBCSPDCP206L S1
   													WHERE	S1.REQ_DVSN_CD = #strREQ_DVSN_CD#
							   						AND		S1.ACP_YR = #strACP_YR#
							   						AND		S1.CVPT_ACP_NO = #strCVPT_ACP_NO#
							   						AND		S1.ORG_HIS_DVSN_CD ='1'
							   						)
   					) Z
   					, TBCSPDCP301M D
   					, TBCSPDCP302M E
   					, TBDCMACM103L F
   					, TBCSPDCP205L G
   					, (SELECT	#strREQ_DVSN_CD# REQ_DVSN_CD, #strACP_YR# ACP_YR, #strCVPT_ACP_NO# CVPT_ACP_NO, COUNT(*) AS SUC_CNT
						FROM	TBCSPDCP105L S1 
						WHERE	S1.REQ_DVSN_CD = #strREQ_DVSN_CD#
						AND		S1.ACP_YR = #strACP_YR#
						AND		S1.CVPT_ACP_NO = #strCVPT_ACP_NO#
						) H
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #strREQ_DVSN_CD#
			AND		A.ACP_YR = #strACP_YR#
			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
			AND		A.ACP_YR = C.ACP_YR
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = Z.REQ_DVSN_CD(+)
			AND		A.ACP_YR = Z.ACP_YR(+)
			AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO(+)
			AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
			AND		A.ACP_YR = D.ACP_YR(+)
			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
			AND		D.REQ_DVSN_CD = E.REQ_DVSN_CD(+)
			AND		D.ACP_YR = E.ACP_YR(+)
			AND		D.CVPT_ACP_NO = E.CVPT_ACP_NO(+)
			AND		D.CVPT_OPM_SRNO = E.CVPT_OPM_SRNO(+)
			AND		D.CVPT_IFM_DVSN_CD(+) = 'C'
			AND		D.ONR_DOC_MNG_CRD_ID = F.ONR_DOC_MNG_CRD_ID(+)
			AND		F.ONR_APV_FL_DVSN_CD(+) = 'A'
			AND		A.REQ_DVSN_CD = G.REQ_DVSN_CD
			AND		A.ACP_YR = G.ACP_YR
			AND		A.CVPT_ACP_NO = G.CVPT_ACP_NO
			AND		(G.REQ_DVSN_CD, G.ACP_YR, G.CVPT_ACP_NO, G.SRNO) IN (	SELECT	Z.REQ_DVSN_CD, Z.ACP_YR, Z.CVPT_ACP_NO, MIN(Z.SRNO) AS SRNO
																			FROM	TBCSPDCP205L Z
																			WHERE	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
																			AND		A.ACP_YR = Z.ACP_YR
																			AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
																			GROUP BY Z.REQ_DVSN_CD, Z.ACP_YR, Z.CVPT_ACP_NO
																		)
			AND		A.REQ_DVSN_CD = H.REQ_DVSN_CD(+)
			AND		A.ACP_YR = H.ACP_YR(+)
			AND		A.CVPT_ACP_NO = H.CVPT_ACP_NO(+)																			
		]]>
	</select>
	
	<insert id="CSPDCP415P203Merge" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,'A1' AS CVPT_DOC_DVSN_CD
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #CVPT_DOC_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,'A1'
		        					,#CVPT_DOC_TXT#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP415P203Merge2" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,'A2' AS CVPT_DOC_DVSN_CD
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #CVPT_DOC_TXT2#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,'A2'
		        					,#CVPT_DOC_TXT2#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP415P203Merge3" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,'A3' AS CVPT_DOC_DVSN_CD
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #CVPT_DOC_TXT3#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,'A3'
		        					,#CVPT_DOC_TXT3#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP415P203Merge4" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,'A4' AS CVPT_DOC_DVSN_CD
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #CVPT_DOC_TXT4#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,'A4'
		        					,#CVPT_DOC_TXT4#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<update id="CSPDCP415P201ANSTXTUPDATE" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP201M
			SET		ANS_TXT = #ANS_TXT#
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO# 
		]]>
	</update>
	
	<resultMap class="java.util.HashMap" id="ansMap">
 		<result property="REQ_DVSN_CD" column="REQ_DVSN_CD"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ACP_YR" column="ACP_YR"                             jdbcType="VARCHAR2"  javaType="java.lang.String" /> 
		<result property="CVPT_ACP_NO" column="CVPT_ACP_NO"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="SMG_CVPT_HNDL_DVSN_CD" column="SMG_CVPT_HNDL_DVSN_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="OPM_NTF_DVSN_CD" column="OPM_NTF_DVSN_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="NTF_YN" column="NTF_YN"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_WDW_DT" column="CVPT_WDW_DT"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_WDW_YN" column="CVPT_WDW_YN"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_HNDL_STA_CD" column="CVPT_HNDL_STA_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ANS_TXT" column="ANS_TXT"       jdbcType="CLOB"  javaType="java.lang.String" />
		<result property="ACP_RUT_CD" column="ACP_RUT_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="RSLT_NTF_WAY_CD" column="RSLT_NTF_WAY_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_KND_DVSN_CD" column="CVPT_KND_DVSN_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="SUC_CVPT_HNDL_STA_CD" column="SUC_CVPT_HNDL_STA_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="SUC_TXT" column="SUC_TXT"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="INSPC_YN" column="INSPC_YN"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ANS_DOC_ID" column="ANS_DOC_ID"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="EML_ID" column="EML_ID"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_OPM_APV_HNDL_STA_CD" column="CVPT_OPM_APV_HNDL_STA_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="HPN" column="HPN"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_OPM_SRNO" column="CVPT_OPM_SRNO"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ONR_DOC_MNG_CRD_ID" column="ONR_DOC_MNG_CRD_ID"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ONR_APV_CMPT_DH" column="ONR_APV_CMPT_DH"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="WDW_RQS_YN" column="WDW_RQS_YN"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="RPET_YN" column="RPET_YN"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_HNDL_DVSN_CD" column="CVPT_HNDL_DVSN_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String" />
		
 	</resultMap>
	<select id="CSPDCP412EAnsSelect" parameterClass="paramMap"
		resultMap="ansMap">
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, B.SMG_CVPT_HNDL_DVSN_CD
					, NVL(B.OPM_NTF_DVSN_CD,'N') AS OPM_NTF_DVSN_CD
					, OPM_NTF_DVSN_CD AS NTF_YN
					, TO_CHAR(A.CVPT_WDW_DH,'YYYYMMDD') AS  CVPT_WDW_DT
					, DECODE(A.CVPT_WDW_DH,NULL,'N','Y') AS CVPT_WDW_YN
					, A.CVPT_HNDL_STA_CD
					, CASE WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '101' THEN TO_CLOB('귀하께서 제출하신 감사요청사항을 취하하여 감사요청사항의 처리에 관한 규정 제14조제3항에 따라 회신하지 않습니다.')
						WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '102'  THEN TO_CLOB('귀하께서 제출하신 감사요청사항은 가명․차명․ 무기명 또는 주소가 불분명한 경우로 감사요청사항의 처리에 관한 규정 제14조제3항에 따라 회신하지 않습니다.')
						WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '103' THEN TO_CLOB('귀하께서 제출하신 감사요청사항은 3회 이상 반복 제출된 동일한 감사요청사항으로 종결처리되어 감사요청사항의 처리에 관한 규정 제14조제3항에 따라 회신하지 않습니다.')
						WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '104' THEN TO_CLOB('귀하께서 제출하신 감사요청사항에 대해 회신을 원하지 않아 감사요청사항의 처리에 관한 규정 제14조제3항에 따라 회신하지 않습니다.')
						WHEN B.ANS_TXT IS NULL AND ( A.RPET_YN IS NULL OR A.RPET_YN ='N' ) THEN (SELECT  CVPT_DOC_TXT
																								FROM 	TBCSPDCP203M Z 
																								WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
																								AND		A.ACP_YR = Z.ACP_YR
																								AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
																								AND		Z.CVPT_DOC_DVSN_CD = 'A3')
						ELSE B.ANS_TXT END AS ANS_TXT
					, A.ACP_RUT_CD
					, A.RSLT_NTF_WAY_CD
					, B.CVPT_KND_DVSN_CD
					, (	SELECT	Z.CVPT_HNDL_STA_CD 
						FROM 	TBCSPDCP101M Z 
						WHERE 	Z.REQ_DVSN_CD = #strSUC_REQ_DVSN_CD#
						AND		Z.ACP_YR = #strSUC_ACP_YR#
						AND		Z.CVPT_ACP_NO = #strSUC_CVPT_ACP_NO#
					  ) AS SUC_CVPT_HNDL_STA_CD
					, '해당감사제보는 [ '||A.ACP_YR||'-민원-'||A.RM_CVPT_ACP_NO||' ] 와 합건처리되었습니다.' AS SUC_TXT
					/*, (CASE WHEN CVPT_KND_DVSN_CD = '1' THEN ''
						WHEN	CVPT_KND_DVSN_CD = '2' AND (SELECT 	COUNT(*) 
															FROM	TBCSPDCP205L Z
															WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
															AND		A.ACP_YR = Z.ACP_YR
															AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
															AND		CVPT_HNDL_DVSN_CD IN ('40')) > 0  
								AND B.INSPC_RSLT_TG_YN <> 'Y' 
								THEN 'Y' ELSE '' END ) AS INSPC_YN*/
					,''  AS INSPC_YN
					,B.DOC_ID AS ANS_DOC_ID
					,A.EML_ID
					,C.CVPT_OPM_APV_HNDL_STA_CD
					,A.HPN
					,C.CVPT_OPM_SRNO
					,C.ONR_DOC_MNG_CRD_ID
					,TO_CHAR(C.ONR_APV_CMPT_DH,'YYYY-MM-DD HH24:MI') AS ONR_APV_CMPT_DH
					,A.WDW_RQS_YN
					,A.RPET_YN AS RPET_YN
					,(SELECT  Z.CVPT_HNDL_DVSN_CD
					FROM 	TBCSPDCP205L Z 
					WHERE	Z.REQ_DVSN_CD = #strREQ_DVSN_CD#
					AND		Z.ACP_YR = #strACP_YR#
					AND		Z.CVPT_ACP_NO = #strCVPT_ACP_NO#
					AND     Z.SRNO = (	SELECT  MIN(SRNO)
										FROM 	TBCSPDCP205L X 
										WHERE	X.REQ_DVSN_CD = #strREQ_DVSN_CD#
										AND		X.ACP_YR = #strACP_YR#
										AND		X.CVPT_ACP_NO = #strCVPT_ACP_NO#
									  )
					) as CVPT_HNDL_DVSN_CD
			FROM	TBCSPDCP101M A
					, TBCSPDCP201M B
					, TBCSPDCP301M C
			WHERE	A.REQ_DVSN_CD = B.REQ_DVSN_CD
			AND		A.ACP_YR = B.ACP_YR
			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = #strREQ_DVSN_CD#
   			AND		A.ACP_YR = #strACP_YR#
   			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD(+)
			AND		A.ACP_YR = C.ACP_YR(+)
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO(+)
			AND		C.CVPT_IFM_DVSN_CD(+) = 'A'
		]]>
	</select>
	
	<!-- 민원처리결과 답변탭 저장시 민원 기본 테이블 UPDATE (취하일시) -->
	<update id="CSPDCP412E101AnsUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	/*CSPDCP412E101AnsUpdate*/ TBCSPDCP101M
			SET		CVPT_WDW_DH = DECODE(#CVPT_WDW_YN#,'Y',SYSDATE,NULL)
					,CVPT_HNDL_STA_CD = CASE WHEN #CVPT_HNDL_STA_CD# ='41' AND #OPM_NTF_DVSN_CD# = 'N' THEN '40' 
						ELSE CVPT_HNDL_STA_CD END
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</update>
	
	<!-- 민원처리결과 답변탭 저장시 민원 기본 테이블 UPDATE (취하일시) -->
	<update id="CSPDCP412E101AnsSucUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	/*CSPDCP412E101AnsSucUpdate*/ TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD = CASE WHEN #CVPT_HNDL_STA_CD# ='41' AND #OPM_NTF_DVSN_CD# = 'N' THEN '40' 
						ELSE CVPT_HNDL_STA_CD END
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
														)
		]]>
	</update>
	
	
	<!-- 처리결과 답변 탭 저장시 처리구분, 통보확인코드,처리결과답변 내용 저장  -->
	<update id="CSPDCP412E201AnsUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	/*CSPDCP412E201AnsUpdate*/ TBCSPDCP201M
			SET		SMG_CVPT_HNDL_DVSN_CD = #SMG_CVPT_HNDL_DVSN_CD#
					,OPM_NTF_DVSN_CD = #OPM_NTF_DVSN_CD#
					,ANS_TXT = #ANS_TXT#
					,DOC_ID = #ANS_DOC_ID#
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</update>
	
	<!-- 처리결과 답변 탭 저장시 처리구분, 통보확인코드,처리결과답변 내용 저장  -->
	<update id="CSPDCP412E201AnsSucUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	/*CSPDCP412E201AnsSucUpdate*/ TBCSPDCP201M
			SET		SMG_CVPT_HNDL_DVSN_CD = #SMG_CVPT_HNDL_DVSN_CD#
					,OPM_NTF_DVSN_CD = #OPM_NTF_DVSN_CD#
					,ANS_TXT = #ANS_TXT#
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
														)
		]]>
	</update>
	
	<!-- 처리결과 답변탭에서 취하시 합건된 목록을 삭제함으로써 합건 해지한다. -->
	<delete id="CSPDCP412EAnsSucDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE	
			FROM	TBCSPDCP105L
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</delete>
	
	<update id="CSPDCP412E101NtfUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD = CASE WHEN #CVPT_WDW_YN# = 'Y' THEN '70'
											WHEN #CVPT_WDW_YN# = 'N' AND #CVPT_KND_DVSN_CD# = '1' 
												AND (	SELECT  Z.CVPT_HNDL_DVSN_CD
														FROM 	TBCSPDCP205L Z 
														WHERE	Z.REQ_DVSN_CD = #REQ_DVSN_CD#
														AND		Z.ACP_YR = #ACP_YR#
														AND		Z.CVPT_ACP_NO = #CVPT_ACP_NO#
														AND     Z.SRNO = (	SELECT  MIN(SRNO)
																			FROM 	TBCSPDCP205L X 
																			WHERE	X.REQ_DVSN_CD = #REQ_DVSN_CD#
																			AND		X.ACP_YR = #ACP_YR#
																			AND		X.CVPT_ACP_NO = #CVPT_ACP_NO#
																		  )
												    ) IN ('60')
												THEN '50'
											WHEN #CVPT_WDW_YN# = 'N' AND #CVPT_KND_DVSN_CD# = '2' THEN '60'
										ELSE '60' END
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</update>
	
	<!-- 합건민원 처리결과 통보시 접수기본 테이블 상태값 UPDATE -->
	<update id="CSPDCP412E101NtfSucUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	/*CSPDCP412E101NtfSucUpdate*/ TBCSPDCP101M D1
			SET		D1.CVPT_HNDL_STA_CD = ( SELECT  CVPT_HNDL_STA_CD
											FROM	TBCSPDCP101M 
											WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
											AND		ACP_YR = #ACP_YR#
											AND		CVPT_ACP_NO = #CVPT_ACP_NO#
										  )
			WHERE	(D1.REQ_DVSN_CD, D1.ACP_YR,D1.CVPT_ACP_NO ) IN (	SELECT 	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L 
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
														  )
		]]>
	</update>
	
	<insert id="CSPDCP412E202NtfInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#REQ_DVSN_CD#
							,#ACP_YR#
							,#CVPT_ACP_NO#
							,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
								  FROM TBCSPDCP202H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #REQ_DVSN_CD#
							       AND ACP_YR = #ACP_YR#
							       AND CVPT_ACP_NO = #CVPT_ACP_NO#
							 )
							,F_USR_INFO(#S_CNB#,'5')
							,F_USR_INFO(#S_CNB#,'1')
							,( SELECT  CVPT_HNDL_STA_CD
											FROM	TBCSPDCP101M 
											WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
											AND		ACP_YR = #ACP_YR#
											AND		CVPT_ACP_NO = #CVPT_ACP_NO#
										  )
							,F_USR_INFO(#S_CNB#,'1')
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>
	
	<!-- 처리결과 통보시 합건자료 배부이력 INSERT -->
	<insert id="CSPDCP412E202NtfSucInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		SELECT	A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO
        				,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
						  	FROM TBCSPDCP202H Z
							WHERE 1=1
					       	AND Z.REQ_DVSN_CD = A.REQ_DVSN_CD
					       	AND Z.ACP_YR = A.ACP_YR
					    	AND Z.CVPT_ACP_NO = A.CVPT_ACP_NO
					 	)
					 	,F_USR_INFO(#S_CNB#,'5')
					 	,F_USR_INFO(#S_CNB#,'1')
					 	,( SELECT  CVPT_HNDL_STA_CD
											FROM	TBCSPDCP101M 
											WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
											AND		ACP_YR = #ACP_YR#
											AND		CVPT_ACP_NO = #CVPT_ACP_NO#
										  )
					 	,F_USR_INFO(#S_CNB#,'1')
					 	,#FNL_USR_ID#
						,#FNL_DEAL_DPT_CD#
						,#FNL_MNU_ID#
						,SYSDATE
						,SYSDATE
				FROM	TBCSPDCP101M A
				WHERE	(A.REQ_DVSN_CD, A.ACP_YR,A.CVPT_ACP_NO ) IN (	SELECT 	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
																FROM	TBCSPDCP105L 
																WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
																AND		ACP_YR = #ACP_YR#
																AND		CVPT_ACP_NO = #CVPT_ACP_NO#
															  )
		]]>
	</insert>
	
	<update id="CSPDCP412E201NtfUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	/*CSPDCP412E201NtfUpdate*/ TBCSPDCP201M D1
			SET		INSPC_RSLT_TG_YN = DECODE(#OPM_NTF_DVSN_CD#,'Y','',(DECODE(#CVPT_KND_DVSN_CD#,'1','','2','N')))
					,FNL_HNDL_DH = CASE WHEN ( SELECT  CVPT_HNDL_STA_CD
											FROM	TBCSPDCP101M 
											WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
											AND		ACP_YR = #ACP_YR#
											AND		CVPT_ACP_NO = #CVPT_ACP_NO#
										  ) = '50' THEN NULL ELSE SYSDATE END
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</update>
	
	<!-- 처리결과 통보시 합건민원일 경우  사후관리등록 처리 로직-->
	<update id="CSPDCP412E201SucNtfUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	/*CSPDCP412E201SucNtfUpdate*/ TBCSPDCP201M D1
			SET		INSPC_RSLT_TG_YN = DECODE(#OPM_NTF_DVSN_CD#,'Y','',(DECODE(#CVPT_KND_DVSN_CD#,'1','','2','N')))
					,SMG_CVPT_HNDL_DVSN_CD = #SMG_CVPT_HNDL_DVSN_CD#
					,OPM_NTF_DVSN_CD = #OPM_NTF_DVSN_CD#
					,FNL_HNDL_DH = CASE WHEN ( SELECT  CVPT_HNDL_STA_CD
											FROM	TBCSPDCP101M 
											WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
											AND		ACP_YR = #ACP_YR#
											AND		CVPT_ACP_NO = #CVPT_ACP_NO#
										  ) = '50' THEN NULL ELSE SYSDATE END
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (	SELECT 	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L 
															WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		ACP_YR = #ACP_YR#
															AND		CVPT_ACP_NO = #CVPT_ACP_NO#
														  )
		]]>
	</update>
	
	<!-- 처리결과 통보시  민원이메일 기본 테이블 insert-->
	<insert id="CSPDCP412E303NtfInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP303M
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_EML_HIS_SRNO
        					,DGE
        					,SEN_DH
        					,EML_TXT
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#REQ_DVSN_CD#
							,#ACP_YR#
							,#CVPT_ACP_NO#
							,(	SELECT NVL(MAX(CVPT_EML_HIS_SRNO),0)+1
								  FROM TBCSPDCP303M
								 WHERE 1=1
							       AND REQ_DVSN_CD = #REQ_DVSN_CD#
							       AND ACP_YR = #ACP_YR#
							       AND CVPT_ACP_NO = #CVPT_ACP_NO#
							 )
							,NULL
							,SYSDATE
							,#ANS_TXT#
							,F_USR_INFO(#S_CNB#,'1')
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>
	
	<!-- 처리결과 통보시 합건자료 민원이메일 기본 테이블 insert-->
	<insert id="CSPDCP412E303NtfSucInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP303M
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_EML_HIS_SRNO
        					,DGE
        					,SEN_DH
        					,EML_TXT
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		SELECT	A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO
						,(	SELECT NVL(MAX(Z.CVPT_EML_HIS_SRNO),0)+1
							  FROM TBCSPDCP303M Z
							 WHERE 1=1
						       AND Z.REQ_DVSN_CD = A.REQ_DVSN_CD
						       AND Z.ACP_YR = A.ACP_YR
						       AND Z.CVPT_ACP_NO = A.CVPT_ACP_NO
						 )
						,NULL
						,SYSDATE
						,#ANS_TXT#
						,F_USR_INFO(#S_CNB#,'1')
						,#FNL_USR_ID#
						,#FNL_DEAL_DPT_CD#
						,#FNL_MNU_ID#
						,SYSDATE
						,SYSDATE
				FROM	TBCSPDCP101M A
				WHERE	(REQ_DVSN_CD, ACP_YR,CVPT_ACP_NO ) IN (	SELECT 	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
																FROM	TBCSPDCP105L 
																WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
																AND		ACP_YR = #ACP_YR#
																AND		CVPT_ACP_NO = #CVPT_ACP_NO#
															  )
				AND		RSLT_NTF_WAY_CD = '002'
				AND		EML_ID IS NOT NULL
		]]>
	</insert>
	
	<resultMap class="java.util.HashMap" id="cspdcp418">
 		<result property="REQ_DVSN_CD" column="REQ_DVSN_CD"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ACP_YR" column="ACP_YR"                             jdbcType="VARCHAR2"  javaType="java.lang.String" /> 
		<result property="CVPT_ACP_NO" column="CVPT_ACP_NO"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_NO" column="ACP_NO"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPTR_NM" column="CVPTR_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="AD" column="AD"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ZCD" column="ZCD"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_OPM_SRNO" column="CVPT_OPM_SRNO"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="OPM_TXT" column="OPM_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="ONR_DOC_MNG_CRD_ID" column="ONR_DOC_MNG_CRD_ID"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="CVPT_IFM_DVSN_CD" column="CVPT_IFM_DVSN_CD"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TITLE" column="TITLE"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="DGE" column="DGE"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TIT_NM" column="TIT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TEL" column="TEL"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="FL_RUT_NM" column="FL_RUT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="SYS_FL_NM" column="SYS_FL_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="RECEIVER" column="RECEIVER"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
 	</resultMap>
	
	<select id="CSPDCP418PMainSelect" parameterClass="paramMap"
		resultMap="cspdcp418">
        <![CDATA[     	
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, A.ACP_YR||'-민원-'||C.RM_CVPT_ACP_NO AS ACP_NO
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) AS CVPTR_NM
					, DECODE(C.ZCD,NULL,NULL,C.AD||' '||C.DTL_AD) AS AD
					, C.ZCD
					, B.CVPT_OPM_SRNO
					, CASE WHEN D.OPM_TXT IS NULL AND #strDGE# IS NULL THEN (SELECT  CVPT_DOC_TXT
																			FROM 	TBCSPDCP203M Z 
																			WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
																			AND		A.ACP_YR = Z.ACP_YR
																			AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
																			AND		Z.CVPT_DOC_DVSN_CD = 'A3')
						WHEN D.OPM_TXT IS NULL AND #strDGE# IS NOT NULL THEN (SELECT  CVPT_DOC_TXT
																			FROM 	TBCSPDCP203M Z 
																			WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
																			AND		A.ACP_YR = Z.ACP_YR
																			AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
																			AND		Z.CVPT_DOC_DVSN_CD = 'B4'
																			AND		Z.DGE = #strDGE#)
						ELSE D.OPM_TXT END AS OPM_TXT
					, B.ONR_DOC_MNG_CRD_ID
					, NVL(B.CVPT_IFM_DVSN_CD,#strCVPT_IFM_DVSN_CD#) AS CVPT_IFM_DVSN_CD
					, F_CODE_NM('1000370',NVL(B.CVPT_IFM_DVSN_CD,#strCVPT_IFM_DVSN_CD#)) AS TITLE
					, #strDGE# AS DGE
					, C.TIT_NM
					, DECODE(C.TNB,NULL,C.HPN,C.TNB) AS TEL
					, E.FL_RUT_NM
					, E.SYS_FL_NM
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) || ' 귀하 (우'||C.ZCD || ' ' || C.AD || ' ' || C.DTL_AD || ')' AS RECEIVER
			FROM	TBCSPDCP201M A
					, TBCSPDCP301M B
					, TBCSPDCP101M C
					, TBCSPDCP302M D
					, TBDCMACM103L E
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #strREQ_DVSN_CD#
			AND		A.ACP_YR = #strACP_YR#
			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
			AND		A.ACP_YR = C.ACP_YR
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
			AND		A.ACP_YR = B.ACP_YR(+)
			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			AND		B.CVPT_IFM_DVSN_CD(+) = #strCVPT_IFM_DVSN_CD#
			AND		B.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
			AND		B.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
			AND		B.ACP_YR = D.ACP_YR(+)
			AND		B.CVPT_OPM_SRNO = D.CVPT_OPM_SRNO(+)
			AND		B.ONR_DOC_MNG_CRD_ID = E.ONR_DOC_MNG_CRD_ID(+)
		]]>
		<dynamic>
			<isNotEmpty property="strDGE" prepend="AND">
					B.DGE(+) = #strDGE#
			</isNotEmpty>
		</dynamic>
	</select>
	
	<select id="CSPDCP418P301KeySelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[     	
			SELECT 	TO_CHAR(NVL(MAX(TO_NUMBER(CVPT_OPM_SRNO)),0)+1) AS CVPT_OPM_SRNO
			FROM 	TBCSPDCP301M
			WHERE 	1=1
			AND 	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND 	ACP_YR = #ACP_YR#
			AND 	CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</select>
	
	
	<update id="CSPDCP418P101Update" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD ='41'
					,FNL_USR_ID = #FNL_USR_ID#
     				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
     				,FNL_MNU_ID = #FNL_MNU_ID#
      				,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND 	ACP_YR = #ACP_YR#
			AND 	CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</update>
	
	<insert id="CSPDCP418P301Merge" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP301M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_OPM_SRNO# AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,CVPT_OPM_SRNO
		        					,DGE
		        					,CVPT_IFM_DVSN_CD
		        					,CVPT_OPM_APV_HNDL_STA_CD
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
		        					,#CVPT_OPM_SRNO#
		        					,#DGE#
		        					,#CVPT_IFM_DVSN_CD#
		        					,'10'
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP418P302Merge" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP302M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_OPM_SRNO# AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		OPM_TXT = #OPM_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,CVPT_OPM_SRNO
		        					,OPM_TXT
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
		        					,#CVPT_OPM_SRNO#
		        					,#OPM_TXT#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP412E202InspcInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#REQ_DVSN_CD#
							,#ACP_YR#
							,#CVPT_ACP_NO#
							,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
								  FROM TBCSPDCP202H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #REQ_DVSN_CD#
							       AND ACP_YR = #ACP_YR#
							       AND CVPT_ACP_NO = #CVPT_ACP_NO#
							 )
							,F_USR_INFO(#S_CNB#,'5')
							,F_USR_INFO(#S_CNB#,'1')
							,'50'
							,F_USR_INFO(#S_CNB#,'1')
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>
	
	<update id="CSPDCP412E201InspcUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP201M
			SET		INSPC_RSLT_TG_YN = 'Y'
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</update>
	
	<insert id="CSPDCP412E403InspcInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP404H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,TG_SEL_HST_SRNO
        					,TG_SEL_DH
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#REQ_DVSN_CD#
							,#ACP_YR#
							,#CVPT_ACP_NO#
							,(	SELECT NVL(MAX(TG_SEL_HST_SRNO),0)+1
								  FROM TBCSPDCP404H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #REQ_DVSN_CD#
							       AND ACP_YR = #ACP_YR#
							       AND CVPT_ACP_NO = #CVPT_ACP_NO#
							 )
							,SYSDATE
							,F_USR_INFO(#S_CNB#,'1')
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>
	
	<select id="CSPDCP412E204LawSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, A.LAW_HIS_SRNO
					, (	SELECT	Z.LAW_NM
						FROM	TBBADCMR013M Z
						WHERE	A.LAW_LNK_ID = Z.LAW_LNK_ID) AS LAW_NM
					, A.LAW_DTL_TXT
					, A.LAW_LNK_ID
			FROM	TBCSPDCP204L A
			WHERE	A.REQ_DVSN_CD = #strREQ_DVSN_CD#
			AND		A.ACP_YR = #strACP_YR#
			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
			AND		A.DGE IS NULL
		]]>
	</select>
	
	<insert id="CSPDCP412E204LawInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP204L
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,LAW_HIS_SRNO
        					,LAW_LNK_ID
        					,DGE
        					,LAW_DTL_TXT
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#REQ_DVSN_CD#
							,#ACP_YR#
							,#CVPT_ACP_NO#
							,(	SELECT 	NVL(MAX(LAW_HIS_SRNO),0)+1
								FROM	TBCSPDCP204L 
								WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
								AND		ACP_YR = #ACP_YR#
								AND		CVPT_ACP_NO = #CVPT_ACP_NO#
							  )
							,#LAW_LNK_ID#
							,NULL
							,#LAW_DTL_TXT#
							,F_USR_INFO(#S_CNB#,'1')
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
        ]]>
	</insert>
	
	<update id="CSPDCP412E204LawUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP204L
			SET		LAW_DTL_TXT = #LAW_DTL_TXT#
					,FNL_USR_ID = #FNL_USR_ID#
   					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
   					,FNL_MNU_ID = #FNL_MNU_ID#
   					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
			AND		LAW_LNK_ID = #LAW_LNK_ID#
			AND		LAW_HIS_SRNO = #LAW_HIS_SRNO#
		]]>
	</update>
	
	<delete id="CSPDCP412E204LawDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPDCP204L
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
			AND		LAW_LNK_ID = #LAW_LNK_ID#
			AND		LAW_HIS_SRNO = #LAW_HIS_SRNO#
		]]>
	</delete>
	
	<resultMap class="java.util.HashMap" id="cspdcp414Map">
 		<result property="REQ_DVSN_CD" column="REQ_DVSN_CD"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ACP_YR" column="ACP_YR"                             jdbcType="VARCHAR2"  javaType="java.lang.String" /> 
		<result property="CVPT_ACP_NO" column="CVPT_ACP_NO"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_NO" column="ACP_NO"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_DH" column="ACP_DH"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_RUT_NM" column="ACP_RUT_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPTR_NM" column="CVPTR_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="AD" column="AD"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="TIT_NM" column="TIT_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_TXT" column="CVPT_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="SMG_CVPT_APL_NO" column="SMG_CVPT_APL_NO"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TNB" column="TNB"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="HPN" column="HPN"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="ATCH_YN" column="ATCH_YN"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
 	</resultMap>
	<select id="CSPDCP414PMainSelect" parameterClass="paramMap"
		resultMap="cspdcp414Map">
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.ACP_YR||'-민원-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,F_CODE_NM('1000056',A.ACP_RUT_CD) AS ACP_RUT_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,DECODE(A.ZCD,NULL,'','(우)'||A.ZCD||' '||A.AD||' '||A.DTL_AD) AS AD
   					,A.TIT_NM
   					,B.CVPT_TXT
   					,A.SMG_CVPT_APL_NO
   					,A.TNB
   					,A.HPN
   					,CASE WHEN	(	SELECT	COUNT(FILE_ID)
  			 						FROM	ECM_FILE_LIST_VIEW2 X
   									WHERE	A.DOC_ID = X.DOC_ID
			   					) > 0 THEN 'Y' 
			   		ELSE 'N' END AS ATCH_YN
   			FROM	TBCSPDCP101M A
   					,TBCSPDCP102M B
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #strREQ_DVSN_CD#
   			AND		A.ACP_YR = #strACP_YR#
   			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
		]]>
			
	</select>
	
	<select id="CSPDCP412EMmsSeqSelect" parameterClass="paramMap" resultClass="int">
		<![CDATA[
			SELECT MMS_CONTENTS_INFO_SEQ.NEXTVAL AS CONT_SEQ FROM  DUAL
		]]>
		
	</select>
	
	<insert id="CSPDCP412EMmsMsgInsert" parameterClass ="paramMap">
		<![CDATA[
			INSERT INTO MMS_CONTENTS_INFO 
				 	(	CONT_SEQ
				 		, FILE_CNT
				 		, MMS_BODY
				 		, MMS_SUBJECT
				 	) 
			VALUES (	#CONT_SEQ#
						, 1
						, #SMS_TXT#||'접수번호 : '||(	SELECT	ACP_YR||'-'||F_CODE_NM('1000740',REQ_DVSN_CD)||'-'||RM_CVPT_ACP_NO
													FROM	TBCSPDCP101M
													WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
													AND		ACP_YR = #ACP_YR#
													AND		CVPT_ACP_NO = #CVPT_ACP_NO#)
						, '감사원 감사제보 문자통보'
					)
		]]>
	</insert>
	
	<insert id="CSPDCP412E416MmsMsgInsert" parameterClass ="paramMap">
		<![CDATA[
			INSERT INTO MMS_CONTENTS_INFO 
				 	(	CONT_SEQ
				 		, FILE_CNT
				 		, MMS_BODY
				 		, MMS_SUBJECT
				 	) 
			VALUES (	#CONT_SEQ#
						, 1
						, #SMS_TXT#||#ACP_NO#
						, '감사원 감사제보 문자통보'
					)
		]]>
	</insert>
	
	<insert id="CSPDCP412EMsgInsert" parameterClass ="paramMap">
		<![CDATA[
			INSERT INTO MSG_DATA
				 	(	MSG_SEQ
				 		, CUR_STATE
				 		, REQ_DATE
				 		, CALL_TO
				 		, CALL_FROM
				 		, SMS_TXT
				 		, MSG_TYPE
				 		, CONT_SEQ
				 	) 
			VALUES (	MSG_DATA_SEQ.NEXTVAL
						, 0
						, SYSDATE
						, REPLACE(#HPN#,'-','')
						, F_DPT_INFO(#FNL_DEAL_DPT_CD#,'8') 
						, ''
						, 6
						, #CONT_SEQ#
					)
		]]>
	</insert>
	
	<insert id="CSPDCP412E304MsgInsert" parameterClass ="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP304L
						(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_SMS_TRNM_HIS_SRNO
							,TRNM_HPN
							,RPL_TNB
							,SMS_TXT
							,TRNM_DH
							,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
       			VALUES	(	#REQ_DVSN_CD#
       						,#ACP_YR#
       						,#CVPT_ACP_NO#
							,(	SELECT NVL(MAX(CVPT_SMS_TRNM_HIS_SRNO),0)+1
								  FROM TBCSPDCP304L
								 WHERE 1=1
							       AND REQ_DVSN_CD = #REQ_DVSN_CD#
							       AND ACP_YR = #ACP_YR#
							       AND CVPT_ACP_NO = #CVPT_ACP_NO#
							 )
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'8') 
							,#HPN#
							,#SMS_TXT#
							,SYSDATE
							,F_USR_INFO(#S_CNB#,'1')
							,F_USR_INFO(#S_CNB#,'1')
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
						
		]]>
	</insert>
	
	<insert id="CSPDCP412ESmgInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,'500'
							,'N'
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'6')
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'7')
							,F_USR_INFO(#S_CNB#,'2')
							,''
							,'02-2011-2191'
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M
				WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
				AND		ACP_YR = #ACP_YR#
				AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</insert>
	
	<update id="CSPDCP411PDCP301ONRUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP301M
			SET		ONR_DOC_MNG_CRD_ID = #ONR_DOC_MNG_CRD_ID#
					,ONR_APV_RQS_DH = SYSDATE
					,ADMN_INF_HNDL_NO = #ADMN_INF_HNDL_NO#
					,CVPT_OPM_APV_HNDL_STA_CD = '20'
					,FNL_USR_ID = #FNL_USR_ID#
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
					,FNL_MNU_ID = #FNL_MNU_ID#
					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
			AND		CVPT_OPM_SRNO = #CVPT_OPM_SRNO#
		]]>
	</update>
	
	<insert id="CSPDCP416ESmgInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,'500'
							,'N'
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'6')
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'7')
							,F_USR_INFO(#S_CNB#,'2')
							,''
							,'02-2011-2191'
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M
				WHERE	REQ_DVSN_CD = #SUC_REQ_DVSN_CD#
				AND		ACP_YR = #SUC_ACP_YR#
				AND		CVPT_ACP_NO = #SUC_CVPT_ACP_NO#
		]]>
	</insert>
	
	
	<insert id="CSPDCP412ESmgNtfInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_CONTENTS		/*민원 처리결과 내용*/
							,PCD_REG_DATE		/*처리일자*/
							,PCD_CONTENTS_ATTACH_YN	/*민원처리결과첨부여부*/
							,PCD_GUBUN			/*신문고민원 처리구분코드*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,DECODE(SMG_FRT_HNDL_STA_CD, '161','181', '163','183')
							,'N'
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'6')
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'7')
							,F_USR_INFO(#S_CNB#,'2')
							,''
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'8')
							,#ANS_TXT#
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'N'
							,#SMG_CVPT_HNDL_DVSN_CD#
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M
				WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
				AND		ACP_YR = #ACP_YR#
				AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</insert>
	
	<insert id="CSPDCP412ESmgSucNtfInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_CONTENTS		/*민원 처리결과 내용*/
							,PCD_REG_DATE		/*처리일자*/
							,PCD_CONTENTS_ATTACH_YN	/*민원처리결과첨부여부*/
							,PCD_GUBUN			/*신문고민원 처리구분코드*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,DECODE(SMG_FRT_HNDL_STA_CD, '161','181', '163','183')
							,'N'
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'6')
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'7')
							,F_USR_INFO(#S_CNB#,'2')
							,''
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'8')
							,#ANS_TXT#
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'N'
							,#SMG_CVPT_HNDL_DVSN_CD#
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M A
				WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
																FROM	TBCSPDCP105L
																WHERE 	REQ_DVSN_CD = #REQ_DVSN_CD#
																AND		ACP_YR = #ACP_YR#
																AND		CVPT_ACP_NO = #CVPT_ACP_NO#
															  )
				AND		A.ACP_RUT_CD = '8'
		]]>
	</insert>
	
	<!-- 처리전 온나라 결재시 시행문 테이블 Merge -->
	<insert id="CSPDCP415POnr301Merge" parameterClass="paramMap">
		<![CDATA[
			MERGE INTO 	TBCSPDCP301M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_OPM_SRNO# AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_OPM_APV_HNDL_STA_CD = '10'
        					,ADMN_INF_HNDL_NO = #ADMN_INF_HNDL_NO#
        					,ONR_DOC_MNG_CRD_ID = #ONR_DOC_MNG_CRD_ID#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
				INSERT 	(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_OPM_SRNO
							,DGE
							,CVPT_IFM_DVSN_CD
	       					,CVPT_OPM_APV_HNDL_STA_CD
	       					,ADMN_INF_HNDL_NO
	       					,ONR_DOC_MNG_CRD_ID
	       					,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
	       		VALUES	(	#REQ_DVSN_CD#
							,#ACP_YR#
							,#CVPT_ACP_NO#
							,#CVPT_OPM_SRNO#
							,NULL
							,'C'
	       					,'10'
	       					,#ADMN_INF_HNDL_NO#
	       					,#ONR_DOC_MNG_CRD_ID#
	       					,#FRT_USR_ID#
	       					,#FNL_USR_ID#
	       					,#FNL_DEAL_DPT_CD#
	       					,#FNL_MNU_ID#
	       					,SYSDATE
	       					,SYSDATE
	       				)
		]]>
	</insert>
	
	<insert id="CSPDCP415POnr302Merge" parameterClass="paramMap">
		<![CDATA[
			MERGE INTO 	TBCSPDCP302M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_OPM_SRNO# AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		OPM_TXT = #OPM_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
				INSERT 	(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_OPM_SRNO
	       					,OPM_TXT
	       					,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
		       				)
		       		VALUES	(	#REQ_DVSN_CD#
								,#ACP_YR#
								,#CVPT_ACP_NO#
								,#CVPT_OPM_SRNO#
								,#OPM_TXT#
		       					,#FRT_USR_ID#
		       					,#FNL_USR_ID#
		       					,#FNL_DEAL_DPT_CD#
		       					,#FNL_MNU_ID#
		       					,SYSDATE
		       					,SYSDATE
		       				)
		]]>
	</insert>
	
	<select id="CSPDCP412E206NtfSucCheckSelect" parameterClass="paramMap" resultClass="int">
		<![CDATA[
			SELECT	/*CSPDCP412E206NtfSucCheckSelect*/
					COUNT(*) AS CNT
			FROM	TBCSPDCP105L D1
			WHERE	D1.REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		D1.ACP_YR = #ACP_YR#
			AND		D1.CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</select>
	
	<select id="CSPDCP418POnrUserInfoSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	/*CSPDCP418POnrUserInfoSelect*/
					D1.USR_ID, 
					D1.EML_AD,
					NVL(F_DPT_INFO(D1.DPT_CD,'6'),D1.DPT_CD) AS DEPT_CD,
					D2.FRML_DPT_NM AS DEPT_NM,	
					'CSPDCP' AS BIZ_GUBUN,
					D1.USR_NAM, 
					D1.RANK_NM_2 AS POSITION_NM
			FROM	TBDCMACM001M D1
					,TBDCMACM002M D2
			WHERE 	USR_ID = #FNL_USR_ID#
			AND		D1.DPT_CD = D2.DPT_CD
		]]>
	</select>
	
	<resultMap class="java.util.HashMap" id="CSPDCP412E301OnnaraSelectMap">
 		<result property="REQ_DVSN_CD"      column="REQ_DVSN_CD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ACP_YR"           column="ACP_YR" jdbcType="VARCHAR2"  javaType="java.lang.String" /> 
		<result property="CVPT_ACP_NO"      column="CVPT_ACP_NO" jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_NO"           column="ACP_NO" jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPTR_NM"         column="CVPTR_NM" jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="AD"               column="AD" jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ZCD" 				column="ZCD" jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_OPM_SRNO" 	column="CVPT_OPM_SRNO" jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="OPM_TXT" 				column="OPM_TXT" jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="ONR_DOC_MNG_CRD_ID" 	column="ONR_DOC_MNG_CRD_ID" jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="CVPT_IFM_DVSN_CD" 	column="CVPT_IFM_DVSN_CD" jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TITLE" 				column="TITLE" jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="DGE" 					column="DGE" jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TIT_NM" 				column="TIT_NM" jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TEL" 					column="TEL" jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="RECEIVER" 			column="RECEIVER" jdbcType="VARCHAR2"      javaType="java.lang.String" />
 	</resultMap>
	
	<select id="CSPDCP412E301OnnaraSelect" parameterClass="paramMap"
		resultMap="CSPDCP412E301OnnaraSelectMap">
        <![CDATA[     	
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, A.ACP_YR||'-민원-'||C.RM_CVPT_ACP_NO AS ACP_NO
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) AS CVPTR_NM
					, DECODE(C.ZCD,NULL,NULL,C.AD||' '||C.DTL_AD) AS AD
					, C.ZCD
					, B.CVPT_OPM_SRNO
					, CASE WHEN #strDGE# IS NULL THEN A.ANS_TXT
						WHEN #strDGE# IS NOT NULL THEN (SELECT  Z.ANS_TXT
														FROM 	TBCSPDCP401H Z 
														WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
														AND		A.ACP_YR = Z.ACP_YR
														AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
														AND		Z.DGE = #strDGE#)
						ELSE NULL END AS OPM_TXT
					, B.ONR_DOC_MNG_CRD_ID
					, NVL(B.CVPT_IFM_DVSN_CD,#strCVPT_IFM_DVSN_CD#) AS CVPT_IFM_DVSN_CD
					, F_CODE_NM('1000370',NVL(B.CVPT_IFM_DVSN_CD,#strCVPT_IFM_DVSN_CD#))||' (제'||A.ACP_YR||'-민원-'||C.RM_CVPT_ACP_NO||'호)' AS TITLE
					, #strDGE# AS DGE
					, C.TIT_NM
					, DECODE(C.TNB,NULL,C.HPN,C.TNB) AS TEL
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) || ' 귀하 (우'||C.ZCD || ' ' || C.AD || ' ' || C.DTL_AD || ')' AS RECEIVER
			FROM	TBCSPDCP201M A
					, TBCSPDCP301M B
					, TBCSPDCP101M C
					, TBCSPDCP302M D
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #strREQ_DVSN_CD#
			AND		A.ACP_YR = #strACP_YR#
			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
			AND		A.ACP_YR = C.ACP_YR
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
			AND		A.ACP_YR = B.ACP_YR(+)
			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			AND		B.CVPT_IFM_DVSN_CD(+) = #strCVPT_IFM_DVSN_CD#
			AND		B.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
			AND		B.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
			AND		B.ACP_YR = D.ACP_YR(+)
			AND		B.CVPT_OPM_SRNO = D.CVPT_OPM_SRNO(+)
		]]>
		<dynamic>
			<isNotEmpty property="strDGE" prepend="AND">
					B.DGE(+) = #strDGE#
			</isNotEmpty>
		</dynamic>
	</select>
	
	<!-- 시행문 작성 온나라결재 -->
	<insert id="CSPDCP412E301OnnaraMerge" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP301M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_OPM_SRNO# AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		ONR_DOC_MNG_CRD_ID = #ONR_DOC_MNG_CRD_ID#
        					,ADMN_INF_HNDL_NO = #ADMN_INF_HNDL_NO#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,CVPT_OPM_SRNO
		        					,DGE
		        					,CVPT_IFM_DVSN_CD
		        					,CVPT_OPM_APV_HNDL_STA_CD
		        					,ADMN_INF_HNDL_NO
		        					,ONR_DOC_MNG_CRD_ID
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
		        					,#CVPT_OPM_SRNO#
		        					,#DGE#
		        					,#CVPT_IFM_DVSN_CD#
		        					,'10'
		        					,#ADMN_INF_HNDL_NO#
		        					,#ONR_DOC_MNG_CRD_ID#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>

	<insert id="CSPDCP416P205SucInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	/*CSPDCP412E205SucInsert*/
						TBCSPDCP205L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,SRNO
        					,CVPT_HNDL_DVSN_CD
        					,AUD_RFR_MTRL_TRNF_DPT_CD
        					,TRNF_DPT_CD
        					,DOC_ID
        					,DOC_TYP_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		SELECT	#SUC_REQ_DVSN_CD#
	        			,#SUC_ACP_YR#
	        			,#SUC_CVPT_ACP_NO#
       					,SRNO
       					,CVPT_HNDL_DVSN_CD
       					,AUD_RFR_MTRL_TRNF_DPT_CD
       					,TRNF_DPT_CD
       					,DOC_ID
       					,DOC_TYP_CD
       					,FRT_USR_ID
       					,FNL_USR_ID
       					,FNL_DEAL_DPT_CD
       					,FNL_MNU_ID
       					,SYSDATE
       					,SYSDATE
        		FROM	TBCSPDCP205L
        		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN ( 	SELECT	#REQ_DVSN_CD#,#ACP_YR#,#CVPT_ACP_NO# 
        														FROM 	DUAL )
		]]>
	</insert>
	
	<insert id="CSPDCP416P206SucInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	/*CSPDCP416P206SucInsert*/
						TBCSPDCP206L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,HNDL_ORG_SRNO
        					,ORG_HIS_DVSN_CD
        					,SRNO
        					,ORG_CD
        					,PUB_DVSN_CD
        					,COPT_SG_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        					,ORG_NM
        					,OGN_ORG_DVSN_CD
        				)
        	SELECT	#SUC_REQ_DVSN_CD#
        			,#SUC_ACP_YR#
        			,#SUC_CVPT_ACP_NO#
        			,HNDL_ORG_SRNO
        			,ORG_HIS_DVSN_CD
        			,SRNO
  					,ORG_CD
  					,PUB_DVSN_CD
  					,COPT_SG_CD
  					,FRT_USR_ID
  					,FNL_USR_ID
  					,FNL_DEAL_DPT_CD
  					,FNL_MNU_ID
  					,SYSDATE
  					,SYSDATE
  					,ORG_NM
  					,OGN_ORG_DVSN_CD
        	FROM	TBCSPDCP206L
        	WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN ( 	SELECT	#REQ_DVSN_CD#,#ACP_YR#,#CVPT_ACP_NO# 
        													FROM 	DUAL )
		]]>
	</insert>
	
	<select id="CSPDCP412EAudInfTrfDvsnCdCheckSelect" parameterClass="paramMap" resultClass="int">
		<![CDATA[
			SELECT	/*CSPDCP412EAudInfTrfDvsnCdCheckSelect*/
					COUNT(*) AS CNT
			FROM	TBCSPDCP205L D1
			WHERE	D1.REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		D1.ACP_YR = #ACP_YR#
			AND		D1.CVPT_ACP_NO = #CVPT_ACP_NO#
			AND		D1.SRNO = (SELECT	MIN(SRNO)
								FROM	TBCSPDCP205L S1
								WHERE	D1.REQ_DVSN_CD = #REQ_DVSN_CD#
								AND		D1.ACP_YR = #ACP_YR#
								AND		D1.CVPT_ACP_NO = #CVPT_ACP_NO#)
			AND		D1.CVPT_HNDL_DVSN_CD = '50'
		]]>
	</select>
	
	
	
	<select id="CSPDCP412EWdwCheckSelect" parameterClass="paramMap" resultClass="int">
		<![CDATA[
			SELECT	COUNT(*) AS CNT
			FROM	TBCSPDCP105L
			WHERE	REQ_DVSN_CD	= #strREQ_DVSN_CD#
			AND		ACP_YR	= #strACP_YR#
			AND		CVPT_ACP_NO = #strCVPT_ACP_NO#
		]]>
	
	</select>
	
	<select id="CSPDCP412ESucCount" parameterClass="paramMap" resultClass="int">
		<![CDATA[
			SELECT	COUNT(*) AS CNT
			FROM	TBCSPDCP105L
			WHERE	REQ_DVSN_CD	= #REQ_DVSN_CD#
			AND		ACP_YR	= #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</select>
	
	<select id="CSPDCP412EOnrSucSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	SUC_REQ_DVSN_CD AS REQ_DVSN_CD , SUC_ACP_YR AS ACP_YR, SUC_CVPT_ACP_NO AS CVPT_ACP_NO
			FROM	TBCSPDCP105L
			WHERE	REQ_DVSN_CD	= #REQ_DVSN_CD#
			AND		ACP_YR	= #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
	</select>
	
	<!-- 강제 취하 처리 한다. -->
	<update id="CSPDCP412EWdwOkSaveUpdate" parameterClass="paramMap">
		UPDATE	TBCSPDCP101M D1
		SET		D1.CVPT_HNDL_STA_CD ='70'
				,D1.FNL_MDF_DH = SYSDATE
				,D1.FNL_USR_ID = #FNL_USR_ID#
				,D1.FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,D1.FNL_MNU_ID = #FNL_MNU_ID#
		WHERE	D1.REQ_DVSN_CD = #strREQ_DVSN_CD#
 		AND		D1.ACP_YR = #strACP_YR#
 		AND		D1.CVPT_ACP_NO = #strCVPT_ACP_NO#
	</update>
	
	<select id="CSPDCP412EMsgCheckYn" parameterClass="paramMap" resultClass="String">
		SELECT	RPET_YN AS RPET_YN
		FROM	TBCSPDCP101M
		WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
		AND		ACP_YR = #ACP_YR#
		AND		CVPT_ACP_NO = #CVPT_ACP_NO#
	</select>
</sqlMap> 

