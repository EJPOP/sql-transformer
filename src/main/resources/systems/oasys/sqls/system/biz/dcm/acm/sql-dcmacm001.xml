<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="dcm/acm/001">

	<select id="dcmacm001EMessageselect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT MSG_CD/*메시지코드*/
			     , MSG_NM/*메시지명*/
			     , TSK_CAT_CD /*업무구분코드*/
			     , FUNC_CAT_CD||TSK_CAT_CD AS FUNC_CAT_CD /*기능분류코드*/
			     , MSG_CD AS ORG_MSG_CD
			FROM TBDCMACM012C
			WHERE 1=1						
        ]]>
		<isNotEmpty prepend="AND" property="strMsgNm">
			MSG_NM LIKE '%'||#strMsgNm# ||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strTskCatCd">
			TSK_CAT_CD LIKE '%'||#strTskCatCd# ||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strFuncCatCd">
			FUNC_CAT_CD LIKE '%'||#strFuncCatCd# ||'%'
		</isNotEmpty>	
		 <![CDATA[    
		 ORDER BY MSG_CD
		 ]]>
	</select>
	<!-- 메시지관리 -->
	<insert id="dcmacm001EMessageinsert" parameterClass="paramMap">
		INSERT INTO TBDCMACM012C
		(
			MSG_CD
			, MSG_NM
			, TSK_CAT_CD
			, FUNC_CAT_CD
	
			, FRT_USR_ID
			,
			FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			,
			FNL_MDF_DH
		)
		VALUES
		(
			#MSG_CD#
			, #MSG_NM#
			, #TSK_CAT_CD#
			, #FUNC_CAT_CD#
			, #FRT_USR_ID#
			,
			#FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
			, SYSDATE
			, SYSDATE
		)
	</insert>

	<!--메시지관리 update -->
	<update id="dcmacm001EMessageupdate" parameterClass="paramMap">
		<![CDATA[ 	
			UPDATE TBDCMACM012C
			   SET MSG_CD     = #MSG_CD# 
			     , TSK_CAT_CD = #TSK_CAT_CD#
			     , FUNC_CAT_CD = #FUNC_CAT_CD#
                 , FNL_MDF_DH = SYSDATE
		         , FNL_USR_ID = #FNL_USR_ID#
                 , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
		         , FNL_MNU_ID = #FNL_MNU_ID#
			   
		]]>
		<isNotNull prepend="," property="MSG_NM">
			MSG_NM = #MSG_NM#
		</isNotNull>
		WHERE 1=1
		  AND MSG_CD = #MSG_CD#
		  AND TSK_CAT_CD = #TSK_CAT_CD#
		  AND FUNC_CAT_CD =#FUNC_CAT_CD#

	</update>

	<!--메시지 delete -->
	<update id="dcmacm001EMessagedelete" parameterClass="paramMap">
		DELETE FROM TBDCMACM012C
		WHERE 1=1
		AND MSG_CD = #MSG_CD#
	</update>

	<!-- 로그조회 -->
	<select id="dcmacm001QLogselect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT *
			FROM TBDCMACM014H
			WHERE 1=1
			 AND RQS_DH BETWEEN #strRqsDhFrom#||'000000' AND #strRqsDhTo#||'235959'
						
        ]]>
		<isNotEmpty prepend="AND" property="strMnuId">
			MNU_ID LIKE
			'%'||#strMnuId# ||'%'
		</isNotEmpty>	
		 <![CDATA[    
		 ORDER BY RQS_DH
		 ]]>
	</select>

	<!-- 사이트코드관리 -->
	<select id="dcmacm026SiteCodeMgtSelect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT *
			FROM TBDCMACM016M
			WHERE 1=1
        ]]>
		<isNotEmpty prepend="AND" property="strSitNm">
			SIT_NM LIKE '%'||#strSitNm# ||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strUseYn">
			USE_YN LIKE '%'||#strUseYn# ||'%'
		</isNotEmpty>
		 <![CDATA[    
		 ORDER BY SIT_CD
		 ]]>
	</select>

	<!-- 접속아이피 통제 -->
	<select id="dcmacm026CtrlIpSelect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT CTRL_NO /*통제번호*/
			     , SIT_CD    /*사이트코드*/
			     , STR_IP_AD /*시작ip*/ 
			     , END_IP_AD /*종료 ip*/
			     , CNCT_PMS_STR_DH
			     , CNCT_PMS_END_DH
			     , SUBSTR(TO_CHAR(CNCT_PMS_STR_DH,'yyyymmddhh24miss'),9,14) AS CNCT_PMS_STR_HH /*시작일*/
                 , SUBSTR(TO_CHAR(CNCT_PMS_END_DH,'yyyymmddhh24miss'),9,14)AS CNCT_PMS_END_HH  /*종료일*/
			FROM TBDCMACM027L
			WHERE 1=1
			  AND SIT_CD = #strSitCd# 
        ]]>
	</select>

	<!-- 접속아이피 통제 -->
	<select id="dcmacm026CtrlIpMaxSelect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT NVL(MAX(CTRL_NO),0)+1 AS CTRL_NO /*통제번호*/		
			FROM TBDCMACM027L
			WHERE 1=1
			  AND SIT_CD = #SIT_CD# 
        ]]>
	</select>

	<!-- 접속아이피 통제 -->
	<select id="dcmacm026CtrlIpCnt" parameterClass="paramMap" resultClass="java.lang.String">
        <![CDATA[       
			SELECT COUNT(*) AS CNT 		
			FROM TBDCMACM027L
			WHERE 1=1
			  AND SIT_CD = #SIT_CD# 
        ]]>
	</select>
	
	<!-- 사이트코드 신규 -->
	<insert id="dcmacm026SiteCodeMgtInsert" parameterClass="paramMap">
		INSERT INTO TBDCMACM016M
		(
			SIT_CD
			, SIT_NM
			, URL_AD
			, SIT_DES
			, USE_YN
			, CTRL_YN
			,
			FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			,
			FNL_MDF_DH
		) VALUES
		(
			#SIT_CD#
			, #SIT_NM#
			, #URL_AD#
			, #SIT_DES#
			, #USE_YN#
			,
			#CTRL_YN#
			, #FRT_USR_ID#
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
			, SYSDATE
			, SYSDATE
		)
	</insert>
	
	<!-- 접속IP통제 신규 -->
	<insert id="dcmacm026CtrlIpInsert" parameterClass="paramMap">
		INSERT INTO TBDCMACM027L
		(
			CTRL_NO
			, SIT_CD
			, STR_IP_AD
			, END_IP_AD
			, CNCT_PMS_STR_DH
			,
			CNCT_PMS_END_DH
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			,
			FRT_REGI_DH
			,
			FNL_MDF_DH
		) VALUES
		(
			#CTRL_NO#
			, #SIT_CD#
			, #STR_IP_AD#
			,
			#END_IP_AD#
			,
			TO_DATE(#CNCT_PMS_STR_DH#||#CNCT_PMS_STR_HH#,'YYYYMMDDHH24:MI:SS')
			,
			TO_DATE(#CNCT_PMS_END_DH#||#CNCT_PMS_END_HH#,'YYYYMMDDHH24:MI:SS')
			,
			#FRT_USR_ID#
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
			, SYSDATE
			,
			SYSDATE
		)
	</insert>

	<!--사이트코드 update -->
	<update id="dcmacm026SiteCodeMgtUpdate" parameterClass="paramMap">
		<![CDATA[ 	
			UPDATE TBDCMACM016M
			   SET SIT_CD  = #SIT_CD# 
				  , FNL_MDF_DH = SYSDATE
			      , FNL_USR_ID = #FNL_USR_ID#
	              , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			      , FNL_MNU_ID = #FNL_MNU_ID#			   
		]]>
				<isNotNull prepend="," property="SIT_NM">
					SIT_NM = #SIT_NM#
				</isNotNull>
				<isNotNull prepend="," property="URL_AD">
					URL_AD = #URL_AD#
				</isNotNull>
				<isNotNull prepend="," property="SIT_DES">
					SIT_DES = #SIT_DES#
				</isNotNull>
				<isNotNull prepend="," property="USE_YN">
					USE_YN = #USE_YN#
				</isNotNull>
				<isNotNull prepend="," property="CTRL_YN">
					CTRL_YN = #CTRL_YN#
				</isNotNull>
		WHERE 1=1
		AND SIT_CD = #SIT_CD#
	</update>

	<!--접속ip 통제 update -->
	<update id="dcmacm026CtrlIpUpdate" parameterClass="paramMap">
		<![CDATA[ 	
			UPDATE TBDCMACM027L
			   SET CTRL_NO     = #CTRL_NO# 
				  , SIT_CD     = #SIT_CD#
				  , FNL_MDF_DH = SYSDATE
			      , FNL_USR_ID = #FNL_USR_ID#
	              , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			      , FNL_MNU_ID = #FNL_MNU_ID#			   
		]]>
			<isNotNull prepend="," property="STR_IP_AD">
				STR_IP_AD = #STR_IP_AD#
			</isNotNull>
			<isNotNull prepend="," property="END_IP_AD">
				END_IP_AD = #END_IP_AD#
			</isNotNull>
			<isNotNull prepend="," property="CNCT_PMS_STR_DH">
				CNCT_PMS_STR_DH =
				TO_DATE(SUBSTR(#CNCT_PMS_STR_DH#,0,8)||#CNCT_PMS_STR_HH#,'YYYYMMDDHH24:MI:SS')
			</isNotNull>
			<isNotNull prepend="," property="CNCT_PMS_END_DH">
				CNCT_PMS_END_DH =
				TO_DATE(SUBSTR(#CNCT_PMS_END_DH#,0,8)||#CNCT_PMS_END_HH#,'YYYYMMDDHH24:MI:SS')
			</isNotNull>
		WHERE 1=1
		AND SIT_CD = #SIT_CD#
		AND CTRL_NO = #CTRL_NO#
	</update>

	<!--사이트코드 delete -->
	<update id="dcmacm026SiteCodeMgtDelete" parameterClass="paramMap">
		DELETE FROM TBDCMACM016M
		WHERE 1=1
		AND SIT_CD = #SIT_CD#
	</update>

	<!--접속IP통제 delete -->
	<update id="dcmacm026CtrlYnDelete" parameterClass="paramMap">
		DELETE FROM TBDCMACM027L
		WHERE 1=1
		AND SIT_CD = #SIT_CD#
	</update>
	
	<!--접속IP통제 delete -->
	<update id="dcmacm026CtrlIpDelete" parameterClass="paramMap">
		DELETE FROM TBDCMACM027L
		WHERE 1=1
		AND SIT_CD = #SIT_CD#
		AND CTRL_NO = #CTRL_NO#
	</update>

	<!--프로그램관리 조회 -->
	<select id="dcmacm027PgmMgtSelect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT *
			FROM TBDCMACM017M
			WHERE 1=1						
        ]]>
		<isNotEmpty prepend="AND" property="strPgmId">
			PGM_ID LIKE '%'|| #strPgmId# ||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strTskCatCd">
			TSK_CAT_CD LIKE '%'||#strTskCatCd#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strFuncCatCd">
			FUNC_CAT_CD LIKE '%'||#strFuncCatCd#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strPgmNm">
			PGM_NM LIKE '%'||#strPgmNm# ||'%'
		</isNotEmpty>	
		 <![CDATA[    
		 ORDER BY PGM_NM
		 ]]>
	</select>
	
	<!--프로그램관리 추가 -->
	<insert id="dcmacm027PgmMgtInsert" parameterClass="paramMap">
		INSERT INTO	TBDCMACM017M
		(
		PGM_ID
		, SIT_CD
		, TSK_CAT_CD
		, FUNC_CAT_CD
		, PGM_NM
		,
		PGM_ENG_NM
		, PGM_DVSN
		, USE_YN
		, URL
		, PGM_DES
		, FRT_USR_ID
		, FRT_REGI_DH
		)
		VALUES
		(
		#PGM_ID#
		, #SIT_CD#
		, #TSK_CAT_CD#
		, #FUNC_CAT_CD#
		, #PGM_NM#
		,
		#PGM_ENG_NM#
		,
		#PGM_DVSN#
		, #USE_YN#
		, #URL#
		, #PGM_DES#
		, #FRT_USR_ID#
		,
		SYSDATE
		)
	</insert>

	<!--프로그램관리 수정 -->

	<update id="dcmacm027PgmMgtUpdate" parameterClass="paramMap">
		<![CDATA[ 	
			UPDATE TBDCMACM017M
			   SET SIT_CD               = #SIT_CD# 
			     , PGM_ID 				= #PGM_ID#
			   	 , TSK_CAT_CD = #TSK_CAT_CD#
			   	 , FUNC_CAT_CD = #FUNC_CAT_CD#
			   	 , FNL_MDF_DH = SYSDATE
		]]>

		<isNotNull prepend="," property="PGM_NM">
			PGM_NM = #PGM_NM#
		</isNotNull>
		<isNotNull prepend="," property="PGM_ENG_NM">
			PGM_ENG_NM = #PGM_ENG_NM#
		</isNotNull>
		<isNotNull prepend="," property="PGM_DVSN">
			PGM_DVSN = #PGM_DVSN#
		</isNotNull>
		<isNotNull prepend="," property="USE_YN">
			USE_YN = #USE_YN#
		</isNotNull>
		<isNotNull prepend="," property="URL">
			URL = #URL#
		</isNotNull>
		<isNotNull prepend="," property="PGM_DES">
			PGM_DES = #PGM_DES#
		</isNotNull>
		<isNotNull prepend="," property="FNL_DEAL_DPT_CD">
			FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
		</isNotNull>
		<isNotNull prepend="," property="FNL_MNU_ID">
			FNL_MNU_ID = #FNL_MNU_ID#
		</isNotNull>
		WHERE 1=1
		AND SIT_CD = #SIT_CD#
		AND PGM_ID = #PGM_ID#
	</update>
	
	<!--프로그램관리 삭제 -->
	<update id="dcmacm027PgmMgtDelete" parameterClass="paramMap">
		DELETE FROM TBDCMACM017M
		WHERE 1=1
		AND SIT_CD = #SIT_CD#
		AND PGM_ID = #PGM_ID#
	</update>


	<!--부서코드 조회 -->
	<select id="dcmacm024DeptCodeSelect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT DISTINCT DPT_CD /*부서코드*/
			     , DPT_NM /*부서명*/
			     , TNB /*전화번호*/
			     , USE_YN /*사용여부*/
			     , ABR_DPT_NM_1 /*약명1*/
			     , ABR_DPT_NM_2 /*약명2*/
			     , FRML_DPT_NM /*공식부서명*/
			     , STND_DPT_CD /*표준부서명*/
			     , FAN         /*팩스번호*/
			     , OW_DVDT_TXT /*사무분장내용*/
			     , DPT_TP_CD /*부서타입코드*/
			     , IMD_CD    /*직속코드*/
			     , DPT_SNO /*부서순번*/
			     , ZCD
			     , AD
			     /*, DTL_AD 2016.06.30*/			     
			     , HMP_AD			     
			     /*, SAL_DPT_CD 급여부서 2016.06.30
			     /*, SAL_DPT_NM 급여부서명 2016.06.30
			     /*, BK_DPT_NM 이전부서명 20160630*/
			     , HIRK_DPT_CD /*상위부서코드*/
			     , F_DPT_INFO(HIRK_DPT_CD,'1') AS HIRK_DPT_NM/*상위부서명*/			     
			     , SRT_SNO /*정렬순번*/			     
			     , ORZT_DVSN_CD /*조직구분코드*/         
			     , ASBM_RCPT_TG_YN /* 의원면직수신대상여부 추가 - 2016.07.21 yyh */ 
			     , DPT_TP_CD_2
			     , LOC_DVSN_CD 
			     , HOMP_OPN
			     , HOMP_SEC    
			     , HOMP_DVDT_CD /* 부서장 직위약칭 추가 - 2018.10.02 EUNOK */ 
			     , HOMP_DVDT_NM /* 부서장 직위약칭 추가 - 2018.10.02 EUNOK */ 
			     , HOMP_OW_DVDT_TXT /* 홈페이지사무분장내용 추가 - 2019.08.28 yyh */
				FROM TBDCMACM002M A
		     WHERE 1=1			
        ]]>

		<isNotEmpty prepend="AND" property="strDptCd">
			DPT_CD LIKE
			'%'||#strDptCd# ||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strDptNm">
			(DPT_NM LIKE
			'%'||#strDptNm# ||'%'OR ABR_DPT_NM_1 LIKE '%'||#strDptNm# ||'%' OR
			ABR_DPT_NM_2 LIKE '%'||#strDptNm# ||'%' OR FRML_DPT_NM LIKE '%'||#strDptNm#||'%' )
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strUseYn">
			USE_YN LIKE
			'%'||#strUseYn# ||'%'
		</isNotEmpty>		
	    <isNotEmpty property="strTreeUseYn">
			  START WITH USE_YN = #strTreeUseYn#
             CONNECT BY PRIOR HIRK_DPT_CD = DPT_CD 
		</isNotEmpty>
        
		 <![CDATA[    
		ORDER BY DPT_SNO, DPT_CD
		 ]]>
	</select>
	<!-- 하위부서 체크 -->

	<select id="dcmacm024DeptChildSelect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT COUNT(DPT_CD) AS CNT
			  FROM TBDCMACM002M
		     WHERE 1=1
			   AND HIRK_DPT_CD = #DPT_CD#	
		 ]]>
	</select>
	<!-- 사용자관리부서내역 부서 체크 -->
	<select id="dcmacm003UsrDptCnt" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT COUNT(DPT_CD) AS CNT
			  FROM TBDCMACM003L
		     WHERE 1=1
			   AND DPT_CD = #DPT_CD#		
		 ]]>
	</select>
	
	<!--부서코드 등록 -->
	<insert id="dcmacm024DeptCodeInsert" parameterClass="paramMap">
		DECLARE
			BEGIN
				INSERT
				INTO
				TBDCMACM002M
				(
				  DPT_CD
				, DPT_NM
				, TNB
				, USE_YN
				, ABR_DPT_NM_1
				, ABR_DPT_NM_2
				, FRML_DPT_NM
				, STND_DPT_CD
				, FAN
				, OW_DVDT_TXT
				, FRT_USR_ID
				, HIRK_DPT_CD
				, FRT_REGI_DH
				, SRT_SNO
				, ORZT_DVSN_CD
				, DPT_TP_CD
				, IMD_CD
				, ASBM_RCPT_TG_YN /* 의원면직수신대상여부 추가 - 2016.07.21 yyh */
				, HOMP_OPN /* 홈페이지 부서공개 여부 추가 - 2018.10.04 EUNOK */
				, HOMP_SEC /* 홈페이지연락처공개여부 - 2018.10.04 EUNOK */
				, HOMP_DVDT_CD /* 홈페이지용직위약칭 코드- 2018.10.04 EUNOK */
				, HOMP_DVDT_NM /* 홈페이지용직위약칭명- 2018.10.04 EUNOK */
				, HOMP_OW_DVDT_TXT /* 홈페이지사무분장내용 추가 - 2019.08.28 yyh */
				, FNL_MNU_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MDF_DH
				,DPT_TP_CD_2
				,LOC_DVSN_CD
				) VALUES
				(
				  #DPT_CD#
				, #DPT_NM#
				, #TNB#
				, #USE_YN#
				, #ABR_DPT_NM_1#
				, #ABR_DPT_NM_2#
				, #FRML_DPT_NM#
				, #STND_DPT_CD#
				, #FAN#
				, #OW_DVDT_TXT#
				, #FRT_USR_ID#
				, #HIRK_DPT_CD#
				, SYSDATE
				, #SRT_SNO#
				, #ORZT_DVSN_CD#
				, #DPT_TP_CD#
				, #IMD_CD#
				, #ASBM_RCPT_TG_YN#
				, #HOMP_OPN#
				, #HOMP_SEC#
				, #HOMP_DVDT_CD#
				, #HOMP_DVDT_NM#
				, #HOMP_OW_DVDT_TXT#
				, #FNL_MNU_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, SYSDATE
				,#DPT_TP_CD_2#
				,#LOC_DVSN_CD#
				);
				
			
				
				INSERT
				INTO
				TBDCMACM031H
				(
				  DPT_CD
				, CON_NO 
				, CON_HNDL_DVSN_CD
				, USE_YN
				
				, FRT_USR_ID		
				, FRT_REGI_DH
				, FNL_MNU_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MDF_DH
				) VALUES
				(
				  #DPT_CD#
				, (	SELECT NVL(MAX(CON_NO),0)+1  AS CON_NO
					  FROM TBDCMACM031H
			       ) 
			    , 'C'
				, 'N'
				
				, #FRT_USR_ID#			
				, SYSDATE
				, #FNL_MNU_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, SYSDATE
				);
		 END;	

	</insert>
	
	<!--부서코드 수정 -->
	<update id="dcmacm024DeptCodeUpdate" parameterClass="paramMap">
		<![CDATA[ 	
		DECLARE
			BEGIN
			UPDATE TBDCMACM002M
			   SET DPT_CD               = #DPT_CD# 
			     , DPT_NM 				= #DPT_NM#
			     , USE_YN               = #USE_YN#
			     , FNL_MDF_DH = SYSDATE
				 , FNL_USR_ID = #FNL_USR_ID#
                 , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				 , FNL_MNU_ID = #FNL_MNU_ID#
		]]>
		<isNotNull prepend="," property="TNB">
			TNB = #TNB#
		</isNotNull>
		<isNotNull prepend="," property="ABR_DPT_NM_1">
			ABR_DPT_NM_1 =
			#ABR_DPT_NM_1#
		</isNotNull>
		<isNotNull prepend="," property="ABR_DPT_NM_2">
			ABR_DPT_NM_2 =
			#ABR_DPT_NM_2#
		</isNotNull>
		<isNotNull prepend="," property="FRML_DPT_NM">
			FRML_DPT_NM = #FRML_DPT_NM#
		</isNotNull>
		<isNotNull prepend="," property="STND_DPT_CD">
			STND_DPT_CD = #STND_DPT_CD#
		</isNotNull>
		<isNotNull prepend="," property="FAN">
			FAN = #FAN#
		</isNotNull>
		<isNotNull prepend="," property="OW_DVDT_TXT">
			OW_DVDT_TXT = #OW_DVDT_TXT#
		</isNotNull>
		<isNotNull prepend="," property="HIRK_DPT_CD">
			HIRK_DPT_CD = #HIRK_DPT_CD#
		</isNotNull>
		<isNotNull prepend="," property="SRT_SNO">
			SRT_SNO = #SRT_SNO#
		</isNotNull>
		<isNotNull prepend="," property="ORZT_DVSN_CD">
			ORZT_DVSN_CD =	#ORZT_DVSN_CD#
		</isNotNull>
		<isNotNull prepend="," property="DPT_TP_CD">
			DPT_TP_CD =	#DPT_TP_CD#
		</isNotNull>
		<isNotNull prepend="," property="IMD_CD">
			IMD_CD =	#IMD_CD#
		</isNotNull>
		<isNotNull prepend="," property="DPT_TP_CD_2">
			DPT_TP_CD_2 =	#DPT_TP_CD_2#
		</isNotNull>
		<isNotNull prepend="," property="LOC_DVSN_CD">
			LOC_DVSN_CD =	#LOC_DVSN_CD#
		</isNotNull>
		
		/* 의원면직수신대상여부 추가 - 2016.07.21 yyh */
		<isNotNull prepend="," property="ASBM_RCPT_TG_YN">
			ASBM_RCPT_TG_YN =	#ASBM_RCPT_TG_YN#
		</isNotNull>		
		
		/* 홈페이지 부서공개 여부 추가 - 2018.10.04 EUNOK */
		<isNotNull prepend="," property="HOMP_OPN">
			HOMP_OPN =	#HOMP_OPN#
		</isNotNull>	
		/* 홈페이지 연락처공개 여부 추가 - 2018.10.04 EUNOK */
		<isNotNull prepend="," property="HOMP_SEC">
			HOMP_SEC =	#HOMP_SEC#
		</isNotNull>
		/* 홈페이지 직위약칭코드 추가 - 2018.10.04 EUNOK */
		<isNotNull prepend="," property="HOMP_DVDT_CD">
			HOMP_DVDT_CD =	#HOMP_DVDT_CD#
		</isNotNull>
			/* 홈페이지 직위약칭명 추가 - 2018.10.04 EUNOK */
		<isNotNull prepend="," property="HOMP_DVDT_NM">
			HOMP_DVDT_NM =	#HOMP_DVDT_NM#
		</isNotNull>
		
		/* 홈페이지사무분장내용 추가 - 2019.08.28 yyh */
		<isNotNull prepend="," property="HOMP_OW_DVDT_TXT">
			HOMP_OW_DVDT_TXT =	#HOMP_OW_DVDT_TXT#
		</isNotNull>
				
		<![CDATA[ 	
		WHERE 1=1
		AND DPT_CD = #DPT_CD#
		
		;
			INSERT
				INTO
				TBDCMACM030H
				(
				  CON_NO 				/* 연계번호 */
				, CON_USE_YN 
				, DPT_CD 				/* 부서코드 */
				, DPT_NM 				/* 부서명 */
				, TNB 					/* 전화번호 */
				, USE_YN 				/* 사용여부 */
				, ABR_DPT_NM_1			/* 약칭부서명1 */
				, ABR_DPT_NM_2 			/* 약칭부서명2 */
				, FRML_DPT_NM 			/* 공식부서명 */
				, STND_DPT_CD		 	/* 표준부서코드 */
				, FAN 					/* 팩스번호 */
				, IMD_CD 				/* 직속코드 */
				, DPT_TP_CD 			/* 부서타입코드 */
				, DPT_SNO 				/* 부서순번 */
				, ZCD 					/* 우편번호 */
				, AD 					/* 주소 */
				, DTL_AD 				/* 상세주소 */
				, HMP_AD 				/* 홈페이지주소 */
				, SAL_DPT_CD 			/* 급여부서코드 */
				, SAL_DPT_NM 			/* 급여부서명 */
				, BK_DPT_NM 			/* 이전부서명 */
				, OW_DVDT_TXT			/* 사무분장내용 */
				, HIRK_DPT_CD 			/* 상위부서코드 */
				, ORZT_DVSN_CD 			/* 조직구분코드 */
				, SRT_SNO 				/* 정렬순번 */
				, DEP_RGN_CD 			/* 출발지역코드 */
				, ENFM_WHLS_CHGR_CNB 	/* 집행전말담당자전산번호 */
				, HOMP_OPN				/* 홈페이지공개여부 */
				, HOMP_SEC				/* 홈페이지연락처공개여부 */
				, HOMP_DVDT_NM	        /* 홈페이지용직위약칭 */
				, HOMP_OW_DVDT_TXT      /* 홈페이지사무분장내용 추가 - 2019.08.28 yyh */
				, FRT_USR_ID
				, FRT_REGI_DH
				, FNL_MNU_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MDF_DH
				) SELECT ( (SELECT NVL(MAX(CON_NO),0)+1 FROM TBDCMACM030H)) AS CON_NO /* 연계번호 */
				        , 'N' AS CON_USE_YN
						, DPT_CD
						, DPT_NM
						, TNB
						, USE_YN
						, ABR_DPT_NM_1
						, ABR_DPT_NM_2
						, FRML_DPT_NM
						, STND_DPT_CD
						, FAN
						, IMD_CD
						, DPT_TP_CD
						, DPT_SNO
						, ZCD
						, AD
						, '' DTL_AD
						, HMP_AD
						, '' SAL_DPT_CD
						, '' SAL_DPT_NM
						, '' BK_DPT_NM
						, OW_DVDT_TXT
						, HIRK_DPT_CD
						, ORZT_DVSN_CD
						, SRT_SNO
						, '' DEP_RGN_CD
						, ENFM_WHLS_CHGR_CNB
						, HOMP_OPN
						, HOMP_SEC
						, HOMP_DVDT_NM
						, HOMP_OW_DVDT_TXT
						, #FNL_USR_ID# AS FRT_USR_ID
		                , SYSDATE AS FRT_REGI_DH
						, #FNL_MNU_ID# AS FNL_MNU_ID
						, #FNL_USR_ID# AS FNL_USR_ID
						, #FNL_DEAL_DPT_CD# AS FNL_DEAL_DPT_CD
						, SYSDATE AS FNL_MDF_DH
				    FROM TBDCMACM002M
				   WHERE DPT_CD=#DPT_CD#
				   ;
				 END;
				 ]]>
	</update>
	
	
	<!--부서코드 삭제 -->
	<update id="dcmacm024DeptCodeDelete" parameterClass="paramMap">
	DECLARE
		BEGIN
			DELETE
			FROM
			TBDCMACM002M
			WHERE 1=1
			AND DPT_CD = #DPT_CD#;
			
			
				INSERT
					INTO
					TBDCMACM031H
					(
					  DPT_CD
					, CON_NO 
					, CON_HNDL_DVSN_CD
					, USE_YN
					
					, FRT_USR_ID		
					, FRT_REGI_DH
					, FNL_MNU_ID
					, FNL_USR_ID
					, FNL_DEAL_DPT_CD
					, FNL_MDF_DH
					) VALUES
					(
					  #DPT_CD#
					, (	SELECT NVL(MAX(CON_NO),0)+1  AS CON_NO
						  FROM TBDCMACM031H
				       ) 
				    , 'D'
					, 'N'
					
					, #FRT_USR_ID#			
					, SYSDATE
					, #FNL_MNU_ID#
					, #FNL_USR_ID#
					, #FNL_DEAL_DPT_CD#
					, SYSDATE
					);
			END;

	</update>

	<!-- 부서 국 리스트 조회 -->
	<select id="dcmacm024DeptBureauSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[       
          SELECT DPT_CD, DPT_NM,HIRK_DPT_CD
            FROM TBDCMACM002M
           WHERE 1=1
         
             ]]>
        <isNotEmpty prepend="AND" property="strDptAuth"> 
              DPT_CD IN ( SELECT SUBSTR(DPT_CD,'1','3')||'000' FROM TABLE(F_AUTH_DEPT(#strCnb#, #strDptAuth#, 'Y')))
        </isNotEmpty>
            AND DPT_CD  LIKE '%000'
            AND USE_YN = 'Y'
           ORDER BY DPT_SNO, DPT_CD 
        
	</select>
	<!-- 부서 과 리스트 조회 -->
	<select id="dcmacm024DeptSectSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[       
           SELECT DPT_CD, DPT_NM, HIRK_DPT_CD
             FROM TBDCMACM002M
            WHERE 1=1

                 ]]>
             <isNotEmpty prepend="AND" property="strDptAuth"> 
              DPT_CD IN ( SELECT DPT_CD FROM TABLE(F_AUTH_DEPT(#strCnb#, #strDptAuth#, 'Y')))
             </isNotEmpty>
             
			<isNotEmpty property="strHrkDptCd">
	        	<isEmpty property="strDptCd">
				AND SUBSTR(DPT_CD, 0, 3) = SUBSTR(#strHrkDptCd#, 0, 3)        	
	        	</isEmpty>
	        	<isNotEmpty property="strDptCd">
	        	OR SUBSTR(DPT_CD, 0, 3) = SUBSTR(#strHrkDptCd#, 0, 3)
	        	</isNotEmpty>
			</isNotEmpty>
			
			  AND DPT_CD NOT LIKE '%000'
              AND USE_YN = 'Y'
           ORDER BY DPT_SNO, DPT_CD 	
      
	</select>

	<!--부서코드팝업 조회 -->
	<select id="dcmacm024DeptPopSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[       
			SELECT DPT_CD  
			     , DPT_NM
			     , TNB
			     , USE_YN
			     , ABR_DPT_NM_1
			     , ABR_DPT_NM_2
			     , FRML_DPT_NM
			     , STND_DPT_CD
			     , FAN
			     , OW_DVDT_TXT
			     , DPT_TP_CD
			     , IMD_CD
			     , DPT_SNO
			     , ZCD
			     , AD
			     /*, DTL_AD 2016.06.30*/
			     
			     , HMP_AD
			     
			     /* , SAL_DPT_CD 2016.06.30
			     /*, SAL_DPT_NM 2016.06.30
			     /*, BK_DPT_NM 20160630*/
			     , HIRK_DPT_CD
			     
		      FROM TBDCMACM002M
		     WHERE 1=1
						
        ]]>
        <isNotEmpty property="strUsrDptAuth">
			AND DPT_CD IN ( SELECT DPT_CD FROM TABLE(F_AUTH_DEPT(#strUsrCnb#, #strUsrDptAuth#, 'Y')))
		</isNotEmpty>
        
		<isNotEmpty prepend="AND" property="strDptCd">
			DPT_CD LIKE
			'%'||#strDptCd# ||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strDptNm">
			(DPT_NM LIKE
			'%'||#strDptNm# ||'%'
			OR ABR_DPT_NM_1 LIKE '%'||#strDptNm# ||'%'
			OR
			ABR_DPT_NM_2 LIKE '%'||#strDptNm# ||'%'
			OR DPT_CD LIKE '%'||#strDptNm#||'%'
			OR FRML_DPT_NM LIKE '%'||#strDptNm#||'%')
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strUseYn">
			USE_YN LIKE
			'%'||#strUseYn# ||'%'
		</isNotEmpty>
 	
        ORDER BY DPT_SNO, DPT_CD 

	</select>


	<select id="dcmacm008CmmMaxSelect" parameterClass="paramMap"
		resultClass="java.lang.String">
	
	    SELECT  NVL(MAX(CMM_CD_DVSN_CD)+1,'1000001') AS CMM_CD_DVSN_CD
         FROM TBDCMACM013C
        WHERE 1=1
          AND CD ='000000000'
	
	</select>	
	<!-- 공통코드 메인 조회 -->
	<select id="dcmacm008CmmSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
       SELECT TSK_CAT_CD /*업무분류*/
            , FUNC_CAT_CD||TSK_CAT_CD AS FUNC_CAT_CD /*기능분류*/
            , CMM_CD_DVSN_CD /*코드구분*/
            , CD /*코드*/
            , CD_NM /*코드명*/
            , USE_YN
            , PRD_USE_YN
            , STR_DT
            , END_DT
            , OTPT_SEQ
            , USR_DFN_TXT_1
            , USR_DFN_TXT_2
            , USR_DFN_TXT_3
            , USR_DFN_TXT_4
            , USR_DFN_TXT_5
            , USR_DFN_TXT_6
            , USR_DFN_TXT_7
            , USR_DFN_TXT_8
            , USR_DFN_TXT_9
            , USR_DFN_TXT_10
            , BK_CD_DVSN_NM
            , BK_CD_NM
         FROM TBDCMACM013C
        WHERE 1=1
          AND CD ='000000000'
        ]]>
		<isNotEmpty property="strTskCatCd">
			AND TSK_CAT_CD LIKE #strTskCatCd#||'%'
		</isNotEmpty>
		<isNotEmpty property="strFuncCatCd">
			AND FUNC_CAT_CD LIKE #strFuncCatCd# ||'%'
		</isNotEmpty>
		<isNotEmpty property="strCdDivNm">
			AND CD_NM LIKE '%'||#strCdDivNm#||'%'
		</isNotEmpty>
		<isNotEmpty property="strUseYn">
			AND USE_YN = #strUseYn#
		</isNotEmpty>
		<isNotEmpty property="strDtlCdDivNm">
			AND CMM_CD_DVSN_CD IN (
           		 SELECT CMM_CD_DVSN_CD FROM TBDCMACM013C WHERE CD_NM LIKE '%' || #strDtlCdDivNm# || '%' AND CD !='000000000'  GROUP BY CMM_CD_DVSN_CD
          	)
		</isNotEmpty>
		<isEqual property="strOrderBy" compareValue="1">
				ORDER BY CD_NM
		</isEqual>	

	</select>
	<!--공통코드 sub 조회 -->
	<select id="dcmacm008CmmDetailSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
       SELECT TSK_CAT_CD
            , FUNC_CAT_CD||TSK_CAT_CD AS FUNC_CAT_CD
            , CMM_CD_DVSN_CD
            , CD
            , CD_NM
            , USE_YN
            , PRD_USE_YN
            , STR_DT
            , END_DT
            , OTPT_SEQ
            , USR_DFN_TXT_1
            , USR_DFN_TXT_2
            , USR_DFN_TXT_3
            , USR_DFN_TXT_4
            , USR_DFN_TXT_5
            , USR_DFN_TXT_6
            , USR_DFN_TXT_7
            , USR_DFN_TXT_8
            , USR_DFN_TXT_9
            , USR_DFN_TXT_10
            , BK_CD_DVSN_NM
            , BK_CD_NM
         FROM TBDCMACM013C
        WHERE 1=1
          AND CD <>'000000000'
		  AND CMM_CD_DVSN_CD = #strCdDvsn#

	         ]]>

	</select>

	<select id="dcmacm008CmmDetailCntSelect" parameterClass="paramMap" resultClass="resultMap">
		SELECT COUNT(*) AS CNT
		FROM TBDCMACM013C
		WHERE 1=1
		AND CD <![CDATA[ <> ]]>
		'000000000'
		AND CMM_CD_DVSN_CD = #CMM_CD_DVSN_CD#
	</select>
	
	<!-- 공통코드 delete -->
	<update id="dcmacm008CmmDelete" parameterClass="paramMap">
	DECLARE
		BEGIN
			DELETE
			TBDCMACM013C
			WHERE 1 = 1
			AND CMM_CD_DVSN_CD = #CMM_CD_DVSN_CD#
			AND CD =#CD#;
			
		
			INSERT
			INTO
			TBDCMACM033H
			(
			  CMM_CD_DVSN_CD
			, CD 
			, CON_NO 
			, CON_HNDL_DVSN_CD
			, USE_YN
			
			, FRT_USR_ID		
			, FRT_REGI_DH
			, FNL_MNU_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MDF_DH
			) VALUES
			(
			  #CMM_CD_DVSN_CD#
			, #CD#
			, (	SELECT NVL(MAX(CON_NO),0)+1  AS CON_NO
				  FROM TBDCMACM033H
			   ) 
			, 'D'
			, 'N'
			
			, #FRT_USR_ID#			
			, SYSDATE
			, #FNL_MNU_ID#
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, SYSDATE
			);
		END;		
	</update>
	<!-- 공통코드 insert -->
	<insert id="dcmacm008CmmInsert" parameterClass="paramMap">
	DECLARE
		BEGIN
			INSERT INTO
			TBDCMACM013C
			(
			  CMM_CD_DVSN_CD
			, CD
			, TSK_CAT_CD
			, FUNC_CAT_CD
			, CD_NM
			, USE_YN
			, PRD_USE_YN
			, STR_DT
			, END_DT
			, OTPT_SEQ
			, USR_DFN_TXT_1
			, USR_DFN_TXT_2
			, USR_DFN_TXT_3
			, USR_DFN_TXT_4
			, USR_DFN_TXT_5
			, BK_CD_DVSN_NM
			, BK_CD_NM
			
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			, FNL_MDF_DH
			, USR_DFN_TXT_6
            , USR_DFN_TXT_7
            , USR_DFN_TXT_8
            , USR_DFN_TXT_9
            , USR_DFN_TXT_10
			)
			VALUES
			(
			  #CMM_CD_DVSN_CD#
			, #CD#
			, #TSK_CAT_CD#
			, #FUNC_CAT_CD#
			, #CD_NM#
			, #USE_YN#
			, #PRD_USE_YN#
			, #STR_DT#
			, #END_DT#
			, TO_NUMBER(NVL(#OTPT_SEQ#,NULL))
			, #USR_DFN_TXT_1#
			, #USR_DFN_TXT_2#
			, #USR_DFN_TXT_3#
			, #USR_DFN_TXT_4#
			, #USR_DFN_TXT_5#
			, #BK_CD_DVSN_NM#
			, #BK_CD_NM#
			, #FRT_USR_ID#
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
			, SYSDATE
			, SYSDATE
			, #USR_DFN_TXT_6#
            , #USR_DFN_TXT_7#
            , #USR_DFN_TXT_8#
            , #USR_DFN_TXT_9#
            , #USR_DFN_TXT_10#
			);
			
				INSERT
				INTO
				TBDCMACM033H
				(
				  CMM_CD_DVSN_CD
				, CD 
				, CON_NO 
				, CON_HNDL_DVSN_CD
				, USE_YN
				
				, FRT_USR_ID		
				, FRT_REGI_DH
				, FNL_MNU_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MDF_DH
				) VALUES
				(
				  #CMM_CD_DVSN_CD#
				, #CD#
				, (	SELECT NVL(MAX(CON_NO),0)+1  AS CON_NO
					  FROM TBDCMACM033H
			       ) 
			    , 'C'
				, 'N'
				
				, #FRT_USR_ID#			
				, SYSDATE
				, #FNL_MNU_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, SYSDATE
				);
			END;
			 
			
			
	</insert>
	<!-- 공통코드 업데이트 -->
	<update id="dcmacm008CmmUpdate" parameterClass="paramMap">
	
	DECLARE
		BEGIN
			UPDATE TBDCMACM013C
			SET FNL_MDF_DH = SYSDATE
			, CMM_CD_DVSN_CD =
			#CMM_CD_DVSN_CD#
			, CD = #CD#
			, FNL_USR_ID = #FNL_USR_ID#
			,
			FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			, FNL_MNU_ID = #FNL_MNU_ID#
	
			<isNotNull prepend="," property="TSK_CAT_CD">
				TSK_CAT_CD = #TSK_CAT_CD#
			</isNotNull>
			<isNotNull prepend="," property="FUNC_CAT_CD">
				FUNC_CAT_CD = #FUNC_CAT_CD#
			</isNotNull>
			<isNotNull prepend="," property="CD_NM">
				CD_NM = #CD_NM#
			</isNotNull>
			<isNotNull prepend="," property="USE_YN">
				USE_YN = NVL(#USE_YN#,'N')
			</isNotNull>
			<isNotNull prepend="," property="PRD_USE_YN">
				PRD_USE_YN =
				NVL(#PRD_USE_YN#,'N')
			</isNotNull>
			<isNotNull prepend="," property="STR_DT">
				STR_DT = #STR_DT#
			</isNotNull>
			<isNotNull prepend="," property="END_DT">
				END_DT = #END_DT#
			</isNotNull>
			<isNotNull prepend="," property="OTPT_SEQ">
				OTPT_SEQ = #OTPT_SEQ#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_1">
				USR_DFN_TXT_1 =
				#USR_DFN_TXT_1#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_2">
				USR_DFN_TXT_2 =
				#USR_DFN_TXT_2#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_3">
				USR_DFN_TXT_3 =
				#USR_DFN_TXT_3#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_4">
				USR_DFN_TXT_4 =
				#USR_DFN_TXT_4#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_5">
				USR_DFN_TXT_5 =
				#USR_DFN_TXT_5#
			</isNotNull>
			<isNotNull prepend="," property="BK_CD_DVSN_NM">
				BK_CD_DVSN_NM =
				#BK_CD_DVSN_NM#
			</isNotNull>
			<isNotNull prepend="," property="BK_CD_NM">
				BK_CD_NM = #BK_CD_NM#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_6">
				USR_DFN_TXT_6 =
				#USR_DFN_TXT_6#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_7">
				USR_DFN_TXT_7 =
				#USR_DFN_TXT_7#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_8">
				USR_DFN_TXT_8 =
				#USR_DFN_TXT_8#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_9">
				USR_DFN_TXT_9 =
				#USR_DFN_TXT_9#
			</isNotNull>
			<isNotNull prepend="," property="USR_DFN_TXT_10">
				USR_DFN_TXT_10 =
				#USR_DFN_TXT_10#
			</isNotNull>
	
			WHERE 1 = 1
			AND CMM_CD_DVSN_CD = #CMM_CD_DVSN_CD#
			AND CD = #CD#;
			
			INSERT 
			INTO TBDCMACM032H
			(
			   CON_NO
			 , CON_USE_YN
			 , CMM_CD_DVSN_CD
			 , CD
			 , TSK_CAT_CD
			 , FUNC_CAT_CD
			 , CD_NM
			 , USE_YN
			 , PRD_USE_YN
			 , STR_DT
			 , END_DT
			 , OTPT_SEQ
			 , USR_DFN_TXT_1
			 , USR_DFN_TXT_2
			 , USR_DFN_TXT_3
			 , USR_DFN_TXT_4
			 , USR_DFN_TXT_5
			 , BK_CD_DVSN_NM
			 , BK_CD_NM

			 
			 , FRT_USR_ID
			 , FNL_USR_ID
			 , FNL_DEAL_DPT_CD
			 , FNL_MNU_ID
			 , FRT_REGI_DH
			 , FNL_MDF_DH
			 )
	    SELECT
			   ( (SELECT NVL(MAX(CON_NO),0)+1 FROM TBDCMACM032H)) AS CON_NO /* 연계번호 */
			 , 'N' AS CON_USE_YN
			 , CMM_CD_DVSN_CD
			 , CD
			 , TSK_CAT_CD
			 , FUNC_CAT_CD
			 , CD_NM
			 , USE_YN
			 , PRD_USE_YN
			 , STR_DT
			 , END_DT
			 , OTPT_SEQ
			 , USR_DFN_TXT_1
			 , USR_DFN_TXT_2
			 , USR_DFN_TXT_3
			 , USR_DFN_TXT_4
			 , USR_DFN_TXT_5
			 , BK_CD_DVSN_NM
			 , BK_CD_NM

			 
			 , #FNL_USR_ID# AS FNL_USR_ID
			 , #FNL_USR_ID# AS FNL_USR_ID
			 , #FNL_DEAL_DPT_CD# AS FNL_DEAL_DPT_CD
			 , #FNL_MNU_ID# AS FNL_MNU_ID
			 , SYSDATE AS FRT_REGI_DH
			 , SYSDATE AS FNL_MDF_DH
          FROM TBDCMACM013C 			 
	     WHERE CMM_CD_DVSN_CD = #CMM_CD_DVSN_CD#
		   AND CD = #CD#
			 ;
		END;
	</update>




	<!-- 공통코드팝업조회 -->
	<select id="COMcmncodelistpopSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[        
			SELECT CM013.CMM_CD_DVSN_CD,
		           CM013.CD,
		           CM013.TSK_CAT_CD,
		           F_CODE_NM('1000343',CM013.TSK_CAT_CD) AS TSK_CAT_NM,
		           CM013.FUNC_CAT_CD||CM013.TSK_CAT_CD AS FUNC_CAT_CD,
		           CM013.CD_NM,
		           CM013.USE_YN,
		           CM013.PRD_USE_YN,
		           CM013.STR_DT,
		           CM013.END_DT,
		           CM013.OTPT_SEQ,
		           CM013.USR_DFN_TXT_1,
		           CM013.USR_DFN_TXT_2,
		           CM013.USR_DFN_TXT_3,
		           CM013.USR_DFN_TXT_4,
		           CM013.USR_DFN_TXT_5,
		           CM013.BK_CD_DVSN_NM,
		           CM013.BK_CD_NM,
		           CM013.FRT_USR_ID,
		           CM013.FNL_USR_ID,
		           CM013.FNL_DEAL_DPT_CD,
		           CM013.FNL_MNU_ID,
		           CM013.FRT_REGI_DH,
		           CM013. FNL_MDF_DH,
				   DVSN.CD AS UP_CODE, 
		           DVSN.CD_NM AS UP_CODE_NM,
		           CM013.USR_DFN_TXT_6,
		           CM013.USR_DFN_TXT_7,
		           CM013.USR_DFN_TXT_8,
		           CM013.USR_DFN_TXT_9,
		           CM013.USR_DFN_TXT_10
			FROM	 TBDCMACM013C CM013
		        	,(SELECT CMM_CD_DVSN_CD, CD, CD_NM FROM TBDCMACM013C WHERE CD = '000000000') DVSN
		        	 
			WHERE 	1=1
			AND     CM013.CD <> '000000000'
			AND 	CM013.CMM_CD_DVSN_CD = DVSN.CMM_CD_DVSN_CD
        ]]>

		<dynamic>
			<isNotEmpty property="strCdNm">
				AND (CM013.CD_NM LIKE
				'%'||#strCdNm#
				||'%' OR CM013.CD LIKE '%'||#strCdNm# ||'%')
			</isNotEmpty>
			<isNotEmpty property="strCdDvsn">
				AND CM013.CMM_CD_DVSN_CD
				= #strCdDvsn#
			</isNotEmpty>
			<isNotEmpty property="strTskCatCd">
				AND CM013.TSK_CAT_CD =
				#strTskCatCd#
			</isNotEmpty>
			<isNotEmpty property="strFuncCatCd">
				AND CM013.FUNC_CAT_CD
				= #strFuncCatCd#
			</isNotEmpty>
		</dynamic>
  					
				   <![CDATA[       
			ORDER BY CM013.CMM_CD_DVSN_CD,
		           CM013.CD
        ]]>
	</select>

	<!-- 기관코드관리 조회 -->
	<select id="dcmacm011OrgSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<include refid = "include.pageSelct"/>
	<![CDATA[
       SELECT ORG_CD
            , ORG_NM
            , RGN_CD
			, F_CODE_NM('1000001',RGN_CD) AS RGN_NM
            , ORG_DVSN_CD
            , ORG_DGE_CD
            , COPT_SG_CD
            , COPT_SG_2_CD
            , TNB
            , ZCD
            , AD
            , DTL_AD
            , ROAD_NM_AD
            , ROAD_NM_DTL_AD
            , USE_DVSN_NO
            , ENFM_DPT_CD
            , F_DPT_INFO(ENFM_DPT_CD, '4') AS ENFM_DPT_NM
            , ORG_CAT_CD
            , SUBSTR(ZCD,1,3) 										AS ZCD1	
          	, SUBSTR(ZCD,4,3) 										AS ZCD2
          	, PUB_DVSN_CD
          	, PASA_USE_YN_CD
  			, ADMN_ORG_DVSN_CD

         FROM TBDCMACM015M
        WHERE 1=1
	         ]]>
		<isNotEmpty property="strEnfmDptCd">
			AND ENFM_DPT_CD LIKE
			   '%'||#strEnfmDptCd#||'%'
		</isNotEmpty>
		<isNotEmpty property="strOrgNm">
			AND ORG_NM LIKE '%'||#strOrgNm#||'%'
		</isNotEmpty>
		<isNotEmpty property="strUseDvsn">
			AND USE_DVSN_NO = #strUseDvsn#
		</isNotEmpty>
		<isNotEmpty property="strOrgDvsnCd">
			AND ORG_DVSN_CD = #strOrgDvsnCd#
		</isNotEmpty>
		<isNotEmpty property="strOrgDge">
			AND ORG_DGE_CD = #strOrgDge#
		</isNotEmpty>

		<isNotEmpty property="strOrgCd">
			AND ORG_CD = #strOrgCd#
		</isNotEmpty>
		<isNotEmpty property="strPasaUseYn">
			AND PASA_USE_YN_CD = #strPasaUseYn#
		</isNotEmpty>
		<isNotEmpty property="strCOPT_SG_2_CD">
					AND COPT_SG_2_CD =  #strCOPT_SG_2_CD#
				</isNotEmpty>
		<isNotEmpty property="strOrgCdFrom">
		<![CDATA[
			AND ORG_CD >= #strOrgCdFrom#
			]]>
		</isNotEmpty>
		<isNotEmpty property="strOrgCdTo">
		<![CDATA[
			AND ORG_CD <= #strOrgCdTo#
		]]>
		</isNotEmpty>
		<isNotEmpty property="strRgnCd">
					AND RGN_CD =  #strRgnCd#
				</isNotEmpty>
		<isNotEmpty property="strPUB_DVSN_CD">
					AND PUB_DVSN_CD =  #strPUB_DVSN_CD#
				</isNotEmpty>
		
		<isEmpty property="strOrderBy">
			ORDER BY ORG_CD,ORG_NM
			</isEmpty>
		<isNotEmpty property="strOrderBy">
				ORDER BY $strOrderBy$
		</isNotEmpty>	
		<include refid = "include.pageOrder"/> 
	</select>


	<!-- 기관코드관리신규 -->
	<insert id="dcmacm011OrgInsert" parameterClass="paramMap">
	
		DECLARE
			BEGIN
				INSERT INTO
				TBDCMACM015M
				(
				ORG_CD
				, ORG_NM
				, RGN_CD
				, ORG_DVSN_CD
				, ORG_DGE_CD
				, COPT_SG_CD
				, COPT_SG_2_CD
				, TNB
				, ZCD
				, AD
				, DTL_AD
				, ROAD_NM_AD
				, ROAD_NM_DTL_AD
				, USE_DVSN_NO
				, CRE_DT
				, RMK
				, ENFM_DPT_CD
				, ORG_CAT_CD
				, CVPT_TON_ORG_YN
				, CHG_DT
				, BZN
				, ABLT_DT
				, PUB_DVSN_CD
				, PASA_USE_YN_CD
		
				, FRT_USR_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MNU_ID
				, FRT_REGI_DH
				, FNL_MDF_DH
				, ADMN_ORG_DVSN_CD
				)
				VALUES
				(
				#ORG_CD#
				, #ORG_NM#
				, #RGN_CD#
				, #ORG_DVSN_CD#
				, #ORG_DGE_CD#
				, SUBSTR(#COPT_SG_2_CD#,0,3)
				, #COPT_SG_2_CD#
				, #TNB#
				, #ZCD#
				, #AD#
				, #DTL_AD#
				, #ROAD_NM_AD#
				, #ROAD_NM_DTL_AD#
				, #USE_DVSN_NO#
				,TO_CHAR(SYSDATE,'yyyymmdd')
				, #RMK#
				, #ENFM_DPT_CD#
				, #ORG_CAT_CD#
				, #CVPT_TON_ORG_YN#
				, TO_CHAR(SYSDATE,'yyyymmdd')
				, #BZN#
				, #ABLT_DT#
				, #PUB_DVSN_CD#
				, #PASA_USE_YN_CD#
				, #FRT_USR_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, #FNL_MNU_ID#
				, SYSDATE
				, SYSDATE
				, #ADMN_ORG_DVSN_CD#
				);
				
				INSERT
				INTO
				TBDCMACM035H
				(
				  ORG_CD
				, CON_NO 
				, CON_HNDL_DVSN_CD
				, USE_YN
				
				, FRT_USR_ID		
				, FRT_REGI_DH
				, FNL_MNU_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MDF_DH
				) VALUES
				(
				  #ORG_CD#
				, (	SELECT NVL(MAX(CON_NO),0)+1  AS CON_NO
					  FROM TBDCMACM035H
			       ) 
			    , 'C'
				, 'N'
				
				, #FRT_USR_ID#			
				, SYSDATE
				, #FNL_MNU_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, SYSDATE
				);
		END;
				
	</insert>
	<!-- 기관 수정 -->
	<update id="dcmacm011OrgUpdate" parameterClass="paramMap">
	
	DECLARE
		BEGIN
			UPDATE TBDCMACM015M
			SET ORG_CD = ORG_CD
			, FNL_MDF_DH = SYSDATE
			,
			FNL_USR_ID = #FNL_USR_ID#
			, FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			,
			FNL_MNU_ID = #FNL_MNU_ID#
			,COPT_SG_CD = SUBSTR(#COPT_SG_2_CD#,0,3)
			,COPT_SG_2_CD = #COPT_SG_2_CD#
			,ADMN_ORG_DVSN_CD = #ADMN_ORG_DVSN_CD#
			<isNotNull prepend="," property="ORG_NM">
				ORG_NM = #ORG_NM#
			</isNotNull>
			<isNotNull prepend="," property="RGN_CD">
				RGN_CD = #RGN_CD#
			</isNotNull>
			<isNotNull prepend="," property="ORG_DVSN_CD">
				ORG_DVSN_CD = #ORG_DVSN_CD#
			</isNotNull>
			<isNotNull prepend="," property="ORG_DGE_CD">
				ORG_DGE_CD = #ORG_DGE_CD#
			</isNotNull>
			<isNotNull prepend="," property="TNB">
				TNB = #TNB#
			</isNotNull>
			<isNotNull prepend="," property="ZCD">
				ZCD = #ZCD#
			</isNotNull>
			<isNotNull prepend="," property="AD">
				AD =#AD#
			</isNotNull>
			<isNotNull prepend="," property="DTL_AD">
				DTL_AD = #DTL_AD#
			</isNotNull>
			<isNotNull prepend="," property="ROAD_NM_AD">
				ROAD_NM_AD = #ROAD_NM_AD#
			</isNotNull>
			<isNotNull prepend="," property="ROAD_NM_DTL_AD">
				ROAD_NM_DTL_AD =
				#ROAD_NM_DTL_AD#
			</isNotNull>
			<isNotNull prepend="," property="USE_DVSN_NO">
				USE_DVSN_NO = #USE_DVSN_NO#
			</isNotNull>
			<isNotNull prepend="," property="ENFM_DPT_CD">
				ENFM_DPT_CD = #ENFM_DPT_CD#
			</isNotNull>
			<isNotNull prepend="," property="PASA_USE_YN_CD">
				PASA_USE_YN_CD = #PASA_USE_YN_CD#
			</isNotNull>
			<isNotNull prepend="," property="PUB_DVSN_CD">
				PUB_DVSN_CD = #PUB_DVSN_CD#
			</isNotNull>
	
			WHERE 1 = 1
			AND ORG_CD = #ORG_CD#;
			
			INSERT INTO 
			TBDCMACM034H(
			   CON_NO
			 , CON_USE_YN
			 , ORG_CD
			 , ORG_NM
			 , ORG_DVSN_CD
			 , ORG_DGE_CD
			 , COPT_SG_CD
			 , TNB
			 , ZCD
			 , AD
			 , DTL_AD
			 , ROAD_NM_AD
			 , ROAD_NM_DTL_AD
			 , USE_DVSN_NO
			 , CRE_DT
			 , RMK
			 , ENFM_DPT_CD
			 , ORG_CAT_CD
			 , CVPT_TON_ORG_YN
			 , CHG_DT
			 , BZN
			 , ABLT_DT
			 , PUB_DVSN_CD
			 , SRCH_CNT
			 , PASA_USE_YN_CD
			 , COPT_SG_2_CD
			 , FRT_USR_ID
			 , FNL_USR_ID
			 , FNL_DEAL_DPT_CD
			 , FNL_MNU_ID
			 , FRT_REGI_DH
			 , FNL_MDF_DH
			 , RGN_CD    /* 추가 - 2015.05.26 yyh */
			 , ADMN_ORG_DVSN_CD
			) 
			SELECT (SELECT NVL(MAX(CON_NO),'0')+1 FROM TBDCMACM034H) AS CON_NO
			     , 'N' AS CON_USE_YN
				 , ORG_CD
				 , ORG_NM
				 , ORG_DVSN_CD
				 , ORG_DGE_CD
				 , COPT_SG_CD
				 , TNB
				 , ZCD
				 , AD
				 , DTL_AD
				 , ROAD_NM_AD
				 , ROAD_NM_DTL_AD
				 , USE_DVSN_NO
				 , CRE_DT
				 , RMK
				 , ENFM_DPT_CD
				 , ORG_CAT_CD
				 , CVPT_TON_ORG_YN
				 , CHG_DT
				 , BZN
				 , ABLT_DT
				 , PUB_DVSN_CD
				 , NULL SRCH_CNT
				 , PASA_USE_YN_CD
				 , COPT_SG_2_CD /* 소관부호2코드 추가 - 2017.03.20 yyh */				 
				 , #FNL_USR_ID# AS FRT_USR_ID
				 , #FNL_USR_ID# AS FNL_USR_ID
				 , #FNL_DEAL_DPT_CD# AS FNL_DEAL_DPT_CD
				 , #FNL_MNU_ID# AS FNL_MNU_ID
				 , SYSDATE AS FRT_REGI_DH
				 , SYSDATE AS FNL_MDF_DH
				 , RGN_CD
				 , NVL(ADMN_ORG_DVSN_CD,'N') AS ADMN_ORG_DVSN_CD
			 FROM TBDCMACM015M 
			 WHERE ORG_CD = #ORG_CD#;
			 
		END;

	</update>

	<!-- 기관코드 delete -->
	<delete id="dcmacm011OrgDelete" parameterClass="paramMap">
		
	DECLARE
		BEGIN
			DELETE
			TBDCMACM015M
			WHERE 1 = 1
			AND ORG_CD = #ORG_CD#;
			
				INSERT
					INTO
					TBDCMACM035H
					(
					  ORG_CD
					, CON_NO 
					, CON_HNDL_DVSN_CD
					, USE_YN
					
					, FRT_USR_ID		
					, FRT_REGI_DH
					, FNL_MNU_ID
					, FNL_USR_ID
					, FNL_DEAL_DPT_CD
					, FNL_MDF_DH
					) VALUES
					(
					  #ORG_CD#
					, (	SELECT NVL(MAX(CON_NO),0)+1  AS CON_NO
						  FROM TBDCMACM035H
				       ) 
				    , 'D'
					, 'N'
					
					, #FRT_USR_ID#			
					, SYSDATE
					, #FNL_MNU_ID#
					, #FNL_USR_ID#
					, #FNL_DEAL_DPT_CD#
					, SYSDATE
					);
			END;
	</delete>


	<!-- 기관코드 팝업 국가기관조회 -->
	<select id="dcmacm014OrgNatSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<include refid="include.pageSelct" />
		
	<![CDATA[
       SELECT CASE
          WHEN USE_DVSN_NO='N' THEN '(*)'||ORG_CD
           ELSE  ORG_CD
           END AS ORG_CD_YN
            , ORG_CD
            , ORG_NM
            , RGN_CD
            , F_CODE_NM('1000001',RGN_CD) AS RGN_NM   
            , ORG_DVSN_CD
            , F_CODE_NM('1000119',ORG_DVSN_CD) AS ORG_DVSN_NM
            , ORG_DGE_CD
            , F_CODE_NM('1000346',ORG_DGE_CD) AS ORG_DGE_NM
            , COPT_SG_CD
            , F_ORG_HRK_NM(COPT_SG_CD) AS COPT_SG_NM
            , TNB
            , ZCD
            , AD
            , DTL_AD
			, ROAD_NM_AD
            , ROAD_NM_DTL_AD
            , USE_DVSN_NO
            , ENFM_DPT_CD
            , ORG_CAT_CD
            , PUB_DVSN_CD
            ,COPT_SG_2_CD
			,F_DPT_INFO(ENFM_DPT_CD,'1') AS ENFM_DPT_NM
			,ADMN_ORG_DVSN_CD
         FROM TBDCMACM015M
        WHERE 1=1
        
         AND ORG_DVSN_CD = '10'
	         ]]>
		<isNotEmpty property="strUseDvsn">
			AND USE_DVSN_NO = #strUseDvsn#
		</isNotEmpty>
		<isNotEmpty property="strOrgNm">
			AND (ORG_NM LIKE
			'%'||#strOrgNm#||'%'OR ORG_CD LIKE
			'%'||#strOrgNm#||'%')
		</isNotEmpty>
		<isNotEmpty property="strCoptSg">
			AND COPT_SG_CD = #strCoptSg#
		</isNotEmpty>
		<isNotEmpty property="strOrgDgeCd">
			AND ORG_DGE_CD = #strOrgDgeCd#
		</isNotEmpty>
		<isNotEmpty property="strOrgDvsnCd">
			AND ORG_DVSN_CD = #strOrgDvsnCd#
		</isNotEmpty>
		<isNotEmpty property="strCoptDvsn">
			   AND EXISTS ( SELECT 1
                  FROM TBDCMACM013C
                 WHERE CMM_CD_DVSN_CD ='1000719'
                   AND USR_DFN_TXT_1||'000000000' = TBDCMACM015M.ORG_CD) 
		</isNotEmpty>
		
		<!-- 기관정보관리대상여부 - 2018.07.16 yyh -->	
		<isNotEmpty property="strMngDvsnYn">
			<isEqual property="strMngDvsnYn" compareValue="Y">
				AND MNG_DVSN_YN = 'Y'
			</isEqual>
			<isEqual property="strMngDvsnYn" compareValue="YW">
				AND MNG_DVSN_YN IN ('Y','W') 
			</isEqual>			   
		</isNotEmpty>
				
		<include refid="include.pageOrder" />
	</select>

	<!-- 기관코드 팝업 기타 -->
	<select id="dcmacm016OrgEtcSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<include refid="include.pageSelct" />
		
	<![CDATA[
       SELECT CASE
          WHEN USE_DVSN_NO='N' THEN '(*)'||ORG_CD
           ELSE  ORG_CD
           END AS ORG_CD_YN
            , ORG_CD
            , ORG_NM
            , RGN_CD
            ,  F_CODE_NM('1000001',RGN_CD) AS RGN_NM    
            , ORG_DVSN_CD
            , F_CODE_NM('1000119',ORG_DVSN_CD) AS ORG_DVSN_NM
            , ORG_DGE_CD
            , F_CODE_NM('1000346',ORG_DGE_CD) AS ORG_DGE_NM
            , COPT_SG_CD
            , F_ORG_HRK_NM(COPT_SG_CD) AS COPT_SG_NM
            , TNB
            , ZCD
            , AD
            , DTL_AD
			, ROAD_NM_AD
            , ROAD_NM_DTL_AD
            , USE_DVSN_NO
            , ENFM_DPT_CD
            , ORG_CAT_CD
            , PUB_DVSN_CD
            ,COPT_SG_2_CD
			,F_DPT_INFO(ENFM_DPT_CD,'1') AS ENFM_DPT_NM
			,ADMN_ORG_DVSN_CD
         FROM TBDCMACM015M
        WHERE 1=1
         AND ORG_DVSN_CD IN ('58','59')
         
         
	         ]]>

		<isNotEmpty property="strUseDvsn">
			AND USE_DVSN_NO = #strUseDvsn#
		</isNotEmpty>
		<isNotEmpty property="strOrgNm">
			AND (ORG_NM LIKE
			'%'||#strOrgNm#||'%'OR ORG_CD LIKE
			'%'||#strOrgNm#||'%')
		</isNotEmpty>
		<isNotEmpty property="strCoptSg">
			AND COPT_SG_CD = #strCoptSg#
		</isNotEmpty>
		<isNotEmpty property="strOrgDgeCd">
			AND ORG_DGE_CD = #strOrgDgeCd#
		</isNotEmpty>
				<isNotEmpty property="strOrgDvsnCd">
			AND ORG_DVSN_CD = #strOrgDvsnCd#
		</isNotEmpty>
		
		<isNotEmpty property="strCoptDvsn">
			   AND EXISTS ( SELECT 1
                  FROM TBDCMACM013C
                 WHERE CMM_CD_DVSN_CD ='1000719'
                   AND USR_DFN_TXT_1||'000000000' = TBDCMACM015M.ORG_CD) 
		</isNotEmpty>
		
		<!-- 기관정보관리대상여부 - 2018.07.16 yyh -->	
		<isNotEmpty property="strMngDvsnYn">
			<isEqual property="strMngDvsnYn" compareValue="Y">
				AND MNG_DVSN_YN = 'Y'
			</isEqual>
			<isEqual property="strMngDvsnYn" compareValue="YW">
				AND MNG_DVSN_YN IN ('Y','W') 
			</isEqual>			   
		</isNotEmpty>
		
		<include refid="include.pageOrder" />
	</select>
	<!-- 기관 코드 지방자치단체 -->
	<select id="dcmacm015OrgPvcSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<include refid="include.pageSelct" />
		
	<![CDATA[
       SELECT CASE
          WHEN USE_DVSN_NO='N' THEN '(*)'||ORG_CD
           ELSE  ORG_CD
           END AS ORG_CD_YN
            , ORG_CD
            , ORG_NM
            , RGN_CD
            , F_CODE_NM('1000001',RGN_CD) AS RGN_NM    
               
            , ORG_DVSN_CD
            , F_CODE_NM('1000119',ORG_DVSN_CD) AS ORG_DVSN_NM
            , ORG_DGE_CD
            , F_CODE_NM('1000346',ORG_DGE_CD) AS ORG_DGE_NM
            , COPT_SG_CD
            , F_ORG_HRK_NM(COPT_SG_CD) AS COPT_SG_NM
            , TNB
            , ZCD
            , AD
            , DTL_AD
			, ROAD_NM_AD
            , ROAD_NM_DTL_AD
            , USE_DVSN_NO
            , ENFM_DPT_CD
            , ORG_CAT_CD
            , PUB_DVSN_CD
            ,COPT_SG_2_CD
			,F_DPT_INFO(ENFM_DPT_CD,'1') AS ENFM_DPT_NM
			,ADMN_ORG_DVSN_CD
         FROM TBDCMACM015M
        WHERE 1=1
         AND ORG_DVSN_CD IN ('21','22')
	         ]]>
		<isNotEmpty property="strUseDvsn">
	AND USE_DVSN_NO = #strUseDvsn#
		</isNotEmpty>
		<isNotEmpty property="strOrgNm">
			AND (ORG_NM LIKE
			'%'||#strOrgNm#||'%'OR ORG_CD LIKE
			'%'||#strOrgNm#||'%')
		</isNotEmpty>
		<isNotEmpty property="strCoptSg">
			AND COPT_SG_CD = #strCoptSg#
		</isNotEmpty>
		<isNotEmpty property="strOrgDgeCd">
			AND ORG_DGE_CD = #strOrgDgeCd#
		</isNotEmpty>
		<isNotEmpty property="strOrgDvsnCd">
			AND ORG_DVSN_CD = #strOrgDvsnCd#
		</isNotEmpty>
		
		<isNotEmpty property="strCoptDvsn">
			   AND EXISTS ( SELECT 1
                  FROM TBDCMACM013C
                 WHERE CMM_CD_DVSN_CD ='1000719'
                   AND USR_DFN_TXT_1||'000000000' = TBDCMACM015M.ORG_CD) 
		</isNotEmpty>
		
		<!-- 기관정보관리대상여부 - 2018.07.16 yyh -->	
		<isNotEmpty property="strMngDvsnYn">
			<isEqual property="strMngDvsnYn" compareValue="Y">
				AND MNG_DVSN_YN = 'Y'
			</isEqual>
			<isEqual property="strMngDvsnYn" compareValue="YW">
				AND MNG_DVSN_YN IN ('Y','W') 
			</isEqual>			   
		</isNotEmpty>
		
		<include refid="include.pageOrder" />
	</select>
	<!-- 기관코드 공공기관 -->
	<select id="dcmacm017OrgPubSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<include refid="include.pageSelct" />
		
	<![CDATA[
       SELECT CASE
          WHEN USE_DVSN_NO='N' THEN '(*)'||ORG_CD
           ELSE  ORG_CD
           END AS ORG_CD_YN
            , ORG_CD
            , ORG_NM
            , RGN_CD
            , F_CODE_NM('1000001',RGN_CD) AS RGN_NM    
            , ORG_DVSN_CD
            , F_CODE_NM('1000119',ORG_DVSN_CD) AS ORG_DVSN_NM
            , ORG_DGE_CD
            , F_CODE_NM('1000346',ORG_DGE_CD) AS ORG_DGE_NM
            , COPT_SG_CD
            , F_ORG_HRK_NM(COPT_SG_CD) AS COPT_SG_NM
            , TNB
            , ZCD
            , AD
            , DTL_AD
			, ROAD_NM_AD
            , ROAD_NM_DTL_AD
            , USE_DVSN_NO
            , ENFM_DPT_CD
            , ORG_CAT_CD
            , PUB_DVSN_CD
            ,COPT_SG_2_CD
			,F_DPT_INFO(ENFM_DPT_CD,'1') AS ENFM_DPT_NM
			,ADMN_ORG_DVSN_CD
         FROM TBDCMACM015M
        WHERE 1=1
         AND ORG_DVSN_CD NOT IN ('10','21','22','58','59')
	         ]]>
		<isNotEmpty property="strUseDvsn">
			AND USE_DVSN_NO = #strUseDvsn#
		</isNotEmpty>
		<isNotEmpty property="strOrgNm">
			AND (ORG_NM LIKE
			'%'||#strOrgNm#||'%'OR ORG_CD LIKE
			'%'||#strOrgNm#||'%')
		</isNotEmpty>
		<isNotEmpty property="strCoptSg">
			AND COPT_SG_CD = #strCoptSg#
		</isNotEmpty>
		<isNotEmpty property="strOrgDgeCd">
			AND ORG_DGE_CD = #strOrgDgeCd#
		</isNotEmpty>
		<isNotEmpty property="strOrgDvsnCd">
			AND ORG_DVSN_CD = #strOrgDvsnCd#
		</isNotEmpty>
		
		<isNotEmpty property="strCoptDvsn">
			   AND EXISTS ( SELECT 1
                  FROM TBDCMACM013C
                 WHERE CMM_CD_DVSN_CD ='1000719'
                   AND USR_DFN_TXT_1||'000000000' = TBDCMACM015M.ORG_CD) 
		</isNotEmpty>
		
		<!-- 기관정보관리대상여부 - 2018.07.16 yyh -->	
		<isNotEmpty property="strMngDvsnYn">
			<isEqual property="strMngDvsnYn" compareValue="Y">
				AND MNG_DVSN_YN = 'Y'
			</isEqual>
			<isEqual property="strMngDvsnYn" compareValue="YW">
				AND MNG_DVSN_YN IN ('Y','W') 
			</isEqual>			   
		</isNotEmpty>
		
		<include refid="include.pageOrder" />

	</select>
	
	<!-- 기관코드 공공기관기타 - 2018.07.20 yyh -->
	<select id="dcmacm018OrgPubAndEtcSelect" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		
	<![CDATA[
       SELECT CASE
          WHEN USE_DVSN_NO='N' THEN '(*)'||ORG_CD
           ELSE  ORG_CD
           END AS ORG_CD_YN
            , ORG_CD
            , ORG_NM
            , RGN_CD
            , F_CODE_NM('1000001',RGN_CD) AS RGN_NM    
            , ORG_DVSN_CD
            , F_CODE_NM('1000119',ORG_DVSN_CD) AS ORG_DVSN_NM
            , ORG_DGE_CD
            , F_CODE_NM('1000346',ORG_DGE_CD) AS ORG_DGE_NM
            , COPT_SG_CD
            , F_ORG_HRK_NM(COPT_SG_CD) AS COPT_SG_NM
            , TNB
            , ZCD
            , AD
            , DTL_AD
			, ROAD_NM_AD
            , ROAD_NM_DTL_AD
            , USE_DVSN_NO
            , ENFM_DPT_CD
            , ORG_CAT_CD
            , PUB_DVSN_CD
            ,COPT_SG_2_CD
			,F_DPT_INFO(ENFM_DPT_CD,'1') AS ENFM_DPT_NM
			,ADMN_ORG_DVSN_CD
         FROM TBDCMACM015M
        WHERE 1=1
         AND ORG_DVSN_CD NOT IN ('10','21','22')
	         ]]>
		<isNotEmpty property="strUseDvsn">
			AND USE_DVSN_NO = #strUseDvsn#
		</isNotEmpty>
		<isNotEmpty property="strOrgNm">
			AND (ORG_NM LIKE
			'%'||#strOrgNm#||'%'OR ORG_CD LIKE
			'%'||#strOrgNm#||'%')
		</isNotEmpty>
		<isNotEmpty property="strCoptSg">
			AND COPT_SG_CD = #strCoptSg#
		</isNotEmpty>
		<isNotEmpty property="strOrgDgeCd">
			AND ORG_DGE_CD = #strOrgDgeCd#
		</isNotEmpty>
		<isNotEmpty property="strOrgDvsnCd">
			AND ORG_DVSN_CD = #strOrgDvsnCd#
		</isNotEmpty>
		
		<isNotEmpty property="strCoptDvsn">
			   AND EXISTS ( SELECT 1
                  FROM TBDCMACM013C
                 WHERE CMM_CD_DVSN_CD ='1000719'
                   AND USR_DFN_TXT_1||'000000000' = TBDCMACM015M.ORG_CD) 
		</isNotEmpty>
		
		<!-- 기관정보관리대상여부 - 2018.07.16 yyh -->	
		<isNotEmpty property="strMngDvsnYn">
			<isEqual property="strMngDvsnYn" compareValue="Y">
				AND MNG_DVSN_YN = 'Y'
			</isEqual>
			<isEqual property="strMngDvsnYn" compareValue="YW">
				AND MNG_DVSN_YN IN ('Y','W') 
			</isEqual>			   
		</isNotEmpty>
		
		<include refid="include.pageOrder" />

	</select>
		
	<!-- 기관팝업 전체조회 -->
	<select id="dcmacm013OrgAllSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<include refid="include.pageSelct" />
		
	<![CDATA[
       SELECT CASE
          WHEN USE_DVSN_NO='N' THEN '(*)'||ORG_CD
           ELSE  ORG_CD
           END AS ORG_CD_YN
            , ORG_CD
            , ORG_NM
            , RGN_CD
            , F_CODE_NM('1000001',RGN_CD) AS RGN_NM
            , ORG_DVSN_CD
            , F_CODE_NM('1000119',ORG_DVSN_CD) AS ORG_DVSN_NM
            , ORG_DGE_CD
            , F_CODE_NM('1000346',ORG_DGE_CD) AS ORG_DGE_NM
            , COPT_SG_CD
            , F_ORG_HRK_NM(COPT_SG_CD) AS COPT_SG_NM
            , TNB
            , ZCD
            , AD
	
            , DTL_AD
			, ROAD_NM_AD
            , ROAD_NM_DTL_AD
            , USE_DVSN_NO
            , ENFM_DPT_CD
            , ORG_CAT_CD
            , PUB_DVSN_CD
			,COPT_SG_2_CD
			,F_DPT_INFO(ENFM_DPT_CD,'1') AS ENFM_DPT_NM
			,ADMN_ORG_DVSN_CD
         FROM TBDCMACM015M
        WHERE 1=1
	         ]]>
	    <isNotEmpty property="strUseDvsn">
			AND USE_DVSN_NO = #strUseDvsn#
		</isNotEmpty>     
		<isNotEmpty property="strOrgNm">
			AND (ORG_NM LIKE
			'%'||#strOrgNm#||'%'OR ORG_CD LIKE
			'%'||#strOrgNm#||'%')
		</isNotEmpty>
		<isNotEmpty property="strCoptSg">
			AND COPT_SG_CD = #strCoptSg#
		</isNotEmpty>
		<isNotEmpty property="strOrgDvsnCd">
			AND ORG_DVSN_CD = #strOrgDvsnCd#
		</isNotEmpty>
		<isNotEmpty property="strOrgDgeCd">
			AND ORG_DGE_CD = #strOrgDgeCd#
		</isNotEmpty>
		<isNotEmpty property="strCoptDvsn">
			   AND EXISTS ( SELECT 1
                  FROM TBDCMACM013C
                 WHERE CMM_CD_DVSN_CD ='1000719'
                   AND USR_DFN_TXT_1||'000000000' = TBDCMACM015M.ORG_CD) 
		</isNotEmpty>
		
		<!-- 기관정보관리대상여부 - 2018.07.09 yyh -->	
		<isNotEmpty property="strMngDvsnYn">
			<isEqual property="strMngDvsnYn" compareValue="Y">
				AND MNG_DVSN_YN = 'Y'
			</isEqual>
			<isEqual property="strMngDvsnYn" compareValue="YW">
				AND MNG_DVSN_YN IN ('Y','W') 
			</isEqual>			   
		</isNotEmpty>
				
		<include refid="include.pageOrder" />

	</select>

	<!-- 임포트 조회 -->

	<select id="dcmacm013OrgImpSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
       SELECT ORG_CD
            , ORG_NM
            , RGN_CD
            , F_CODE_NM('1000001',RGN_CD) AS RGN_NM
            , ORG_DVSN_CD
            , F_CODE_NM('1000119',ORG_DVSN_CD) AS ORG_DVSN_NM
            , ORG_DGE_CD
            , F_CODE_NM('1000346',ORG_DGE_CD) AS ORG_DGE_NM
            , COPT_SG_CD
            , F_ORG_HRK_NM(COPT_SG_CD) AS COPT_SG_NM
            , TNB
            , ZCD
            , AD
	
            , DTL_AD
			, ROAD_NM_AD
            , ROAD_NM_DTL_AD
            , USE_DVSN_NO
            , ENFM_DPT_CD
            , ORG_CAT_CD
            , PUB_DVSN_CD
			, COPT_SG_2_CD
			,F_DPT_INFO(ENFM_DPT_CD,'1') AS ENFM_DPT_NM
			,ADMN_ORG_DVSN_CD
         FROM TBDCMACM015M
        WHERE 1=1
	         ]]>
		<isNotEmpty property="strOrgNm">
			AND (ORG_NM LIKE
			'%'||#strOrgNm#||'%'OR ORG_CD LIKE
			'%'||#strOrgNm#||'%')
		</isNotEmpty>
		<isNotEmpty property="strCoptSg">
			AND COPT_SG_CD = #strCoptSg#
		</isNotEmpty>
		<isNotEmpty property="strOrgDvsnCd">
			AND ORG_DVSN_CD = #strOrgDvsnCd#
		</isNotEmpty>
			<isNotEmpty property="strUseDvsn">
			AND USE_DVSN_NO = #strUseDvsn#
		</isNotEmpty>
		
		<isNotEmpty property="strCoptDvsn">
			   AND EXISTS ( SELECT 1
                  FROM TBDCMACM013C
                 WHERE CMM_CD_DVSN_CD ='1000719'
                   AND USR_DFN_TXT_1||'000000000' = TBDCMACM015M.ORG_CD) 
		</isNotEmpty>
		
		<!-- 기관차수 - 2018.05.30 yyh -->	
		<isNotEmpty property="strOrgDgeCd">
			   AND ORG_DGE_CD = #strOrgDgeCd#
		</isNotEmpty>
				
		<!-- 기관정보관리대상여부 - 2018.07.09 yyh -->	
		<isNotEmpty property="strMngDvsnYn">
			<isEqual property="strMngDvsnYn" compareValue="Y">
				AND MNG_DVSN_YN = 'Y'
			</isEqual>
			<isEqual property="strMngDvsnYn" compareValue="YW">
				AND MNG_DVSN_YN IN ('Y','W') 
			</isEqual>			   
		</isNotEmpty>
						
	</select>
	<!-- 사용자조회 -->
	<!--2015.11.18 조석원 감사관님 요청 - 팩스번호-->
	<select id="dcmacm001UsrMgSelect" parameterClass="paramMap" 	resultClass="resultMap">
	<![CDATA[
 	SELECT USR_DVSN_CD  
            , F_CODE_NM('1000338',USR_DVSN_CD) AS USR_DVSN_NM          
            , ORG_CD
            , F_ORG_INFO(ORG_CD,'1') AS ORG_NM
            , CNB
            , DPT_CD
            , F_DPT_INFO(DPT_CD,'1') AS DPT_NM
            , USR_ID 
            , USR_NAM
            , RQS_STA_CD       
            , RLS_DT     
            , TNB
            , RANK_CD
            , F_CODE_NM('1000173',RANK_CD) AS RANK_NM
            , PST_CD
            , F_CODE_NM('1000176',PST_CD)  AS PST_NM
            , F_PER_INFO(DGUARD.DECRYPT('TB_ENC','EIN', EIN) ,'1')  AS EIN  /* EIN 개인정보보호를 위해 마스킹처리 */ 
            , EML_AD
           
            , BAI_USR_YN
            /*, ZCD 2016.06.30 최승규 수석님 요청*/
            , APM_DVSN_CD   
            , F_PER_INFO(HOM_TNB,'2')  AS HOM_TNB /* HOM_TNB 개인정보보호를 위해 마스킹처리 */           
            , RQS_TXT
            , LOGIN_WAY_CD
            , DOC_ID
            , DOC_TYP_CD
            
            , INN_RANK_CD
             
            /*2015.01.27 박재운 감사관 요청-실소속부서 수정가능하도록.*/
            , RAL_BLT_DIV_CD                                            /*실소속코드*/
            , F_CODE_NM('1000144', RAL_BLT_DIV_CD) AS RAL_BLT_DIV_NM    /*실소속명*/
            
            , FAN
            , CAR_NO
            ,T1.SUB_DPT_CD
            ,F_DPT_INFO(T1.SUB_DPT_CD,'1') AS SUB_DPT_NM
            ,SUB_INN_RANK_CD
            ,T1.WRK_STR_DT
            ,T1.WRK_END_DT
            ,T1.ONR_PST_NM
            ,T1.SGN_DOC_ID
            ,T1.STMP_DOC_ID
            ,(SELECT FILE_NAME FROM ECM_FILE_LIST_VIEW2 S1 WHERE T1.SGN_DOC_ID = S1.DOC_ID ) AS SGN_FILE_NAME
            ,(SELECT FILE_NAME FROM ECM_FILE_LIST_VIEW2 S1 WHERE T1.STMP_DOC_ID = S1.DOC_ID ) AS STMP_FILE_NAME
            
             /* 출장여비계좌관리 정보 추가 - 2017.04.06 yyh */
            ,T1.BZT_TREXP_RCIT_BNK_CD                       AS BZT_TREXP_RCIT_BNK_CD /* 출장여비수령은행코드 */
            , F_CODE_NM('1000166', T1.BZT_TREXP_RCIT_BNK_CD) AS BZT_TREXP_RCIT_BNK_NM /* 출장여비수령은행명 */
            , F_PER_INFO(DGUARD.DECRYPT('TB_ENC','EAN', T1.BZT_TREXP_RCIT_EAN) ,'3')  AS BZT_TREXP_RCIT_EAN  /* BZT_TREXP_RCIT_EAN 출장여비수령계좌번호 개인정보보호를 위해 마스킹처리 */ 
            
            ,PBSVT_NO           
            ,T1.GEN_ADMN_DVSN_CD
            ,T1.CHR_DTY_NM/*담당직무*/
            ,NVL(T1.IS_LOCK,'N') AS IS_LOCK
            ,NVL(T1.INACTIVE,'N') AS INACTIVE /*휴면계정여부*/
         FROM TBDCMACM001M T1
         WHERE 1=1
          ]]>

		<isNotEmpty property="strUsrNam">
			AND USR_NAM LIKE '%'||#strUsrNam#||'%'
		</isNotEmpty>
		<isNotEmpty property="strUsrId">
			AND USR_ID LIKE #strUsrId#||'%'
		</isNotEmpty>
		<isNotEmpty property="strDptCd">
			AND DPT_CD = #strDptCd#
		</isNotEmpty>
		<isNotEmpty property="strHirkDptCd">
			AND	SUBSTR(DPT_CD, 0, 3) = SUBSTR(#strHirkDptCd#, 0, 3)
		</isNotEmpty>
		<isNotEmpty property="strRqsStaCd">
			AND RQS_STA_CD = #strRqsStaCd#
		</isNotEmpty>

		<isNotEmpty property="strUsrDvsn">
			AND USR_DVSN_CD = #strUsrDvsn#
		</isNotEmpty>

		<isNotEmpty property="strUsrCnb">
			AND CNB LIKE #strUsrCnb#||'%'
		</isNotEmpty>
		<isNotEmpty property="strLoginWayCd">
			AND LOGIN_WAY_CD = #strLoginWayCd#
		</isNotEmpty>
		<isEqual property="strWrkYn" compareValue="Y">
			AND	(T1.WRK_END_DT IS NOT NULL AND TO_CHAR(SYSDATE,'YYYYMMDD') <![CDATA[>]]> T1.WRK_END_DT)
		</isEqual>
		<isEqual property="strWrkYn" compareValue="N">
			AND	(T1.WRK_END_DT IS NULL OR TO_CHAR(SYSDATE,'YYYYMMDD') <![CDATA[<=]]> T1.WRK_END_DT)
		</isEqual>
		<isNotEmpty property="strOrder">
			ORDER BY RANK_CD, CNB
		</isNotEmpty>
		
		<isEmpty property="strOrder">
		ORDER BY USR_NAM
		</isEmpty>
	</select>

	<!-- 사용자조회 암호화 X -->
	<select id="dcmacm001UsrMgSelect2" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
 	SELECT USR_DVSN_CD  
            , F_CODE_NM('1000338',USR_DVSN_CD) AS USR_DVSN_NM          
            , ORG_CD
            , F_ORG_INFO(ORG_CD,'1') AS ORG_NM
            , CNB
            , DPT_CD
            , F_DPT_INFO(DPT_CD,'1') AS DPT_NM
            , USR_ID 
            , USR_NAM
            , RQS_STA_CD       
            , RLS_DT     
            , TNB
            , RANK_CD
            , F_CODE_NM('1000173',RANK_CD) AS RANK_NM
            , PST_CD
            , F_CODE_NM('1000176',PST_CD)  AS PST_NM
            , REGEXP_REPLACE(DGUARD.DECRYPT('TB_ENC','EIN',EIN),'(\d{6})(\d{7})(\d{0,7})','\1-\2') AS EIN
            , EML_AD
           
            , BAI_USR_YN
            /*, ZCD 2016.06.30 최승규 수석님 요청*/
            , APM_DVSN_CD   
            , HOM_TNB 
            , RQS_TXT
            , LOGIN_WAY_CD
            , DOC_ID
            , DOC_TYP_CD
            
            , INN_RANK_CD
             
            /*2015.01.27 박재운 감사관 요청-실소속부서 수정가능하도록.*/
            , RAL_BLT_DIV_CD                                            /*실소속코드*/
            , F_CODE_NM('1000144', RAL_BLT_DIV_CD) AS RAL_BLT_DIV_NM    /*실소속명*/
            
            , FAN
            , CAR_NO
            ,T1.SUB_DPT_CD
            ,F_DPT_INFO(T1.SUB_DPT_CD,'1') AS SUB_DPT_NM
            ,SUB_INN_RANK_CD
            ,T1.WRK_STR_DT
            ,T1.WRK_END_DT
            ,T1.ONR_PST_NM
            ,T1.SGN_DOC_ID
            ,T1.STMP_DOC_ID
            ,(SELECT FILE_NAME FROM ECM_FILE_LIST_VIEW2 S1 WHERE T1.SGN_DOC_ID = S1.DOC_ID ) AS SGN_FILE_NAME
            ,(SELECT FILE_NAME FROM ECM_FILE_LIST_VIEW2 S1 WHERE T1.STMP_DOC_ID = S1.DOC_ID ) AS STMP_FILE_NAME
            
             /* 출장여비계좌관리 정보 추가 - 2017.04.06 yyh */
            ,T1.BZT_TREXP_RCIT_BNK_CD                       AS BZT_TREXP_RCIT_BNK_CD /* 출장여비수령은행코드 */
            , F_CODE_NM('1000166', T1.BZT_TREXP_RCIT_BNK_CD) AS BZT_TREXP_RCIT_BNK_NM /* 출장여비수령은행명 */
            , F_PER_INFO(DGUARD.DECRYPT('TB_ENC','EAN', T1.BZT_TREXP_RCIT_EAN) ,'3')  AS BZT_TREXP_RCIT_EAN  /* BZT_TREXP_RCIT_EAN 출장여비수령계좌번호 개인정보보호를 위해 마스킹처리 */ 
            
            ,PBSVT_NO           
            ,T1.GEN_ADMN_DVSN_CD
            ,T1.CHR_DTY_NM/*담당직무*/
            ,NVL(T1.IS_LOCK,'N') AS IS_LOCK
            ,NVL(T1.INACTIVE,'N') AS INACTIVE /*휴면계정여부*/
         FROM TBDCMACM001M T1
         WHERE 1=1
          ]]>

		<isNotEmpty property="strUsrNam">
			AND USR_NAM LIKE '%'||#strUsrNam#||'%'
		</isNotEmpty>
		<isNotEmpty property="strUsrId">
			AND USR_ID LIKE #strUsrId#||'%'
		</isNotEmpty>
		<isNotEmpty property="strDptCd">
			AND DPT_CD = #strDptCd#
		</isNotEmpty>
		<isNotEmpty property="strHirkDptCd">
			AND	SUBSTR(DPT_CD, 0, 3) = SUBSTR(#strHirkDptCd#, 0, 3)
		</isNotEmpty>
		<isNotEmpty property="strRqsStaCd">
			AND RQS_STA_CD = #strRqsStaCd#
		</isNotEmpty>

		<isNotEmpty property="strUsrDvsn">
			AND USR_DVSN_CD = #strUsrDvsn#
		</isNotEmpty>

		<isNotEmpty property="strUsrCnb">
			AND CNB LIKE #strUsrCnb#||'%'
		</isNotEmpty>
		<isNotEmpty property="strLoginWayCd">
			AND LOGIN_WAY_CD = #strLoginWayCd#
		</isNotEmpty>
		<isEqual property="strWrkYn" compareValue="Y">
			AND	(T1.WRK_END_DT IS NOT NULL AND TO_CHAR(SYSDATE,'YYYYMMDD') <![CDATA[>]]> T1.WRK_END_DT)
		</isEqual>
		<isEqual property="strWrkYn" compareValue="N">
			AND	(T1.WRK_END_DT IS NULL OR TO_CHAR(SYSDATE,'YYYYMMDD') <![CDATA[<=]]> T1.WRK_END_DT)
		</isEqual>
		<isNotEmpty property="strOrder">
			ORDER BY RANK_CD, CNB
		</isNotEmpty>
		
		<isEmpty property="strOrder">
		ORDER BY USR_NAM
		</isEmpty>
	</select>

	<!-- 사용자 신규 2015.1.13 BAI_USR_YN 추가 전상철대리님 요청사항-->
	<!-- 신규 등록시 직급정렬순서명 값은 사용자구분에 상관없이 무조건 10을 넣는다. 2015.03.25 박재운감사관 요청 -->
	<insert id="dcmacm001UsrMgInsert" parameterClass="paramMap">
	DECLARE
		BEGIN
			INSERT INTO
			TBDCMACM001M
			(
			CNB
			, USR_ID
			, USR_NAM
			, RANK_CD
			, PST_CD
			, DPT_CD
			, TNB
			, EIN
			, AD
			, EML_AD
			, USR_DVSN_CD
			, RQS_TXT
			, RQS_STA_CD
			
	
			, RQR_ID
			, RQS_DT
	
			, RLS_DT
			, LOGIN_WAY_CD
			, DOC_ID
			, ESN
			, TMP_YN                                                                                                                                                             
			, BAI_USR_YN 
			, ORG_CD
			, INN_RANK_CD
			, HOM_TNB
	        , RAL_BLT_DIV_CD
			, FNL_MNU_ID
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FRT_REGI_DH
			, FNL_MDF_DH
			, WOK_DVSN_CD
			, RANK_SRT_SEQ_NM
			
			,FAN
			,CAR_NO
			,SUB_DPT_CD
			,SUB_INN_RANK_CD
			,WRK_STR_DT
			,WRK_END_DT
			
			,BZT_TREXP_RCIT_BNK_CD /* 출장여비수령은행코드 - 2017.04.06 yyh */
			,BZT_TREXP_RCIT_EAN    /* 출장여비수령암호화계좌번호 - 2017.04.06 yyh */		
			,PBSVT_NO	
			,GEN_ADMN_DVSN_CD
			,CHR_DTY_NM /*담당직무*/
			)
			VALUES
			(
			  #CNB#
			, #USR_ID#
			, #USR_NAM#
			, #RANK_CD#
			, #PST_CD#
			, #DPT_CD#
			, #TNB#
			, #EIN#
			, #AD#
			, #EML_AD#
			, #USR_DVSN_CD#
			, #RQS_TXT#
			, '3'
		
	
			, #FRT_USR_ID#
			, TO_CHAR(SYSDATE,'yyyymmdd')
	
			,TO_CHAR(SYSDATE,'yyyymmdd')
			, #LOGIN_WAY_CD#
			, #DOC_ID#
			, #ESN#
			, 'Y'
			, 'Y'
			, '011000000000'
			, #INN_RANK_CD#
			, #HOM_TNB#
	        , #RAL_BLT_DIV_CD#
			, #FNL_MNU_ID#
			, #FRT_USR_ID#
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, SYSDATE
			, SYSDATE
			, DECODE(#USR_DVSN_CD#,'3','AAA','1','AAA',NULL)
			, '10'
			
			,#FAN#
			,REPLACE(#CAR_NO#,' ','') /*입력시 공백제거*/
			,#SUB_DPT_CD#
			,#SUB_INN_RANK_CD#
			,#WRK_STR_DT#
			,#WRK_END_DT#
			
			,#BZT_TREXP_RCIT_BNK_CD# 
			,#BZT_TREXP_RCIT_EAN# 		
			,#PBSVT_NO#		
			,#GEN_ADMN_DVSN_CD#	
			,#CHR_DTY_NM#
			);
		INSERT
				INTO
				TBDCMACM038H
				(
				  CNB
				, CON_NO 
				, CON_HNDL_DVSN_CD
				, USE_YN
				
				, FRT_USR_ID		
				, FRT_REGI_DH
				, FNL_MNU_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MDF_DH
				) VALUES
				(
				  #CNB#
				, (	SELECT NVL(MAX(CON_NO),0)+1  AS CON_NO
					  FROM TBDCMACM038H
			       ) 
			    , 'C'
				, 'N'
				
				, #FRT_USR_ID#			
				, SYSDATE
				, #FNL_MNU_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, SYSDATE
				);
		 END;			
			
	</insert>

	<!-- 사용자 수정 -->
	<update id="dcmacm001UsrMgUpdate" parameterClass="paramMap">
	DECLARE
		BEGIN	
		UPDATE TBDCMACM001M
		SET CNB = #CNB#
		, FNL_MDF_DH = SYSDATE
		, FNL_MNU_ID =
		#FNL_MNU_ID#
		, FNL_USR_ID = #FNL_USR_ID#
		, FNL_DEAL_DPT_CD =
		#FNL_DEAL_DPT_CD#
		,SUB_DPT_CD = #SUB_DPT_CD#
		,SUB_INN_RANK_CD = #SUB_INN_RANK_CD#
		,PBSVT_NO = #PBSVT_NO#
		,GEN_ADMN_DVSN_CD = #GEN_ADMN_DVSN_CD#
		<isNotNull prepend="," property="DOC_ID">
			DOC_ID = #DOC_ID#
		</isNotNull>
		<isNotNull prepend="," property="USR_ID">
			USR_ID = #USR_ID#
		</isNotNull>
		<isNotNull prepend="," property="USR_NAM">
			USR_NAM = #USR_NAM#
		</isNotNull>
		<isNotNull prepend="," property="RANK_CD">
			RANK_CD = #RANK_CD#
		</isNotNull>
		<isNotNull prepend="," property="PST_CD">
			PST_CD = #PST_CD#
		</isNotNull>
		<isNotNull prepend="," property="DPT_CD">
			DPT_CD = #DPT_CD#
		</isNotNull>
		<isNotNull prepend="," property="RQS_STA_CD">
			RQS_STA_CD = #RQS_STA_CD#
		</isNotNull>
		<isNotNull prepend="," property="TNB">
			TNB = #TNB#
		</isNotNull>
		<isNotNull prepend="," property="EIN">
			EIN = #EIN#
		</isNotNull>
		<isNotNull prepend="," property="EML_AD">
			EML_AD =#EML_AD#
		</isNotNull>
		<isNotNull prepend="," property="USR_DVSN_CD">
			USR_DVSN_CD = #USR_DVSN_CD#
		</isNotNull>
		<isNotNull prepend="," property="RQS_TXT">
			RQS_TXT = #RQS_TXT#
		</isNotNull>
		
		<isNotNull property="RQS_INS_DVSN_CD">
			<isNotNull prepend="," property="RQS_STA_CD">
				RLS_DT =
				TO_CHAR(SYSDATE,'yyyymmdd')
			</isNotNull>
		</isNotNull>
		
		<isNotNull prepend="," property="LOGIN_WAY_CD">
			LOGIN_WAY_CD =
			#LOGIN_WAY_CD#
		</isNotNull>
		
		<isNotNull prepend="," property="INN_RANK_CD">
			INN_RANK_CD =
			#INN_RANK_CD#
		</isNotNull>
		<isNotNull prepend="," property="HOM_TNB">
			HOM_TNB =
			#HOM_TNB#
		</isNotNull>
		<!-- 2015.01.27 박재운 감사관 : 실부서코드 수정 가능하도록 요청 -->
		<isNotNull prepend="," property="RAL_BLT_DIV_CD">
			RAL_BLT_DIV_CD = #RAL_BLT_DIV_CD#
		</isNotNull>
		
		<isNotNull prepend="," property="FAN">
			FAN = #FAN#
		</isNotNull>
		
		<isNotNull prepend="," property="CAR_NO">
			CAR_NO = REPLACE(#CAR_NO#,' ','') /*입력시 공백제거*/
		</isNotNull>
		<isNotNull prepend="," property="WRK_STR_DT">
			WRK_STR_DT = #WRK_STR_DT#
		</isNotNull>
		<isNotNull prepend="," property="WRK_END_DT">
			WRK_END_DT = #WRK_END_DT#
		</isNotNull>
		
		<!-- 출장여비계좌관리 정보 추가 - 2017.04.06 yyh -->
		<isNotNull prepend="," property="BZT_TREXP_RCIT_BNK_CD">
			BZT_TREXP_RCIT_BNK_CD = #BZT_TREXP_RCIT_BNK_CD# 
		</isNotNull>		
		<isNotNull prepend="," property="BZT_TREXP_RCIT_EAN">
			BZT_TREXP_RCIT_EAN = #BZT_TREXP_RCIT_EAN#
		</isNotNull>
		<!-- 담당직무 추가 - 2018.01.15 EUNOK -->
		<isNotNull prepend="," property="CHR_DTY_NM">
			CHR_DTY_NM = #CHR_DTY_NM#
		</isNotNull>
		<!-- 로그인잠금여부 추가 - 2020.10.07 EUNOK -->
		<isNotEmpty prepend="," property="IS_LOCK">
			<isEqual property="IS_LOCK" compareValue="N">
				IS_LOCK = #IS_LOCK#
				,LOGIN_FAIL_COUNT = '0'
			</isEqual>
			<isNotEqual property="IS_LOCK" compareValue="N">
				IS_LOCK = #IS_LOCK#
				,LOGIN_FAIL_COUNT = '3'
			</isNotEqual>
		</isNotEmpty>
		<!-- 휴면계정여부 추가 - 2021.07.12 EUNOK -->
		<isNotEmpty prepend="," property="INACTIVE">
			<isEqual property="INACTIVE" compareValue="N">
				INACTIVE = #INACTIVE#
				,INACTIVE_DH = NULL
			</isEqual>
			<isNotEqual property="INACTIVE" compareValue="N">
				INACTIVE = #INACTIVE#
				,INACTIVE_DH =  TO_CHAR(SYSDATE,'YYYYMMDD')
			</isNotEqual>
		</isNotEmpty>
		WHERE 1 = 1
		AND CNB = #CNB#
		;
		INSERT INTO TBDCMACM037H
		(     CON_NO
		    , CON_USE_YN			
			, CNB				
			, USR_ID			
			, USR_NAM			
			, RANK_CD			
			, PST_CD			
			, DPT_CD			
			, TNB				
			, EIN				
			, EML_AD			
			, USR_DVSN_CD		
			, RQS_TXT			
			, DOC_ID			
			, DOC_TYP_CD		
			, BAI_USR_YN		
			, ORG_CD	 		
			, ACP_DT	 		
			, ZCD	     		
			, AD	     		
			, DTL_AD			
			, ROAD_NM_AD		
			, ROAD_NM_DTL_AD	
			, RAL_BLT_DIV_CD	
			, OCP_CD			
			, PS_CD				
			, PS_DT				
			, RSG_DT			
			, CRNT_RANK_APM_DT	
			, APM_DVSN_CD		
			, RSD_ZCD			
			, HOM_TNB			
			, WOK_DVSN_CD		
			, CRNT_DPT_APM_DT	
			, VAC_YN			
			, RQR_ID			
			, RQS_DT			
			, RQS_STA_CD		
			, INN_RANK_CD		
			, DPT_DT			
			, BZT_YN			
			, RANK_SRT_SEQ_NM	
			, SRT_KY_NO			
			, RLS_DT			
			, RANK_CD_2			
			, RANK_NM_2			
			, DNV_INF		
			, LOGIN_WAY_CD		
			, ESN				
			, TMP_YN			
			, FNL_CHG_DT		
			, CHG_APT_DT		
			, FRT_USR_ID		
			, FNL_USR_ID		
			, FNL_DEAL_DPT_CD	
			, FNL_MNU_ID		
			, FRT_REGI_DH		
			, FNL_MDF_DH		
			)
	   SELECT 
			( (SELECT NVL(MAX(CON_NO),0)+1 FROM TBDCMACM037H)) AS CON_NO /* 연계번호 */
			, 'N' AS CON_USE_YN
			, CNB				/*전산번호(PK)       */
			, USR_ID				/*사용자ID           */
			, USR_NAM				/*사용자성명         */
			, RANK_CD				/*직급코드           */
			, PST_CD				/*직위코드           */
			, DPT_CD				/*부서코드           */
			, TNB					/*전화번호           */
			, EIN					/*암호화주민등록번호 */
			, EML_AD				/*이메일주소         */
			, USR_DVSN_CD			/*사용자구분코드     */
			, RQS_TXT				/*요청내용           */
			, DOC_ID				/*문서ID             */
			, DOC_TYP_CD			/*문서유형코드       */
			, BAI_USR_YN			/*감사원사용자여부   */
			, ORG_CD	 			/*기관코드           */
			, ACP_DT	 			/*접수일             */
			, '' ZCD	     			/*우편번호           */
			, AD	     			/*주소               */
			, '' DTL_AD				/*상세주소           */
			, '' ROAD_NM_AD			/*도로명주소         */
			, '' ROAD_NM_DTL_AD		/*도로명상세주소     */
			, RAL_BLT_DIV_CD		/*실소속과코드       */
			, OCP_CD				/*직종코드           */
			, PS_CD				    /*호봉코드           */
			, ''				    /*호봉일             */
			, RSG_DT				/*퇴직일             */
			, CRNT_RANK_APM_DT	    /*현직급임용일       */
			, APM_DVSN_CD			/*임용구분코드       */
			, RSD_ZCD				/*거주지우편번호     */
			, HOM_TNB				/*자택전화번호       */
			, WOK_DVSN_CD			/*재직구분코드       */
			, CRNT_DPT_APM_DT		/*현부서임용일       */
			, VAC_YN				/*휴가여부           */
			, RQR_ID				/*요청자ID           */
			, RQS_DT				/*요청일             */
			, RQS_STA_CD			/*요청상태코드       */
			, INN_RANK_CD			/*내부직급코드       */
			, DPT_DT				/*부서일             */
			, BZT_YN				/*출장여부           */
			, RANK_SRT_SEQ_NM		/*직급정렬순서명     */
			, SRT_KY_NO			    /*정렬키번호         */
			, RLS_DT				/*해제일             */
			, RANK_CD_2			    /*직급코드2          */
			, RANK_NM_2			    /*직급명2            */
			, DNV_INF				/*정보               */
			, LOGIN_WAY_CD		    /*로그인방법코드     */
			, ESN					/*암호화비밀번호     */
			, TMP_YN				/*임시여부           */
			, FNL_CHG_DT			/*최종변경일         */
			, CHG_APT_DT			/*변경예정일         */
			, #FNL_USR_ID# AS FRT_USR_ID 			/*최초사용자ID       */
			, #FNL_USR_ID# AS FNL_USR_ID			/*최종사용자ID       */
			, #FNL_DEAL_DPT_CD# AS FNL_DEAL_DPT_CD 		/*최종거래부서코드   */
			, #FNL_MNU_ID# AS FNL_MNU_ID			/*최종메뉴ID         */
			, SYSDATE AS FRT_REGI_DH			/*최초등록일시       */
			, SYSDATE AS FNL_MDF_DH			/*최종수정일시       */
		FROM TBDCMACM001M
	   WHERE CNB = #CNB#;
	   END;
	</update>

	<!-- 사용자 delete -->
	<delete id="dcmacm001UsrMgDelete" parameterClass="paramMap">
	DECLARE
	  BEGIN
		DELETE
		TBDCMACM001M
		WHERE 1 = 1
		AND CNB = #CNB#;
		
		INSERT
				INTO
				TBDCMACM038H
				(
				  CNB
				, CON_NO 
				, CON_HNDL_DVSN_CD
				, USE_YN
				
				, FRT_USR_ID		
				, FRT_REGI_DH
				, FNL_MNU_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MDF_DH
				) VALUES
				(
				  #CNB#
				, (	SELECT NVL(MAX(CON_NO),0)+1  AS CON_NO
					  FROM TBDCMACM038H
			       ) 
			    , 'D'
				, 'N'
				
				, #FRT_USR_ID#			
				, SYSDATE
				, #FNL_MNU_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, SYSDATE
				);
			END;
	</delete>

	<!-- 사용자 delete 시 비밀번호이력 -->
	<delete id="dcmacm001PwdDelete" parameterClass="paramMap">
		DELETE
		TBDCMACM028L
		WHERE 1 = 1
		AND CNB = #CNB#
	</delete>

	<!-- 사용자 delete 시 비밀번호변경이력 삭제 -->
	<delete id="dcmacm001PwdHstDelete" parameterClass="paramMap">
		DELETE
		TBDCMACM029H
		WHERE 1 = 1
		AND CNB = #CNB#
	</delete>




	<!--사용자 아이디 유무 체크 -->
	<select id="dcmacm001UsrIdCheck" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
       SELECT USR_ID
           FROM TBDCMACM001M
         WHERE 1=1
         AND USR_ID =#strUsrId#
          ]]>
	</select>


	<!-- 사용자전산번호 max+1 -->
	<select id="dcmacm001UsrCnbMax" parameterClass="paramMap"
		resultClass="java.lang.String">
	<isEqual property="strUsrDvsn" compareValue="7">
	    <![CDATA[
         SELECT LPAD(MAX(NVL(TRANSLATE(CNB, '0123456789' || CNB, '0123456789'), 0)) + 1, 4, 0) AS CNB 
           FROM TBDCMACM001M
          WHERE 1 = 1
        ]]> 	    
	    	AND  SUBSTR(CNB,0,1) <![CDATA[ <= ]]> CASE WHEN SUBSTR(UPPER(#USR_ID#),0,4) = 'TEST' THEN '7' ELSE '4' END 	    
	</isEqual>
	<isNotEqual property="strUsrDvsn" compareValue="7">
    	<![CDATA[
	     SELECT MIN(CNB) AS CNB
		   FROM ( 
			        SELECT TO_CHAR(LEVEL+(#strUsrDvsn#||'000')) CNB
			          FROM DUAL
			    CONNECT BY LEVEL <= 999
		        ) 
		  WHERE CNB NOT IN (
			                    SELECT CNB
			                      FROM TBDCMACM001M
			                     WHERE CNB LIKE #strUsrDvsn#||'%' 
		                   )
		 ]]>
	</isNotEqual>	
	</select>

	<!-- 사용자비밀번호 재설정[주민번호뒷자리] -->
	<update id="dcmacm001UsrPwdUpdate" parameterClass="paramMap">
		UPDATE TBDCMACM001M
		SET
		FNL_CHG_DT = TO_CHAR(SYSDATE,'yyyymmdd')
		, ESN=#PWD#
		, TMP_YN = 'n'
		,
		FNL_MDF_DH = SYSDATE
		, FNL_USR_ID = #FNL_USR_ID#
		, FNL_DEAL_DPT_CD =#FNL_DEAL_DPT_CD#
		, FNL_MNU_ID = #FNL_MNU_ID#
		
		WHERE CNB=#CNB#
	</update>

	<!-- 사용자비밀번호변경이력 -->
	<insert id="dcmacm001UsrPwdHstInsert" parameterClass="paramMap">
		INSERT INTO
		TBDCMACM029H
		(
		HST_DH
		, HST_DVSN_CD
		, HST_SNO
		, CNB
		, ESN
		, TMP_YN
		,
		FNL_CHG_DT
		, CHG_APT_DT

		, FNL_MNU_ID
		, FRT_USR_ID
		, FNL_USR_ID
		,
		FNL_DEAL_DPT_CD
		, FRT_REGI_DH
		,
		FNL_MDF_DH
		)
		VALUES
		(
		SYSDATE
		, #HST_DVSN_CD#
		, #HST_SNO#
		, #CNB#
		, #PWD#
		, #TMP_YN#
		,
		TO_CHAR(SYSDATE,'yyyymmdd')
		,
		#CHG_APT_DT#

		, #FNL_MNU_ID#
		, #FNL_USR_ID#
		, #FNL_USR_ID#
		,
		#FNL_DEAL_DPT_CD#
		, SYSDATE
		, SYSDATE
		)
	</insert>
	<!-- 사용자비밀번호내역 신규 -->
	<insert id="dcmacm001UsrPwdInsert" parameterClass="paramMap">
		INSERT INTO
		TBDCMACM028L
		(
		CNB
		, ESN
		, TMP_YN
		, FNL_CHG_DT
		, CHG_APT_DT

		, FNL_MNU_ID
		,
		FRT_USR_ID
		, FNL_USR_ID
		, FNL_DEAL_DPT_CD
		, FRT_REGI_DH
		,
		FNL_MDF_DH
		)
		VALUES
		(
		#CNB#
		, #ESN#
		, #TMP_YN#
		, TO_CHAR(SYSDATE,'yyyymmdd')
		,
		#CHG_APT_DT#

		, #FNL_MNU_ID#
		, #FNL_USR_ID#
		, #FNL_USR_ID#
		,
		#FNL_DEAL_DPT_CD#
		, SYSDATE
		, SYSDATE
		)
	</insert>



	<select id="dcmacm001PwdHstSnoMax" parameterClass="paramMap"
		resultClass="java.lang.String">
	<![CDATA[
          SELECT NVL(MAX(HST_SNO),0)+1 AS CNB 
           FROM TBDCMACM029H
           WHERE HST_DH = SYSDATE
          ]]>
	</select>


	<!-- 사용자조회 팝업 -->
	<select id="dcmacm006UsrSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
       SELECT A.USR_DVSN_CD
            , A.ORG_CD
            , F_ORG_INFO(A.ORG_CD,'1') AS ORG_NM
            , A.CNB
            , A.DPT_CD
            , F_DPT_INFO(A.DPT_CD,'1') AS DPT_NM
            , A.USR_ID 
            , A.USR_NAM
            , A.RQS_STA_CD
            , A.RLS_DT
            , A.TNB
            , A.RANK_CD
            , F_CODE_NM('1000173',A.RANK_CD) AS RANK_NM
            , A.PST_CD
            , F_CODE_NM('1000176',A.PST_CD)  AS PST_NM
            , A.EIN
            , SUBSTR(A.EIN,0,6)||'-*******' AS P_EIN
            
            , A.EML_AD
            , A.USR_DVSN_CD
            , F_CODE_NM('1000338',A.USR_DVSN_CD) AS USR_DVSN_NM
            
            , A.BAI_USR_YN
            , '' ZCD
            , A.APM_DVSN_CD
            , A.HOM_TNB
            /*, F_DPT_INFO(A.DPT_CD, '3')  AS DEP_RGN_CD 2016.06.30*/
            , F_CODE_NM('1000029', F_DPT_INFO(A.DPT_CD, '3')) AS DEP_RGN_NM 
            , A.PS_CD
            , F_CODE_NM('1000177',A.PS_CD) AS PS_NM
     		, A.RAL_BLT_DIV_CD
     		, F_CODE_NM ('1000144',A.RAL_BLT_DIV_CD) AS RAL_BLT_DIV_NM
            , A.DOC_ID  
           , D2.FILE_NAME AS IMG_FILE_NAME   
         FROM TBDCMACM001M A, ECM_FILE_LIST_VIEW2 D2
         WHERE 1=1
           AND A.DOC_ID = D2.DOC_ID(+)
          ]]>

		<isNotEmpty property="strUsrNam">
			AND (A.USR_NAM LIKE '%' ||#strUsrNam#|| '%' OR
				A.USR_ID LIKE #strUsrNam#||'%' OR
				A.CNB LIKE #strUsrNam#||'%')
		</isNotEmpty>	
		<isNotEmpty property="strWrkDvsnCd">
			AND A.RQS_STA_CD = #strWrkDvsnCd#
		</isNotEmpty>
		<isNotEmpty property="strUsrDvsn">
			AND A.USR_DVSN_CD = #strUsrDvsn#
		</isNotEmpty>
		<isNotEmpty property="strUsrDptAuth">
			AND A.DPT_CD IN ( SELECT DPT_CD FROM TABLE(F_AUTH_DEPT(#strUsrCnb#, #strUsrDptAuth#, 'Y')))
		</isNotEmpty>
		<isNotEmpty property="strDptCd">
			AND A.DPT_CD = #strDptCd#
		</isNotEmpty>
	</select>

	<!-- 사용자관리부서 조회 -->

	<select id="dcmacm006UsrDptSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
       SELECT CNB
            , DPT_CD 
            , F_DPT_INFO(DPT_CD,'1') AS DPT_NM
         FROM TBDCMACM003L 
         WHERE 1=1
           AND CNB = #strUsrCnb#
          ]]>

	</select>
	<!-- 사용자관리부서 신규 -->
	<insert id="dcmacm001UsrDptInsert" parameterClass="paramMap">
		INSERT INTO
		TBDCMACM003L
		(
		CNB
		, DPT_CD
		, FRT_USR_ID
		, FNL_USR_ID
		, FNL_DEAL_DPT_CD
		,
		FNL_MNU_ID
		,
		FNL_MDF_DH
		, FRT_REGI_DH

		)
		VALUES
		(
		#CNB#
		, #DPT_CD#

		,
		#FRT_USR_ID#
		, #FNL_USR_ID#
		, #FNL_DEAL_DPT_CD#
		, #FNL_MNU_ID#
		, SYSDATE
		,
		SYSDATE

		)
	</insert>

	<!-- 사용자관리부서 수정 -->
	<update id="dcmacm001UsrDptUpdate" parameterClass="paramMap">
		UPDATE
		TBDCMACM003L
		SET CNB = #CNB#
		, DPT_CD = #DPT_CD#
		, FNL_MDF_DH = SYSDATE
		,
		FNL_MNU_ID = #FNL_MNU_ID#
		, FNL_USR_ID = #FNL_USR_ID#
		, FNL_DEAL_DPT_CD
		= #FNL_DEAL_DPT_CD#
		WHERE 1 = 1
		AND CNB = #CNB#
		AND
		DPT_CD=#DPT_CD#

	</update>

	<!-- 사용자 관리부서 delete -->
	<delete id="dcmacm001UsrDptDelete" parameterClass="paramMap">
		DELETE
		TBDCMACM003L
		WHERE 1 = 1
		AND CNB = #CNB#
		<isNotEmpty property="DPT_CD">
		AND DPT_CD =#DPT_CD#
		</isNotEmpty>
	</delete>



	<select id="dcmacm001UsrEnrGrpSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
      SELECT A.USR_ID, A.USR_NAM, C.GROUP_ID, C.GROUP_NAME, C.GROUP_DESC
       FROM TBDCMACM001M A
  	      , GROUP_USER B
  	      , GROUP_INFO C
      WHERE A.CNB = #strUsrCnb#
        AND A.USR_ID = B.USER_ID
        AND B.GROUP_ID = C.GROUP_ID
          ]]>
	</select>
	<select id="dcmacm004UsrEnrRolSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
   SELECT A.USR_ID, A.USR_NAM, C.ROLE_ID, C.ROLE_NAME, C.ROLE_DESC
     FROM TBDCMACM001M A
        , ROLE_USER B
  	    , ROLE_INFO C
    WHERE A.USR_ID = B.USER_ID
      AND B.ROLE_ID = C.ROLE_ID
      AND  A.CNB = #strUsrCnb#
          ]]>

	</select>
	<!-- 우편번호 -->
	<select id="dcmacm034ZipCodeMgrSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
        SELECT ZCD
             , ZCD_SRNO
             , PRV_NM
             , CITY_NM
             , TWN_NM
             , ROAD_NM
             , UDG_YN
             , BULD_NO_MAIN_NO
             , BULD_NO_SU_NO
             , CITY_BULD_NM
             , LD_CD
             , LD_NM
             , RI_NM
             , MNTN_YN
             , ALN_MAIN_NO
             , TWN_SRNO
             , ALN_SU_NO
               
         FROM TBDCMACM020L
         WHERE 1=1
          ]]>
		<isNotEmpty property="strName">
			AND (LD_NM LIKE #strName#||'%' OR
			TWN_NM LIKE #strName#||'%' OR RI_NM
			LIKE #strName#||'%' OR ROAD_NM
			LIKE #strName#||'%'
			OR CITY_BULD_NM LIKE '%'||#strName#||'%'
			 )
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="strZcd">
			ZCD LIKE
			'%'||#strZcd#||'%'
		</isNotEmpty>
	</select>

	<select id="dcmacm035ZipCodeSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<include refid="include.pageSelct" />
	<![CDATA[
	
         SELECT PRV_NM ||' '|| CITY_NM ||' '|| ROAD_NM ||' '||BULD_NO_MAIN_NO AS ROAD_DTL_AD          
              , PRV_NM ||' '|| CITY_NM || NVL2(TWN_NM,' ' || TWN_NM, '')||' '||NVL2(RI_NM,'' || RI_NM, '') ||LD_NM ||' '||ALN_MAIN_NO AS AD 
              , ZCD
              , SUBSTR(ZCD,1,3) 										AS ZCD1	
          	  , SUBSTR(ZCD,4,3) 										AS ZCD2
          	
           FROM TBDCMACM020L
          WHERE 1=1
           
                
          ]]>
		<isNotEmpty property="strName">
			AND (LD_NM LIKE #strName#||'%' OR
			TWN_NM LIKE #strName#||'%' OR RI_NM
			LIKE #strName#||'%' OR ROAD_NM
			LIKE #strName#||'%'
			OR CITY_BULD_NM LIKE '%'||#strName#||'%' )
		</isNotEmpty>
		<include refid="include.pageOrder" />
	</select>



	<!-- 결재구분 조회 -->
	<select id="dcmacm041ApprBizDivSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
        SELECT APV_DVSN_CD
            , TSK_CAT_CD
            , FUNC_CAT_CD||TSK_CAT_CD AS FUNC_CAT_CD
            , APV_DVSN_NM
            , SUB_PAE_RUT_NM
            , SVC_NM
            , APV_MTD_NM
            , SBM_MTD_NM
         FROM TBDCMACM021M
        WHERE 1=1
        ORDER BY APV_DVSN_CD
 
          ]]>

	</select>

	<!-- 우편번호 엑셀 신규 -->
	<insert id="dcmacm034ZcdInsert" parameterClass="paramMap">
		INSERT INTO
		TBDCMACM020L
		(
		ZCD
		, ZCD_SRNO
		, PRV_NM
		, PRV_ENG_NM
		, CITY_NM
		, CITY_ENG_NM
		,
		TWN_NM
		,
		TWN_ENG_NM
		, ROAD_NM_CD
		, ROAD_NM
		, ROAD_ENG_NM
		, UDG_YN
		,
		BULD_NO_MAIN_NO
		, BULD_NO_SU_NO
		, BULD_MNG_NO
		, CITY_BULD_NM
		, LD_CD
		,
		LD_NM
		, RI_NM
		,
		MNTN_YN
		, ALN_MAIN_NO
		, ALN_SU_NO
		, TWN_SRNO


		, FNL_MNU_ID
		,
		FRT_USR_ID
		, FNL_USR_ID
		, FNL_DEAL_DPT_CD
		, FRT_REGI_DH
		,
		FNL_MDF_DH
		)
		VALUES
		(

		#COL1# /*ZCD*/
		, #COL2# /*ZCD_SRNO*/
		, #COL3# /*PRV_NM*/
		, #COL4# /* PRV_ENG_NM*/
		, #COL5# /*CITY_NM*/
		, #COL6# /*CITY_ENG_NM*/
		, #COL7# /*TWN_NM*/
		, #COL8# /*TWN_ENG_NM*/
		, #COL9# /*ROAD_NM_CD*/
		,
		#COL10# /*ROAD_NM*/
		, #COL11# /*ROAD_ENG_NM*/
		, #COL12# /*UDG_YN*/
		, #COL13# /*BULD_NO_MAIN_NO*/
		, #COL14# /*BULD_NO_SU_NO*/
		, #COL15# /*BULD_MNG_NO*/
		, #COL16# /*CITY_BULD_NM*/
		, #COL17# /*LD_CD*/
		, #COL18# /*LD_NM*/
		, #COL19# /*RI_NM*/
		, #COL20# /*MNTN_YN*/
		, #COL21# /*ALN_MAIN_NO*/
		, #COL22# /*ALN_SU_NO*/
		, #COL24# /*TWN_SRNO*/

		,
		#FNL_MNU_ID#
		, #FRT_USR_ID#
		, #FNL_USR_ID#
		, #FNL_DEAL_DPT_CD#
		, SYSDATE
		,
		SYSDATE

		)
	</insert>
	    <!-- 우편번호 엑셀 유무체크 -->
	<select id="dcmacm034ExelChk" parameterClass="paramMap"
		resultClass="java.lang.String">
	      SELECT COUNT(*) AS CNT
           FROM TBDCMACM020L
          WHERE 1=1
            AND ZCD             = #COL1#
            AND ZCD_SRNO        = #COL2#
            AND ROAD_NM_CD      = #COL9#
            AND UDG_YN          = #COL12#
            AND BULD_NO_MAIN_NO = #COL13#
            AND BULD_MNG_NO     = #COL15# 
            AND BULD_NO_SU_NO   = #COL14#
            AND LD_CD           = #COL17#
            AND MNTN_YN         = #COL20#
            AND ALN_MAIN_NO     = #COL21#
            AND TWN_SRNO        = #COL24#
            AND ALN_SU_NO       = #COL22#
    </select>
        <!-- 우편번호 엑셀 삭제 -->
    <delete id="dcmacm034ZcdDelete" parameterClass="paramMap">
	      DELETE
           FROM TBDCMACM020L
          WHERE 1=1
            AND ZCD             = #COL1#
            AND ZCD_SRNO        = #COL2#
            AND ROAD_NM_CD      = #COL9#
            AND UDG_YN          = #COL12#
            AND BULD_NO_MAIN_NO = #COL13#
            AND BULD_MNG_NO     = #COL15# 
            AND BULD_NO_SU_NO   = #COL14#
            AND LD_CD           = #COL17#
            AND MNTN_YN         = #COL20#
            AND ALN_MAIN_NO     = #COL21#
            AND TWN_SRNO        = #COL24#
            AND ALN_SU_NO       = #COL22#
    </delete>
    <!-- 우편번호 엑셀 수정 -->
    <update id="dcmacm034ZcdUpdate" parameterClass="paramMap">
      UPDATE TBDCMACM020L 
         SET
          ZCD              = #COL1#
		, ZCD_SRNO         = #COL2#
		, PRV_NM           = #COL3#
		, PRV_ENG_NM       = #COL4#
		, CITY_NM          = #COL5#
		, CITY_ENG_NM      = #COL6#
		, TWN_NM           = #COL7#
		, TWN_ENG_NM       = #COL8#
		, ROAD_NM_CD       = #COL9#
		, ROAD_NM          = #COL10#
		, ROAD_ENG_NM      = #COL11#
		, UDG_YN           = #COL12#
		, BULD_NO_MAIN_NO  = #COL13#
		, BULD_NO_SU_NO    = #COL14#
		, BULD_MNG_NO      = #COL15#
		, CITY_BULD_NM     = #COL16#
		, LD_CD            = #COL17#
		, LD_NM            = #COL18#
		, RI_NM            = #COL19#
		, MNTN_YN          = #COL20#
		, ALN_MAIN_NO      = #COL21#
		, ALN_SU_NO        = #COL22#
		, TWN_SRNO         = #COL24#
        , FNL_MDF_DH = SYSDATE
		, FNL_USR_ID = #FNL_USR_ID#
		, FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
		, FNL_MNU_ID = #FNL_MNU_ID# 
         
          WHERE 1=1
            AND ZCD             = #COL1#
            AND ZCD_SRNO        = #COL2#
            AND ROAD_NM_CD      = #COL9#
            AND UDG_YN          = #COL12#
            AND BULD_NO_MAIN_NO = #COL13#
            AND BULD_MNG_NO     = #COL15# 
            AND BULD_NO_SU_NO   = #COL14#
            AND LD_CD           = #COL17#
            AND MNTN_YN         = #COL20#
            AND ALN_MAIN_NO     = #COL21#
            AND TWN_SRNO        = #COL24#
            AND ALN_SU_NO       = #COL22#
            </update>
	<!-- 결재구분 신규 -->
	<insert id="dcmacm041ApprBizDivInsert" parameterClass="paramMap">
		INSERT
		INTO
		TBDCMACM021M
		(
		APV_DVSN_CD
		, TSK_CAT_CD
		, FUNC_CAT_CD
		, APV_DVSN_NM
		,
		SUB_PAE_RUT_NM
		, SVC_NM
		,
		APV_MTD_NM
		, SBM_MTD_NM
		,FNL_MNU_ID
		, FRT_USR_ID
		,
		FNL_USR_ID
		,
		FNL_DEAL_DPT_CD
		, FRT_REGI_DH
		, FNL_MDF_DH
		)
		VALUES
		(
		#APV_DVSN_CD#
		, #TSK_CAT_CD#
		, #FUNC_CAT_CD#
		, #APV_DVSN_NM#
		,
		#SUB_PAE_RUT_NM#
		,
		#SVC_NM#
		, #APV_MTD_NM#
		, #SBM_MTD_NM#
		, #FNL_MNU_ID#
		,
		#FRT_USR_ID#
		,
		#FNL_USR_ID#
		, #FNL_DEAL_DPT_CD#
		, SYSDATE
		, SYSDATE

		)
	</insert>

	<update id="dcmacm041ApprBizDivUpdate" parameterClass="paramMap">
		UPDATE TBDCMACM021M
		SET APV_DVSN_CD = #APV_DVSN_CD#
		, FNL_MDF_DH =
		SYSDATE
		, FNL_USR_ID = #FNL_USR_ID#
		, FNL_DEAL_DPT_CD =
		#FNL_DEAL_DPT_CD#
		, FNL_MNU_ID = #FNL_MNU_ID#

		<isNotNull prepend="," property="TSK_CAT_CD">
			TSK_CAT_CD = #TSK_CAT_CD#
		</isNotNull>
		<isNotNull prepend="," property="FUNC_CAT_CD">
			FUNC_CAT_CD = #FUNC_CAT_CD#
		</isNotNull>

		<isNotNull prepend="," property="APV_DVSN_NM">
			APV_DVSN_NM = #APV_DVSN_NM#
		</isNotNull>

		<isNotNull prepend="," property="SUB_PAE_RUT_NM">
			SUB_PAE_RUT_NM =
			#SUB_PAE_RUT_NM#
		</isNotNull>

		<isNotNull prepend="," property="SVC_NM">
			SVC_NM = #SVC_NM#
		</isNotNull>
		<isNotNull prepend="," property="APV_MTD_NM">
			APV_MTD_NM = #APV_MTD_NM#
		</isNotNull>
		<isNotNull prepend="," property="SBM_MTD_NM">
			SBM_MTD_NM = #SBM_MTD_NM#
		</isNotNull>


		WHERE 1 = 1
		AND APV_DVSN_CD = #APV_DVSN_CD#

	</update>

	<!-- 결재구분 delete -->
	<delete id="dcmacm041ApprBizDivDelete" parameterClass="paramMap">
		DELETE
		TBDCMACM021M
		WHERE 1 = 1
		AND APV_DVSN_CD = #APV_DVSN_CD#
	</delete>

	<!-- 결재구분 사용여부 -->
	<select id="dcmacm041ApprBizChk" parameterClass="paramMap"
		resultClass="java.lang.String">
        <![CDATA[       
			SELECT COUNT(*) AS CNT
		
			FROM TBDCMACM022L
			WHERE 1=1
			  AND APV_DVSN_CD = #APV_DVSN_CD# 
        ]]>

	</select>


	<!-- 결재문서 - 내가 받은 문서 AND T23.APVR_CNB = #strUsrCnb# dcmacm043ApprDownDocumentSelect -->
	<select id="dcmacm043ApprDownDocumentSelect" parameterClass="paramMap"
		resultClass="resultMap">
		  SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
           <isEmpty  property="strFieldAuditYn">
           			,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     				WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     				WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			    /* 이행상황결재 추가 - 2018.03.28 yyh */
                                    WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                                FROM TBBADEAR002D
                                                                               WHERE APV_DOC_NO = T22.APV_DOC_NO)                                                                    
				     		ELSE '' END AS AUD_YR_NO
				     ,'' AS AUD_KND_NM
				     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                      
				     		ELSE '' END AS AUD_SBJ_NM
				     , '' as AUD_DOC_NM
				     , '' as MNG_DPT_NM
		   </isEmpty>
		   <isNotEmpty  property="strFieldAuditYn">
		   			,F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-') AS AUD_YR_NO
				     ,'' AS AUD_KND_NM
				     , AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')' AS AUD_SBJ_NM
				     , AD.AUD_DOC_NM
				     , '' AS MNG_DPT_NM
		   </isNotEmpty>
		   		, F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
            FROM (
                    SELECT DISTINCT D3.APV_DOC_NO
                         , D3.APV_DVSN_CD
                      FROM (
							   SELECT APV_DOC_NO,  /*기안한 문서는 반려, 상신취소, 상신완료*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
		                    	WHERE APVR_CNB = #strApvrCnb#
			                      AND APVR_SEQ = '1'
			                      AND APVR_STA_CD IN ('101','201','301')
			            	   UNION
			            	   SELECT APV_DOC_NO,  /*기안자가 아닌경우 결재처리(반려포함)한 문서 기준으로 조회, 협조는 진행문서함에 조회 하지 않는다.*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
		                    	WHERE APVR_CNB = #strApvrCnb#
			                      AND APVR_SEQ <![CDATA[ <> ]]> '1'
			                <isNotEqual property="strApvrCnb" compareValue="2381"> /*임시 조치*/
			                      AND APVR_KND_CD <![CDATA[ <> ]]> '4'
	                        </isNotEqual>
			                      AND SUBSTR(APVR_STA_CD,0,1) = '2'
		                       UNION
								SELECT L.APV_DOC_NO,  /*기안자가 아닌경우 결재한 이력이 있는 경우 문서를 볼수 있게 조회*/
								      L.APV_DVSN_CD
								 FROM TBDCMACM023L L
										 ,TBDCMACM023H H
								WHERE L.APV_DOC_NO = H.APV_DOC_NO
								  AND L.APVR_CNB = H.APVR_CNB
		                    	AND L.APVR_CNB = #strApvrCnb#
								  AND L.APVR_SEQ <![CDATA[ <> ]]> '1'
						    <isNotEqual property="strApvrCnb" compareValue="2381"> /*임시 조치*/
								  AND L.APVR_KND_CD <![CDATA[ <> ]]>'4' /*임시 조치*/
						    </isNotEqual>
								  AND SUBSTR(H.APVR_STA_CD,0,1) = '2'         
                          ) D3
                    
              			<isNotEmpty property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                              AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23
               , TBDCMACM022L T22
        <isNotEmpty  property="strFieldAuditYn">
			   , ( SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
		</isNotEmpty>
               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD
		<isNotEmpty  property="strFieldAuditYn">
		  	    AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
			    AND   T22.APV_DVSN_CD IN ('fieldAudit','badear001','AudExecPlanMng','fieldAuditMain')
	    <![CDATA[   
				AND T22.APV_STA_CD NOT IN ('3','4','5') /*진행중인 문서만 조회하도록 추가*/
                AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'            
         ]]>
	       UNION
   		  SELECT /*실지감사, 심의요청 대시보드의 결재대기함 건수 조회 시 소위원회 결과보고서 보고서를 포함하여 조회 되도록 추가*/
   		         T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
		       , '' AS AUD_YR_NO
		       , '' AS AUD_KND_NM
		       , '' AS AUD_SBJ_NM
		       , '' as AUD_DOC_NM
		       , '' as MNG_DPT_NM
		       , F_DPT_INFO (T22.APV_DPT_CD,'4') AS APV_DPT_NM
	        FROM TBDCMACM022L T22,
		  	   (
                SELECT DISTINCT D3.APV_DOC_NO
                     , D3.APV_DVSN_CD
                  FROM (
                           SELECT APV_DOC_NO,  /*기안한 문서는 반려, 상신취소, 상신완료*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
		                    	WHERE APVR_CNB = #strApvrCnb#
			                      AND APVR_SEQ = '1'
			                      AND APVR_STA_CD IN ('101','201','301')
			            	   UNION
			            	   SELECT APV_DOC_NO,  /*기안자가 아닌경우 결재처리(반려포함)한 문서 기준으로 조회, 협조는 진행문서함에 조회 하지 않는다.*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
		                    	WHERE APVR_CNB = #strApvrCnb#
			                      AND APVR_SEQ <![CDATA[ <> ]]> '1'
			                <isNotEqual property="strApvrCnb" compareValue="2381"> /*임시 조치*/
			                      AND APVR_KND_CD <![CDATA[ <> ]]> '4'
	                        </isNotEqual>
			                      AND SUBSTR(APVR_STA_CD,0,1) = '2' 
		                       UNION
								SELECT L.APV_DOC_NO,  /*기안자가 아닌경우 결재한 이력이 있는 경우 문서를 볼수 있게 조회*/
								      L.APV_DVSN_CD
								 FROM TBDCMACM023L L
										 ,TBDCMACM023H H
								WHERE L.APV_DOC_NO = H.APV_DOC_NO
								  AND L.APVR_CNB = H.APVR_CNB
		                    	AND L.APVR_CNB = #strApvrCnb#
								  AND L.APVR_SEQ <![CDATA[ <> ]]> '1'
						    <isNotEqual property="strApvrCnb" compareValue="2381"> /*임시 조치*/
								  AND L.APVR_KND_CD <![CDATA[ <> ]]>'4' /*임시 조치*/
						    </isNotEqual>
								  AND SUBSTR(H.APVR_STA_CD,0,1) = '2'       
                      ) D3
	              ) T23,
		       TBBADFRE103M T103M
		 WHERE T22.APV_DOC_NO = T23.APV_DOC_NO
		   AND T22.APV_DVSN_CD = T23.APV_DVSN_CD
		   AND T22.APV_DOC_NO = T103M.APV_RQS_ID
		   AND T22.APV_DVSN_CD IN ('requestAudit5', 'requestAudit6')
		   AND T103M.RPRT_CD IN ('D10300200','D10300600','D10300700','E10200200','E10300150','E10300400','E10500200','D10200700','E10400500')   
		</isNotEmpty>
		<isEmpty  property="strFieldAuditYn">
	  	    <isNotEmpty prepend="AND" property="strApvDvsnCd">
				<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
					T22.APV_DVSN_CD IN ('fieldAudit','badear001','fieldAuditMain')
				</isEqual>
				<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
					T22.APV_DVSN_CD =
					#strApvDvsnCd#
				</isNotEqual>
			</isNotEmpty>
		</isEmpty>  
		<![CDATA[   
				AND T22.APV_STA_CD NOT IN ('3','4','5') /*진행중인 문서만 조회하도록 추가*/
                AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'            
         ]]>
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		ORDER BY T22.APV_STA_CD, T22.SBM_DH ASC
	</select>

<select id="dcmacm043ApprDownDocumentSelect2" parameterClass="paramMap"
		resultClass="resultMap">
		 SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
           		,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-')
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			/* 이행상황결재 추가 - 2018.03.28 yyh */
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                            FROM TBBADEAR002D
                                                                           WHERE APV_DOC_NO = T22.APV_DOC_NO)	                                                                    
				     		ELSE NULL END AS AUD_YR_NO
				     ,'' AS AUD_KND_NM
				     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')'
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                     
				     		ELSE NULL END AS AUD_SBJ_NM
				     , AD.AUD_DOC_NM
				     , '' AS MNG_DPT_NM
				     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
            FROM (
                    SELECT DISTINCT D3.APV_DOC_NO
                         , D3.APV_DVSN_CD
                      FROM (
							   SELECT APV_DOC_NO,  /*기안한 문서는 반려, 상신취소, 상신완료*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
		                    	WHERE APVR_CNB = #strApvrCnb#
			                      AND APVR_SEQ = '1'
			                      AND APVR_STA_CD IN ('101','201','301')
			                      <isEqual property="strMenuId" compareValue="DCMACM040Q">
							    	 AND APVR_PST_CD = '0055700'
							    </isEqual>
			            	   UNION
			            	   SELECT APV_DOC_NO,  /*기안자가 아닌경우 결재처리(반려포함)한 문서 기준으로 조회, 협조는 진행문서함에 조회 하지 않는다.*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
		                    	WHERE APVR_CNB = #strApvrCnb#
			                      AND APVR_SEQ <![CDATA[ <> ]]> '1'
			                <isNotEqual property="strApvrCnb" compareValue="2381"> /*임시 조치*/
			                      AND APVR_KND_CD <![CDATA[ <> ]]> '4'
	                        </isNotEqual>
			                      AND SUBSTR(APVR_STA_CD,0,1) = '2'
			                <isEqual property="strMenuId" compareValue="DCMACM040Q">
						    	 AND APVR_PST_CD = '0055700'
						    </isEqual>
		                       UNION
								SELECT L.APV_DOC_NO,  /*기안자가 아닌경우 결재한 이력이 있는 경우 문서를 볼수 있게 조회*/
								      L.APV_DVSN_CD
								 FROM TBDCMACM023L L
										 ,TBDCMACM023H H
								WHERE L.APV_DOC_NO = H.APV_DOC_NO
								  AND L.APVR_CNB = H.APVR_CNB
		                    	AND L.APVR_CNB = #strApvrCnb#
								  AND L.APVR_SEQ <![CDATA[ <> ]]> '1'
						    <isNotEqual property="strApvrCnb" compareValue="2381"> /*임시 조치*/
								  AND L.APVR_KND_CD <![CDATA[ <> ]]>'4' /*임시 조치*/
						    </isNotEqual>
						    <isEqual property="strMenuId" compareValue="DCMACM040Q">
						    	 AND L.APVR_PST_CD = '0055700'
						    </isEqual>
								  AND SUBSTR(H.APVR_STA_CD,0,1) = '2' 
                          ) D3
                    
              			<isNotEmpty property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                              AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23
               , TBDCMACM022L T22
			   , ( SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM  AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD
                AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
		<isEqual  property="strFieldAuditYn" compareValue="Y">
			    AND   T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain','requestAudit1','requestAudit2','requestAudit3','requestAudit4','requestAudit5','requestAudit6','requestAudit7','requestAudit8','badear001','DspRqClosingSend','AudExecPlanMng')
		</isEqual>
		<isEqual  property="strFieldAuditYn" compareValue="N">
		  	    AND   T22.APV_DVSN_CD NOT IN ('fieldAudit','fieldAuditMain','requestAudit1','requestAudit2','requestAudit3','requestAudit4','requestAudit5','requestAudit6','requestAudit7','requestAudit8','DspRqClosingSend','AudExecPlanMng')
		</isEqual>  
		<![CDATA[   
				AND T22.APV_STA_CD NOT IN ('3','4','5') /*진행중인 문서만 조회하도록 추가*/
                AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'            
         ]]>
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','badear001','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD =
				#strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
		ORDER BY T22.APV_STA_CD, T22.SBM_DH ASC
	</select>
	
	<!-- 결재문서 - 결재한문서 조회 -->
	<select id="dcmacm043FnlApprDownDocumentSelect" parameterClass="paramMap"
		resultClass="resultMap">
		  SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
           <isEmpty  property="strFieldAuditYn">
           ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
      				     	    /* 이행상황결재 추가 - 2018.03.28 yyh */
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                            FROM TBBADEAR002D
                                                                           WHERE APV_DOC_NO = T22.APV_DOC_NO)                                                                    
				     		ELSE '' END AS AUD_YR_NO
				     , '' as AUD_KND_NM
				     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     				WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     				WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                    WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								    /* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                    WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                                FROM TBBADEAR001M D1 
                                                                                    ,TBBADEAR002D D2
                                                                               WHERE D1.AUD_YR     = D2.AUD_YR
                                                                                 AND D1.AUD_NO     = D2.AUD_NO
                                                                                 AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                                 AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                      
				     		ELSE '' END AS AUD_SBJ_NM
				     , '' as AUD_DOC_NM
				     , '' as MNG_DPT_NM
		   </isEmpty>
		   <isNotEmpty  property="strFieldAuditYn">
		   ,F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-') AS AUD_YR_NO
				     , '' AS AUD_KND_NM
				     , AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')' AS AUD_SBJ_NM
				     , AD.AUD_DOC_NM
				     , '' AS MNG_DPT_NM
		   </isNotEmpty>
		   , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
            FROM (
                    SELECT DISTINCT D3.APV_DOC_NO
                         , D3.APV_DVSN_CD
                      FROM (SELECT APV_DOC_NO
                                  , APV_DVSN_CD
                              FROM TBDCMACM023L
                        	WHERE APVR_CNB = #strApvrCnb#
                        	AND	CASE WHEN APVR_KND_CD ='9' AND READ_YN = 'Y' AND APVR_STA_CD ='202' THEN '1'
                        		    WHEN APVR_KND_CD ='9' AND NVL(READ_YN,'N') = 'N' AND APVR_STA_CD ='202' THEN '0'
                        		    ELSE '1' END = '1'
                        	AND	    SUBSTR(APVR_STA_CD,0,1) IN ('2','4')
                        		    
                          ) D3
                    
              			<isNotEmpty property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                              AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23
               , TBDCMACM022L T22
        <isNotEmpty  property="strFieldAuditYn">
			   , (SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
		</isNotEmpty>
               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD
		<isNotEmpty  property="strFieldAuditYn">
		  	    AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
			    AND   T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain','badear001','AudExecPlanMng')
			    AND T22.APV_STA_CD IN ('3','4') /*승인된 문서만 조회하도록 추가*/
      			<![CDATA[  AND T22.SBM_CNB <> #strApvrCnb# ]]>
                AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'            
             UNION
   		   SELECT /*실지감사, 심의요청 대시보드의 결재대기함 건수 조회 시 소위원회 결과보고서 보고서를 포함하여 조회 되도록 추가*/
   		         T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
		       , '' AS AUD_YR_NO
		       , '' AS AUD_KND_NM
		       , '' AS AUD_SBJ_NM
		       , '' as AUD_DOC_NM
		       , '' as MNG_DPT_NM
		       , F_DPT_INFO (T22.APV_DPT_CD,'4') AS APV_DPT_NM
		       FROM TBDCMACM022L T22,
			  	   (
                    SELECT DISTINCT D3.APV_DOC_NO
                         , D3.APV_DVSN_CD
                      FROM (SELECT APV_DOC_NO
                                  , APV_DVSN_CD
                              FROM TBDCMACM023L
                        	WHERE APVR_CNB = #strApvrCnb#
                        	AND	CASE WHEN APVR_KND_CD ='9' AND READ_YN = 'Y' AND APVR_STA_CD ='202' THEN '1'
                        		    WHEN APVR_KND_CD ='9' AND NVL(READ_YN,'N') = 'N' AND APVR_STA_CD ='202' THEN '0'
                        		    ELSE '1' END = '1'
                        		    AND	    SUBSTR(APVR_STA_CD,0,1) IN ('2','4')
                          ) D3
                    
              			<isNotEmpty property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                              AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23,
			       TBBADFRE103M T103M
			 WHERE T22.APV_DOC_NO = T23.APV_DOC_NO
			   AND T22.APV_DVSN_CD = T23.APV_DVSN_CD
			   AND T22.APV_DOC_NO = T103M.APV_RQS_ID
			   AND T22.APV_DVSN_CD IN ('requestAudit5', 'requestAudit6')
			   AND T103M.RPRT_CD IN ('D10300200','D10300600','D10300700','E10200200','E10300150','E10300400','E10500200','D10200700','E10400500')   
		</isNotEmpty>
		<isEmpty  property="strFieldAuditYn">
		  	    <isNotEmpty prepend="AND" property="strApvDvsnCd">
					<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
						T22.APV_DVSN_CD IN ('fieldAudit','badear001','fieldAuditMain')
					</isEqual>
					<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
						T22.APV_DVSN_CD =
						#strApvDvsnCd#
					</isNotEqual>
				</isNotEmpty>
		</isEmpty>  
				AND T22.APV_STA_CD IN ('3','4') /*승인된 문서만 조회하도록 추가*/
      			<![CDATA[  AND T22.SBM_CNB <> #strApvrCnb# ]]>
                AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'            
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		ORDER BY T22.FNL_APV_DH DESC
	</select>
	
	<select id="dcmacm043FnlApprDownDocumentSelect2" parameterClass="paramMap"
		resultClass="resultMap">
		  SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
           ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-')
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
      				     			/* 이행상황결재 추가 - 2018.03.28 yyh */
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                            FROM TBBADEAR002D
                                                                           WHERE APV_DOC_NO = T22.APV_DOC_NO)                                                                    
				     		ELSE NULL END AS AUD_YR_NO
				     , '' AS AUD_KND_NM
				     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')'
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                      
				     		ELSE NULL END AS AUD_SBJ_NM
				     , AD.AUD_DOC_NM
				     , '' AS MNG_DPT_NM
				     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
            FROM (
                    SELECT DISTINCT D3.APV_DOC_NO
                         , D3.APV_DVSN_CD
                      FROM (SELECT APV_DOC_NO
                                  , APV_DVSN_CD
                              FROM TBDCMACM023L
                        	WHERE APVR_CNB = #strApvrCnb#
                        	AND	CASE WHEN APVR_KND_CD ='9' AND READ_YN = 'Y' AND APVR_STA_CD ='202' THEN '1'
                        		    WHEN APVR_KND_CD ='9' AND NVL(READ_YN,'N') = 'N' AND APVR_STA_CD ='202' THEN '0'
                        		    ELSE '1' END = '1'
                        		    AND	    SUBSTR(APVR_STA_CD,0,1) IN ('2','4')
                        		    <isEqual property="strMenuId" compareValue="DCMACM040Q">
							    	 AND APVR_PST_CD = '0055700'
							    </isEqual>
                          ) D3
                    
              			<isNotEmpty property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                              AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23
               , TBDCMACM022L T22
			   , (SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD
                AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
		<isEqual  property="strFieldAuditYn" compareValue="Y">
			    AND   T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain','requestAudit1','requestAudit2','requestAudit3','requestAudit4','requestAudit5','requestAudit6','requestAudit7','requestAudit8','badear001','DspRqClosingSend','AudExecPlanMng')
		</isEqual>
		<isEqual  property="strFieldAuditYn" compareValue="N">
		  	    AND   T22.APV_DVSN_CD NOT IN ('fieldAudit','fieldAuditMain','requestAudit1','requestAudit2','requestAudit3','requestAudit4','requestAudit5','requestAudit6','requestAudit7','requestAudit8','DspRqClosingSend','AudExecPlanMng')
		</isEqual>  
				AND T22.APV_STA_CD IN ('3','4') /*승인된 문서만 조회하도록 추가*/
      			<![CDATA[  AND T22.SBM_CNB <> #strApvrCnb# ]]>
                AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'            
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','badear001','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD =
				#strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
		ORDER BY T22.FNL_APV_DH DESC
	</select>
	
	
	<select id="dcmacm043FnlApprAllSelect" parameterClass="paramMap"
		resultClass="resultMap">
		  SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
           ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-')
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
      				     			/* 이행상황결재 추가 - 2018.03.28 yyh */
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                            FROM TBBADEAR002D
                                                                           WHERE APV_DOC_NO = T22.APV_DOC_NO)	                                                                    
				     		ELSE NULL END AS AUD_YR_NO
				     , '' AS AUD_KND_NM
				     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')'
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                        
				     		ELSE NULL END AS AUD_SBJ_NM
				     , AD.AUD_DOC_NM
				     , '' AS MNG_DPT_NM
				     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
            FROM (
                    SELECT DISTINCT D3.APV_DOC_NO
                         , D3.APV_DVSN_CD
                      FROM (SELECT APV_DOC_NO
                                  , APV_DVSN_CD
                              FROM TBDCMACM023L
                              WHERE SUBSTR(APVR_STA_CD,0,1) IN ('2','4')
                          ) D3
                    
              			<isNotEmpty property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                              AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23
               , TBDCMACM022L T22
			   , (SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD
                AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
				AND T22.APV_STA_CD IN ('3','4') /*승인된 문서만 조회하도록 추가*/
                AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'            
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD = #strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
		ORDER BY T22.FNL_APV_DH DESC
	</select>
	
	
	<!-- 결재문서 - 내가 올린 문서 WHERE SBN_CNB =#strUsrCnb# dcmacm043ApprUpDocumentSelect -->
	<select id="dcmacm044ApprUpDocumentSelect" parameterClass="paramMap"
		resultClass="resultMap">
	
        	  SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
             <isEmpty  property="strFieldAuditYn">
             ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     				WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     				WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
      				     			/* 이행상황결재 추가 - 2018.03.28 yyh */
                                    WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                                FROM TBBADEAR002D
                                                                               WHERE APV_DOC_NO = T22.APV_DOC_NO)                                                                    
				     		ELSE '' END AS AUD_YR_NO
				     , '' as AUD_KND_NM
				     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     				WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     				WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                    WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								    /* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                    WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                                FROM TBBADEAR001M D1 
                                                                                    ,TBBADEAR002D D2
                                                                               WHERE D1.AUD_YR     = D2.AUD_YR
                                                                                 AND D1.AUD_NO     = D2.AUD_NO
                                                                                 AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                                 AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                     
				     		ELSE '' END AS AUD_SBJ_NM
				     , '' as AUD_DOC_NM
				     , '' as MNG_DPT_NM
		     </isEmpty>
		     <isNotEmpty  property="strFieldAuditYn">
		     ,F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-') AS AUD_YR_NO
				     , '' AS AUD_KND_NM
				     , AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')' AS AUD_SBJ_NM
				     , AD.AUD_DOC_NM
				     , '' AS MNG_DPT_NM
		     </isNotEmpty>
		     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
            FROM (
                   SELECT D3.APV_DOC_NO,
		                  D3.APV_DVSN_CD
		             FROM ( SELECT APV_DOC_NO,
		                           APV_DVSN_CD
		                      FROM TBDCMACM023L
                        	   WHERE APVR_CNB = #strApvrCnb#
                               AND APVR_SEQ = 1 
                          ) D3
                    
              			<isNotEmpty  property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                               AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23
               , TBDCMACM022L T22
        <isNotEmpty  property="strFieldAuditYn">
			  , ( SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD, 
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
		</isNotEmpty>
               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO(+)
                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD(+)
               	AND  T22.SBM_CNB = #strApvrCnb#
                AND  T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959' 
                AND  T22.APV_STA_CD IN ('3','4')/* 승인된 문서만 조회하도록 추가*/           
	  <isNotEmpty  property="strFieldAuditYn">
			    AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
			    AND   T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain','badear001','AudExecPlanMng')
		  UNION
		   SELECT /*실지감사, 심의요청 대시보드의 결재대기함 건수 조회 시 소위원회 결과보고서 보고서를 포함하여 조회 되도록 추가*/
		         T22.APV_DOC_NO  
			   , T22.APV_DVSN_CD
			   , T22.TSK_KY_TXT
			   , T22.APV_STA_CD
			   , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
			   , T22.APV_TIT_NM
			   , T22.SBM_CNB
			   , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
			   , T22.SBM_DH
			   , T22.FNL_APV_CNB
			   , T22.FNL_APV_DH
			   , '' AS AUD_YR_NO
			   , '' AS AUD_KND_NM
			   , '' AS AUD_SBJ_NM
			   , '' as AUD_DOC_NM
			   , '' as MNG_DPT_NM
			   , F_DPT_INFO (T22.APV_DPT_CD,'4') AS APV_DPT_NM
			 FROM (
                   SELECT D3.APV_DOC_NO,
		                  D3.APV_DVSN_CD
		             FROM ( SELECT APV_DOC_NO,
		                           APV_DVSN_CD
		                      FROM TBDCMACM023L
                        	   WHERE APVR_CNB = #strApvrCnb#
                               AND APVR_SEQ = 1 
                          ) D3
                    
              			<isNotEmpty  property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                               AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23,
	             TBDCMACM022L T22,
	             TBBADFRE103M T103M
	         WHERE  T22.APV_DOC_NO =T23.APV_DOC_NO(+)
               AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD(+)
			   AND  T22.APV_DOC_NO = T103M.APV_RQS_ID
			   AND  T22.APV_DVSN_CD IN ('requestAudit5', 'requestAudit6')
			   AND  T103M.RPRT_CD IN ('D10300200','D10300600','D10300700','E10200200','E10300150','E10300400','E10500200','D10200700','E10400500')   
			   AND  T22.SBM_CNB = #strApvrCnb#
               AND  T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959' 
               AND  T22.APV_STA_CD IN ('3','4')/* 승인된 문서만 조회하도록 추가*/           
	  </isNotEmpty>
	  <isEmpty  property="strFieldAuditYn">
	  	  <isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','badear001','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD =
				#strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
	  </isEmpty>       
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD = #strApvSta#
		</isNotEmpty>
		ORDER BY T22.APV_STA_CD, T22.SBM_DH DESC
	</select>
	
	
	<!-- 결재문서 - 내가 올린 문서 WHERE SBN_CNB =#strUsrCnb# dcmacm043ApprUpDocumentSelect -->
	<select id="dcmacm044ApprUpDocumentSelect2" parameterClass="paramMap"
		resultClass="resultMap">
        	   SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
               ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-')
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
      				     		/* 이행상황결재 추가 - 2018.03.28 yyh */
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                            FROM TBBADEAR002D
                                                                           WHERE APV_DOC_NO = T22.APV_DOC_NO)	                                                                    
				     		ELSE NULL END AS AUD_YR_NO
				     , '' AS AUD_KND_NM
				     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')'
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                     
				     		ELSE NULL END AS AUD_SBJ_NM
				     , AD.AUD_DOC_NM
				     , '' AS MNG_DPT_NM
				     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
            FROM (
                   SELECT D3.APV_DOC_NO,
		                  D3.APV_DVSN_CD
		             FROM ( SELECT APV_DOC_NO,
		                           APV_DVSN_CD
		                      FROM TBDCMACM023L
                        	   WHERE APVR_CNB = #strApvrCnb#
                               AND APVR_SEQ = 1 
                          ) D3
              			<isNotEmpty  property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                               AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23
               , TBDCMACM022L T22
			  , ( SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD, 
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO(+)
                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD(+)
               	AND  T22.SBM_CNB = #strApvrCnb#
                AND  T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959' 
                /*AND  T22.APV_STA_CD = '3' 승인된 문서만 조회하도록 추가*/  
                AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)         
	  <isEqual  property="strFieldAuditYn" compareValue="Y">
		  AND   T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain','requestAudit1','requestAudit2','requestAudit3','requestAudit4','requestAudit5','requestAudit6','requestAudit7','requestAudit8','badear001','DspRqClosingSend','AudExecPlanMng','AudInfoSend3')
	  </isEqual>
	  <isEqual  property="strFieldAuditYn"  compareValue="N">
	  	  AND   T22.APV_DVSN_CD NOT IN ('fieldAudit','fieldAuditMain','requestAudit1','requestAudit2','requestAudit3','requestAudit4','requestAudit5','requestAudit6','requestAudit7','requestAudit8','DspRqClosingSend','AudExecPlanMng','AudInfoSend3')
	  </isEqual>       
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD = #strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','badear001','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD =
				#strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
		ORDER BY T22.SBM_DH DESC
	</select>
	
	<!-- 결재문서 - 내가 올린 문서 WHERE SBN_CNB =#strUsrCnb# dcmacm043ApprUpDocumentSelect -->
	<select id="dcmacm044ApprUpDocumentSelect2All" parameterClass="paramMap"
		resultClass="resultMap">
	
        	  SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
               ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-')
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
      				     		/* 이행상황결재 추가 - 2018.03.28 yyh */
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                            FROM TBBADEAR002D
                                                                           WHERE APV_DOC_NO = T22.APV_DOC_NO)	                                                                    
				     		ELSE NULL END AS AUD_YR_NO
				     , '' AS AUD_KND_NM
				     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')'
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                 WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                      
				     		ELSE NULL END AS AUD_SBJ_NM
				     , AD.AUD_DOC_NM
				     , '' AS MNG_DPT_NM
				     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
            FROM (
                   SELECT D3.APV_DOC_NO,
		                  D3.APV_DVSN_CD
		             FROM ( SELECT APV_DOC_NO,
		                           APV_DVSN_CD
		                      FROM TBDCMACM023L
                             WHERE APVR_CNB = #strApvrCnb#
                               AND APVR_SEQ = 1 
                          ) D3
                    
              			<isNotEmpty  property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                               AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23
               , TBDCMACM022L T22
			  , ( SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO(+)
                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD(+)
                AND  T22.SBM_CNB = #strApvrCnb#
                AND  T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959' 
              /*  AND  T22.APV_STA_CD = '3' 승인된 문서만 조회하도록 추가*/           
		  AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD = #strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD = #strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
		ORDER BY T22.APV_STA_CD, T22.SBM_DH DESC
	</select>
	
	<select id="dcmacm042FnlApprAllSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
	 SELECT T22.APV_DOC_NO
		     , T22.APV_DVSN_CD
		     , T22.TSK_KY_TXT
		     , T22.APV_STA_CD
		     , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
		     , T22.APV_TIT_NM
		     , T22.SBM_CNB
		     , F_USR_INFO(T22.SBM_CNB,'2') AS SBM_CNB_NM
		     , T22.SBM_DH
		     , T22.FNL_APV_CNB
		     , T22.FNL_APV_DH
		     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
		  FROM TBDCMACM022L T22/*, (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                                 , usr_nam
                                 , apvr_cnb
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                               AND  D2.USR_NAM LIKE '%'||'오갑주'||'%') D*/
                               
		  WHERE 1=1
		    AND T22.APV_STA_CD = '3' /*승인 문서만 조회하도록 추가*/
		  	]]>
		  	<isNotEmpty  property="strUsrNam">
             AND T22.APV_DOC_NO IN (SELECT APV_DOC_NO FROM TBDCMACM023L WHERE APVR_CNB IN (SELECT CNB FROM TBDCMACM001M WHERE USR_NAM LIKE '%' || #strUsrNam# || '%'))
			</isNotEmpty>
			<![CDATA[
		     AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'

			]]>
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
			T22.APV_DVSN_CD =
			#strApvDvsnCd#
		</isNotEmpty>
		
		ORDER BY T22.APV_STA_CD, T22.SBM_DH DESC
	</select>
	
	<select id="dcmacm042ApprAllSelect" parameterClass="paramMap"
		resultClass="resultMap">
		 SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
           		,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-')
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			/* 이행상황결재 추가 - 2018.03.28 yyh */
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                            FROM TBBADEAR002D
                                                                           WHERE APV_DOC_NO = T22.APV_DOC_NO)	                                                                    
				     		ELSE NULL END AS AUD_YR_NO
				     ,'' AS AUD_KND_NM
				     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')'
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                 WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                      
				     		ELSE NULL END AS AUD_SBJ_NM
				     , AD.AUD_DOC_NM
				     , '' AS MNG_DPT_NM
				     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
            FROM (
                    SELECT DISTINCT D3.APV_DOC_NO
                         , D3.APV_DVSN_CD
                      FROM (
							   SELECT APV_DOC_NO,  /*기안한 문서는 반려, 상신취소, 상신완료*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
			                      where APVR_SEQ = '1'
			                      AND APVR_STA_CD IN ('101','201','301')
			            	   UNION
			            	   SELECT APV_DOC_NO,  /*기안자가 아닌경우 결재처리(반려포함)한 문서 기준으로 조회, 협조는 진행문서함에 조회 하지 않는다.*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
			                      where APVR_SEQ <![CDATA[ <> ]]> '1'
			                      AND SUBSTR(APVR_STA_CD,0,1)  = '2'
		                       UNION
								SELECT L.APV_DOC_NO,  /*기안자가 아닌경우 결재한 이력이 있는 경우 문서를 볼수 있게 조회*/
								      L.APV_DVSN_CD
								 FROM TBDCMACM023L L
										 ,TBDCMACM023H H
								WHERE L.APV_DOC_NO = H.APV_DOC_NO
								  AND L.APVR_CNB = H.APVR_CNB
								  AND L.APVR_SEQ <![CDATA[ <> ]]> '1'
								  AND SUBSTR(H.APVR_STA_CD,0,1) ='2'
                          ) D3
                    
              			<isNotEmpty property="strUsrNam"> 
                         , (SELECT D1.APV_DOC_NO 
                                 , D1.APV_DVSN_CD
                              FROM TBDCMACM023L D1
                                 , TBDCMACM001M D2
                             WHERE D1.APVR_CNB = D2.CNB
                              AND  D2.USR_NAM LIKE '%'||#strUsrNam#||'%' 
                          ) D4
                      WHERE D3.APV_DOC_NO = D4.APV_DOC_NO
                        AND D3.APV_DVSN_CD = D4.APV_DVSN_CD
                         </isNotEmpty>  
                  ) T23
               , TBDCMACM022L T22
			   , ( SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD
                AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
		<![CDATA[   
				AND T22.APV_STA_CD NOT IN ('3','4','5') /*진행중인 문서만 조회하도록 추가*/
                AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'            
         ]]>
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD = #strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
		ORDER BY T22.APV_STA_CD, T22.SBM_DH ASC
	</select>
	
	<!-- 결재대기함 관리자 모드 조회 -->
	<select id="dcmacm042ApvAllSelect" parameterClass="paramMap"
		resultClass="resultMap">
	 SELECT T22.APV_DOC_NO
		     , T22.APV_DVSN_CD
		     , T22.TSK_KY_TXT
		     , T22.APV_STA_CD
		     , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
		     , T22.APV_TIT_NM
		     , T22.SBM_CNB
		     , F_USR_INFO(T22.SBM_CNB,'2') AS SBM_CNB_NM
		     , T23.APVR_CNB
		     , F_USR_INFO(T23.APVR_CNB,'2') AS APVR_CNB_NM
		     , T22.SBM_DH
		     , T22.FNL_APV_CNB
		     , T22.FNL_APV_DH
		     , T23.APV_SNO
		     , T23.APVR_STA_CD
		     , T23.APVR_KND_CD
		     , T21.APV_DVSN_NM
		     , T23.APVR_SEQ
     <isEmpty  property="strFieldAuditYn">
     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     				WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     				WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
      				     			/* 이행상황결재 추가 - 2018.03.28 yyh */
                                    WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                                FROM TBBADEAR002D
                                                                               WHERE APV_DOC_NO = T22.APV_DOC_NO)	                                                                    
				     		ELSE '' END AS AUD_YR_NO
		     , '' as AUD_KND_NM
		     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                      
				     		ELSE '' END AS AUD_SBJ_NM
		     , '' as AUD_DOC_NM
		     , '' as MNG_DPT_NM
     </isEmpty>
     <isNotEmpty  property="strFieldAuditYn">
     ,F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-') AS AUD_YR_NO
		     , '' AS AUD_KND_NM
		     , AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')' AS AUD_SBJ_NM
		     , AD.AUD_DOC_NM
		     , '' AS MNG_DPT_NM
     </isNotEmpty>
     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
		  FROM TBDCMACM022L T22, TBDCMACM023L T23, TBDCMACM021M T21
	  <isNotEmpty  property="strFieldAuditYn">
		  , ( SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD
	  	</isNotEmpty>

		  WHERE 1=1
		  AND	T22.APV_DOC_NO = T23.APV_DOC_NO
		  AND	T22.APV_DVSN_CD = T23.APV_DVSN_CD
		  AND	T23.APVR_STA_CD IN ('102','103','104','105','106','107')
		  AND	T22.APV_DVSN_CD = T21.APV_DVSN_CD
	  <isNotEmpty  property="strFieldAuditYn">
		  AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
		  AND   T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain','badear001')
	  </isNotEmpty>
	  <isEmpty  property="strFieldAuditYn">
	  	  AND   T22.APV_DVSN_CD NOT IN ('fieldAudit','fieldAuditMain')
	  </isEmpty>
		  	<isNotEmpty  property="strUsrNam">
             AND T23.APVR_CNB IN (SELECT CNB FROM TBDCMACM001M WHERE USR_NAM LIKE '%' || #strUsrNam# || '%')
			</isNotEmpty>
			<![CDATA[
		     AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'

			]]>
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','badear001','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD =
				#strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
		
		 
		
		ORDER BY T22.APV_STA_CD, T22.SBM_DH DESC
	</select>
	
	<!-- 결재대기함 관리자 모드 조회 -->
	<select id="dcmacm043ApvAllSelect" parameterClass="paramMap"
		resultClass="resultMap">
	 SELECT T22.APV_DOC_NO
		     , T22.APV_DVSN_CD
		     , T22.TSK_KY_TXT
		     , T22.APV_STA_CD
		     , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
		     , T22.APV_TIT_NM
		     , T22.SBM_CNB
		     , F_USR_INFO(T22.SBM_CNB,'2') AS SBM_CNB_NM
		     , T23.APVR_CNB
		     , F_USR_INFO(T23.APVR_CNB,'2') AS APVR_CNB_NM
		     , T22.SBM_DH
		     , T22.FNL_APV_CNB
		     , T22.FNL_APV_DH
		     , T23.APV_SNO
		     , T23.APVR_STA_CD
		     , T23.APVR_KND_CD
		     , T21.APV_DVSN_NM
		     , T23.APVR_SEQ
		     , NVL(T23.READ_YN,'N') AS READ_YN
		     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-')
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			/* 이행상황결재 추가 - 2018.03.28 yyh */
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                            FROM TBBADEAR002D
                                                                           WHERE APV_DOC_NO = T22.APV_DOC_NO)                                                                    
				     		ELSE NULL END AS AUD_YR_NO
		     , '' AS AUD_KND_NM
		     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')'
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)                                                                      
				     		ELSE NULL END AS AUD_SBJ_NM
		     , AD.AUD_DOC_NM
		     , '' AS MNG_DPT_NM
		     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
		  FROM TBDCMACM022L T22, TBDCMACM023L T23, TBDCMACM021M T21
		  , ( SELECT 
			              A.AUD_YR, A.AUD_NO,
			              C.AUD_KND_CD,
			              C.AUD_SBJ_NM AS AUD_SBJ_NM,
			              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
			                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
			                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
			                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
			                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
			                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
			                                        FROM TBFDMADM002M
			                                       WHERE AUD_DOC_CD = A.RPRT_CD
			                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID
			         FROM TBBADDED103M A 
			              LEFT OUTER JOIN TBBADDED001M C 
			              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
			        WHERE A.APV_RQS_ID IS NOT NULL
			        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
			              C.AUD_SBJ_NM,
			              C.MNG_DPT_CD,
			              A.APV_RQS_ID) AD

		  WHERE 1=1
		  AND	T22.APV_DOC_NO = T23.APV_DOC_NO
		  AND	T22.APV_DVSN_CD = T23.APV_DVSN_CD
		  AND	( T23.APVR_STA_CD IN ('102','103','104','105','106','107') OR (T23.APVR_KND_CD = '9' AND T23.APVR_STA_CD = '202' AND NVL(T23.READ_YN,'N') = 'N' ) ) 
		  AND	T22.APV_DVSN_CD = T21.APV_DVSN_CD
		  AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
		  	<isNotEmpty  property="strUsrNam">
             AND T23.APVR_CNB IN (SELECT CNB FROM TBDCMACM001M WHERE USR_NAM LIKE '%' || #strUsrNam# || '%')
			</isNotEmpty>
			<![CDATA[
		     AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'

			]]>
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
		    <isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD = #strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
		
		 
		
		ORDER BY T22.APV_STA_CD, T22.SBM_DH ASC
	</select>
	
	<!-- 결재대기함 사용자 모드 조회 -->
	<select id="dcmacm042ApvUserSelect" parameterClass="paramMap"
		resultClass="resultMap">
		 SELECT T22.APV_DOC_NO
		     , T22.APV_DVSN_CD
		     , T22.TSK_KY_TXT
		     , T22.APV_STA_CD
		     , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
		     , T22.APV_TIT_NM
		     , T22.SBM_CNB
		     , F_USR_INFO(T22.SBM_CNB,'2') AS SBM_CNB_NM
		     , T23.APVR_CNB
		     , F_USR_INFO(T23.APVR_CNB,'2') AS APVR_CNB_NM
		     , T22.SBM_DH
		     , T22.FNL_APV_CNB
		     , T22.FNL_APV_DH
		     , T23.APV_SNO
		     , T23.APVR_STA_CD
		     , T23.APVR_KND_CD
		     , T21.APV_DVSN_NM	
		     , T23.APVR_SEQ
		     , NVL(T23.READ_YN,'N') AS READ_YN
		     /* 국민제안2국1과 처리기한 칼럼 추가 - 2023.06.20 */ 
		     <![CDATA[
   		     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
     			   THEN	(SELECT		CASE WHEN (TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'))))) < 0
                                         THEN '기한초과' 
                                         WHEN TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))) >= 100
                                         THEN ('D-'||TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))))
                                         WHEN TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))) >= 10
                                         THEN ('D-0'||TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))))
                                         ELSE ('D-00'||TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))))
                                         END
     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
     						AND		T1.ACP_YR = T2.ACP_YR
     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
     						)
     			ELSE '' END AS AUD_HNDL_DDLN_DT
     		]]>
      <isEmpty  property="strFieldAuditYn">
      ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     				WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     				WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			    /* 이행상황결재 추가 - 2018.03.28 yyh */
                                    WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                                FROM TBBADEAR002D
                                                                               WHERE APV_DOC_NO = T22.APV_DOC_NO)
                                   WHEN T22.APV_DVSN_CD  IN ('requestAudit5', 'requestAudit6')   /*심사 재심의건도 분류번호가 조회되도록 수정 2018.06.19 CJLEE*/
		                                   THEN (SELECT D1.ACP_YR||DECODE(D1.ACP_DVSN_CD, '1', '-심사-', '2','-재심-')||D1.ACP_SRNO
		                                   FROM TBBADFRE012M D1 , TBBADFRE103M D2
		                                  WHERE D1.ACP_YR = D2.ACP_YR
		                                     AND D1.ACP_SRNO = D2.ACP_SRNO
		                                     AND D1.ACP_DVSN_CD = D2.ACP_DVSN_CD
		                                     AND D2.APV_RQS_ID = T22.APV_DOC_NO
		                                     AND ROWNUM = 1
		                                     )	                                                                    
				     		ELSE '' END AS AUD_YR_NO
		     , '' as AUD_KND_NM
		     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     				WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     				WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                    WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								    /* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                    WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                                FROM TBBADEAR001M D1 
                                                                                    ,TBBADEAR002D D2
                                                                               WHERE D1.AUD_YR     = D2.AUD_YR
                                                                                 AND D1.AUD_NO     = D2.AUD_NO
                                                                                 AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                                 AND D2.APV_DOC_NO = T22.APV_DOC_NO)
                                    WHEN T22.APV_DVSN_CD  IN ('requestAudit5', 'requestAudit6')   /*심사 재심의건도 제목이 조회되도록 수정 2018.06.19 CJLEE*/
					                         THEN (SELECT D1.TIT_NM
					                                   FROM TBBADFRE012M D1 , TBBADFRE103M D2
					                                  WHERE D1.ACP_YR = D2.ACP_YR
					                                     AND D1.ACP_SRNO = D2.ACP_SRNO
					                                     AND D1.ACP_DVSN_CD = D2.ACP_DVSN_CD
					                                     AND D2.APV_RQS_ID = T22.APV_DOC_NO
					                                     AND ROWNUM =1)                                                                     
				     		ELSE '' END AS AUD_SBJ_NM

		     , '' as AUD_DOC_NM
		     , '' as MNG_DPT_NM
     </isEmpty>
		     <isNotEmpty  property="strFieldAuditYn">
		     ,F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-') AS AUD_YR_NO
		     , '' AS AUD_KND_NM
		     , AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')' AS AUD_SBJ_NM
		     , AD.AUD_DOC_NM
		     , '' AS MNG_DPT_NM
		     </isNotEmpty>
		     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
		     /*전자감사 에디터 업무 처리 여부  start CJLEE*/
       ,
       CASE WHEN T22.APV_DVSN_CD  IN ('requestAudit5', 'requestAudit6')
       THEN 
       (SELECT CASE WHEN SUM(DECODE(D2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) > 0 THEN 'N'  
                         WHEN SUM(DECODE(D2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) = 0 THEN 'Y' 
                          ELSE NULL END  
         FROM TBBADFRE012M D1 , TBBADFRE103M D2
        WHERE D1.ACP_YR = D2.ACP_YR
           AND D1.ACP_SRNO = D2.ACP_SRNO
           AND D1.ACP_DVSN_CD = D2.ACP_DVSN_CD
           AND D2.RPRT_CD  ='D10200200'
           AND D2.APV_RQS_ID = T22.APV_DOC_NO) 
           ELSE ( SELECT CASE WHEN SUM(DECODE(T2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) > 0 THEN 'N' 
                          WHEN SUM(DECODE(T2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) = 0 THEN 'Y' 
                             ELSE NULL END  
          FROM TBBADDED103M T2
         WHERE T2.APV_RQS_ID = T22.APV_DOC_NO
            AND T2.RPRT_CD = 'A10600200' 
            AND T2.AUD_STEP_CD = 'A1060') END AS EDITOR_WRK_APPL_YN 
            , ( SELECT CASE WHEN TO_CHAR(MAX(T3.SND_DH),'YYYYMMDD') <![CDATA[<]]> ( SELECT ST.USR_DFN_TXT_1 FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = '1000915' AND ST.CD = '10') THEN 'NT'
                      WHEN SUM(DECODE(NVL(T2.OPIN_WRK_APPL_YN,'N'), 'N', 1, 0) ) > 0 THEN 'N' 
                      WHEN SUM(DECODE(NVL(T2.OPIN_WRK_APPL_YN,'N'), 'N', 1, 0) ) = 0 THEN 'Y'
                      ELSE NULL END
		           FROM TBBADDED103M T2
		           LEFT OUTER JOIN TBBADDED111M T3 ON (T3.AUD_YR = T2.AUD_YR AND T3.AUD_NO = T2.AUD_NO AND T3.AUD_STEP_CD = T2.AUD_STEP_CD AND T3.DOC_ID = T2.DOC_ID)
		           WHERE T2.APV_RQS_ID = T22.APV_DOC_NO
		             AND T2.RPRT_CD = 'A10600200' 
		             AND T2.AUD_STEP_CD = 'A1060') AS OPIN_WRK_APPL_YN 
		  FROM TBDCMACM022L T22, TBDCMACM023L T23, TBDCMACM021M T21
		<isNotEmpty  property="strFieldAuditYn">
		  , ( SELECT 
		              A.AUD_YR, A.AUD_NO,
		              C.AUD_KND_CD,
		              C.AUD_SBJ_NM AS AUD_SBJ_NM,
		              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
		                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
		                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
		                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
		                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
		                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
		                                        FROM TBFDMADM002M
		                                       WHERE AUD_DOC_CD = A.RPRT_CD
		                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
		              C.MNG_DPT_CD,
		              A.APV_RQS_ID
		         FROM TBBADDED103M A 
		              LEFT OUTER JOIN TBBADDED001M C 
		              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
		        WHERE A.APV_RQS_ID IS NOT NULL
		        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
		              C.AUD_SBJ_NM,
		              C.MNG_DPT_CD,
		              A.APV_RQS_ID) AD
	  	</isNotEmpty>
		  WHERE 1=1
		  AND	T22.APV_DOC_NO = T23.APV_DOC_NO
		  AND	T22.APV_DVSN_CD = T23.APV_DVSN_CD
		  AND	(T23.APVR_STA_CD IN ('102','103','104','105','106','107') OR (T23.APVR_KND_CD = '9' AND T23.APVR_STA_CD = '202' AND NVL(T23.READ_YN,'N') = 'N' ) )
      	  AND 	T23.APVR_CNB = #strApvrCnb#
		  AND	T22.APV_DVSN_CD = T21.APV_DVSN_CD
  	  <isNotEmpty  property="strFieldAuditYn">
		  AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
		  AND   T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain','badear001', 'AudExecPlanMng')
	  UNION
	   SELECT /*실지감사, 심의요청 대시보드의 결재대기함 건수 조회 시 소위원회 결과보고서 보고서를 포함하여 조회 되도록 추가*/ 
	        T22.APV_DOC_NO,
	        T22.APV_DVSN_CD,
	        T22.TSK_KY_TXT,
	        T22.APV_STA_CD,
	        F_CODE_NM ('1000333',T22.APV_STA_CD) AS APV_STA_NM,T22.APV_TIT_NM,
	        T22.SBM_CNB,
	        F_USR_INFO (T22.SBM_CNB,'2') AS SBM_CNB_NM,
	        T23.APVR_CNB,
	        F_USR_INFO (T23.APVR_CNB,'2') AS APVR_CNB_NM,
	        T22.SBM_DH,
	        T22.FNL_APV_CNB,
	        T22.FNL_APV_DH,
	        T23.APV_SNO,
	        T23.APVR_STA_CD,
	        T23.APVR_KND_CD,
	        T21.APV_DVSN_NM,
	        T23.APVR_SEQ,
	        NVL(T23.READ_YN,'N') AS READ_YN,
	        (SELECT D1.ACP_YR||DECODE(D1.ACP_DVSN_CD, '1', '-심사-', '2','-재심-')||D1.ACP_SRNO
                                   FROM TBBADFRE012M D1 , TBBADFRE103M D2
                                  WHERE D1.ACP_YR = D2.ACP_YR
                                     AND D1.ACP_SRNO = D2.ACP_SRNO
                                     AND D1.ACP_DVSN_CD = D2.ACP_DVSN_CD
                                     AND D2.APV_RQS_ID = T22.APV_DOC_NO)  AS AUD_YR_NO, /*심사 재심의건도 분류번호가 조회되도록 수정 2018.06.19 CJLEE*/
	        '' AS AUD_KND_NM,
	        (SELECT D1.TIT_NM
                                   FROM TBBADFRE012M D1 , TBBADFRE103M D2
                                  WHERE D1.ACP_YR = D2.ACP_YR
                                     AND D1.ACP_SRNO = D2.ACP_SRNO
                                     AND D1.ACP_DVSN_CD = D2.ACP_DVSN_CD
                                     AND D2.APV_RQS_ID = T22.APV_DOC_NO) AS AUD_SBJ_NM,   /*심사 재심의건도 제목이 조회되도록 수정 2018.06.19 CJLEE*/
	        (SELECT AGGR_CONCAT (T2.RPRT_NM, ','ORDER BY T2.RPRT_CD)
                                 FROM TBBADFRE103M T2
                               WHERE T2.APV_RQS_ID = T22.APV_DOC_NO )  as AUD_DOC_NM,  /*심사 재심의건도 문서명 조회되도록 수정 2018.06.19 CJLEE*/
	        '' as MNG_DPT_NM,
	        F_DPT_INFO (T22.APV_DPT_CD,
	        '4') AS APV_DPT_NM,
	        /*전자감사 에디터 업무 처리 여부  start CJLEE*/
		       (SELECT CASE WHEN SUM(DECODE(D2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) > 0 THEN 'N' 
		                         WHEN SUM(DECODE(D2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) = 0 THEN 'Y' 
		                            ELSE NULL END  
		         FROM TBBADFRE012M D1 , TBBADFRE103M D2
		        WHERE D1.ACP_YR = D2.ACP_YR
		           AND D1.ACP_SRNO = D2.ACP_SRNO
		           AND D1.ACP_DVSN_CD = D2.ACP_DVSN_CD
		           AND D2.RPRT_CD  ='D10200200'
		           AND D2.APV_RQS_ID = T22.APV_DOC_NO) AS EDITOR_WRK_APPL_YN 
	           , '' AS OPIN_WRK_APPL_YN
	        FROM TBDCMACM022L T22,
			  	   TBDCMACM023L T23,
			       TBDCMACM021M T21,
			       TBBADFRE103M T103M
			 WHERE T22.APV_DOC_NO = T23.APV_DOC_NO
			   AND T22.APV_DVSN_CD = T23.APV_DVSN_CD
			   AND T22.APV_DOC_NO = T103M.APV_RQS_ID
			   AND T22.APV_DVSN_CD = T21.APV_DVSN_CD
			   /* 공석일경우 미열람건 카운트 추가 */
			   AND ( T23.APVR_STA_CD IN ('102','103','104','105','106','107') OR (T23.APVR_KND_CD = '9' AND T23.APVR_STA_CD = '202' AND NVL(T23.READ_YN,'N') = 'N' ) )
			   AND T23.APVR_CNB = #strApvrCnb#
			   AND T22.APV_DVSN_CD IN ('requestAudit5', 'requestAudit6')
			   AND T103M.RPRT_CD IN ('D10300200','D10300600','D10300700','E10200200','E10300150','E10300400','E10500200','D10200700','E10400500')    
	  </isNotEmpty>
	  <isEmpty  property="strFieldAuditYn">
	  	  <isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain','badear001')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD = #strApvDvsnCd#
			</isNotEqual>
		  </isNotEmpty>
	  </isEmpty>
		  	<isNotEmpty  property="strUsrNam">
             AND T23.APVR_CNB IN (SELECT CNB FROM TBDCMACM001M WHERE USR_NAM LIKE '%' || #strUsrNam# || '%')
			</isNotEmpty>
			<![CDATA[
		     AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'
			]]>
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		
		
		 
		
		ORDER BY T22.APV_STA_CD, T22.SBM_DH ASC
	</select>
	
	
	<select id="dcmacm043ApvUserSelect" parameterClass="paramMap"
		resultClass="resultMap">
		 SELECT T22.APV_DOC_NO
		     , T22.APV_DVSN_CD
		     , T22.TSK_KY_TXT
		     , T22.APV_STA_CD
		     , F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
		     , T22.APV_TIT_NM
		     , T22.SBM_CNB
		     , F_USR_INFO(T22.SBM_CNB,'2') AS SBM_CNB_NM
		     , T23.APVR_CNB
		     , F_USR_INFO(T23.APVR_CNB,'2') AS APVR_CNB_NM
		     , T22.SBM_DH
		     , T22.FNL_APV_CNB
		     , T22.FNL_APV_DH
		     , T23.APV_SNO
		     , T23.APVR_STA_CD
		     , T23.APVR_KND_CD
		     , T21.APV_DVSN_NM	
		     , T23.APVR_SEQ
		     , NVL(T23.READ_YN,'N') AS READ_YN
		     /* 국민제안2국1과 처리기한 칼럼 추가 - 2023.06.20 */
		     <![CDATA[ 
   		     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
     			   THEN	(SELECT		CASE WHEN (TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'))))) < 0
                                         THEN '기한초과'
                                         WHEN TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))) >= 100
                                         THEN ('D-'||TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))))
                                         WHEN TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))) >= 10
                                         THEN ('D-0'||TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))))
                                         ELSE ('D-00'||TRUNC((TO_DATE(T2.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))))
                                         END
     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
     						AND		T1.ACP_YR = T2.ACP_YR
     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
     						)
     			ELSE '' END AS AUD_HNDL_DDLN_DT
     		]]>
      		,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.ACP_YR||'-'||F_CODE_NM('1000740',T2.REQ_DVSN_CD)||'-'||T2.RM_CVPT_ACP_NO
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN F_MNG_KND_AUDYRNO(AD.AUD_YR, AD.AUD_NO, AD.AUD_KND_CD, '-')
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT YE||'-'||SRNO
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
      				     		/* 이행상황결재 추가 - 2018.03.28 yyh */
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_MNG_KND_AUDYRNO(AUD_YR, AUD_NO, '', '-') || '-' || DSP_RQ_SNO
                                                                            FROM TBBADEAR002D
                                                                           WHERE APV_DOC_NO = T22.APV_DOC_NO)
                                                                           
                                WHEN T22.APV_DVSN_CD  IN ('requestAudit5', 'requestAudit6')   /*심사 재심의건도 분류번호가 조회되도록 수정 2018.06.19 CJLEE*/
                         THEN (SELECT D1.ACP_YR||DECODE(D1.ACP_DVSN_CD, '1', '-심사-', '2','-재심-')||D1.ACP_SRNO
                                   FROM TBBADFRE012M D1 , TBBADFRE103M D2
                                  WHERE D1.ACP_YR = D2.ACP_YR
                                     AND D1.ACP_SRNO = D2.ACP_SRNO
                                     AND D1.ACP_DVSN_CD = D2.ACP_DVSN_CD
                                     AND D2.APV_RQS_ID = T22.APV_DOC_NO
                                     AND ROWNUM = 1
                                     )                                           	                                                                    
				     		ELSE NULL END AS AUD_YR_NO
		     , '' AS AUD_KND_NM
		     ,CASE WHEN	 T22.APV_DVSN_CD IN ('requestAudit1','requestAudit2','requestAudit3')
				     			THEN	(SELECT		T2.TIT_NM
				     						FROM 	TBCSPDCP603M T1, TBCSPDCP101M T2
				     						WHERE	T1.APV_RQS_ID = T22.APV_DOC_NO
				     						AND		T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
				     						AND		T1.ACP_YR = T2.ACP_YR
				     						AND		T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
				     						)
				     			WHEN T22.APV_DVSN_CD = 'fieldAudit' THEN AD.AUD_SBJ_NM||'('||F_DPT_INFO(AD.MNG_DPT_CD, '4')||')'
				     			WHEN T22.APV_DVSN_CD IN ('AudInfoSend','AudInfoHndl') THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII100M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
				     			WHEN T22.APV_DVSN_CD = 'AudInfoHndl2' THEN (SELECT TIT_TXT
                                                                    FROM    TBCSPBII170M S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
                                WHEN T22.APV_DVSN_CD = 'portalNotiApv' THEN (SELECT S1.TITLE
                                                                    FROM    CTT_IMSI S1
                                                                    WHERE   T22.APV_DOC_NO = S1.APV_DOC_NO
                                                                    )
								/* 이행상황결재시에 처분종류 추가 - 2018.03.28 yyh */                                                                    
                                WHEN T22.APV_DVSN_CD = 'DspRqApv'   THEN (SELECT F_CODE_NM('1000002', D1.DSP_RQ_KND_CD)
                                                                            FROM TBBADEAR001M D1 
                                                                                ,TBBADEAR002D D2
                                                                           WHERE D1.AUD_YR     = D2.AUD_YR
                                                                             AND D1.AUD_NO     = D2.AUD_NO
                                                                             AND D1.DSP_RQ_SNO = D2.DSP_RQ_SNO
                                                                             AND D2.APV_DOC_NO = T22.APV_DOC_NO)
                                WHEN T22.APV_DVSN_CD  IN ('requestAudit5', 'requestAudit6')   /*심사 재심의건도 제목이 조회되도록 수정 2018.06.19 CJLEE*/
			                         THEN (SELECT D1.TIT_NM
			                                   FROM TBBADFRE012M D1 , TBBADFRE103M D2
			                                  WHERE D1.ACP_YR = D2.ACP_YR
			                                     AND D1.ACP_SRNO = D2.ACP_SRNO
			                                     AND D1.ACP_DVSN_CD = D2.ACP_DVSN_CD
			                                     AND D2.APV_RQS_ID = T22.APV_DOC_NO
			                                     AND ROWNUM = 1
			                                     )                                                                                                                 
				     		ELSE NULL END AS AUD_SBJ_NM
		     ,CASE WHEN T22.APV_DVSN_CD = 'fieldAudit'  
                       THEN AD.AUD_DOC_NM 
              WHEN T22.APV_DVSN_CD  IN ('requestAudit5', 'requestAudit6')      /*심사 재심의건도 문서명 조회되도록 수정 2018.06.19 CJLEE*/
                       THEN (SELECT AGGR_CONCAT (T2.RPRT_NM, ','ORDER BY T2.RPRT_CD)
                                 FROM TBBADFRE103M T2
                               WHERE T2.APV_RQS_ID = T22.APV_DOC_NO ) 
              ELSE '' END AS AUD_DOC_NM
		     , '' AS MNG_DPT_NM
		     , F_DPT_INFO(T22.APV_DPT_CD,'4') AS APV_DPT_NM
		     /*전자감사 에디터 업무 처리 여부  start CJLEE*/
		     , CASE WHEN T22.APV_DVSN_CD = 'fieldAudit'     
		                        THEN ( SELECT CASE WHEN SUM(DECODE(T2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) > 0 THEN 'N' 
		                                                   WHEN SUM(DECODE(T2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) = 0 THEN 'Y' 
		                                                    ELSE NULL END  
		                                  FROM TBBADDED103M T2
		                                 WHERE T2.AUD_YR = AD.AUD_YR
		                                    AND T2.AUD_NO = AD.AUD_NO
		                                    AND T2.APV_RQS_ID = T22.APV_DOC_NO
		                                    AND T2.RPRT_CD = 'A10600200' 
		                                    AND T2.AUD_STEP_CD = 'A1060')
		             WHEN T22.APV_DVSN_CD  = 'requestAudit5' 
		                        THEN  (SELECT CASE WHEN SUM(DECODE(D2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) > 0 THEN 'N' 
		                                                   WHEN SUM(DECODE(D2.EDITOR_WRK_APPL_YN, 'N', 1 , 0)) = 0 THEN 'Y' 
		                                                     ELSE NULL END  
		                                   FROM TBBADFRE012M D1 , TBBADFRE103M D2
		                                  WHERE D1.ACP_YR = D2.ACP_YR
		                                     AND D1.ACP_SRNO = D2.ACP_SRNO
		                                     AND D1.ACP_DVSN_CD = D2.ACP_DVSN_CD
		                                     AND D2.RPRT_CD = 'D10200200'
		                                     AND D2.APV_RQS_ID = T22.APV_DOC_NO)
		                 ELSE NULL END AS EDITOR_WRK_APPL_YN
		      , ( SELECT CASE WHEN TO_CHAR(MAX(T3.SND_DH),'YYYYMMDD') <![CDATA[<]]> ( SELECT ST.USR_DFN_TXT_1 FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = '1000915' AND ST.CD = '10') THEN 'NT'
                      WHEN SUM(DECODE(NVL(T2.OPIN_WRK_APPL_YN,'N'), 'N', 1, 0) ) > 0 THEN 'N' 
                      WHEN SUM(DECODE(NVL(T2.OPIN_WRK_APPL_YN,'N'), 'N', 1, 0) ) = 0 THEN 'Y'
                      ELSE NULL END 
		           FROM TBBADDED103M T2
		           LEFT OUTER JOIN TBBADDED111M T3 ON (T3.AUD_YR = T2.AUD_YR AND T3.AUD_NO = T2.AUD_NO AND T3.AUD_STEP_CD = T2.AUD_STEP_CD AND T3.DOC_ID = T2.DOC_ID)
		           WHERE T2.APV_RQS_ID = T22.APV_DOC_NO
		             AND T2.RPRT_CD = 'A10600200' 
		             AND T2.AUD_STEP_CD = 'A1060') AS OPIN_WRK_APPL_YN
		  FROM TBDCMACM022L T22, TBDCMACM023L T23, TBDCMACM021M T21
		  , ( SELECT 
		              A.AUD_YR, A.AUD_NO,
		              C.AUD_KND_CD,
		              C.AUD_SBJ_NM AS AUD_SBJ_NM,
		              AGGR_CONCAT (CASE WHEN RPRT_CD = 'A10600100' THEN '개별처분요구안' 
		                                WHEN RPRT_CD = 'A10951200' THEN '조사개시통보'
		                                WHEN RPRT_CD = 'A10951300' THEN '조사종료통보'
		                                WHEN RPRT_CD = 'A10600200' THEN '감사보고서'
		                                WHEN RPRT_CD = 'A10920100' THEN '검토의견/보고서'
		                                ELSE ( SELECT AGGR_CONCAT (DTIL_AUD_DOC_NM,',') AS DTIL_AUD_DOC_NM
		                                        FROM TBFDMADM002M
		                                       WHERE AUD_DOC_CD = A.RPRT_CD
		                                       GROUP BY AUD_DOC_CD) END,',') AS AUD_DOC_NM,
		              C.MNG_DPT_CD,
		              A.APV_RQS_ID
		         FROM TBBADDED103M A 
		              LEFT OUTER JOIN TBBADDED001M C 
		              ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO)
		        WHERE A.APV_RQS_ID IS NOT NULL
		        GROUP BY A.AUD_YR, A.AUD_NO, C.AUD_KND_CD,
		              C.AUD_SBJ_NM,
		              C.MNG_DPT_CD,
		              A.APV_RQS_ID) AD
		  WHERE 1=1
		  AND	T22.APV_DOC_NO = T23.APV_DOC_NO
		  AND	T22.APV_DVSN_CD = T23.APV_DVSN_CD
		  AND	( T23.APVR_STA_CD IN ('102','103','104','105','106','107') OR (T23.APVR_KND_CD = '9' AND T23.APVR_STA_CD = '202' AND NVL(T23.READ_YN,'N') = 'N' ) )
      	  AND 	T23.APVR_CNB = #strApvrCnb#
		  AND	T22.APV_DVSN_CD = T21.APV_DVSN_CD
		  AND   T22.APV_DOC_NO = AD.APV_RQS_ID(+)
  	  <isEqual  property="strFieldAuditYn" compareValue="Y">
		  AND   T22.APV_DVSN_CD IN ('fieldAudit','fieldAuditMain','requestAudit1','requestAudit2','requestAudit3','requestAudit4','requestAudit5','requestAudit6','requestAudit7','requestAudit8','badear001','DspRqClosingSend','AudExecPlanMng')
	  </isEqual>
	  <isEqual  property="strFieldAuditYn" compareValue="N">
	  	  AND   T22.APV_DVSN_CD NOT IN ('fieldAudit','fieldAuditMain','requestAudit1','requestAudit2','requestAudit3','requestAudit4','requestAudit5','requestAudit6','requestAudit7','requestAudit8','DspRqClosingSend','AudExecPlanMng')
	  </isEqual>
		  	<isNotEmpty  property="strUsrNam">
             AND T23.APVR_CNB IN (SELECT CNB FROM TBDCMACM001M WHERE USR_NAM LIKE '%' || #strUsrNam# || '%')
			</isNotEmpty>
			<![CDATA[
		     AND T22.SBM_DH BETWEEN #strSbmDyFrom#||'000000' AND #strSbmDyTo#||'235959'
			]]>
		<isNotEmpty prepend="AND" property="strApvTit">
			T22.APV_TIT_NM LIKE
			'%'||#strApvTit#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvSta">
			T22.APV_STA_CD =
			#strApvSta#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strApvDvsnCd">
			<isEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD IN ('fieldAudit','badear001','fieldAuditMain')
			</isEqual>
			<isNotEqual property="strApvDvsnCd" compareValue="fieldAudit">
				T22.APV_DVSN_CD =
				#strApvDvsnCd#
			</isNotEqual>
		</isNotEmpty>
		
		<isEqual property="strMenuId" compareValue="DCMACM040Q">
	    	 AND T23.APVR_PST_CD = '0055700'
	    </isEqual>
		ORDER BY T22.APV_STA_CD, T22.SBM_DH ASC
	</select>

	<!-- 결재상신팝업 문서정보 조회 -->
	<select id="dcmacm045ApprSugSelect" parameterClass="paramMap"
		resultClass="java.lang.String">
	<![CDATA[
	
		SELECT TO_CHAR(SYSDATE,'yyyymmddhh24miss')||LPAD(APV_DOC_NO_SEQ.NEXTVAL, 6, 0) AS APV_DOC_NO
		 FROM DUAL
	
	]]>
	</select>

	<!-- 결재문서 신규 -->
	<insert id="dcmacm045ApprSugInsert" parameterClass="paramMap">
	<![CDATA[
		INSERT INTO
		TBDCMACM022L
		(
		APV_DOC_NO
		, APV_DVSN_CD
		, APV_STA_CD
		, APV_TIT_NM
		, SBM_CNB
		, SBM_DH

		, FNL_APV_DH
		, AUD_SBJ_NM

		, FNL_MNU_ID
		, FRT_USR_ID
		, FNL_USR_ID
		, FNL_DEAL_DPT_CD
		,
		FRT_REGI_DH
		,
		FNL_MDF_DH
		,FNL_APV_CNB
		,APV_DOC_SEQ
		,APV_DOC_HTML_TXT
		,APV_DPT_CD
		,AUTO_CMPT_COPR_YN
		,DRFT_FORM_KND
		)
		VALUES
		(
		#APV_DOC_NO#
		, #APV_DVSN_CD#
		, #APV_STA_CD#
		, #APV_TIT_NM#
		, #SBM_CNB#
		, SYSDATE
		, SYSDATE
		, #AUD_SBJ_NM#
		, #FNL_MNU_ID#
		, #FRT_USR_ID#
		, #FNL_USR_ID#
		, #FNL_DEAL_DPT_CD#
		,  SYSDATE
		, SYSDATE
		, #FNL_APV_CNB#
		, #APV_DOC_SEQ#
		, #APV_DOC_HTML_TXT#
		, #FNL_DEAL_DPT_CD#
		, #AUTO_CMPT_COPR_YN#
		, #DRFT_FORM_KND#
		)
		]]>
	</insert>

	<!-- 결재자 신규 -->
	<insert id="dcmacm045ApprSugAssignInsert" parameterClass="paramMap">
	   MERGE INTO	TBDCMACM023L A
					USING	(	SELECT	#APV_DOC_NO# AS APV_DOC_NO
										,#APV_DVSN_CD# AS APV_DVSN_CD
										,#APVR_CNB# AS APVR_CNB
										,#APVR_SEQ# AS APVR_SEQ
								FROM	DUAL
							) B
					ON	(		A.APV_DOC_NO = B.APV_DOC_NO
							AND	A.APV_DVSN_CD = B.APV_DVSN_CD
							AND	A.APVR_CNB = B.APVR_CNB
							AND	A.APVR_SEQ = B.APVR_SEQ
						)
				WHEN	NOT MATCHED THEN
					INSERT
						(
						APV_DOC_NO
						, APV_DVSN_CD
						, APVR_CNB
						, APVR_DPT_CD
						,
						APVR_RANK_CD
						, APVR_PST_CD
						,
						APVR_KND_CD
						, APV_SNO
						, APVR_STA_CD
						, APV_DH
						,
						APV_OPIN
				
						, FNL_MNU_ID
						, FRT_USR_ID
						, FNL_USR_ID
						, FNL_DEAL_DPT_CD
						,
						FRT_REGI_DH
						,
						FNL_MDF_DH
						,APVR_SEQ
						,ONR_PST_NM
						,VACANCY_CD
						)
						VALUES
						(
						#APV_DOC_NO#
						, #APV_DVSN_CD#
						, #APVR_CNB#
						, #APVR_DPT_CD#
						, #APVR_RANK_CD#
						,
						#APVR_PST_CD#
						, #APVR_KND_CD#
						,
						#APV_SNO#
						, #APVR_STA_CD#
						,
						CASE WHEN SUBSTR(#APVR_STA_CD#,0,1) = '3' THEN NULL
	                        WHEN SUBSTR(#APVR_STA_CD#,0,1) <![CDATA[ <> ]]> '1' THEN NVL(#APV_DH#,TO_CHAR(SYSDATE,'yyyymmddhh24mIss'))
                    	ELSE NULL END
						,
						#APV_OPIN#
				
						, #FNL_MNU_ID#
						, #FRT_USR_ID#
						,
						#FNL_USR_ID#
						, #FNL_DEAL_DPT_CD#
						, SYSDATE
						, SYSDATE
						, (SELECT NVL(COUNT(*),0)+1
							 FROM TBDCMACM023L
							WHERE APV_DOC_NO = #APV_DOC_NO#
							  AND APV_DVSN_CD = #APV_DVSN_CD#)
						, #ONR_PST_NM#
						, #VACANCY_CD#
						)
	</insert>
	<!-- 결재자상태 업데이트 -->
	<update id="dcmacm047ApprSugAssignUpdate" parameterClass="paramMap">
		UPDATE TBDCMACM023L
		SET APV_DVSN_CD = #APV_DVSN_CD#
		, APV_DH = CASE WHEN SUBSTR(#APVR_STA_CD#,0,1) = '3' THEN NULL
	                        WHEN SUBSTR(#APVR_STA_CD#,0,1) <![CDATA[ <> ]]> '1' THEN NVL(#APV_DH#,NVL(APV_DH,TO_CHAR(SYSDATE,'yyyymmddhh24mIss')))
	                    ELSE NULL END
		, FNL_MDF_DH = SYSDATE
		, FNL_USR_ID = #FNL_USR_ID#
		, FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
		, FNL_MNU_ID = #FNL_MNU_ID#
		<isNotNull prepend="," property="APVR_STA_CD">
			APVR_STA_CD = #APVR_STA_CD#
		</isNotNull>
		<isNotNull prepend="," property="APV_OPIN">
			APV_OPIN = #APV_OPIN#
		</isNotNull>
		WHERE 1 = 1
		AND APV_DVSN_CD = #APV_DVSN_CD#
		AND APV_DOC_NO = #APV_DOC_NO#
		AND APVR_CNB =#APVR_CNB#
		AND APVR_SEQ =#APVR_SEQ#
	</update>
	
	<update id="dcmacm047ApprSugAssignUpdate2" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBDCMACM023L
			SET		APV_DH = TO_CHAR(SYSDATE,'yyyymmddhh24mIss')
					,APVR_STA_CD = '202'
					,READ_YN = 'Y'
		]]>
			<isNotNull prepend="," property="APV_OPIN">
				APV_OPIN = #APV_OPIN#
			</isNotNull>
		<![CDATA[
			WHERE	 APV_DVSN_CD = #APV_DVSN_CD#
			AND APV_DOC_NO = #APV_DOC_NO#
			AND APVR_CNB =#APVR_CNB#
			AND APVR_SEQ =#APVR_SEQ#
		]]>
	</update>

	<!-- 결재문서상태업데이트 -->
	<update id="dcmacm047ApprSugUpdate" parameterClass="paramMap">
		UPDATE
		TBDCMACM022L
		SET APV_STA_CD = #APV_STA_CD#
		, FNL_APV_DH = SYSDATE
		,
		FNL_APV_CNB =#FNL_APV_CNB#

		, FNL_MDF_DH = SYSDATE
		, FNL_USR_ID =
		#FNL_USR_ID#
		, FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
		, FNL_MNU_ID =
		#FNL_MNU_ID#
		,APV_TIT_NM = #APV_TIT_NM#
		,APV_DOC_HTML_TXT = #APV_DOC_HTML_TXT#
		,AUTO_CMPT_COPR_YN = #AUTO_CMPT_COPR_YN#
		WHERE 1 = 1
		AND APV_DVSN_CD = #APV_DVSN_CD#
		AND APV_DOC_NO =
		#APV_DOC_NO#

	</update>
	
	<resultMap class="java.util.HashMap" id="dcmacm047ApprSelect">
 		<result property="APV_DOC_NO" column="APV_DOC_NO"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="APV_DVSN_CD" column="APV_DVSN_CD"                             jdbcType="VARCHAR2"  javaType="java.lang.String" /> 
		<result property="TSK_KY_TXT" column="TSK_KY_TXT"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="APV_STA_CD" column="APV_STA_CD"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="APV_STA_NM" column="APV_STA_NM"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="APV_TIT_NM" column="APV_TIT_NM"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="SBM_CNB" column="SBM_CNB"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="SBM_CNB_ID" column="SBM_CNB_ID"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="SBM_CNB_NM" column="SBM_CNB_NM"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="SBM_DH" column="SBM_DH"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="FNL_APV_CNB" column="FNL_APV_CNB"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="FNL_APV_DH" column="FNL_APV_DH"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="APV_DOC_SEQ" column="APV_DOC_SEQ"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="APV_DOC_HTML_TXT" column="APV_DOC_HTML_TXT"                             jdbcType="CLOB"  javaType="java.lang.String" />
		<result property="AUTO_CMPT_COPR_YN" column="AUTO_CMPT_COPR_YN"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="DRFT_FORM_KND" column="DRFT_FORM_KND"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="AUD_SBJ_NM" column="AUD_SBJ_NM"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="HIS_RESTORE_YN" column="HIS_RESTORE_YN"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
	</resultMap>
	<!-- 결재상신팝업 문서정보 조회 -->
	<select id="dcmacm047ApprSelect" parameterClass="paramMap"
		resultMap="dcmacm047ApprSelect">
	<![CDATA[
	
		   SELECT T22.APV_DOC_NO  
               , T22.APV_DVSN_CD
               , T22.TSK_KY_TXT
               , T22.APV_STA_CD
               ,F_CODE_NM('1000333',T22.APV_STA_CD) AS APV_STA_NM
               , T22.APV_TIT_NM
               , T22.SBM_CNB
               , F_USR_INFO(T22.SBM_CNB,'1') AS SBM_CNB_ID
               , F_USR_INFO(SBM_CNB,'2') AS SBM_CNB_NM
               , T22.SBM_DH
               , T22.FNL_APV_CNB
               , T22.FNL_APV_DH
               , T22.APV_DOC_SEQ
               , T22.APV_DOC_HTML_TXT
               , T22.AUTO_CMPT_COPR_YN
               , T22.DRFT_FORM_KND
               , T22.AUD_SBJ_NM
               , (SELECT (CASE WHEN COUNT(AA.APVR_STA_CD) > 0 THEN 'Y'
                                               ELSE 'N'
			               END)
			        FROM TBDCMACM023H AA
			       WHERE AA.APV_DOC_NO = T22.APV_DOC_NO
			         AND AA.APV_DVSN_CD = T22.APV_DVSN_CD
			         AND APVR_STA_CD = '401') AS HIS_RESTORE_YN
            FROM TBDCMACM022L T22
		   WHERE 1=1
		     AND T22.APV_DOC_NO=#strDocNo#
		     AND T22.APV_DVSN_CD=#strApvDvsnCd#
	
	]]>
	</select>

	<!-- 해당문서 결재자목록 조회 -->
	<select id="dcmacm047ApprUsrSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
	    SELECT 	L.APV_SNO,
		        L.APV_DVSN_CD,
		        L.APV_DOC_NO,
		        F_USR_INFO (L.APVR_CNB,'2') AS APVR_USR_NAM,
		        F_USR_INFO (L.APVR_CNB,'1') AS USR_ID,
		        F_DPT_INFO (L.APVR_DPT_CD,'1') AS APVR_DPT_NM,
		        F_DPT_INFO (L.APVR_DPT_CD,'4') AS APVR_DPT_NM_2, /* 약칭부서명 추가 - 2017.03.31 yyh */		        
		        L.APVR_DPT_CD,
		        F_CODE_NM ('1000173',L.APVR_RANK_CD) AS APVR_RANK_NM,
		        APVR_RANK_CD,
		        F_CODE_NM ('1000176',L.APVR_PST_CD)|| 
		                                              CASE WHEN ONR_PST_NM LIKE '%직무대리%' THEN ' 직무대리' 
		                                                   WHEN ONR_PST_NM LIKE '%권한대행%' THEN ' 권한대행' 
		                                                   ELSE '' 
		                                               END AS APVR_PST_NM,
		        L.APVR_PST_CD,
		        L.APV_DH,
		        L.APVR_STA_CD,
		        L.APVR_CNB,
		        L.APV_OPIN,
                CASE WHEN L.APV_OPIN IS NOT NULL THEN TRIM(SUBSTRB(L.APV_OPIN,0,22)) || '...'
                     ELSE '' 
                 END                                AS APV_OPIN_2, /* 자른 결재의견 추가 - 2017.03.31 yyh */
		        L.APVR_KND_CD,
		        L.APVR_SEQ,
		        L.ONR_PST_NM
		        ,NVL((SELECT MIN(H.APV_DH) 
		            FROM TBDCMACM023H H 
		           WHERE H.APV_DOC_NO = L.APV_DOC_NO
		             AND H.APVR_CNB = L.APVR_CNB
		             AND SUBSTR(H.APVR_STA_CD,0,1) = '2'
		             AND SUBSTR(L.APVR_STA_CD,0,1) = '2'
		             ),L.APV_DH) AS FRT_APV_DH /* 최초 결재 일자 (실지감사에서 사용) */
		             ,VACANCY_CD
		             ,NVL(L.READ_YN,'N') AS READ_YN
	   FROM TBDCMACM023L L
	  WHERE 1=1
        AND L.APV_DOC_NO=#strDocNo#
        AND L.APV_DVSN_CD=#strApvDvsnCd#
      ORDER BY L.APV_SNO, L.APVR_KND_CD, L.APVR_SEQ
	
	]]>
	</select>

	<!-- 결재가능자 확인 조회 -->
	<select id="dcmacm047ApprUsrChkSelect" parameterClass="paramMap"
		resultClass="java.lang.String">
	<![CDATA[
		SELECT COUNT(*) AS CNT
          FROM TBDCMACM023L
	     where APV_DOC_NO =#strDocNo#
           AND APVR_CNB=#strApvrCnb#
           AND APVR_STA_CD < 200
           AND APVR_STA_CD IS NOT NULL
	
	]]>
	</select>


	<!-- 사용자별메뉴 사용현황 -->
	<select id="dcmacm049UsrMenuSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<include refid="include.pageSelct" />
	<![CDATA[
      SELECT A.SIT_CD	/* 사이트코드 */
	       , B.SIT_NM /* 사이트명 */
	       , '메뉴위치미정' AS MENU_LOC	/* 메뉴위치 */
	       , A.RQS_DH	/* 요청일시 */
	       , A.CNB	/* 전산번호 */
	       , D.DPT_CD	/* 부서코드 */
	       , D.DPT_NM	/* 부서명 */
	       , C.USR_ID	/* 아이디 */
	       , C.USR_NAM	/* 이름 */
	       , A.RQS_IP_NO	/* IP */
	       , A.RQS_SVC_ID
	       , A.RQS_SVC_PRMT_TXT	/* 파라미터 */
	       , A.LVL_MNU_NM_1
	       , A.LVL_MNU_NM_2
	       , A.LVL_MNU_NM_3
	       , A.LVL_MNU_NM_4
	       , A.LVL_MNU_NM_5
	       , E.RESOURCE_DESC AS MNU_NM
        FROM TBDCMACM014H A
  	       , TBDCMACM016M B
  	       , TBDCMACM001M C
  	       , TBDCMACM002M D
  	       , COMMON_RESOURCE E
       WHERE A.SIT_CD = B.SIT_CD
         AND A.CNB = C.CNB
         AND A.FNL_DEAL_DPT_CD = D.DPT_CD
         AND A.RQS_DH BETWEEN #strFrom#||'000000' AND #strTo#||'235959'
         AND A.MNU_ID = E.RESOURCE_NAME  
	]]>
		<isNotEmpty prepend="AND" property="strSitCd">
			A.SIT_CD LIKE
			#strSitCd#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strMnuId">
			E.RESOURCE_DESC LIKE	#strMnuId#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strUsrCnb">
			A.CNB LIKE #strUsrCnb#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strDptCd">
			D.DPT_CD LIKE
			#strDptCd#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strIp">
			RQS_IP_NO LIKE
			#strIp#||'%'
		</isNotEmpty>
		ORDER BY A.RQS_DH DESC
		<include refid="include.pageOrder" />
	</select>


	<!-- 사용자별 엑셀 export -->
	<select id="dcmacm049ExcelSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
      SELECT A.SIT_CD	/* 사이트코드 */
	       , B.SIT_NM /* 사이트명 */
	       , A.LVL_MNU_NM_1 /*메뉴뎁스1*/
	       , A.LVL_MNU_NM_2 /*메뉴뎁스2*/
	       , A.LVL_MNU_NM_3 /*메뉴뎁스3*/
	       , A.LVL_MNU_NM_4 /*메뉴뎁스4*/
	       , A.LVL_MNU_NM_5 /*메뉴뎁스5*/
	       , A.RQS_DH	/* 요청일시 */
	       , A.CNB	/* 전산번호 */
	       , C.DPT_CD	/* 부서코드 */
	       , D.DPT_NM	/* 부서명 */
	       , C.USR_ID	/* 아이디 */
	       , C.USR_NAM	/* 이름 */
	       , A.RQS_IP_NO	/* IP */
	       , A.RQS_SVC_ID
	       , A.RQS_SVC_PRMT_TXT	/* 파라미터 */
        FROM TBDCMACM014H A
  	       , TBDCMACM016M B
  	       , TBDCMACM001M C
  	       , TBDCMACM002M D
  	       , COMMON_RESOURCE E
       WHERE A.SIT_CD = B.SIT_CD
         AND A.CNB = C.CNB
         AND A.FNL_DEAL_DPT_CD = D.DPT_CD
         AND A.RQS_DH BETWEEN #strFrom#||'000000' AND #strTo#||'235959'
          AND A.MNU_ID = E.RESOURCE_NAME  
	]]>
		<isNotEmpty prepend="AND" property="strSitCd">
			A.SIT_CD LIKE
			#strSitCd#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strMnuId">
			E.RESOURCE_DESC LIKE	#strMnuId#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strUsrCnb">
			A.CNB LIKE #strUsrCnb#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strDptCd">
			D.DPT_CD LIKE
			#strDptCd#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strIp">
			RQS_IP_NO LIKE
			#strIp#||'%'
		</isNotEmpty>
	</select>

	<select id="dcmacm051UsrToLoginSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
        SELECT USE_DH, COUNT(USE_DH) AS CNT
         FROM (SELECT SUBSTR(TO_CHAR(LOGIN_DATE,'YYYYMMDDHH24MISS'),0,8) AS USE_DH
                 FROM PTL_LOG
                WHERE TO_CHAR(LOGIN_DATE,'YYYYMMDDHH24MISS') BETWEEN #strFrom#||'000000' AND #strTo#||'235959'
                 AND ACTION_TYPE ='LOGIN'
               GROUP BY SUBSTR(TO_CHAR(LOGIN_DATE,'YYYYMMDDHH24MISS'),0,8), CNB
             ) A
         GROUP BY USE_DH
         ORDER BY USE_DH DESC
		]]>
	</select>   

	<select id="dcmacm050UsrLoginSelect" parameterClass="paramMap"	resultClass="resultMap">
		<include refid="include.pageSelct" />
	<![CDATA[
      SELECT A.LOGIN_DATE
           , A.CNB
           , A.USER_ID
           , A.USER_IP
           , B.USR_NAM
           , A.ACTION_TYPE
           , B.DPT_CD
           , B.RANK_CD
           , F_CODE_NM('1000173',B.RANK_CD) AS RANK_NM
           , F_DPT_INFO(B.DPT_CD ,'1') DPT_NM

        FROM PTL_LOG A, TBDCMACM001M B
       WHERE 1=1
         AND A.CNB =B.CNB
         AND A.ACTION_TYPE ='LOGIN'
         AND A.LOGIN_DATE BETWEEN #strFrom#||'000000' AND #strTo#||'235959'
  		]]>
		<isNotEmpty prepend="AND" property="strIp">
			A.USER_IP LIKE
			#strIp#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strDptCd">
			B.DPT_CD LIKE
			#strDptCd#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strUsrCnb">
			A.CNB LIKE #strUsrCnb#||'%'
		</isNotEmpty>
		<include refid="include.pageOrder" />
	</select>
	
	<select id="dcmacm050ExcelSelect" parameterClass="paramMap"	resultClass="resultMap">
	<![CDATA[
      SELECT A.LOGIN_DATE
           , A.CNB
           , A.USER_ID
           , A.USER_IP
           , B.USR_NAM
           , A.ACTION_TYPE
           , B.DPT_CD
           , B.RANK_CD
           , F_CODE_NM('1000173',B.RANK_CD) AS RANK_NM
           , C.DPT_NM

        FROM PTL_LOG A, TBDCMACM001M B, TBDCMACM002M C
       WHERE 1=1
         AND A.CNB =B.CNB
         AND B.DPT_CD = C.DPT_CD
         AND A.ACTION_TYPE ='LOGIN'
         AND A.LOGIN_DATE BETWEEN #strFrom#||'000000' AND #strTo#||'235959'
  		]]>
		<isNotEmpty prepend="AND" property="strIp">
			A.USER_IP LIKE
			#strIp#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strDptCd">
			B.DPT_CD LIKE
			#strDptCd#||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strUsrCnb">
			A.CNB LIKE #strUsrCnb#||'%'
		</isNotEmpty>
	</select>	
	
	
	<!-- 소속부서 과장 조회 -->
	<select id="dcmacm046UsrPstSelect" parameterClass="paramMap" resultClass="resultMap">

		SELECT USR_DVSN_CD
		, F_CODE_NM('1000338',USR_DVSN_CD) AS USR_DVSN_NM
		, ORG_CD
		, F_ORG_INFO(ORG_CD,'1')
		AS ORG_NM
		, CNB
		, DPT_CD
		, F_DPT_INFO(DPT_CD,'1') AS DPT_NM
		, USR_ID
		,USR_NAM
		, RQS_STA_CD
		, RLS_DT
		, TNB
		, RANK_CD
		, F_CODE_NM('1000173',RANK_CD) AS RANK_NM
		, PST_CD
		, F_CODE_NM('1000176',PST_CD) AS PST_NM
		, EIN
		, EML_AD
		
		, BAI_USR_YN
		, '' ZCD
		, APM_DVSN_CD
		,HOM_TNB , RQS_TXT
		, LOGIN_WAY_CD
		, ONR_PST_NM		/*전자감사 기안문에 표시될 직위명*/
		FROM TBDCMACM001M
		WHERE DPT_CD =#strDptCd#
		AND PST_CD='0013600'
		AND RQS_STA_CD = '3'
		AND RSG_DT IS NULL
		AND ROWNUM=1
	</select>

	<select id="dcmacm011CoptSgSelect" parameterClass="paramMap" resultClass="resultMap">
		SELECT SUBSTR(ORG_CD,1,3) AS ORG_CD,
		ORG_NM
		FROM TBDCMACM015M
		WHERE ORG_CD = COPT_SG_CD||'000000000'
		AND  USE_DVSN_NO ='Y'
		ORDER BY ORG_NM
	</select>
	
	<select id="dcmacm011CoptSg2Select" parameterClass="paramMap" resultClass="resultMap">
		SELECT CASE WHEN LENGTH(COPT_SG_2_CD) = 3 THEN SUBSTR(ORG_CD,1,3) ELSE SUBSTR(ORG_CD,1,6) END AS ORG_CD,
		ORG_NM
		FROM TBDCMACM015M
		WHERE ORG_CD = RPAD(COPT_SG_2_CD,12,'0')
		AND  USE_DVSN_NO ='Y'
		ORDER BY ORG_NM
	</select>
	
	<!-- 결재 푸시 TO_DO_LIST INSERT -->
	<!-- 결재자 신규 -->
	<insert id="dcmacm045PushOrderListInsert" parameterClass="paramMap">
		INSERT
		INTO
		PTL_ORDER_LIST
		(
		  SEQ
		, TITLE
		, CONTENT
		, CRT_DT
		, CRT_USER_ID
		, STRT_DT
		, END_DT
		, IMP_YN
		, MSN_YN
		, NA_YN
		, NA_DT
		, DOC_NO
		, APV_DVSN_CD
		, ORDER_TYPE_CD		
		)
		VALUES
		(
		  #SEQ#
		, #TITLE#
		, #CONTENT#
		, TO_CHAR(SYSDATE,'yyyymmddhh24miss')
		, #FNL_USR_ID#
		, TO_CHAR(SYSDATE,'yyyymmddhh24miss')
		, ''
		, 'N'
		, 'N'
		, ''
		, ''
		, #APV_DOC_NO#
		, #APV_DVSN_CD#
		, '03'
		)
	</insert>
	
	<!-- 푸시 상신시 연계 -->	
	<insert id="dcmacm045PushOrderReceiveInsert" parameterClass="paramMap">
		INSERT
		INTO
		PTL_ORDER_RECEIVE_LIST
		(
			  SEQ
			, USER_ID
			, COMP_CMMT
			, CRE_DT
			, COMP_DT
	        , SRT_NO		
		)
		VALUES
		(
			  #SEQ#
			, #USR_ID#
			, #COMP_CMMT#
			, TO_CHAR(SYSDATE,'yyyymmddhh24miss')
			, TO_CHAR(SYSDATE,'yyyymmddhh24miss')
			, #APVR_SEQ#
		)
	</insert>
	
	<!-- 결재 푸시 다음결재자연계 -->
	<insert id="dcmacm045PushOrderNotiInsert" parameterClass="paramMap">
			INSERT
			INTO
			PTL_ORDER_NOTI
			(
			  SEQ
			, NOTI_SEQ
			, USER_ID
			, TITLE
			, CRT_DT
			, IMP_YN
			, USE_YN
			)
			VALUES
			(
			  #SEQ#
			, #NOTI_SEQ#
			, #USR_ID#
			, #TITLE#
			, TO_CHAR(SYSDATE,'yyyymmddhh24miss')
			, 'N'
			, DECODE(#USR_ID#,#FRT_USR_ID#,'N','Y')
			)
	</insert>
	
	<update id="dcmacm045PushOrderReceiveUpdate" parameterClass="paramMap">
		MERGE INTO	PTL_ORDER_RECEIVE_LIST A
					USING	(	SELECT	#USR_ID# 	AS USR_ID
										,#SEQ# 		AS SEQ
										,#APVR_SEQ# AS SRT_NO
								FROM	DUAL
							) B
					ON	(	
					    			A.USER_ID = B.USR_ID
				    	    	AND A.SEQ 	  = B.SEQ
						    	AND A.SRT_NO  = B.SRT_NO
						)
				WHEN	MATCHED	THEN
					UPDATE
					   SET 	COMP_CMMT = #COMP_CMMT#
				 	  	  , COMP_DT =  TO_CHAR(SYSDATE,'yyyymmddhh24miss')
				WHEN	NOT MATCHED THEN
					INSERT	(
								  SEQ
								, USER_ID
								, COMP_CMMT
								, CRE_DT
								, COMP_DT
						        , SRT_NO		
							)
							VALUES
							(
								  #SEQ#
								, #USR_ID#
								, #COMP_CMMT#
								, TO_CHAR(SYSDATE,'yyyymmddhh24miss')
								, TO_CHAR(SYSDATE,'yyyymmddhh24miss')
								, #APVR_SEQ#
							)
	</update>
	
		
	<update id="dcmacm045PushOrderListUpdate" parameterClass="paramMap">
		UPDATE PTL_ORDER_LIST
		SET NA_YN ='Y'
		  , NA_DT= TO_CHAR(SYSDATE,'yyyymmddhh24miss')		
		WHERE 1 = 1
		  AND SEQ = #SEQ#
	</update>
	
	
	<update id="dcmacm045PushOrderNotiUpdate" parameterClass="paramMap">
		UPDATE
		PTL_ORDER_NOTI
		SET TITLE =#TITLE#
		WHERE 1 = 1
		  AND USER_ID=#USR_ID#
		  AND SEQ = #SEQ#
	</update>	
	
	<!-- 푸시orderlist max seq -->
	<select id="dcmacm045PushMaxSeq" parameterClass="paramMap"	resultClass="java.lang.String">
		SELECT NVL(MAX(SEQ),'1000000')+1 FROM PTL_ORDER_LIST
	</select>
	
	<!-- 푸시 noti max seq -->
	<select id="dcmacm045PushNotiMaxSeq" parameterClass="paramMap"	resultClass="java.lang.String">
		SELECT NVL(MAX(NOTI_SEQ),'1000000')+1 FROM ptl_order_noti
		WHERE SEQ =#SEQ#
	</select>
	
	<!-- 문서번호에 해당하는 order seq -->
	<select id="dcmacm045PushOrderSeq" parameterClass="paramMap" resultClass="resultMap">
		SELECT TO_CHAR(MAX(SEQ)) AS SEQ
		FROM PTL_ORDER_LIST
		WHERE DOC_No =#APV_DOC_NO#
	</select>
	
	<!-- 권한에 따른 부서 리스트 공통팝업 -->
	<select id="dcmacm006DptListselect" parameterClass="paramMap"	resultClass="resultMap">
		SELECT DPT_CD
		     , DPT_NM
		  FROM TBDCMACM002M
		  WHERE 1=1 
		   AND USE_YN ='Y'
	 <isNotEmpty prepend="AND" property="strUsrDptAuth"> 
         DPT_CD IN ( SELECT DPT_CD FROM TABLE(F_AUTH_DEPT(#strUsrCnb#, #strUsrDptAuth#, 'Y')))
     </isNotEmpty>
     ORDER BY DPT_SNO, DPT_CD
	</select>
	
	<!-- 메신저연계 max seq -->
	<select id="dcmacm045MsgMaxSeq" parameterClass="paramMap"	resultClass="java.lang.String">
		SELECT NVL(MAX(MSG_SNO),'0')+1 AS MSG_SNO FROM TBDCMACM026L
	</select>
		
	
	<!-- 메신저 push 대상 추가 -->	
	<insert id="dcmacm045MsgPushInsert" parameterClass="paramMap">			
			INSERT INTO
			TBDCMACM026L
			(
			  MSG_SNO
			, TSK_CAT_CD
			, FUNC_CAT_CD
			, SEND_ID
	        , MSG_TP_YN	  
	        , MSG_TXT_2
	        , RCNT_CNT
	        , RCNT_HIS
	        , MSG_REGI_DH	
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			,
			FNL_MDF_DH	
			)
			VALUES
			(
			  #MSG_SNO#
			, 'CM'
			, 'CM'
			, #FNL_USR_ID#
	        , '0'	     
	        , #TITLE#
	        , #RCNT_CNT#
	        , #RCNT_HIS#
	        , SYSDATE 
			, #FNL_USR_ID#
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
			, SYSDATE
			, SYSDATE	
			);

	</insert>
	
	<!-- 소속순 직원명부 -->
	<!-- <select id="dcmportalDptUsrSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT DPT_NM, DPT_CD
			  FROM (
			        SELECT DPT_CD, '['||DPT_NM||']' AS DPT_NM, DPT_CD AS DPT_SNO
			          FROM TBDCMACM002M
			         WHERE USE_YN = 'Y'
			           AND SUBSTR(DPT_CD, 3,6) = '0000'  
			        UNION ALL 
			        SELECT DPT_CD, '<'||ABR_DPT_NM_1||'>' AS DPT_NM, HIRK_DPT_CD||DPT_CD AS DPT_SNO
			          FROM TBDCMACM002M
			         WHERE USE_YN = 'Y'
			           AND SUBSTR(HIRK_DPT_CD, 3,6) = '0000'
			        UNION ALL
			        SELECT A.DPT_CD
			             , USR_NAM||NVL(DECODE(LENGTH(F_CODE_NM('1000173', A.RANK_CD)),2,'('||SUBSTR(F_CODE_NM('1000173', A.RANK_CD),1,1)||') ', ''),'') AS DPT_NM
			             , B.HIRK_DPT_CD||B.DPT_CD||'000'||DECODE(A.RANK_CD,'187','0',A.RANK_CD) AS DPT_SNO
			          FROM TBDCMACM001M A, TBDCMACM002M B
			         WHERE A.DPT_CD = B.DPT_CD
			           AND B.USE_YN = 'Y'
			           AND A.DPT_CD != '880880'
			           AND A.RQS_STA_CD = '3'
			           AND A.WOK_DVSN_CD IN ('AAA','AAB','ABA','ABB')
			           AND B.DPT_CD NOT IN ('150150','150160','150170')
			 )
			 ORDER BY DPT_SNO, DPT_CD
 		]]>
	</select> -->
	<select id="dcmportalDptUsrSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
			SELECT DPT_CD,
		       '['||DPT_NM||']' AS DPT_NM,
		       SRT_SNO,
		       DPT_SNO,
		       A.SRT_SNO*10 AS AA,
		       1 AS ABC ,
		       NULL RAL_BLT_DIV_CD,
		       NULL INN_RANK_CD ,
		       NULL RANK_SRT_SEQ_NM,
		       NULL CRNT_RANK_APM_DT,
		       NULL SRT_KY_NO,
		       NULL CRNT_DPT_APM_DT,
		       NULL FIRST_IHIDN /*NULL EIN*/
		  FROM TBDCMACM002M A
		 WHERE A.USE_YN = 'Y'
		   AND (A.DPT_CD LIKE '%000'
		            OR A.DPT_CD in ('770770'))
		   AND A.DPT_CD NOT IN '400000'
		UNION ALL
		SELECT DPT_CD,
		       '<'||ABR_DPT_NM_1||'>' AS DPT_NM,
		       SRT_SNO,
		       DPT_SNO,
		       (SELECT B.SRT_SNO*10+A.SRT_SNO
		          FROM TBDCMACM002M B
		         WHERE B.DPT_CD = substring(A.DPT_CD, 1, 3)||'000') AS AA ,
		       2 AS ABC ,
		       NULL RAL_BLT_DIV_CD,
		       NULL INN_RANK_CD ,
		       NULL RANK_SRT_SEQ_NM,
		       NULL CRNT_RANK_APM_DT,
		       NULL SRT_KY_NO,
		       NULL CRNT_DPT_APM_DT,
		       NULL FIRST_IHIDN /*NULL EIN*/
		       
		  FROM TBDCMACM002M A
		WHERE A.USE_YN = 'Y'
		   AND A.DPT_CD NOT LIKE '%000'
		   AND A.DPT_CD NOT IN ('770770','880880','150150','150160','150170','150180')
		 UNION ALL
		SELECT A.DPT_CD ,
		       USR_NAM||NVL(DECODE(LENGTH(F_CODE_NM('1000173', A.RANK_CD)), 2, '('||SUBSTR(F_CODE_NM('1000173', A.RANK_CD), 1, 1)||') ', ''), '') AS DPT_NM ,
		       SRT_SNO,
		       DPT_SNO,
		       CASE
		         WHEN A.DPT_CD LIKE '%000'
		    OR A.DPT_CD IN ('770770') THEN B.SRT_SNO*10
		         ELSE (SELECT S.SRT_SNO*10+B.SRT_SNO
		          FROM TBDCMACM002M S
		         WHERE S.DPT_CD = substring(B.DPT_CD, 1, 3)||'000')
		       END AA ,
		       3 AS ABC ,
		       RAL_BLT_DIV_CD,
		       INN_RANK_CD ,
		       RANK_SRT_SEQ_NM,
		       CRNT_RANK_APM_DT,
		       SRT_KY_NO,
		       CRNT_DPT_APM_DT,
		       FIRST_IHIDN /*EIN*/
		  FROM TBDCMACM001M A,
		       TBDCMACM002M B
		 WHERE A.DPT_CD = B.DPT_CD
		   AND B.USE_YN = 'Y'
		   AND A.DPT_CD NOT IN ( '880880')
		   AND A.RQS_STA_CD = '3'
		   AND A.WOK_DVSN_CD IN ('AAA','AAB','ABA', 'ABB')
		   AND B.DPT_CD NOT IN ('150150','150160','150170','400000','150180')
		 ORDER BY TO_NUMBER(AA),
		       ABC,
		       RAL_BLT_DIV_CD,
		       NVL(INN_RANK_CD, '50') ASC ,
		       RANK_SRT_SEQ_NM,
		       CRNT_RANK_APM_DT,
		       SRT_KY_NO,
		       CRNT_DPT_APM_DT,
		       FIRST_IHIDN /*EIN*/
]]>
	</select>
	
	<!-- 성명순 직원명부1 -->
	<select id="dcmportalUsr1Select" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
		SELECT USR_NAM||NVL(DECODE(LENGTH(F_CODE_NM('1000173', A.RANK_CD)),2,'('||SUBSTR(F_CODE_NM('1000173', A.RANK_CD),1,1)||') ', ''),'')||D.ABR_DPT_NM_1 AS MEM
		  FROM TBDCMACM002M D, TBDCMACM001M A 
		 WHERE D.USE_YN = 'Y'
		   AND D.DPT_CD = A.DPT_CD
		   AND A.DPT_CD != '880880'
		   AND A.WOK_DVSN_CD IN ('AAA','AAB','ABA','ABB')
		   AND A.DPT_CD NOT IN ('150150','150160','150170')  
		   AND A.RQS_STA_CD = '3'
		  ORDER BY A.USR_NAM
		]]>
	</select>
	
	
	<!-- 성명순 직원명부2 -->
	<select id="dcmportalUsr2Select" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
			SELECT USR_NAM||DECODE(LENGTH(RANK_NM),2,'('||SUBSTR(RANK_NM,1,1)||')', '')||' '||TNB||' '||ABR_DPT_NM_1 AS MEM
			  FROM (
			SELECT USR_NAM
			    , F_CODE_NM('1000173', A.RANK_CD) AS RANK_NM
			    , D.ABR_DPT_NM_1
			    , CASE WHEN LENGTH(A.TNB) > 4 THEN SUBSTR(A.TNB,LENGTH(A.TNB)-3,LENGTH(A.TNB))
			           ELSE A.TNB
			       END AS TNB
			  FROM TBDCMACM002M D, TBDCMACM001M A 
			 WHERE D.USE_YN = 'Y'
			   AND D.DPT_CD = A.DPT_CD
			   AND A.DPT_CD != '880880'
			   AND A.WOK_DVSN_CD IN ('AAA','AAB','ABA','ABB')
			   AND A.DPT_CD NOT IN ('150150','150160','150170')  
			   AND A.RQS_STA_CD = '3'
			       )
			  ORDER BY USR_NAM
		]]>
	</select>
	
	
	<!-- 부서벌 직원명부1 -->
	<select id="dcmacm049ReportSelect2" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
		SELECT F_DPT_INFO(FNL_DEAL_DPT_CD,'1') AS DPT_NM
		     /*, B.RESOURCE_DESC AS MNU_NM
		     , A.MNU_ID*/
		     , LVL_MNU_NM_1
		     , LVL_MNU_NM_2
		     , LVL_MNU_NM_3
		     , LVL_MNU_NM_4
		     , LVL_MNU_NM_5
		     , COUNT(A.FNL_DEAL_DPT_CD) AS CNT
		  FROM TBDCMACM014H A
		     , COMMON_RESOURCE B
		 WHERE RQS_SVC_ID ='/biz/com/auth/auth.do'
		   AND A.MNU_ID = RESOURCE_NAME
		   		 ]]>
		<isNotEmpty prepend="AND" property="strDptCd">
		    FNL_DEAL_DPT_CD=#strDptCd#
		 </isNotEmpty>
		 <isNotEmpty prepend="AND" property="strIp">
		    RQS_IP_NO LIKE '%'||#strIp#||'%'
		 </isNotEmpty>
		 <isNotEmpty prepend="AND" property="strUsrCnb">
		    CNB=#strUsrCnb#
		 </isNotEmpty>
		    AND TO_CHAR(RQS_DH,'YYYYMMDD') BETWEEN #strFrom# AND #strTo# 
		 GROUP BY FNL_DEAL_DPT_CD, MNU_ID,LVL_MNU_NM_1,
		          LVL_MNU_NM_2, LVL_MNU_NM_3,LVL_MNU_NM_4, LVL_MNU_NM_5
		 ORDER BY FNL_DEAL_DPT_CD, LVL_MNU_NM_1, LVL_MNU_NM_2, LVL_MNU_NM_3,LVL_MNU_NM_4, LVL_MNU_NM_5
	</select>
	
	
		<!-- 메뉴별 직원명부1 -->
	<select id="dcmacm049ReportSelect1" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
		SELECT 
		     /*  B.RESOURCE_DESC AS MNU_NM
		     , A.MNU_ID
		     ,*/
		      LVL_MNU_NM_1
		     , LVL_MNU_NM_2
		     , LVL_MNU_NM_3
		     , LVL_MNU_NM_4
		     , LVL_MNU_NM_5
		     , COUNT(A.FNL_DEAL_DPT_CD) AS CNT
		  FROM TBDCMACM014H A
		     , COMMON_RESOURCE B
		 WHERE RQS_SVC_ID ='/biz/com/auth/auth.do'
		   AND A.MNU_ID = RESOURCE_NAME
		   		 ]]>
		<isNotEmpty prepend="AND" property="strDptCd">
		    FNL_DEAL_DPT_CD=#strDptCd#
		 </isNotEmpty>
		 <isNotEmpty prepend="AND" property="strIp">
		    RQS_IP_NO LIKE '%'||#strIp#||'%'
		 </isNotEmpty>
		 <isNotEmpty prepend="AND" property="strUsrCnb">
		    CNB=#strUsrCnb#
		 </isNotEmpty>
		    AND TO_CHAR(RQS_DH,'YYYYMMDD') BETWEEN #strFrom# AND #strTo# 
		 GROUP BY LVL_MNU_NM_1,
		          LVL_MNU_NM_2, LVL_MNU_NM_3,LVL_MNU_NM_4, LVL_MNU_NM_5
		 ORDER BY LVL_MNU_NM_1, LVL_MNU_NM_2, LVL_MNU_NM_3,LVL_MNU_NM_4, LVL_MNU_NM_5
	</select>
	
	<select id="dcmacm047PushCnbList" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	APVR_CNB
			FROM	TBDCMACM023L
			WHERE	APV_DOC_NO = #strDocNo# 
		]]>
	</select>
	
	<select id="DCMACM001IfSeqSelect" parameterClass="paramMap" resultClass="Integer">
		<![CDATA[
			SELECT	IF_SEQ.NEXTVAL
			FROM	DUAL
		]]>
	</select>
	
	<select id="DCMACM001IfFileSeqSelect" parameterClass="paramMap" resultClass="Integer">
		<![CDATA[
			SELECT	IF_FILE_SEQ.NEXTVAL
			FROM	DUAL
		]]>
	</select>
	
	<insert id="DCMACM001BAI_INF_DB_SND_001Insert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	BAI_INF_DB_SND_001
					(	IF_SEQ			/*연계순번*/
						,TARE_NM		/*테이블명*/
						,IF_REF_SEQ		/*참조연계순번*/
						,IF_STATUS		/*연계상태코드*/
						,IF_TRY			/*연계시도횟수*/
						,IF_RAISE_DT	/*IF_RAISE_DT*/
					)
			VALUES	(	#IF_SEQ#
						,#TARE_NM#
						,#IF_REF_SEQ#
						,'SS'
						,0
						,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
					)
		]]>
	</insert>
	
	<insert id="DCMACM001EH_INF_GR_AT_001Insert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	EH_INF_GR_AT_001
					(	IF_FILE_SEQ
						,IF_SEQ
						,TARE_NM
						,ATCH_FILE_ID
						,FILE_SN
						,FILE_STRE_COURS
						,STRE_FILE_NM
						,ORIGNL_FILE_NM
						,FILE_EXTSN
						,FILE_CN
						,FILE_SIZE
						,IF_FILE_CASE
						,FRT_USR_ID
					)
			VALUES	(	#IF_FILE_SEQ#
						,#IF_SEQ#
						,#TARE_NM#
						,#ATCH_FILE_ID#
						,#FILE_SN#
						,#FILE_STRE_COURS#
						,#STRE_FILE_NM#
						,#ORIGNL_FILE_NM#
						,#FILE_EXTSN#
						,#FILE_CN#
						,#FILE_SIZE#
						,#IF_FILE_CASE#
						,#FRT_USR_ID#
					)
		]]>
	</insert>
	
	<select id="DCMACM001ReceiveSelect" parameterClass="String" resultClass="resultMap">
		<![CDATA[
			SELECT	IF_SEQ
					,TARE_NM
					,IF_REF_SEQ
					,IF_TABLE_PK
			FROM	BAI_INF_DB_RCV_001
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<select id="DCMACM001HE_INF_EP_PS_001Select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	IF_SEQ
					,IF_TYPE
					,NTT_ID
					,BBS_ID
					,NTT_NO
					,NTT_SJ
					,NTT_CN
					,NTCR_NM
					,FLAG
					,FRST_REGIST_PNTTM
					,MAIN_IMG_ID
					,THUMB_IMG_ID
					,LIST_IMG_ID
			FROM	HE_INF_EP_PS_001
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<!-- 감사교육 수신 데이터 조회 -->
	<select id="DCMACM001HE_INF_SP_AE_004Select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	IF_SEQ
					,IF_TYPE
					,YR
					,CRS_CD
					,CRS_CDN
					,TANE_ID
					,NAM
					,BTDT
					,DPT_NM
					,HPN
					,PST_NM
					,RANK_NM
					,SEX_CD
					,WRK_PRD_TXT
					,DMT_UE_YN
					,SNDY_LODG_YN
					,RMK_SBJ
					,ORG_CD
					,IF_SIID
					,'HOMEPAGE' AS FNL_USR_ID
					,'HOMEPAGE' AS FNL_DEAL_DPT_CD
					,'HOMEPAGE' AS FNL_MNU_ID
			FROM	HE_INF_SP_AE_004
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<update id="DCMACM001BAI_INF_DB_RCV_001ERRORUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	BAI_INF_DB_RCV_001
			SET		IF_STATUS = #IF_STATUS#
					,IF_TABLE_PK = #IF_TABLE_PK#
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</update>
	
	<resultMap class="java.util.HashMap" id="spcp008Map">
		<result property="IF_SEQ" column="IF_SEQ" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="IF_TYPE" column="IF_TYPE" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="HMP_APL_NO" column="HMP_APL_NO" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CVPTR_NM" column="CVPTR_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="TNB" column="TNB" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="EML_ID" column="EML_ID" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="HPN" column="HPN" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ZCD" column="ZCD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="AD" column="AD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="DTL_AD" column="DTL_AD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CPNM_NM" column="CPNM_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="BZN" column="BZN" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_NM" column="CLM_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="WRK_PLAC_NM" column="WRK_PLAC_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_TNB" column="CLM_TNB" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_ZCD" column="CLM_ZCD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_AD" column="CLM_AD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_DTL_AD" column="CLM_DTL_AD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CVPT_KND_CD" column="CVPT_KND_CD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="TIT_NM" column="TIT_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CVPT_TXT" column="CVPT_TXT" jdbcType="CLOB" javaType="java.lang.String" />
		<result property="ACP_DH" column="ACP_DH" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="IF_SIID" column="IF_SIID" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CVPT_ACP_NO" column="CVPT_ACP_NO" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="DOC_ID" column="DOC_ID" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ACP_YR" column="ACP_YR" jdbcType="VARCHAR2" javaType="java.lang.String" />
	</resultMap>
	
	<select id="DCMACM001HE_INF_SP_CP_008Select" parameterClass="paramMap" resultMap="spcp008Map">
		<![CDATA[
			SELECT	IF_SEQ
					,IF_TYPE
					,HOME_REQ_ID	AS HMP_APL_NO
					,REQ_NM			AS CVPTR_NM
					,REQ_TEL		AS TNB
					,REQ_EML		AS EML_ID
					,REQ_HP			AS HPN
					,REQ_ZIP		AS ZCD
					,REQ_ADDR1		AS AD
					,REQ_ADDR2		AS DTL_AD
					,REQ_ORG		AS CPNM_NM
					,REQ_BSN_NO		AS BZN
					,RES_NM			AS CLM_NM
					,RES_ORG		AS WRK_PLAC_NM
					,RES_TEL		AS CLM_TNB
					,RES_ZIP		AS CLM_ZCD
					,RES_ADDR1		AS CLM_AD
					,RES_ADDR2		AS CLM_DTL_AD
					,JEBO_CD		AS CVPT_KND_CD
					,JEBO_TTL		AS TIT_NM
					,JEBO_CN		AS CVPT_TXT
					,JEBO_REG_DT	AS ACP_DH
					,IF_SIID		AS IF_SIID
					,(	SELECT	LPAD(TO_CHAR(NVL(MAX(TO_NUMBER(RM_CVPT_ACP_NO)),0)+1),5,0) AS RM_CVPT_ACP_NO
						FROM	TBCSPDCP101M
						WHERE	REQ_DVSN_CD = '1'
						AND		ACP_YR = SUBSTR(#JEBO_REG_DT#, 1,4)
					) AS CVPT_ACP_NO
					,'' AS DOC_ID
					,SUBSTR(#JEBO_REG_DT#, 1,4) AS ACP_YR
			FROM	HE_INF_SP_CP_008
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<resultMap class="java.util.HashMap" id="spcp009Map">
		<result property="IF_SEQ" column="IF_SEQ" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="IF_TYPE" column="IF_TYPE" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="HMP_APL_NO" column="HMP_APL_NO" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CVPTR_NM" column="CVPTR_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="TNB" column="TNB" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="EML_ID" column="EML_ID" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="HPN" column="HPN" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ZCD" column="ZCD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="AD" column="AD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="DTL_AD" column="DTL_AD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CPNM_NM" column="CPNM_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="BZN" column="BZN" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_NM" column="CLM_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="WRK_PLAC_NM" column="WRK_PLAC_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_TNB" column="CLM_TNB" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_ZCD" column="CLM_ZCD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_AD" column="CLM_AD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CLM_DTL_AD" column="CLM_DTL_AD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="TIT_NM" column="TIT_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CVPT_TXT" column="CVPT_TXT" jdbcType="CLOB" javaType="java.lang.String" />
		<result property="IF_SIID" column="IF_SIID" jdbcType="VARCHAR2" javaType="java.lang.String" />
	</resultMap>
	<select id="DCMACM001HE_INF_SP_CP_009Select" parameterClass="paramMap" resultMap="spcp009Map">
		<![CDATA[
			SELECT	IF_SEQ
					,IF_TYPE
					,HOME_REQ_ID	AS HMP_APL_NO
					,REQ_NM			AS CVPTR_NM
					,REQ_TEL		AS TNB
					,REQ_EML		AS EML_ID
					,REQ_HP			AS HPN
					,REQ_ZIP		AS ZCD
					,REQ_ADDR1		AS AD
					,REQ_ADDR2		AS DTL_AD
					,REQ_ORG		AS CPNM_NM
					,REQ_BSN_NO		AS BZN
					,RES_NM			AS CLM_NM
					,RES_ORG		AS WRK_PLAC_NM
					,RES_TEL		AS CLM_TNB
					,RES_ZIP		AS CLM_ZCD
					,RES_ADDR1		AS CLM_AD
					,RES_ADDR2		AS CLM_DTL_AD
					,JEBO_TTL		AS TIT_NM
					,JEBO_CN		AS CVPT_TXT
					,IF_SIID		AS IF_SIID
			FROM	HE_INF_SP_CP_009
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<select id="DCMACM001HE_INF_SP_CP_014Select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	IF_SEQ
					,IF_TYPE
					,HOME_REQ_ID		AS HMP_APL_NO
					,JEBO_CNCL_DT
					,IP_AD
					,E_RECV_NO			AS RM_CVPT_ACP_NO
					,E_RECV_YY			AS ACP_YR
					,IF_SIID
			FROM	HE_INF_SP_CP_014
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<select id="DCMACM001HE_INF_SP_IS_001Select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	IF_SEQ
					,IF_TYPE
					,CRPT_TYP_NM
					,'' AS DOC_ID
					,DOC_TYP_CD
					,INSP_TXT
					,NAM
					,WRIT_DH
					,TIT_NM
					,HPN
					,IF_SIID
					,(SELECT NVL(MAX(SNO),0) + 1 FROM TBCSPCIS002M) AS SNO
			FROM	HE_INF_SP_IS_001
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<select id="DCMACM001HE_HPDM010101_DM010101Select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	,IF_SEQ
					,IF_TYPE
					,AUD_SMT_MTRL_ID
					,AUD_SMT_MTRL_TIT_NM
					,RQR_CNB
					,SMT_DT
					,SMT_TXT
					,PRSR_NAM
					,PRSR_TNB
					,PRSR_EML_AD
					,PRSR_ORG_CD
					,SMT_ORG_CD
					,SMT_ORG_NM
					,SMT_ORG_BRDV_CD
					,SMT_ORG_BRDV_NM
					,RQR_DPT_CD
					,FRT_REGI_DH
					,IF_SIID
			FROM	HE_HPDM010101_DM010101
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<select id="DCMACM001EH_INF_GR_AT_002Select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	IF_FILE_SEQ
					,IF_SEQ
					,TARE_NM
					,ATCH_FILE_ID
					,FILE_SN
					,FILE_STRE_COURS
					,STRE_FILE_NM
					,ORIGNL_FILE_NM
					,FILE_EXTSN
					,FILE_CN
					,FILE_SIZE
					,IF_FILE_CASE
					,IF_CD
					,BIGO
					,FRT_USR_ID
					,IF_SIID
			FROM	EH_INF_GR_AT_002
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<update id="DCMACM001HE_INF_SP_CP_008DocIdUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		DOC_ID = #DOC_ID#
			WHERE	HMP_APL_NO = #IF_TABLE_PK#
		]]>
	</update>
	
	<update id="DCMACM001HE_INF_SP_IS_001DocIdUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPCIS002M
			SET		DOC_ID = #DOC_ID#
			WHERE	SNO = #IF_TABLE_PK#
		]]>
	</update>
	
	<update id="DCMACM001HE_HPDM010101_DM010101DocIdUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBDCMIDM001L
			SET		DOC_ID = #DOC_ID#
			WHERE	AUD_SMT_MTRL_ID = #IF_TABLE_PK#
		]]>
	</update>
	
	<update id="DCMACM001BaiNewsReceiveMerge" parameterClass="paramMap">
		<![CDATA[
			MERGE INTO	PTL_BAI_NEWS A
					USING	(	SELECT	#NTT_ID# AS NTT_ID
										,#BBS_ID# AS BBS_ID
								FROM	DUAL
							) B
					ON	(		A.NTT_ID = B.NTT_ID
							AND	A.BBS_ID = B.BBS_ID
						)
				WHEN	MATCHED	THEN
					UPDATE
					SET		NTT_NO 				= #NTT_NO#
							,NTT_SJ 			= #NTT_SJ#
							,NTT_CN 			= #NTT_CN#
							,NTCR_NM 			= #NTCR_NM#
							,FRST_REGIST_PNTTM 	= #FRST_REGIST_PNTTM#
							,MAIN_IMG_ID		= #MAIN_IMG_ID#
							,THUMB_IMG_ID		= #THUMB_IMG_ID#
							,LIST_IMG_ID		= #LIST_IMG_ID#
				WHEN	NOT MATCHED THEN
					INSERT	(	NTT_ID
								,BBS_ID
								,NTT_NO
								,NTT_SJ
								,NTT_CN
								,NTCR_NM
								,FRST_REGIST_PNTTM
								,MAIN_IMG_ID
								,THUMB_IMG_ID
								,LIST_IMG_ID
							)
					VALUES	(	#NTT_ID#
								,#BBS_ID#
								,#NTT_NO#
								,#NTT_SJ#
								,#NTT_CN#
								,#NTCR_NM#
								,#FRST_REGIST_PNTTM#
								,#MAIN_IMG_ID#
								,#THUMB_IMG_ID#
								,#LIST_IMG_ID#
							)
		]]>
	</update>
	
	<resultMap class="java.util.HashMap" id="enaisBoardMap">
		<result property="IF_SEQ" 		column="IF_SEQ"			jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="BRD_DVSN_CD"  column="BRD_DVSN_CD" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="SRNO" 		column="SRNO" 			jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="GRP_NO" 		column="GRP_NO" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="RPL_SNO" 		column="RPL_SNO" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="LVL_CNT" 		column="LVL_CNT" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="TIT_NM" 		column="TIT_NM" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="REGI_DH" 		column="REGI_DH" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="REGI_ORG_NM" 	column="REGI_ORG_NM" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="REGN_ID" 		column="REGN_ID" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="REGN_NM" 		column="REGN_NM" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="SRCH_CNT" 	column="SRCH_CNT" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="TXT" 			column="TXT" 			jdbcType="CLOB" javaType="java.lang.String" />
		<result property="DOC_ID" 		column="DOC_ID" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="DOC_TYP_CD" 	column="DOC_TYP_CD" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="TNB" 			column="TNB" 			jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="EML_AD" 		column="EML_AD" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="RMK" 			column="RMK" 			jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FRT_REGI_DH" 	column="FRT_REGI_DH" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FRT_USR_ID" 	column="FRT_USR_ID" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FNL_MDF_DH" 	column="FNL_MDF_DH" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FNL_USR_ID" 	column="FNL_USR_ID" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FNL_DEAL_DPT_CD" column="FNL_DEAL_DPT_CD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FNL_MNU_ID" 	column="FNL_MNU_ID" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ATCH_FILE_ID" column="ATCH_FILE_ID" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FILE_PATH" 	column="FILE_PATH" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FILE_NAME" 	column="FILE_NAME" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="S_FILE_NAME" 	column="S_FILE_NAME" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FILE_SIZE" 	column="FILE_SIZE" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FLAG" 		column="FLAG" 			jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="IF_STATUS" 	column="IF_STATUS" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="IF_TRY" 		column="IF_TRY" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="IF_RAISE_DT" 	column="IF_RAISE_DT" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="IF_DEAL_DT" 	column="IF_DEAL_DT" 	jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="IF_MESSG" 	column="IF_MESSG" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="IF_SIID" 		column="IF_SIID" 		jdbcType="VARCHAR2" javaType="java.lang.String" />
		
	</resultMap>
	<select id="DCMACM001HE_ENAIS_BOARDSelect" parameterClass="paramMap" resultMap="enaisBoardMap">
		<![CDATA[
			SELECT	IF_SEQ,
					BRD_DVSN_CD,
					SRNO,
					GRP_NO,
					RPL_SNO,
					LVL_CNT,
					TIT_NM,
					REGI_DH,
					REGI_ORG_NM,
					REGN_ID,
					REGN_NM,
					SRCH_CNT,
					TXT,
					DOC_ID,
					DOC_TYP_CD,
					TNB,
					EML_AD,
					RMK,
					FRT_REGI_DH,
					FRT_USR_ID,
					FNL_MDF_DH,
					FNL_USR_ID,
					FNL_DEAL_DPT_CD,
					FNL_MNU_ID,
					ATCH_FILE_ID,
					FILE_PATH,
					FILE_NAME,
					S_FILE_NAME,
					FILE_SIZE,
					FLAG,
					IF_STATUS,
					IF_TRY,
					IF_RAISE_DT,
					IF_DEAL_DT,
					IF_MESSG,
					IF_SIID
			FROM	HE_ENAIS_BOARD
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<insert id="DCMACM001TWFAACAV065LReceiveInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TWFAACAV065L
					(	BRD_DVSN_CD
						,SRNO
						,GRP_NO
						,RPL_SNO
						,LVL_CNT
						,TIT_NM
						,REGI_DH
						,REGI_ORG_NM
						,REGN_ID
						,REGN_NM
						,SRCH_CNT
						,TXT
						,DOC_ID
						,DOC_TYP_CD
						,TNB
						,EML_AD
						,RMK
						,FRT_REGI_DH
						,FRT_USR_ID
						,FNL_MDF_DH
						,FNL_USR_ID
						,FNL_DEAL_DPT_CD
						,FNL_MNU_ID
					)
			VALUES	(	#BRD_DVSN_CD#
						,#SRNO#
						,#GRP_NO#
						,#RPL_SNO#
						,#LVL_CNT#
						,#TIT_NM#
						,#REGI_DH#
						,#REGI_ORG_NM#
						,#REGN_ID#
						,#REGN_NM#
						,#SRCH_CNT#
						,#TXT#
						,''
						,''
						,#TNB#
						,#EML_AD#
						,#RMK#
						,SYSDATE
						,'BATCH'
						,SYSDATE
						,'BATCH'
						,'BATCH'
						,'BATCH'
					)
		]]>
	</insert>
	
	<update id="DCMACM001TWFAACAV065LReceiveUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE  TWFAACAV065L
			SET     TIT_NM = #TIT_NM#,
			        SRCH_CNT = #SRCH_CNT#,
			        TXT = #TXT#,
			        DOC_ID = #DOC_ID#,
			        TNB = #TNB#,
			        EML_AD = #EML_AD#
			WHERE   BRD_DVSN_CD = #BRD_DVSN_CD#
			AND		SRNO = #SRNO#
		]]>
	</update>
	
	<update id="DCMACM001TWFAACAV065LReceiveDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE  TWFAACAV065L
			WHERE   1=1
			AND     BRD_DVSN_CD = #BRD_DVSN_CD#
			AND		GRP_NO = #GRP_NO#
		]]>
	</update>
	
	<select id="DCMACM001EnaisIfSeqSelect" parameterClass="paramMap" resultClass="Integer">
		<![CDATA[
			SELECT	ENAIS_IF_SEQ.NEXTVAL AS IF_SEQ
			FROM	DUAL
		]]>
	</select>
	
	<select id="DCMACM001_NE_ENAIS_BOARD_Select" parameterClass="String" resultClass="resultMap">
		<![CDATA[
			SELECT  BRD_DVSN_CD
					,SRNO
					,GRP_NO
					,RPL_SNO
					,LVL_CNT
					,TIT_NM
					,REGI_DH
					,REGI_ORG_NM
					,REGN_ID
					,REGN_NM
					,SRCH_CNT
					,TXT
					,DOC_ID
					,DOC_TYP_CD
					,TNB
					,EML_AD
					,RMK
					,FRT_REGI_DH
					,FRT_USR_ID
					,FNL_MDF_DH
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,ATCH_FILE_ID
					,FILE_PATH
					,FILE_NAME
					,S_FILE_NAME
					,FILE_SIZE
					,FLAG
			FROM	NE_ENAIS_BOARD
			WHERE   IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<select id="DCMACM001TWFAACAV065LSelectDocID" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT DOC_ID
			  FROM TWFAACAV065L
			 WHERE BRD_DVSN_CD = #BRD_DVSN_CD#
			   AND SRNO = #SRNO#
		]]>
	</select>
	
	<update id="DCMACM001TWFAACAV065LReceiveMerge" parameterClass="paramMap">
		<![CDATA[
            MERGE INTO	TWFAACAV065L A
					USING	(	SELECT	#BRD_DVSN_CD# AS BRD_DVSN_CD
										,#SRNO# AS SRNO
								FROM	DUAL
							) B
					ON	(		A.BRD_DVSN_CD = B.BRD_DVSN_CD
								AND	A.SRNO = B.SRNO
						)
				WHEN	MATCHED	THEN
					UPDATE
					SET     TIT_NM = #TIT_NM#,
                            SRCH_CNT = #SRCH_CNT#,
                            TXT = #TXT#,
                           	DOC_ID = #DOC_ID#,
                            TNB = #TNB#,
                            EML_AD = #EML_AD#
				WHEN	NOT MATCHED THEN
					INSERT  (	BRD_DVSN_CD
                                ,SRNO
                                ,GRP_NO
                                ,RPL_SNO
                                ,LVL_CNT
                                ,TIT_NM
                                ,REGI_DH
                                ,REGI_ORG_NM
                                ,REGN_ID
                                ,REGN_NM
                                ,SRCH_CNT
                                ,TXT
                                ,DOC_ID
                                ,DOC_TYP_CD
                                ,TNB
                                ,EML_AD
                                ,RMK
                                ,FRT_REGI_DH
                                ,FRT_USR_ID
                                ,FNL_MDF_DH
                                ,FNL_USR_ID
                                ,FNL_DEAL_DPT_CD
                                ,FNL_MNU_ID
                            )
                    VALUES	(	#BRD_DVSN_CD#
                                ,#SRNO#
                                ,#GRP_NO#
                                ,#RPL_SNO#
                                ,#LVL_CNT#
                                ,#TIT_NM#
                                ,#REGI_DH#
                                ,#REGI_ORG_NM#
                                ,#REGN_ID#
                                ,#REGN_NM#
                                ,#SRCH_CNT#
                                ,#TXT#
                                ,#DOC_ID#
                                ,'ENAIS_연계파일'
                                ,#TNB#
                                ,#EML_AD#
                                ,#RMK#
                                ,SYSDATE
                                ,'BATCH'
                                ,SYSDATE
                                ,'BATCH'
                                ,'BATCH'
                                ,'BATCH'
                            )
		]]>
	</update>
	
	<update id="DCMACM001TWFAACAV065LERRORUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TWFAACAV065L
			SET		IF_STATUS = #IF_STATUS#
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</update>
	
	<select id="DCMACM001_NE_ENAIS_FILE_Select" parameterClass="String" resultClass="resultMap">
		<![CDATA[
			SELECT  FILE_PATH
					,FILE_NAME
					,S_FILE_NAME
			FROM    NE_ENAIS_FILE
			WHERE   IF_SEQ = #IF_SEQ#
		]]>
	</select>
	
	<update id="DCMACM001_NE_ENAIS_FILE_ERRORUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	NE_ENAIS_FILE
			SET		IF_STATUS = #IF_STATUS#
			WHERE	IF_SEQ = #IF_SEQ#
		]]>
	</update>
	
	<select id="dcmacm024ExcelExportSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[       
			SELECT DISTINCT DPT_CD /*부서코드*/
			     , DPT_NM /*부서명*/
			     , TNB /*전화번호*/
			     , USE_YN /*사용여부*/
			     , ABR_DPT_NM_1 /*약명1*/
			     , ABR_DPT_NM_2 /*약명2*/
			     , FRML_DPT_NM /*공식부서명*/
			     , STND_DPT_CD /*표준부서명*/
			     , FAN         /*팩스번호*/
			     , OW_DVDT_TXT /*사무분장내용*/
			     , DPT_TP_CD /*부서타입코드*/
			     , F_CODE_NM('1000459',DPT_TP_CD) AS DPT_TP_NM
			     , IMD_CD    /*직속코드*/
			     , F_CODE_NM('1000329',IMD_CD) AS IMD_NM
			     , DPT_SNO /*부서순번*/
			     , ZCD
			     , AD
			     /*, DTL_AD 2016.06.30*/			     
			     , HMP_AD			     
			     /*, SAL_DPT_CD 급여부서 2016.06.30
			     /*, SAL_DPT_NM 급여부서명 2016.06.30
			     /*, BK_DPT_NM 이전부서명 20160630*/
			     , HIRK_DPT_CD /*상위부서코드*/
			     , F_DPT_INFO(HIRK_DPT_CD,'1') AS HIRK_DPT_NM/*상위부서명*/			     
			     , SRT_SNO /*정렬순번*/			     
			     , ORZT_DVSN_CD /*조직구분코드*/ 
			     ,F_CODE_NM('1000481',ORZT_DVSN_CD) AS ORZT_DVSN_NM 
			     ,DPT_TP_CD_2  
			     , F_CODE_NM('1000805',DPT_TP_CD_2) AS DPT_TP_NM_2
			     , F_CODE_NM('1000804',LOC_DVSN_CD) AS LOC_DVSN_NM
			     ,LOC_DVSN_CD
			     , HOMP_OPN
			     , HOMP_SEC
			     , HOMP_DVDT_NM
			     , HOMP_OW_DVDT_TXT /* 홈페이지사무분장내용 추가 - 2019.08.28 yyh */
		      FROM TBDCMACM002M A
		     WHERE 1=1						
        ]]>

		<isNotEmpty prepend="AND" property="strDptCd">
			DPT_CD LIKE
			'%'||#strDptCd# ||'%'
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strDptNm">
			(DPT_NM LIKE
			'%'||#strDptNm# ||'%'OR ABR_DPT_NM_1 LIKE '%'||#strDptNm# ||'%' OR
			ABR_DPT_NM_2 LIKE '%'||#strDptNm# ||'%' OR FRML_DPT_NM LIKE '%'||#strDptNm#||'%' )
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strUseYn">
			USE_YN LIKE
			'%'||#strUseYn# ||'%'
		</isNotEmpty>		
	    <isNotEmpty property="strTreeUseYn">
			  START WITH USE_YN = #strTreeUseYn#
             CONNECT BY PRIOR HIRK_DPT_CD =DPT_CD 
		</isNotEmpty>
        
		 <![CDATA[    
		ORDER BY DPT_SNO, DPT_CD
		 ]]>
	</select>
	
	<select id="dcmacm045AppDocSeqSelect" parameterClass="paramMap" resultClass="java.lang.String">
		SELECT TO_CHAR(SYSDATE,'yyyy') || '-' || #S_DPT_NAM# || '-' || (COUNT(*)+1) AS APV_DOC_SEQ
		  FROM TBDCMACM022L
		 WHERE SUBSTR(APV_DOC_SEQ, 0, INSTR(APV_DOC_SEQ,'-',1,2)-1) = TO_CHAR(SYSDATE,'yyyy') || '-' || #S_DPT_NAM#
	</select>
	
	<update id="dcmacm045ApprSugUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE TBDCMACM022L
			   SET APV_TIT_NM 		= #APV_TIT_NM#
				 , APV_DOC_HTML_TXT = #APV_DOC_HTML_TXT#
				 , APV_STA_CD       = #APV_STA_CD#
				 , FRT_USR_ID 		= #FNL_USR_ID#
				 , FNL_MDF_DH 		= SYSDATE
				 , AUTO_CMPT_COPR_YN = #AUTO_CMPT_COPR_YN#
			 WHERE APV_DOC_NO   = #APV_DOC_NO#
			   AND APV_DVSN_CD  = #APV_DVSN_CD#
		]]>
	</update>
	
	<delete id="dcmacm045ApprSugAssignDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE FROM 
				(SELECT *
				   FROM TBDCMACM023L
				  WHERE APV_DOC_NO = #APV_DOC_NO#
				    AND APV_DVSN_CD = #APV_DVSN_CD#
				    AND (
				    	 SUBSTR(APVR_STA_CD,0,1) <> 2 
    	 				 OR APVR_STA_CD IS NULL
    	 				 )
    			)
		]]>
	</delete>
	
	<!-- 결재문서상태 히스토리 -->
	<insert id="dcmacm047ApprSugHistInsert" parameterClass="paramMap">
		INSERT INTO TBDCMACM022H	
			SELECT (SELECT NVL(MAX(SEQ), 0) + 1 FROM TBDCMACM022H) /*히스토리 순번*/
					,APV_DOC_NO
					,APV_DVSN_CD
					,TSK_KY_TXT
					,#APV_STA_CD# AS APV_STA_CD
					,APV_TIT_NM
					,SBM_CNB
					,SBM_DH
					,FNL_APV_CNB
					,FNL_APV_DH
					,FRT_USR_ID
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,SYSDATE AS FRT_REGI_DH
					,SYSDATE AS FNL_MDF_DH
					,APV_DOC_HTML_TXT
					,APV_DOC_SEQ
		   	  FROM TBDCMACM022L
			 WHERE APV_DOC_NO = #APV_DOC_NO#
			   AND APV_DVSN_CD = #APV_DVSN_CD#
	</insert>
	
	<!-- 결재문서별 결재자 완료 상태 히스토리 -->
	<insert id="dcmacm047ApprSugAssignHistInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBDCMACM023H	
				 SELECT (SELECT NVL(MAX(SEQ), 0) + RN FROM TBDCMACM023H) AS SEQ
					    ,APV_DOC_NO
						,APV_DVSN_CD
						,APVR_CNB
						,APVR_SEQ
						,APVR_DPT_CD
						,APVR_RANK_CD
						,APVR_PST_CD
						,APVR_KND_CD
						,APV_SNO
						,APVR_STA_CD
						,APV_DH
						,APV_OPIN
						,FRT_USR_ID
						,FNL_USR_ID
						,FNL_DEAL_DPT_CD
						,FNL_MNU_ID
						,FRT_REGI_DH
						,FNL_MDF_DH
						,ONR_PST_NM
						,VACANCY_CD
						,READ_YN
				  FROM (
				  		SELECT ROWNUM AS RN
				  		     ,A.APV_DOC_NO
						     ,A.APV_DVSN_CD
						     ,A.APVR_CNB
						     ,A.APVR_SEQ
						     ,A.APVR_DPT_CD
						     ,A.APVR_RANK_CD
						     ,A.APVR_PST_CD
						     ,A.APVR_KND_CD
						     ,A.APV_SNO
						     ,A.APVR_STA_CD
						     ,A.APV_DH
						     ,A.APV_OPIN
						     ,A.FRT_USR_ID
						     ,A.FNL_USR_ID
						     ,A.FNL_DEAL_DPT_CD
						     ,A.FNL_MNU_ID
						     ,SYSDATE AS FRT_REGI_DH
						     ,SYSDATE AS FNL_MDF_DH
						     ,A.ONR_PST_NM
						     ,A.VACANCY_CD
						     ,A.READ_YN
						  FROM TBDCMACM023L A
		       LEFT OUTER JOIN TBDCMACM023H B ON (B.APV_DOC_NO = A.APV_DOC_NO AND B.APV_DVSN_CD = A.APV_DVSN_CD AND B.APVR_CNB = A.APVR_CNB AND B.APVR_SEQ = A.APVR_SEQ AND B.APV_DH = A.APV_DH)
						 WHERE A.APV_DOC_NO = #strDocNo#
						   AND A.APV_DVSN_CD = #strApvDvsnCd#
						   AND SUBSTR(A.APVR_STA_CD,0,1) >= '2'
						   AND SUBSTR(A.APVR_STA_CD,0,1) <> '3'
						   AND B.SEQ IS NULL
						 ORDER BY A.APV_DH DESC, A.APVR_KND_CD DESC
						) 
		]]>
	</insert>
	
	<!-- 결재문서별 결재자 취소 상태 히스토리 -->
	<insert id="dcmacm047ApprSugAssignCancelHistInsert" parameterClass="paramMap">
		<![CDATA[
			 INSERT INTO TBDCMACM023H	
				 SELECT (SELECT NVL(MAX(SEQ), 0) + 1 FROM TBDCMACM023H) AS SEQ
					    ,APV_DOC_NO
						,APV_DVSN_CD
						,APVR_CNB
						,APVR_SEQ
						,APVR_DPT_CD
						,APVR_RANK_CD
						,APVR_PST_CD
						,APVR_KND_CD
						,APV_SNO
						,#HIST_APVR_STA_CD# AS APVR_STA_CD
						,APV_DH
						,APV_OPIN
						,FRT_USR_ID
						,FNL_USR_ID
						,FNL_DEAL_DPT_CD
						,FNL_MNU_ID
						,SYSDATE AS FRT_REGI_DH
						,SYSDATE AS FNL_MDF_DH
						,ONR_PST_NM
						,VACANCY_CD
						,READ_YN
				  FROM TBDCMACM023L
				 WHERE APV_DOC_NO = #APV_DOC_NO#
			       AND APV_DVSN_CD = #APV_DVSN_CD#
			       AND APVR_CNB = #APVR_CNB#
			       AND APVR_SEQ = #APVR_SEQ#
		]]>
	</insert>
	
	<insert id="dcmacm047ApprSugAssignHistInsert2" parameterClass="paramMap">
		<![CDATA[
			 INSERT INTO TBDCMACM023H	
				 SELECT (SELECT NVL(MAX(SEQ), 0) + 1 FROM TBDCMACM023H) AS SEQ
					    ,APV_DOC_NO
						,APV_DVSN_CD
						,APVR_CNB
						,APVR_SEQ
						,APVR_DPT_CD
						,APVR_RANK_CD
						,APVR_PST_CD
						,APVR_KND_CD
						,APV_SNO
						,'202' AS APVR_STA_CD
						,TO_CHAR(SYSDATE,'yyyymmddhh24mIss') APV_DH
						,APV_OPIN
						,FRT_USR_ID
						,FNL_USR_ID
						,FNL_DEAL_DPT_CD
						,FNL_MNU_ID
						,SYSDATE AS FRT_REGI_DH
						,SYSDATE AS FNL_MDF_DH
						,ONR_PST_NM
						,VACANCY_CD
						,READ_YN
				  FROM TBDCMACM023L
				 WHERE APV_DOC_NO = #APV_DOC_NO#
			       AND APV_DVSN_CD = #APV_DVSN_CD#
			       AND APVR_CNB = #APVR_CNB#
			       AND APVR_SEQ = #APVR_SEQ#
		]]>
	</insert>
	
	<!-- 결재문서별결재자내역에서 이전 결재자 조회  EUNOK -->
	<select id="dcmacm047PreApprUsrSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[	
			 SELECT T23.APV_DOC_NO,
					 T23.APV_DVSN_CD,
					 T23.APVR_CNB,
					 T23.APVR_KND_CD,
					 T23.APV_SNO,
					 (SELECT USR.USR_ID
					    FROM TBDCMACM001M USR
					   WHERE USR.CNB = T23.APVR_CNB) AS USR_ID,
					 T23.APVR_SEQ
			   FROM TBDCMACM023L T23
			  WHERE T23.APV_DOC_NO	= #APV_DOC_NO#
		        AND T23.APV_DVSN_CD	= #APV_DVSN_CD#
		        /*AND T23.APV_DH IS NOT NULL*/
		        AND (SELECT NVL(MAX(APVR_SEQ),0) - 1
			  		   FROM TBDCMACM023L
		              WHERE APV_DOC_NO=#APV_DOC_NO#
	                	AND APV_DVSN_CD= #APV_DVSN_CD#
	                	AND APVR_CNB=#APVR_CNB#) =  T23.APVR_SEQ
		]]>
	</select>
	
	<!-- 결재문서별결재자내역에서 이후 결재자 조회  EUNOK -->
	<select id="dcmacm047NextApprUsrSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[	
			 SELECT T23.APV_DOC_NO,
					 T23.APV_DVSN_CD,
					 T23.APVR_CNB,
					 T23.APVR_KND_CD,
					 T23.APV_SNO,
					 (SELECT USR.USR_ID
					    FROM TBDCMACM001M USR
					   WHERE USR.CNB = T23.APVR_CNB) AS USR_ID,
					 T23.APVR_SEQ
			   FROM TBDCMACM023L T23
			  WHERE T23.APV_DOC_NO	= #APV_DOC_NO#
		        AND T23.APV_DVSN_CD	= #APV_DVSN_CD#
		        /*AND T23.APV_DH IS NOT NULL*/
		        AND (SELECT NVL(MAX(APVR_SEQ),0) + 1
			  		   FROM TBDCMACM023L
		              WHERE APV_DOC_NO=#APV_DOC_NO#
	                	AND APV_DVSN_CD= #APV_DVSN_CD#
	                	AND APVR_CNB=#APVR_CNB#) =  T23.APVR_SEQ
		]]>
	</select>
	
	<!-- 결재취소 가능 확인 조회 -->
	<select id="dcmacm047ApprUsrChkByCnlApvSelect" parameterClass="paramMap"
		resultClass="java.lang.String">
	<![CDATA[
		SELECT COUNT(*)
		  FROM TBDCMACM023L T23			 
		 WHERE T23.APV_DOC_NO	= #strDocNo#
		   AND (T23.APVR_STA_CD < 200  /*완료 전 상태 만*/
    	 		OR T23.APVR_STA_CD IS NULL)
		   AND T23.APVR_SEQ IN ( SELECT NVL(MAX(APVR_SEQ),0) + 1
					               FROM TBDCMACM023L
					              WHERE APV_DOC_NO= #strDocNo#
					                AND APVR_CNB=#strApvrCnb#
					                AND APVR_STA_CD > 200
					                AND APVR_STA_CD < 205 
					                AND APVR_KND_CD <> 7)
	]]>
	</select>
	
	<!-- 결재완료된 최종 결재순번 조회 -->
	<select id="dcmacm047MaxApvSnoByCmtApprSelect" parameterClass="paramMap"
		resultClass="java.lang.String">
	<![CDATA[
		SELECT MAX(APV_SNO)
		  FROM TBDCMACM023L		 
		 WHERE APV_DOC_NO	= #APV_DOC_NO#
		   AND SUBSTR(APVR_STA_CD,0,1) = 2  /*완료 전 상태 만*/
	]]>
	</select>
	
		<!-- 최종 결재순번 조회 -->
	<select id="dcmacm047MaxApvSnoSelect" parameterClass="paramMap"
		resultClass="java.lang.String">
	<![CDATA[
		SELECT NVL(MAX(APV_SNO),0)
		  FROM TBDCMACM023L		 
		 WHERE APV_DOC_NO	= #APV_DOC_NO#
	]]>
	</select>
	
	<delete id="dcmacm045PushOrderReceiveDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE 
			  FROM PTL_ORDER_RECEIVE_LIST
			 WHERE SEQ = #SEQ#
		]]>
	</delete>
	
	<!-- 결재자목록 결재자순번 조회 -->
	<select id="dcmacm045ApvrSeqSelect" parameterClass="paramMap"	resultClass="java.lang.String">
		SELECT APVR_SEQ
		  FROM TBDCMACM023L
		 WHERE APV_DOC_NO = #APV_DOC_NO#
		   AND APV_DVSN_CD = #APV_DVSN_CD#
		   AND APVR_CNB = #APVR_CNB#
		   AND APV_SNO = #APV_SNO#
	</select>
	
	<select id="dcmacm045ApvrSeqSelect2" parameterClass="paramMap"	resultClass="java.lang.String">
		SELECT APVR_SEQ
		  FROM TBDCMACM023L
		 WHERE APV_DOC_NO = #APV_DOC_NO#
		   AND APV_DVSN_CD = #APV_DVSN_CD#
		   AND APVR_CNB = #APVR_CNB#
		   AND APV_SNO = #APV_SNO#
		   AND APVR_KND_CD = #APVR_KND_CD#
	</select>
	
	<!--  결재자 변경에 따른 업무지시수신자목록 정보 삭제 -->
	<delete id="dcmacm045PushOrderReceiveChangedDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE 
			  FROM PTL_ORDER_RECEIVE_LIST
			 WHERE SEQ = (
			 			  SELECT TO_CHAR(MAX(SEQ)) AS SEQ
						    FROM PTL_ORDER_LIST
			               WHERE DOC_NO = #APV_DOC_NO#
			             )
			   AND SRT_NO IN (
							 SELECT APVR_SEQ
							   FROM TBDCMACM023L
							  WHERE APV_DOC_NO = #APV_DOC_NO#
							    AND APV_DVSN_CD = #APV_DVSN_CD#
							    AND (SUBSTR(APVR_STA_CD,0,1) <> 2 
							    	 OR APVR_STA_CD IS NULL)
							   )
		]]>
	</delete>
	
	<!-- 결재순번에 제출자 존재여부 확인 -->
	<select id="dcmacm047GetSenderYn" parameterClass="paramMap"	resultClass="java.lang.Integer">
		SELECT NVL(COUNT(*),0) as CNT
		  FROM TBDCMACM023L 
		 WHERE APV_DOC_NO = #APV_DOC_NO#
		   AND APV_SNO = #APV_SNO#
		   AND APVR_KND_CD = '7' 
	</select>
	<update id="notiTempApvSave" parameterClass="paramMap">
		UPDATE	CTT_IMSI
		SET		STAT_CD = #STAT_CD#
				,APV_DOC_NO = #APV_DOC_NO#
		WHERE	BOARD_ID ='50'
		<isNotEmpty property="POST_SEQ">
			AND		POST_SEQ = #POST_SEQ#
		</isNotEmpty>
		<isEmpty property="POST_SEQ">
			AND		APV_DOC_NO = #APV_DOC_NO#
		</isEmpty>
		
	</update>
	
	<!--실지감사 결재문서별 보고서코드 조회 -->
	<select id="dcmacm047GetRprtCdByApvDocNo" parameterClass="paramMap"	resultClass="java.lang.String">
		SELECT   MAX(DECODE(RPRT_CD, 'A10601300', 'A10600100', RPRT_CD)) AS RPRT_CD
		  FROM TBBADDED103M
		 WHERE APV_RQS_ID = #strDocNo#
	</select>
	
	<!-- 실지감사 보고서코드 조회 -->
	<select id="dcmacm047GetRprtCdByParentKey" parameterClass="paramMap"	resultClass="java.lang.String">
		SELECT RPRT_CD
		  FROM TBBADDED103M
		 WHERE AUD_YR = #AUD_YR#
		   AND AUD_NO = #AUD_NO#
		   AND AUD_STEP_CD = #AUD_STEP_CD#
		   AND DOC_ID = #DOC_ID#
	</select>
	
		   <!-- 감사구분코드 조회 -->
    <select id="dcmacm045DvsnCdSelect" parameterClass="paramMap"   resultClass="java.lang.String">
        SELECT DECODE(COUNT(AUD_NO), 0 , 'N', 'Y') AS CNT
		FROM  TBBADDED001M A
		WHERE A.AUD_YR = #AUD_YR#
		 AND A.AUD_NO = #AUD_NO#
		AND EXISTS (SELECT 1 FROM TBBADDED030L B
		            WHERE B.AUD_YR  = A.AUD_YR
		             AND B.AUD_NO  = A.AUD_NO
		             AND DVSN_CD ='4') --국회
    </select>
    
    <!-- 자동협조결재 여부 조회 -->
	<select id="dcmacm047getAutoCmptCoprYn" parameterClass="paramMap"
		resultClass="java.lang.String">
	<![CDATA[
		SELECT NVL(AUTO_CMPT_COPR_YN,'N') AS AUTO_CMPT_COPR_YN
		  FROM TBDCMACM022L
		 WHERE APV_DOC_NO = #APV_DOC_NO#
		   AND APV_DVSN_CD = #APV_DVSN_CD#
	]]>
	</select>
	
	<!-- 심사 병행병합 구분코드 조회 -->
    <select id="dcmacm045MgDivCdSelect" parameterClass="paramMap"   resultClass="java.lang.String">
        SELECT A.MG_DIV_CD
          FROM  TBBADFRE012M A, TBBADFRE103M B
        WHERE A.ACP_YR = B.ACP_YR
           AND A.ACP_DVSN_CD = B.ACP_DVSN_CD
           AND A.ACP_SRNO = B.ACP_SRNO
           AND B.DOC_ID = #DOC_ID#
           AND ROWNUM=1
    </select>
    
    <!-- 단계코드 조회 -->
    <select id="dcmacm045audStepCdSelect" parameterClass="paramMap"   resultClass="java.lang.String">
        SELECT  AUD_STEP_CD
         FROM  TBBADDED103M
       WHERE DOC_ID = #DOC_ID#
           AND ROWNUM=1
    </select>
    
    <!--공통코드 sub 조회 2017.07.12 EUNOK 기능분류가 모니터구분일 경우 사용자정의1~4 계산해서 추출 -->
	<select id="dcmacm008CmmDetailSelect2" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
             SELECT TSK_CAT_CD
            , FUNC_CAT_CD||TSK_CAT_CD AS FUNC_CAT_CD
            , CMM_CD_DVSN_CD
            , CD
            , CD_NM
            , USE_YN
            , PRD_USE_YN
            , STR_DT
            , END_DT
            , OTPT_SEQ
            , USR_DFN_TXT_1
            , USR_DFN_TXT_2
            , NVL2(T1.MSUM_Y,T1.MSUM_Y,0) AS USR_DFN_TXT_3
            , NVL2(T1.MSUM_K,T1.MSUM_K,0) AS USR_DFN_TXT_4
            , NVL2(T1.MSUM_F,T1.MSUM_F,0) AS USR_DFN_TXT_5
            , NVL2(T1.MSUM_N,T1.MSUM_N,0) AS USR_DFN_TXT_6
            , USR_DFN_TXT_7
            , USR_DFN_TXT_8
            , USR_DFN_TXT_9
            , USR_DFN_TXT_10
            , BK_CD_DVSN_NM
            , BK_CD_NM
         FROM TBDCMACM013C,
         (
         SELECT 	
        A.MNT_DVSN_CD as MNT_DVSN_CD
        ,SUM(DECODE(A.PC_USE_DVSN_CD,'Y',1,0)) + NVL2(C.M2_Y,C.M2_Y,0) AS MSUM_Y /*사용*/     
        ,SUM(DECODE(A.PC_USE_DVSN_CD,'K',1,0)) + NVL2(C.M2_K,C.M2_K,0) AS MSUM_K /*보관*/        
        ,SUM(DECODE(A.PC_USE_DVSN_CD,'F',1,0)) + NVL2(C.M2_F,C.M2_F,0) AS MSUM_F /*불용*/     
        ,SUM(DECODE(A.PC_USE_DVSN_CD,'N',1,0)) + NVL2(C.M2_N,C.M2_N,0) AS MSUM_N /*폐기*/         
		FROM   	TBCSPIIT005M A	/*PC장비관리테이블*/
		       ,TBDCMACM013C B  /*공통코드테이블*/
               ,(SELECT 	
                    A1.MNT_DVSN_CD2
                    ,sum(DECODE(A1.PC_USE_DVSN_CD,'Y',1,0)) AS M2_Y 
                    ,sum(DECODE(A1.PC_USE_DVSN_CD,'K',1,0)) AS M2_K 
                    ,sum(DECODE(A1.PC_USE_DVSN_CD,'F',1,0)) AS M2_F 
                    ,sum(DECODE(A1.PC_USE_DVSN_CD,'N',1,0)) AS M2_N 
                    FROM   	TBCSPIIT005M A1	
                           ,TBDCMACM013C B1
                    WHERE	1=1
                    AND B1.CMM_CD_DVSN_CD(+) =  #strCdDvsn#
                    AND A1.MNT_DVSN_CD2 = B1.CD
                    group by MNT_DVSN_CD2
                )C
		WHERE	1=1
		AND B.CMM_CD_DVSN_CD(+) = #strCdDvsn#
        AND A.MNT_DVSN_CD = B.CD
        AND A.MNT_DVSN_CD = C.MNT_DVSN_CD2(+)
        GROUP BY MNT_DVSN_CD,C.M2_Y,C.M2_K,C.M2_F,C.M2_N         
         )T1
         
        WHERE 1=1
          AND CD <>'000000000'
          AND CD = T1.MNT_DVSN_CD(+)
		  AND CMM_CD_DVSN_CD = #strCdDvsn#
          ORDER BY CD

	         ]]>

	</select>
	
	<select id="dcmacm001SelectBmsUsrInfo" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	F_DPT_INFO(T1.DPT_CD,'6') AS GCC_ORG_CD, F_DPT_INFO(T1.SUB_DPT_CD,'6') AS SUB_GCC_ORG_CD
			FROM	TBDCMACM001M T1
			WHERE	T1.USR_ID = #strUserID#
		]]>
	</select>
	
	<!-- 메신저 push 대상 추가 -->	
	<insert id="notiTempMsgInsert" parameterClass="paramMap">			
			INSERT INTO
			TBDCMACM026L
			(
			  MSG_SNO
			, TSK_CAT_CD
			, FUNC_CAT_CD
			, SEND_ID
	        , MSG_TP_YN	  
	        , MSG_TXT_2
	        , RCNT_CNT
	        , RCNT_HIS
	        , MSG_REGI_DH	
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			,
			FNL_MDF_DH	
			)
			VALUES
			(
			  (SELECT NVL(MAX(MSG_SNO),'0')+1 AS MSG_SNO FROM TBDCMACM026L)
			, 'CM'
			, 'CM'
			, NULL
	        , '0'	     
	        , #MSG_TXT#
	        , #RCNT_CNT#
	        , #RCNT_HIS#
	        , SYSDATE 
			, 'noti'
			, 'noti'
			, 'noti'
			, 'noti'
			, SYSDATE
			, SYSDATE	
			);

	</insert>
	
	<select id="notiMsgSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT USR_DFN_TXT_1 AS RCNT_HIS
			     , USR_DFN_TXT_2 AS RCNT_CNT
			  FROM TBDCMACM013C
			 WHERE 1=1
			   AND CMM_CD_DVSN_CD = '1000000'
               AND CD = '6'
		]]>
	</select>
	
	<select id="dcmacm047SelectMsgReceiver" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		SELECT AGGR_CONCAT(CNB,'') AS RCNT_HIS, COUNT(*) AS RCNT_CNT
		  FROM (
					SELECT CNB
					  FROM TBDCMACM001M T1
					 WHERE T1.DPT_CD = '120000'
					   AND RANK_SRT_SEQ_NM < '05'
					 UNION
					SELECT T1.CNB
					  FROM TBBADDED031L T1 ,
					       TBBADDED103M T2
					 WHERE T1.AUD_YR = T2.AUD_YR
					   AND T1.AUD_NO = T2.AUD_NO
					   AND T1.AUDTOR_DVSN_CD = '1'
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
					 UNION
					SELECT T4.CNB
					  FROM TBBADDED001M T1 ,
					       TBBADDED103M T2 ,
					       TBDCMACM002M T3 ,
					       TBDCMACM001M T4
					 WHERE T1.AUD_YR = T2.AUD_YR
					   AND T1.AUD_NO = T2.AUD_NO
					   AND T1.SPV_BRDV_CD = T3.DPT_CD
					   AND T3.DPT_CD =T4.DPT_CD
					   AND T4.INN_RANK_CD ='30'
					   AND T4.RQS_STA_CD ='3'
					   AND T4.USR_DVSN_CD = '1'
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
					UNION
					 SELECT T1.HNDL_CHGR_CD AS CNB
					  FROM TBBADFRE012M T1 ,
					       TBBADFRE103M T2
					 WHERE T1.ACP_YR = T2.ACP_YR
					   AND T1.ACP_DVSN_CD = T2.ACP_DVSN_CD
					   AND T1.ACP_SRNO = T2.ACP_SRNO
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
				   UNION
				    SELECT T4.CNB
					  FROM TBBADFRE012M T1 ,
					       TBBADFRE103M T2 ,
					       TBDCMACM002M T3 ,
					       TBDCMACM001M T4
					 WHERE T1.ACP_YR = T2.ACP_YR
					   AND T1.ACP_DVSN_CD = T2.ACP_DVSN_CD
					   AND T1.ACP_SRNO = T2.ACP_SRNO
					   AND T1.DPT_CD = T3.DPT_CD
					   AND T3.DPT_CD =T4.DPT_CD
					   AND T4.INN_RANK_CD ='30'
					   AND T4.RQS_STA_CD ='3'
					   AND T4.USR_DVSN_CD = '1'
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
				   UNION
				    SELECT T3.CNB AS CNB
					  FROM TBCSPEAR001M T1 ,
					       TBCSPDCP603M T2 ,
					       TBDCMACM001M T3
					 WHERE T1.ACP_YR = T2.ACP_YR
					   AND T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
					   AND T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
					   AND T1.HNDL_CHGR_ID = T3.USR_ID
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
				   UNION
				    SELECT T4.CNB AS CNB
					  FROM TBCSPEAR001M T1 ,
					       TBCSPDCP603M T2 ,
					       TBDCMACM002M T3 ,
					       TBDCMACM001M T4
					 WHERE T1.ACP_YR = T2.ACP_YR
					   AND T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
					   AND T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
					   AND T1.HNDL_DPT_CD = T3.DPT_CD
					   AND T3.DPT_CD =T4.DPT_CD
					   AND T4.INN_RANK_CD ='30'
					   AND T4.RQS_STA_CD ='3'
					   AND T4.USR_DVSN_CD = '1'
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
				   UNION
				    SELECT T3.CNB
					  FROM TBCSPEAR010M T1,
					       TBCSPDCP603M T2,
			               TBDCMACM001M T3
                     WHERE T1.CMT_OEN_YE = T2.ACP_YR
					   AND DECODE(T1.CMT_DVSN_CD, '1','7','2','8','') = T2.REQ_DVSN_CD
				   	   AND T1.CMT_DGE = T2.CVPT_ACP_NO
				   	   AND T2.DOC_WRT_ID = T3.USR_ID
				   	   AND T2.APV_RQS_ID = #APV_DOC_NO#
				)
		]]>
	</select>
	
	<select id="dcmacm047SelectMsgReceiver2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		SELECT AGGR_CONCAT(CNB,'') AS RCNT_HIS, COUNT(*) AS RCNT_CNT
		  FROM (
					SELECT CNB
					  FROM TBDCMACM001M T1
					 WHERE T1.DPT_CD = '520000'
					   AND RANK_SRT_SEQ_NM <= '05'
					   AND NVL(INN_RANK_CD,'50') <> '13'
					 UNION
					SELECT T1.CNB
					  FROM TBBADDED031L T1 ,
					       TBBADDED103M T2
					 WHERE T1.AUD_YR = T2.AUD_YR
					   AND T1.AUD_NO = T2.AUD_NO
					   AND T1.AUDTOR_DVSN_CD = '1'
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
					 UNION
					SELECT T4.CNB
					  FROM TBBADDED001M T1 ,
					       TBBADDED103M T2 ,
					       TBDCMACM002M T3 ,
					       TBDCMACM001M T4
					 WHERE T1.AUD_YR = T2.AUD_YR
					   AND T1.AUD_NO = T2.AUD_NO
					   AND T1.SPV_BRDV_CD = T3.DPT_CD
					   AND T3.DPT_CD =T4.DPT_CD
					   AND T4.INN_RANK_CD ='30'
					   AND T4.RQS_STA_CD ='3'
					   AND T4.USR_DVSN_CD = '1'
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
					UNION
					 SELECT T1.HNDL_CHGR_CD AS CNB
					  FROM TBBADFRE012M T1 ,
					       TBBADFRE103M T2
					 WHERE T1.ACP_YR = T2.ACP_YR
					   AND T1.ACP_DVSN_CD = T2.ACP_DVSN_CD
					   AND T1.ACP_SRNO = T2.ACP_SRNO
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
				   UNION
				    SELECT T4.CNB
					  FROM TBBADFRE012M T1 ,
					       TBBADFRE103M T2 ,
					       TBDCMACM002M T3 ,
					       TBDCMACM001M T4
					 WHERE T1.ACP_YR = T2.ACP_YR
					   AND T1.ACP_DVSN_CD = T2.ACP_DVSN_CD
					   AND T1.ACP_SRNO = T2.ACP_SRNO
					   AND T1.DPT_CD = T3.DPT_CD
					   AND T3.DPT_CD =T4.DPT_CD
					   AND T4.INN_RANK_CD ='30'
					   AND T4.RQS_STA_CD ='3'
					   AND T4.USR_DVSN_CD = '1'
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
				   UNION
				    SELECT T3.CNB AS CNB
					  FROM TBCSPEAR001M T1 ,
					       TBCSPDCP603M T2 ,
					       TBDCMACM001M T3
					 WHERE T1.ACP_YR = T2.ACP_YR
					   AND T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
					   AND T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
					   AND T1.HNDL_CHGR_ID = T3.USR_ID
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
				   UNION
				    SELECT T4.CNB AS CNB
					  FROM TBCSPEAR001M T1 ,
					       TBCSPDCP603M T2 ,
					       TBDCMACM002M T3 ,
					       TBDCMACM001M T4
					 WHERE T1.ACP_YR = T2.ACP_YR
					   AND T1.REQ_DVSN_CD = T2.REQ_DVSN_CD
					   AND T1.CVPT_ACP_NO = T2.CVPT_ACP_NO
					   AND T1.HNDL_DPT_CD = T3.DPT_CD
					   AND T3.DPT_CD =T4.DPT_CD
					   AND T4.INN_RANK_CD ='30'
					   AND T4.RQS_STA_CD ='3'
					   AND T4.USR_DVSN_CD = '1'
					   AND T2.APV_RQS_ID = #APV_DOC_NO#
				   UNION
				    SELECT T3.CNB
					  FROM TBCSPEAR010M T1,
					       TBCSPDCP603M T2,
			               TBDCMACM001M T3
                     WHERE T1.CMT_OEN_YE = T2.ACP_YR
					   AND DECODE(T1.CMT_DVSN_CD, '1','7','2','8','') = T2.REQ_DVSN_CD
				   	   AND T1.CMT_DGE = T2.CVPT_ACP_NO
				   	   AND T2.DOC_WRT_ID = T3.USR_ID
				   	   AND T2.APV_RQS_ID = #APV_DOC_NO#
				)
		]]>
	</select>
	
	<insert id="commonInsertLog" parameterClass="paramMap">
        <![CDATA[
            INSERT INTO TBDCMACM014H (
                LG_SRNO,
			   SIT_CD, MNU_ID, CNB, 
			   TSK_CAT_CD, FUNC_CAT_CD, RQS_DH, 
			   RQS_SVC_ID, RQS_SVC_PRMT_TXT, RQS_IP_NO, 
			   FRT_USR_ID, FNL_USR_ID, FNL_DEAL_DPT_CD, 
			   FNL_MNU_ID, FRT_REGI_DH, FNL_MDF_DH
			  , LVL_MNU_NM_1
			  , LVL_MNU_NM_2
			  , LVL_MNU_NM_3
			   ) 
			VALUES ( SBDCM001.NEXTVAL,
			         'S001' ,
			         #MNU_ID# ,
			         #CNB# ,
			         #TSK_CAT_CD# ,
			         #FUNC_CAT_CD# ,
			         SYSDATE ,
			         #RQS_SVC_ID# ,
					 #RQS_SVC_PRMT_TXT# ,
					 #RQS_IP_NO# ,
					 #FRT_USR_ID# ,
					 #FNL_USR_ID# ,
					 #FNL_DEAL_DPT_CD# ,
					 #FNL_MNU_ID# ,
					 SYSDATE ,
				     SYSDATE	
					, #LVL_MNU_NM_1# 
					, #LVL_MNU_NM_2# 
					, #LVL_MNU_NM_3# )

        ]]>
	</insert>
	
	<!-- 주무부서 과 리스트 조회 -->
	<select id="dcmacm024MainDeptSectSelect" parameterClass="paramMap"
		resultClass="resultMap">
           SELECT DPT_CD, DPT_NM
             FROM TBDCMACM002M
            WHERE 1=1
              AND USE_YN = 'Y'
              AND SRT_SNO = 1
           ORDER BY DPT_SNO, DPT_CD 	
      
	</select>
</sqlMap> 