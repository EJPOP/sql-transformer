<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/061">
	<!--장 코드조회-->
	<select id="FAACAV061EselectCode1" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectCode1 */ ]]>
		SELECT
			CHIF_SSEC_CD AS CD
			,CHIF_SSEC_NM AS CD_NM
		FROM TWFAACAV070C
		WHERE DVSN_CD = '1'
	</select>
	
	<!--항 코드조회-->
	<select id="FAACAV061EselectCode2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectCode2 */ ]]>
		SELECT
			ITM_CD AS CD
			,ITM_NM AS CD_NM
		FROM TWFAACAV071C
		WHERE DVSN_CD = '1'
	</select>
	
	<!--세항 코드조회-->
	<select id="FAACAV061EselectCode3" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectCode3 */ ]]>
		SELECT
			DITM_CD AS CD
			,DITM_NM AS CD_NM
		FROM TWFAACAV072C
		WHERE DVSN_CD = '1'
	</select>
	
	<!--목 코드조회-->
	<select id="FAACAV061EselectCode4" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectCode4 */ ]]>
		SELECT
			SITM_CD AS CD
			,SITM_NM AS CD_NM
		FROM TWFAACAV073C
		WHERE DVSN_CD = '1'
	</select>
	
	
	<!--지출계산서 조회-->
	<select id="FAACAV061EselectMainYn" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectMainYn */ ]]>
        <![CDATA[
		SELECT
		    DTM_YN              
		FROM TWFAACAV021L
		]]>
			WHERE PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</select>
	
	
	<!--지출계산서 조회-->
	<select id="FAACAV061EselectMain" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectMain */ ]]>
        <![CDATA[
		SELECT
		    COPT_CD             
		    , ACNT_CD             
		    , BLL_CD              
		    , PROF_DRTR_SRNO      
		    , DL_XPN_RCDB_PBSVT_SRNO        
		    , COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS FULL_PROF_DRTR_SRNO 
		    , PROF_YM             
		    , SUM_DVSN_ID         
		    , SSEC_CD             
		    , SSEC_CD AS SSEC_CD_NM     
		    , ITM_CD
		    , ITM_CD AS ITM_CD_NM
		    , DITM_CD
		    , DITM_CD AS DITM_CD_NM
		    , SITM_CD
		    , SITM_CD AS SITM_CD_NM
		    , DGE                 
		    , TQR_BGT_ALC_AMT     
		    , TQR_TO_BGT_ALC_ATAG   
		    , TQR_FND_ALC_AMT     
		    , TQR_TO_FND_ALC_ATAG   
		    , TQR_EXPN_AMT        
		    , ELT_TO_EXPN_ATAG    
		    , TQR_RED_AMT         
		    , TQR_SUBJ_ASO_RCTF_AMT         
		    , EXPN_SBTR_ATAG      
		    , FND_ALC_BL          
		    , DTM_YN              
		    , HNDL_STA_CD         
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID          
		FROM TWFAACAV021L
		WHERE SUM_DVSN_ID != '49'
		]]>
			AND DGE = (
						SELECT MAX(DGE) 
							FROM TWFAACAV021L
						WHERE PROF_YM = #strYr#||#strMm# 
						    AND COPT_CD = #strCoptCd#
							AND ACNT_CD = #strAcntCd#
							AND BLL_CD = #strBllCd#
							AND PROF_DRTR_SRNO = #strProfDrtrSrno#
							AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
					   )
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		ORDER BY FULL_PROF_DRTR_SRNO, DGE, PROF_YM
	</select>
	
	
	
	
	<!--일상경비교부명세서 조회-->
	<select id="FAACAV061EselectSubList1" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectSubList1 */ ]]>
        <![CDATA[
		SELECT 
				  COPT_CD
				, ACNT_CD
				, BLL_CD
				, PROF_DRTR_SRNO
				, DL_XPN_RCDB_PBSVT_SRNO
				, COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS FULL_PROF_DRTR_SRNO
				, PROF_YM
				, ATT_CD
				, SRNO
				, SUM_DVSN_ID
				, ATT_TXT
				, TRIM(SUBSTRB(ATT_TXT, 1, 60)) AS TXT1
				, TRIM(SUBSTRB(ATT_TXT, 61, 30)) AS TXT2
				, TRIM(SUBSTRB(ATT_TXT, 91, 13)) AS TXT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 104, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 120, 15)) AS AMT2
				, TO_NUMBER(SUBSTRB(ATT_TXT, 136, 15)) AS AMT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 152, 15)) AS AMT4
				, TO_NUMBER(SUBSTRB(ATT_TXT, 168, 15)) AS AMT5
				, TRIM(SUBSTRB(ATT_TXT, 183, 140)) AS RMK
				, DTM_YN
				, HNDL_STA_CD
				, ATT_SRNO
				, FRT_REGI_DH
				, FRT_USR_ID
				, FNL_MDF_DH
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MNU_ID
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280201'
	        AND SUM_DVSN_ID != '49'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#        
        ]]>  
	</select>
	
		
	<!--도급경비 지급명세서 조회-->
	<select id="FAACAV061EselectSubList2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectSubList2 */ ]]>
        <![CDATA[
		SELECT 
				  COPT_CD
				, ACNT_CD
				, BLL_CD
				, PROF_DRTR_SRNO
				, DL_XPN_RCDB_PBSVT_SRNO
				, COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS FULL_PROF_DRTR_SRNO
				, PROF_YM
				, ATT_CD
				, SRNO
				, SUM_DVSN_ID
				, ATT_TXT
				, SUBSTRB(ATT_TXT, 1, 60) AS TXT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 61, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 77, 15)) AS AMT2
				, SUBSTRB(ATT_TXT, 98, 300) AS RMK
				, DTM_YN
				, HNDL_STA_CD
				, ATT_SRNO
				, FRT_REGI_DH
				, FRT_USR_ID
				, FNL_MDF_DH
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MNU_ID
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280202'
			AND SUM_DVSN_ID != '49'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#             
    	]]>  
	</select>		
	
	
	
	<!-- 보조금등 교부명세서 조회-->
	<select id="FAACAV061EselectSubList3" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectSubList3 */ ]]>
		SELECT 
				  COPT_CD
				, ACNT_CD
				, BLL_CD
				, PROF_DRTR_SRNO
				, DL_XPN_RCDB_PBSVT_SRNO
				, COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS FULL_PROF_DRTR_SRNO
				, PROF_YM
				, ATT_CD
				, SRNO
				, SUM_DVSN_ID
				, ATT_TXT
				, SUBSTRB(ATT_TXT, 1, 50) AS TXT1
				, SUBSTRB(ATT_TXT, 51, 60) AS TXT2
				, SUBSTRB(ATT_TXT, 111, 4) AS SSEC_CD
				, SUBSTRB(ATT_TXT, 115, 4) AS ITM_CD
				, SUBSTRB(ATT_TXT, 119, 4) AS DITM_CD
				, SUBSTRB(ATT_TXT, 123, 3) AS SITM_CD
				, SUBSTRB(ATT_TXT, 111, 4) AS SSEC_CD_NM
				, SUBSTRB(ATT_TXT, 115, 4) AS ITM_CD_NM
				, SUBSTRB(ATT_TXT, 119, 4) AS DITM_CD_NM
				, SUBSTRB(ATT_TXT, 123, 3) AS SITM_CD_NM
	 			, TO_NUMBER(SUBSTRB(ATT_TXT, 127, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 143, 15)) AS AMT2
				, TO_NUMBER(SUBSTRB(ATT_TXT, 159, 15)) AS AMT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 175, 15)) AS AMT4
				, TO_NUMBER(SUBSTRB(ATT_TXT, 191, 15)) AS AMT5
				, TO_NUMBER(SUBSTRB(ATT_TXT, 207, 15)) AS AMT6
				, DTM_YN
				, HNDL_STA_CD
				, ATT_SRNO
				, FRT_REGI_DH
				, FRT_USR_ID
				, FNL_MDF_DH
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MNU_ID
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280203'
			AND SUM_DVSN_ID != '49'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#  
	</select>		
	
	
	<!--선금지급명세서 조회-->
	<select id="FAACAV061EselectSubList4" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectSubList4 */ ]]>
        <![CDATA[
		SELECT 
				  COPT_CD
				, ACNT_CD
				, BLL_CD
				, PROF_DRTR_SRNO
				, DL_XPN_RCDB_PBSVT_SRNO
				, COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS FULL_PROF_DRTR_SRNO
				, PROF_YM
				, ATT_CD
				, SRNO
				, SUM_DVSN_ID
				, ATT_TXT
				, SUBSTRB(ATT_TXT, 1, 4) AS SSEC_CD
				, SUBSTRB(ATT_TXT, 5, 4) AS ITM_CD
				, SUBSTRB(ATT_TXT, 9, 4) AS DITM_CD
				, SUBSTRB(ATT_TXT, 13, 3) AS SITM_CD
				, SUBSTRB(ATT_TXT, 1, 4) AS SSEC_CD_NM
				, SUBSTRB(ATT_TXT, 5, 4) AS ITM_CD_NM
				, SUBSTRB(ATT_TXT, 9, 4) AS DITM_CD_NM
				, SUBSTRB(ATT_TXT, 13, 3) AS SITM_CD_NM
				, TO_NUMBER(SUBSTRB(ATT_TXT, 17, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 33, 15)) AS AMT2
				, TO_NUMBER(SUBSTRB(ATT_TXT, 49, 15)) AS AMT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 65, 15)) AS AMT4
				, TO_NUMBER(SUBSTRB(ATT_TXT, 81, 15)) AS AMT5
				, TO_NUMBER(SUBSTRB(ATT_TXT, 97, 15)) AS AMT6
				, TO_NUMBER(SUBSTRB(ATT_TXT, 113, 15)) AS AMT7     
				, SUBSTRB(ATT_TXT, 128, 300) AS RMK
				, DTM_YN
				, HNDL_STA_CD
				, ATT_SRNO
				, FRT_REGI_DH
				, FRT_USR_ID
				, FNL_MDF_DH
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MNU_ID
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280204'
			AND SUM_DVSN_ID != '49'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#  
        ]]>  
	</select>
	
		
	<!--개산액지급명세서 조회-->
	<select id="FAACAV061EselectSubList5" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectSubList5 */ ]]>
        <![CDATA[
		SELECT 
				  COPT_CD
				, ACNT_CD
				, BLL_CD
				, PROF_DRTR_SRNO
				, DL_XPN_RCDB_PBSVT_SRNO
				, COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS FULL_PROF_DRTR_SRNO
				, PROF_YM
				, ATT_CD
				, SRNO
				, SUM_DVSN_ID
				, ATT_TXT
				, SUBSTRB(ATT_TXT, 1, 4) AS SSEC_CD
				, SUBSTRB(ATT_TXT, 5, 4) AS ITM_CD
				, SUBSTRB(ATT_TXT, 9, 4) AS DITM_CD
				, SUBSTRB(ATT_TXT, 13, 3) AS SITM_CD
				, SUBSTRB(ATT_TXT, 1, 4) AS SSEC_CD_NM
				, SUBSTRB(ATT_TXT, 5, 4) AS ITM_CD_NM
				, SUBSTRB(ATT_TXT, 9, 4) AS DITM_CD_NM
				, SUBSTRB(ATT_TXT, 13, 3) AS SITM_CD_NM
				, TO_NUMBER(SUBSTRB(ATT_TXT, 17, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 33, 15)) AS AMT2
				, TO_NUMBER(SUBSTRB(ATT_TXT, 49, 15)) AS AMT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 65, 15)) AS AMT4
				, TO_NUMBER(SUBSTRB(ATT_TXT, 81, 15)) AS AMT5
				, TO_NUMBER(SUBSTRB(ATT_TXT, 97, 15)) AS AMT6
				, TO_NUMBER(SUBSTRB(ATT_TXT, 113, 15)) AS AMT7     
				, SUBSTRB(ATT_TXT, 128, 300) AS ETC
				, DTM_YN
				, HNDL_STA_CD
				, ATT_SRNO
				, FRT_REGI_DH
				, FRT_USR_ID
				, FNL_MDF_DH
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MNU_ID
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280205'
			AND SUM_DVSN_ID != '49'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#  
        ]]>  
	</select>	
	
	<!--지출계산서 insert
	<insert id="FAACAV061EinsertMain" parameterClass="paramMap">
 		INSERT INTO TWFAACAV021L
		 (
		      COPT_CD             
		    , ACNT_CD             
		    , BLL_CD              
		    , PROF_DRTR_SRNO      
		    , DL_XPN_RCDB_PBSVT_SRNO        
		    , PROF_YM             
		    , SUM_DVSN_ID         
		    , SSEC_CD             
		    , ITM_CD
		    , DITM_CD
		    , SITM_CD
		    , DGE                 
		    , TQR_BGT_ALC_AMT     
		    , TQR_TO_BGT_ALC_ATAG   
		    , TQR_FND_ALC_AMT     
		    , TQR_TO_FND_ALC_ATAG   
		    , TQR_EXPN_AMT        
		    , ELT_TO_EXPN_ATAG    
		    , TQR_RED_AMT         
		    , TQR_SUBJ_ASO_RCTF_AMT         
		    , EXPN_SBTR_ATAG      
		    , FND_ALC_BL          
		    , DTM_YN              
		    , HNDL_STA_CD         
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID     
		 ) VALUES (
			  SUBSTR(#FULL_PROF_DRTR_SRNO#,1,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,5,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,9,2)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,12,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,16,3)
		    , REPLACE(#PROF_YM#,'-','')
		    , '11'
		    , #SSEC_CD#
		    , #ITM_CD#
		    , #DITM_CD#
		    , #SITM_CD#
		    , #maxCnt#
		    , REPLACE(#BGT_ALC_AMT#,',','')
		    , F_AMT_CD_SUM(#FULL_PROF_DRTR_SRNO#,REPLACE(#PROF_YM#,'-',''),#SSEC_CD#,#ITM_CD#,#DITM_CD#,#SITM_CD#,'BGT_ALC_AGGAMT') + REPLACE(#BGT_ALC_AMT#,',','') 
   		    , REPLACE(#FND_ALC_AMT#,',','')
   			, F_AMT_CD_SUM(#FULL_PROF_DRTR_SRNO#,REPLACE(#PROF_YM#,'-',''),#SSEC_CD#,#ITM_CD#,#DITM_CD#,#SITM_CD#,'FND_ALC_AGGAMT') + REPLACE(#FND_ALC_AMT#,',','')
   		    , REPLACE(#EXPN_AMT#,',','')
   		    <isEqual property="strMm" compareValue="01">
   		    , '0'
   		    </isEqual>
   		    <isNotEqual property="strMm" compareValue="01">
   			, F_EXPN_SBTR_AGGAMT_SUM(#FULL_PROF_DRTR_SRNO#,REPLACE(#PROF_YM#,'-',''),#SSEC_CD#,#ITM_CD#,#DITM_CD#,#SITM_CD#)
   			</isNotEqual>
		    , REPLACE(#EXTIN_AMT#,',','')
		    , REPLACE(#RCTF_AMT#,',','')
			, F_AMT_CD_SUM(#FULL_PROF_DRTR_SRNO#,REPLACE(#PROF_YM#,'-',''),#SSEC_CD#,#ITM_CD#,#DITM_CD#,#SITM_CD#,'EXPN_SBTR_AGGAMT') + (REPLACE(#RCTF_AMT#,',','') - (REPLACE(#EXTIN_AMT#,',','') - REPLACE(#EXPN_AMT#,',',''))) 
			, F_AMT_CD_SUM(#FULL_PROF_DRTR_SRNO#,REPLACE(#PROF_YM#,'-',''),#SSEC_CD#,#ITM_CD#,#DITM_CD#,#SITM_CD#,'FND_ALC_BL') + (REPLACE(#EXTIN_AMT#,',','') - (REPLACE(#EXPN_AMT#,',','') - REPLACE(#FND_ALC_AMT#,',','') + REPLACE(#RCTF_AMT#,',','')))     
		    , 'N'
		    , #HNDL_STA_CD#
		    , ''
		    , ''
		    , '' 
		    , ''
		    , ''
		    , ''
		 ) 
	</insert>
	 -->	
	
	<!--지출계산서 Insert 이후 분기 금액 합산 update
	<update id="FAACAV061EupdateMainAmt" parameterClass="paramMap">
 		UPDATE TWFAACAV021L SET
			 BGT_ALC_AGGAMT = NVL(BGT_ALC_AGGAMT,0) + #BGT_ALC_AMT# 
			,FND_ALC_AGGAMT = NVL(FND_ALC_AGGAMT,0) + #FND_ALC_AMT# 
			,BEF_EXPN_AGG_AMT = NVL(BEF_EXPN_AGG_AMT,0) + REPLACE(#EXPN_AMT#,',','')
			,EXPN_SBTR_AGGAMT = NVL(EXPN_SBTR_AGGAMT,0) + (REPLACE(#RCTF_AMT#,',','') - (REPLACE(#EXTIN_AMT#,',','') - REPLACE(#EXPN_AMT#,',','')))
			,FND_ALC_BL = FND_ALC_BL + (REPLACE(#EXTIN_AMT#,',','') - (REPLACE(#EXPN_AMT#,',','') - REPLACE(#FND_ALC_AMT#,',','') + REPLACE(#RCTF_AMT#,',','')))
		WHERE COPT_CD          = SUBSTR(#FULL_PROF_DRTR_SRNO#,1,3) 
			AND ACNT_CD        = SUBSTR(#FULL_PROF_DRTR_SRNO#,5,3) 
			AND	BLL_CD         = SUBSTR(#FULL_PROF_DRTR_SRNO#,9,2) 
			AND	PROF_DRTR_SRNO = SUBSTR(#FULL_PROF_DRTR_SRNO#,12,3)
			AND	DL_XPN_RCDB_PBSVT_SRNO    = SUBSTR(#FULL_PROF_DRTR_SRNO#,16,3)
			AND	PROF_YM        > REPLACE(#PROF_YM#,'-','')
			AND SSEC_CD     = #SSEC_CD# 
			AND ITM_CD      = #ITM_CD#
			AND DITM_CD     = #DITM_CD#
			AND SITM_CD     = #SITM_CD#
	</update>		
	 -->
	
	<!--일상경비 교부명세서 insert
	<insert id="FAACAV061EinsertSub1" parameterClass="paramMap">
 		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD              /*소관부호*/
			, ACNT_CD              /*회계부호코드*/
			, BLL_CD               /*계산서부호코드*/
			, PROF_DRTR_SRNO       /*증명책임자일련번호*/
			, DL_XPN_RCDB_PBSVT_SRNO          /*일상경비출납공무원일련번호*/
			, PROF_YM              /*증명년월*/
			, ATT_CD               /*첨부코드*/
			, SRNO                 /*일련번호*/
			, SUM_DVSN_ID          /*구분*/
			, ATT_TXT              /*첨부내용*/
			, DTM_YN               /*확정여부*/
			, HNDL_STA_CD             /*처리상태*/
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  SUBSTR(#FULL_PROF_DRTR_SRNO#,1,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,5,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,9,2)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,12,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,16,3)
		    , REPLACE(#PROF_YM#,'-','')
		    , 'ATC280201'
		    , (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
				  WHERE ATT_CD = 'ATC280201'
				  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = REPLACE(#FULL_PROF_DRTR_SRNO#,'-','')
				  AND DGE = #maxCnt#
				  AND PROF_YM = REPLACE(#PROF_YM#,'-','')
				)
		    , #SUM_DVSN_ID#
		    , RPAD(#TXT1#,60,' ')||RPAD(#TXT2#,30,' ')||RPAD(#TXT3#,12,' ')||' '||
			  LPAD(REPLACE(NVL(#AMT1#,'0'),',',''),15,'0')||' '||
			  LPAD(REPLACE(NVL(#AMT2#,'0'),',',''),15,'0')||' '||
			  LPAD(REPLACE(NVL(#AMT3#,'0'),',',''),15,'0')||' '||
			  LPAD(REPLACE(NVL(#AMT4#,'0'),',',''),15,'0')||' '||
			  LPAD(REPLACE(NVL(#AMT5#,'0'),',',''),15,'0')||' '||
			  #RMK#
		    , 'N'
		    , #HNDL_STA_CD#
		    , #ATT_SRNO#
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		 ) 
	</insert>	
 -->
	<!--도급경비지급명세서 insert
	<insert id="FAACAV061EinsertSub2" parameterClass="paramMap">
 		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD              /*소관부호*/
			, ACNT_CD              /*회계부호코드*/
			, BLL_CD               /*계산서부호코드*/
			, PROF_DRTR_SRNO       /*증명책임자일련번호*/
			, DL_XPN_RCDB_PBSVT_SRNO          /*일상경비출납공무원일련번호*/
			, PROF_YM              /*증명년월*/
			, ATT_CD               /*첨부코드*/
			, SRNO                 /*일련번호*/
			, SUM_DVSN_ID          /*구분*/
			, ATT_TXT              /*첨부내용*/
			, DTM_YN               /*확정여부*/
			, HNDL_STA_CD             /*처리상태*/
			, ATT_SRNO 	   		   /*부표 일련번호*/
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  SUBSTR(#FULL_PROF_DRTR_SRNO#,1,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,5,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,9,2)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,12,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,16,3)
		    , REPLACE(#PROF_YM#,'-','')
		    , 'ATC280202'
		    , (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
				  WHERE ATT_CD = 'ATC280202'
				  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = REPLACE(#FULL_PROF_DRTR_SRNO#,'-','')
				  AND DGE = #maxCnt#
				  AND PROF_YM = REPLACE(#PROF_YM#,'-','')
				)
		    , #SUM_DVSN_ID#
			, RPAD(#TXT1#,60,' ')||' '||LPAD(REPLACE(#AMT1#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT2#,',',''),15,'0')||' '||#RMK#
		    , 'N'
		    , #HNDL_STA_CD#
		    , #ATT_SRNO#
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		 )  
	</insert>				
	-->
	<!--보조금등 교부명세서 insert
	<insert id="FAACAV061EinsertSub3" parameterClass="paramMap">
 		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD              /*소관부호*/
			, ACNT_CD              /*회계부호코드*/
			, BLL_CD               /*계산서부호코드*/
			, PROF_DRTR_SRNO       /*증명책임자일련번호*/
			, DL_XPN_RCDB_PBSVT_SRNO          /*일상경비출납공무원일련번호*/
			, PROF_YM              /*증명년월*/
			, ATT_CD               /*첨부코드*/
			, SRNO                 /*일련번호*/
			, SUM_DVSN_ID          /*구분*/
			, ATT_TXT              /*첨부내용*/
			, DTM_YN               /*확정여부*/
			, HNDL_STA_CD             /*처리상태*/
			, ATT_SRNO 			   /*부표 일련번호*/
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  SUBSTR(#FULL_PROF_DRTR_SRNO#,1,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,5,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,9,2)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,12,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,16,3)
		    , REPLACE(#PROF_YM#,'-','')
		    , 'ATC280203'
		    , (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
				  WHERE ATT_CD = 'ATC280203'
				  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = REPLACE(#FULL_PROF_DRTR_SRNO#,'-','')
				  AND DGE = #maxCnt#
				  AND PROF_YM = REPLACE(#PROF_YM#,'-','')
				)
		    , #SUM_DVSN_ID#
			, RPAD(#TXT1#,50,' ')||RPAD(#TXT2#,60,' ')||#SSEC_CD#||#ITM_CD#||#DITM_CD#||#SITM_CD#||' '||
			  LPAD(REPLACE(#AMT1#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT2#,',',''),15,'0')||' '||
			  LPAD(REPLACE(#AMT3#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT4#,',',''),15,'0')||' '||
			  LPAD(REPLACE(#AMT5#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT6#,',',''),15,'0')
		    , 'N'
		    , #HNDL_STA_CD#
		    , #ATT_SRNO#
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		 )  
	</insert>	
	-->
	
	<!--선금지급명세서 insert
	<insert id="FAACAV061EinsertSub4" parameterClass="paramMap">
 		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD              /*소관부호*/
			, ACNT_CD              /*회계부호코드*/
			, BLL_CD               /*계산서부호코드*/
			, PROF_DRTR_SRNO       /*증명책임자일련번호*/
			, DL_XPN_RCDB_PBSVT_SRNO          /*일상경비출납공무원일련번호*/
			, PROF_YM              /*증명년월*/
			, ATT_CD               /*첨부코드*/
			, SRNO                 /*일련번호*/
			, SUM_DVSN_ID          /*구분*/
			, ATT_TXT              /*첨부내용*/
			, DTM_YN               /*확정여부*/
			, HNDL_STA_CD             /*처리상태*/
			, ATT_SRNO 			   /*부표 일련번호*/
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  SUBSTR(#FULL_PROF_DRTR_SRNO#,1,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,5,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,9,2)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,12,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,16,3)
		    , REPLACE(#PROF_YM#,'-','')
		    , 'ATC270205'
		    , (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
				  WHERE ATT_CD = 'ATC280204'
				  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = REPLACE(#FULL_PROF_DRTR_SRNO#,'-','')
				  AND DGE = #maxCnt#
				  AND PROF_YM = REPLACE(#PROF_YM#,'-','')
				)
		    , #SUM_DVSN_ID#
			, #SSEC_CD#||#ITM_CD#||#DITM_CD#||#SITM_CD#||' '||
			  LPAD(REPLACE(#AMT1#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT2#,',',''),15,'0')||' '||
			  LPAD(REPLACE(#AMT3#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT4#,',',''),15,'0')||' '||
			  LPAD(REPLACE(#AMT5#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT6#,',',''),15,'0')||' '||
			  LPAD(REPLACE(#AMT7#,',',''),15,'0')||' '||#RMK#		
			, 'N'
		    , #HNDL_STA_CD#
		    , #ATT_SRNO#
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		 ) 
	</insert>
	 -->
	 
	<!--개산액지급명세서 insert
	<insert id="FAACAV061EinsertSub5" parameterClass="paramMap">
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD              /*소관부호*/
			, ACNT_CD              /*회계부호코드*/
			, BLL_CD               /*계산서부호코드*/
			, PROF_DRTR_SRNO       /*증명책임자일련번호*/
			, DL_XPN_RCDB_PBSVT_SRNO          /*일상경비출납공무원일련번호*/
			, PROF_YM              /*증명년월*/
			, ATT_CD               /*첨부코드*/
			, SRNO                 /*일련번호*/
			, SUM_DVSN_ID          /*구분*/
			, ATT_TXT              /*첨부내용*/
			, DTM_YN               /*확정여부*/
			, HNDL_STA_CD             /*처리상태*/
			, ATT_SRNO 				/*부표 일련번호*/
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  SUBSTR(#FULL_PROF_DRTR_SRNO#,1,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,5,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,9,2)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,12,3)
		    , SUBSTR(#FULL_PROF_DRTR_SRNO#,16,3)
		    , REPLACE(#PROF_YM#,'-','')
		    , 'ATC270205'
		    , (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
				  WHERE ATT_CD = 'ATC280205'
				  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = REPLACE(#FULL_PROF_DRTR_SRNO#,'-','')
				  AND DGE = #maxCnt#
				  AND PROF_YM = REPLACE(#PROF_YM#,'-','')
				)
		    , #SUM_DVSN_ID#
			, #SSEC_CD#||#ITM_CD#||#DITM_CD#||#SITM_CD#||' '||
			  LPAD(REPLACE(#AMT1#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT2#,',',''),15,'0')||' '||
			  LPAD(REPLACE(#AMT3#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT4#,',',''),15,'0')||' '||
			  LPAD(REPLACE(#AMT5#,',',''),15,'0')||' '||LPAD(REPLACE(#AMT6#,',',''),15,'0')||' '||
			  LPAD(REPLACE(#AMT7#,',',''),15,'0')||' '||#RMK#		
			, 'N'
		    , #HNDL_STA_CD#
		    , #ATT_SRNO#
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		 )  
	</insert>	
		-->
	
	<!--지출계산서 확정여부 update-->
	<update id="FAACAV061EupdateMain" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EupdateMain */ ]]>
		UPDATE TWFAACAV021L SET
			DTM_YN = 'Y'
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	DGE            = #DGE#
	</update>
	
	<!--일상경비교부명세서 확정여부 update-->
	<update id="FAACAV061EupdateSub1" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EupdateSub1 */ ]]>
		UPDATE TWFAACAV009L SET
			DTM_YN = 'Y'
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280201'
	</update>
	
	<!--도급경비지급명세서 확정여부 update-->
	<update id="FAACAV061EupdateSub2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EupdateSub2 */ ]]>
		UPDATE TWFAACAV009L SET
			DTM_YN = 'Y'
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280202'
	</update>	
	
	
	<!--보조금등교부명세서 확정여부 update-->
	<update id="FAACAV061EupdateSub3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EupdateSub3 */ ]]>
		UPDATE TWFAACAV009L SET
			DTM_YN = 'Y'
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280203'
	</update>
	
		
	<!--선지급명세서 확정여부 update-->
	<update id="FAACAV061EupdateSub4" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EupdateSub4 */ ]]>
		UPDATE TWFAACAV009L SET
			DTM_YN = 'Y'
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280204'
	</update>
	
		
	<!--개산액지급명세서 확정여부 update-->
	<update id="FAACAV061EupdateSub5" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EupdateSub5 */ ]]>
		UPDATE TWFAACAV009L SET
			DTM_YN = 'Y'
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280205'
	</update>	
	
	<!--지출계산서 삭제시 금액 minus update
	<update id="FAACAV061EupdateMainAmt2" parameterClass="paramMap">
 		UPDATE TWFAACAV021L SET
			  BGT_ALC_AGGAMT   = BGT_ALC_AGGAMT - REPLACE(#BGT_ALC_AMT#,',','')
			, FND_ALC_AGGAMT   = FND_ALC_AGGAMT - REPLACE(#FND_ALC_AMT#,',','')
			, EXPN_SBTR_AGGAMT = NVL(EXPN_SBTR_AGGAMT,0) - (REPLACE(#RCTF_AMT#,',','') - (REPLACE(#EXTIN_AMT#,',','') - REPLACE(#EXPN_AMT#,',','')))
			, FND_ALC_BL 	   = FND_ALC_BL - (REPLACE(#EXTIN_AMT#,',','') - (REPLACE(#EXPN_AMT#,',','') - REPLACE(#FND_ALC_AMT#,',','') + REPLACE(#RCTF_AMT#,',','')))
		WHERE COPT_CD          = #COPT_CD#       
			AND ACNT_CD        = #ACNT_CD#       
			AND	BLL_CD         = #BLL_CD#        
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#   
			AND (PROF_YM != #PROF_YM# OR DGE > #DGE#)
			AND SSEC_CD     = #SSEC_CD# 
			AND ITM_CD      = #ITM_CD#
			AND DITM_CD     = #DITM_CD#
			AND SITM_CD     = #SITM_CD#
			<isEqual property="strMm" compareValue="01">
				AND	SUBSTR(PROF_YM,1,4) IN (SUBSTR(#PROF_YM#,1,4))
			</isEqual>
			<isEqual property="strMm" compareValue="02">
				AND	PROF_YM IN (#PROF_YM#, #PROF_YM# + 1, #PROF_YM# + 2)
			</isEqual>
			<isEqual property="strMm" compareValue="03">
				AND	PROF_YM IN (#PROF_YM#, #PROF_YM# + 1)
			</isEqual>
			<isEqual property="strMm" compareValue="04">
				AND	PROF_YM = #PROF_YM#
			</isEqual>
			AND SUM_DVSN_ID != '49'
	</update>
	 -->
			
	<!--지출계산서 삭제시 금액 minus update(전기까지 누계만 따로 빼야해서 쿼리 다시 만듬)
	<update id="FAACAV061EupdateBefExpnAggAmt" parameterClass="paramMap">
 		UPDATE TWFAACAV021L SET
			BEF_EXPN_AGG_AMT   = BEF_EXPN_AGG_AMT - #EXPN_AMT#		    
		WHERE COPT_CD          = #COPT_CD#       
			AND ACNT_CD        = #ACNT_CD#       
			AND	BLL_CD         = #BLL_CD#        
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#   
			AND (PROF_YM != #PROF_YM# OR DGE > #DGE#)
			AND SSEC_CD     = #SSEC_CD# 
			AND ITM_CD      = #ITM_CD#
			AND DITM_CD     = #DITM_CD#
			AND SITM_CD     = #SITM_CD#
			AND	PROF_YM > #PROF_YM#
			AND SUM_DVSN_ID != '49'
	</update>		
	 -->
	 
	<!--지출계산서 삭제 -->
	<delete id="FAACAV061EdeleteMain" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteMain */ ]]>
		DELETE FROM TWFAACAV021L
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM     = #PROF_YM#
			AND SSEC_CD     = #SSEC_CD# 
			AND ITM_CD      = #ITM_CD#
			AND DITM_CD     = #DITM_CD#
			AND SITM_CD     = #SITM_CD#
			AND	DGE         = #DGE#
	</delete>
	
	
	
	<!--일상경비교부명세서 삭제 -->
	<delete id="FAACAV061EdeleteSub1" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteSub1 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280201'
	</delete>	
	
	
	<!--도급경비지급명세서 삭제 -->
	<delete id="FAACAV061EdeleteSub2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteSub2 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280202'
	</delete>
			
	
	<!--보조금등교부명세서 대사조서 삭제 -->
	<delete id="FAACAV061EdeleteSub3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteSub3 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280203'
	</delete>
	
			
	<!--선지급명세서 삭제 -->
	<delete id="FAACAV061EdeleteSub4" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteSub4 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280204'
	</delete>
	
			
	<!--개산액지급명세서 삭제 -->
	<delete id="FAACAV061EdeleteSub5" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteSub5 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #COPT_CD#
			AND ACNT_CD        = #ACNT_CD#
			AND	BLL_CD         = #BLL_CD#
			AND	PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #DL_XPN_RCDB_PBSVT_SRNO#
			AND	PROF_YM        = #PROF_YM#
			AND	SRNO           = #SRNO#
			AND ATT_CD = 'ATC280205'
	</delete>
	
<!-- 	<select id="FAACAV061EselectMainTxt" parameterClass="paramMap" resultClass="resultMap">
	    SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV021L
	    WHERE PROF_YM = SUBSTR(#MAIN#,15,6)
	    AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO =  SUBSTR(#MAIN#,1,14)
	</select>
	
	<insert id="FAACAV061EinsertMainTxt" parameterClass="paramMap">
		INSERT INTO TWFAACAV021L
		 (
		    COPT_CD             
		    , ACNT_CD             
		    , BLL_CD              
		    , PROF_DRTR_SRNO      
		    , DL_XPN_RCDB_PBSVT_SRNO        
		    , PROF_YM             
		    , SUM_DVSN_ID         
		    , SSEC_CD             
		    , ITM_CD
		    , DITM_CD
		    , SITM_CD
		    , DGE                 
		    , TQR_BGT_ALC_AMT     
		    , TQR_TO_BGT_ALC_ATAG   
		    , TQR_FND_ALC_AMT     
		    , TQR_TO_FND_ALC_ATAG   
		    , TQR_EXPN_AMT        
		    , ELT_TO_EXPN_ATAG    
		    , TQR_RED_AMT         
		    , TQR_SUBJ_ASO_RCTF_AMT         
		    , EXPN_SBTR_ATAG      
		    , FND_ALC_BL          
		    , DTM_YN              
		    , HNDL_STA_CD         
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID      
		 ) VALUES (
		 	 SUBSTR(#MAIN#,1,3)
		 	,SUBSTR(#MAIN#,4,3)
		 	,SUBSTR(#MAIN#,7,2)
		 	,SUBSTR(#MAIN#,9,3)
		 	,SUBSTR(#MAIN#,12,3)
		 	,SUBSTR(#MAIN#,15,6)
		 	,SUBSTR(#MAIN#,21,2)
		 	,SUBSTR(#MAIN#,23,4)
		 	,SUBSTR(#MAIN#,27,4)
		 	,SUBSTR(#MAIN#,31,4)
		 	,SUBSTR(#MAIN#,35,3)
			,#maxCnt#
		 	,DECODE(SUBSTRB(#MAIN#,38,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,39,15)),TO_NUMBER(SUBSTRB(#MAIN#,39,15)))
		 	,DECODE(SUBSTRB(#MAIN#,54,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,55,15)),TO_NUMBER(SUBSTRB(#MAIN#,55,15)))
		 	,DECODE(SUBSTRB(#MAIN#,70,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,71,15)),TO_NUMBER(SUBSTRB(#MAIN#,71,15)))
		 	,DECODE(SUBSTRB(#MAIN#,86,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,87,15)),TO_NUMBER(SUBSTRB(#MAIN#,87,15)))
		 	,DECODE(SUBSTRB(#MAIN#,102,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,103,15)),TO_NUMBER(SUBSTRB(#MAIN#,103,15)))
		 	,DECODE(SUBSTRB(#MAIN#,118,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,119,15)),TO_NUMBER(SUBSTRB(#MAIN#,119,15)))
		 	,DECODE(SUBSTRB(#MAIN#,134,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,135,15)),TO_NUMBER(SUBSTRB(#MAIN#,135,15)))
		 	,DECODE(SUBSTRB(#MAIN#,150,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,151,15)),TO_NUMBER(SUBSTRB(#MAIN#,151,15)))
		 	,DECODE(SUBSTRB(#MAIN#,166,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,167,15)),TO_NUMBER(SUBSTRB(#MAIN#,167,15)))
		 	,DECODE(SUBSTRB(#MAIN#,182,1),'-','-'||TO_NUMBER(SUBSTRB(#MAIN#,183,15)),TO_NUMBER(SUBSTRB(#MAIN#,183,15)))
		 	,'N'
		 	,''
		 	,''
		 	,''
		 	,''
		 	,''
		 	,''
		 	,''
		 )
	</insert>
	
	<select id="FAACAV061EselectTxt280201" parameterClass="paramMap" resultClass="resultMap">
	    SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
	    WHERE PROF_YM = SUBSTR(#ATC280201#,15,6)
	    AND ATT_CD = 'ATC280201'
	    AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO =  SUBSTR(#ATC280201#,1,14)
	</select>			
		
	<insert id="FAACAV061EinsertTxt280201" parameterClass="paramMap">
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID  			
		 ) VALUES (
		 	  SUBSTRB(#ATC280201#,1,3)
		 	, SUBSTRB(#ATC280201#,4,3)
		 	, SUBSTRB(#ATC280201#,7,2)
		 	, SUBSTRB(#ATC280201#,9,3)
		 	, SUBSTRB(#ATC280201#,12,3)
		 	, SUBSTRB(#ATC280201#,15,6)
		 	, 'ATC280201'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280201'
			 	  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = SUBSTRB(#ATC280201#,1,14)
			 	  AND PROF_YM = SUBSTRB(#ATC280201#,15,6)
			 	)
			, #maxCnt#
			, 'Txt'			 	
		 	, SUBSTRB(#ATC280201#,21,2)
		 	, TRIM(SUBSTRB(#ATC280201#,23,400))
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )
	</insert>	
	
	<select id="FAACAV061EselectTxt280202" parameterClass="paramMap" resultClass="resultMap">
	    SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
	    WHERE PROF_YM = SUBSTR(#ATC280202#,15,6)
	    AND ATT_CD = 'ATC280202'
	    AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO =  SUBSTR(#ATC280202#,1,14)
	</select>				
	
	<insert id="FAACAV061EinsertTxt280202" parameterClass="paramMap">
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID  			
		 ) VALUES (
		 	  SUBSTRB(#ATC280202#,1,3)
		 	, SUBSTRB(#ATC280202#,4,3)
		 	, SUBSTRB(#ATC280202#,7,2)
		 	, SUBSTRB(#ATC280202#,9,3)
		 	, SUBSTRB(#ATC280202#,12,3)
		 	, SUBSTRB(#ATC280202#,15,6)
		 	, 'ATC280202'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280202'
			 	  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = SUBSTRB(#ATC280202#,1,14)
			 	  AND PROF_YM = SUBSTRB(#ATC280202#,15,6)
			 	)
			, #maxCnt#
			, 'Txt'			 	
		 	, SUBSTRB(#ATC280202#,21,2)
		 	, TRIM(SUBSTRB(#ATC280202#,23,400))
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )
	</insert>
	
	<select id="FAACAV061EselectTxt280203" parameterClass="paramMap" resultClass="resultMap">
	    SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
	    WHERE PROF_YM = SUBSTR(#ATC280203#,15,6)
	    AND ATT_CD = 'ATC280203'
	    AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO =  SUBSTR(#ATC280203#,1,14)
	</select>				
		
	<insert id="FAACAV061EinsertTxt280203" parameterClass="paramMap">
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID  			
		 ) VALUES (
		 	  SUBSTRB(#ATC280203#,1,3)
		 	, SUBSTRB(#ATC280203#,4,3)
		 	, SUBSTRB(#ATC280203#,7,2)
		 	, SUBSTRB(#ATC280203#,9,3)
		 	, SUBSTRB(#ATC280203#,12,3)
		 	, SUBSTRB(#ATC280203#,15,6)
		 	, 'ATC280203'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280203'
			 	  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = SUBSTRB(#ATC280203#,1,14)
			 	  AND PROF_YM = SUBSTRB(#ATC280203#,15,6)
			 	)
			, #maxCnt#
			, 'Txt'			 	
		 	, SUBSTRB(#ATC280203#,21,2)
		 	, TRIM(SUBSTRB(#ATC280203#,23,400))
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )
	</insert>
	
	<select id="FAACAV061EselectTxt280204" parameterClass="paramMap" resultClass="resultMap">
	    SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
	    WHERE PROF_YM = SUBSTR(#ATC280204#,15,6)
	    AND ATT_CD = 'ATC280204'
	    AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO =  SUBSTR(#ATC280204#,1,14)
	</select>				
		
	<insert id="FAACAV061EinsertTxt280204" parameterClass="paramMap">
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID  			
		 ) VALUES (
		 	  SUBSTRB(#ATC280204#,1,3)
		 	, SUBSTRB(#ATC280204#,4,3)
		 	, SUBSTRB(#ATC280204#,7,2)
		 	, SUBSTRB(#ATC280204#,9,3)
		 	, SUBSTRB(#ATC280204#,12,3)
		 	, SUBSTRB(#ATC280204#,15,6)
		 	, 'ATC280204'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280204'
			 	  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = SUBSTRB(#ATC280204#,1,14)
			 	  AND PROF_YM = SUBSTRB(#ATC280204#,15,6)
			 	)
			, #maxCnt#
			, 'Txt'			 	
		 	, SUBSTRB(#ATC280204#,21,2)
		 	, TRIM(SUBSTRB(#ATC280204#,23,400))
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )
	</insert>
		
		
	<select id="FAACAV061EselectTxt280205" parameterClass="paramMap" resultClass="resultMap">
	    SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
	    WHERE PROF_YM = SUBSTR(#ATC280205#,15,6)
	    AND ATT_CD = 'ATC280205'
	    AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO =  SUBSTR(#ATC280205#,1,14)
	</select>					
		
		
	<insert id="FAACAV061EinsertTxt280205" parameterClass="paramMap">
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID  			
		 ) VALUES (
		 	  SUBSTRB(#ATC280205#,1,3)
		 	, SUBSTRB(#ATC280205#,4,3)
		 	, SUBSTRB(#ATC280205#,7,2)
		 	, SUBSTRB(#ATC280205#,9,3)
		 	, SUBSTRB(#ATC280205#,12,3)
		 	, SUBSTRB(#ATC280205#,15,6)
		 	, 'ATC280205'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280205'
			 	  AND COPT_CD||ACNT_CD||BLL_CD||PROF_DRTR_SRNO||DL_XPN_RCDB_PBSVT_SRNO = SUBSTRB(#ATC280205#,1,14)
			 	  AND PROF_YM = SUBSTRB(#ATC280205#,15,6)
			 	)
			, #maxCnt#
			, 'Txt'			 	
		 	, SUBSTRB(#ATC280205#,21,2)
		 	, TRIM(SUBSTRB(#ATC280205#,23,400))
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )	
	</insert>	


	 -->

	<!--지출계산서 Max 값 채번-->
	<select id="FAACAV061EselectMaxCnt" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectMaxCnt */ ]]>
        <![CDATA[
			SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV021L
			WHERE PROF_YM = #profYm#
		   		AND COPT_CD = #coptCd#
				AND ACNT_CD = #acntCd#
				AND BLL_CD = #bllCd#
				AND PROF_DRTR_SRNO = #profDrtrSrno#
				AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
        ]]>  
	</select>	
	
	<!-- 지출계산서 -->
	<insert id="FAACAV061EinsertMainExcel" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EinsertMainExcel */ ]]>
		INSERT INTO TWFAACAV021L
		 (
		    COPT_CD             
		    , ACNT_CD             
		    , BLL_CD              
		    , PROF_DRTR_SRNO      
		    , DL_XPN_RCDB_PBSVT_SRNO        
		    , PROF_YM             
		    , SUM_DVSN_ID         
		    , SSEC_CD             
		    , ITM_CD
		    , DITM_CD
		    , SITM_CD
		    , DGE                 
		    , TQR_BGT_ALC_AMT     
		    , TQR_TO_BGT_ALC_ATAG   
		    , TQR_FND_ALC_AMT     
		    , TQR_TO_FND_ALC_ATAG   
		    , TQR_EXPN_AMT        
		    , ELT_TO_EXPN_ATAG    
		    , TQR_RED_AMT         
		    , TQR_SUBJ_ASO_RCTF_AMT         
		    , EXPN_SBTR_ATAG      
		    , FND_ALC_BL          
		    , DTM_YN              
		    , HNDL_STA_CD         
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 		
		 ) VALUES (
			  #coptCd#
		    , #acntCd#
		    , #bllCd#
		    , #profDrtrSrno#
		    , #ordpubSrno#
		    , #profYm#
		    , TO_NUMBER(#COL0#)
		    , REPLACE(#COL1#,'.0','')
		    , REPLACE(#COL2#,'.0','')
		    , REPLACE(#COL3#,'.0','')
		    , REPLACE(#COL4#,'.0','')
		    , #maxCnt#
		    , TO_NUMBER(#COL5#)
		    , TO_NUMBER(#COL6#)
   		    , TO_NUMBER(#COL7#)
   			, TO_NUMBER(#COL8#)
   		    , TO_NUMBER(#COL9#)
   		    , TO_NUMBER(#COL10#)
		    , TO_NUMBER(#COL11#)
		    , TO_NUMBER(#COL12#)
			, TO_NUMBER(#COL13#) 
			, TO_NUMBER(#COL14#)     
		    , 'N'
		    , ''
		    , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		    , ''
		    , ''
		    , ''
		    , ''
		    , ''
		 ) 
	</insert>		
	
	<!-- 일상경비교부명세서 MAX -->
	<select id="FAACAV061EselectExcel280201" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectExcel280201 */ ]]>
        <![CDATA[
			SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			WHERE PROF_YM = #profYm#
				AND ATT_CD = 'ATC280201'
		   		AND COPT_CD = #coptCd#
				AND ACNT_CD = #acntCd#
				AND BLL_CD = #bllCd#
				AND PROF_DRTR_SRNO = #profDrtrSrno#
				AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
        ]]>  
	</select>				
	
	<!-- 일상경비교부명세서 -->
	<insert id="FAACAV061EinsertExcel280201" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EinsertExcel280201 */ ]]>
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  #coptCd#
		    , #acntCd#
		    , #bllCd#
		    , #profDrtrSrno#
		    , #ordpubSrno#
		    , #profYm#
		 	, 'ATC280201'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280201'
					AND PROF_YM = #profYm#
					AND COPT_CD = #coptCd#
					AND ACNT_CD = #acntCd#
					AND BLL_CD = #bllCd#
					AND PROF_DRTR_SRNO = #profDrtrSrno#
					AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
			 	)
			, #maxCnt#
			, 'Excel'
		 	, TO_NUMBER(#COL0#)
		 	, RPAD(NVL(#COL1#, ' '),60,' ')||RPAD(NVL(#COL2#, ' '),30,' ')||RPAD(NVL(#COL3#, ' '),13,' ')||
		 	  LPAD(TO_NUMBER(#COL4#),15,' ')||' '||LPAD(TO_NUMBER(#COL5#),15,' ')||' '||
		 	  LPAD(TO_NUMBER(#COL6#),15,' ')||' '||LPAD(TO_NUMBER(#COL7#),15,' ')||' '||
		 	  LPAD(TO_NUMBER(#COL8#),15,' ')||#COL9#
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )
	</insert>	
	
	<!-- 도급경비지급명세서 MAX-->
	<select id="FAACAV061EselectExcel280202" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectExcel280202 */ ]]>
        <![CDATA[
			SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			WHERE PROF_YM = #profYm#
				AND ATT_CD = 'ATC280202'
		   		AND COPT_CD = #coptCd#
				AND ACNT_CD = #acntCd#
				AND BLL_CD = #bllCd#
				AND PROF_DRTR_SRNO = #profDrtrSrno#
				AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
        ]]>  
	</select>			
	
	<!-- 도급경비지급명세서 -->
	<insert id="FAACAV061EinsertExcel280202" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EinsertExcel280202 */ ]]>
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  #coptCd#
		    , #acntCd#
		    , #bllCd#
		    , #profDrtrSrno#
		    , #ordpubSrno#
		    , #profYm#
		 	, 'ATC280202'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280202'
					AND PROF_YM = #profYm#
			   		AND COPT_CD = #coptCd#
					AND ACNT_CD = #acntCd#
					AND BLL_CD = #bllCd#
					AND PROF_DRTR_SRNO = #profDrtrSrno#
					AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
			 	)
			, #maxCnt#
			, 'Excel'			 	
		 	, TO_NUMBER(#COL0#)
		 	, RPAD(NVL(#COL1#,' '),60,' ')||LPAD(TO_NUMBER(#COL2#),15,' ')||' '||LPAD(TO_NUMBER(#COL3#),15,' ')||#COL4#
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )
	</insert>
	
	<!-- 보조금등 교부명세서 MAX -->
	<select id="FAACAV061EselectExcel280203" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectExcel280203 */ ]]>
        <![CDATA[
			SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			WHERE PROF_YM = #profYm#
				AND ATT_CD = 'ATC280203'
   				AND COPT_CD = #coptCd#
				AND ACNT_CD = #acntCd#
				AND BLL_CD = #bllCd#
				AND PROF_DRTR_SRNO = #profDrtrSrno#
				AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
        ]]>  
	</select>			
		
	<!-- 보조금등 교부명세서 -->
	<insert id="FAACAV061EinsertExcel280203" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EinsertExcel280203 */ ]]>
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  #coptCd#
		    , #acntCd#
		    , #bllCd#
		    , #profDrtrSrno#
		    , #ordpubSrno#
		    , #profYm#
		 	, 'ATC280203'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280203'
					AND PROF_YM = #profYm#
			   		AND COPT_CD = #coptCd#
					AND ACNT_CD = #acntCd#
					AND BLL_CD = #bllCd#
					AND PROF_DRTR_SRNO = #profDrtrSrno#
					AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
			 	)
			, #maxCnt#
			, 'Excel'			 	
		 	, TO_NUMBER(#COL0#)
		 	, RPAD(NVL(#COL1#, ' '),50,' ')||RPAD(NVL(#COL2#, ' '),60,' ')||TO_NUMBER(#COL3#)||TO_NUMBER(#COL4#)||TO_NUMBER(#COL5#)||TO_NUMBER(#COL6#)||' '||
		 	LPAD(TO_NUMBER(#COL7#),15,' ')||' '||LPAD(TO_NUMBER(#COL8#),15,' ')||' '||LPAD(TO_NUMBER(#COL9#),15,' ')||' '||
		 	LPAD(TO_NUMBER(#COL10#),15,' ')||' '||LPAD(TO_NUMBER(#COL11#),15,' ')||' '||LPAD(TO_NUMBER(#COL12#),15,' ')
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )
	</insert>
	
	<!-- 선지급명세서 MAX -->
	<select id="FAACAV061EselectExcel280204" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectExcel280204 */ ]]>
        <![CDATA[
			SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			WHERE PROF_YM = #profYm#
				AND ATT_CD = 'ATC280204'
		   		AND COPT_CD = #coptCd#
				AND ACNT_CD = #acntCd#
				AND BLL_CD = #bllCd#
				AND PROF_DRTR_SRNO = #profDrtrSrno#
				AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
        ]]>  
	</select>			
		
	<!-- 선지급명세서 -->
	<insert id="FAACAV061EinsertExcel280204" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EinsertExcel280204 */ ]]>
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  #coptCd#
		    , #acntCd#
		    , #bllCd#
		    , #profDrtrSrno#
		    , #ordpubSrno#
		    , #profYm#
		 	, 'ATC280204'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280204'
					AND PROF_YM = #profYm#
			   		AND COPT_CD = #coptCd#
					AND ACNT_CD = #acntCd#
					AND BLL_CD = #bllCd#
					AND PROF_DRTR_SRNO = #profDrtrSrno#
					AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
			 	)
			, #maxCnt#
			, 'Excel'			 	
		 	, TO_NUMBER(#COL0#)
		 	, LPAD(TO_NUMBER(#COL1#),4,0)||LPAD(TO_NUMBER(#COL2#),4,0)||LPAD(TO_NUMBER(#COL3#),4,0)||LPAD(TO_NUMBER(#COL4#),3,0)||' '||LPAD(TO_NUMBER(#COL5#),15,' ')||' '||LPAD(TO_NUMBER(#COL6#),15,' ')||' '||LPAD(TO_NUMBER(#COL7#),15,' ')||' '||
		 	  LPAD(TO_NUMBER(#COL8#),15, ' ')||' '||LPAD(TO_NUMBER(#COL9#),15, ' ')||' '||LPAD(TO_NUMBER(#COL10#),15, ' ')||' '||LPAD(TO_NUMBER(#COL11#),16,' ')||#COL12#
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )
	</insert>
	
	<!-- 개산액지급명세서 MAX -->
	<select id="FAACAV061EselectExcel280205" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EselectExcel280205 */ ]]>
        <![CDATA[
			SELECT NVL(MAX(DGE),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			WHERE PROF_YM = #profYm#
				AND ATT_CD = 'ATC280205'
		   		AND COPT_CD = #coptCd#
				AND ACNT_CD = #acntCd#
				AND BLL_CD = #bllCd#
				AND PROF_DRTR_SRNO = #profDrtrSrno#
				AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
        ]]>  
	</select>			
		
		
	<!-- 개산액지급명세서 -->
	<insert id="FAACAV061EinsertExcel280205" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EinsertExcel280205 */ ]]>
		INSERT INTO TWFAACAV009L
		 (
			  COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YM
			, ATT_CD
			, SRNO
			, DGE
			, ATT_TYP_ID
			, SUM_DVSN_ID
			, ATT_TXT
			, DTM_YN
			, HNDL_STA_CD
			, ATT_SRNO
		    , FRT_REGI_DH         
		    , FRT_USR_ID          
		    , FNL_MDF_DH          
		    , FNL_USR_ID          
		    , FNL_DEAL_DPT_CD     
		    , FNL_MNU_ID 			
		 ) VALUES (
			  #coptCd#
		    , #acntCd#
		    , #bllCd#
		    , #profDrtrSrno#
		    , #ordpubSrno#
		    , #profYm#
		 	, 'ATC280205'
		 	, (SELECT NVL(MAX(SRNO),0)+1 AS MAX_SEQ FROM TWFAACAV009L
			 	  WHERE ATT_CD = 'ATC280205'
					AND PROF_YM = #profYm#
			   		AND COPT_CD = #coptCd#
					AND ACNT_CD = #acntCd#
					AND BLL_CD = #bllCd#
					AND PROF_DRTR_SRNO = #profDrtrSrno#
					AND DL_XPN_RCDB_PBSVT_SRNO = #ordpubSrno#
			 	)
			, #maxCnt#
			, 'Excel'
		 	, TO_NUMBER(#COL0#)
		 	, LPAD(TO_NUMBER(#COL1#),4,0)||LPAD(TO_NUMBER(#COL2#),4,0)||LPAD(TO_NUMBER(#COL3#),4,0)||LPAD(TO_NUMBER(#COL4#),3,0)||' '||LPAD(TO_NUMBER(#COL5#),15,' ')||' '||LPAD(TO_NUMBER(#COL6#),15,' ')||' '||LPAD(TO_NUMBER(#COL7#),15,' ')||' '||
		 	  LPAD(TO_NUMBER(#COL8#),15,' ')||' '||LPAD(TO_NUMBER(#COL9#),15,' ')||' '||LPAD(TO_NUMBER(#COL10#),15,' ')||' '||LPAD(TO_NUMBER(#COL11#),15,' ')||#COL12#
		 	, 'N'
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 	, ''
		 )	
	</insert>
	

	<!--지출계산서 출력-->
	<select id="FAACAV061R_M" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061R_M */ ]]>
		SELECT
		    COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호 
		    , SUBSTR(PROF_YM,1,4) || '년 ' || SUBSTR(PROF_YM,5,2) || '월' AS 분기
          	, F_AV_ACNT_CD_NM(ACNT_CD) AS 회계명
            , F_AV_BLL_COPT_CD_NM(COPT_CD) AS 소관명		    
		    , SSEC_CD||'-'||ITM_CD||'-'||DITM_CD||'-'||SITM_CD AS 관항세항목
		    , TQR_BGT_ALC_AMT AS AMT1
		    , TQR_TO_BGT_ALC_ATAG AS  AMT2
		    , TQR_FND_ALC_AMT AS  AMT3
		    , TQR_TO_FND_ALC_ATAG AS AMT4
		    , TQR_EXPN_AMT AS AMT5
		    , ELT_TO_EXPN_ATAG AS AMT6
		    , TQR_RED_AMT AS AMT7
		    , TQR_SUBJ_ASO_RCTF_AMT AS AMT8
		    , EXPN_SBTR_ATAG AS AMT9
		    , FND_ALC_BL AS AMT10
		FROM TWFAACAV021L
		WHERE 1 = 1
			AND DGE = (
						SELECT MAX(DGE) 
							FROM TWFAACAV021L
						WHERE PROF_YM = #strYr#||#strMm# 
						    AND COPT_CD = #strCoptCd#
							AND ACNT_CD = #strAcntCd#
							AND BLL_CD = #strBllCd#
							AND PROF_DRTR_SRNO = #strProfDrtrSrno#
							AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
					   )		
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		ORDER BY 증명책임자부호, SUM_DVSN_ID DESC, 관항세항목
	</select>
			
	<!-- 일상경비교부명세서 -->
	<select id="FAACAV061R_01" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061R_01 */ ]]>
        <![CDATA[
		SELECT 
				 COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
				, SUBSTR(PROF_YM,1,4) || '년 ' || SUBSTR(PROF_YM,5,2) || '월' AS 분기
          	    , F_AV_ACNT_CD_NM(ACNT_CD) AS 회계명
                , F_AV_BLL_COPT_CD_NM(COPT_CD) AS 소관명				
				, TRIM(SUBSTRB(ATT_TXT, 1, 60)) AS TXT1
				, TRIM(SUBSTRB(ATT_TXT, 61, 30)) AS TXT2
				, TRIM(SUBSTRB(ATT_TXT, 91, 13)) AS TXT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 104, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 120, 15)) AS AMT2
				, TO_NUMBER(SUBSTRB(ATT_TXT, 136, 15)) AS AMT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 152, 15)) AS AMT4
				, TO_NUMBER(SUBSTRB(ATT_TXT, 168, 15)) AS AMT5
				, TRIM(SUBSTRB(ATT_TXT, 183, 140)) AS RMK
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280201'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
			AND SUM_DVSN_ID != '49'		
		ORDER BY 증명책임자부호, SUM_DVSN_ID DESC 
        ]]>  
	</select>
	
	<!-- 도급경비지급명세서 -->
	<select id="FAACAV061R_02" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061R_02 */ ]]>
        <![CDATA[
		SELECT 
				 COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
				, SUBSTR(PROF_YM,1,4) || '년 ' || SUBSTR(PROF_YM,5,2) || '월' AS 분기
          	    , F_AV_ACNT_CD_NM(ACNT_CD) AS 회계명
                , F_AV_BLL_COPT_CD_NM(COPT_CD) AS 소관명				
				, SUBSTRB(ATT_TXT, 1, 60) AS TXT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 61, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 77, 15)) AS AMT2
				, SUBSTRB(ATT_TXT, 98, 300) AS RMK
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280202'
        	AND SUM_DVSN_ID != '49'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#        
		ORDER BY 증명책임자부호, SUM_DVSN_ID DESC
        ]]>  
	</select>
	
	<!-- 보조금등 교부명세서 -->
	<select id="FAACAV061R_03" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061R_03 */ ]]>
        <![CDATA[
		SELECT 
				 COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
				, SUBSTR(PROF_YM,1,4) || '년 ' || SUBSTR(PROF_YM,5,2) || '월' AS 분기
          	    , F_AV_ACNT_CD_NM(ACNT_CD) AS 회계명
                , F_AV_BLL_COPT_CD_NM(COPT_CD) AS 소관명				
				, SUBSTRB(ATT_TXT, 111, 4)||'-'||SUBSTRB(ATT_TXT, 115, 4)||'-'||SUBSTRB(ATT_TXT, 119, 4)||'-'||SUBSTRB(ATT_TXT, 123, 3) AS 관항세항목
				, SUBSTRB(ATT_TXT, 1, 50) AS TXT1
				, SUBSTRB(ATT_TXT, 51, 60) AS TXT2
				, TO_NUMBER(SUBSTRB(ATT_TXT, 127, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 143, 15)) AS AMT2
				, TO_NUMBER(SUBSTRB(ATT_TXT, 159, 15)) AS AMT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 175, 15)) AS AMT4
				, TO_NUMBER(SUBSTRB(ATT_TXT, 191, 15)) AS AMT5
				, TO_NUMBER(SUBSTRB(ATT_TXT, 207, 15)) AS AMT6
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280203'
			AND SUM_DVSN_ID != '49'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#  
		ORDER BY 증명책임자부호, 관항세항목, SUM_DVSN_ID DESC
        ]]>  
	</select>
			
			
	<!-- 선지급명세서 -->
	<select id="FAACAV061R_04" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061R_04 */ ]]>
		SELECT 
				 COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
				, SUBSTR(PROF_YM,1,4) || '년 ' || SUBSTR(PROF_YM,5,2) || '월' AS 분기
          	    , F_AV_ACNT_CD_NM(ACNT_CD) AS 회계명
                , F_AV_BLL_COPT_CD_NM(COPT_CD) AS 소관명				
				, SUBSTRB(ATT_TXT, 1, 4)||'-'||SUBSTRB(ATT_TXT, 5, 4)||'-'||SUBSTRB(ATT_TXT, 9, 4)||'-'||SUBSTRB(ATT_TXT, 13, 3) AS 관항세항목
				, TO_NUMBER(SUBSTRB(ATT_TXT, 17, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 33, 15)) AS AMT2
				, TO_NUMBER(SUBSTRB(ATT_TXT, 49, 15)) AS AMT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 65, 15)) AS AMT4
				, TO_NUMBER(SUBSTRB(ATT_TXT, 81, 15)) AS AMT5
				, TO_NUMBER(SUBSTRB(ATT_TXT, 97, 15)) AS AMT6
				, TO_NUMBER(SUBSTRB(ATT_TXT, 113, 15)) AS AMT7     
				, SUBSTRB(ATT_TXT, 128, 300) AS RMK
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280204'
			AND SUM_DVSN_ID != '49'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND  BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND  DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#  
		ORDER BY 증명책임자부호, 관항세항목, SUM_DVSN_ID DESC
		
	</select>
	
				
	<!--  개산액지급명세서 -->
	<select id="FAACAV061R_05" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/061/FAACAV061R_05 */ ]]>
		SELECT 
				 COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
				, SUBSTR(PROF_YM,1,4) || '년 ' || SUBSTR(PROF_YM,5,2) || '월' AS 분기
          	    , F_AV_ACNT_CD_NM(ACNT_CD) AS 회계명
                , F_AV_BLL_COPT_CD_NM(COPT_CD) AS 소관명				
				, SUBSTRB(ATT_TXT, 1, 4)||'-'||SUBSTRB(ATT_TXT, 5, 4)||'-'||SUBSTRB(ATT_TXT, 9, 4)||'-'||SUBSTRB(ATT_TXT, 13, 3) AS 관항세항목
				, TO_NUMBER(SUBSTRB(ATT_TXT, 17, 15)) AS AMT1
				, TO_NUMBER(SUBSTRB(ATT_TXT, 33, 15)) AS AMT2
				, TO_NUMBER(SUBSTRB(ATT_TXT, 49, 15)) AS AMT3
				, TO_NUMBER(SUBSTRB(ATT_TXT, 65, 15)) AS AMT4
				, TO_NUMBER(SUBSTRB(ATT_TXT, 81, 15)) AS AMT5
				, TO_NUMBER(SUBSTRB(ATT_TXT, 97, 15)) AS AMT6
				, TO_NUMBER(SUBSTRB(ATT_TXT, 113, 15)) AS AMT7     
				, SUBSTRB(ATT_TXT, 128, 300) AS RMK
		FROM TWFAACAV009L
		WHERE ATT_CD = 'ATC280205'
			AND SUM_DVSN_ID != '49'
			AND PROF_YM = #strYr#||#strMm#
			AND COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#  
		ORDER BY 증명책임자부호, 관항세항목, SUM_DVSN_ID DESC
		
	</select>
	
	<!--지출계산서 삭제 (엑셀 업로드시 기존에 있는 지출계산서를 삭제하고 insert하기 위함)-->
	<delete id="FAACAV061EdeleteMainExcel" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteMainExcel */ ]]>
		DELETE FROM TWFAACAV021L
		WHERE COPT_CD          = #coptCd#
			AND ACNT_CD        = #acntCd#
			AND	BLL_CD         = #bllCd#
			AND	PROF_DRTR_SRNO = #profDrtrSrno#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #ordpubSrno#
			AND	PROF_YM     = #profYm#
	</delete>
	
	<!--부표 1 삭제 (엑셀 업로드시 기존에 있는 지출계산서를 삭제하고 insert하기 위함)-->
	<delete id="FAACAV061EdeleteExcel280201" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteExcel280201 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #coptCd#
			AND ACNT_CD        = #acntCd#
			AND	BLL_CD         = #bllCd#
			AND	PROF_DRTR_SRNO = #profDrtrSrno#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #ordpubSrno#
			AND	PROF_YM        = #profYm#
			AND ATT_CD = 'ATC280201'
	</delete>	
	
	<!--부표 2 삭제 (엑셀 업로드시 기존에 있는 지출계산서를 삭제하고 insert하기 위함)-->
	<delete id="FAACAV061EdeleteExcel280202" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteExcel280202 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #coptCd#
			AND ACNT_CD        = #acntCd#
			AND	BLL_CD         = #bllCd#
			AND	PROF_DRTR_SRNO = #profDrtrSrno#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #ordpubSrno#
			AND	PROF_YM        = #profYm#
			AND ATT_CD = 'ATC280202'
	</delete>	
	
	<!--부표 3 삭제 (엑셀 업로드시 기존에 있는 지출계산서를 삭제하고 insert하기 위함)-->
	<delete id="FAACAV061EdeleteExcel280203" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteExcel280203 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #coptCd#
			AND ACNT_CD        = #acntCd#
			AND	BLL_CD         = #bllCd#
			AND	PROF_DRTR_SRNO = #profDrtrSrno#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #ordpubSrno#
			AND	PROF_YM        = #profYm#
			AND ATT_CD = 'ATC280203'
	</delete>	
	
	<!--부표 4 삭제 (엑셀 업로드시 기존에 있는 지출계산서를 삭제하고 insert하기 위함)-->
	<delete id="FAACAV061EdeleteExcel280204" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteExcel280204 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #coptCd#
			AND ACNT_CD        = #acntCd#
			AND	BLL_CD         = #bllCd#
			AND	PROF_DRTR_SRNO = #profDrtrSrno#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #ordpubSrno#
			AND	PROF_YM        = #profYm#
			AND ATT_CD = 'ATC280204'
	</delete>	
	
	<!--부표 5 삭제 (엑셀 업로드시 기존에 있는 지출계산서를 삭제하고 insert하기 위함)-->
	<delete id="FAACAV061EdeleteExcel280205" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/061/FAACAV061EdeleteExcel280205 */ ]]>
		DELETE FROM TWFAACAV009L
		WHERE COPT_CD          = #coptCd#
			AND ACNT_CD        = #acntCd#
			AND	BLL_CD         = #bllCd#
			AND	PROF_DRTR_SRNO = #profDrtrSrno#
			AND	DL_XPN_RCDB_PBSVT_SRNO    = #ordpubSrno#
			AND	PROF_YM        = #profYm#
			AND ATT_CD = 'ATC280205'
	</delete>	
				
</sqlMap>






