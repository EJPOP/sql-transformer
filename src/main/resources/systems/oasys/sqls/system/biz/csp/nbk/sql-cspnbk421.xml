<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="csp/nbk/421">
	
	<select id="CSPNBK421TotLendTracStatSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		SELECT	/* CSPNBK421TotLendTracStatSelect */
				COUNT(D1.MOUI_NO) AS TOT_CNT
				, NVL(SUM(D1.RPM_PRN), 0) AS TOT_RPM_PRN
				, NVL(SUM(D1.RPM_INT_AM), 0) AS TOT_RPM_INT_AM
				, MAX(D1.LAG_WDL_TRAC_HNDL_STA_CD) AS LAG_WDL_TRAC_HNDL_STA_CD
		FROM	TBCSPNBK206L D1
				, TBCSPNBK001M D2
				, TBDCMACM001M D3
		WHERE	D1.MOUI_NO = D2.MOUI_NO
		AND		D2.CNB = D3.CNB
		AND		D1.LEND_KND_CD = #lendKndCd#
		AND		D1.HNDL_YM = #hndlYm#
	]]>
		<isNotEmpty property="mouiNo" prepend="AND">
				D1.MOUI_NO = #mouiNo#
		</isNotEmpty>
		<isNotEmpty property="mouiNm" prepend="AND">
				D3.USR_NAM LIKE '%' || #mouiNm# || '%'
		</isNotEmpty>
		<isNotEmpty property="strRGR_YN">
			AND	D2.RGR_YN = #strRGR_YN#
		</isNotEmpty>
	</select>
	
	<select id="CSPNBK421LendTracListSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		SELECT	/* CSPNBK421LendTracListSelect */
				D1.MOUI_NO
				, D3.USR_NAM
				, D2.CNB
				, D3.DPT_CD
				, D4.DPT_NM
				, TO_CHAR(TO_DATE(D5.FNL_RPM_DT, 'YYYYMMDD'), 'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(D1.RPM_DT, 'YYYYMMDD'), 'YYYY-MM-DD') || ' ( ' || (TO_DATE(D1.RPM_DT, 'YYYYMMDD') - TO_DATE(D5.FNL_RPM_DT, 'YYYYMMDD')) || ' )' AS TERM_CALC_INT
				, D1.RPM_PRN
				, D1.RPM_INT_AM
				, D2.SAL_SEI_YN
				, D5.FNL_RPM_DT
				, D1.ARR_RPM_PRN_SUM_AM
				, D1.BK_RPM_PRN_SUM_AM
				, D1.EMN_RPM_PRN_SUM_AM
		FROM	TBCSPNBK206L D1
				, TBCSPNBK001M D2
				, TBDCMACM001M D3
				, TBDCMACM002M D4
				, TBCSPNBK202M D5
		WHERE	D1.MOUI_NO = D2.MOUI_NO
		AND		D2.CNB = D3.CNB
		AND		D3.DPT_CD = D4.DPT_CD
		AND		D1.LEND_KND_CD = D5.LEND_KND_CD
		AND		D1.MOUI_NO = D5.MOUI_NO
		AND		D1.LEND_KND_CD = #lendKndCd#
		AND		D1.HNDL_YM = #hndlYm#
		AND		D2.SCS_YN = 'N'
	]]>
		<isNotEmpty property="mouiNo" prepend="AND">
				D1.MOUI_NO = #mouiNo#
		</isNotEmpty>
		<isNotEmpty property="mouiNm" prepend="AND">
				D3.USR_NAM LIKE '%' || #mouiNm# || '%'
		</isNotEmpty>
		<isEqual property="detachGubun" compareValue="T" prepend="AND">
				D4.DPT_CD = '770770'
		</isEqual >	
		<isNotEmpty property="strRGR_YN">
			AND	D2.RGR_YN = #strRGR_YN#
		</isNotEmpty>
	<![CDATA[
		ORDER BY D1.MOUI_NO
	]]>
	</select>
	
	<select id="CSPNBK421LendTracListForExcelSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		SELECT	/* CSPNBK421LendTracListForExcelSelect */
				'1040000' AS DDCT_ORG_CD
				, D3.USR_NAM
				, D3.EIN
				, DECODE( D1.LEND_KND_CD, '1', 'B16', 'B15' ) AS DDCD_CD
				, 0 AS SLN
				, D1.HNDL_YM AS START_YM
				, 'AA' AS SAL_DVSN_CD
				, DECODE( D4.EMN_RPM_WAY_DVSN_CD, '1', D1.RPM_INT_AM, '2', D1.RPM_PRN + D1.RPM_INT_AM ) AS DDCT_AM
				, '' AS DDCT_YY_DVSN_CD
				, '' AS BNK_CD
				, '' AS ACNB
				, D1.HNDL_YM AS END_YM
				, '' AS RMK
				, '' AS UPD_USER_ID
				, '' AS UPD_DH
		FROM	TBCSPNBK206L D1
				, TBCSPNBK001M D2
				, TBDCMACM001M D3
				, TBCSPNBK202M D4
		WHERE	D1.MOUI_NO = D2.MOUI_NO
		AND		D2.CNB = D3.CNB
		AND		D1.LEND_KND_CD = D4.LEND_KND_CD
		AND		D1.MOUI_NO = D4.MOUI_NO
		AND		D1.LEND_KND_CD = #lendKndCd#
		AND		D1.HNDL_YM = #hndlYm#
		AND		D2.MOUI_DVSN_CD = '0'
		AND		D2.SCS_YN = 'N'
		AND		D4.EMN_RPM_WAY_DVSN_CD != '0'
	]]>
		<isNotEmpty property="strRGR_YN">
			AND	D2.RGR_YN = #strRGR_YN#
		</isNotEmpty>
	<![CDATA[
		ORDER BY USR_NAM
	]]>
	</select>
	
	<update id="CSPNBK421QLendTracHndlStatCdUpdate" parameterClass="paramMap">
	<![CDATA[
		UPDATE	/* CSPNBK421QLendTracHndlStatCdUpdate */ TBCSPNBK206L D1
		SET		D1.LAG_WDL_TRAC_HNDL_STA_CD = #lagWdlTracHndlStaCd#
				, D1.FNL_USR_ID = #usrId#
				, D1.FNL_DEAL_DPT_CD = #dptCd#
				, D1.FNL_MNU_ID = #mnuId#
				, D1.FNL_MDF_DH = SYSDATE
		WHERE	D1.LEND_KND_CD = #lendKndCd#
		AND		D1.HNDL_YM = #hndlYm#
		AND		D1.MOUI_NO IN 	(	SELECT	MOUI_NO
									FROM	TBCSPNBK001M
									WHERE	RGR_YN = #strRGR_YN#
								)
	]]>
	</update>
	
	<update id="CSPNBK421LendArrMouiUpdate" parameterClass="paramMap">
	<![CDATA[
		UPDATE	/* CSPNBK421LendArrMouiUpdate */ TBCSPNBK202M D1
		SET    	D1.EMN_RPM_WAY_DVSN_CD = ( CASE WHEN D1.LEND_KND_CD ='1' THEN  '2' ELSE '1' END )
				, D1.FNL_USR_ID = #usrId#
				, D1.FNL_DEAL_DPT_CD = #dptCd#
				, D1.FNL_MNU_ID = #mnuId#
				, D1.FNL_MDF_DH = SYSDATE
		WHERE  	D1.LEND_KND_CD = #lendKndCd#
		AND   	D1.MOUI_NO IN (
						SELECT 	D2.MOUI_NO 
						FROM 	TBCSPNBK203D D2, TBCSPNBK001M D3
		                WHERE  	D2.LEND_KND_CD = #lendKndCd#
		                AND    	D2.LEND_BL > 0
		                AND    	D2.CNL_YN = 'N'
		                AND    	D2.EXPR_DT < #tracHndlSchDt# 
		                AND		D2.MOUI_NO = D3.MOUI_NO
		                AND		D3.RGR_YN = #strRGR_YN#)
		AND    	D1.EMN_RPM_WAY_DVSN_CD = '0'
	]]>
	</update>
	
	<insert id="CSPNBK421LendTracInsert" parameterClass="paramMap">
	<![CDATA[
		INSERT INTO /* CSPNBK421LendTracInsert */ TBCSPNBK206L
		(
			LEND_KND_CD
			, HNDL_YM
			, MOUI_NO
			, RPM_PRN
			, RPM_DT
			, LAG_WDL_TRAC_HNDL_STA_CD
			, ARR_RPM_PRN_SUM_AM
			, BK_RPM_PRN_SUM_AM
			, EMN_RPM_PRN_SUM_AM
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			, FNL_MDF_DH
		)
		SELECT	D3.LEND_KND_CD
				, #hndlYm# AS HNDL_YM
				, D3.MOUI_NO
				, ( 
					(
						CASE
							WHEN D4.PRE_ARR_LEND_SUM_BL >= D3.ARR_RPM_PRN_SUM_AM 
							THEN D3.ARR_RPM_PRN_SUM_AM
							ELSE D4.PRE_ARR_LEND_SUM_BL
						END )
					+ (
						CASE
							WHEN D4.PRE_LEND_SUM_BL >= D3.BK_RPM_PRN_SUM_AM 
							THEN D3.BK_RPM_PRN_SUM_AM
							ELSE D4.PRE_LEND_SUM_BL
						END ) 
					+  EMN_RPM_PRN_SUM_AM
				) AS TOTAL_RPM_PRN
				, #tracHndlSchDt# AS RPM_DT
				, '0' AS LAG_WDL_TRAC_HNDL_STA_CD
				, (
					CASE
						WHEN D4.PRE_ARR_LEND_SUM_BL >= D3.ARR_RPM_PRN_SUM_AM 
						THEN D3.ARR_RPM_PRN_SUM_AM
						ELSE D4.PRE_ARR_LEND_SUM_BL
					END 
				) AS ARR_RPM_PRN_SUM_AM
				, (
					CASE
						WHEN D4.PRE_LEND_SUM_BL >= D3.BK_RPM_PRN_SUM_AM 
						THEN D3.BK_RPM_PRN_SUM_AM
						ELSE D4.PRE_LEND_SUM_BL
					END
				) AS BK_RPM_PRN_SUM_AM
				, D4.EMN_RPM_PRN_SUM_AM
				, #usrId# AS FRT_USR_ID
				, #usrId# AS FNL_USR_ID
				, #dptCd# AS FNL_DEAL_DPT_CD
				, #mnuId# AS FNL_MNU_ID
				, SYSDATE AS FRT_REGI_DH
				, SYSDATE AS FNL_MDF_DH
		FROM	(
					SELECT	D1.LEND_KND_CD
							, D1.MOUI_NO
							, D1.FNL_RPM_DT
							, D1.LEND_BL
							, D1.EMN_RPM_WAY_DVSN_CD
							, NVL(D1.ARR_RPM_PRN_SUM_AM, 0) AS ARR_RPM_PRN_SUM_AM
							, NVL(D1.BK_RPM_PRN_SUM_AM, 0 ) AS BK_RPM_PRN_SUM_AM
					FROM	TBCSPNBK202M D1
					WHERE	D1.LEND_KND_CD = #lendKndCd#
					AND		D1.LEND_BL > 0
					AND		( D1.EMN_RPM_WAY_DVSN_CD != '0'
							OR ( D1.EMN_RPM_WAY_DVSN_CD = '0' AND D1.FNL_RPM_DT < TO_CHAR(TO_DATE(#tracHndlSchDt#, 'YYYYMMDD')-100, 'YYYYMMDD' ) ) )
				) D3  
				, (  
					SELECT	D2.LEND_KND_CD
							, D2.MOUI_NO
							, NVL(SUM((CASE WHEN D2.LEND_DT < '20080201' AND D2.EXPR_DT <= #tracHndlSchDt# THEN D2.LEND_BL ELSE 0 END )), 0) AS PRE_ARR_LEND_SUM_BL 	
							, NVL(SUM((CASE WHEN D2.LEND_DT < '20080201' AND D2.EXPR_DT > #tracHndlSchDt# THEN D2.LEND_BL ELSE 0 END )), 0) AS PRE_LEND_SUM_BL 		
							, NVL(SUM((CASE WHEN D2.LEND_DT >= '20080201' THEN ( CASE WHEN D2.LEND_KND_CD = #lendKndCd# THEN ( CASE WHEN D2.LEND_BL >= D2.EMN_RPM_PRN THEN D2.EMN_RPM_PRN ELSE D2.LEND_BL END ) ELSE 0 END ) ELSE 0 END )), 0) AS EMN_RPM_PRN_SUM_AM
					FROM	TBCSPNBK203D D2
					WHERE	D2.LEND_KND_CD = #lendKndCd#
					AND		D2.LEND_BL > 0
					AND		D2.CNL_YN = 'N'
					GROUP BY D2.LEND_KND_CD, D2.MOUI_NO
				) D4
		WHERE	D3.LEND_KND_CD = D4.LEND_KND_CD(+)
		AND		D3.MOUI_NO = D4.MOUI_NO(+)
		AND		D3.MOUI_NO IN 	(	SELECT	MOUI_NO
									FROM	TBCSPNBK001M
									WHERE	RGR_YN = #strRGR_YN#
								)
		AND		( D4.PRE_ARR_LEND_SUM_BL > 0 OR D4.PRE_LEND_SUM_BL > 0 OR D4.EMN_RPM_PRN_SUM_AM > 0 )
	]]>
	</insert>
	
	<update id="CSPNBK421RpmIntAmUpdateByMouiNo" parameterClass="paramMap">
	<![CDATA[
		UPDATE	/*CSPNBK421RpmIntAmUpdateByMouiNo*/ TBCSPNBK206L D1
		SET		RPM_INT_AM = #rpmIntAm#
				, D1.FNL_USR_ID = #usrId#
				, D1.FNL_DEAL_DPT_CD = #dptCd#
				, D1.FNL_MNU_ID = #mnuId#
				, D1.FNL_MDF_DH = SYSDATE
		WHERE	D1.LEND_KND_CD = #lendKndCd#
		AND		D1.HNDL_YM = #hndlYm#
		AND		D1.MOUI_NO = #mouiNo#
	]]>
	</update>
	
	<delete id="CSPNBK421LendTracListDelete" parameterClass="paramMap">
	<![CDATA[
		DELETE	FROM /* CSPNBK421LendTracListDelete */ TBCSPNBK206L D1
		WHERE	D1.LEND_KND_CD = #lendKndCd#
		AND		D1.HNDL_YM = #hndlYm#
		AND		D1.MOUI_NO IN	(	SELECT	MOUI_NO
									FROM	TBCSPNBK001M
									WHERE	RGR_YN = #strRGR_YN#
								)
	]]>
	</delete>
	
	<select id="CSPNBK421QReportListSelect1" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		/*
		 * 대출금급여공제자 
		 * note : 1. 대출금입지원장에서 자료를 읽음(이체처리완료후에 자료작성가능)
		 *        2. 개인조합원만 대상 
		 *        3. 직위는 지금 현재 데이타가 부실해서 제외
		 */
		SELECT  A.MOUI_NO AS MOUI_NO,
		        NVL(C.USR_NAM, '') AS USR_NAM,
		        NVL(B.CNB, '') AS CNB,
		        D.DPT_NM AS DEPT_NM,
		        E.CD_NM AS CD_NM,
		        A.DEAL_PRN + A.LEND_BL AS JAN_AMOUNT,
		        A.BK_FNL_RPM_DT AS LN_LAST_REPAY_DATE,
		    	NVL(A.DEAL_PRN, 0) AS DEAL_PRN,
		     	NVL(A.INT_AM, 0) AS INT_AM,
		    	NVL(A.DEAL_PRN, 0)+ NVL(A.INT_AM, 0) AS GOJAE_AMOUNT,
		 		A.LEND_BL AS LN_REM_AMOUNT,
				A.LAG_WDL_RMK AS LAG_WDL_RMK
		FROM    TBCSPNBK205L A,
		        TBCSPNBK001M B,
		        TBDCMACM001M C,
		        TBDCMACM002M D,
		        TBDCMACM013C E
		WHERE   A.LEND_KND_CD =  #lendKndCd# 
		AND     A.LEND_DEAL_DVSN_CD =  '1'
		AND     A.CNL_YN = 'N'
		AND     SUBSTR(A.LEND_DEAL_DT,0,6) = #hndlYm#
		AND     A.MOUI_NO = B.MOUI_NO
		AND     B.CNB = C.CNB
		AND     C.DPT_CD = D.DPT_CD
		AND     E.CMM_CD_DVSN_CD = '1000173'
		AND     E.CD = C.RANK_CD
	]]>
	</select>
	
	<select id="CSPNBK421QReportListSelect2" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		SELECT  COUNT(MOUI_NO) AS MOUI_NO_CNT,
		        SUM(DEAL_PRN + LEND_BL) AS JAN_AMOUNT,
		        '' AS LN_LAST_REPAY_DATE,
		        SUM(DEAL_PRN) AS DEAL_PRN,
		        SUM(INT_AM)  AS INT_AM,
		        SUM(DEAL_PRN+INT_AM) AS DDCT_AMT,
		        SUM(LEND_BL)  AS LEND_BL,
		        '' AS REMARK
		FROM    TBCSPNBK205L
		WHERE   LEND_KND_CD =  #lendKndCd# 
		AND     LEND_DEAL_DVSN_CD =  '1'
		AND     CNL_YN = 'N'
		AND     SUBSTR(LEND_DEAL_DT,0,6) = #hndlYm#
	]]>
	</select>
	
	<select id="CSPNBK421TracHistYYSelect" resultClass="resultMap">
	<![CDATA[
		SELECT	/* CSPNBK421TracHistYYSelect */
				DISTINCT SUBSTR(D1.HNDL_YM, 1, 4) AS HNDL_YY
		FROM	TBCSPNBK206L D1
		UNION
		SELECT	TO_CHAR(SYSDATE, 'YYYY') AS HNDL_YY
		FROM	dual
		ORDER BY HNDL_YY DESC
	]]>
	</select>
	
	<select id="CSPNBK421LendRpmPrnDiffCntSelect" parameterClass="paramMap" resultClass="int">
	<![CDATA[
		SELECT	/* CSPNBK421LendRpmPrnDiffCntSelect */
				COUNT(D1.MOUI_NO) AS CNT
		FROM	TBCSPNBK206L D1, TBCSPNBK001M D5
				, (
					SELECT	D3.LEND_KND_CD
							, #hndlYm# AS HNDL_YM
							, D3.MOUI_NO
							, ( 
								(
									CASE /* 20080201 이전 대출 연체잔액 >= 연체상환원금합계금액 */ 
										WHEN D4.PRE_ARR_LEND_SUM_BL >= D3.ARR_RPM_PRN_SUM_AM 
										THEN D3.ARR_RPM_PRN_SUM_AM /* 연체상환원금합계금액 */
										ELSE D4.PRE_ARR_LEND_SUM_BL /* 20080201 이전 대출 연체잔액 */
									END )
								+ (
									CASE /* 20080201 이전 대출잔액 >= 이전상환원금합계금액 */
										WHEN D4.PRE_LEND_SUM_BL >= D3.BK_RPM_PRN_SUM_AM
										THEN D3.BK_RPM_PRN_SUM_AM /* 이전상환원금합계금액 */
										ELSE D4.PRE_LEND_SUM_BL /* 20080201 이전 대출잔액 */
									END ) 
								+  EMN_RPM_PRN_SUM_AM /* 20080201 이후 월상환액 */
							) AS TOTAL_RPM_PRN /* 상환액 */
							, '' AS RPM_DT
							, '0' AS LAG_WDL_TRAC_HNDL_STA_CD
							, (
								CASE /* 20080201 이전 대출 연체잔액 >= 연체상환원금합계금액 */ 
									WHEN D4.PRE_ARR_LEND_SUM_BL >= D3.ARR_RPM_PRN_SUM_AM 
									THEN D3.ARR_RPM_PRN_SUM_AM /* 연체상환원금합계금액 */
									ELSE D4.PRE_ARR_LEND_SUM_BL /* 20080201 이전 대출 연체잔액 */
								END 
							) AS ARR_RPM_PRN_SUM_AM
							, (
								CASE /* 20080201 이전 대출잔액 >= 이전상환원금합계금액 */
									WHEN D4.PRE_LEND_SUM_BL >= D3.BK_RPM_PRN_SUM_AM 
									THEN D3.BK_RPM_PRN_SUM_AM /* 이전상환원금합계금액 */
									ELSE D4.PRE_LEND_SUM_BL /* 20080201 이전 대출잔액 */
								END
							) AS BK_RPM_PRN_SUM_AM
							, D4.EMN_RPM_PRN_SUM_AM
					FROM	(
								SELECT	D1.LEND_KND_CD
										, D1.MOUI_NO
										, D1.FNL_RPM_DT
										, D1.LEND_BL
										, D1.EMN_RPM_WAY_DVSN_CD
										, NVL(D1.ARR_RPM_PRN_SUM_AM, 0) AS ARR_RPM_PRN_SUM_AM
										, NVL(D1.BK_RPM_PRN_SUM_AM, 0 ) AS BK_RPM_PRN_SUM_AM
								FROM	TBCSPNBK202M D1
								WHERE	D1.LEND_KND_CD = #lendKndCd#
								AND		D1.LEND_BL > 0
								AND		( D1.EMN_RPM_WAY_DVSN_CD != '0'
										OR ( D1.EMN_RPM_WAY_DVSN_CD = '0' AND D1.FNL_RPM_DT < TO_CHAR(TO_DATE(#tracHndlSchDt#, 'YYYYMMDD')-100, 'YYYYMMDD' ) ) )
							) D3  
							, (  
								SELECT	D2.LEND_KND_CD
										, D2.MOUI_NO
										, NVL(SUM((CASE WHEN D2.LEND_DT < '20080201' AND D2.EXPR_DT <= #tracHndlSchDt# THEN D2.LEND_BL ELSE 0 END )), 0) AS PRE_ARR_LEND_SUM_BL 	/* 20080201 이전 대출 연체잔액 */
										, NVL(SUM((CASE WHEN D2.LEND_DT < '20080201' AND D2.EXPR_DT > #tracHndlSchDt# THEN D2.LEND_BL ELSE 0 END )), 0) AS PRE_LEND_SUM_BL 		/* 20080201 이전 대출잔액 */
										, NVL(SUM((CASE WHEN D2.LEND_DT >= '20080201' THEN ( CASE WHEN D2.LEND_KND_CD = '1' THEN ( CASE WHEN D2.LEND_BL >= D2.EMN_RPM_PRN THEN D2.EMN_RPM_PRN ELSE D2.LEND_BL END ) ELSE 0 END ) ELSE 0 END )), 0) AS EMN_RPM_PRN_SUM_AM /* 20080201 이후 월상환액 */
								FROM	TBCSPNBK203D D2
								WHERE	D2.LEND_KND_CD = #lendKndCd#
								AND		D2.LEND_BL > 0
								AND		D2.CNL_YN = 'N'
								GROUP BY D2.LEND_KND_CD, D2.MOUI_NO
							) D4
					WHERE	D3.LEND_KND_CD = D4.LEND_KND_CD(+)
					AND		D3.MOUI_NO = D4.MOUI_NO(+)
					AND		( D4.PRE_ARR_LEND_SUM_BL > 0 OR D4.PRE_LEND_SUM_BL > 0 OR D4.EMN_RPM_PRN_SUM_AM > 0 )
				) D2
		WHERE	D2.LEND_KND_CD = D1.LEND_KND_CD(+)
		AND		D2.HNDL_YM = D1.HNDL_YM(+)
		AND		D2.MOUI_NO = D1.MOUI_NO(+)
		AND		D1.RPM_PRN != D2.TOTAL_RPM_PRN
		AND		D1.MOUI_NO = D5.MOUI_NO
		
	]]>
		<isNotEmpty property="strRGR_YN">
			AND	D5.RGR_YN = #strRGR_YN#
		</isNotEmpty>
	</select>
	
	<select id="CSPNBK421LendStopToDayCheckSelect" parameterClass="paramMap" resultClass="String">
	<![CDATA[
		SELECT	/* CSPNBK421LendStopToDayCheckSelect */
				DISTINCT DECODE(D1.LAG_WDL_TRAC_HNDL_STA_CD, '1', 'Y', 'N') AS STOP_STAT
		FROM	TBCSPNBK206L D1
		WHERE	D1.LEND_KND_CD = #lendKndCd#
		AND		D1.MOUI_NO = #mouiNo#
		AND		D1.HNDL_YM = TO_CHAR(SYSDATE, 'YYYYMM')
	]]>
	</select>
</sqlMap>