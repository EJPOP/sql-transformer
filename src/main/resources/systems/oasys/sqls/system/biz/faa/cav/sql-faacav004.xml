<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/004">
	
	<select id="FAACAV004EMainSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/004/FAACAV004EMainSelect */ ]]>
		<include refid="include.pageSelct" />	
		<isNotEmpty property="strOrgNm">
		    SELECT  A.KEY,
		            A.PROF_DRTR_SG,
		            A.ORG_NM,
		            A.PERIOD,
		            A.MN_1_STA_CD,
		            A.MN_2_STA_CD,
		            A.MN_3_STA_CD,
		            A.MN_4_STA_CD,
		            A.MN_5_STA_CD,
		            A.MN_6_STA_CD,
		            A.MN_7_STA_CD,
		            A.MN_8_STA_CD,
		            A.MN_9_STA_CD,
		            A.MN_1_0_STA_CD,
		            A.MN_1_1_STA_CD,
		            A.MN_1_2_STA_CD,
		            A.MN_1_3_STA_CD,
		            A.COPT_NM,
		            A.ACNT_NM,
		            A.BLL_NM,
		            A.CRE_DT,
		            A.ABLT_DT,
		            A.PST_NM,
		            A.MDF_PEN_NM,
		            A.TNB,
		            A.AD
		    FROM    (
		            SELECT  ROWNUM AS KEY, 
		                    MSTR.COPT_CD||'-'||MSTR.ACNT_CD||'-'||MSTR.BLL_CD||'-'||MSTR.PROF_DRTR_SRNO||'-'||MSTR.DL_XPN_RCDB_PBSVT_SRNO PROF_DRTR_SG,
		                    MN.ORG_NM,
		                    CD.RMK_2 AS PERIOD,
		                    MSTR.MN_1_STA_CD,
		                    MSTR.MN_2_STA_CD,
		                    MSTR.MN_3_STA_CD,
		                    MSTR.MN_4_STA_CD,
		                    MSTR.MN_5_STA_CD,
		                    MSTR.MN_6_STA_CD,
		                    MSTR.MN_7_STA_CD,
		                    MSTR.MN_8_STA_CD,
		                    MSTR.MN_9_STA_CD,
		                    MSTR.MN_1_0_STA_CD,
		                    MSTR.MN_1_1_STA_CD,
		                    MSTR.MN_1_2_STA_CD,
		                    MSTR.MN_1_3_STA_CD,
		                    F_AV_BLL_COPT_CD_NM(MSTR.COPT_CD) COPT_NM,/*소관명*/
		                    F_AV_ACNT_CD_NM(MSTR.ACNT_CD) ACNT_NM, /*회계명*/
		                    F_AV_BLL_CD_NM(MSTR.BLL_CD, MSTR.DL_XPN_RCDB_PBSVT_SRNO) AS BLL_NM,	/*계산서명*/
		                    MN.CRE_DT, /*신설일*/
		                    MN.ABLT_DT, /*폐지일*/
		                    MN.PST_NM, /*담당자직위*/
		                    MN.MDF_PEN_NM , /*담당자*/
		                    MN.TNB , /*전화번호*/
		                    MN.AD /*주소*/
		            FROM    TWFAACAV007M MSTR , TWFAACAV003M MN, TWFAACAV024C CD
		            WHERE   1=1
		            AND     MSTR.COPT_CD = MN.COPT_CD
		            AND     MSTR.ACNT_CD = MN.ACNT_CD
		            AND     MSTR.BLL_CD  = MN.BLL_CD
		            AND     MSTR.PROF_DRTR_SRNO = MN.PROF_DRTR_SRNO
		            AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = MN.DL_XPN_RCDB_PBSVT_SRNO
		            AND     MSTR.PROF_YR = #strYr#
		            AND     CD.ACNT_DVSN_CD = '30'
		            AND     NVL(MN.ABLT_DT, '999999') &gt;= #strYm#
		            AND     CD.ACNT_CD = MSTR.BLL_CD || CASE WHEN MSTR.DL_XPN_RCDB_PBSVT_SRNO= '000' THEN '000' WHEN MSTR.DL_XPN_RCDB_PBSVT_SRNO!= '000' THEN 'XXX' END
		            AND     MN.MDF_DVSN_CD NOT IN 'D'
		            AND     MN.ORG_CD = #strOrg1#||#strOrg2#||#strOrg3#||#strOrg4#
					) A
		</isNotEmpty>
		
		<isEmpty property="strOrgNm">
		    SELECT  A.KEY,
		            A.PROF_DRTR_SG,
		            A.ORG_NM,
		            A.PERIOD,
		            A.MN_1_STA_CD,
		            A.MN_2_STA_CD,
		            A.MN_3_STA_CD,
		            A.MN_4_STA_CD,
		            A.MN_5_STA_CD,
		            A.MN_6_STA_CD,
		            A.MN_7_STA_CD,
		            A.MN_8_STA_CD,
		            A.MN_9_STA_CD,
		            A.MN_1_0_STA_CD,
		            A.MN_1_1_STA_CD,
		            A.MN_1_2_STA_CD,
		            A.MN_1_3_STA_CD,
		            A.COPT_NM,
		            A.ACNT_NM,
		            A.BLL_NM,
		            A.CRE_DT,
		            A.ABLT_DT,
		            A.PST_NM,
		            A.MDF_PEN_NM,
		            A.TNB,
		            A.AD
		    FROM    (
		            SELECT  ROWNUM AS KEY, 
		                    MSTR.COPT_CD||'-'||MSTR.ACNT_CD||'-'||MSTR.BLL_CD||'-'||MSTR.PROF_DRTR_SRNO||'-'||MSTR.DL_XPN_RCDB_PBSVT_SRNO PROF_DRTR_SG,
		                    MN.ORG_NM,
		                    MN.PERIOD,
		                    MSTR.MN_1_STA_CD,
		                    MSTR.MN_2_STA_CD,
		                    MSTR.MN_3_STA_CD,
		                    MSTR.MN_4_STA_CD,
		                    MSTR.MN_5_STA_CD,
		                    MSTR.MN_6_STA_CD,
		                    MSTR.MN_7_STA_CD,
		                    MSTR.MN_8_STA_CD,
		                    MSTR.MN_9_STA_CD,
		                    MSTR.MN_1_0_STA_CD,
		                    MSTR.MN_1_1_STA_CD,
		                    MSTR.MN_1_2_STA_CD,
		                    MSTR.MN_1_3_STA_CD,
		                    MN.COPT_NM,/*소관명*/
		                    MN.ACNT_NM, /*회계명*/
		                    MN.BLL_NM, /*계산서명*/
		                    MN.CRE_DT, /*신설일*/
		                    MN.ABLT_DT, /*폐지일*/
		                    MN.PST_NM, /*담당자 직위*/
		                    MN.MDF_PEN_NM , /*담당자*/
		                    MN.TNB , /*전화번호*/
		                    MN.AD /*주소*/
		            FROM    TWFAACAV007M MSTR,
		                    (SELECT CC.COPT_CD,
		                            CC.ACNT_CD,
		                            CC.BLL_CD,
		                            CC.PROF_DRTR_SRNO,
		                            CC.DL_XPN_RCDB_PBSVT_SRNO,
		                            CC.ORG_CD,
		                            BB.PERIOD,
		                            CC.ORG_NM,
		                            BB.COPT_NM,/*소관명*/
		                            BB.ACNT_NM, /*회계명*/
		                            BB.BLL_NM,
		                            CC.CRE_DT, /*신설일*/
		                            CC.ABLT_DT, /*폐지일*/
		                            CC.PST_NM, /*담당자 직위*/
		                            CC.MDF_PEN_NM , /*담당자*/
		                            CC.TNB , /*전화번호*/
		                            CC.AD /*주소*/
		                    FROM    TWFAACAV003M CC,
		                            (SELECT A.COPT_CD,
		                                    A.ACNT_CD, 
		                                    A.BLL_CD, 
		                                    A.PROF_DRTR_SRNO, 
		                                    A.DL_XPN_RCDB_PBSVT_SRNO,
		                                    CASE B.RMK_2 WHEN '월'   THEN #strYm#
		                                                 WHEN '분기' THEN  CASE WHEN #strMm# = '01' THEN #strYr#||'01'
		                                                                        WHEN #strMm# = '02' THEN #strYr#||'04'
		                                                                        WHEN #strMm# = '03' THEN #strYr#||'07'
		                                                                        WHEN #strMm# = '04' THEN #strYr#||'10'
		                                                                   END
		                                                 WHEN '연'  THEN #strYr#||'00'
		                                    END AS ABLT_DT_PROF_YM,
		                                    CASE B.RMK_2 WHEN '월'  THEN #strYm#
		                                                 WHEN '분기' THEN  CASE WHEN #strMm# = '01' THEN #strYr#||'03'
		                                                                        WHEN #strMm# = '02' THEN #strYr#||'06'
		                                                                        WHEN #strMm# = '03' THEN #strYr#||'09'
		                                                                        WHEN #strMm# = '04' THEN #strYr#||'13'
		                                                                   END
		                                                 WHEN '연'  THEN #strYr#||'13'
		                                    END AS CRE_DT_PROF_YM,
		                                    B.RMK_2 AS PERIOD,
		                                    C.ACNT_CD_NM AS COPT_NM,
		                                    D.ACNT_CD_NM AS ACNT_NM,
		                                    B.ACNT_CD_NM AS BLL_NM
		                            FROM    TWFAACAV003M A,
		                                    TWFAACAV024C B,
		                                    TWFAACAV024C C,
		                                    TWFAACAV024C D
		                            WHERE   1=1
		                            AND     A.MDF_DVSN_CD NOT IN ('D')
		                            AND     B.ACNT_DVSN_CD = '30'
		                            AND     B.ACNT_CD = A.BLL_CD || CASE WHEN A.DL_XPN_RCDB_PBSVT_SRNO= '000' THEN '000' WHEN A.DL_XPN_RCDB_PBSVT_SRNO!= '000' THEN 'XXX' END
		                            AND 	C.ACNT_DVSN_CD = '02'
		                            AND 	C.ACNT_CD = A.COPT_CD
		                            AND 	D.ACNT_DVSN_CD = '01'
		                            AND 	D.ACNT_CD = A.ACNT_CD
		                        <!--기관코드-->
		                        <isNotEmpty property="strOrg1">
		                            AND     SUBSTR(A.ORG_CD,1,3) = #strOrg1#
		                        </isNotEmpty>
		                        <isNotEmpty property="strOrg2">
		                            AND     SUBSTR(A.ORG_CD,4,3) = #strOrg2#
		                        </isNotEmpty>
		                        <isNotEmpty property="strOrg3">
		                            AND     SUBSTR(A.ORG_CD,7,3) = #strOrg3#
		                        </isNotEmpty>
		                        <isNotEmpty property="strOrg4">
		                            AND     SUBSTR(A.ORG_CD,10,3) = #strOrg4#
		                        </isNotEmpty>
		                        
		                        <!--소관코드-->
		                        <isNotEmpty property="strCoptCd">
		                            AND A.COPT_CD = #strCoptCd#
		                        </isNotEmpty>
		                        <!--회계코드-->
		                        <isNotEmpty property="strAcntCd">
		                            AND A.ACNT_CD = #strAcntCd#
		                        </isNotEmpty>
		                        <!--계산서코드 입력 시 START-->
		                        <isNotEmpty property="strBllCd">
		                            <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
		                                <isEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
		                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = '000'
		                                    <isEqual property="strBllCd" compareValue="17">
		                                        AND     A.BLL_CD IN ('17','18')
		                                    </isEqual>
		                                    <isEqual property="strBllCd" compareValue="22">
		                                        AND     A.BLL_CD IN ('22','23','24')
		                                    </isEqual>
		                                    <isEqual property="strBllCd" compareValue="42">
		                                        AND     A.BLL_CD IN ('42','43')
		                                    </isEqual>
		                                    <isNotEmpty property="strBllCd">
		                                        AND     A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_CD 
		                                                                ELSE #strBllCd#
		                                                           END
		                                    </isNotEmpty>
		                                </isEqual>
		                                
		                                <isNotEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
		                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		                                    <isEqual property="strBllCd" compareValue="17">
		                                        AND     A.BLL_CD IN ('17','18')
		                                    </isEqual>
		                                    <isEqual property="strBllCd" compareValue="22">
		                                        AND     A.BLL_CD IN ('22','23','24')
		                                    </isEqual>
		                                    <isNotEmpty property="strBllCd">
		                                        AND     A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN A.BLL_CD 
		                                                                ELSE #strBllCd#
		                                                           END
		                                    </isNotEmpty>
		                                </isNotEqual>
		                            </isNotEmpty>
		
		                            <isEmpty property="strDlXpnRcdbPbsvtSrno">
		                                <isEqual property="strFildSsecYn" compareValue="N">
		                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = '000'
		                                    <isEqual property="strBllCd" compareValue="17">
		                                        AND     A.BLL_CD IN ('17','18')
		                                    </isEqual>
		                                    <isEqual property="strBllCd" compareValue="22">
		                                        AND     A.BLL_CD IN ('22','23','24')
		                                    </isEqual>
		                                    <isEqual property="strBllCd" compareValue="42">
		                                        AND     A.BLL_CD IN ('42','43')
		                                    </isEqual>
		                                    <isNotEmpty property="strBllCd">
		                                        AND     A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_CD 
		                                                                ELSE #strBllCd#
		                                                           END
		                                    </isNotEmpty>
		                                </isEqual>
		                                <isEqual property="strFildSsecYn" compareValue="Y">
		                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
		                                    <isEqual property="strBllCd" compareValue="17">
		                                    AND     A.BLL_CD IN ('17','18')
		                                    </isEqual>
		                                    <isEqual property="strBllCd" compareValue="22">
		                                    AND     A.BLL_CD IN ('22','23','24')
		                                    </isEqual>
		                                    <isNotEmpty property="strBllCd">
		                                    AND     A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN A.BLL_CD 
		                                                            ELSE #strBllCd#
		                                                       END
		                                    </isNotEmpty>
		                                </isEqual>
		                            </isEmpty>
		                        </isNotEmpty>
		                        <!--계산서코드 입력 시 END-->
		                        
		                        <!--계산서코드 미입력-->
		                        <isEmpty property="strBllCd">
		                            <isEqual property="strFildSsecYn" compareValue="N">
		                                <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
		                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		                                </isNotEmpty>
		                            </isEqual>
		                            <isEqual property="strFildSsecYn" compareValue="Y">
		                                <isNotEmpty property="strDlXpnRcdbPbsvtSrno">	
		                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		                                </isNotEmpty>
		                                <isEmpty property="strDlXpnRcdbPbsvtSrno">	
		                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
		                                </isEmpty>
		                            </isEqual>
		                        </isEmpty>
		                        <!--증명책임자 일련번호-->
		                        <isNotEmpty property="strProfDrtrSrno">
		                            AND     A.PROF_DRTR_SRNO = #strProfDrtrSrno#
		                        </isNotEmpty>
		                        <isEqual property="strPeriod" compareValue="M">
		                            AND     (A.BLL_CD IN ('17','18','19','25') OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'))
		                        </isEqual>
		                        <isEqual property="strPeriod" compareValue="Q">
		                            AND     A.BLL_CD IN ('11','12','13','15','16','20','21','22','23','24','29','41','42')
		                            AND     A.DL_XPN_RCDB_PBSVT_SRNO = '000'
		                        </isEqual>
		                        <isEqual property="strPeriod" compareValue="Y">
		                            AND     A.BLL_CD IN ('14','28','30','31','32','33','34','35','55')
		                            AND     A.DL_XPN_RCDB_PBSVT_SRNO = '000'
		                        </isEqual>
		                            ) BB
		                    WHERE   BB.COPT_CD = CC.COPT_CD
		                    AND     BB.ACNT_CD = CC.ACNT_CD
		                    AND     BB.BLL_CD  = CC.BLL_CD
		                    AND     BB.PROF_DRTR_SRNO = CC.PROF_DRTR_SRNO
		                    AND     BB.DL_XPN_RCDB_PBSVT_SRNO = CC.DL_XPN_RCDB_PBSVT_SRNO
		                    AND     NVL(CC.ABLT_DT,'999999') <![CDATA[ >= ]]> BB.ABLT_DT_PROF_YM
		                    AND		CC.CRE_DT <![CDATA[ <= ]]> BB.CRE_DT_PROF_YM
		                    ) MN
		            WHERE   1=1
		            AND     MSTR.COPT_CD = MN.COPT_CD
		            AND     MSTR.ACNT_CD = MN.ACNT_CD
		            AND     MSTR.BLL_CD  = MN.BLL_CD
		            AND     MSTR.PROF_DRTR_SRNO = MN.PROF_DRTR_SRNO
		            AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = MN.DL_XPN_RCDB_PBSVT_SRNO
		            AND     MSTR.PROF_YR = #strYr#                    
		        <!--기관코드-->
		        <isNotEmpty property="strOrg1">
		            AND     SUBSTR(MN.ORG_CD,1,3) = #strOrg1#
		        </isNotEmpty>
		        <isNotEmpty property="strOrg2">
		            AND     SUBSTR(MN.ORG_CD,4,3) = #strOrg2#
		        </isNotEmpty>
		        <isNotEmpty property="strOrg3">
		            AND     SUBSTR(MN.ORG_CD,7,3) = #strOrg3#
		        </isNotEmpty>
		        <isNotEmpty property="strOrg4">
		            AND     SUBSTR(MN.ORG_CD,10,3) = #strOrg4#
		        </isNotEmpty>
		        
		        <!--소관코드-->
		        <isNotEmpty property="strCoptCd">
		            AND MSTR.COPT_CD = #strCoptCd#
		        </isNotEmpty>
		        <!--회계코드-->
		        <isNotEmpty property="strAcntCd">
		            AND MSTR.ACNT_CD = #strAcntCd#
		        </isNotEmpty>
		        <!--계산서코드 입력 시 START-->
		        <isNotEmpty property="strBllCd">
		            <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
		                <isEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
		                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
		                    <isEqual property="strBllCd" compareValue="17">
		                        AND     MSTR.BLL_CD IN ('17','18')
		                    </isEqual>
		                    <isEqual property="strBllCd" compareValue="22">
		                        AND     MSTR.BLL_CD IN ('22','23','24')
		                    </isEqual>
		                    <isEqual property="strBllCd" compareValue="42">
		                        AND     MSTR.BLL_CD IN ('42','43')
		                    </isEqual>
		                    <isNotEmpty property="strBllCd">
		                        AND     MSTR.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN MSTR.BLL_CD 
		                                                ELSE #strBllCd#
		                                           END
		                    </isNotEmpty>
		                </isEqual>
		                
		                <isNotEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
		                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		                    <isEqual property="strBllCd" compareValue="17">
		                        AND     MSTR.BLL_CD IN ('17','18')
		                    </isEqual>
		                    <isEqual property="strBllCd" compareValue="22">
		                        AND     MSTR.BLL_CD IN ('22','23','24')
		                    </isEqual>
		                    <isNotEmpty property="strBllCd">
		                        AND     MSTR.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN MSTR.BLL_CD 
		                                                ELSE #strBllCd#
		                                           END
		                    </isNotEmpty>
		                </isNotEqual>
		            </isNotEmpty>
		
		            <isEmpty property="strDlXpnRcdbPbsvtSrno">
		                <isEqual property="strFildSsecYn" compareValue="N">
		                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
		                    <isEqual property="strBllCd" compareValue="17">
		                        AND     MSTR.BLL_CD IN ('17','18')
		                    </isEqual>
		                    <isEqual property="strBllCd" compareValue="22">
		                        AND     MSTR.BLL_CD IN ('22','23','24')
		                    </isEqual>
		                    <isEqual property="strBllCd" compareValue="42">
		                        AND     MSTR.BLL_CD IN ('42','43')
		                    </isEqual>
		                    <isNotEmpty property="strBllCd">
		                        AND     MSTR.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN MSTR.BLL_CD 
		                                                ELSE #strBllCd#
		                                           END
		                    </isNotEmpty>
		                </isEqual>
		                <isEqual property="strFildSsecYn" compareValue="Y">
		                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
		                    <isEqual property="strBllCd" compareValue="17">
		                    AND     MSTR.BLL_CD IN ('17','18')
		                    </isEqual>
		                    <isEqual property="strBllCd" compareValue="22">
		                    AND     MSTR.BLL_CD IN ('22','23','24')
		                    </isEqual>
		                    <isNotEmpty property="strBllCd">
		                    AND     MSTR.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN MSTR.BLL_CD 
		                                            ELSE #strBllCd#
		                                       END
		                    </isNotEmpty>
		                </isEqual>
		            </isEmpty>
		        </isNotEmpty>
		        <!--계산서코드 입력 시 END-->
		        
		        <!--계산서코드 미입력-->
		        <isEmpty property="strBllCd">
		            <isEqual property="strFildSsecYn" compareValue="N">
		                <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
		                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		                </isNotEmpty>
		            </isEqual>
		            <isEqual property="strFildSsecYn" compareValue="Y">
		                <isNotEmpty property="strDlXpnRcdbPbsvtSrno">	
		                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		                </isNotEmpty>
		                <isEmpty property="strDlXpnRcdbPbsvtSrno">	
		                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
		                </isEmpty>
		            </isEqual>
		        </isEmpty>
		        <!--증명책임자 일련번호-->
		        <isNotEmpty property="strProfDrtrSrno">
		            AND     MSTR.PROF_DRTR_SRNO = #strProfDrtrSrno#
		        </isNotEmpty>
		        <isEqual property="strPeriod" compareValue="M">
		            AND     (MSTR.BLL_CD IN ('17','18','19','25') OR (MSTR.BLL_CD IN ('22','23','24') AND MSTR.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'))
		        </isEqual>
		        <isEqual property="strPeriod" compareValue="Q">
		            AND     MSTR.BLL_CD IN ('11','12','13','15','16','20','21','22','23','24','29','41','42')
		            AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
		        </isEqual>
		        <isEqual property="strPeriod" compareValue="Y">
		            AND     MSTR.BLL_CD IN ('14','28','30','31','32','33','34','35','55')
		            AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
		        </isEqual>
		            ) A
		    WHERE	1=1
		    <!--접수-->
		    <isEqual property="strRecvYn" compareValue="Y">
		        <isEqual property="strMm" compareValue="00">
		            AND     A.MN_1_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="01">
		            AND     A.MN_1_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="02">
		            AND     A.MN_2_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="03">
		            AND     A.MN_3_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="04">
		            AND     A.MN_4_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="05">
		            AND     A.MN_5_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="06">
		            AND     A.MN_6_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="07">
		            AND     A.MN_7_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="08">
		            AND     A.MN_8_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="09">
		            AND     A.MN_9_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="10">
		            AND     A.MN_1_0_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="11">
		            AND     A.MN_1_1_STA_CD IN('E','W','D','P')
		        </isEqual>
		        <isEqual property="strMm" compareValue="12">
		            AND     A.MN_1_2_STA_CD IN('E','W','D','P')
		        </isEqual>	
		        <isEqual property="strMm" compareValue="13">
		            AND     A.MN_1_3_STA_CD IN('E','W','D','P')
		        </isEqual>
		    </isEqual>
			
		    <!--미접수-->
		    <isEqual property="strRecvYn" compareValue="N">
		        <isGreaterEqual property="strMm" compareValue="00">
		            AND     A.MN_1_STA_CD IS NULL
		            <isGreaterEqual property="strMm" compareValue="01" prepend="OR">
		            A.MN_1_STA_CD IS NULL
		                <isGreaterEqual property="strMm" compareValue="02" prepend="OR">
		                A.MN_2_STA_CD IS NULL
		                    <isGreaterEqual property="strMm" compareValue="03" prepend="OR">
		                    A.MN_3_STA_CD IS NULL
		                        <isGreaterEqual property="strMm" compareValue="04" prepend="OR">
		                        A.MN_4_STA_CD IS NULL
		                            <isGreaterEqual property="strMm" compareValue="05" prepend="OR">
		                            A.MN_5_STA_CD IS NULL
		                                <isGreaterEqual property="strMm" compareValue="06" prepend="OR">
		                                A.MN_6_STA_CD IS NULL
		                                    <isGreaterEqual property="strMm" compareValue="07" prepend="OR">
		                                    A.MN_7_STA_CD IS NULL
		                                        <isGreaterEqual property="strMm" compareValue="08" prepend="OR">
		                                        A.MN_8_STA_CD IS NULL
		                                            <isGreaterEqual property="strMm" compareValue="09" prepend="OR">
		                                            A.MN_9_STA_CD IS NULL
		                                                <isGreaterEqual property="strMm" compareValue="10" prepend="OR">
		                                                A.MN_1_0_STA_CD IS NULL
		                                                    <isGreaterEqual property="strMm" compareValue="11" prepend="OR">
		                                                    A.MN_1_1_STA_CD IS NULL
		                                                        <isGreaterEqual property="strMm" compareValue="12" prepend="OR">
		                                                        A.MN_1_2_STA_CD IS NULL
		                                                            <isGreaterEqual property="strMm" compareValue="13" prepend="OR">
		                                                            A.MN_1_3_STA_CD IS NULL
		                                                            </isGreaterEqual>
		                                                        </isGreaterEqual>
		                                                    </isGreaterEqual>
		                                                </isGreaterEqual>
		                                            </isGreaterEqual>
		                                        </isGreaterEqual>
		                                    </isGreaterEqual>
		                                </isGreaterEqual>
		                            </isGreaterEqual>
		                        </isGreaterEqual>
		                    </isGreaterEqual>
		                </isGreaterEqual>
		            </isGreaterEqual>
		        </isGreaterEqual>
		    </isEqual>
		    <!--전체-->
		    <isEqual property="strRecvYn" compareValue="A">
		        <!--연간분-->
		        <isEqual property="yearChk" compareValue="Y">
		            AND     (A.MN_1_STA_CD &lt;&gt; '*' OR A.MN_1_STA_CD IS NULL)
		        </isEqual>
		        <!--월, 분기분 -->
		        <isEqual property="yearChk" compareValue="N">
		            <isGreaterEqual property="strMm" compareValue="00">
		            AND  (A.MN_1_STA_CD &lt;&gt; '*' OR A.MN_1_STA_CD IS NULL)
		                <isGreaterEqual property="strMm" compareValue="01" prepend="OR">
		                (A.MN_1_STA_CD &lt;&gt; '*' OR A.MN_1_STA_CD IS NULL)
		                    <isGreaterEqual property="strMm" compareValue="02" prepend="OR">
		                    (A.MN_2_STA_CD &lt;&gt; '*' OR A.MN_2_STA_CD IS NULL)
		                        <isGreaterEqual property="strMm" compareValue="03" prepend="OR">
		                        (A.MN_3_STA_CD &lt;&gt; '*' OR A.MN_3_STA_CD IS NULL)
		                            <isGreaterEqual property="strMm" compareValue="04" prepend="OR">
		                            (A.MN_4_STA_CD &lt;&gt; '*' OR A.MN_4_STA_CD IS NULL)
		                                <isGreaterEqual property="strMm" compareValue="05" prepend="OR">
		                                (A.MN_5_STA_CD &lt;&gt; '*' OR A.MN_5_STA_CD IS NULL)
		                                    <isGreaterEqual property="strMm" compareValue="06" prepend="OR">
		                                    (A.MN_6_STA_CD &lt;&gt; '*' OR A.MN_6_STA_CD IS NULL)
		                                        <isGreaterEqual property="strMm" compareValue="07" prepend="OR">
		                                        (A.MN_7_STA_CD &lt;&gt; '*' OR A.MN_7_STA_CD IS NULL)
		                                            <isGreaterEqual property="strMm" compareValue="08" prepend="OR">
		                                            (A.MN_8_STA_CD &lt;&gt; '*' OR A.MN_8_STA_CD IS NULL)
		                                                <isGreaterEqual property="strMm" compareValue="09" prepend="OR">
		                                                (A.MN_9_STA_CD &lt;&gt; '*' OR A.MN_9_STA_CD IS NULL)
		                                                    <isGreaterEqual property="strMm" compareValue="10" prepend="OR">
		                                                    (A.MN_1_0_STA_CD &lt;&gt; '*' OR A.MN_1_0_STA_CD IS NULL)
		                                                        <isGreaterEqual property="strMm" compareValue="11" prepend="OR">
		                                                        (A.MN_1_1_STA_CD &lt;&gt; '*' OR A.MN_1_1_STA_CD IS NULL)
		                                                            <isGreaterEqual property="strMm" compareValue="12" prepend="OR">
		                                                            (A.MN_1_2_STA_CD &lt;&gt; '*' OR A.MN_1_2_STA_CD IS NULL)
		                                                                <isGreaterEqual property="strMm" compareValue="13" prepend="OR">
		                                                                (A.MN_1_3_STA_CD &lt;&gt; '*' OR A.MN_1_3_STA_CD IS NULL)
		                                                                </isGreaterEqual>
		                                                            </isGreaterEqual>
		                                                        </isGreaterEqual>
		                                                    </isGreaterEqual>
		                                                </isGreaterEqual>
		                                            </isGreaterEqual>
		                                        </isGreaterEqual>
		                                    </isGreaterEqual>
		                                </isGreaterEqual>
		                            </isGreaterEqual>
		                        </isGreaterEqual>
		                    </isGreaterEqual>
		                </isGreaterEqual>
		            </isGreaterEqual>
		        </isEqual>
		    </isEqual>
		</isEmpty>
		<include refid="include.pageOrder" />
		ORDER BY PROF_DRTR_SG, ORG_NM
	</select>
	
	 
	<select id="FAACAV004EselectMainExcelList" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/004/FAACAV004EselectMainExcelList */ ]]>
	    SELECT  ROWNUM AS KEY,
	            A.ORG_NM,
	            A.PST_NM,
	            A.PROF_DRTR_SG,
	            A.MDF_PEN_NM ,
	            A.TNB ,
	            A.CRE_DT,
	            A.ABLT_DT,
        <isNotEqual property="strRecvYn" compareValue="Y">
            <isEqual property="strMm" compareValue="00">
                DECODE(TRIM(A.MN_1_STA_CD),'','00','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="01">
                DECODE(TRIM(A.MN_1_STA_CD),'','01','') AS AA  
            </isEqual>
            <isEqual property="strMm" compareValue="02">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="03">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="04">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="05">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04,','')
                ||DECODE(TRIM(A.MN_5_STA_CD),'','05','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="06">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04,','')
                ||DECODE(TRIM(A.MN_5_STA_CD),'','05,','')
                ||DECODE(TRIM(A.MN_6_STA_CD),'','06','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="07">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04,','')
                ||DECODE(TRIM(A.MN_5_STA_CD),'','05,','')
                ||DECODE(TRIM(A.MN_6_STA_CD),'','06,','')
                ||DECODE(TRIM(A.MN_7_STA_CD),'','07','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="08">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04,','')
                ||DECODE(TRIM(A.MN_5_STA_CD),'','05,','')
                ||DECODE(TRIM(A.MN_6_STA_CD),'','06,','')
                ||DECODE(TRIM(A.MN_7_STA_CD),'','07,','')
                ||DECODE(TRIM(A.MN_8_STA_CD),'','08','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="09">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04,','')
                ||DECODE(TRIM(A.MN_5_STA_CD),'','05,','')
                ||DECODE(TRIM(A.MN_6_STA_CD),'','06,','')
                ||DECODE(TRIM(A.MN_7_STA_CD),'','07,','')
                ||DECODE(TRIM(A.MN_8_STA_CD),'','08,','')
                ||DECODE(TRIM(A.MN_9_STA_CD),'','09','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="10">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04,','')
                ||DECODE(TRIM(A.MN_5_STA_CD),'','05,','')
                ||DECODE(TRIM(A.MN_6_STA_CD),'','06,','')
                ||DECODE(TRIM(A.MN_7_STA_CD),'','07,','')
                ||DECODE(TRIM(A.MN_8_STA_CD),'','08,','')
                ||DECODE(TRIM(A.MN_9_STA_CD),'','09,','')
                ||DECODE(TRIM(A.MN_1_0_STA_CD),'','10','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="11">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04,','')
                ||DECODE(TRIM(A.MN_5_STA_CD),'','05,','')
                ||DECODE(TRIM(A.MN_6_STA_CD),'','06,','')
                ||DECODE(TRIM(A.MN_7_STA_CD),'','07,','')
                ||DECODE(TRIM(A.MN_8_STA_CD),'','08,','')
                ||DECODE(TRIM(A.MN_9_STA_CD),'','09,','')
                ||DECODE(TRIM(A.MN_1_0_STA_CD),'','10,','')
                ||DECODE(TRIM(A.MN_1_1_STA_CD),'','11','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="12">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04,','')
                ||DECODE(TRIM(A.MN_5_STA_CD),'','05,','')
                ||DECODE(TRIM(A.MN_6_STA_CD),'','06,','')
                ||DECODE(TRIM(A.MN_7_STA_CD),'','07,','')
                ||DECODE(TRIM(A.MN_8_STA_CD),'','08,','')
                ||DECODE(TRIM(A.MN_9_STA_CD),'','09,','')
                ||DECODE(TRIM(A.MN_1_0_STA_CD),'','10,','')
                ||DECODE(TRIM(A.MN_1_1_STA_CD),'','11,','')
                ||DECODE(TRIM(A.MN_1_2_STA_CD),'','12','') AS AA
            </isEqual>
            <isEqual property="strMm" compareValue="13">
                DECODE(TRIM(A.MN_1_STA_CD),'','01,','')
                ||DECODE(TRIM(A.MN_2_STA_CD),'','02,','')
                ||DECODE(TRIM(A.MN_3_STA_CD),'','03,','')
                ||DECODE(TRIM(A.MN_4_STA_CD),'','04,','')
                ||DECODE(TRIM(A.MN_5_STA_CD),'','05,','')
                ||DECODE(TRIM(A.MN_6_STA_CD),'','06,','')
                ||DECODE(TRIM(A.MN_7_STA_CD),'','07,','')
                ||DECODE(TRIM(A.MN_8_STA_CD),'','08,','')
                ||DECODE(TRIM(A.MN_9_STA_CD),'','09,','')
                ||DECODE(TRIM(A.MN_1_0_STA_CD),'','10,','')
                ||DECODE(TRIM(A.MN_1_1_STA_CD),'','11,','')
                ||DECODE(TRIM(A.MN_1_2_STA_CD),'','12,','')
                ||DECODE(TRIM(A.MN_1_3_STA_CD),'','13','') AS AA
            </isEqual>
        </isNotEqual>
	        <isEqual property="strRecvYn" compareValue="Y">
	            '' AS AA
	        </isEqual>
		FROM    (SELECT MN.ORG_NM,
		                MN.PST_NM,
		                MSTR.COPT_CD||'-'||MSTR.ACNT_CD||'-'||MSTR.BLL_CD||'-'||MSTR.PROF_DRTR_SRNO||'-'||MSTR.DL_XPN_RCDB_PBSVT_SRNO AS PROF_DRTR_SG,
		                MN.MDF_PEN_NM,
		                MN.TNB,
		                MN.CRE_DT,
		                MN.ABLT_DT,
		                MSTR.MN_1_STA_CD,
		                MSTR.MN_2_STA_CD,
		                MSTR.MN_3_STA_CD,
		                MSTR.MN_4_STA_CD,
		                MSTR.MN_5_STA_CD,
		                MSTR.MN_6_STA_CD,
		                MSTR.MN_7_STA_CD,
		                MSTR.MN_8_STA_CD,
		                MSTR.MN_9_STA_CD,
		                MSTR.MN_1_0_STA_CD,
		                MSTR.MN_1_1_STA_CD,
		                MSTR.MN_1_2_STA_CD,
		                MSTR.MN_1_3_STA_CD
		        FROM	TWFAACAV007M MSTR,
		                (SELECT CC.COPT_CD,
		                        CC.ACNT_CD,
		                        CC.BLL_CD,
		                        CC.PROF_DRTR_SRNO,
		                        CC.DL_XPN_RCDB_PBSVT_SRNO,
		                        CC.ORG_CD,
		                        CC.ORG_NM,
		                        CC.PST_NM,
		                        CC.CRE_DT, /*신설일*/
		                        CC.ABLT_DT, /*폐지일*/
		                        CC.MDF_PEN_NM , /*담당자*/
		                        CC.TNB
		                FROM    TWFAACAV003M CC,
		                        (SELECT A.COPT_CD,
		                                A.ACNT_CD, 
		                                A.BLL_CD, 
		                                A.PROF_DRTR_SRNO, 
		                                A.DL_XPN_RCDB_PBSVT_SRNO,
		                                CASE B.RMK_2 WHEN '월'   THEN #strYm#
		                                             WHEN '분기' THEN  CASE WHEN #strMm# = '01' THEN #strYr#||'01'
		                                                                    WHEN #strMm# = '02' THEN #strYr#||'04'
		                                                                    WHEN #strMm# = '03' THEN #strYr#||'07'
		                                                                    WHEN #strMm# = '04' THEN #strYr#||'10'
		                                                               END
		                                             WHEN '연'   THEN #strYr#||'00'
		                                END AS ABLT_DT_PROF_YM,
		                                CASE B.RMK_2 WHEN '월'   THEN #strYm#
		                                             WHEN '분기' THEN  CASE WHEN #strMm# = '01' THEN #strYr#||'03'
		                                                                    WHEN #strMm# = '02' THEN #strYr#||'06'
		                                                                    WHEN #strMm# = '03' THEN #strYr#||'09'
		                                                                    WHEN #strMm# = '04' THEN #strYr#||'13'
		                                                               END
		                                             WHEN '연'   THEN #strYr#||'13'
		                                END AS CRE_DT_PROF_YM
		                        FROM    TWFAACAV003M A,
		                                TWFAACAV024C B
		                        WHERE   1=1
		                        AND     A.MDF_DVSN_CD NOT IN ('D')
		                        AND     B.ACNT_DVSN_CD = '30'
		                        AND     B.ACNT_CD = A.BLL_CD || CASE WHEN A.DL_XPN_RCDB_PBSVT_SRNO= '000' THEN '000' WHEN A.DL_XPN_RCDB_PBSVT_SRNO!= '000' THEN 'XXX' END
							<!--기관코드-->
	                        <isNotEmpty property="strOrg1">
	                            AND     SUBSTR(A.ORG_CD,1,3) = #strOrg1#
	                        </isNotEmpty>
	                        <isNotEmpty property="strOrg2">
	                            AND     SUBSTR(A.ORG_CD,4,3) = #strOrg2#
	                        </isNotEmpty>
	                        <isNotEmpty property="strOrg3">
	                            AND     SUBSTR(A.ORG_CD,7,3) = #strOrg3#
	                        </isNotEmpty>
	                        <isNotEmpty property="strOrg4">
	                            AND     SUBSTR(A.ORG_CD,10,3) = #strOrg4#
	                        </isNotEmpty>
	                        
	                        <!--소관코드-->
	                        <isNotEmpty property="strCoptCd">
	                            AND A.COPT_CD = #strCoptCd#
	                        </isNotEmpty>
	                        <!--회계코드-->
	                        <isNotEmpty property="strAcntCd">
	                            AND A.ACNT_CD = #strAcntCd#
	                        </isNotEmpty>
	                        <!--계산서코드 입력 시 START-->
	                        <isNotEmpty property="strBllCd">
	                            <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
	                                <isEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
	                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = '000'
	                                    <isEqual property="strBllCd" compareValue="17">
	                                        AND     A.BLL_CD IN ('17','18')
	                                    </isEqual>
	                                    <isEqual property="strBllCd" compareValue="22">
	                                        AND     A.BLL_CD IN ('22','23','24')
	                                    </isEqual>
	                                    <isEqual property="strBllCd" compareValue="42">
	                                        AND     A.BLL_CD IN ('42','43')
	                                    </isEqual>
	                                    <isNotEmpty property="strBllCd">
	                                        AND     A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_CD 
	                                                                ELSE #strBllCd#
	                                                           END
	                                    </isNotEmpty>
	                                </isEqual>
	                                
	                                <isNotEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
	                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	                                    <isEqual property="strBllCd" compareValue="17">
	                                        AND     A.BLL_CD IN ('17','18')
	                                    </isEqual>
	                                    <isEqual property="strBllCd" compareValue="22">
	                                        AND     A.BLL_CD IN ('22','23','24')
	                                    </isEqual>
	                                    <isNotEmpty property="strBllCd">
	                                        AND     A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN A.BLL_CD 
	                                                                ELSE #strBllCd#
	                                                           END
	                                    </isNotEmpty>
	                                </isNotEqual>
	                            </isNotEmpty>
	
	                            <isEmpty property="strDlXpnRcdbPbsvtSrno">
	                                <isEqual property="strFildSsecYn" compareValue="N">
	                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = '000'
	                                    <isEqual property="strBllCd" compareValue="17">
	                                        AND     A.BLL_CD IN ('17','18')
	                                    </isEqual>
	                                    <isEqual property="strBllCd" compareValue="22">
	                                        AND     A.BLL_CD IN ('22','23','24')
	                                    </isEqual>
	                                    <isEqual property="strBllCd" compareValue="42">
	                                        AND     A.BLL_CD IN ('42','43')
	                                    </isEqual>
	                                    <isNotEmpty property="strBllCd">
	                                        AND     A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_CD 
	                                                                ELSE #strBllCd#
	                                                           END
	                                    </isNotEmpty>
	                                </isEqual>
	                                <isEqual property="strFildSsecYn" compareValue="Y">
	                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
	                                    <isEqual property="strBllCd" compareValue="17">
	                                    AND     A.BLL_CD IN ('17','18')
	                                    </isEqual>
	                                    <isEqual property="strBllCd" compareValue="22">
	                                    AND     A.BLL_CD IN ('22','23','24')
	                                    </isEqual>
	                                    <isNotEmpty property="strBllCd">
	                                    AND     A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN A.BLL_CD 
	                                                            ELSE #strBllCd#
	                                                       END
	                                    </isNotEmpty>
	                                </isEqual>
	                            </isEmpty>
	                        </isNotEmpty>
	                        <!--계산서코드 입력 시 END-->
	                        
	                        <!--계산서코드 미입력-->
	                        <isEmpty property="strBllCd">
	                            <isEqual property="strFildSsecYn" compareValue="N">
	                                <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
	                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	                                </isNotEmpty>
	                            </isEqual>
	                            <isEqual property="strFildSsecYn" compareValue="Y">
	                                <isNotEmpty property="strDlXpnRcdbPbsvtSrno">	
	                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	                                </isNotEmpty>
	                                <isEmpty property="strDlXpnRcdbPbsvtSrno">	
	                                    AND     A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
	                                </isEmpty>
	                            </isEqual>
	                        </isEmpty>
	                        <!--증명책임자 일련번호-->
	                        <isNotEmpty property="strProfDrtrSrno">
	                            AND     A.PROF_DRTR_SRNO = #strProfDrtrSrno#
	                        </isNotEmpty>
	                        <isEqual property="strPeriod" compareValue="M">
	                            AND     (A.BLL_CD IN ('17','18','19','25') OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'))
	                        </isEqual>
	                        <isEqual property="strPeriod" compareValue="Q">
	                            AND     A.BLL_CD IN ('11','12','13','15','16','20','21','22','23','24','29','41','42')
	                            AND     A.DL_XPN_RCDB_PBSVT_SRNO = '000'
	                        </isEqual>
	                        <isEqual property="strPeriod" compareValue="Y">
	                            AND     A.BLL_CD IN ('14','28','30','31','32','33','34','35','55')
	                            AND     A.DL_XPN_RCDB_PBSVT_SRNO = '000'
	                        </isEqual>
	                            ) BB
	                    WHERE   BB.COPT_CD = CC.COPT_CD
	                    AND     BB.ACNT_CD = CC.ACNT_CD
	                    AND     BB.BLL_CD  = CC.BLL_CD
	                    AND     BB.PROF_DRTR_SRNO = CC.PROF_DRTR_SRNO
	                    AND     BB.DL_XPN_RCDB_PBSVT_SRNO = CC.DL_XPN_RCDB_PBSVT_SRNO
	                    AND     NVL(CC.ABLT_DT,'999999') <![CDATA[ >= ]]> BB.ABLT_DT_PROF_YM
	                    AND		CC.CRE_DT <![CDATA[ <= ]]> BB.CRE_DT_PROF_YM
	                    ) MN
	            WHERE   1=1
	            AND     MSTR.COPT_CD = MN.COPT_CD
	            AND     MSTR.ACNT_CD = MN.ACNT_CD
	            AND     MSTR.BLL_CD  = MN.BLL_CD
	            AND     MSTR.PROF_DRTR_SRNO = MN.PROF_DRTR_SRNO
	            AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = MN.DL_XPN_RCDB_PBSVT_SRNO
	            AND     MSTR.PROF_YR = #strYr#                    
	        <!--기관코드-->
	        <isNotEmpty property="strOrg1">
	            AND     SUBSTR(MN.ORG_CD,1,3) = #strOrg1#
	        </isNotEmpty>
	        <isNotEmpty property="strOrg2">
	            AND     SUBSTR(MN.ORG_CD,4,3) = #strOrg2#
	        </isNotEmpty>
	        <isNotEmpty property="strOrg3">
	            AND     SUBSTR(MN.ORG_CD,7,3) = #strOrg3#
	        </isNotEmpty>
	        <isNotEmpty property="strOrg4">
	            AND     SUBSTR(MN.ORG_CD,10,3) = #strOrg4#
	        </isNotEmpty>
	        
	        <!--소관코드-->
	        <isNotEmpty property="strCoptCd">
	            AND MSTR.COPT_CD = #strCoptCd#
	        </isNotEmpty>
	        <!--회계코드-->
	        <isNotEmpty property="strAcntCd">
	            AND MSTR.ACNT_CD = #strAcntCd#
	        </isNotEmpty>
	        <!--계산서코드 입력 시 START-->
	        <isNotEmpty property="strBllCd">
	            <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
	                <isEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
	                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
	                    <isEqual property="strBllCd" compareValue="17">
	                        AND     MSTR.BLL_CD IN ('17','18')
	                    </isEqual>
	                    <isEqual property="strBllCd" compareValue="22">
	                        AND     MSTR.BLL_CD IN ('22','23','24')
	                    </isEqual>
	                    <isEqual property="strBllCd" compareValue="42">
	                        AND     MSTR.BLL_CD IN ('42','43')
	                    </isEqual>
	                    <isNotEmpty property="strBllCd">
	                        AND     MSTR.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN MSTR.BLL_CD 
	                                                ELSE #strBllCd#
	                                           END
	                    </isNotEmpty>
	                </isEqual>
	                
	                <isNotEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
	                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	                    <isEqual property="strBllCd" compareValue="17">
	                        AND     MSTR.BLL_CD IN ('17','18')
	                    </isEqual>
	                    <isEqual property="strBllCd" compareValue="22">
	                        AND     MSTR.BLL_CD IN ('22','23','24')
	                    </isEqual>
	                    <isNotEmpty property="strBllCd">
	                        AND     MSTR.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN MSTR.BLL_CD 
	                                                ELSE #strBllCd#
	                                           END
	                    </isNotEmpty>
	                </isNotEqual>
	            </isNotEmpty>
	
	            <isEmpty property="strDlXpnRcdbPbsvtSrno">
	                <isEqual property="strFildSsecYn" compareValue="N">
	                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
	                    <isEqual property="strBllCd" compareValue="17">
	                        AND     MSTR.BLL_CD IN ('17','18')
	                    </isEqual>
	                    <isEqual property="strBllCd" compareValue="22">
	                        AND     MSTR.BLL_CD IN ('22','23','24')
	                    </isEqual>
	                    <isEqual property="strBllCd" compareValue="42">
	                        AND     MSTR.BLL_CD IN ('42','43')
	                    </isEqual>
	                    <isNotEmpty property="strBllCd">
	                        AND     MSTR.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN MSTR.BLL_CD 
	                                                ELSE #strBllCd#
	                                           END
	                    </isNotEmpty>
	                </isEqual>
	                <isEqual property="strFildSsecYn" compareValue="Y">
	                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
	                    <isEqual property="strBllCd" compareValue="17">
	                    AND     MSTR.BLL_CD IN ('17','18')
	                    </isEqual>
	                    <isEqual property="strBllCd" compareValue="22">
	                    AND     MSTR.BLL_CD IN ('22','23','24')
	                    </isEqual>
	                    <isNotEmpty property="strBllCd">
	                    AND     MSTR.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN MSTR.BLL_CD 
	                                            ELSE #strBllCd#
	                                       END
	                    </isNotEmpty>
	                </isEqual>
	            </isEmpty>
	        </isNotEmpty>
	        <!--계산서코드 입력 시 END-->
	        
	        <!--계산서코드 미입력-->
	        <isEmpty property="strBllCd">
	            <isEqual property="strFildSsecYn" compareValue="N">
	                <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
	                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	                </isNotEmpty>
	            </isEqual>
	            <isEqual property="strFildSsecYn" compareValue="Y">
	                <isNotEmpty property="strDlXpnRcdbPbsvtSrno">	
	                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	                </isNotEmpty>
	                <isEmpty property="strDlXpnRcdbPbsvtSrno">	
	                    AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
	                </isEmpty>
	            </isEqual>
	        </isEmpty>
	        <!--증명책임자 일련번호-->
	        <isNotEmpty property="strProfDrtrSrno">
	            AND     MSTR.PROF_DRTR_SRNO = #strProfDrtrSrno#
	        </isNotEmpty>
	        <isEqual property="strPeriod" compareValue="M">
	            AND     (MSTR.BLL_CD IN ('17','18','19','25') OR (MSTR.BLL_CD IN ('22','23','24') AND MSTR.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'))
	        </isEqual>
	        <isEqual property="strPeriod" compareValue="Q">
	            AND     MSTR.BLL_CD IN ('11','12','13','15','16','20','21','22','23','24','29','41','42')
	            AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
	        </isEqual>
	        <isEqual property="strPeriod" compareValue="Y">
	            AND     MSTR.BLL_CD IN ('14','28','30','31','32','33','34','35','55')
	            AND     MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
	        </isEqual>
	            ) A
	    WHERE	1=1
	    <!--접수-->
	    <isEqual property="strRecvYn" compareValue="Y">
	        <isEqual property="strMm" compareValue="00">
	            AND     A.MN_1_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="01">
	            AND     A.MN_1_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="02">
	            AND     A.MN_2_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="03">
	            AND     A.MN_3_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="04">
	            AND     A.MN_4_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="05">
	            AND     A.MN_5_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="06">
	            AND     A.MN_6_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="07">
	            AND     A.MN_7_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="08">
	            AND     A.MN_8_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="09">
	            AND     A.MN_9_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="10">
	            AND     A.MN_1_0_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="11">
	            AND     A.MN_1_1_STA_CD IN('E','W','D','P')
	        </isEqual>
	        <isEqual property="strMm" compareValue="12">
	            AND     A.MN_1_2_STA_CD IN('E','W','D','P')
	        </isEqual>	
	        <isEqual property="strMm" compareValue="13">
	            AND     A.MN_1_3_STA_CD IN('E','W','D','P')
	        </isEqual>
	    </isEqual>
	
	    <!--미접수-->
	    <isEqual property="strRecvYn" compareValue="N">
	        <isGreaterEqual property="strMm" compareValue="00">
	            AND     A.MN_1_STA_CD IS NULL
	            <isGreaterEqual property="strMm" compareValue="01" prepend="OR">
	            A.MN_1_STA_CD IS NULL
	                <isGreaterEqual property="strMm" compareValue="02" prepend="OR">
	                A.MN_2_STA_CD IS NULL
	                    <isGreaterEqual property="strMm" compareValue="03" prepend="OR">
	                    A.MN_3_STA_CD IS NULL
	                        <isGreaterEqual property="strMm" compareValue="04" prepend="OR">
	                        A.MN_4_STA_CD IS NULL
	                            <isGreaterEqual property="strMm" compareValue="05" prepend="OR">
	                            A.MN_5_STA_CD IS NULL
	                                <isGreaterEqual property="strMm" compareValue="06" prepend="OR">
	                                A.MN_6_STA_CD IS NULL
	                                    <isGreaterEqual property="strMm" compareValue="07" prepend="OR">
	                                    A.MN_7_STA_CD IS NULL
	                                        <isGreaterEqual property="strMm" compareValue="08" prepend="OR">
	                                        A.MN_8_STA_CD IS NULL
	                                            <isGreaterEqual property="strMm" compareValue="09" prepend="OR">
	                                            A.MN_9_STA_CD IS NULL
	                                                <isGreaterEqual property="strMm" compareValue="10" prepend="OR">
	                                                A.MN_1_0_STA_CD IS NULL
	                                                    <isGreaterEqual property="strMm" compareValue="11" prepend="OR">
	                                                    A.MN_1_1_STA_CD IS NULL
	                                                        <isGreaterEqual property="strMm" compareValue="12" prepend="OR">
	                                                        A.MN_1_2_STA_CD IS NULL
	                                                            <isGreaterEqual property="strMm" compareValue="13" prepend="OR">
	                                                            A.MN_1_3_STA_CD IS NULL
	                                                            </isGreaterEqual>
	                                                        </isGreaterEqual>
	                                                    </isGreaterEqual>
	                                                </isGreaterEqual>
	                                            </isGreaterEqual>
	                                        </isGreaterEqual>
	                                    </isGreaterEqual>
	                                </isGreaterEqual>
	                            </isGreaterEqual>
	                        </isGreaterEqual>
	                    </isGreaterEqual>
	                </isGreaterEqual>
	            </isGreaterEqual>
	        </isGreaterEqual>
	    </isEqual>
	    <!--전체-->
	    <isEqual property="strRecvYn" compareValue="A">
	        <!--연간분-->
	        <isEqual property="yearChk" compareValue="Y">
	            AND     (A.MN_1_STA_CD &lt;&gt; '*' OR A.MN_1_STA_CD IS NULL)
	        </isEqual>
	        <!--월, 분기분 -->
	        <isEqual property="yearChk" compareValue="N">
	            <isGreaterEqual property="strMm" compareValue="00">
	            AND  (A.MN_1_STA_CD &lt;&gt; '*' OR A.MN_1_STA_CD IS NULL)
	                <isGreaterEqual property="strMm" compareValue="01" prepend="OR">
	                (A.MN_1_STA_CD &lt;&gt; '*' OR A.MN_1_STA_CD IS NULL)
	                    <isGreaterEqual property="strMm" compareValue="02" prepend="OR">
	                    (A.MN_2_STA_CD &lt;&gt; '*' OR A.MN_2_STA_CD IS NULL)
	                        <isGreaterEqual property="strMm" compareValue="03" prepend="OR">
	                        (A.MN_3_STA_CD &lt;&gt; '*' OR A.MN_3_STA_CD IS NULL)
	                            <isGreaterEqual property="strMm" compareValue="04" prepend="OR">
	                            (A.MN_4_STA_CD &lt;&gt; '*' OR A.MN_4_STA_CD IS NULL)
	                                <isGreaterEqual property="strMm" compareValue="05" prepend="OR">
	                                (A.MN_5_STA_CD &lt;&gt; '*' OR A.MN_5_STA_CD IS NULL)
	                                    <isGreaterEqual property="strMm" compareValue="06" prepend="OR">
	                                    (A.MN_6_STA_CD &lt;&gt; '*' OR A.MN_6_STA_CD IS NULL)
	                                        <isGreaterEqual property="strMm" compareValue="07" prepend="OR">
	                                        (A.MN_7_STA_CD &lt;&gt; '*' OR A.MN_7_STA_CD IS NULL)
	                                            <isGreaterEqual property="strMm" compareValue="08" prepend="OR">
	                                            (A.MN_8_STA_CD &lt;&gt; '*' OR A.MN_8_STA_CD IS NULL)
	                                                <isGreaterEqual property="strMm" compareValue="09" prepend="OR">
	                                                (A.MN_9_STA_CD &lt;&gt; '*' OR A.MN_9_STA_CD IS NULL)
	                                                    <isGreaterEqual property="strMm" compareValue="10" prepend="OR">
	                                                    (A.MN_1_0_STA_CD &lt;&gt; '*' OR A.MN_1_0_STA_CD IS NULL)
	                                                        <isGreaterEqual property="strMm" compareValue="11" prepend="OR">
	                                                        (A.MN_1_1_STA_CD &lt;&gt; '*' OR A.MN_1_1_STA_CD IS NULL)
	                                                            <isGreaterEqual property="strMm" compareValue="12" prepend="OR">
	                                                            (A.MN_1_2_STA_CD &lt;&gt; '*' OR A.MN_1_2_STA_CD IS NULL)
	                                                                <isGreaterEqual property="strMm" compareValue="13" prepend="OR">
	                                                                (A.MN_1_3_STA_CD &lt;&gt; '*' OR A.MN_1_3_STA_CD IS NULL)
	                                                                </isGreaterEqual>
	                                                            </isGreaterEqual>
	                                                        </isGreaterEqual>
	                                                    </isGreaterEqual>
	                                                </isGreaterEqual>
	                                            </isGreaterEqual>
	                                        </isGreaterEqual>
	                                    </isGreaterEqual>
	                                </isGreaterEqual>
	                            </isGreaterEqual>
	                        </isGreaterEqual>
	                    </isGreaterEqual>
	                </isGreaterEqual>
	            </isGreaterEqual>
	        </isEqual>
	    </isEqual>
		ORDER BY A.PROF_DRTR_SG
	</select> 
	
	
	
	<!-- 접수현황목록 상세조회 -->
	<select id="FAACAV004EMainDtlSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/004/FAACAV004EMainDtlSelect */ ]]>
        <![CDATA[
			SELECT SUBSTR(PROF_YM,5,2) PROF_YM, 
				   FRT_ACP_DT,
				   FNL_ACP_DT,
				   ACP_SQ
			FROM   TWFAACAV004L	
			 WHERE	1=1
			  AND COPT_CD = #strCoptCd#
			  AND ACNT_CD = #strAcntCd#
			  AND BLL_CD = #strBllCd#
			  AND PROF_DRTR_SRNO = #strProfDrtrSrno# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
			  AND PROF_YM BETWEEN  #strYr#||'00' AND   #strYr#||'13'
		]]>	   

		<![CDATA[
				ORDER BY PROF_YM
        ]]>
	</select> 
	
	<select id="FAACAV004ERselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/004/FAACAV004ERselect */ ]]>
			SELECT #title# as 제목,
				   #strYr# as STR_YR,
				   #strMm# as END_MM,
				   MSTR.COPT_CD||'-'||MSTR.ACNT_CD||'-'||MSTR.BLL_CD||'-'||MSTR.PROF_DRTR_SRNO||'-'||MSTR.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호,
			       CASE CD.USR_DFN_TXT_1 WHEN '월' THEN 1 
   	                         WHEN '분기' THEN 2
   	                         WHEN '연'  THEN 3
   	                         ELSE 4 END PERIODASC,
				   F_AV_ACNT_CD_NM(MSTR.ACNT_CD) AS 회계명,
			       D2.ORG_NM AS 기관명,
			       D2.PST_NM AS 증명책임자직위,
			       D2.MDF_PEN_NM || '
			       ' || D2.TNB AS 증명책임자,
			       F_AV_BLL_CD_NM(MSTR.BLL_CD, MSTR.DL_XPN_RCDB_PBSVT_SRNO) AS 계산서종류,
			       CASE WHEN CRE_DT LIKE #strYr# || '%' THEN SUBSTR(CRE_DT, 0,  4) || '-' || SUBSTR(CRE_DT,5)
		             ELSE '' END  AS 신설일자,
			       MSTR.MN_1_STA_CD AS 현황1월,
			       MSTR.MN_2_STA_CD AS 현황2월,
			       MSTR.MN_3_STA_CD AS 현황3월,
			       MSTR.MN_4_STA_CD AS 현황4월,
			       MSTR.MN_5_STA_CD AS 현황5월,
			       MSTR.MN_6_STA_CD AS 현황6월,
			       MSTR.MN_7_STA_CD AS 현황7월,
			       MSTR.MN_8_STA_CD AS 현황8월,
			       MSTR.MN_9_STA_CD AS 현황9월,
			       MSTR.MN_1_0_STA_CD AS 현황10월,
			       MSTR.MN_1_1_STA_CD AS 현황11월,
			       MSTR.MN_1_2_STA_CD AS 현황12월,
			       MSTR.MN_1_3_STA_CD AS 현황13월
			  FROM TWFAACAV007M MSTR, 
                   TWFAACAV003M D2
                   ,TBDCMACM013C CD
			 WHERE 1=1 
			   AND MSTR.COPT_CD = D2.COPT_CD
		   	   AND MSTR.ACNT_CD = D2.ACNT_CD
		   	   AND MSTR.BLL_CD = D2.BLL_CD
		   	   AND MSTR.PROF_DRTR_SRNO = D2.PROF_DRTR_SRNO
		   	   AND MSTR.DL_XPN_RCDB_PBSVT_SRNO = D2.DL_XPN_RCDB_PBSVT_SRNO
		   	   AND CD.CMM_CD_DVSN_CD = '1000015'
		   	   AND CD.CD = MSTR.BLL_CD
			   AND MSTR.PROF_YR     = #strYr# 
		<isNotEmpty property="strOrgNm">
			   AND D2.ORG_NM = #strOrgNm#
		</isNotEmpty>	   
		<isNotEmpty property="strCoptCd">	 	   
			   AND MSTR.COPT_CD     = #strCoptCd#
		</isNotEmpty>   	
		<isNotEmpty property="strAcntCd">	 	   
			   AND MSTR.ACNT_CD     = #strAcntCd#
		</isNotEmpty>
		<isNotEmpty property="strBllCd">	
			<isEmpty property="strProfDrtrSrno">
	    		<isEqual property="strBllCdType" compareValue="99">
					AND  MSTR.BLL_CD = #strBllCd#
				</isEqual>
			</isEmpty>	 
			<isEmpty property="strProfDrtrSrno">
				<isEqual property="strBllCd" compareValue="17">
				   AND  MSTR.BLL_CD IN('17','18')
				</isEqual>
			</isEmpty> 
			<isEmpty property="strProfDrtrSrno">
				<isEqual property="strBllCd" compareValue="22">
				   AND  MSTR.BLL_CD IN('22','23','24')
				</isEqual>
			</isEmpty> 
			<isEmpty property="strProfDrtrSrno">
				<isEqual property="strBllCd" compareValue="42">
				   AND  MSTR.BLL_CD IN('42','43')
				</isEqual>
			</isEmpty> 
			<isNotEmpty property="strProfDrtrSrno">
				   AND  MSTR.BLL_CD =#strBllCd#
			</isNotEmpty>
																				 
		</isNotEmpty>   
		
		<isNotEmpty property="strProfDrtrSrno">	 	   
			   AND MSTR.PROF_DRTR_SRNO     = #strProfDrtrSrno#
		</isNotEmpty> 
		<isNotEmpty property="strDlXpnRcdbPbsvtSrno">	 	   
			   AND MSTR.DL_XPN_RCDB_PBSVT_SRNO     = #strDlXpnRcdbPbsvtSrno#
		</isNotEmpty>		

		<isEqual property="strFildSsecYn" compareValue="Y">
		 	   AND  MSTR.DL_XPN_RCDB_PBSVT_SRNO != '000'
		</isEqual>	
		<isEqual property="strFildSsecYn" compareValue="N">
		 	   AND  MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
					
		<isNotEmpty property="strRecvYn">
			<isEqual property="strRecvYn" compareValue="Y">
				<isEqual property="strMm" compareValue="00">
				   AND  MSTR.MN_1_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND  MSTR.MN_1_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  MSTR.MN_2_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  MSTR.MN_3_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  MSTR.MN_4_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  MSTR.MN_5_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  MSTR.MN_6_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  MSTR.MN_7_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  MSTR.MN_8_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  MSTR.MN_9_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  MSTR.MN_1_0_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  MSTR.MN_1_1_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  MSTR.MN_1_2_STA_CD IN('E','W','D','P')
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  MSTR.MN_1_3_STA_CD IN('E','W','D','P')
				</isEqual>
			</isEqual>	
			
			<isEqual property="strRecvYn" compareValue="N">
				<isEqual property="strMm" compareValue="00">
                   AND  (MSTR.MN_1_STA_CD IS NULL OR REPLACE(MSTR.MN_1_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="01">
                   AND  (MSTR.MN_1_STA_CD IS NULL OR REPLACE(MSTR.MN_1_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="02">
                   AND  (MSTR.MN_2_STA_CD IS NULL OR REPLACE(MSTR.MN_2_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="03">
                   AND  (MSTR.MN_3_STA_CD IS NULL OR REPLACE(MSTR.MN_3_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="04">
                   AND  (MSTR.MN_4_STA_CD IS NULL OR REPLACE(MSTR.MN_4_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="05">
                   AND  (MSTR.MN_5_STA_CD IS NULL OR REPLACE(MSTR.MN_5_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="06">
                   AND  (MSTR.MN_6_STA_CD IS NULL OR REPLACE(MSTR.MN_6_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="07">
                   AND  (MSTR.MN_7_STA_CD IS NULL OR REPLACE(MSTR.MN_7_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="08">
                   AND  (MSTR.MN_8_STA_CD IS NULL OR REPLACE(MSTR.MN_8_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="09">
                   AND  (MSTR.MN_9_STA_CD IS NULL OR REPLACE(MSTR.MN_9_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="10">
                   AND  (MSTR.MN_1_0_STA_CD IS NULL OR REPLACE(MSTR.MN_1_0_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="11">
                   AND  (MSTR.MN_1_1_STA_CD IS NULL OR REPLACE(MSTR.MN_1_1_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="12">
                   AND  (MSTR.MN_1_2_STA_CD IS NULL OR REPLACE(MSTR.MN_1_2_STA_CD,' ',NULL) = NULL)
                </isEqual>	
                <isEqual property="strMm" compareValue="13">
                   AND  (MSTR.MN_1_3_STA_CD IS NULL OR REPLACE(MSTR.MN_1_3_STA_CD,' ',NULL) = NULL)
                </isEqual>
			</isEqual>	

			<isEqual property="strRecvYn" compareValue="A">
				<isEqual property="strMm" compareValue="00">
				   AND (MSTR.MN_1_STA_CD NOT IN('*') OR  MSTR.MN_1_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND (MSTR.MN_1_STA_CD NOT IN('*') OR  MSTR.MN_1_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  (MSTR.MN_2_STA_CD NOT IN('*') OR MSTR.MN_2_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  (MSTR.MN_3_STA_CD NOT IN('*') OR MSTR.MN_3_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  (MSTR.MN_4_STA_CD NOT IN('*') OR MSTR.MN_4_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  (MSTR.MN_5_STA_CD NOT IN('*') OR MSTR.MN_5_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  (MSTR.MN_6_STA_CD NOT IN('*') OR MSTR.MN_6_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  (MSTR.MN_7_STA_CD NOT IN('*') OR MSTR.MN_7_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  (MSTR.MN_8_STA_CD NOT IN('*') OR MSTR.MN_8_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  (MSTR.MN_9_STA_CD NOT IN('*') OR MSTR.MN_9_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  (MSTR.MN_1_0_STA_CD NOT IN('*') OR MSTR.MN_1_0_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  (MSTR.MN_1_1_STA_CD NOT IN('*') OR  MSTR.MN_1_1_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  (MSTR.MN_1_2_STA_CD NOT IN('*') OR MSTR.MN_1_2_STA_CD IS NULL)
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  (MSTR.MN_1_3_STA_CD NOT IN('*') OR MSTR.MN_1_3_STA_CD IS NULL)
				</isEqual>
			</isEqual>																												
		</isNotEmpty> 		
					ORDER BY 증명책임자부호
	</select>
	
	<select id="FAACAV004ER2select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/004/FAACAV004ER2select */ ]]>
		<![CDATA[
			SELECT SUBSTR(PROF_YM,1,4) || '.' || SUBSTR(PROF_YM,5,2) AS 증명년월,
			       SUBSTR(FRT_ACP_DT,1,4) || '.' || SUBSTR(FRT_ACP_DT,5,2)|| '.' || SUBSTR(FRT_ACP_DT,7,2) AS 최초접수일,
			       SUBSTR(FNL_ACP_DT,1,4) || '.' || SUBSTR(FNL_ACP_DT,5,2)|| '.' || SUBSTR(FNL_ACP_DT,7,2) AS 최종접수일,
			       ACP_SQ AS 정정횟수
			FROM   TWFAACAV004L	
			 WHERE	1=1
			  AND COPT_CD = #strCoptCd#
			  AND ACNT_CD = #strAcntCd#
			  AND BLL_CD = #strBllCd#
			  AND PROF_DRTR_SRNO = #strProfDrtrSrno# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
			  AND PROF_YM BETWEEN  #strYr#||'00' AND   #strYr#||'13'
		]]>	   

		<![CDATA[
				ORDER BY PROF_YM
        ]]>
	</select>
	
	<select id="FAACAV004ER3select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/004/FAACAV004ER3select */ ]]>
		<![CDATA[
			SELECT MN.COPT_CD||'-'||MN.ACNT_CD||'-'||MN.BLL_CD||'-'||MN.PROF_DRTR_SRNO||'-'||MN.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
			       ,F_AV_ACNT_CD_NM(MN.ACNT_CD) AS 회계
			       ,F_AV_BLL_COPT_CD_NM(MN.COPT_CD) AS 소관
			       ,F_AV_BLL_CD_NM(MN.BLL_CD, MN.DL_XPN_RCDB_PBSVT_SRNO) AS 계산서종류
			       ,SUBSTR(MN.CRE_DT,1,4)||'.'||SUBSTR(MN.CRE_DT,5,2) AS 부호신설일
			       ,SUBSTR(MN.ABLT_DT,1,4)||'.'||SUBSTR(MN.ABLT_DT,5,2) AS 부호폐지일
			       ,MN.ORG_NM AS 기관명
			       ,MN.PST_NM AS 담당자직위
			       ,MN.MDF_PEN_NM AS 담당자성명
				   ,MN.TNB AS 전화번호
				   ,MN.AD AS 주소
			  FROM TWFAACAV007M MSTR , TWFAACAV003M MN , TBDCMACM013C CD
			WHERE 1=1
			  AND MSTR.COPT_CD = MN.COPT_CD
			  AND MSTR.ACNT_CD = MN.ACNT_CD 
			  AND MSTR.BLL_CD = MN.BLL_CD 
			  AND MSTR.PROF_DRTR_SRNO = MN.PROF_DRTR_SRNO 
			  AND MSTR.DL_XPN_RCDB_PBSVT_SRNO = MN.DL_XPN_RCDB_PBSVT_SRNO 
			  AND CD.CMM_CD_DVSN_CD = '1000015' 
			  AND CD.CD = MSTR.BLL_CD 
		]]>	   
		<isNotEmpty property="strYr">	
			   AND MSTR.PROF_YR     = #strYr#
		</isNotEmpty>
		<isNotEmpty property="strCoptCd">	 	   
			   AND MSTR.COPT_CD     = #strCoptCd#
		</isNotEmpty>   	
		<isNotEmpty property="strAcntCd">	 	   
			   AND MSTR.ACNT_CD     = #strAcntCd#
		</isNotEmpty>
				
		<isNotEmpty property="strBllCd">
			<isEmpty property="strProfDrtrSrno">
	    		<isEqual property="strBllCdType" compareValue="99">
					AND  MSTR.BLL_CD = #strBllCd#
				</isEqual>
			</isEmpty>	 		
			<isEmpty property="strProfDrtrSrno">
				<isEqual property="strBllCd" compareValue="17">
				   AND  MSTR.BLL_CD IN('17','18')
				</isEqual>
			</isEmpty> 
			<isEmpty property="strProfDrtrSrno">
				<isEqual property="strBllCd" compareValue="22">
				   AND  MSTR.BLL_CD IN('22','23','24')
				</isEqual>
			</isEmpty> 
			<isEmpty property="strProfDrtrSrno">
				<isEqual property="strBllCd" compareValue="42">
				   AND  MSTR.BLL_CD IN('42','43')
				</isEqual>
			</isEmpty> 
			<isNotEmpty property="strProfDrtrSrno">
				   AND  MSTR.BLL_CD =#strBllCd#
			</isNotEmpty>
																				 
		</isNotEmpty>   
		
		<isNotEmpty property="strProfDrtrSrno">	 	   
			   AND MSTR.PROF_DRTR_SRNO     = #strProfDrtrSrno#
		</isNotEmpty> 
		<isNotEmpty property="strDlXpnRcdbPbsvtSrno">	 	   
			   AND MSTR.DL_XPN_RCDB_PBSVT_SRNO     = #strDlXpnRcdbPbsvtSrno#
		</isNotEmpty>		

		<isEqual property="strFildSsecYn" compareValue="Y">
		 	   AND  MSTR.DL_XPN_RCDB_PBSVT_SRNO != '000'
		</isEqual>	
		<isEqual property="strFildSsecYn" compareValue="N">
		 	   AND  MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
					
		<isNotEmpty property="strRecvYn">
			<isEqual property="strRecvYn" compareValue="Y">
				<isEqual property="strMm" compareValue="00">
				   AND  MSTR.MN_1_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND  MSTR.MN_1_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  MSTR.MN_2_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  MSTR.MN_3_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  MSTR.MN_4_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  MSTR.MN_5_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  MSTR.MN_6_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  MSTR.MN_7_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  MSTR.MN_8_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  MSTR.MN_9_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  MSTR.MN_1_0_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  MSTR.MN_1_1_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  MSTR.MN_1_2_STA_CD IN('E','W','D','P')
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  MSTR.MN_1_3_STA_CD IN('E','W','D','P')
				</isEqual>
			</isEqual>	
			
			<isEqual property="strRecvYn" compareValue="N">
				<isEqual property="strMm" compareValue="00">
                   AND  (MSTR.MN_1_STA_CD IS NULL OR REPLACE(MSTR.MN_1_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="01">
                   AND  (MSTR.MN_1_STA_CD IS NULL OR REPLACE(MSTR.MN_1_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="02">
                   AND  (MSTR.MN_2_STA_CD IS NULL OR REPLACE(MSTR.MN_2_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="03">
                   AND  (MSTR.MN_3_STA_CD IS NULL OR REPLACE(MSTR.MN_3_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="04">
                   AND  (MSTR.MN_4_STA_CD IS NULL OR REPLACE(MSTR.MN_4_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="05">
                   AND  (MSTR.MN_5_STA_CD IS NULL OR REPLACE(MSTR.MN_5_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="06">
                   AND  (MSTR.MN_6_STA_CD IS NULL OR REPLACE(MSTR.MN_6_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="07">
                   AND  (MSTR.MN_7_STA_CD IS NULL OR REPLACE(MSTR.MN_7_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="08">
                   AND  (MSTR.MN_8_STA_CD IS NULL OR REPLACE(MSTR.MN_8_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="09">
                   AND  (MSTR.MN_9_STA_CD IS NULL OR REPLACE(MSTR.MN_9_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="10">
                   AND  (MSTR.MN_1_0_STA_CD IS NULL OR REPLACE(MSTR.MN_1_0_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="11">
                   AND  (MSTR.MN_1_1_STA_CD IS NULL OR REPLACE(MSTR.MN_1_1_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="12">
                   AND  (MSTR.MN_1_2_STA_CD IS NULL OR REPLACE(MSTR.MN_1_2_STA_CD,' ',NULL) = NULL)
                </isEqual>	
                <isEqual property="strMm" compareValue="13">
                   AND  (MSTR.MN_1_3_STA_CD IS NULL OR REPLACE(MSTR.MN_1_3_STA_CD,' ',NULL) = NULL)
                </isEqual>
			</isEqual>	

			<isEqual property="strRecvYn" compareValue="A">
				<isEqual property="strMm" compareValue="00">
				   AND (MSTR.MN_1_STA_CD NOT IN('*') OR  MSTR.MN_1_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND (MSTR.MN_1_STA_CD NOT IN('*') OR  MSTR.MN_1_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  (MSTR.MN_2_STA_CD NOT IN('*') OR MSTR.MN_2_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  (MSTR.MN_3_STA_CD NOT IN('*') OR MSTR.MN_3_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  (MSTR.MN_4_STA_CD NOT IN('*') OR MSTR.MN_4_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  (MSTR.MN_5_STA_CD NOT IN('*') OR MSTR.MN_5_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  (MSTR.MN_6_STA_CD NOT IN('*') OR MSTR.MN_6_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  (MSTR.MN_7_STA_CD NOT IN('*') OR MSTR.MN_7_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  (MSTR.MN_8_STA_CD NOT IN('*') OR MSTR.MN_8_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  (MSTR.MN_9_STA_CD NOT IN('*') OR MSTR.MN_9_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  (MSTR.MN_1_0_STA_CD NOT IN('*') OR MSTR.MN_1_0_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  (MSTR.MN_1_1_STA_CD NOT IN('*') OR  MSTR.MN_1_1_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  (MSTR.MN_1_2_STA_CD NOT IN('*') OR MSTR.MN_1_2_STA_CD IS NULL)
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  (MSTR.MN_1_3_STA_CD NOT IN('*') OR MSTR.MN_1_3_STA_CD IS NULL)
				</isEqual>
			</isEqual>																												
		</isNotEmpty> 		
	</select>
	
	<select id="FAACAV005ERselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/004/FAACAV005ERselect */ ]]>
			SELECT MSTR.COPT_CD||'-'||MSTR.ACNT_CD||'-'||MSTR.BLL_CD||'-'||MSTR.PROF_DRTR_SRNO||'-'||MSTR.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호,
			       CASE CD.USR_DFN_TXT_1 WHEN '월' THEN 1 
		 	                         WHEN '분기' THEN 2
		 	                         WHEN '연'  THEN 3
		 	                         ELSE 4 END PERIODASC,
				   MN.ORG_NM AS 기관명,
				   MN.PST_NM AS 담당자직위,
			       MN.MDF_PEN_NM AS 담당자,
			       MSTR.MN_1_STA_CD AS 증명1월,
			       MSTR.MN_2_STA_CD AS 증명2월,
			       MSTR.MN_3_STA_CD AS 증명3월,
			       MSTR.MN_4_STA_CD AS 증명4월,
			       MSTR.MN_5_STA_CD AS 증명5월,
			       MSTR.MN_6_STA_CD AS 증명6월,
			       MSTR.MN_7_STA_CD AS 증명7월,
			       MSTR.MN_8_STA_CD AS 증명8월,
			       MSTR.MN_9_STA_CD AS 증명9월,
			       MSTR.MN_1_0_STA_CD AS 증명10월,
			       MSTR.MN_1_1_STA_CD AS 증명11월,
			       MSTR.MN_1_2_STA_CD AS 증명12월,
			       MSTR.MN_1_3_STA_CD AS 증명13월
			  FROM TWFAACAV007M MSTR 
   LEFT OUTER JOIN TWFAACAV074M D2
				ON MSTR.COPT_CD = D2.COPT_CD
		   	   AND MSTR.ACNT_CD = D2.ACNT_CD
		   	   AND MSTR.BLL_CD = D2.BLL_CD
		   	   AND MSTR.PROF_DRTR_SRNO = D2.PROF_DRTR_SRNO
		   	   AND MSTR.DL_XPN_RCDB_PBSVT_SRNO = D2.DL_XPN_RCDB_PBSVT_SRNO
				   ,TWFAACAV003M MN,TBDCMACM013C CD
			 WHERE 1=1
			   AND MSTR.COPT_CD = MN.COPT_CD
			   AND MSTR.ACNT_CD = MN.ACNT_CD 
			   AND MSTR.BLL_CD = MN.BLL_CD 
			   AND MSTR.PROF_DRTR_SRNO = MN.PROF_DRTR_SRNO 
			   AND MSTR.DL_XPN_RCDB_PBSVT_SRNO = MN.DL_XPN_RCDB_PBSVT_SRNO 
			   AND CD.CMM_CD_DVSN_CD = '1000015' 
			   AND CD.CD = MSTR.BLL_CD 
		<isNotEmpty property="strOrgNm">
			   AND MN.ORG_NM = #strOrgNm#
		</isNotEmpty>	   
		<isNotEmpty property="strYr">	
			   AND MSTR.PROF_YR     = #strYr#
		</isNotEmpty>
		<isNotEmpty property="strCoptCd">	 	   
			   AND MSTR.COPT_CD     = #strCoptCd#
		</isNotEmpty>   	
		<isNotEmpty property="strAcntCd">	 	   
			   AND MSTR.ACNT_CD     = #strAcntCd#
		</isNotEmpty>
		<isNotEmpty property="strBllCd">	 	
			<isEmpty property="strProfDrtrSrno">
	    		<isEqual property="strBllCdType" compareValue="99">
					AND  MSTR.BLL_CD = #strBllCd#
				</isEqual>
			</isEmpty>	  		
			<isEmpty property="strProfDrtrSrno">
				<isEqual property="strBllCd" compareValue="17">
				   AND  MSTR.BLL_CD IN('17','18')
				</isEqual>
			</isEmpty> 
			<isEmpty property="strProfDrtrSrno">
				<isEqual property="strBllCd" compareValue="22">
				   AND  MSTR.BLL_CD IN('22','23','24')
				</isEqual>
			</isEmpty> 
			<isEmpty property="strProfDrtrSrno">
				<isEqual property="strBllCd" compareValue="42">
				   AND  MSTR.BLL_CD IN('42','43')
				</isEqual>
			</isEmpty> 
			<isNotEmpty property="strProfDrtrSrno">
				   AND  MSTR.BLL_CD =#strBllCd#
			</isNotEmpty>
																				 
		</isNotEmpty>   
		
		<isNotEmpty property="strProfDrtrSrno">	 	   
			   AND MSTR.PROF_DRTR_SRNO     = #strProfDrtrSrno#
		</isNotEmpty> 
		<isNotEmpty property="strDlXpnRcdbPbsvtSrno">	 	   
			   AND MSTR.DL_XPN_RCDB_PBSVT_SRNO     = #strDlXpnRcdbPbsvtSrno#
		</isNotEmpty>		

		<isEqual property="strFildSsecYn" compareValue="Y">
		 	   AND  MSTR.DL_XPN_RCDB_PBSVT_SRNO != '000'
		</isEqual>	
		<isEqual property="strFildSsecYn" compareValue="N">
		 	   AND  MSTR.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
					
		<isNotEmpty property="strRecvYn">
			<isEqual property="strRecvYn" compareValue="Y">
				<isEqual property="strMm" compareValue="00">
				   AND  MSTR.MN_1_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND  MSTR.MN_1_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  MSTR.MN_2_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  MSTR.MN_3_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  MSTR.MN_4_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  MSTR.MN_5_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  MSTR.MN_6_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  MSTR.MN_7_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  MSTR.MN_8_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  MSTR.MN_9_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  MSTR.MN_1_0_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  MSTR.MN_1_1_STA_CD IN('E','W','D','P')
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  MSTR.MN_1_2_STA_CD IN('E','W','D','P')
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  MSTR.MN_1_3_STA_CD IN('E','W','D','P')
				</isEqual>
			</isEqual>	
			
			<isEqual property="strRecvYn" compareValue="N">
				<isEqual property="strMm" compareValue="00">
                   AND  (MSTR.MN_1_STA_CD IS NULL OR REPLACE(MSTR.MN_1_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="01">
                   AND  (MSTR.MN_1_STA_CD IS NULL OR REPLACE(MSTR.MN_1_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="02">
                   AND  (MSTR.MN_2_STA_CD IS NULL OR REPLACE(MSTR.MN_2_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="03">
                   AND  (MSTR.MN_3_STA_CD IS NULL OR REPLACE(MSTR.MN_3_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="04">
                   AND  (MSTR.MN_4_STA_CD IS NULL OR REPLACE(MSTR.MN_4_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="05">
                   AND  (MSTR.MN_5_STA_CD IS NULL OR REPLACE(MSTR.MN_5_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="06">
                   AND  (MSTR.MN_6_STA_CD IS NULL OR REPLACE(MSTR.MN_6_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="07">
                   AND  (MSTR.MN_7_STA_CD IS NULL OR REPLACE(MSTR.MN_7_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="08">
                   AND  (MSTR.MN_8_STA_CD IS NULL OR REPLACE(MSTR.MN_8_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="09">
                   AND  (MSTR.MN_9_STA_CD IS NULL OR REPLACE(MSTR.MN_9_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="10">
                   AND  (MSTR.MN_1_0_STA_CD IS NULL OR REPLACE(MSTR.MN_1_0_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="11">
                   AND  (MSTR.MN_1_1_STA_CD IS NULL OR REPLACE(MSTR.MN_1_1_STA_CD,' ',NULL) = NULL)
                </isEqual>
                <isEqual property="strMm" compareValue="12">
                   AND  (MSTR.MN_1_2_STA_CD IS NULL OR REPLACE(MSTR.MN_1_2_STA_CD,' ',NULL) = NULL)
                </isEqual>	
                <isEqual property="strMm" compareValue="13">
                   AND  (MSTR.MN_1_3_STA_CD IS NULL OR REPLACE(MSTR.MN_1_3_STA_CD,' ',NULL) = NULL)
                </isEqual>
			</isEqual>	

			<isEqual property="strRecvYn" compareValue="A">
				<isEqual property="strMm" compareValue="00">
				   AND (MSTR.MN_1_STA_CD NOT IN('*') OR  MSTR.MN_1_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND (MSTR.MN_1_STA_CD NOT IN('*') OR  MSTR.MN_1_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  (MSTR.MN_2_STA_CD NOT IN('*') OR MSTR.MN_2_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  (MSTR.MN_3_STA_CD NOT IN('*') OR MSTR.MN_3_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  (MSTR.MN_4_STA_CD NOT IN('*') OR MSTR.MN_4_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  (MSTR.MN_5_STA_CD NOT IN('*') OR MSTR.MN_5_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  (MSTR.MN_6_STA_CD NOT IN('*') OR MSTR.MN_6_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  (MSTR.MN_7_STA_CD NOT IN('*') OR MSTR.MN_7_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  (MSTR.MN_8_STA_CD NOT IN('*') OR MSTR.MN_8_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  (MSTR.MN_9_STA_CD NOT IN('*') OR MSTR.MN_9_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  (MSTR.MN_1_0_STA_CD NOT IN('*') OR MSTR.MN_1_0_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  (MSTR.MN_1_1_STA_CD NOT IN('*') OR  MSTR.MN_1_1_STA_CD IS NULL)
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  (MSTR.MN_1_2_STA_CD NOT IN('*') OR MSTR.MN_1_2_STA_CD IS NULL)
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  (MSTR.MN_1_3_STA_CD NOT IN('*') OR MSTR.MN_1_3_STA_CD IS NULL)
				</isEqual>
			</isEqual>																												
		</isNotEmpty>
					ORDER BY 증명책임자부호
	</select>
</sqlMap> 







