<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="dcm/bst/001">
	<select id="DCMBST001QNowDaySelect" parameterClass="paramMap" resultClass="resultMap">
       	 SELECT * FROM TBDCMBST001M WHERE TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN STR_DT AND END_DT
	</select>
	<select id="DCMBST001QSelectedDay" parameterClass="paramMap" resultClass="resultMap">
       	 SELECT * FROM TBDCMBST001M WHERE YR =#YR# AND MN= #MN#  AND WEK_NO=#WEK_NO#
	</select>
	
	<select id="DCMBST001QResult01Select" parameterClass="paramMap" resultClass="resultMap">
		/*실지감사실시*/
		SELECT  STTC_DVSN_CD ,
				NVL(MAX(COL_1_1),0) AS LIST1_STTC1,/*자료수집합계*/
				NVL(MAX(COL_2_1),0) AS LIST1_STTC2,/*자료수집(재무감사)*/
				NVL(MAX(COL_3_1),0) AS LIST1_STTC3,/*자료수집(기관감사)*/
				NVL(MAX(COL_4_1),0) AS LIST1_STTC4,/*자료수집(특정감사)*/
				NVL(MAX(COL_5_1),0) AS LIST1_STTC5,/*자료수집(성과감사)*/
				NVL(MAX(COL_1_2),0) AS LIST1_STTC6,/*예비조사합계*/
				NVL(MAX(COL_2_2),0) AS LIST1_STTC7,/*예비조사(재무감사)*/
				NVL(MAX(COL_3_2),0) AS LIST1_STTC8,/*예비조사(기관감사)*/
				NVL(MAX(COL_4_2),0) AS LIST1_STTC9,/*예비조사(특정감사)*/
				NVL(MAX(COL_5_2),0) AS LIST1_STTC10,/*예비조사(성과감사)*/
				NVL(MAX(COL_1_3),0) AS LIST1_STTC11,/*실지감사합계*/
				NVL(MAX(COL_2_3),0) AS LIST1_STTC12,/*실지감사(재무감사)*/
				NVL(MAX(COL_3_3),0) AS LIST1_STTC13,/*실지감사(기관감사)*/
				NVL(MAX(COL_4_3),0) AS LIST1_STTC14,/*실지감사(특정감사)*/
				NVL(MAX(COL_5_3),0) AS LIST1_STTC15/*실지감사(성과감사)*/
		FROM
		(	SELECT STTC_DVSN_CD ,
				DECODE(STTC_SNO,1,STTC_NM_4,NULL) AS COL_1_1,
				DECODE(STTC_SNO,2,STTC_NM_4,NULL) AS COL_2_1,
				DECODE(STTC_SNO,3,STTC_NM_4,NULL) AS COL_3_1,
				DECODE(STTC_SNO,5,STTC_NM_4,NULL) AS COL_4_1,
				DECODE(STTC_SNO,4,STTC_NM_4,NULL) AS COL_5_1,
			
				DECODE(STTC_SNO,1,STTC_NM_5,NULL) AS COL_1_2,
				DECODE(STTC_SNO,2,STTC_NM_5,NULL) AS COL_2_2,
				DECODE(STTC_SNO,3,STTC_NM_5,NULL) AS COL_3_2,
				DECODE(STTC_SNO,5,STTC_NM_5,NULL) AS COL_4_2,
				DECODE(STTC_SNO,4,STTC_NM_5,NULL) AS COL_5_2,
			
				DECODE(STTC_SNO,1,STTC_NM_6,NULL) AS COL_1_3,
				DECODE(STTC_SNO,2,STTC_NM_6,NULL) AS COL_2_3,
				DECODE(STTC_SNO,3,STTC_NM_6,NULL) AS COL_3_3,
				DECODE(STTC_SNO,5,STTC_NM_6,NULL) AS COL_4_3,
				DECODE(STTC_SNO,4,STTC_NM_6,NULL) AS COL_5_3
			FROM TBDCMBST002M
			WHERE STTC_YR =#strYr# AND STTC_MN= #strMn#
				  AND STTC_WEK_NO=#strWekNo# AND STTC_DVSN_CD=#strSttcDvsnCd#
		)
		GROUP BY STTC_DVSN_CD

	</select>
	
	<select id="DCMBST001QResult02Select" parameterClass="paramMap" resultClass="resultMap">
		/*국회감사요구*/
		SELECT  
				NVL(STTC_NM_6,0) + NVL(STTC_NM_7,0) + NVL(STTC_NM_8,0) AS LIST2_STTC1,/*감사실시중*/
				NVL(STTC_NM_8 ,0) AS LIST2_STTC2,/*실지감사*/
				NVL(STTC_NM_11 ,0) AS LIST2_STTC3,/*시행(국회통보)*/
				NVL(STTC_NM_9,0) + NVL(STTC_NM_10,0) AS LIST2_STTC4,/*감사실시중*/
				NVL(STTC_NM_12,0) AS LIST2_STTC5,/*기한경과*/
				NVL(STTC_NM_13,0) AS LIST2_STTC6/*연장*/
		FROM TBDCMBST002M
		WHERE STTC_YR =#strYr# AND STTC_MN= #strMn#
			  AND STTC_WEK_NO=#strWekNo# AND STTC_DVSN_CD=#strSttcDvsnCd#
	</select>
	<select id="DCMBST001QResult02_2Select" parameterClass="paramMap" resultClass="resultMap">
		/*국회감사요구처리상황*/
		SELECT NVL(MAX(LIST2_STTC7),0) AS LIST2_STTC7 ,NVL(MAX(LIST2_STTC8),0) AS LIST2_STTC8 ,NVL(MAX(LIST2_STTC9),0) AS LIST2_STTC9 FROM 
			(SELECT  
					DECODE(STTC_NM_8,1, COUNT(STTC_NM_8),NULL) AS LIST2_STTC7,  
					DECODE(STTC_NM_8,2, COUNT(STTC_NM_8),NULL) AS LIST2_STTC8,  
					DECODE(STTC_NM_8,3, COUNT(STTC_NM_8),NULL) AS LIST2_STTC9 
			FROM TBDCMBST002M
			WHERE STTC_YR =#strYr# AND STTC_MN= #strMn# AND STTC_WEK_NO=#strWekNo# AND STTC_DVSN_CD=#strSttcDvsnCd#
			GROUP BY STTC_NM_8 ORDER BY STTC_NM_8
        )
		
	</select>
	<select id="DCMBST001QResult03Select" parameterClass="paramMap" resultClass="resultMap">
		/*처리안 단계*/
		SELECT  NVL(STTC_NM_3,0) AS LIST3_STTC1,/*종료보고비보고*/
				NVL(STTC_NM_4,0) AS LIST3_STTC2,/*과 작성중*/
				NVL(STTC_NM_5,0) + NVL(STTC_NM_6,0) + NVL(STTC_NM_7,0) AS LIST3_STTC3,/*총차국장 결재중*/
				NVL(STTC_NM_8,0) AS LIST3_STTC4 /*주심위원검토중*/
		FROM TBDCMBST002M
		WHERE STTC_YR =#strYr# AND STTC_MN= #strMn#
			  AND STTC_WEK_NO=#strWekNo# AND STTC_DVSN_CD=#strSttcDvsnCd#
	</select>
	
	<select id="DCMBST001QResult03_2Select" parameterClass="paramMap" resultClass="resultMap">
		/*처리안 단계 처리일 경과*/
		 SELECT  NVL(MAX(STEP1),0) AS LIST3_STTC5 ,
				 NVL(MAX(STEP2),0) AS LIST3_STTC6 ,
				 NVL(MAX(STEP3),0) + NVL(MAX(STEP4),0) + NVL(MAX(STEP5),0) + NVL(MAX(STEP6),0) AS LIST3_STTC7,
				 NVL(MAX(STEP7),0) AS LIST3_STTC8
		FROM 
				(SELECT  
						DECODE(STTC_NM_1,'종료보고 미보고',COUNT(STTC_NM_6), NULL) AS STEP1 ,  
						DECODE(STTC_NM_1,'과장검토',COUNT(STTC_NM_6), NULL) AS STEP2,  
						DECODE(STTC_NM_1,'국장검토',COUNT(STTC_NM_6), NULL) AS STEP3,  
						DECODE(STTC_NM_1,'단장검토',COUNT(STTC_NM_6), NULL) AS STEP4,  
						DECODE(STTC_NM_1,'차장검토',COUNT(STTC_NM_6), NULL) AS STEP5,  
						DECODE(STTC_NM_1,'총장검토',COUNT(STTC_NM_6), NULL) AS STEP6,  
						DECODE(STTC_NM_1,'위원검토',COUNT(STTC_NM_6), NULL) AS STEP7
				FROM TBDCMBST002M
				WHERE STTC_YR = #strYr# AND STTC_MN = #strMn# 
					   AND STTC_WEK_NO = #strWekNo# AND STTC_DVSN_CD = #strSttcDvsnCd# 
					   AND INSTR(STTC_NM_6,'경과',-1) <![CDATA[ > ]]> 0 
				GROUP BY STTC_NM_1 )
	</select>
	
	<select id="DCMBST001QResult04Select" parameterClass="paramMap" resultClass="resultMap">
		/*결과시행*/
		SELECT  STTC_DVSN_CD ,
				NVL(MAX(COL_1_1),0) + NVL(MAX(COL_2_1),0) AS LIST4_STTC1, /*판정 징계*/
				NVL(MAX(COL_3_1),0) + NVL(MAX(COL_4_1),0) + NVL(MAX(COL_5_1),0) AS LIST4_STTC2,  /*시정 주의 개선*/
				NVL(MAX(COL_6_1),0) + NVL(MAX(COL_7_1),0) + NVL(MAX(COL_8_1),0) + NVL(MAX(COL_9_1),0) + NVL(MAX(COL_10_1),0) AS LIST4_STTC3, /*권고통보*/
				NVL(MAX(COL_11_1),0) AS LIST4_STTC4 /*고발 수사요청*/
				FROM
				(SELECT STTC_DVSN_CD ,
						DECODE(STTC_SNO,3,STTC_NM_9,NULL) AS COL_1_1,  
						DECODE(STTC_SNO,4,STTC_NM_9,NULL) AS COL_2_1, 
						DECODE(STTC_SNO,5,STTC_NM_9,NULL) AS COL_3_1,
						DECODE(STTC_SNO,6,STTC_NM_9,NULL) AS COL_4_1,
						DECODE(STTC_SNO,7,STTC_NM_9,NULL) AS COL_5_1,
						DECODE(STTC_SNO,8,STTC_NM_9,NULL) AS COL_6_1,
						DECODE(STTC_SNO,9,STTC_NM_9,NULL) AS COL_7_1,
						DECODE(STTC_SNO,10,STTC_NM_9,NULL) AS COL_8_1,
						DECODE(STTC_SNO,11,STTC_NM_9,NULL) AS COL_9_1,
						DECODE(STTC_SNO,12,STTC_NM_9,NULL) AS COL_10_1,
						DECODE(STTC_SNO,13,STTC_NM_9,NULL) AS COL_11_1
						FROM TBDCMBST002M
						WHERE STTC_YR =#strYr# AND STTC_MN= #strMn# AND STTC_WEK_NO=#strWekNo# AND STTC_DVSN_CD=#strSttcDvsnCd#
				)
		GROUP BY STTC_DVSN_CD
	</select>
	
	<select id="DCMBST001QResult05Select" parameterClass="paramMap" resultClass="resultMap">
		/*감사청구사항*/
		SELECT  STTC_DVSN_CD,
				NVL(MAX(COL_1_1),0) AS LIST5_STTC1,  /*국민신규접수*/
				NVL(MAX(COL_2_1),0)  AS LIST5_STTC2, /*국민인용*/
				NVL(MAX(COL_4_1),0) + NVL(MAX(COL_5_1),0) + NVL(MAX(COL_6_1),0) + NVL(MAX(COL_3_1),0) AS LIST5_STTC3, /*국민기각등*/
				
				NVL(MAX(COL_7_1),0) AS LIST5_STTC4,  /*공익신규접수*/
				NVL(MAX(COL_8_1),0)  AS LIST5_STTC5,  /*공익인용*/
				NVL(MAX(COL_10_1),0) + NVL(MAX(COL_11_1),0) + NVL(MAX(COL_12_1),0) + NVL(MAX(COL_9_1),0)AS LIST5_STTC6/*공익기각등*/
			FROM
			( 	SELECT STTC_DVSN_CD,
					DECODE(STTC_SNO,8,STTC_NM_5,NULL) AS COL_1_1,  
					DECODE(STTC_SNO,8,STTC_NM_7,NULL) AS COL_2_1, 
					DECODE(STTC_SNO,8,STTC_NM_8,NULL) AS COL_3_1,
					DECODE(STTC_SNO,8,STTC_NM_9,NULL) AS COL_4_1,
					DECODE(STTC_SNO,8,STTC_NM_10,NULL) AS COL_5_1,
					DECODE(STTC_SNO,8,STTC_NM_11,NULL) AS COL_6_1,
					DECODE(STTC_SNO,9,STTC_NM_5,NULL) AS COL_7_1,
					DECODE(STTC_SNO,9,STTC_NM_7,NULL) AS COL_8_1,
					DECODE(STTC_SNO,9,STTC_NM_8,NULL) AS COL_9_1,
					DECODE(STTC_SNO,9,STTC_NM_9,NULL) AS COL_10_1,
					DECODE(STTC_SNO,9,STTC_NM_10,NULL) AS COL_11_1,
					DECODE(STTC_SNO,9,STTC_NM_11,NULL) AS COL_12_1
				FROM TBDCMBST002M
				WHERE STTC_YR = #strYr# AND STTC_MN = #strMn# AND STTC_WEK_NO = #strWekNo# AND STTC_DVSN_CD = #strSttcDvsnCd# 
			)
		GROUP BY STTC_DVSN_CD
	</select>
	<select id="DCMBST001QResult06Select" parameterClass="paramMap" resultClass="resultMap">
		/*감사청구미처리*/
		SELECT  STTC_DVSN_CD,
				NVL(MAX(COL_1_1),0) + NVL(MAX(COL_2_1),0) AS LIST6_STTC1, /*국민미처리*/
				NVL(MAX(COL_3_1),0) + NVL(MAX(COL_4_1),0) AS LIST6_STTC2, /*국민기한경과*/
				NVL(MAX(COL_5_1),0) + NVL(MAX(COL_6_1),0) AS LIST6_STTC3, /*공익미처리*/
				NVL(MAX(COL_7_1),0) + NVL(MAX(COL_8_1),0) AS LIST6_STTC4 /*공익기한경과*/
				FROM
				( 	SELECT STTC_DVSN_CD,
						DECODE(STTC_SNO,2,STTC_NM_3,NULL) AS COL_1_1,  
						DECODE(STTC_SNO,2,STTC_NM_6,NULL) AS COL_2_1, 
						DECODE(STTC_SNO,2,STTC_NM_5,NULL) AS COL_3_1,
						DECODE(STTC_SNO,2,STTC_NM_8,NULL) AS COL_4_1,
						DECODE(STTC_SNO,3,STTC_NM_3,NULL) AS COL_5_1,
						DECODE(STTC_SNO,3,STTC_NM_6,NULL) AS COL_6_1,
						DECODE(STTC_SNO,3,STTC_NM_5,NULL) AS COL_7_1,
						DECODE(STTC_SNO,3,STTC_NM_8,NULL) AS COL_8_1
					FROM TBDCMBST002M
					WHERE STTC_YR = #strYr# AND STTC_MN = #strMn# AND STTC_WEK_NO = #strWekNo# AND STTC_DVSN_CD = #strSttcDvsnCd# 
				)
		GROUP BY STTC_DVSN_CD
	</select>
	<select id="DCMBST001QResult07Select" parameterClass="paramMap" resultClass="resultMap">
		/*심사청구  재심의 청구*/
		SELECT * FROM
		(	SELECT STTC_YR,STTC_MN,STTC_WEK_NO,STTC_SNO,STTC_DVSN_CD,
		
			    NVL(STTC_NM_4,0) AS LIST7_STTC1,/*심사 신규*/
			    NVL(STTC_NM_6,0) AS LIST7_STTC2,/*심사 인용*/
			    NVL(STTC_NM_7,0)+NVL(STTC_NM_8,0)+NVL(STTC_NM_9,0) AS LIST7_STTC3,/*심사 기각등*/
			    NVL(STTC_NM_10,0) AS LIST7_STTC4 /*심사 미처리*/
		    
			FROM    TBDCMBST002M T1
			WHERE   T1.STTC_DVSN_CD = #strSttcDvsnCd1# 
			UNION ALL  
			SELECT STTC_YR,STTC_MN,STTC_WEK_NO,STTC_SNO,STTC_DVSN_CD,
			    NVL(STTC_NM_4,0) AS LIST7_STTC1,/*재심의 신규*/
			    NVL(STTC_NM_6,0) AS LIST7_STTC2,/*재심의 인용*/
			    NVL(STTC_NM_7,0) + NVL(STTC_NM_8,0) + NVL(STTC_NM_9,0) AS LIST7_STTC3,/*재심의 기각등*/
			    NVL(STTC_NM_10,0) AS LIST7_STTC4 /*재심의 미처리*/
			FROM    TBDCMBST002M T2
			WHERE   T2.STTC_DVSN_CD = #strSttcDvsnCd2# 
		)
		WHERE	STTC_YR = #strYr# AND STTC_MN = #strMn# AND STTC_WEK_NO = #strWekNo#  AND STTC_SNO =3
	</select>
	<select id="DCMBST001QResult08Select" parameterClass="paramMap" resultClass="resultMap">
		/*심사청구  재심의미처리*/
		SELECT * FROM
			(	SELECT STTC_YR,STTC_MN,STTC_WEK_NO,STTC_SNO,STTC_DVSN_CD,
				
				    NVL(STTC_NM_2,0)+NVL(STTC_NM_3,0) AS LIST8_STTC1,/*심사 미처리6월*/
				    NVL(STTC_NM_4,0) AS LIST8_STTC2,/*심사 미처리1년*/
				    NVL(STTC_NM_5,0) + NVL(STTC_NM_6,0) AS LIST8_STTC3/*심사 미처리1년초과*/
				    
				FROM    TBDCMBST002M T1
				WHERE   T1.STTC_DVSN_CD = #strSttcDvsnCd1# 
				UNION ALL  
				SELECT STTC_YR,STTC_MN,STTC_WEK_NO,STTC_SNO,STTC_DVSN_CD,
				    NVL(STTC_NM_2,0) + NVL(STTC_NM_3,0) AS LIST8_STTC1,/*재심의 미처리6월*/
				    NVL(STTC_NM_4,0) AS LIST8_STTC2,/*재심의 미처리1년*/
				    NVL(STTC_NM_5,0) + NVL(STTC_NM_6,0) AS LIST8_STTC3/*재심의 미처리1년초과*/
				    
				FROM    TBDCMBST002M T2
				WHERE   T2.STTC_DVSN_CD = #strSttcDvsnCd2# 
			)
		WHERE	STTC_YR = #strYr# AND STTC_MN = #strMn# AND STTC_WEK_NO = #strWekNo# AND STTC_SNO = 1
	</select>
	<select id="DCMBST001QResult09Select" parameterClass="paramMap" resultClass="resultMap">
		SELECT	NVL(STTC_NM_4,0) AS LIST9_STTC1,/*민원 신규접수*/
			    NVL(STTC_NM_5,0) + NVL(STTC_NM_11,0)  AS LIST9_STTC2,/*민원 처리완료*/
			    NVL(STTC_NM_13,0) + NVL(STTC_NM_14,0) AS LIST9_STTC3, /*민원 미처리 미처리*/
			    NVL(STTC_NM_14,0) AS LIST9_STTC4 /*민원 미처리 기한경과*/	    
		FROM	TBDCMBST002M T2
		WHERE	STTC_YR = #strYr# AND STTC_MN = #strMn# AND STTC_WEK_NO = #strWekNo# AND STTC_DVSN_CD = #strSttcDvsnCd# AND STTC_SNO = 3
	</select>
	<select id="DCMBST001QResult10Select" parameterClass="paramMap" resultClass="resultMap">
	SELECT	NVL(STTC_NM_5,0) AS LIST10_STTC1,/*부정청탁 신규접수*/
		    NVL(STTC_NM_6,0) AS LIST10_STTC2,/*부정청탁 처리완료*/
		    NVL(STTC_NM_10,0) + NVL(STTC_NM_11,0)  AS LIST10_STTC3,/*부정청탁 미처리*/
		    NVL(STTC_NM_11,0) AS LIST10_STTC4 /*부정청탁 기한경과*/    
		FROM	TBDCMBST002M T2
		WHERE	STTC_YR = #strYr# AND STTC_MN = #strMn# AND STTC_WEK_NO = #strWekNo# AND STTC_DVSN_CD = #strSttcDvsnCd# AND STTC_SNO = 7
	</select>
</sqlMap> 