<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/dcp/514">

 	<resultMap class="java.util.HashMap" id="hwpDoc_Map">
	
	<result property="CVPT_ACP_NO" column="CVPT_ACP_NO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REQ_DVSN_CD" column="REQ_DVSN_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_YR" column="ACP_YR" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CVPTR_NM" column="CVPTR_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="AD" column="AD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="PK_NO" column="PK_NO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TNB" column="TNB" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_DH" column="ACP_DH" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TIT_NM" column="TIT_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="DGE" column="DGE" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ORG_NM" column="ORG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="B1_CVPT_DOC_TXT" column="B1_CVPT_DOC_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="B2_CVPT_DOC_TXT" column="B2_CVPT_DOC_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="B3_CVPT_DOC_TXT" column="B3_CVPT_DOC_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="B4_CVPT_DOC_TXT" column="B4_CVPT_DOC_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="CVPT_OPM_APV_HNDL_STA_CD" column="CVPT_OPM_APV_HNDL_STA_CD"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="OPM_TXT" column="OPM_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
	<result property="CVPT_OPM_SRNO" column="CVPT_OPM_SRNO"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="FL_RUT_NM" column="FL_RUT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="SYS_FL_NM" column="SYS_FL_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="RSLT_RPRT_HNDL_RSLT_CD" column="RSLT_RPRT_HNDL_RSLT_CD"    jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="RSLT_RPRT_HNDL_RSLT_NM" column="RSLT_RPRT_HNDL_RSLT_NM"    jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="TITLE" column="TITLE"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="ONR_DOC_MNG_CRD_ID" column="ONR_DOC_MNG_CRD_ID"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="CNT" column="CNT" jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="CVPT_HNDL_DVSN_CD" column="CVPT_HNDL_DVSN_CD" jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="ONR_APV_CMPT_DH" column="ONR_APV_CMPT_DH" jdbcType="VARCHAR2"      javaType="java.lang.String" />
    </resultMap>
    
 	<select id="CSPDCP514PMainSelect" parameterClass="paramMap"
		resultMap="hwpDoc_Map">
		<![CDATA[
		SELECT D1.CVPT_ACP_NO
		      ,D1.REQ_DVSN_CD
		      ,D1.ACP_YR
		      ,DECODE(D1.REQR_KND_CD,'1',D1.CVPTR_NM,'2',D1.RPST_PEN_NM,'3',D1.RPST_PEN_NM,'4',D1.CVPTR_NM) AS CVPTR_NM 
		      ,DECODE(D1.ZCD,NULL,'','(우)'||D1.ZCD||' '||D1.AD||' '||D1.DTL_AD) AS AD
		      ,D1.ACP_YR||'-민원-'||D1.RM_CVPT_ACP_NO||CHR(10)||CHR(13)||'('||TO_CHAR(D1.ACP_DH, 'YYYY-MM-DD')||')' AS PK_NO
		      ,DECODE(D1.TNB,NULL,D1.HPN,D1.TNB) AS TNB
		      ,TO_CHAR(D1.ACP_DH, 'YYYY-MM-DD') AS ACP_DH
		      , CASE WHEN	H.SUC_CNT > 0 AND H.SUC_CNT <= 5 THEN D1.TIT_NM||(	SELECT	'(합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
							   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
							   								 						WHERE	D1.REQ_DVSN_CD = S2.REQ_DVSN_CD
												   								 	AND		D1.ACP_YR = S2.ACP_YR
												   								 	AND		D1.CVPT_ACP_NO = S2.CVPT_ACP_NO
												   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
												   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
												   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
												   								 ) 
							WHEN H.SUC_CNT > 5 THEN D1.TIT_NM||(	SELECT	'(합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' 외 '||(H.SUC_CNT-5)||'건)'
			   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
			   								 						WHERE	D1.REQ_DVSN_CD = S2.REQ_DVSN_CD
								   								 	AND		D1.ACP_YR = S2.ACP_YR
								   								 	AND		D1.CVPT_ACP_NO = S2.CVPT_ACP_NO
								   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
								   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
								   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
								   								 	AND		ROWNUM <= 5
								   								 ) 
						ELSE D1.TIT_NM END AS TIT_NM
		      ,#DGE# AS DGE
		      , Z.ORG_NM
		      ,CASE WHEN (SELECT COUNT(1)
		                    FROM TBCSPDCP203M S1
		                   WHERE 1=1
		                     AND S1.CVPT_DOC_DVSN_CD = 'B1'
		                     AND S1.ACP_YR = D1.ACP_YR
		                     AND S1.REQ_DVSN_CD = D1.REQ_DVSN_CD
		                     AND S1.DGE = #DGE#
		                     AND S1.CVPT_ACP_NO = D1.CVPT_ACP_NO) = 0 THEN (SELECT S2.CVPT_DOC_TXT
		                                                                      FROM TBCSPDCP203M S2
		                                                                     WHERE 1=1
		                                                                       AND S2.CVPT_DOC_DVSN_CD = 'A1'
		                                                                       AND S2.ACP_YR = D1.ACP_YR
		                                                                       AND S2.REQ_DVSN_CD = D1.REQ_DVSN_CD
		                                                                       AND S2.CVPT_ACP_NO = D1.CVPT_ACP_NO) 
	              ELSE (SELECT S3.CVPT_DOC_TXT
	                            FROM TBCSPDCP203M S3
	                           WHERE 1=1
	                             AND S3.CVPT_DOC_DVSN_CD = 'B1'
	                             AND S3.ACP_YR = D1.ACP_YR
	                             AND S3.REQ_DVSN_CD = D1.REQ_DVSN_CD
	                             AND S3.CVPT_ACP_NO = D1.CVPT_ACP_NO
	                             AND S3.DGE = #DGE#) END AS B1_CVPT_DOC_TXT
		      ,(SELECT S4.CVPT_DOC_TXT
		           FROM TBCSPDCP203M S4
		          WHERE S4.CVPT_DOC_DVSN_CD = 'B2'
		            AND S4.ACP_YR = D1.ACP_YR
		            AND S4.REQ_DVSN_CD = D1.REQ_DVSN_CD
		            AND S4.DGE = #DGE#
		            AND S4.CVPT_ACP_NO = D1.CVPT_ACP_NO) AS B2_CVPT_DOC_TXT
		      ,(SELECT S5.CVPT_DOC_TXT
		           FROM TBCSPDCP203M S5
		          WHERE S5.CVPT_DOC_DVSN_CD = 'B3'
		            AND S5.ACP_YR = D1.ACP_YR
		            AND S5.REQ_DVSN_CD = D1.REQ_DVSN_CD
		            AND S5.DGE = #DGE#
		            AND S5.CVPT_ACP_NO = D1.CVPT_ACP_NO) AS B3_CVPT_DOC_TXT
		      ,(SELECT S3.CVPT_DOC_TXT
	                            FROM TBCSPDCP203M S3
	                           WHERE 1=1
	                             AND S3.CVPT_DOC_DVSN_CD = 'B4'
	                             AND S3.ACP_YR = D1.ACP_YR
	                             AND S3.REQ_DVSN_CD = D1.REQ_DVSN_CD
	                             AND S3.CVPT_ACP_NO = D1.CVPT_ACP_NO
	                             AND S3.DGE = #DGE#) AS B4_CVPT_DOC_TXT
				,D2.CVPT_OPM_APV_HNDL_STA_CD
				, D3.OPM_TXT
				, D2.CVPT_OPM_SRNO
				, D4.FL_RUT_NM
				, D4.SYS_FL_NM
				, D6.RSLT_RPRT_HNDL_RSLT_CD
				, F_CODE_NM('1000053',RSLT_RPRT_HNDL_RSLT_CD) AS RSLT_RPRT_HNDL_RSLT_NM
				,CASE WHEN	H.SUC_CNT > 0 AND H.SUC_CNT <= 5 THEN F_CODE_NM('1000370','D')||' (제'||D1.ACP_YR||'-민원-'||D1.RM_CVPT_ACP_NO||'호) 조사 위탁'||(	SELECT	' (합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
																								   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
																								   								 						WHERE	D1.REQ_DVSN_CD = S2.REQ_DVSN_CD
																													   								 	AND		D1.ACP_YR = S2.ACP_YR
																													   								 	AND		D1.CVPT_ACP_NO = S2.CVPT_ACP_NO
																													   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
																													   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
																													   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
					   								 																								) 
						WHEN H.SUC_CNT > 5 THEN F_CODE_NM('1000370','D')||' (제'||D1.ACP_YR||'-민원-'||D1.RM_CVPT_ACP_NO||'호) 조사 위탁'||(	SELECT	' (합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' 외 '||(H.SUC_CNT-5)||'건)'
																		   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
																		   								 						WHERE	D1.REQ_DVSN_CD = S2.REQ_DVSN_CD
																							   								 	AND		D1.ACP_YR = S2.ACP_YR
																							   								 	AND		D1.CVPT_ACP_NO = S2.CVPT_ACP_NO
																							   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
																							   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
																							   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
																							   								 	AND		ROWNUM <= 5
  								 																								) 
						ELSE F_CODE_NM('1000370','D')||' (제'||D1.ACP_YR||'-민원-'||D1.RM_CVPT_ACP_NO||'호) 조사 위탁' END AS TITLE
				, D2.ONR_DOC_MNG_CRD_ID
				, (SELECT COUNT(*)
		           FROM TBCSPDCP203M S4
		          WHERE S4.CVPT_DOC_DVSN_CD = 'B1'
		            AND S4.ACP_YR = D1.ACP_YR
		            AND S4.REQ_DVSN_CD = D1.REQ_DVSN_CD
		            AND S4.DGE = #DGE#
		            AND S4.CVPT_ACP_NO = D1.CVPT_ACP_NO) AS CNT
		        , D7.CVPT_HNDL_DVSN_CD
		        , TO_CHAR(D2.ONR_APV_CMPT_DH,'YYYY-MM-DD') AS ONR_APV_CMPT_DH 
		  FROM TBCSPDCP101M D1
		  	   , TBCSPDCP301M D2
 			   , TBCSPDCP302M D3
 			   , TBDCMACM103L D4
 			   , TBCSPDCP401H D5
 			   , TBCSPDCP402L D6
 			   , TBCSPDCP205L D7
 			   ,(	SELECT	Z.REQ_DVSN_CD, Z.ACP_YR, Z.CVPT_ACP_NO
								,CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(ORG_CD,'1') 
								ELSE Z.ORG_NM END AS ORG_NM
								, CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_HRK_NM(COPT_SG_CD)
								ELSE NULL END AS COPT_SG_NM
   						FROM	TBCSPDCP206L Z
   						WHERE	Z.REQ_DVSN_CD = #REQ_DVSN_CD#
   						AND		Z.ACP_YR = #ACP_YR#
   						AND		Z.CVPT_ACP_NO = #CVPT_ACP_NO#
   						AND		Z.ORG_HIS_DVSN_CD ='1'
   						AND		Z.HNDL_ORG_SRNO = (SELECT	MIN(S1.HNDL_ORG_SRNO)
   													FROM	TBCSPDCP206L S1
   													WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
							   						AND		S1.ACP_YR = #ACP_YR#
							   						AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#
							   						AND		S1.ORG_HIS_DVSN_CD ='1'
							   						)
   					) Z
				, (SELECT	#REQ_DVSN_CD# REQ_DVSN_CD, #ACP_YR# ACP_YR, #CVPT_ACP_NO# CVPT_ACP_NO, COUNT(*) AS SUC_CNT
						FROM	TBCSPDCP105L S1 
						WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
						AND		S1.ACP_YR = #ACP_YR#
						AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#
						) H
		 WHERE 1=1
		   AND D1.REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND D1.ACP_YR      = #ACP_YR#
		   AND D1.CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
		   AND D1.ACP_YR = D2.ACP_YR(+)
		   AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
		   AND D2.DGE(+) = #DGE#
		   AND D2.CVPT_IFM_DVSN_CD(+) = 'D'
		   AND D2.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
		   AND D2.ACP_YR = D3.ACP_YR(+)
		   AND D2.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
		   AND D2.CVPT_OPM_SRNO = D3.CVPT_OPM_SRNO(+)
		   AND D2.ONR_DOC_MNG_CRD_ID = D4.ONR_DOC_MNG_CRD_ID(+)
		   AND D1.REQ_DVSN_CD = D5.REQ_DVSN_CD(+)
		   AND D1.ACP_YR = D5.ACP_YR(+)
		   AND D1.CVPT_ACP_NO = D5.CVPT_ACP_NO(+)
		   AND D5.DGE(+) = #DGE#
		   AND D5.REQ_DVSN_CD = D6.REQ_DVSN_CD(+)
		   AND D5.ACP_YR = D6.ACP_YR(+)
		   AND D5.CVPT_ACP_NO = D6.CVPT_ACP_NO(+)
		   AND D5.DGE = D6.DGE(+)
		   AND D1.REQ_DVSN_CD = D7.REQ_DVSN_CD
		   AND D1.ACP_YR = D7.ACP_YR
		   AND D1.CVPT_ACP_NO = D7.CVPT_ACP_NO
		   AND D7.SRNO = #SRNO#
		   AND D1.REQ_DVSN_CD = Z.REQ_DVSN_CD(+)
		   AND D1.ACP_YR = Z.ACP_YR(+)
		   AND D1.CVPT_ACP_NO = Z.CVPT_ACP_NO(+)
		   AND		D1.REQ_DVSN_CD = H.REQ_DVSN_CD(+)
		   AND		D1.ACP_YR = H.ACP_YR(+)
		   AND		D1.CVPT_ACP_NO = H.CVPT_ACP_NO(+)	
		]]>
		
	</select>
	
	<resultMap class="java.util.HashMap" id="hwpDoc_Map2">
	
	<result property="CVPT_ACP_NO" column="CVPT_ACP_NO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REQ_DVSN_CD" column="REQ_DVSN_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_YR" column="ACP_YR" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CVPTR_NM" column="CVPTR_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="AD" column="AD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="PK_NO" column="PK_NO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TNB" column="TNB" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_DH" column="ACP_DH" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TIT_NM" column="TIT_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="DGE" column="DGE" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ORG_NM" column="ORG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="COPT_SG_NM" column="COPT_SG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="B1_CVPT_DOC_TXT" column="B1_CVPT_DOC_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="B2_CVPT_DOC_TXT" column="B2_CVPT_DOC_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="B3_CVPT_DOC_TXT" column="B3_CVPT_DOC_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="B4_CVPT_DOC_TXT" column="B4_CVPT_DOC_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="CVPT_OPM_APV_HNDL_STA_CD" column="CVPT_OPM_APV_HNDL_STA_CD"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="OPM_TXT" column="OPM_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
	<result property="CVPT_OPM_SRNO" column="CVPT_OPM_SRNO"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="FL_RUT_NM" column="FL_RUT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="SYS_FL_NM" column="SYS_FL_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="RSLT_RPRT_HNDL_RSLT_CD" column="RSLT_RPRT_HNDL_RSLT_CD"    jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="RSLT_RPRT_HNDL_RSLT_NM" column="RSLT_RPRT_HNDL_RSLT_NM"    jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="TITLE" column="TITLE"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="ONR_DOC_MNG_CRD_ID" column="ONR_DOC_MNG_CRD_ID"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="CNT" column="CNT" jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="CVPT_HNDL_DVSN_CD" column="CVPT_HNDL_DVSN_CD" jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="DSP_RQ_KND_CD" column="DSP_RQ_KND_CD" jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="DSP_ORG_NM" column="DSP_ORG_NM" jdbcType="VARCHAR2"      javaType="java.lang.String" />
	<result property="ONR_APV_CMPT_DH" column="ONR_APV_CMPT_DH" jdbcType="VARCHAR2"      javaType="java.lang.String" />
    </resultMap>
	<!-- 위탁조사결과 보고 내역 조회 -->
	<select id="CSPDCP514PMainSelect2" parameterClass="paramMap"
		resultMap="hwpDoc_Map2">
		<![CDATA[
		SELECT D1.CVPT_ACP_NO
		      ,D1.REQ_DVSN_CD
		      ,D1.ACP_YR
		      ,DECODE(D1.REQR_KND_CD,'1',D1.CVPTR_NM,'2',D1.RPST_PEN_NM,'3',D1.RPST_PEN_NM,'4',D1.CVPTR_NM) AS CVPTR_NM 
		      ,DECODE(D1.ZCD,NULL,'','(우)'||D1.ZCD||' '||D1.AD||' '||D1.DTL_AD) AS AD
		      ,D1.ACP_YR||'-민원-'||D1.RM_CVPT_ACP_NO||CHR(10)||CHR(13)||'('||TO_CHAR(D1.ACP_DH, 'YYYY-MM-DD')||')' AS PK_NO
		      ,DECODE(D1.TNB,NULL,D1.HPN,D1.TNB) AS TNB
		      ,TO_CHAR(D1.ACP_DH, 'YYYY-MM-DD') AS ACP_DH
		      , CASE WHEN	H.SUC_CNT > 0 AND H.SUC_CNT <= 5 THEN D1.TIT_NM||(	SELECT	'(합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
							   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
							   								 						WHERE	D1.REQ_DVSN_CD = S2.REQ_DVSN_CD
												   								 	AND		D1.ACP_YR = S2.ACP_YR
												   								 	AND		D1.CVPT_ACP_NO = S2.CVPT_ACP_NO
												   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
												   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
												   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
												   								 ) 
							WHEN H.SUC_CNT > 5 THEN D1.TIT_NM||(	SELECT	'(합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' 외 '||(H.SUC_CNT-5)||'건)'
			   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
			   								 						WHERE	D1.REQ_DVSN_CD = S2.REQ_DVSN_CD
								   								 	AND		D1.ACP_YR = S2.ACP_YR
								   								 	AND		D1.CVPT_ACP_NO = S2.CVPT_ACP_NO
								   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
								   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
								   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
								   								 	AND		ROWNUM <= 5
								   								 ) 
						ELSE D1.TIT_NM END AS TIT_NM
		      ,#DGE# AS DGE
		      , Z.ORG_NM
 			  , Z.COPT_SG_NM
		      ,CASE WHEN (SELECT COUNT(1)
		                    FROM TBCSPDCP203M S1
		                   WHERE 1=1
		                     AND S1.CVPT_DOC_DVSN_CD = 'B1'
		                     AND S1.ACP_YR = D1.ACP_YR
		                     AND S1.REQ_DVSN_CD = D1.REQ_DVSN_CD
		                     AND S1.DGE = #DGE#
		                     AND S1.CVPT_ACP_NO = D1.CVPT_ACP_NO) = 0 THEN (SELECT S2.CVPT_DOC_TXT
		                                                                      FROM TBCSPDCP203M S2
		                                                                     WHERE 1=1
		                                                                       AND S2.CVPT_DOC_DVSN_CD = 'A1'
		                                                                       AND S2.ACP_YR = D1.ACP_YR
		                                                                       AND S2.REQ_DVSN_CD = D1.REQ_DVSN_CD
		                                                                       AND S2.CVPT_ACP_NO = D1.CVPT_ACP_NO) 
	              ELSE (SELECT S3.CVPT_DOC_TXT
	                            FROM TBCSPDCP203M S3
	                           WHERE 1=1
	                             AND S3.CVPT_DOC_DVSN_CD = 'B1'
	                             AND S3.ACP_YR = D1.ACP_YR
	                             AND S3.REQ_DVSN_CD = D1.REQ_DVSN_CD
	                             AND S3.CVPT_ACP_NO = D1.CVPT_ACP_NO
	                             AND S3.DGE = #DGE#) END AS B1_CVPT_DOC_TXT
		      ,(SELECT S4.CVPT_DOC_TXT
		           FROM TBCSPDCP203M S4
		          WHERE S4.CVPT_DOC_DVSN_CD = 'B2'
		            AND S4.ACP_YR = D1.ACP_YR
		            AND S4.REQ_DVSN_CD = D1.REQ_DVSN_CD
		            AND S4.DGE = #DGE#
		            AND S4.CVPT_ACP_NO = D1.CVPT_ACP_NO) AS B2_CVPT_DOC_TXT
		      ,(SELECT S5.CVPT_DOC_TXT
		           FROM TBCSPDCP203M S5
		          WHERE S5.CVPT_DOC_DVSN_CD = 'B3'
		            AND S5.ACP_YR = D1.ACP_YR
		            AND S5.REQ_DVSN_CD = D1.REQ_DVSN_CD
		            AND S5.DGE = #DGE#
		            AND S5.CVPT_ACP_NO = D1.CVPT_ACP_NO) AS B3_CVPT_DOC_TXT
		      ,(SELECT S3.CVPT_DOC_TXT
	                            FROM TBCSPDCP203M S3
	                           WHERE 1=1
	                             AND S3.CVPT_DOC_DVSN_CD = 'B4'
	                             AND S3.ACP_YR = D1.ACP_YR
	                             AND S3.REQ_DVSN_CD = D1.REQ_DVSN_CD
	                             AND S3.CVPT_ACP_NO = D1.CVPT_ACP_NO
	                             AND S3.DGE = #DGE#) AS B4_CVPT_DOC_TXT
				,D2.CVPT_OPM_APV_HNDL_STA_CD
				, D3.OPM_TXT
				, D2.CVPT_OPM_SRNO
				, D4.FL_RUT_NM
				, D4.SYS_FL_NM
				, D6.RSLT_RPRT_HNDL_RSLT_CD
				, F_CODE_NM('1000053',RSLT_RPRT_HNDL_RSLT_CD) AS RSLT_RPRT_HNDL_RSLT_NM
				,CASE WHEN	H.SUC_CNT > 0 AND H.SUC_CNT <= 5 THEN F_CODE_NM('1000370','D')||' (제'||D1.ACP_YR||'-민원-'||D1.RM_CVPT_ACP_NO||'호) 조사 위탁'||(	SELECT	' (합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
																								   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
																								   								 						WHERE	D1.REQ_DVSN_CD = S2.REQ_DVSN_CD
																													   								 	AND		D1.ACP_YR = S2.ACP_YR
																													   								 	AND		D1.CVPT_ACP_NO = S2.CVPT_ACP_NO
																													   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
																													   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
																													   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
					   								 																								) 
						WHEN H.SUC_CNT > 5 THEN F_CODE_NM('1000370','D')||' (제'||D1.ACP_YR||'-민원-'||D1.RM_CVPT_ACP_NO||'호) 조사 위탁'||(	SELECT	' (합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' 외 '||(H.SUC_CNT-5)||'건)'
																		   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
																		   								 						WHERE	D1.REQ_DVSN_CD = S2.REQ_DVSN_CD
																							   								 	AND		D1.ACP_YR = S2.ACP_YR
																							   								 	AND		D1.CVPT_ACP_NO = S2.CVPT_ACP_NO
																							   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
																							   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
																							   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
																							   								 	AND		ROWNUM <= 5
  								 																								) 
						ELSE F_CODE_NM('1000370','D')||' (제'||D1.ACP_YR||'-민원-'||D1.RM_CVPT_ACP_NO||'호) 조사 위탁' END AS TITLE
				, D2.ONR_DOC_MNG_CRD_ID
				, (SELECT COUNT(*)
		           FROM TBCSPDCP203M S4
		          WHERE S4.CVPT_DOC_DVSN_CD = 'B1'
		            AND S4.ACP_YR = D1.ACP_YR
		            AND S4.REQ_DVSN_CD = D1.REQ_DVSN_CD
		            AND S4.DGE = #DGE#
		            AND S4.CVPT_ACP_NO = D1.CVPT_ACP_NO) AS CNT
		        , D7.CVPT_HNDL_DVSN_CD
		        , (SELECT	AGGR_CONCAT(DSP_RQ_KND_CD,'|') 
		        	FROM	TBCSPDCP405L S1
		        	WHERE	S1.REQ_DVSN_CD = D5.REQ_DVSN_CD
		        	AND		S1.ACP_YR = D5.ACP_YR
		        	AND		S1.CVPT_ACP_NO = D5.CVPT_ACP_NO
		        	AND		S1.DGE = D5.DGE
		        ) AS DSP_RQ_KND_CD
		        , (SELECT	AGGR_CONCAT(F_ORG_INFO(S1.ORG_CD,'1'),',') AS DSP_ORG_NM
		        	FROM	TBCSPDCP206L S1
		        	WHERE	S1.REQ_DVSN_CD = D1.REQ_DVSN_CD
		        	AND		S1.ACP_YR = D1.ACP_YR
		        	AND		S1.CVPT_ACP_NO = D1.CVPT_ACP_NO
		        	AND		S1.ORG_HIS_DVSN_CD = '2' ) AS DSP_ORG_NM
		        , TO_CHAR(D2.ONR_APV_CMPT_DH,'YYYY-MM-DD') AS ONR_APV_CMPT_DH 
		  FROM TBCSPDCP101M D1
		  	   , TBCSPDCP301M D2
 			   , TBCSPDCP302M D3
 			   , TBDCMACM103L D4
 			   , TBCSPDCP401H D5
 			   , TBCSPDCP402L D6
 			   , TBCSPDCP205L D7
 			   ,(	SELECT	Z.REQ_DVSN_CD, Z.ACP_YR, Z.CVPT_ACP_NO
								,CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(ORG_CD,'1') 
								ELSE Z.ORG_NM END AS ORG_NM
								, CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_HRK_NM(COPT_SG_CD)
								ELSE NULL END AS COPT_SG_NM
   						FROM	TBCSPDCP206L Z
   						WHERE	Z.REQ_DVSN_CD = #REQ_DVSN_CD#
   						AND		Z.ACP_YR = #ACP_YR#
   						AND		Z.CVPT_ACP_NO = #CVPT_ACP_NO#
   						AND		Z.ORG_HIS_DVSN_CD ='1'
   						AND		Z.HNDL_ORG_SRNO = (SELECT	MIN(S1.HNDL_ORG_SRNO)
   													FROM	TBCSPDCP206L S1
   													WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
							   						AND		S1.ACP_YR = #ACP_YR#
							   						AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#
							   						AND		S1.ORG_HIS_DVSN_CD ='1'
							   						)
   					) Z
   			, (SELECT	#REQ_DVSN_CD# REQ_DVSN_CD, #ACP_YR# ACP_YR, #CVPT_ACP_NO# CVPT_ACP_NO, COUNT(*) AS SUC_CNT
						FROM	TBCSPDCP105L S1 
						WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
						AND		S1.ACP_YR = #ACP_YR#
						AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#
						) H
		 WHERE 1=1
		   AND D1.REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND D1.ACP_YR      = #ACP_YR#
		   AND D1.CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD(+)
		   AND D1.ACP_YR = D2.ACP_YR(+)
		   AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO(+)
		   AND D2.DGE(+) = #DGE#
		   AND D2.CVPT_IFM_DVSN_CD(+) = 'D'
		   AND D2.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
		   AND D2.ACP_YR = D3.ACP_YR(+)
		   AND D2.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
		   AND D2.CVPT_OPM_SRNO = D3.CVPT_OPM_SRNO(+)
		   AND D2.ONR_DOC_MNG_CRD_ID = D4.ONR_DOC_MNG_CRD_ID(+)
		   AND D1.REQ_DVSN_CD = D5.REQ_DVSN_CD(+)
		   AND D1.ACP_YR = D5.ACP_YR(+)
		   AND D1.CVPT_ACP_NO = D5.CVPT_ACP_NO(+)
		   AND D5.DGE(+) = #DGE#
		   AND D5.REQ_DVSN_CD = D6.REQ_DVSN_CD(+)
		   AND D5.ACP_YR = D6.ACP_YR(+)
		   AND D5.CVPT_ACP_NO = D6.CVPT_ACP_NO(+)
		   AND D5.DGE = D6.DGE(+)
		   AND D1.REQ_DVSN_CD = D7.REQ_DVSN_CD
		   AND D1.ACP_YR = D7.ACP_YR
		   AND D1.CVPT_ACP_NO = D7.CVPT_ACP_NO
		   AND D7.SRNO = #SRNO#
		   AND D1.REQ_DVSN_CD = Z.REQ_DVSN_CD(+)
		   AND D1.ACP_YR = Z.ACP_YR(+)
		   AND D1.CVPT_ACP_NO = Z.CVPT_ACP_NO(+)
		   AND		D1.REQ_DVSN_CD = H.REQ_DVSN_CD(+)
		   AND		D1.ACP_YR = H.ACP_YR(+)
		   AND		D1.CVPT_ACP_NO = H.CVPT_ACP_NO(+)
		]]>
		
	</select>
	
	<insert id="CSPDCP514P203Merge" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,'B1' AS CVPT_DOC_DVSN_CD
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        				AND A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #B1_CVPT_DOC_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,'B1'
		        					,#B1_CVPT_DOC_TXT#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP514P203Merge2" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,'B2' AS CVPT_DOC_DVSN_CD
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        				AND A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #B2_CVPT_DOC_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,'B2'
		        					,#B2_CVPT_DOC_TXT#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP514P203Merge3" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,'B3' AS CVPT_DOC_DVSN_CD
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        				AND A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #B3_CVPT_DOC_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,'B3'
		        					,#B3_CVPT_DOC_TXT#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP514P203Merge4" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,'B4' AS CVPT_DOC_DVSN_CD
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        				AND A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #B4_CVPT_DOC_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,'B4'
		        					,#B4_CVPT_DOC_TXT#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	
	
	<!-- 처리전 온나라 결재시 시행문 테이블 Merge -->
	<insert id="CSPDCP514POnr301Merge" parameterClass="paramMap">
		<![CDATA[
			MERGE INTO 	TBCSPDCP301M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_OPM_SRNO# AS CVPT_OPM_SRNO
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        				AND A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_OPM_APV_HNDL_STA_CD = '10'
        					,ADMN_INF_HNDL_NO = #ADMN_INF_HNDL_NO#
        					,ONR_DOC_MNG_CRD_ID = #ONR_DOC_MNG_CRD_ID#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
				INSERT 	(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_OPM_SRNO
							,DGE
							,CVPT_IFM_DVSN_CD
	       					,CVPT_OPM_APV_HNDL_STA_CD
	       					,ADMN_INF_HNDL_NO
	       					,ONR_DOC_MNG_CRD_ID
	       					,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
	       		VALUES	(	#REQ_DVSN_CD#
							,#ACP_YR#
							,#CVPT_ACP_NO#
							,#CVPT_OPM_SRNO#
							,#DGE#
							,'D'
	       					,'10'
	       					,#ADMN_INF_HNDL_NO#
	       					,#ONR_DOC_MNG_CRD_ID#
	       					,#FRT_USR_ID#
	       					,#FNL_USR_ID#
	       					,#FNL_DEAL_DPT_CD#
	       					,#FNL_MNU_ID#
	       					,SYSDATE
	       					,SYSDATE
	       				)
		]]>
	</insert>
	
	
	<insert id="CSPDCP514POnr302Merge" parameterClass="paramMap">
		<![CDATA[
			MERGE INTO 	TBCSPDCP302M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_OPM_SRNO# AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		OPM_TXT = #OPM_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
				INSERT 	(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_OPM_SRNO
	       					,OPM_TXT
	       					,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
		       				)
		       		VALUES	(	#REQ_DVSN_CD#
								,#ACP_YR#
								,#CVPT_ACP_NO#
								,#CVPT_OPM_SRNO#
								,#OPM_TXT#
		       					,#FRT_USR_ID#
		       					,#FNL_USR_ID#
		       					,#FNL_DEAL_DPT_CD#
		       					,#FNL_MNU_ID#
		       					,SYSDATE
		       					,SYSDATE
		       				)
		]]>
	</insert>
</sqlMap> 
