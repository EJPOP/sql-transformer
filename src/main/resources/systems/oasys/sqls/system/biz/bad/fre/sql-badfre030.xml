<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="bad/fre/030">
	
	<!-- 감사결과 처분요구 등 미집행현황 포틀릿 연결팝업 (국)-->
	<select id="BADFRE030PMainList" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
SELECT CASE WHEN D.TMP_ID = '1' THEN '기한내'
            WHEN D.TMP_ID = '2' THEN '기한경과'
            WHEN D.TMP_ID = '3' THEN '집중관리'
            WHEN D.TMP_ID = '4' THEN '이행회보미처리'
            END AS GUBUN          
            
      ,CASE WHEN D.TMP_ID = '1' THEN SUM(D1.IN_TERM)
            WHEN D.TMP_ID = '2' THEN SUM(D1.OUT_TERM)
            WHEN D.TMP_ID = '3' THEN SUM(D1.HRA_CNT)
            WHEN D.TMP_ID = '4' THEN SUM(D1.OVER_CNT)
            END AS TOT      
      ,CASE WHEN D.TMP_ID = '1' THEN SUM(CASE WHEN D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN SUM(CASE WHEN D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN SUM(CASE WHEN D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN SUM(CASE WHEN D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS TOT1
      ,CASE WHEN D.TMP_ID = '1' THEN SUM(CASE WHEN D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN SUM(CASE WHEN D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN SUM(CASE WHEN D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN SUM(CASE WHEN D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS TOT2            
            
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '010000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '010000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '010000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '010000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "1_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '010000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '010000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '010000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '010000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "1_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '020000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '020000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '020000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '020000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "2_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '020000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '020000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '020000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '020000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "2_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '030000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '030000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '030000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '030000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "3_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '030000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '030000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '030000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '030000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "3_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '040000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '040000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '040000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '040000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "4_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '040000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '040000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '040000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '040000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "4_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '050000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '050000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '050000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '050000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "5_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '050000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '050000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '050000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '050000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "5_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '060000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '060000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '060000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '060000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "6_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '060000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '060000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '060000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '060000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "6_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '070000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '070000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '070000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '070000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "7_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '070000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '070000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '070000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '070000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "7_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '080000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '080000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '080000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '080000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "8_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '080000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '080000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '080000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '080000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "8_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '090000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '090000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '090000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '090000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "9_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '090000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '090000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '090000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '090000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "9_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A0000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A0000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A0000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A0000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "A_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A0000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A0000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A0000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A0000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "A_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0D0000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0D0000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0D0000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0D0000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "D_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0D0000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0D0000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0D0000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0D0000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "D_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0E0000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0E0000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0E0000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0E0000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "E_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0E0000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0E0000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0E0000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0E0000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "E_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0G0000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0G0000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0G0000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0G0000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "G_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0G0000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0G0000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0G0000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0G0000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "G_2"
            
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0H0000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0H0000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0H0000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0H0000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "H_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0H0000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0H0000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0H0000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0H0000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "H_2"
            
       /* 지방행정감사1국 추가 - 2016.02.03 yyh */     
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '061000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '061000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '061000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '061000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "I_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '061000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '061000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '061000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '061000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "I_2"
          
       /* 지방행정감사2국 추가 - 2016.02.03 yyh */     
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '062000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '062000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '062000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '062000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "J_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '062000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '062000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '062000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '062000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "J_2"          
            
       /* 민원조사단 추가 - 2016.02.03 yyh */     
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '071000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '071000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '071000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '071000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "K_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '071000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '071000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '071000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '071000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "K_2"    
            
       /* SOC시설안전감사단 추가 - 2016.02.03 yyh */     
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A1000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A1000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A1000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A1000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "L_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A1000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A1000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A1000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0A1000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "L_2"    
            
       /* 방산비리특별감사단 추가 - 2016.02.03 yyh */     
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0I0000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0I0000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0I0000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0I0000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "M_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0I0000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0I0000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0I0000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '0I0000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "M_2"
            
       /* 감사청구조사단 추가 - 2017.04.20 yyh */     
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '081000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '081000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '081000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '081000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "N_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '081000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '081000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '081000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '081000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "N_2"      
            
       /* 공공감사운영단 추가 - 2017.04.20 yyh */     
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '180000' AND D1.GROUP_FLAG = 1 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '180000' AND D1.GROUP_FLAG = 1 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '180000' AND D1.GROUP_FLAG = 1 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '180000' AND D1.GROUP_FLAG = 1 THEN D1.OVER_CNT ELSE 0 END)
            END AS "O_1"
      ,CASE WHEN D.TMP_ID = '1' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '180000' AND D1.GROUP_FLAG = 2 THEN D1.IN_TERM ELSE 0 END)
            WHEN D.TMP_ID = '2' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '180000' AND D1.GROUP_FLAG = 2 THEN D1.OUT_TERM ELSE 0 END)
            WHEN D.TMP_ID = '3' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '180000' AND D1.GROUP_FLAG = 2 THEN D1.HRA_CNT ELSE 0 END)
            WHEN D.TMP_ID = '4' THEN MAX(CASE WHEN D1.ENFM_MNG_BRDV_CD = '180000' AND D1.GROUP_FLAG = 2 THEN D1.OVER_CNT ELSE 0 END)
            END AS "O_2"                                       
  FROM
  (
        SELECT LEVEL AS TMP_ID
          FROM DUAL
          CONNECT BY LEVEL <= 4
  ) D
 ,(
        SELECT SUBSTR(E.ENFM_MNG_BRDV_CD,0,3)||'000' AS ENFM_MNG_BRDV_CD
             , 1 AS GROUP_FLAG
             , SUM(
                   CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') <= NVL(E.HNDL_DDLN_DT, '99991231') THEN 1
                        ELSE 0
                    END ) AS IN_TERM		/* 처분요구 기한내 */
             , SUM(
                   CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') > NVL(E.HNDL_DDLN_DT, '99991231') THEN 1
                        ELSE 0
                    END ) AS OUT_TERM		/* 처분요구 기한외 */
             /*, SUM(
                   CASE WHEN NVL(E.HRK_MNG_ASG_YN, 'N') = 'Y' THEN 1
                        ELSE 0
                    END ) AS HRA_CNT		 처분요구 HBA */
             
              /* HRA 삭제, 집중관리 추가 - 2016.06.29 yyh*/
			   , SUM(
                   CASE WHEN E.NOT_CPLT_STA_DVSN_CD = '2' THEN 1
                        ELSE 0
                    END ) AS HRA_CNT		 /* 처분요구 집중관리 */
                                        
             , SUM(NVL(F.TMP_CNT, 0))AS OVER_CNT      /* 처분요구 집행회보접수 */
          FROM TBBADEAR001M D
             , TBBADEAR002D E
		     , (
		       SELECT   1 AS TMP_CNT
		              , S1.AUD_YR
		              , S1.AUD_NO
		              , S1.DSP_RQ_SNO
		         FROM TBBADFRE001H S1
		        WHERE 1 = 1
		          AND S1.BAI_CHGD_ACP_DT IS NULL
		        GROUP BY S1.AUD_YR
		               , S1.AUD_NO
		               , S1.DSP_RQ_SNO
		       ) F
         WHERE 1=1
           AND D.AUD_YR                 = E.AUD_YR(+)
           AND D.AUD_NO                 = E.AUD_NO(+) 
           AND D.DSP_RQ_SNO             = E.DSP_RQ_SNO(+)
           AND D.AUD_YR                 = F.AUD_YR(+)
           AND D.AUD_NO                 = F.AUD_NO(+)
           AND D.DSP_RQ_SNO             = F.DSP_RQ_SNO(+)
           AND E.DTM_STA_CD = '1'  
           AND D.DSP_RQ_KND_CD IN ('110', '210', '310', '320', '391', '800', '810', '820', '830', '840', '850')
           AND E.ENFM_MNG_BRDV_CD IN (SELECT DPT_CD FROM TBDCMACM002M WHERE USE_YN = 'Y' AND ORZT_DVSN_CD = '30')
           GROUP BY SUBSTR(E.ENFM_MNG_BRDV_CD,0,3)||'000'
UNION ALL
        SELECT SUBSTR(E.ENFM_MNG_BRDV_CD,0,3)||'000' AS ENFM_MNG_BRDV_CD
             , 2 AS GROUP_FLAG
             , SUM(
                   CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') <= NVL(E.HNDL_DDLN_DT, '99991231') THEN 1
                        ELSE 0
                    END ) AS IN_TERM		/* 처분요구 기한내 */
             , SUM(
                   CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') > NVL(E.HNDL_DDLN_DT, '99991231') THEN 1
                        ELSE 0
                    END ) AS OUT_TERM		/* 처분요구 기한외 */
             /*, SUM(
                   CASE WHEN NVL(E.HRK_MNG_ASG_YN, 'N') = 'Y' THEN 1
                        ELSE 0
                    END ) AS HRA_CNT		 처분요구 HBA */
                    
              /* HRA 삭제, 집중관리 추가 - 2016.06.29 yyh*/
			   , SUM(
                   CASE WHEN E.NOT_CPLT_STA_DVSN_CD = '2' THEN 1
                        ELSE 0
                    END ) AS HRA_CNT		 /* 처분요구 집중관리 */                    
                    
             , SUM(NVL(F.TMP_CNT, 0))AS OVER_CNT      /* 처분요구 집행회보접수 */
          FROM TBBADEAR001M D
             , TBBADEAR002D E
		     , (
		       SELECT   1 AS TMP_CNT
		              , S1.AUD_YR
		              , S1.AUD_NO
		              , S1.DSP_RQ_SNO
		         FROM TBBADFRE001H S1
		        WHERE 1 = 1
		          AND S1.BAI_CHGD_ACP_DT IS NULL
		        GROUP BY S1.AUD_YR
		               , S1.AUD_NO
		               , S1.DSP_RQ_SNO
		       ) F
         WHERE 1=1
           AND D.AUD_YR                 = E.AUD_YR(+)
           AND D.AUD_NO                 = E.AUD_NO(+) 
           AND D.DSP_RQ_SNO             = E.DSP_RQ_SNO(+)
           AND D.AUD_YR                 = F.AUD_YR(+)
           AND D.AUD_NO                 = F.AUD_NO(+)
           AND D.DSP_RQ_SNO             = F.DSP_RQ_SNO(+)
           AND E.DTM_STA_CD = '1'  
           AND D.DSP_RQ_KND_CD IN ('510','520','530','610','611', '620', '621', '623', '630')
           AND E.ENFM_MNG_BRDV_CD IN (SELECT DPT_CD FROM TBDCMACM002M WHERE USE_YN = 'Y' AND ORZT_DVSN_CD = '30')
           GROUP BY SUBSTR(E.ENFM_MNG_BRDV_CD,0,3)||'000'
) D1
GROUP BY D.TMP_ID
ORDER BY D.TMP_ID
	]]>
	</select>
	
	<!-- 감사결과 처분요구 등 미집행현황 포틀릿 연결팝업 (국)_ BACKUP-->
	<select id="BADFRE030PMainList_BAK" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
SELECT F_DPT_INFO(D1.ENFM_MNG_BRDV_CD, '1') AS ORG_NM
     , D1.GROUP_FLAG
     , D1.IN_TERM
     , D1.OUT_TERM
     , D1.HRA_CNT
     , D1.OVER_CNT
     , D1.ENFM_MNG_BRDV_CD
  FROM (
        SELECT SUBSTR(E.ENFM_MNG_BRDV_CD,0,3)||'000' AS ENFM_MNG_BRDV_CD
             , '처분요구' AS GROUP_FLAG
             , SUM(
                   CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') <= NVL(E.HNDL_DDLN_DT, '99991231') THEN 1
                        ELSE 0
                    END ) AS IN_TERM		/* 처분요구 기한내 */
             , SUM(
                   CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') > NVL(E.HNDL_DDLN_DT, '99991231') THEN 1
                        ELSE 0
                    END ) AS OUT_TERM		/* 처분요구 기한외 */
             /*, SUM(
                   CASE WHEN NVL(E.HRK_MNG_ASG_YN, 'N') = 'Y' THEN 1
                        ELSE 0
                    END ) AS HRA_CNT		 처분요구 HBA */
                    
              /* HRA 삭제, 집중관리 추가 - 2016.06.29 yyh*/
			   , SUM(
                   CASE WHEN E.NOT_CPLT_STA_DVSN_CD = '2' THEN 1
                        ELSE 0
                    END ) AS HRA_CNT		 /* 처분요구 집중관리 */                    
                    
             , SUM(NVL(F.TMP_CNT, 0))AS OVER_CNT      /* 처분요구 집행회보접수 */
          FROM TBBADEAR001M D
             , TBBADEAR002D E
             , (
               SELECT COUNT(1) AS TMP_CNT
                    , S1.AUD_YR
                    , S1.AUD_NO
                    , S1.DSP_RQ_SNO
                 FROM TBBADFRE001H S1
                WHERE 1 = 1
                  AND S1.ENFM_WHLS_APV_STA_CD <> '3'
             GROUP BY S1.AUD_YR
                    , S1.AUD_NO
                    , S1.DSP_RQ_SNO
             ) F
         WHERE 1=1
           AND D.AUD_YR                 = E.AUD_YR(+)
           AND D.AUD_NO                 = E.AUD_NO(+) 
           AND D.DSP_RQ_SNO             = E.DSP_RQ_SNO(+)
           AND D.AUD_YR                 = F.AUD_YR(+)
           AND D.AUD_NO                 = F.AUD_NO(+)
           AND D.DSP_RQ_SNO             = F.DSP_RQ_SNO(+)
           AND E.DTM_STA_CD = '1'  
           AND E.DSP_RQ_APV_STA_CD <> '3'
           AND D.DSP_RQ_KND_CD IN ('110', '210', '310', '320', '391', '800', '810', '820', '830', '840', '850')
           AND E.ENFM_MNG_BRDV_CD IN (SELECT DPT_CD FROM TBDCMACM002M WHERE USE_YN = 'Y' AND ORZT_DVSN_CD = '30' AND DPT_CD LIKE '0%')
GROUP BY SUBSTR(E.ENFM_MNG_BRDV_CD,0,3)||'000'
UNION ALL
        SELECT SUBSTR(E.ENFM_MNG_BRDV_CD,0,3)||'000' AS ENFM_MNG_BRDV_CD
             , '권고.통보' AS GROUP_FLAG
             , SUM(
                   CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') <= NVL(E.HNDL_DDLN_DT, '99991231') THEN 1
                        ELSE 0
                    END ) AS IN_TERM		/* 처분요구 기한내 */
             , SUM(
                   CASE WHEN TO_CHAR(SYSDATE, 'YYYYMMDD') > NVL(E.HNDL_DDLN_DT, '99991231') THEN 1
                        ELSE 0
                    END ) AS OUT_TERM		/* 처분요구 기한외 */
             /*, SUM(
                   CASE WHEN NVL(E.HRK_MNG_ASG_YN, 'N') = 'Y' THEN 1
                        ELSE 0
                    END ) AS HRA_CNT		 처분요구 HBA */
                    
              /* HRA 삭제, 집중관리 추가 - 2016.06.29 yyh*/
			   , SUM(
                   CASE WHEN E.NOT_CPLT_STA_DVSN_CD = '2' THEN 1
                        ELSE 0
                    END ) AS HRA_CNT		 /* 처분요구 집중관리 */                    
                    
             , SUM(NVL(F.TMP_CNT, 0))AS OVER_CNT      /* 처분요구 집행회보접수 */
          FROM TBBADEAR001M D
             , TBBADEAR002D E
             , (
               SELECT COUNT(1) AS TMP_CNT
                    , S1.AUD_YR
                    , S1.AUD_NO
                    , S1.DSP_RQ_SNO
                 FROM TBBADFRE001H S1
                WHERE 1 = 1
                  AND S1.ENFM_WHLS_APV_STA_CD <> '3'
             GROUP BY S1.AUD_YR
                    , S1.AUD_NO
                    , S1.DSP_RQ_SNO
             ) F
         WHERE 1=1
           AND D.AUD_YR                 = E.AUD_YR(+)
           AND D.AUD_NO                 = E.AUD_NO(+) 
           AND D.DSP_RQ_SNO             = E.DSP_RQ_SNO(+)
           AND D.AUD_YR                 = F.AUD_YR(+)
           AND D.AUD_NO                 = F.AUD_NO(+)
           AND D.DSP_RQ_SNO             = F.DSP_RQ_SNO(+)
           AND E.DTM_STA_CD = '1'  
           AND E.DSP_RQ_APV_STA_CD <> '3'
           AND D.DSP_RQ_KND_CD IN ('510','520','530','610','611', '620', '621', '623', '630')
           AND E.ENFM_MNG_BRDV_CD IN (SELECT DPT_CD FROM TBDCMACM002M WHERE USE_YN = 'Y' AND ORZT_DVSN_CD = '30' AND DPT_CD LIKE '0%')
GROUP BY SUBSTR(E.ENFM_MNG_BRDV_CD,0,3)||'000'
) D1
ORDER BY D1.ENFM_MNG_BRDV_CD
       , D1.GROUP_FLAG DESC
	]]>
	</select>
	
</sqlMap> 
