<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/lfi/251">
	
	<select id="CSPLFI251QMainSelect" parameterClass="paramMap" resultClass="resultMap">
	/*sql-csplfi251.xml/csp/lfi/251/CSPLFI251QMainSelect*/
		<![CDATA[
			SELECT 	A.USR_NAM,
			 		A.CNB, 
			 		A.DPT_CD, 
			 		B.DPT_NM,
			 		F_CODE_NM('1000176', A.PST_CD) AS PST_NM, /* 직위 */
			 		F_CODE_NM('1000173', A.RANK_CD) AS RANK_NM, /* 직급 */
			 		F_CODE_NM('1000177', A.PS_CD) AS PS_NM,
			 		F_CODE_NM('1000173', A.RANK_CD) || ' - ' ||F_CODE_NM('1000177', A.PS_CD) AS RANK_PS_NM,
			        DECODE(A.RCDB_PBSVT_YN,'Y','부여','미부여') AS RCDB_PBSVT_YN,
			        DECODE(A.BRGA_YN,'Y','부여','미부여') AS BRGA_YN
			  FROM 	TBDCMACM001M A,
			  		TBDCMACM002M B
			 WHERE 	1=1
			   AND 	A.DPT_CD = B.DPT_CD
		]]>
			<isNotEmpty property="dptCd">	 	   
			   AND A.DPT_CD = #dptCd#
			</isNotEmpty>
			<isNotEmpty property="cnb">	 	   
			   AND A.CNB = #cnb#
			</isNotEmpty>	
			<isNotEmpty property="authDvsnCd">	 
				<isEqual property="authDvsnCd" compareValue="01">
					AND A.RCDB_PBSVT_YN = 'Y'
				</isEqual>
				<isEqual property="authDvsnCd" compareValue="02">
					AND A.BRGA_YN = 'Y'
				</isEqual>
			</isNotEmpty>	
	</select>
	
	<select id="CSPLFI251EUserInfoSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT 	A.USR_NAM,
			 		A.CNB, 
			 		A.DPT_CD, 
			 		B.DPT_NM,
			 		F_CODE_NM('1000176', A.PST_CD) AS PST_NM, /* 직위 */
			 		F_CODE_NM('1000173', A.RANK_CD) AS RANK_NM, /* 직급 */
			 		F_CODE_NM('1000177', A.PS_CD) AS PS_NM,
			 		F_CODE_NM('1000173', A.RANK_CD) || ' - ' ||F_CODE_NM('1000177', A.PS_CD) AS RANK_PS_NM,
			 		NVL(A.RCDB_PBSVT_YN,'N') AS RCDB_PBSVT_YN,
			        NVL(A.BRGA_YN,'N') AS BRGA_YN
			  FROM 	TBDCMACM001M A,
			  		TBDCMACM002M B
			 WHERE 	1=1
			   AND 	A.DPT_CD = B.DPT_CD
			   AND	A.CNB = #cnb#
		]]>
	</select>
	
	<update id="CSPLFI251EAlwUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE TBDCMACM001M
			   SET RCDB_PBSVT_YN = #rcdbPbsvtYn#
			   , BRGA_YN = #brgaYn#
			 WHERE CNB = #cnb# 
		]]>	
	</update>
	
	<delete id="CSPLFI251QUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE TBDCMACM001M
			   SET RCDB_PBSVT_YN = 'N'
			   , BRGA_YN = 'N'
			 WHERE CNB = #CNB#
			   AND DPT_CD = #DPT_CD#
		]]>
	</delete>
	
</sqlMap> 