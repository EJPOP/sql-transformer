<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/076">

	<resultMap id="enaisRecvHwDataVO" class="org.ebai.iportal.enais.vo.EnaisRecvHwDataVO">
		<result property="accmnId" column="ACCMN_ID"/>
		<result property="offcNm" column="OFFC_NM"/>
		<result property="fsclNm" column="FSCL_NM"/>
		<result property="chckNm" column="CHCK_NM"/>
		<result property="period" column="PERIOD"/>
		<result property="mon1" column="MN_1_STA_CD"/>
		<result property="mon2" column="MN_2_STA_CD"/>
		<result property="mon3" column="MN_3_STA_CD"/>
		<result property="mon4" column="MN_4_STA_CD"/>
		<result property="mon5" column="MN_5_STA_CD"/>
		<result property="mon6" column="MN_6_STA_CD"/>
		<result property="mon7" column="MN_7_STA_CD"/>
		<result property="mon8" column="MN_8_STA_CD"/>
		<result property="mon9" column="MN_9_STA_CD"/>
		<result property="mon10" column="MN_1_0_STA_CD"/>
		<result property="mon11" column="MN_1_1_STA_CD"/>
		<result property="mon12" column="MN_1_2_STA_CD"/>
		<result property="mon13" column="MN_1_3_STA_CD"/>
	</resultMap>
	
	<resultMap id="enaisExtYhDataVO" class="org.ebai.iportal.enais.vo.EnaisExtYhDataVO">
		<result property="accmnId" column="ACCMN_ID"/>
		<result property="orgNm" column="ORG_NM"/>
		<result property="fsclNm" column="FSCL_NM"/>
		<result property="chckNm" column="CHCK_NM"/>
		<result property="mdfPenNm" column="MDF_PEN_NM"/>
		<result property="pstNm" column="PST_NM"/>
		<result property="mon1" column="MN_1_STA_CD"/>
		<result property="mon2" column="MN_2_STA_CD"/>
		<result property="mon3" column="MN_3_STA_CD"/>
		<result property="mon4" column="MN_4_STA_CD"/>
		<result property="mon5" column="MN_5_STA_CD"/>
		<result property="mon6" column="MN_6_STA_CD"/>
		<result property="mon7" column="MN_7_STA_CD"/>
		<result property="mon8" column="MN_8_STA_CD"/>
		<result property="mon9" column="MN_9_STA_CD"/>
		<result property="mon10" column="MN_1_0_STA_CD"/>
		<result property="mon11" column="MN_1_1_STA_CD"/>
		<result property="mon12" column="MN_1_2_STA_CD"/>
		<result property="mon13" column="MN_1_3_STA_CD"/>
	</resultMap>
	
	<resultMap id="enaisMnsumDataVO" class="org.ebai.iportal.enais.vo.EnaisMnsumDataVO">
		<result property="mnsumYm" column="MNSUM_YM"/>
		<result property="mnsumDvsnCdNm" column="MNSUM_DVSN_CD_NM"/>
		<result property="acpDh" column="ACP_DH"/>
	</resultMap>
	
	<resultMap id="enaisRcptHstDataVO" class="org.ebai.iportal.enais.vo.EnaisRcptHstDataVO">
		<result property="rcptDh" column="RCPT_DH"/>
		<result property="rcptStaCdNm" column="RCPT_STA_CD_NM"/>
		<result property="acpErrCd" column="ACP_ERR_CD"/>
	</resultMap>
    
    <!--접수현황조회 전체 카운트-->
    <select id="FAACAV076EMainselectHwTotCnt" parameterClass="paramMap" resultClass="int">
    	<![CDATA[  /* faa/cav/076/FAACAV076EMainselectHwTotCnt */ ]]>
    <![CDATA[
		SELECT	COUNT(D1.COPT_CD) AS CNT
		FROM	TWFAACAV007M D1
				, ( 
					SELECT	WS1.ACNT_CD AS BLL_CD
							, SUBSTR(WS1.RMK_2, 1, 2) AS BLL_GUBUN_CD
					FROM	TWFAACAV024C WS1
					WHERE	WS1.ACNT_DVSN_CD = '03'
				) D2
		WHERE	D1.BLL_CD = D2.BLL_CD
		AND		D1.PROF_YR = #profYr#
		AND		( D1.COPT_CD, D1.ACNT_CD, D1.BLL_CD, D1.PROF_DRTR_SRNO, D1.DL_XPN_RCDB_PBSVT_SRNO  ) IN (
					SELECT	WS2.COPT_CD, WS2.ACNT_CD, WS2.BLL_CD, WS2.PROF_DRTR_SRNO, WS2.DL_XPN_RCDB_PBSVT_SRNO
					FROM	TWFAACAV003M WS2
					WHERE	WS2.ORG_CD = #orgCd#
				)
	]]>
		<isNotEmpty property="period">
		AND		D2.BLL_GUBUN_CD = #period#
		</isNotEmpty>
		<isEqual property="expnType" compareValue="1">
		AND		D1.BLL_CD NOT IN ( '41','42','43' )
		</isEqual>
		<isEqual property="expnType" compareValue="2">
		AND		D1.BLL_CD IN ( '41','42','43' )
		</isEqual>
    </select>
    
    <!--접수현황조회-->
    <select id="FAACAV076EMainselectHw" parameterClass="paramMap" resultMap="enaisRecvHwDataVO">
    	<![CDATA[  /* faa/cav/076/FAACAV076EMainselectHw */ ]]>
    <![CDATA[
    	SELECT	Y.COPT_CD || '-' || Y.ACNT_CD || '-' || Y.BLL_CD || '-' || Y.PROF_DRTR_SRNO || '-' || Y.DL_XPN_RCDB_PBSVT_SRNO AS ACCMN_ID
    			, ( SELECT S1.ACNT_CD_NM FROM TWFAACAV024C S1 WHERE S1.ACNT_DVSN_CD = '02' AND S1.ACNT_CD = Y.COPT_CD ) AS OFFC_NM
				, ( SELECT S1.ACNT_CD_NM FROM TWFAACAV024C S1 WHERE S1.ACNT_DVSN_CD = '01' AND S1.ACNT_CD = Y.ACNT_CD ) AS FSCL_NM
				, F_AV_BLL_CD_NM( Y.BLL_CD, Y.DL_XPN_RCDB_PBSVT_SRNO ) AS CHCK_NM
				, BLL_GUBUN_CD AS PERIOD
				, DECODE( Y.MN_1_STA_CD, '*', Y.MN_1_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || DECODE( Y.BLL_GUBUN_CD, '05', '00', '01' )
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_STA_CD
				, DECODE( Y.MN_2_STA_CD, '*', Y.MN_2_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '02'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_2_STA_CD
				, DECODE( Y.MN_3_STA_CD, '*', Y.MN_3_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '03'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_3_STA_CD
				, DECODE( Y.MN_4_STA_CD, '*', Y.MN_4_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '04'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_4_STA_CD
				, DECODE( Y.MN_5_STA_CD, '*', Y.MN_5_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '05'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_5_STA_CD
				, DECODE( Y.MN_6_STA_CD, '*', Y.MN_6_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '06'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_6_STA_CD
				, DECODE( Y.MN_7_STA_CD, '*', Y.MN_7_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '07'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_7_STA_CD
				, DECODE( Y.MN_8_STA_CD, '*', Y.MN_8_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '08'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_8_STA_CD
				, DECODE( Y.MN_9_STA_CD, '*', Y.MN_9_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '09'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_9_STA_CD
				, DECODE( Y.MN_1_0_STA_CD, '*', Y.MN_1_0_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '10'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_0_STA_CD
				, DECODE( Y.MN_1_1_STA_CD, '*', Y.MN_1_1_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '11'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_1_STA_CD
				, DECODE( Y.MN_1_2_STA_CD, '*', Y.MN_1_2_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '12'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_2_STA_CD
				, DECODE( Y.MN_1_3_STA_CD, '*', Y.MN_1_3_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '13'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_3_STA_CD
		FROM	(
					SELECT	ROWNUM AS RN
							, D3.*
					FROM	(
								SELECT	D1.COPT_CD
										, D1.ACNT_CD
										, D1.BLL_CD
										, D1.PROF_DRTR_SRNO
										, D1.DL_XPN_RCDB_PBSVT_SRNO
										, D1.PROF_YR
										, D1.MN_1_STA_CD
										, D1.MN_2_STA_CD
										, D1.MN_3_STA_CD
										, D1.MN_4_STA_CD
										, D1.MN_5_STA_CD
										, D1.MN_6_STA_CD
										, D1.MN_7_STA_CD
										, D1.MN_8_STA_CD
										, D1.MN_9_STA_CD
										, D1.MN_1_0_STA_CD
										, D1.MN_1_1_STA_CD
										, D1.MN_1_2_STA_CD
										, D1.MN_1_3_STA_CD
										, D2.BLL_GUBUN_CD
								FROM	TWFAACAV007M D1
										, ( 
											SELECT	WS1.ACNT_CD AS BLL_CD
													, SUBSTR(WS1.RMK_2, 1, 2) AS BLL_GUBUN_CD
											FROM	TWFAACAV024C WS1
											WHERE	WS1.ACNT_DVSN_CD = '03'
										) D2
								WHERE	D1.BLL_CD = D2.BLL_CD
								AND		D1.PROF_YR = #profYr#
								AND		( D1.COPT_CD, D1.ACNT_CD, D1.BLL_CD, D1.PROF_DRTR_SRNO, D1.DL_XPN_RCDB_PBSVT_SRNO  ) IN (
											SELECT	WS2.COPT_CD, WS2.ACNT_CD, WS2.BLL_CD, WS2.PROF_DRTR_SRNO, WS2.DL_XPN_RCDB_PBSVT_SRNO
											FROM	TWFAACAV003M WS2
											WHERE	WS2.ORG_CD = #orgCd#
										)
	]]>
		<isNotEmpty property="period">
								AND		D2.BLL_GUBUN_CD = #period#
		</isNotEmpty>
		<isEqual property="expnType" compareValue="1">
								AND		D1.BLL_CD NOT IN ( '41','42','43' )
		</isEqual>
		<isEqual property="expnType" compareValue="2">
								AND		D1.BLL_CD IN ( '41','42','43' )
		</isEqual>
	<![CDATA[
								ORDER BY PROF_YR, COPT_CD, ACNT_CD, BLL_CD, PROF_DRTR_SRNO, DL_XPN_RCDB_PBSVT_SRNO
							) D3
				) Y
		WHERE	Y.RN BETWEEN ( #pageNo# - 1 ) * #pageSize# + 1 AND ( #pageNo# * #pageSize# )    
    ]]>
    </select>
    
    <!-- 예하접수현황조회 전체 카운트 -->
    <select id="FAACAV076EMainselectYhTotCnt" parameterClass="paramMap" resultClass="int">
    	<![CDATA[  /* faa/cav/076/FAACAV076EMainselectYhTotCnt */ ]]>
    <![CDATA[
    	SELECT	COUNT(D1.COPT_CD) AS CNT
		FROM	TWFAACAV007M D1
		WHERE	D1.PROF_YR = #profYr#
		AND		D1.COPT_CD = ( SELECT COPT_SG_CD FROM   TBDCMACM015M WHERE ORG_CD = #orgCd# )
	]]>
	<isEqual property="bllCdType" compareValue="99">
		AND		D1.BLL_CD = #bllCd#
		AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
	</isEqual>
	<isNotEqual property="bllCdType" compareValue="99">
		<isEqual property="bllCd" compareValue="17">
		AND		D1.BLL_CD IN ( '17', '18' )
		AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="18">
		AND		D1.BLL_CD IN ( '17', '18' )
		AND		D1.DL_XPN_RCDB_PBSVT_SRNO != '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="19">
		AND		D1.BLL_CD = '19'
		AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="25">
		AND		D1.BLL_CD = '19'
		AND		D1.DL_XPN_RCDB_PBSVT_SRNO != '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="22">
		AND		D1.BLL_CD IN ( '22', '23', '24' )
		AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="42">
		AND		D1.BLL_CD IN ( '42', '43' )
		AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
	</isNotEqual>
	<isEqual property="recvYn" compareValue="A">
		<isEqual property="profMm" compareValue="00">
		AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="01">
		AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="02">
		AND		( D1.MN_2_STA_CD NOT IN('*') OR D1.MN_2_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="03">
		AND		( D1.MN_3_STA_CD NOT IN('*') OR D1.MN_3_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="04">
		AND		( D1.MN_4_STA_CD NOT IN('*') OR D1.MN_4_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="05">
		AND		( D1.MN_5_STA_CD NOT IN('*') OR D1.MN_5_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="06">
		AND		( D1.MN_6_STA_CD NOT IN('*') OR D1.MN_6_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="07">
		AND		( D1.MN_7_STA_CD NOT IN('*') OR D1.MN_7_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="08">
		AND		( D1.MN_8_STA_CD NOT IN('*') OR D1.MN_8_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="09">
		AND		( D1.MN_9_STA_CD NOT IN('*') OR D1.MN_9_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="10">
		AND		( D1.MN_1_0_STA_CD NOT IN('*') OR D1.MN_1_0_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="11">
		AND		( D1.MN_1_1_STA_CD NOT IN('*') OR D1.MN_1_1_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="12">
		AND		( D1.MN_1_2_STA_CD NOT IN('*') OR D1.MN_1_2_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="13">
		AND		( D1.MN_1_3_STA_CD NOT IN('*') OR D1.MN_1_3_STA_CD IS NULL )
		</isEqual>
	</isEqual>
	<isEqual property="recvYn" compareValue="Y">
		<isEqual property="profMm" compareValue="00">
		AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="01">
		AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="02">
		AND		( D1.MN_2_STA_CD NOT IN('*') OR D1.MN_2_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="03">
		AND		( D1.MN_3_STA_CD NOT IN('*') OR D1.MN_3_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="04">
		AND		( D1.MN_4_STA_CD NOT IN('*') OR D1.MN_4_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="05">
		AND		( D1.MN_5_STA_CD NOT IN('*') OR D1.MN_5_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="06">
		AND		( D1.MN_6_STA_CD NOT IN('*') OR D1.MN_6_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="07">
		AND		( D1.MN_7_STA_CD NOT IN('*') OR D1.MN_7_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="08">
		AND		( D1.MN_8_STA_CD NOT IN('*') OR D1.MN_8_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="09">
		AND		( D1.MN_9_STA_CD NOT IN('*') OR D1.MN_9_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="10">
		AND		( D1.MN_1_0_STA_CD NOT IN('*') OR D1.MN_1_0_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="11">
		AND		( D1.MN_1_1_STA_CD NOT IN('*') OR D1.MN_1_1_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="12">
		AND		( D1.MN_1_2_STA_CD NOT IN('*') OR D1.MN_1_2_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="13">
		AND		( D1.MN_1_3_STA_CD NOT IN('*') OR D1.MN_1_3_STA_CD IS NOT NULL )
		</isEqual>
	</isEqual>
	<isEqual property="recvYn" compareValue="N">
		<isEqual property="profMm" compareValue="00">
		AND		D1.MN_1_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="01">
		AND		D1.MN_1_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="02">
		AND		D1.MN_2_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="03">
		AND		D1.MN_3_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="04">
		AND		D1.MN_4_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="05">
		AND		D1.MN_5_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="06">
		AND		D1.MN_6_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="07">
		AND		D1.MN_7_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="08">
		AND		D1.MN_8_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="09">
		AND		D1.MN_9_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="10">
		AND		D1.MN_1_0_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="11">
		AND		D1.MN_1_1_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="12">
		AND		D1.MN_1_2_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="13">
		AND		D1.MN_1_3_STA_CD IS NULL
		</isEqual>
	</isEqual>
    </select>
    
    <!-- 예하접수현황조회 -->
    <select id="FAACAV076EMainselectYh" parameterClass="paramMap" resultMap="enaisExtYhDataVO">
    	<![CDATA[  /* faa/cav/076/FAACAV076EMainselectYh */ ]]>
    <![CDATA[
    	SELECT	Y.COPT_CD || '-' || Y.ACNT_CD || '-' || Y.BLL_CD || '-' || Y.PROF_DRTR_SRNO || '-' || Y.DL_XPN_RCDB_PBSVT_SRNO AS ACCMN_ID
				, Y.PROF_YR
				, (
					SELECT 	S1.ORG_NM
					FROM 	TWFAACAV003M S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
				) AS ORG_NM
				, '' AS MDF_PEN_NM
				, '' AS PST_NM
				, ( SELECT S1.ACNT_CD_NM FROM TWFAACAV024C S1 WHERE S1.ACNT_DVSN_CD = '01' AND S1.ACNT_CD = Y.ACNT_CD ) AS FSCL_NM
				, F_AV_BLL_CD_NM( Y.BLL_CD, Y.DL_XPN_RCDB_PBSVT_SRNO ) AS CHCK_NM
				, Y.BLL_GUBUN_CD
				, DECODE( Y.MN_1_STA_CD, '*', Y.MN_1_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || DECODE( Y.BLL_GUBUN_CD, '05', '00', '01' )
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								AND     D2.RCPT_STA_CD IN ('A','W')
								GROUP BY PROF_YM
							)
				)) AS MN_1_STA_CD
				, DECODE( Y.MN_2_STA_CD, '*', Y.MN_2_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '02'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_2_STA_CD
				, DECODE( Y.MN_3_STA_CD, '*', Y.MN_3_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '03'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_3_STA_CD
				, DECODE( Y.MN_4_STA_CD, '*', Y.MN_4_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '04'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_4_STA_CD
				, DECODE( Y.MN_5_STA_CD, '*', Y.MN_5_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '05'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_5_STA_CD
				, DECODE( Y.MN_6_STA_CD, '*', Y.MN_6_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '06'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_6_STA_CD
				, DECODE( Y.MN_7_STA_CD, '*', Y.MN_7_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '07'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_7_STA_CD
				, DECODE( Y.MN_8_STA_CD, '*', Y.MN_8_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '08'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_8_STA_CD
				, DECODE( Y.MN_9_STA_CD, '*', Y.MN_9_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '09'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_9_STA_CD
				, DECODE( Y.MN_1_0_STA_CD, '*', Y.MN_1_0_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '10'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_0_STA_CD
				, DECODE( Y.MN_1_1_STA_CD, '*', Y.MN_1_1_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '11'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_1_STA_CD
				, DECODE( Y.MN_1_2_STA_CD, '*', Y.MN_1_2_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '12'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_2_STA_CD
				, DECODE( Y.MN_1_3_STA_CD, '*', Y.MN_1_3_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '13'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_3_STA_CD
		FROM	(
					SELECT	ROWNUM AS RN
							, D3.*
					FROM	(
								SELECT	D1.COPT_CD
										, D1.ACNT_CD
										, D1.BLL_CD
										, D1.PROF_DRTR_SRNO
										, D1.DL_XPN_RCDB_PBSVT_SRNO
										, D1.PROF_YR
										, D1.MN_1_STA_CD
										, D1.MN_2_STA_CD
										, D1.MN_3_STA_CD
										, D1.MN_4_STA_CD
										, D1.MN_5_STA_CD
										, D1.MN_6_STA_CD
										, D1.MN_7_STA_CD
										, D1.MN_8_STA_CD
										, D1.MN_9_STA_CD
										, D1.MN_1_0_STA_CD
										, D1.MN_1_1_STA_CD
										, D1.MN_1_2_STA_CD
										, D1.MN_1_3_STA_CD
										, D2.BLL_GUBUN_CD
								FROM	TWFAACAV007M D1
										, ( 
											SELECT	WS1.ACNT_CD AS BLL_CD
													, SUBSTR(WS1.RMK_2, 1, 2) AS BLL_GUBUN_CD
											FROM	TWFAACAV024C WS1
											WHERE	WS1.ACNT_DVSN_CD = '03'
										) D2
								WHERE	D1.BLL_CD = D2.BLL_CD
								AND		D1.PROF_YR = #profYr#
								AND		D1.COPT_CD = ( SELECT COPT_SG_CD FROM   TBDCMACM015M WHERE ORG_CD = #orgCd# )
	]]>
	<isEqual property="bllCdType" compareValue="99">
								AND		D1.BLL_CD = #bllCd#
								AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
	</isEqual>
	<isNotEqual property="bllCdType" compareValue="99">
		<isEqual property="bllCd" compareValue="17">
								AND		D1.BLL_CD IN ( '17', '18' )
								AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="18">
								AND		D1.BLL_CD IN ( '17', '18' )
								AND		D1.DL_XPN_RCDB_PBSVT_SRNO != '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="19">
								AND		D1.BLL_CD = '19'
								AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="25">
								AND		D1.BLL_CD = '19'
								AND		D1.DL_XPN_RCDB_PBSVT_SRNO != '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="22">
								AND		D1.BLL_CD IN ( '22', '23', '24' )
								AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="42">
								AND		D1.BLL_CD IN ( '42', '43' )
								AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
	</isNotEqual>
	<isEqual property="recvYn" compareValue="A">
		<isEqual property="profMm" compareValue="00">
								AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="01">
								AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="02">
								AND		( D1.MN_2_STA_CD NOT IN('*') OR D1.MN_2_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="03">
								AND		( D1.MN_3_STA_CD NOT IN('*') OR D1.MN_3_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="04">
								AND		( D1.MN_4_STA_CD NOT IN('*') OR D1.MN_4_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="05">
								AND		( D1.MN_5_STA_CD NOT IN('*') OR D1.MN_5_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="06">
								AND		( D1.MN_6_STA_CD NOT IN('*') OR D1.MN_6_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="07">
								AND		( D1.MN_7_STA_CD NOT IN('*') OR D1.MN_7_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="08">
								AND		( D1.MN_8_STA_CD NOT IN('*') OR D1.MN_8_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="09">
								AND		( D1.MN_9_STA_CD NOT IN('*') OR D1.MN_9_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="10">
								AND		( D1.MN_1_0_STA_CD NOT IN('*') OR D1.MN_1_0_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="11">
								AND		( D1.MN_1_1_STA_CD NOT IN('*') OR D1.MN_1_1_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="12">
								AND		( D1.MN_1_2_STA_CD NOT IN('*') OR D1.MN_1_2_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="13">
								AND		( D1.MN_1_3_STA_CD NOT IN('*') OR D1.MN_1_3_STA_CD IS NULL )
		</isEqual>
	</isEqual>
	<isEqual property="recvYn" compareValue="Y">
		<isEqual property="profMm" compareValue="00">
								AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="01">
								AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="02">
								AND		( D1.MN_2_STA_CD NOT IN('*') OR D1.MN_2_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="03">
								AND		( D1.MN_3_STA_CD NOT IN('*') OR D1.MN_3_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="04">
								AND		( D1.MN_4_STA_CD NOT IN('*') OR D1.MN_4_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="05">
								AND		( D1.MN_5_STA_CD NOT IN('*') OR D1.MN_5_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="06">
								AND		( D1.MN_6_STA_CD NOT IN('*') OR D1.MN_6_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="07">
								AND		( D1.MN_7_STA_CD NOT IN('*') OR D1.MN_7_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="08">
								AND		( D1.MN_8_STA_CD NOT IN('*') OR D1.MN_8_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="09">
								AND		( D1.MN_9_STA_CD NOT IN('*') OR D1.MN_9_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="10">
								AND		( D1.MN_1_0_STA_CD NOT IN('*') OR D1.MN_1_0_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="11">
								AND		( D1.MN_1_1_STA_CD NOT IN('*') OR D1.MN_1_1_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="12">
								AND		( D1.MN_1_2_STA_CD NOT IN('*') OR D1.MN_1_2_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="13">
								AND		( D1.MN_1_3_STA_CD NOT IN('*') OR D1.MN_1_3_STA_CD IS NOT NULL )
		</isEqual>
	</isEqual>
	<isEqual property="recvYn" compareValue="N">
		<isEqual property="profMm" compareValue="00">
								AND		D1.MN_1_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="01">
								AND		D1.MN_1_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="02">
								AND		D1.MN_2_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="03">
								AND		D1.MN_3_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="04">
								AND		D1.MN_4_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="05">
								AND		D1.MN_5_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="06">
								AND		D1.MN_6_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="07">
								AND		D1.MN_7_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="08">
								AND		D1.MN_8_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="09">
								AND		D1.MN_9_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="10">
								AND		D1.MN_1_0_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="11">
								AND		D1.MN_1_1_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="12">
								AND		D1.MN_1_2_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="13">
								AND		D1.MN_1_3_STA_CD IS NULL
		</isEqual>
	</isEqual>
	<![CDATA[
								ORDER BY PROF_YR, COPT_CD, ACNT_CD, BLL_CD, PROF_DRTR_SRNO, DL_XPN_RCDB_PBSVT_SRNO
						) D3
				) Y
		WHERE	Y.RN BETWEEN ( #pageNo# - 1 ) * #pageSize# + 1 AND ( #pageNo# * #pageSize# )
    ]]>
    </select>
    
    <!-- 예하접수현황조회(페이징없이) -->
    <select id="FAACAV076EMainselectYhNoPage" parameterClass="paramMap" resultMap="enaisExtYhDataVO">
    	<![CDATA[  /* faa/cav/076/FAACAV076EMainselectYhNoPage */ ]]>
    <![CDATA[
    	SELECT	Y.COPT_CD || '-' || Y.ACNT_CD || '-' || Y.BLL_CD || '-' || Y.PROF_DRTR_SRNO || '-' || Y.DL_XPN_RCDB_PBSVT_SRNO AS ACCMN_ID
				, Y.PROF_YR
				, Z.ORG_NM
				, Z.MDF_PEN_NM
				, Z.PST_NM
				, ( SELECT S1.ACNT_CD_NM FROM TWFAACAV024C S1 WHERE S1.ACNT_DVSN_CD = '01' AND S1.ACNT_CD = Y.ACNT_CD ) AS FSCL_NM
				, F_AV_BLL_CD_NM( Y.BLL_CD, Y.DL_XPN_RCDB_PBSVT_SRNO ) AS CHCK_NM
				, Y.BLL_GUBUN_CD
				, DECODE( Y.MN_1_STA_CD, '*', Y.MN_1_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || DECODE( Y.BLL_GUBUN_CD, '05', '00', '01' )
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								AND     D2.RCPT_STA_CD IN ('A','W')
								GROUP BY PROF_YM
							)
				)) AS MN_1_STA_CD
				, DECODE( Y.MN_2_STA_CD, '*', Y.MN_2_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '02'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_2_STA_CD
				, DECODE( Y.MN_3_STA_CD, '*', Y.MN_3_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '03'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_3_STA_CD
				, DECODE( Y.MN_4_STA_CD, '*', Y.MN_4_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '04'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_4_STA_CD
				, DECODE( Y.MN_5_STA_CD, '*', Y.MN_5_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '05'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_5_STA_CD
				, DECODE( Y.MN_6_STA_CD, '*', Y.MN_6_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '06'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_6_STA_CD
				, DECODE( Y.MN_7_STA_CD, '*', Y.MN_7_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '07'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_7_STA_CD
				, DECODE( Y.MN_8_STA_CD, '*', Y.MN_8_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '08'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_8_STA_CD
				, DECODE( Y.MN_9_STA_CD, '*', Y.MN_9_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '09'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_9_STA_CD
				, DECODE( Y.MN_1_0_STA_CD, '*', Y.MN_1_0_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '10'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_0_STA_CD
				, DECODE( Y.MN_1_1_STA_CD, '*', Y.MN_1_1_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '11'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_1_STA_CD
				, DECODE( Y.MN_1_2_STA_CD, '*', Y.MN_1_2_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '12'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_2_STA_CD
				, DECODE( Y.MN_1_3_STA_CD, '*', Y.MN_1_3_STA_CD,  (
					SELECT	(
								CASE
									WHEN S1.RCPT_STA_CD IN ( 'E', 'X' ) THEN 'X'
									WHEN S1.RCPT_STA_CD IN ( 'A', 'W' ) THEN 'O'
									ELSE ''
								END
							) AS STAT
					FROM	TWFAACAV002H S1
					WHERE	S1.COPT_CD = Y.COPT_CD
					AND		S1.ACNT_CD = Y.ACNT_CD
					AND		S1.BLL_CD = Y.BLL_CD
					AND		S1.PROF_DRTR_SRNO = Y.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = Y.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.PROF_YM = Y.PROF_YR || '13'
					AND		( PROF_YM, RCPT_DH ) IN (
								SELECT	PROF_YM, MAX(RCPT_DH) AS RCPT_DH
								FROM	TWFAACAV002H D2
								WHERE	D2.COPT_CD = S1.COPT_CD
								AND		D2.ACNT_CD = S1.ACNT_CD
								AND		D2.BLL_CD = S1.BLL_CD
								AND		D2.PROF_DRTR_SRNO = S1.PROF_DRTR_SRNO
								AND		D2.DL_XPN_RCDB_PBSVT_SRNO = S1.DL_XPN_RCDB_PBSVT_SRNO
								AND		D2.PROF_YM = S1.PROF_YM
								GROUP BY PROF_YM
							)
				)) AS MN_1_3_STA_CD
		FROM	(
					SELECT	D1.COPT_CD
							, D1.ACNT_CD
							, D1.BLL_CD
							, D1.PROF_DRTR_SRNO
							, D1.DL_XPN_RCDB_PBSVT_SRNO
							, D1.PROF_YR
							, D1.MN_1_STA_CD
							, D1.MN_2_STA_CD
							, D1.MN_3_STA_CD
							, D1.MN_4_STA_CD
							, D1.MN_5_STA_CD
							, D1.MN_6_STA_CD
							, D1.MN_7_STA_CD
							, D1.MN_8_STA_CD
							, D1.MN_9_STA_CD
							, D1.MN_1_0_STA_CD
							, D1.MN_1_1_STA_CD
							, D1.MN_1_2_STA_CD
							, D1.MN_1_3_STA_CD
							, D2.BLL_GUBUN_CD
					FROM	TWFAACAV007M D1
							, ( 
								SELECT	WS1.ACNT_CD AS BLL_CD
										, SUBSTR(WS1.RMK_2, 1, 2) AS BLL_GUBUN_CD
								FROM	TWFAACAV024C WS1
								WHERE	WS1.ACNT_DVSN_CD = '03'
							) D2
					WHERE	D1.BLL_CD = D2.BLL_CD
					AND		D1.PROF_YR = #profYr#
					AND		D1.COPT_CD = ( SELECT COPT_SG_CD FROM   TBDCMACM015M WHERE ORG_CD = #orgCd# )
	]]>
	<isEqual property="bllCdType" compareValue="99">
					AND		D1.BLL_CD = #bllCd#
					AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
	</isEqual>
	<isNotEqual property="bllCdType" compareValue="99">
		<isEqual property="bllCd" compareValue="17">
					AND		D1.BLL_CD IN ( '17', '18' )
					AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="18">
					AND		D1.BLL_CD IN ( '17', '18' )
					AND		D1.DL_XPN_RCDB_PBSVT_SRNO != '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="19">
					AND		D1.BLL_CD = '19'
					AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="25">
					AND		D1.BLL_CD = '19'
					AND		D1.DL_XPN_RCDB_PBSVT_SRNO != '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="22">
					AND		D1.BLL_CD IN ( '22', '23', '24' )
					AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
		<isEqual property="bllCd" compareValue="42">
					AND		D1.BLL_CD IN ( '42', '43' )
					AND		D1.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>
	</isNotEqual>
	<isEqual property="recvYn" compareValue="A">
		<isEqual property="profMm" compareValue="00">
					AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="01">
					AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="02">
					AND		( D1.MN_2_STA_CD NOT IN('*') OR D1.MN_2_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="03">
					AND		( D1.MN_3_STA_CD NOT IN('*') OR D1.MN_3_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="04">
					AND		( D1.MN_4_STA_CD NOT IN('*') OR D1.MN_4_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="05">
					AND		( D1.MN_5_STA_CD NOT IN('*') OR D1.MN_5_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="06">
					AND		( D1.MN_6_STA_CD NOT IN('*') OR D1.MN_6_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="07">
					AND		( D1.MN_7_STA_CD NOT IN('*') OR D1.MN_7_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="08">
					AND		( D1.MN_8_STA_CD NOT IN('*') OR D1.MN_8_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="09">
					AND		( D1.MN_9_STA_CD NOT IN('*') OR D1.MN_9_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="10">
					AND		( D1.MN_1_0_STA_CD NOT IN('*') OR D1.MN_1_0_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="11">
					AND		( D1.MN_1_1_STA_CD NOT IN('*') OR D1.MN_1_1_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="12">
					AND		( D1.MN_1_2_STA_CD NOT IN('*') OR D1.MN_1_2_STA_CD IS NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="13">
					AND		( D1.MN_1_3_STA_CD NOT IN('*') OR D1.MN_1_3_STA_CD IS NULL )
		</isEqual>
	</isEqual>
	<isEqual property="recvYn" compareValue="Y">
		<isEqual property="profMm" compareValue="00">
					AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="01">
					AND		( D1.MN_1_STA_CD NOT IN('*') OR D1.MN_1_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="02">
					AND		( D1.MN_2_STA_CD NOT IN('*') OR D1.MN_2_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="03">
					AND		( D1.MN_3_STA_CD NOT IN('*') OR D1.MN_3_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="04">
					AND		( D1.MN_4_STA_CD NOT IN('*') OR D1.MN_4_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="05">
					AND		( D1.MN_5_STA_CD NOT IN('*') OR D1.MN_5_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="06">
					AND		( D1.MN_6_STA_CD NOT IN('*') OR D1.MN_6_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="07">
					AND		( D1.MN_7_STA_CD NOT IN('*') OR D1.MN_7_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="08">
					AND		( D1.MN_8_STA_CD NOT IN('*') OR D1.MN_8_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="09">
					AND		( D1.MN_9_STA_CD NOT IN('*') OR D1.MN_9_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="10">
					AND		( D1.MN_1_0_STA_CD NOT IN('*') OR D1.MN_1_0_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="11">
					AND		( D1.MN_1_1_STA_CD NOT IN('*') OR D1.MN_1_1_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="12">
					AND		( D1.MN_1_2_STA_CD NOT IN('*') OR D1.MN_1_2_STA_CD IS NOT NULL )
		</isEqual>
		<isEqual property="profMm" compareValue="13">
					AND		( D1.MN_1_3_STA_CD NOT IN('*') OR D1.MN_1_3_STA_CD IS NOT NULL )
		</isEqual>
	</isEqual>
	<isEqual property="recvYn" compareValue="N">
		<isEqual property="profMm" compareValue="00">
					AND		D1.MN_1_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="01">
					AND		D1.MN_1_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="02">
					AND		D1.MN_2_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="03">
					AND		D1.MN_3_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="04">
					AND		D1.MN_4_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="05">
					AND		D1.MN_5_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="06">
					AND		D1.MN_6_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="07">
					AND		D1.MN_7_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="08">
					AND		D1.MN_8_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="09">
					AND		D1.MN_9_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="10">
					AND		D1.MN_1_0_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="11">
					AND		D1.MN_1_1_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="12">
					AND		D1.MN_1_2_STA_CD IS NULL
		</isEqual>
		<isEqual property="profMm" compareValue="13">
					AND		D1.MN_1_3_STA_CD IS NULL
		</isEqual>
	</isEqual>
	<![CDATA[
					ORDER BY PROF_YR, COPT_CD, ACNT_CD, BLL_CD, PROF_DRTR_SRNO, DL_XPN_RCDB_PBSVT_SRNO
				) Y
				, TWFAACAV003M Z
		WHERE	Y.COPT_CD = Z.COPT_CD
		AND		Y.ACNT_CD = Z.ACNT_CD
		AND		Y.BLL_CD = Z.BLL_CD
		AND		Y.PROF_DRTR_SRNO = Z.PROF_DRTR_SRNO
		AND		Y.DL_XPN_RCDB_PBSVT_SRNO = Z.DL_XPN_RCDB_PBSVT_SRNO
    ]]>
    </select>
	
   	<!-- 월별자료제출현황 목록 -->
	<select id="FAACAV076EMnsumSituByCondiSelect" parameterClass="paramMap" resultMap="enaisMnsumDataVO">
		<![CDATA[  /* faa/cav/076/FAACAV076EMnsumSituByCondiSelect */ ]]>
 	<![CDATA[
 		SELECT	SUBSTR(YY.MNSUM_YM,1,4) || '/' || SUBSTR(YY.MNSUM_YM,5) AS MNSUM_YM
				, YY.MNSUM_DVSN_CD
				, F_CODE_NM( '1000711', YY.MNSUM_DVSN_CD ) AS MNSUM_DVSN_CD_NM
				, TO_CHAR(YY.ACP_DH, 'YYYY-MM-DD HH24:MI:SS') AS ACP_DH
		FROM	(
					SELECT	ROWNUM AS RN
							, D2.MNSUM_YM
							, D2.MNSUM_DVSN_CD
							, D2.ACP_DH
					FROM	(
								SELECT	D1.MNSUM_YM
										, D1.MNSUM_DVSN_CD
										, D1.ACP_DH
								FROM	TWFAACAV044H D1
	]]>
	<dynamic prepend="WHERE">
		<isNotEmpty property="profYr">
			<isNotEmpty property="profMm" prepend="AND">
										D1.MNSUM_YM = #profYr# || #profMm#
			</isNotEmpty>
			<isEmpty property="profMm" prepend="AND">
										D1.MNSUM_YM LIKE #profYr# || '%'
			</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="mnsumDvsnCd" prepend="AND">
										D1.MNSUM_DVSN_CD = #mnsumDvsnCd#
		</isNotEmpty>
	</dynamic>
	<![CDATA[
								ORDER BY MNSUM_YM, MNSUM_DVSN_CD, ACP_DH
							) D2
				) YY
		WHERE	YY.RN BETWEEN ( #pageNo# - 1 ) * #pageSize# + 1 AND ( #pageNo# * #pageSize# )
   	]]>
	</select>

	<!-- 월별자료제출현황 전체 카운트 -->
	<select id="FAACAV076EMnsumSituByCondiCntSelect" parameterClass="paramMap" resultClass="int">
		<![CDATA[  /* faa/cav/076/FAACAV076EMnsumSituByCondiCntSelect */ ]]>
	<![CDATA[
		SELECT	COUNT(D1.MNSUM_YM) AS CNT
		FROM	TWFAACAV044H D1
	]]>
	<dynamic prepend="WHERE">
		<isNotEmpty property="profYr">
			<isNotEmpty property="profMm" prepend="AND">
				D1.MNSUM_YM = #profYr# || #profMm#
			</isNotEmpty>
			<isEmpty property="profMm" prepend="AND">
				D1.MNSUM_YM LIKE #profYr# || '%'
			</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="mnsumDvsnCd" prepend="AND">
				D1.MNSUM_DVSN_CD = #mnsumDvsnCd#
		</isNotEmpty>
	</dynamic>
	</select>
	
	<!-- 수신이력 조회 -->
	<select id="FAACAV076ERcptHstSelect" parameterClass="paramMap" resultMap="enaisRcptHstDataVO">
		<![CDATA[  /* faa/cav/076/FAACAV076ERcptHstSelect */ ]]>
	<![CDATA[
		SELECT	D1.PROF_YM
				, D1.COPT_CD
				, D1.ACNT_CD
				, D1.BLL_CD
				, D1.PROF_DRTR_SRNO
				, D1.DL_XPN_RCDB_PBSVT_SRNO
				, TO_CHAR(D1.RCPT_DH, 'YYYY.MM.DD HH24:MI:SS') AS RCPT_DH
				, D1.RCPT_STA_CD
				, (SELECT CD_NM FROM TBDCMACM013C WHERE CD = D1.RCPT_STA_CD AND CMM_CD_DVSN_CD = '1000701') AS RCPT_STA_CD_NM
				, DECODE(D1.RCPT_STA_CD, 'E', (
					SELECT	AGGR_CONCAT( S1.ACP_ERR_CD, ',') AS ACP_ERR_CD
					FROM	TWFAACAV006D S1
					WHERE	S1.PROF_YM = D1.PROF_YM
					AND		S1.COPT_CD = D1.COPT_CD
					AND		S1.ACNT_CD = D1.ACNT_CD
					AND		S1.BLL_CD = D1.BLL_CD
					AND		S1.PROF_DRTR_SRNO = D1.PROF_DRTR_SRNO
					AND		S1.DL_XPN_RCDB_PBSVT_SRNO = D1.DL_XPN_RCDB_PBSVT_SRNO
					AND		S1.ACP_DH = D1.RCPT_DH
					GROUP BY S1.PROF_YM
							, S1.COPT_CD
							, S1.ACNT_CD
							, S1.BLL_CD
							, S1.PROF_DRTR_SRNO
							, S1.DL_XPN_RCDB_PBSVT_SRNO
							, S1.ACP_DH
				)) AS ACP_ERR_CD
		FROM	TWFAACAV002H D1
		WHERE	D1.PROF_YM = #profYm#
		AND		D1.COPT_CD = #coptCd#
		AND		D1.ACNT_CD = #acntCd#
		AND		D1.BLL_CD = #bllCd#
		AND		D1.PROF_DRTR_SRNO = #profDrtrSrno#
		AND		D1.DL_XPN_RCDB_PBSVT_SRNO = #dlXpnRcdbPbsvtSrno#
		ORDER BY RCPT_DH
	]]>
	</select>
	
</sqlMap> 



