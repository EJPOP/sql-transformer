<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/006"> 

	<parameterMap id="prcAmCCountParm" class="java.util.HashMap">
		<parameter property="i_proc_gubun"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_prov_date"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_sokwan_cd"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_hoigye_cd"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_gyesan_cd"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_duty_sno"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_sduty_sno"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />		
		<parameter property="o_succ_dvsn_cd"    jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT" />
		<parameter property="o_total_cnt"	    jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT" />		
		<parameter property="o_succ_cnt"	    jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT" />
		<parameter property="o_fail_cnt"	    jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	<parameterMap id="prcAmCCountParm18" class="java.util.HashMap">
		<parameter property="i_proc_gubun"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_prov_date"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_sokwan_cd"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_hoigye_cd"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_gyesan_cd"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_duty_sno"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_sduty_sno"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_from_sokwan"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="i_to_sokwan"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="o_succ_dvsn_cd"    jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT" />
		<parameter property="o_total_cnt"	    jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT" />		
		<parameter property="o_succ_cnt"	    jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT" />
		<parameter property="o_fail_cnt"	    jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT" />		
	</parameterMap>
		
	<!-- 11 수입징수액계산서(세무·세관관서를 제외한 관서용)       -->		
	<procedure id="FAACAV006EMainBatchChk11" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk11 */ ]]>
		{ CALL PWFAACAV006_11(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 12 수입징수액계산서(세무·세관 관서용)       -->		
	<procedure id="FAACAV006EMainBatchChk12" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk12 */ ]]>
		{ CALL PWFAACAV006_12(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 13 수입금출납계산서-->		
	<procedure id="FAACAV006EMainBatchChk13" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk13 */ ]]>
		{ CALL PWFAACAV006_13(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 14 물납액계산서     -->		
	<procedure id="FAACAV006EMainBatchChk14" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk14 */ ]]>
		{ CALL PWFAACAV006_14(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 15 환급금지급액계산서-->		
	<procedure id="FAACAV006EMainBatchChk15" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk15 */ ]]>
		{ CALL PWFAACAV006_15(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>			
	<!-- 16 환급특례법에의한관세등의 정액및개별환급금결정액계산서 -->		
	<procedure id="FAACAV006EMainBatchChk16" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk16 */ ]]>
		{ CALL PWFAACAV006_16(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 17 지출계산서-->		
	<procedure id="FAACAV006EMainBatchChk17" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk17 */ ]]>
		{ CALL PWFAACAV006_17(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 18 관서운영경비출납계산서  소관(from ~ to) 적용 -->		
	<procedure id="FAACAV006EMainBatchChk18" parameterMap="prcAmCCountParm18">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk18 */ ]]>
		{ CALL PWFAACAV006_18(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>
	<!-- 19 선사용자금명령액계산서-->		
	<procedure id="FAACAV006EMainBatchChk19" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk19 */ ]]>
		{ CALL PWFAACAV006_19(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>			
	<!-- 20 선사용자금출납계산서-->		
	<procedure id="FAACAV006EMainBatchChk20" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk20 */ ]]>
		{ CALL PWFAACAV006_20(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 21 기금수입계산서 -->		
	<procedure id="FAACAV006EMainBatchChk21" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk21 */ ]]>
		{ CALL PWFAACAV006_21(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 22 기금지출계산서 -->		
	<procedure id="FAACAV006EMainBatchChk22" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk22 */ ]]>
		{ CALL PWFAACAV006_22(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 23 기금관서운영경비-->		
	<procedure id="FAACAV006EMainBatchChk23" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk23 */ ]]>
		{ CALL PWFAACAV006_23(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 25 선사용자금관서운영경비계산서-->		
	<procedure id="FAACAV006EMainBatchChk25" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk25 */ ]]>
		{ CALL PWFAACAV006_25(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 28 세입세출외현금출납계산서-->		
	<procedure id="FAACAV006EMainBatchChk28" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk28 */ ]]>
		{ CALL PWFAACAV006_28(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 29 수입대체경비출납계산서-->		
	<procedure id="FAACAV006EMainBatchChk29" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk29 */ ]]>
		{ CALL PWFAACAV006_29(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 30 국가채권관리계산서-->		
	<procedure id="FAACAV006EMainBatchChk30" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk30 */ ]]>
		{ CALL PWFAACAV006_30(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 31 국가채무증감계산서  -->		
	<procedure id="FAACAV006EMainBatchChk31" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk31 */ ]]>
		{ CALL PWFAACAV006_31(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>			
	<!-- 32 물품관리계산서 -->		
	<procedure id="FAACAV006EMainBatchChk32" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk32 */ ]]>
		{ CALL PWFAACAV006_32(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 33 국유재산증감 및 현재액계산서 -->		
	<procedure id="FAACAV006EMainBatchChk33" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk33 */ ]]>
		{ CALL PWFAACAV006_33(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>
	<!-- 34 국유재산무상대부액계산서  -->		
	<procedure id="FAACAV006EMainBatchChk34" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk34 */ ]]>
		{ CALL PWFAACAV006_34(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>	
	<!-- 35 유가증권증감계산서  -->		
	<procedure id="FAACAV006EMainBatchChk35" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk35 */ ]]>
		{ CALL PWFAACAV006_35(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>	
	<!--41 세입징수액계산서(지방자치단체용) -->		
	<procedure id="FAACAV006EMainBatchChk41" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk41 */ ]]>
		{ CALL PWFAACAV006_41(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>	
	<!-- 42 지출계산서(지방자치단체용) -->		
	<procedure id="FAACAV006EMainBatchChk42" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk42 */ ]]>
		{ CALL PWFAACAV006_42(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>	
	<!-- 51 한국은행수입계산서  -->		
	<procedure id="FAACAV006EMainBatchChk51" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk51 */ ]]>
		{ CALL PWFAACAV006_51(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>	
	<!-- 52 한국은행지출계산서     -->		
	<procedure id="FAACAV006EMainBatchChk52" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk52 */ ]]>
		{ CALL PWFAACAV006_52(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }  
	</procedure>	
	<!-- 53 국고금출납계산서   -->		
	<procedure id="FAACAV006EMainBatchChk53" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk53 */ ]]>
		{ CALL PWFAACAV006_53(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>			
	<!-- 55 유가증권수불계산서   -->		
	<procedure id="FAACAV006EMainBatchChk55" parameterMap="prcAmCCountParm">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainBatchChk55 */ ]]>
		{ CALL PWFAACAV006_55(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>					
	
	
	<sql id="selBllCd" >
		<isEqual property="strBllDvsn" compareValue="17">	 	   
			AND  BLL_CD IN('17','18')
			AND  DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="18">	 	   
			AND  BLL_CD IN('17','18')
			AND  DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			AND	 COPT_CD BETWEEN #strFromSokwan# AND #strToSokwan#
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="19">	 	   
			AND  BLL_CD IN('19')
			AND  DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="22">	 	   
			AND  BLL_CD IN('22','23','24')
			AND  DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>		 
		<isEqual property="strBllDvsn" compareValue="23">	 	   
			AND  BLL_CD IN('22','23','24')
			AND  DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="25">	 	   
			AND  BLL_CD IN('19')
			AND  DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="42">	 	   
			AND  BLL_CD IN('42','43')
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="99">	 	   
			AND  BLL_CD  = #strBllCd#
		</isEqual>	
		AND EXISTS (SELECT 1
		              FROM TWFAACAV003M
		             WHERE COPT_CD = A.COPT_CD 					       		   
		               AND ACNT_CD = A.ACNT_CD
		               AND BLL_CD = A.BLL_CD
		               AND PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
		               AND DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
		               AND MDF_DVSN_CD NOT IN 'D'
		               AND ACP_DVSN_CD NOT IN ('P'))
	</sql>
	
	<sql id="selBllCd2">
		<isEqual property="strBllDvsn" compareValue="17">	 	   
			AND		A.BLL_CD IN('17','18')
			AND		A.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="18">	 	   
			AND		A.BLL_CD IN('17','18')
			AND		A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			AND	    A.COPT_CD BETWEEN #strFromSokwan# AND #strToSokwan#
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="19">	 	   
			AND		A.BLL_CD IN('19')
			AND		A.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="22">	 	   
			AND		A.BLL_CD IN('22','23','24')
			AND		A.DL_XPN_RCDB_PBSVT_SRNO = '000'
		</isEqual>		 
		<isEqual property="strBllDvsn" compareValue="23">	 	   
			AND		A.BLL_CD IN('22','23','24')
			AND		A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="25">	 	   
			AND		A.BLL_CD IN('19')
			AND		A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="42">	 	   
			AND		A.BLL_CD IN('42','43')
		</isEqual>		
		<isEqual property="strBllDvsn" compareValue="99">	 	   
			AND		A.BLL_CD  = #strBllCd#
		</isEqual>
	</sql>
	
	
	<!--검산목록조회-->
	<select id="FAACAV006EMainselect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[  /* faa/cav/006/FAACAV006EMainselect2 */ ]]>
		/* 총 대상건수 */
		WITH TB_ALL AS(
			SELECT  
			        <isEqual property="strPeriod" compareValue="M">
			            SUM(CASE WHEN (MN_1_STA_CD &lt;&gt; '*' OR MN_1_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'01' AND A.CRE_DT &lt;= #strYr#||'01' THEN 1 ELSE 0 END) AS TOT_CNT1,
			            SUM(CASE WHEN (MN_2_STA_CD &lt;&gt; '*' OR MN_2_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'02' AND A.CRE_DT &lt;= #strYr#||'02' THEN 1 ELSE 0 END) AS TOT_CNT2,
			            SUM(CASE WHEN (MN_3_STA_CD &lt;&gt; '*' OR MN_3_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'03' AND A.CRE_DT &lt;= #strYr#||'03' THEN 1 ELSE 0 END) AS TOT_CNT3,
			            SUM(CASE WHEN (MN_4_STA_CD &lt;&gt; '*' OR MN_4_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'04' AND A.CRE_DT &lt;= #strYr#||'04' THEN 1 ELSE 0 END) AS TOT_CNT4,
			            SUM(CASE WHEN (MN_5_STA_CD &lt;&gt; '*' OR MN_5_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'05' AND A.CRE_DT &lt;= #strYr#||'05' THEN 1 ELSE 0 END) AS TOT_CNT5,
			            SUM(CASE WHEN (MN_6_STA_CD &lt;&gt; '*' OR MN_6_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'06' AND A.CRE_DT &lt;= #strYr#||'06' THEN 1 ELSE 0 END) AS TOT_CNT6,
			            SUM(CASE WHEN (MN_7_STA_CD &lt;&gt; '*' OR MN_7_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'07' AND A.CRE_DT &lt;= #strYr#||'07' THEN 1 ELSE 0 END) AS TOT_CNT7,
			            SUM(CASE WHEN (MN_8_STA_CD &lt;&gt; '*' OR MN_8_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'08' AND A.CRE_DT &lt;= #strYr#||'08' THEN 1 ELSE 0 END) AS TOT_CNT8,
			            SUM(CASE WHEN (MN_9_STA_CD &lt;&gt; '*' OR MN_9_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'09' AND A.CRE_DT &lt;= #strYr#||'09' THEN 1 ELSE 0 END) AS TOT_CNT9,
			            SUM(CASE WHEN (MN_1_0_STA_CD &lt;&gt; '*' OR MN_1_0_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'10' AND A.CRE_DT &lt;= #strYr#||'10' THEN 1 ELSE 0 END) AS TOT_CNT10,
			            SUM(CASE WHEN (MN_1_1_STA_CD &lt;&gt; '*' OR MN_1_1_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'11' AND A.CRE_DT &lt;= #strYr#||'11' THEN 1 ELSE 0 END) AS TOT_CNT11,
			            SUM(CASE WHEN (MN_1_2_STA_CD &lt;&gt; '*' OR MN_1_2_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'12' AND A.CRE_DT &lt;= #strYr#||'12' THEN 1 ELSE 0 END) AS TOT_CNT12,
			            SUM(CASE WHEN (MN_1_3_STA_CD &lt;&gt; '*' OR MN_1_3_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'12' AND A.CRE_DT &lt;= #strYr#||'12' THEN 1 ELSE 0 END) AS TOT_CNT13
			        </isEqual>
			        <isEqual property="strPeriod" compareValue="Q">
			            SUM(CASE WHEN (MN_1_STA_CD &lt;&gt; '*' OR MN_1_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'01' AND A.CRE_DT &lt;= #strYr#||'03' THEN 1 ELSE 0 END) AS TOT_CNT1,
			            SUM(CASE WHEN (MN_2_STA_CD &lt;&gt; '*' OR MN_2_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'04' AND A.CRE_DT &lt;= #strYr#||'06' THEN 1 ELSE 0 END) AS TOT_CNT2,
			            SUM(CASE WHEN (MN_3_STA_CD &lt;&gt; '*' OR MN_3_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'07' AND A.CRE_DT &lt;= #strYr#||'09' THEN 1 ELSE 0 END) AS TOT_CNT3,
			            SUM(CASE WHEN (MN_4_STA_CD &lt;&gt; '*' OR MN_4_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'10' AND A.CRE_DT &lt;= #strYr#||'13' THEN 1 ELSE 0 END) AS TOT_CNT4
			        </isEqual>
			        <isEqual property="strPeriod" compareValue="Y">
			            SUM(CASE WHEN (MN_1_STA_CD &lt;&gt; '*' OR MN_1_STA_CD IS NULL) AND NVL(A.ABLT_DT,'999999') &gt;= #strYr#||'00' AND A.CRE_DT <![CDATA[ <= ]]> #strYr#||'13' THEN 1 ELSE 0 END) AS TOT_CNT1
			        </isEqual>
			FROM    TWFAACAV007M B,
			        (SELECT  A.COPT_CD,
			                A.ACNT_CD,
			                A.BLL_CD,
			                A.PROF_DRTR_SRNO,
			                A.DL_XPN_RCDB_PBSVT_SRNO,
			                A.CRE_DT,
			                A.ABLT_DT
			        FROM    TWFAACAV003M A
			        WHERE   A.MDF_DVSN_CD NOT IN ('D')
			        AND		A.ACP_DVSN_CD NOT IN ('P')
			        AND     A.ABLT_DT <![CDATA[ >= ]]> #strYr#||'00'
			        AND     A.CRE_DT <![CDATA[ <= ]]> #strYr#||'13'
			        <include refid="selBllCd2" />
			        ) A
			WHERE   1=1
			AND     B.COPT_CD = A.COPT_CD
			AND     B.ACNT_CD = A.ACNT_CD
			AND     B.BLL_CD  = A.BLL_CD
			AND     B.PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
			AND     B.DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
			AND     B.PROF_YR = #strYr#
			<include refid="selBllCd2" />
		),
		/* 검산대상건수 */	 
		TB_DO AS(
			SELECT  B.PROF_YM,
			        COUNT(B.COPT_CD) AS DO_CNT
			FROM    (SELECT  DISTINCT
			                A.COPT_CD,
			                A.ACNT_CD,
			                A.BLL_CD,
			                A.PROF_DRTR_SRNO,
			                A.DL_XPN_RCDB_PBSVT_SRNO,
			                A.PROF_YM,
			                <isEqual property="strPeriod" compareValue="M">
			                    CASE WHEN	A.PROF_YM = #strYr#||'13' THEN #strYr#||'12'
			                    	 ELSE	A.PROF_YM
			                    END	AS ABLT_DT_PROF_YM,
			                    CASE WHEN	A.PROF_YM = #strYr#||'13' THEN #strYr#||'12'
			                    	 ELSE	A.PROF_YM
			                    END	AS CRE_DT_PROF_YM
			                </isEqual>
			                <isEqual property="strPeriod" compareValue="Q">
			                    CASE A.PROF_YM WHEN #strYr#||'01' THEN #strYr#||'01'
			                                   WHEN #strYr#||'02' THEN #strYr#||'04'
			                                   WHEN #strYr#||'03' THEN #strYr#||'07'
			                                   WHEN #strYr#||'04' THEN #strYr#||'10'
			                    END AS ABLT_DT_PROF_YM,
			                    CASE A.PROF_YM WHEN #strYr#||'01' THEN #strYr#||'03'
			                                   WHEN #strYr#||'02' THEN #strYr#||'06'
			                                   WHEN #strYr#||'03' THEN #strYr#||'09'
			                                   WHEN #strYr#||'04' THEN #strYr#||'13'
			                    END AS CRE_DT_PROF_YM
			                </isEqual>
			                <isEqual property="strPeriod" compareValue="Y">
			                    #strYr#||'00' AS ABLT_DT_PROF_YM,
			                    #strYr#||'13' AS CRE_DT_PROF_YM
			                </isEqual>
			        FROM    TWFAACAV001M A
			        WHERE   A.PROF_YM BETWEEN #strYr#||'00' AND #strYr#||'13'
			        AND     A.BLL_HNDL_STA_CD NOT IN ('Y','S')
			        <include refid="selBllCd2" />
			        ) B,
			        (SELECT  A.COPT_CD,
			                A.ACNT_CD,
			                A.BLL_CD,
			                A.PROF_DRTR_SRNO,
			                A.DL_XPN_RCDB_PBSVT_SRNO,
			                A.CRE_DT,
			                A.ABLT_DT
			        FROM    TWFAACAV003M A
			        WHERE   A.MDF_DVSN_CD NOT IN ('D')
			        AND		A.ACP_DVSN_CD NOT IN ('P')
			        <include refid="selBllCd2" />
			        AND     A.ABLT_DT <![CDATA[ >= ]]> #strYr#||'00'
			        AND     A.CRE_DT <![CDATA[ <= ]]> #strYr#||'13'
			        ) A
			WHERE   1=1
			AND     B.COPT_CD = A.COPT_CD
			AND     B.ACNT_CD = A.ACNT_CD
			AND     B.BLL_CD  = A.BLL_CD
			AND     B.PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
			AND     B.DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
			AND     B.PROF_YM BETWEEN #strYr#||'00' AND #strYr#||'13'
			<isNotEqual property="strPeriod" compareValue="Y">
				AND     B.CRE_DT_PROF_YM <![CDATA[ >= ]]> A.CRE_DT AND B.ABLT_DT_PROF_YM <![CDATA[ <= ]]> A.ABLT_DT
			</isNotEqual>
			GROUP BY B.PROF_YM
		),
		/* 불부합확정 */
		TB_ERR AS (
			SELECT  B.PROF_YM,
			        COUNT(B.COPT_CD) AS ERR_CNT
			FROM    (SELECT  DISTINCT
			                A.COPT_CD,
			                A.ACNT_CD,
			                A.BLL_CD,
			                A.PROF_DRTR_SRNO,
			                A.DL_XPN_RCDB_PBSVT_SRNO,
			                A.PROF_YM,
			                <isEqual property="strPeriod" compareValue="M">
			                    CASE WHEN	A.PROF_YM = #strYr#||'13' THEN #strYr#||'12'
			                    	 ELSE	A.PROF_YM
			                    END	AS ABLT_DT_PROF_YM,
			                    CASE WHEN	A.PROF_YM = #strYr#||'13' THEN #strYr#||'12'
			                    	 ELSE	A.PROF_YM
			                    END	AS CRE_DT_PROF_YM
			                </isEqual>
			                <isEqual property="strPeriod" compareValue="Q">
			                    CASE A.PROF_YM WHEN #strYr#||'01' THEN #strYr#||'01'
			                                   WHEN #strYr#||'02' THEN #strYr#||'04'
			                                   WHEN #strYr#||'03' THEN #strYr#||'07'
			                                   WHEN #strYr#||'04' THEN #strYr#||'10'
			                    END AS ABLT_DT_PROF_YM,
			                    CASE A.PROF_YM WHEN #strYr#||'01' THEN #strYr#||'03'
			                                   WHEN #strYr#||'02' THEN #strYr#||'06'
			                                   WHEN #strYr#||'03' THEN #strYr#||'09'
			                                   WHEN #strYr#||'04' THEN #strYr#||'13'
			                    END AS CRE_DT_PROF_YM
			                </isEqual>
			                <isEqual property="strPeriod" compareValue="Y">
			                    #strYr#||'00' AS ABLT_DT_PROF_YM,
			                    #strYr#||'13' AS CRE_DT_PROF_YM
			                </isEqual>
			        FROM    TWFAACAV001M A
			        WHERE   A.PROF_YM BETWEEN #strYr#||'00' AND #strYr#||'13'
			        AND     A.BLL_HNDL_STA_CD = 'S'
			        <include refid="selBllCd2" />
			        ) B,
			        (SELECT  A.COPT_CD,
			                A.ACNT_CD,
			                A.BLL_CD,
			                A.PROF_DRTR_SRNO,
			                A.DL_XPN_RCDB_PBSVT_SRNO,
			                A.CRE_DT,
			                A.ABLT_DT
			        FROM    TWFAACAV003M A
			        WHERE   A.MDF_DVSN_CD NOT IN ('D')
			        AND		A.ACP_DVSN_CD NOT IN ('P')
			        <include refid="selBllCd2" />
			        AND     A.ABLT_DT <![CDATA[ >= ]]> #strYr#||'00'
			        AND     A.CRE_DT <![CDATA[ <= ]]> #strYr#||'13'
			        ) A
			WHERE   1=1
			AND     B.COPT_CD = A.COPT_CD
			AND     B.ACNT_CD = A.ACNT_CD
			AND     B.BLL_CD  = A.BLL_CD
			AND     B.PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
			AND     B.DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
			AND     B.PROF_YM BETWEEN #strYr#||'00' AND #strYr#||'13'
			<isNotEqual property="strPeriod" compareValue="Y">
				AND     B.CRE_DT_PROF_YM <![CDATA[ >= ]]> A.CRE_DT AND B.ABLT_DT_PROF_YM <![CDATA[ <= ]]> A.ABLT_DT
			</isNotEqual>
			GROUP BY B.PROF_YM
		),
		<![CDATA[ 
		/* 총검산테이블의 증명년월  */
		TB_RCV AS (
			SELECT	PROF_YM,
					COUNT(COPT_CD) AS RCV_CNT
			FROM	TWFAACAV001M A
			WHERE	PROF_YM BETWEEN #strYr#||'00' AND #strYr#||'13'
		]]>
			<include refid="selBllCd" />
			GROUP BY PROF_YM
		),
		/* 검산완료 */
		TB_DONE AS (
			SELECT  B.PROF_YM,
			        COUNT(B.COPT_CD) AS DONE_CNT
			FROM    (SELECT  DISTINCT
			                A.COPT_CD,
			                A.ACNT_CD,
			                A.BLL_CD,
			                A.PROF_DRTR_SRNO,
			                A.DL_XPN_RCDB_PBSVT_SRNO,
			                A.PROF_YM,
			                <isEqual property="strPeriod" compareValue="M">
			                    CASE WHEN	A.PROF_YM = #strYr#||'13' THEN #strYr#||'12'
			                    	 ELSE	A.PROF_YM
			                    END	AS ABLT_DT_PROF_YM,
			                    CASE WHEN	A.PROF_YM = #strYr#||'13' THEN #strYr#||'12'
			                    	 ELSE	A.PROF_YM
			                    END	AS CRE_DT_PROF_YM
			                </isEqual>
			                <isEqual property="strPeriod" compareValue="Q">
			                    CASE A.PROF_YM WHEN #strYr#||'01' THEN #strYr#||'01'
			                                   WHEN #strYr#||'02' THEN #strYr#||'04'
			                                   WHEN #strYr#||'03' THEN #strYr#||'07'
			                                   WHEN #strYr#||'04' THEN #strYr#||'10'
			                    END AS ABLT_DT_PROF_YM,
			                    CASE A.PROF_YM WHEN #strYr#||'01' THEN #strYr#||'03'
			                                   WHEN #strYr#||'02' THEN #strYr#||'06'
			                                   WHEN #strYr#||'03' THEN #strYr#||'09'
			                                   WHEN #strYr#||'04' THEN #strYr#||'13'
			                    END AS CRE_DT_PROF_YM
			                </isEqual>
			                <isEqual property="strPeriod" compareValue="Y">
			                    #strYr#||'00' AS ABLT_DT_PROF_YM,
			                    #strYr#||'13' AS CRE_DT_PROF_YM
			                </isEqual>
			        FROM    TWFAACAV001M A
			        WHERE   A.PROF_YM BETWEEN #strYr#||'00' AND #strYr#||'13'
			        AND     A.BLL_HNDL_STA_CD = 'Y'
			        <include refid="selBllCd2" />
			        ) B,
			        (SELECT  A.COPT_CD,
			                A.ACNT_CD,
			                A.BLL_CD,
			                A.PROF_DRTR_SRNO,
			                A.DL_XPN_RCDB_PBSVT_SRNO,
			                A.CRE_DT,
			                A.ABLT_DT
			        FROM    TWFAACAV003M A
			        WHERE   A.MDF_DVSN_CD NOT IN ('D')
			        AND		A.ACP_DVSN_CD NOT IN ('P')
			        <include refid="selBllCd2" />
			        AND     A.ABLT_DT <![CDATA[ >= ]]> #strYr#||'00'
			        AND     A.CRE_DT <![CDATA[ <= ]]> #strYr#||'13'
			        ) A
			WHERE   1=1
			AND     B.COPT_CD = A.COPT_CD
			AND     B.ACNT_CD = A.ACNT_CD
			AND     B.BLL_CD  = A.BLL_CD
			AND     B.PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
			AND     B.DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
			AND     B.PROF_YM BETWEEN #strYr#||'00' AND #strYr#||'13'
			<isNotEqual property="strPeriod" compareValue="Y">
				AND     B.CRE_DT_PROF_YM <![CDATA[ >= ]]> A.CRE_DT AND B.ABLT_DT_PROF_YM <![CDATA[ <= ]]> A.ABLT_DT
			</isNotEqual>
			GROUP BY B.PROF_YM
		)
		/* 전체총건수 */
		SELECT	KEY,
				PROF_YM,
				ALL_CNT,
				DONE_CNT,
				DO_CNT,
				ERR_CNT,
				SUM(ALL_CNT - DONE_CNT - ERR_CNT - DO_CNT) AS NO_CNT
	    FROM	(
	    		SELECT	ROWNUM AS KEY, 
						TB_RCV.PROF_YM,
						<isEqual property="strPeriod" compareValue="M">
							CASE WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '01' THEN NVL(TB_ALL.TOT_CNT1,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '02' THEN NVL(TB_ALL.TOT_CNT2,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '03' THEN NVL(TB_ALL.TOT_CNT3,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '04' THEN NVL(TB_ALL.TOT_CNT4,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '05' THEN NVL(TB_ALL.TOT_CNT5,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '06' THEN NVL(TB_ALL.TOT_CNT6,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '07' THEN NVL(TB_ALL.TOT_CNT7,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '08' THEN NVL(TB_ALL.TOT_CNT8,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '09' THEN NVL(TB_ALL.TOT_CNT9,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '10' THEN NVL(TB_ALL.TOT_CNT10,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '11' THEN NVL(TB_ALL.TOT_CNT11,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '12' THEN NVL(TB_ALL.TOT_CNT12,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '13' THEN NVL(TB_ALL.TOT_CNT13,0)  
							END AS ALL_CNT,
						</isEqual>
						<isEqual property="strPeriod" compareValue="Q">
							CASE WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '01' THEN NVL(TB_ALL.TOT_CNT1,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '02' THEN NVL(TB_ALL.TOT_CNT2,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '03' THEN NVL(TB_ALL.TOT_CNT3,0)  
								WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '04' THEN NVL(TB_ALL.TOT_CNT4,0)
							END AS ALL_CNT,
						</isEqual>
						<isEqual property="strPeriod" compareValue="Y">
							CASE WHEN SUBSTR(TB_RCV.PROF_YM,5,2) = '00' THEN NVL(TB_ALL.TOT_CNT1,0) 
							END AS ALL_CNT,
						</isEqual>
						NVL(TB_DONE.DONE_CNT,0) AS DONE_CNT,
						NVL(TB_DO.DO_CNT,0) AS DO_CNT,
						NVL(TB_ERR.ERR_CNT,0) AS ERR_CNT
				FROM	TB_ALL,
						TB_RCV,
						TB_DONE,
						TB_ERR,
						TB_DO
				WHERE	TB_RCV.PROF_YM =  TB_DONE.PROF_YM(+)
				AND		TB_RCV.PROF_YM =  TB_DO.PROF_YM(+)    
				AND		TB_RCV.PROF_YM =  TB_ERR.PROF_YM(+)     
				)
		GROUP BY KEY,
				PROF_YM,
				ALL_CNT,
				DONE_CNT,
				DO_CNT,
				ERR_CNT
		ORDER BY PROF_YM
	</select>
	
	
</sqlMap>