<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="csp/bii/922-ndw">
	<!-- 추진실적(공문) 목록 조회-->
	<select id="CSPBII922PMainSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT A.DOCNO
			     , A.DOCTITLE
			     , A.DOCSUMMARY
			     , A.READSTATUSRANGE
			     , A.OPENSTATUSNAME || CASE WHEN A.OPENSTATUSNAME = '비공개' THEN '(' || A.OPENREASON || ')'
			                                ELSE ''
			                           END                                           AS OPENSTATUSNAME              
			     , '관리 : ' || A.PJTCARDNAME || CHAR(13) || '단위 : ' || A.BIZCARDNAME AS CARDNAME
			     , B.FILETITLE
			     , B.FILEPATH
			     , B.FILENAME			     
			     , A.DOCKEYWORD
			     , A.REPORT_REPORTDATE
			     , A.REPORT_USERNAME
			     , A.APPROVAL_APPROVALDATE
			     , A.APPROVAL_USERNAME
			  FROM AM_ONNARA_RESPONSE_DOC A
			     , AM_ONNARA_ATTACH_FILE  B
			 WHERE A.REQUESTID *= B.REQUESTID
			   AND A.SEQ       *= B.SEQ
			   AND A.DOCID     *= B.DOCID
			   AND B.FILETYPECD = '3'
			   AND A.REQUESTID  = #strRequestId#
			   AND A.SEQ        = convert(numeric, #strSeq#)
			   AND A.DOCID      = #strDocId#
		]]>
	</select>
	
	<!-- 추진실적(공문) 목록 조회-->
	<select id="CSPBII922PFileSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT A.FILETITLE
			     , A.FILEPATH
			     , A.FILENAME			     
			  FROM AM_ONNARA_ATTACH_FILE A
			 WHERE A.FILETYPECD = '4'
			   AND A.REQUESTID = #strRequestId#
			   AND A.SEQ       = convert(numeric, #strSeq#)
			   AND A.DOCID     = #strDocId# 
		]]>
	</select>
</sqlMap>