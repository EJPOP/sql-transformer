<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/ura/001">

	<select id="CSPURA001EDown" parameterClass="paramMap"	resultClass="resultMap">
	<![CDATA[
	SELECT '[' || A.ACP_YR || '-심사-' || A.ACP_SRNO || ']' || REPLACE(B.TIT_NM,CHR(10),'')||'_'  as title ,a.DOC_ID
  FROM TBBADFRE103M A INNER JOIN TBBADFRE012M B ON (B.ACP_YR = A.ACP_YR
           AND B.ACP_DVSN_CD = A.ACP_DVSN_CD
           AND B.ACP_SRNO = A.ACP_SRNO)
 WHERE A.RPRT_CD = 'D10100200'  
   AND A.ACP_DVSN_CD = '1'
   AND A.ACP_YR || A.ACP_SRNO IN ('2018926','2018925','2018923','2018911','2018910','2018728','2018686'
   ,'2018685','2018684','2018683','2018682','2018681','2018591','2018480','2018479','2018435','2018434'
   ,'2018170','201889','201850','201814','20184','2017670','2017668','2017649','2017646','2017645','2017644',
'2017642','2017620','2017617','2017605','2017600','2017599','2017598','2017588','2017586','2017585','2017553',
'2017552','2017551','2017539','2017524','2017518','2017488','2017487','2017465','2017464','2017459','2017458',
'2017457','2017456','2017443','2017421','2017420','2017419','2017417','2017398','2017396','2017395','2017383',
'2017382','2017369','2017365','2017334','2017318','2017317','2017316','2017311','2017310','2017298','2017297',
'2017296','2017295','2017283','2017282','2017265','2017262','2017261','2017258','2017247','2017241','2017239',
'2017231','2017229','2017224','2017213','2017210','2017209','2017205','2017204','2017191','2017160','2017159',
'2017156','2017153','2017144','2017142','2017141','2017133','2017131','2017130','2017128','2017112','2017108',
'201793','201787','201782','201780','201776','201753','201729','201725','201724','201721','201720','201719',
'2016952','2016945','2016944','2016932','2016931','2016929','2016927','2016926','2016919','2016909','2016894',
'2016889','2016877','2016876','2016875','2016874','2016873','2016869','2016868','2016861','2016860','2016858',
'2016857','2016856','2016855','2016854','2016853','2016852','2016851','2016850','2016849','2016848','2016830',
'2016829','2016814','2016813','2016804','2016803','2016802','2016801','2016793','2016788','2016785','2016777',
'2016776','2016774','2016769','2016760','2016758','2016749','2016747','2016742','2016741','2016740','2016736',
'2016733','2016707','2016701','2016700','2016698','2016690','2016689','2016682','2016681','2016678','2016674',
'2016666','2016663','2016662','2016658','2016634','2016624','2016619','2016618','2016617','2016600','2016598',
'2016597','2016593','2016591','2016588','2016587','2016586','2016585','2016581','2016580','2016578','2016577',
'2016572','2016570','2016561','2016553','2016552','2016551','2016545','2016544','2016539','2016536','2016525',
'2016522','2016516','2016512','2016449','2016448','2016442','2016332','2016326','2016289','2016288','2016283',
'2016282','2016270','2016227','2016178','2016161','2016160','2016158','2016156','2016142','2016138','2016137',
'2016136','2016135','2016133','2016132','2015949','2016131','2016128','2016126','2016124','2016123','2016120',
'2016119','2016115','2016111','2016106','2016100','201697','201696','201693','201691','201689','201683','201679',
'201678','201670','201669','201668','201665','201656','201649','201648','201645','201644','201642','201641',
'201624','201622','201621','201620','201615')

                               ]]>
	</select>
	
	<select id="CSPURA001EMainSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
				SELECT /*CSPURA001EMainSelect*/ A.STD_YE,
				       A.STD_SLN,
				       A.STD_TASK_DVSN_CD,
				       F_CODE_NM('1000294',A.STD_TASK_DVSN_CD) AS STD_TASK_DVSN_NM,
				       A.STD_TASK_NM,
				       CASE WHEN LENGTHB(STD_TASK_NM) > 50 THEN SUBSTRB(A.STD_TASK_NM,1,50)||'...' ELSE A.STD_TASK_NM END AS STD_TASK_NM2,
				       A.CHGR_CNB_1 as CHGR_CNB1,
				       (SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.CHGR_CNB_1) AS CHGR_NAM1,
				       A.CHGR_CNB_2 as CHGR_CNB2,
				       (SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.CHGR_CNB_2) AS CHGR_NAM2,
				       A.CHGR_CNB_3 as CHGR_CNB3,
				       (SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.CHGR_CNB_3) AS CHGR_NAM3,
				       A.CHGR_CNB_4 as CHGR_CNB4,
				       (SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.CHGR_CNB_4) AS CHGR_NAM4,
				      	F_USR_INFO(A.CHGR_CNB_1,'2')
			    		||DECODE(A.CHGR_CNB_2,NULL,NULL,',')||DECODE(A.CHGR_CNB_2,NULL,NULL,F_USR_INFO(A.CHGR_CNB_2,'2'))
			    		||DECODE(A.CHGR_CNB_3,'','',',')||DECODE(A.CHGR_CNB_3,NULL,NULL,F_USR_INFO(A.CHGR_CNB_3,'2'))
			    		||DECODE(A.CHGR_CNB_4,'','',',')||DECODE(A.CHGR_CNB_4,NULL,NULL,F_USR_INFO(A.CHGR_CNB_4,'2')) AS TOT_NM,
				       A.RPT_DT,
				       A.DOC_ID,
				       A.DOC_TYP_CD,
				       A.AUD_STD_RMK,
				       A.FRT_USR_ID,
				       A.AUD_STD_SPH_CD,
				       F_CODE_NM('1000605',A.AUD_STD_SPH_CD) AS AUD_STD_SPH_NM,
				       A.STD_TYP_CD,
				       F_CODE_NM('1000654',A.STD_TYP_CD) AS STD_TYP_NM,
				       CASE WHEN (TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'))- TO_DATE(TO_CHAR(FRT_REGI_DH,'YYYYMMDD'))) < 30 THEN '1' ELSE '2' END AS NEW_YN
				       ,FNL_CMPT_DT
				       ,PBCT_DVSN_CD
				       ,F_CODE_NM('1000834',PBCT_DVSN_CD) AS PBCT_DVSN_NM
				       ,OPEN_DVSN_CD
				       ,F_CODE_NM('1000835',OPEN_DVSN_CD) AS OPEN_DVSN_NM
				       ,PBCT_NO_SLN
				       ,SUBSTR(PBCT_YM,0,4) AS PBCT_YY
				       ,SUBSTR(PBCT_YM,5,2) AS PBCT_MM
				       ,ACMP_DVSN_YE
				       ,A.ORG_CD1
				       ,F_ORG_INFO(A.ORG_CD1, '1') AS ORG_NM1
				       ,A.ORG_CD2
				       ,F_ORG_INFO(A.ORG_CD2, '1') AS ORG_NM2
				       ,A.ORG_CD3
				       ,F_ORG_INFO(A.ORG_CD3, '1') AS ORG_NM3
				       ,A.ORG_CD4
				       ,F_ORG_INFO(A.ORG_CD4, '1') AS ORG_NM4
				       ,F_ORG_INFO(A.ORG_CD1, '1')
				       ||DECODE(A.ORG_CD2,NULL,NULL,',')||DECODE(A.ORG_CD2,NULL,NULL,F_ORG_INFO(A.ORG_CD2,'1'))
				       ||DECODE(A.ORG_CD3,NULL,NULL,',')||DECODE(A.ORG_CD3,NULL,NULL,F_ORG_INFO(A.ORG_CD3,'1'))
				       ||DECODE(A.ORG_CD4,NULL,NULL,',')||DECODE(A.ORG_CD4,NULL,NULL,F_ORG_INFO(A.ORG_CD4,'1'))  AS TOT_ORG
				 FROM TBCSPURA001M A
				WHERE 1=1
		]]>	
			<dynamic>
				<isNotEmpty property="fromYmd">
				  AND A.RPT_DT &gt;= #fromYmd#
				</isNotEmpty>
				<isNotEmpty property="toYmd">
				  AND A.RPT_DT &lt;= #toYmd#
				</isNotEmpty>
				
				<isNotEmpty property="STD_TASK_DVSN_CD"> 
			  	AND A.STD_TASK_DVSN_CD IN 
			  	( SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
			                                        FROM DUAL A
			                                       CROSS JOIN(SELECT ','|| #STD_TASK_DVSN_CD# ||',' AS CODE FROM DUAL) B
			                                       CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )				
				</isNotEmpty>	
				
				<isNotEmpty property="CHGR_CNB"> 
				  AND (A.CHGR_CNB_1 = #CHGR_CNB# OR A.CHGR_CNB_2 = #CHGR_CNB# 
				  		OR	A.CHGR_CNB_3 = #CHGR_CNB# OR A.CHGR_CNB_4 = #CHGR_CNB#)
				</isNotEmpty>
				<isNotEmpty property="STD_TASK_NM">
				  AND STD_TASK_NM LIKE '%'||#STD_TASK_NM#||'%'
				</isNotEmpty>
				<isNotEmpty property="strSTD_TYP_CD">
				  AND STD_TYP_CD = #strSTD_TYP_CD#
				</isNotEmpty>
				<isNotEmpty property="strAUD_STD_SPH_CD">
				  AND AUD_STD_SPH_CD = #strAUD_STD_SPH_CD#
				</isNotEmpty>
				<isNotEmpty property="strOrgCd"> 
				  AND (A.ORG_CD1 = #strOrgCd# OR A.ORG_CD2 = #strOrgCd# 
				  		OR	A.ORG_CD3 = #strOrgCd# OR A.ORG_CD4 = #strOrgCd#)
				</isNotEmpty>
				<isNotEmpty property="strSTD_GRP_NO">
					<isEqual property="strSTD_GRP_NO" compareValue="1">
						AND STD_TYP_CD = '01'
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="2">
						AND STD_TYP_CD = '13'
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="3">
						AND STD_TYP_CD = '10'
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="4">
						AND STD_TYP_CD = '14'
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="5">
						AND STD_TYP_CD IN ('07','15')
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="6">
						AND STD_TYP_CD IN ('12','16')
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="7">
						AND STD_TYP_CD = '05'
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="8">
						AND STD_TYP_CD IN ('02','03','04','11')
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="9">
						AND STD_TYP_CD = '06'
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="10">
						AND STD_TYP_CD = '08'
					</isEqual>
					<isEqual property="strSTD_GRP_NO" compareValue="11">
						AND STD_TYP_CD = '09'
					</isEqual>
				  
				</isNotEmpty>
			</dynamic>
			 ORDER BY A.RPT_DT DESC
	</select>
	
	<update id="CSPURA001EUpdate" parameterClass="paramMap">
			UPDATE /*CSPURA001EUpdate*/ TBCSPURA001M
			SET FNL_MDF_DH = SYSDATE
			,PBCT_DVSN_CD = #PBCT_DVSN_CD#
			,OPEN_DVSN_CD = #OPEN_DVSN_CD#
			,PBCT_NO_SLN = #PBCT_NO_SLN#
			,PBCT_YM = #PBCT_YY#||#PBCT_MM#
			,ACMP_DVSN_YE = #ACMP_DVSN_YE#
			, FNL_CMPT_DT = #FNL_CMPT_DT#
			<isNotNull prepend="," property="STD_TASK_DVSN_CD">
				STD_TASK_DVSN_CD = #STD_TASK_DVSN_CD#
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_SPH_CD">
				AUD_STD_SPH_CD = #AUD_STD_SPH_CD#
			</isNotNull>
			<isNotNull prepend="," property="STD_TASK_NM">
				STD_TASK_NM = #STD_TASK_NM# 
			</isNotNull>
			<isNotNull prepend="," property="CHGR_CNB1">
				CHGR_CNB_1 = #CHGR_CNB1#
			</isNotNull>
			<isNotNull prepend="," property="CHGR_CNB2">
				CHGR_CNB_2 = #CHGR_CNB2#
			</isNotNull>
			<isNotNull prepend="," property="CHGR_CNB3">
				CHGR_CNB_3 = #CHGR_CNB3# 
			</isNotNull>
			<isNotNull prepend="," property="CHGR_CNB4">
				CHGR_CNB_4 = #CHGR_CNB4# 
			</isNotNull>
			<isNotNull prepend="," property="RPT_DT">
				RPT_DT = #RPT_DT# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_ID">
				DOC_ID = #DOC_ID# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_TYP_CD">
				DOC_TYP_CD = #DOC_TYP_CD#
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_RMK">
				AUD_STD_RMK = #AUD_STD_RMK# 
			</isNotNull>
			<isNotNull prepend="," property="STD_TYP_CD">
				STD_TYP_CD = #STD_TYP_CD# 
			</isNotNull>
			<isNotNull prepend="," property="ORG_CD1">
				ORG_CD1 = #ORG_CD1# 
			</isNotNull>
			<isNotNull prepend="," property="ORG_CD2">
				ORG_CD2 = #ORG_CD2# 
			</isNotNull>
			<isNotNull prepend="," property="ORG_CD3">
				ORG_CD3 = #ORG_CD3# 
			</isNotNull>
			<isNotNull prepend="," property="ORG_CD4">
				ORG_CD4 = #ORG_CD4# 
			</isNotNull>
			<isNotNull prepend="," property="FNL_USR_ID">
				FNL_USR_ID = #FNL_USR_ID#
			</isNotNull>
			<isNotNull prepend="," property="FNL_DEAL_DPT_CD">
				FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			</isNotNull>
			<isNotNull prepend="," property="FNL_MNU_ID">
				FNL_MNU_ID =#FNL_MNU_ID#
			</isNotNull>
			WHERE STD_YE = #STD_YE#
			  AND STD_SLN = #STD_SLN#
	</update>
	


	<delete id="CSPURA001EDelete" parameterClass="paramMap">
			DELETE FROM TBCSPURA001M
			 WHERE STD_YE = #STD_YE#
			   AND STD_SLN = #STD_SLN#
	</delete>
	
	<select id="CSPURA001EKeySelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	TO_CHAR(SYSDATE, 'YYYY') AS STD_YE
					,NVL(MAX(TO_NUMBER(STD_SLN))+1, 1) AS STD_SLN
			FROM	TBCSPURA001M
			WHERE	STD_YE = (SELECT TO_CHAR(SYSDATE, 'YYYY') FROM DUAL)
		]]>
	</select>
	
	<insert id="CSPURA001EInsert" parameterClass="paramMap">
        <![CDATA[       
				INSERT INTO TBCSPURA001M
				( 
				STD_YE, 
				STD_SLN, 
				STD_TASK_DVSN_CD, 
				STD_TASK_NM, 
				CHGR_CNB_1, 
				CHGR_CNB_2, 
				CHGR_CNB_3, 
				CHGR_CNB_4, 
				RPT_DT, 
				DOC_ID, 
				DOC_TYP_CD, 
				AUD_STD_RMK,
				AUD_STD_SPH_CD,
				STD_TYP_CD,  
				FRT_USR_ID, 
				FNL_USR_ID, 
				FNL_DEAL_DPT_CD, 
				FNL_MNU_ID, 
				FRT_REGI_DH, 
				FNL_MDF_DH
				,PBCT_DVSN_CD
				,OPEN_DVSN_CD
				,PBCT_NO_SLN
				,PBCT_YM
				,ACMP_DVSN_YE
				,FNL_CMPT_DT
				,ORG_CD1
				,ORG_CD2
				,ORG_CD3
				,ORG_CD4 )
				VALUES
				(
				#STD_YE#,
				#STD_SLN#,
				#STD_TASK_DVSN_CD#,
				#STD_TASK_NM#,
				#CHGR_CNB1#, 
				#CHGR_CNB2#, 
				#CHGR_CNB3#, 
				#CHGR_CNB4#, 
				#RPT_DT#, 
				#DOC_ID#, 
				#DOC_TYP_CD#, 
				#AUD_STD_RMK#,
				#AUD_STD_SPH_CD#,
				#STD_TYP_CD#,
				#FRT_USR_ID#, 
				#FNL_USR_ID#, 
				#FNL_DEAL_DPT_CD#, 
				#FNL_MNU_ID#, 
				SYSDATE,
				SYSDATE
				,#PBCT_DVSN_CD#
				,#OPEN_DVSN_CD#
				,#PBCT_NO_SLN#
				,#PBCT_YY#||#PBCT_MM#
				,#ACMP_DVSN_YE#
				,#FNL_CMPT_DT#
				,#ORG_CD1#
				,#ORG_CD2#
				,#ORG_CD3#
				,#ORG_CD4#
				)
        ]]>
	</insert>
	
	<!-- 이슈 리포트 시작 -->
	<select id="CSPURA003EMainSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
			SELECT 	STD_YE,
					STD_SLN,
					STD_ACTV_DVSN_CD,
					TIT_NM,
					WRIT_PEN_CNB_1 as WRIT_PEN_CNB1,
					WRIT_PEN_CNB_2 as WRIT_PEN_CNB2,
					WRIT_PEN_CNB_3 as WRIT_PEN_CNB3,
					WRIT_PEN_CNB_4 as WRIT_PEN_CNB4,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_1) AS WRIT_PSN_NAM1,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_2) AS WRIT_PSN_NAM2,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_3) AS WRIT_PSN_NAM3,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_4) AS WRIT_PSN_NAM4,
					F_USR_INFO(A.WRIT_PEN_CNB_1,'2')
		    		||DECODE(A.WRIT_PEN_CNB_2,NULL,NULL,',')||DECODE(A.WRIT_PEN_CNB_2,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_2,'2'))
		    		||DECODE(A.WRIT_PEN_CNB_3,'','',',')||DECODE(A.WRIT_PEN_CNB_3,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_3,'2'))
		    		||DECODE(A.WRIT_PEN_CNB_4,'','',',')||DECODE(A.WRIT_PEN_CNB_4,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_4,'2')) AS TOT_NM,
					DOC_ID,
					DOC_TYP_CD,
					STR_DT,
					AUD_STD_RMK,
					FRT_USR_ID,
					FNL_USR_ID,
					FNL_DEAL_DPT_CD,
					FNL_MNU_ID,
					FRT_REGI_DH,
					FNL_MDF_DH,
					AUD_STD_SPH_CD
			  FROM  TBCSPURA002M A
			 WHERE 1=1
			   AND STD_ACTV_DVSN_CD = '1'
		]]>	
			<dynamic>
				<isNotEmpty property="fromYmd">
				  AND A.STR_DT &gt;= #fromYmd#
				</isNotEmpty>
				<isNotEmpty property="toYmd">
				  AND A.STR_DT &lt;= #toYmd#
				</isNotEmpty>
				
				<isNotEmpty property="WRIT_PEN_CNB"> 
				  AND (A.WRIT_PEN_CNB_1 = #WRIT_PEN_CNB# OR A.WRIT_PEN_CNB_2 = #WRIT_PEN_CNB# 
				   OR  A.WRIT_PEN_CNB_3 = #WRIT_PEN_CNB# OR A.WRIT_PEN_CNB_4 = #WRIT_PEN_CNB#)
				</isNotEmpty>
				<isNotEmpty property="TIT_NM">
				  AND TIT_NM LIKE '%'||#TIT_NM#||'%'
				</isNotEmpty>
			</dynamic>
			 ORDER BY STD_YE DESC, TO_NUMBER(STD_SLN) DESC
	</select>
	
	<delete id="CSPURA003EDelete" parameterClass="paramMap">
			DELETE FROM TBCSPURA002M
			 WHERE STD_YE = #STD_YE#
			   AND STD_SLN = #STD_SLN#
			   AND STD_ACTV_DVSN_CD = '1'
	</delete>
	
	<update id="CSPURA003EUpdate" parameterClass="paramMap">
			UPDATE TBCSPURA002M
			SET FNL_MDF_DH = SYSDATE
			<isNotNull prepend="," property="TIT_NM">
				TIT_NM = #TIT_NM# 
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_SPH_CD">
				AUD_STD_SPH_CD = #AUD_STD_SPH_CD#
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB1">
				WRIT_PEN_CNB_1 = #WRIT_PEN_CNB1#
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB2">
				WRIT_PEN_CNB_2 = #WRIT_PEN_CNB2#
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB3">
				WRIT_PEN_CNB_3 = #WRIT_PEN_CNB3# 
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB4">
				WRIT_PEN_CNB_4 = #WRIT_PEN_CNB4# 
			</isNotNull>
			<isNotNull prepend="," property="STR_DT">
				STR_DT = #STR_DT# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_ID">
				DOC_ID = #DOC_ID# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_TYP_CD">
				DOC_TYP_CD = #DOC_TYP_CD#
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_RMK">
				AUD_STD_RMK = #AUD_STD_RMK# 
			</isNotNull>
			<isNotNull prepend="," property="FNL_USR_ID">
				FNL_USR_ID = #FNL_USR_ID#
			</isNotNull>
			<isNotNull prepend="," property="FNL_DEAL_DPT_CD">
				FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			</isNotNull>
			<isNotNull prepend="," property="FNL_MNU_ID">
				FNL_MNU_ID =#FNL_MNU_ID#
			</isNotNull>
			WHERE STD_YE = #STD_YE#
			  AND STD_SLN = #STD_SLN#
			  AND STD_ACTV_DVSN_CD = '1'
	</update>
	
	
	<insert id="CSPURA003EInsert" parameterClass="paramMap">
        <![CDATA[       
				INSERT INTO TBCSPURA002M
				( 
				STD_YE, 
				STD_SLN, 
				STD_ACTV_DVSN_CD, 
				TIT_NM, 
				WRIT_PEN_CNB_1, 
				WRIT_PEN_CNB_2, 
				WRIT_PEN_CNB_3, 
				WRIT_PEN_CNB_4, 
				STR_DT, 
				DOC_ID, 
				DOC_TYP_CD, 
				AUD_STD_RMK,
				AUD_STD_SPH_CD, 
				FRT_USR_ID, 
				FNL_USR_ID, 
				FNL_DEAL_DPT_CD, 
				FNL_MNU_ID, 
				FRT_REGI_DH, 
				FNL_MDF_DH )
				VALUES
				(
				(SELECT TO_CHAR(SYSDATE, 'YYYY') FROM DUAL),
				(SELECT NVL(MAX(TO_NUMBER(STD_SLN))+1, 1) FROM TBCSPURA002M 
				 WHERE STD_YE = (SELECT TO_CHAR(SYSDATE, 'YYYY') FROM DUAL)
				   AND STD_ACTV_DVSN_CD = '1'
				),
				'1',
				#TIT_NM#,
				#WRIT_PEN_CNB1#, 
				#WRIT_PEN_CNB2#, 
				#WRIT_PEN_CNB3#, 
				#WRIT_PEN_CNB4#, 
				#STR_DT#, 
				#DOC_ID#, 
				#DOC_TYP_CD#, 
				#AUD_STD_RMK#,
				#AUD_STD_SPH_CD#,
				#FRT_USR_ID#, 
				#FNL_USR_ID#, 
				#FNL_DEAL_DPT_CD#, 
				#FNL_MNU_ID#, 
				SYSDATE,
				SYSDATE
				)
        ]]>
	</insert>
	<!-- 이슈 리포트 종료 -->
	
	<!-- 국제/국내 세미나 시작 -->
	<select id="CSPURA004EMainSelect" parameterClass="paramMap"	resultClass="resultMap" >
		<![CDATA[       
			SELECT 	STD_YE,
					STD_SLN,
					STD_ACTV_DVSN_CD,
					TIT_NM,
					WRIT_PEN_CNB_1 as WRIT_PEN_CNB1,
					WRIT_PEN_CNB_2 as WRIT_PEN_CNB2,
					WRIT_PEN_CNB_3 as WRIT_PEN_CNB3,
					WRIT_PEN_CNB_4 as WRIT_PEN_CNB4,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_1) AS WRIT_PSN_NAM1,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_2) AS WRIT_PSN_NAM2,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_3) AS WRIT_PSN_NAM3,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_4) AS WRIT_PSN_NAM4,
					F_USR_INFO(A.WRIT_PEN_CNB_1,'2')
		    		||DECODE(A.WRIT_PEN_CNB_2,NULL,NULL,',')||DECODE(A.WRIT_PEN_CNB_2,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_2,'2'))
		    		||DECODE(A.WRIT_PEN_CNB_3,'','',',')||DECODE(A.WRIT_PEN_CNB_3,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_3,'2'))
		    		||DECODE(A.WRIT_PEN_CNB_4,'','',',')||DECODE(A.WRIT_PEN_CNB_4,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_4,'2')) AS TOT_NM,
					DOC_ID,
					DOC_TYP_CD,
					STR_DT,
					END_DT,
					TO_CHAR(TO_DATE(STR_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') || ' ~ ' || 
                    TO_CHAR(TO_DATE(END_DT, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS STR_END_DT,
					AUD_STD_RMK,
					FRT_USR_ID,
					FNL_USR_ID,
					FNL_DEAL_DPT_CD,
					FNL_MNU_ID,
					FRT_REGI_DH,
					FNL_MDF_DH,
					AUD_STD_SPH_CD
			  FROM  TBCSPURA002M A
			 WHERE 1=1
			   AND STD_ACTV_DVSN_CD = '2'
		]]>	
			<dynamic>
				<isNotEmpty property="fromYmd">
				  AND A.STR_DT &gt;= #fromYmd#
				</isNotEmpty>
				<isNotEmpty property="toYmd">
				  AND A.STR_DT &lt;= #toYmd#
				</isNotEmpty>
				<isNotEmpty property="fromYmd">
				  AND A.END_DT &gt;= #fromYmd#
				</isNotEmpty>
				<isNotEmpty property="toYmd">
				  AND A.END_DT &lt;= #toYmd#
				</isNotEmpty>
				
				<isNotEmpty property="WRIT_PEN_CNB"> 
				  AND (A.WRIT_PEN_CNB_1 = #WRIT_PEN_CNB# OR A.WRIT_PEN_CNB_2 = #WRIT_PEN_CNB# 
				   OR  A.WRIT_PEN_CNB_3 = #WRIT_PEN_CNB# OR A.WRIT_PEN_CNB_4 = #WRIT_PEN_CNB#)
				</isNotEmpty>
				<isNotEmpty property="TIT_NM">
				  AND TIT_NM LIKE '%'||#TIT_NM#||'%'
				</isNotEmpty>
			</dynamic>
			 ORDER BY STD_YE DESC, TO_NUMBER(STD_SLN) DESC
	</select>
	
	<delete id="CSPURA004EDelete" parameterClass="paramMap">
			DELETE FROM TBCSPURA002M
			 WHERE STD_YE = #STD_YE#
			   AND STD_SLN = #STD_SLN#
			   AND STD_ACTV_DVSN_CD = '2'
	</delete>
	
	<update id="CSPURA004EUpdate" parameterClass="paramMap">
			UPDATE TBCSPURA002M
			SET FNL_MDF_DH = SYSDATE
			<isNotNull prepend="," property="TIT_NM">
				TIT_NM = #TIT_NM# 
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_SPH_CD">
				AUD_STD_SPH_CD = #AUD_STD_SPH_CD# 
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB1">
				WRIT_PEN_CNB_1 = #WRIT_PEN_CNB1#
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB2">
				WRIT_PEN_CNB_2 = #WRIT_PEN_CNB2#
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB3">
				WRIT_PEN_CNB_3 = #WRIT_PEN_CNB3# 
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB4">
				WRIT_PEN_CNB_4 = #WRIT_PEN_CNB4# 
			</isNotNull>
			<isNotNull prepend="," property="STR_DT">
				STR_DT = #STR_DT# 
			</isNotNull>
		<isNotNull prepend="," property="END_DT">
				END_DT = #END_DT# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_ID">
				DOC_ID = #DOC_ID# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_TYP_CD">
				DOC_TYP_CD = #DOC_TYP_CD#
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_RMK">
				AUD_STD_RMK = #AUD_STD_RMK# 
			</isNotNull>
			<isNotNull prepend="," property="FNL_USR_ID">
				FNL_USR_ID = #FNL_USR_ID#
			</isNotNull>
			<isNotNull prepend="," property="FNL_DEAL_DPT_CD">
				FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			</isNotNull>
			<isNotNull prepend="," property="FNL_MNU_ID">
				FNL_MNU_ID =#FNL_MNU_ID#
			</isNotNull>
			WHERE STD_YE = #STD_YE#
			  AND STD_SLN = #STD_SLN#
			  AND STD_ACTV_DVSN_CD = '2'
	</update>
	
	
	<insert id="CSPURA004EInsert" parameterClass="paramMap">
        <![CDATA[       
				INSERT INTO TBCSPURA002M
				( 
				STD_YE, 
				STD_SLN, 
				STD_ACTV_DVSN_CD, 
				TIT_NM, 
				WRIT_PEN_CNB_1, 
				WRIT_PEN_CNB_2, 
				WRIT_PEN_CNB_3, 
				WRIT_PEN_CNB_4, 
				STR_DT, 
				END_DT,
				DOC_ID, 
				DOC_TYP_CD, 
				AUD_STD_RMK,
				AUD_STD_SPH_CD,
				FRT_USR_ID, 
				FNL_USR_ID, 
				FNL_DEAL_DPT_CD, 
				FNL_MNU_ID, 
				FRT_REGI_DH, 
				FNL_MDF_DH )
				VALUES
				(
				(SELECT TO_CHAR(SYSDATE, 'YYYY') FROM DUAL),
				(SELECT NVL(MAX(TO_NUMBER(STD_SLN))+1, 1) FROM TBCSPURA002M 
				 WHERE STD_YE = (SELECT TO_CHAR(SYSDATE, 'YYYY') FROM DUAL)
				   AND STD_ACTV_DVSN_CD = '2'
				),
				'2',
				#TIT_NM#,
				#WRIT_PEN_CNB1#, 
				#WRIT_PEN_CNB2#, 
				#WRIT_PEN_CNB3#, 
				#WRIT_PEN_CNB4#, 
				#STR_DT#,
				#END_DT#, 
				#DOC_ID#, 
				#DOC_TYP_CD#, 
				#AUD_STD_RMK#,
				#AUD_STD_SPH_CD#,
				#FRT_USR_ID#, 
				#FNL_USR_ID#, 
				#FNL_DEAL_DPT_CD#, 
				#FNL_MNU_ID#, 
				SYSDATE,
				SYSDATE
				)
        ]]>
	</insert>	
	<!-- 국제/국내 세미나 종료 -->
	
	<!-- 성과검사 보고서 시작 -->
	<select id="CSPURA002EMainSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
			SELECT 	STD_YE,
					STD_SLN,
					STD_ACTV_DVSN_CD,
					TIT_NM,
					WRIT_PEN_CNB_1 as WRIT_PEN_CNB1,
					WRIT_PEN_CNB_2 as WRIT_PEN_CNB2,
					WRIT_PEN_CNB_3 as WRIT_PEN_CNB3,
					WRIT_PEN_CNB_4 as WRIT_PEN_CNB4,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_1) AS WRIT_PSN_NAM1,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_2) AS WRIT_PSN_NAM2,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_3) AS WRIT_PSN_NAM3,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_4) AS WRIT_PSN_NAM4,
					F_USR_INFO(A.WRIT_PEN_CNB_1,'2')
		    		||DECODE(A.WRIT_PEN_CNB_2,NULL,NULL,',')||DECODE(A.WRIT_PEN_CNB_2,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_2,'2'))
		    		||DECODE(A.WRIT_PEN_CNB_3,'','',',')||DECODE(A.WRIT_PEN_CNB_3,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_3,'2'))
		    		||DECODE(A.WRIT_PEN_CNB_4,'','',',')||DECODE(A.WRIT_PEN_CNB_4,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_4,'2')) AS TOT_NM,
					DOC_ID,
					DOC_TYP_CD,
					STR_DT,
					AUD_STD_RMK,
					AUD_STD_SPH_CD,
					FRT_USR_ID,
					FNL_USR_ID,
					FNL_DEAL_DPT_CD,
					FNL_MNU_ID,
					FRT_REGI_DH,
					FNL_MDF_DH
			  FROM  TBCSPURA002M A
			 WHERE 1=1
			   AND STD_ACTV_DVSN_CD = '3'
		]]>	
			<dynamic>
				<isNotEmpty property="fromYmd">
				  AND A.STR_DT &gt;= #fromYmd#
				</isNotEmpty>
				<isNotEmpty property="toYmd">
				  AND A.STR_DT &lt;= #toYmd#
				</isNotEmpty>
				
				<isNotEmpty property="WRIT_PEN_CNB"> 
				  AND (A.WRIT_PEN_CNB_1 = #WRIT_PEN_CNB# OR A.WRIT_PEN_CNB_2 = #WRIT_PEN_CNB# 
				   OR  A.WRIT_PEN_CNB_3 = #WRIT_PEN_CNB# OR A.WRIT_PEN_CNB_4 = #WRIT_PEN_CNB#)
				</isNotEmpty>
				<isNotEmpty property="TIT_NM">
				  AND TIT_NM LIKE '%'||#TIT_NM#||'%'
				</isNotEmpty>
			</dynamic>
			 ORDER BY STD_YE DESC, TO_NUMBER(STD_SLN) DESC
	</select>
	
	<delete id="CSPURA002EDelete" parameterClass="paramMap">
			DELETE FROM TBCSPURA002M
			 WHERE STD_YE = #STD_YE#
			   AND STD_SLN = #STD_SLN#
			   AND STD_ACTV_DVSN_CD = '3'
	</delete>
	
	<update id="CSPURA002EUpdate" parameterClass="paramMap">
			UPDATE TBCSPURA002M
			SET FNL_MDF_DH = SYSDATE
			<isNotNull prepend="," property="TIT_NM">
				TIT_NM = #TIT_NM# 
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_SPH_CD">
				AUD_STD_SPH_CD = #AUD_STD_SPH_CD# 
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB1">
				WRIT_PEN_CNB_1 = #WRIT_PEN_CNB1#
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB2">
				WRIT_PEN_CNB_2 = #WRIT_PEN_CNB2#
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB3">
				WRIT_PEN_CNB_3 = #WRIT_PEN_CNB3# 
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB4">
				WRIT_PEN_CNB_4 = #WRIT_PEN_CNB4# 
			</isNotNull>
			<isNotNull prepend="," property="STR_DT">
				STR_DT = #STR_DT# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_ID">
				DOC_ID = #DOC_ID# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_TYP_CD">
				DOC_TYP_CD = #DOC_TYP_CD#
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_RMK">
				AUD_STD_RMK = #AUD_STD_RMK# 
			</isNotNull>
			<isNotNull prepend="," property="FNL_USR_ID">
				FNL_USR_ID = #FNL_USR_ID#
			</isNotNull>
			<isNotNull prepend="," property="FNL_DEAL_DPT_CD">
				FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			</isNotNull>
			<isNotNull prepend="," property="FNL_MNU_ID">
				FNL_MNU_ID =#FNL_MNU_ID#
			</isNotNull>
			WHERE STD_YE = #STD_YE#
			  AND STD_SLN = #STD_SLN#
			  AND STD_ACTV_DVSN_CD = '3'
	</update>
	
	
	<insert id="CSPURA002EInsert" parameterClass="paramMap">
        <![CDATA[       
				INSERT INTO TBCSPURA002M
				( 
				STD_YE, 
				STD_SLN, 
				STD_ACTV_DVSN_CD, 
				TIT_NM, 
				WRIT_PEN_CNB_1, 
				WRIT_PEN_CNB_2, 
				WRIT_PEN_CNB_3, 
				WRIT_PEN_CNB_4, 
				STR_DT, 
				DOC_ID, 
				DOC_TYP_CD, 
				AUD_STD_RMK,
				AUD_STD_SPH_CD, 
				FRT_USR_ID, 
				FNL_USR_ID, 
				FNL_DEAL_DPT_CD, 
				FNL_MNU_ID, 
				FRT_REGI_DH, 
				FNL_MDF_DH )
				VALUES
				(
				(SELECT TO_CHAR(SYSDATE, 'YYYY') FROM DUAL),
				(SELECT NVL(MAX(TO_NUMBER(STD_SLN))+1, 1) FROM TBCSPURA002M 
				 WHERE STD_YE = (SELECT TO_CHAR(SYSDATE, 'YYYY') FROM DUAL)
				   AND STD_ACTV_DVSN_CD = '3'
				),
				'3',
				#TIT_NM#,
				#WRIT_PEN_CNB1#, 
				#WRIT_PEN_CNB2#, 
				#WRIT_PEN_CNB3#, 
				#WRIT_PEN_CNB4#, 
				#STR_DT#, 
				#DOC_ID#, 
				#DOC_TYP_CD#, 
				#AUD_STD_RMK#,
				#AUD_STD_SPH_CD#,
				#FRT_USR_ID#, 
				#FNL_USR_ID#, 
				#FNL_DEAL_DPT_CD#, 
				#FNL_MNU_ID#, 
				SYSDATE,
				SYSDATE
				)
        ]]>
	</insert>
	<!-- 성과검사 보고서 종료 -->
	
	
	<!-- 감사환경 보고서 시작 -->
	<select id="CSPURA005EMainSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
			SELECT 	STD_YE,
					STD_SLN,
					STD_ACTV_DVSN_CD,
					TIT_NM,
					WRIT_PEN_CNB_1 as WRIT_PEN_CNB1,
					WRIT_PEN_CNB_2 as WRIT_PEN_CNB2,
					WRIT_PEN_CNB_3 as WRIT_PEN_CNB3,
					WRIT_PEN_CNB_4 as WRIT_PEN_CNB4,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_1) AS WRIT_PSN_NAM1,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_2) AS WRIT_PSN_NAM2,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_3) AS WRIT_PSN_NAM3,
					(SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = A.WRIT_PEN_CNB_4) AS WRIT_PSN_NAM4,
					F_USR_INFO(A.WRIT_PEN_CNB_1,'2')
		    		||DECODE(A.WRIT_PEN_CNB_2,NULL,NULL,',')||DECODE(A.WRIT_PEN_CNB_2,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_2,'2'))
		    		||DECODE(A.WRIT_PEN_CNB_3,'','',',')||DECODE(A.WRIT_PEN_CNB_3,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_3,'2'))
		    		||DECODE(A.WRIT_PEN_CNB_4,'','',',')||DECODE(A.WRIT_PEN_CNB_4,NULL,NULL,F_USR_INFO(A.WRIT_PEN_CNB_4,'2')) AS TOT_NM,
					DOC_ID,
					DOC_TYP_CD,
					STR_DT,
					AUD_STD_RMK,
					FRT_USR_ID,
					FNL_USR_ID,
					FNL_DEAL_DPT_CD,
					FNL_MNU_ID,
					FRT_REGI_DH,
					FNL_MDF_DH,
					AUD_STD_SPH_CD
			  FROM  TBCSPURA002M A
			 WHERE 1=1
			   AND STD_ACTV_DVSN_CD = '4'
		]]>	
			<dynamic>
				<isNotEmpty property="fromYmd">
				  AND A.STR_DT &gt;= #fromYmd#
				</isNotEmpty>
				<isNotEmpty property="toYmd">
				  AND A.STR_DT &lt;= #toYmd#
				</isNotEmpty>
				
				<isNotEmpty property="WRIT_PEN_CNB"> 
				  AND (A.WRIT_PEN_CNB_1 = #WRIT_PEN_CNB# OR A.WRIT_PEN_CNB_2 = #WRIT_PEN_CNB# 
				   OR  A.WRIT_PEN_CNB_3 = #WRIT_PEN_CNB# OR A.WRIT_PEN_CNB_4 = #WRIT_PEN_CNB#)
				</isNotEmpty>
				<isNotEmpty property="TIT_NM">
				  AND TIT_NM LIKE '%'||#TIT_NM#||'%'
				</isNotEmpty>
			</dynamic>
			 ORDER BY STD_YE DESC, TO_NUMBER(STD_SLN) DESC
	</select>
	
	<delete id="CSPURA005EDelete" parameterClass="paramMap">
			DELETE FROM TBCSPURA002M
			 WHERE STD_YE = #STD_YE#
			   AND STD_SLN = #STD_SLN#
			   AND STD_ACTV_DVSN_CD = '4'
	</delete>
	
	<update id="CSPURA005EUpdate" parameterClass="paramMap">
			UPDATE TBCSPURA002M
			SET FNL_MDF_DH = SYSDATE
			<isNotNull prepend="," property="TIT_NM">
				TIT_NM = #TIT_NM# 
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_SPH_CD">
				AUD_STD_SPH_CD = #AUD_STD_SPH_CD# 
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB1">
				WRIT_PEN_CNB_1 = #WRIT_PEN_CNB1#
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB2">
				WRIT_PEN_CNB_2 = #WRIT_PEN_CNB2#
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB3">
				WRIT_PEN_CNB_3 = #WRIT_PEN_CNB3# 
			</isNotNull>
			<isNotNull prepend="," property="WRIT_PEN_CNB4">
				WRIT_PEN_CNB_4 = #WRIT_PEN_CNB4# 
			</isNotNull>
			<isNotNull prepend="," property="STR_DT">
				STR_DT = #STR_DT# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_ID">
				DOC_ID = #DOC_ID# 
			</isNotNull>
			<isNotNull prepend="," property="DOC_TYP_CD">
				DOC_TYP_CD = #DOC_TYP_CD#
			</isNotNull>
			<isNotNull prepend="," property="AUD_STD_RMK">
				AUD_STD_RMK = #AUD_STD_RMK# 
			</isNotNull>
			<isNotNull prepend="," property="FNL_USR_ID">
				FNL_USR_ID = #FNL_USR_ID#
			</isNotNull>
			<isNotNull prepend="," property="FNL_DEAL_DPT_CD">
				FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			</isNotNull>
			<isNotNull prepend="," property="FNL_MNU_ID">
				FNL_MNU_ID =#FNL_MNU_ID#
			</isNotNull>
			WHERE STD_YE = #STD_YE#
			  AND STD_SLN = #STD_SLN#
			  AND STD_ACTV_DVSN_CD = '4'
	</update>
	
	
	<insert id="CSPURA005EInsert" parameterClass="paramMap">
        <![CDATA[       
				INSERT INTO TBCSPURA002M
				( 
				STD_YE, 
				STD_SLN, 
				STD_ACTV_DVSN_CD, 
				TIT_NM, 
				WRIT_PEN_CNB_1, 
				WRIT_PEN_CNB_2, 
				WRIT_PEN_CNB_3, 
				WRIT_PEN_CNB_4, 
				STR_DT, 
				DOC_ID, 
				DOC_TYP_CD, 
				AUD_STD_RMK,
				AUD_STD_SPH_CD, 
				FRT_USR_ID, 
				FNL_USR_ID, 
				FNL_DEAL_DPT_CD, 
				FNL_MNU_ID, 
				FRT_REGI_DH, 
				FNL_MDF_DH )
				VALUES
				(
				(SELECT TO_CHAR(SYSDATE, 'YYYY') FROM DUAL),
				(SELECT NVL(MAX(TO_NUMBER(STD_SLN))+1, 1) FROM TBCSPURA002M 
				 WHERE STD_YE = (SELECT TO_CHAR(SYSDATE, 'YYYY') FROM DUAL)
				   AND STD_ACTV_DVSN_CD = '4'
				),
				'4',
				#TIT_NM#,
				#WRIT_PEN_CNB1#, 
				#WRIT_PEN_CNB2#, 
				#WRIT_PEN_CNB2#, 
				#WRIT_PEN_CNB4#, 
				#STR_DT#, 
				#DOC_ID#, 
				#DOC_TYP_CD#, 
				#AUD_STD_RMK#,
				#AUD_STD_SPH_CD#,
				#FRT_USR_ID#, 
				#FNL_USR_ID#, 
				#FNL_DEAL_DPT_CD#, 
				#FNL_MNU_ID#, 
				SYSDATE,
				SYSDATE
				)
        ]]>
	</insert>
	<!-- 감사환경 보고서 종료 -->
	
	<select id="CSPURA002PMainSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
				SELECT 	/*CSPURA002PMainSelect*/ A.STD_YE,
				       	A.STD_SLN,
				       	F_CODE_NM('1000294',A.STD_TASK_DVSN_CD) AS STD_TASK_DVSN_NM,
				       	A.STD_TASK_NM,
				      	F_USR_INFO(A.CHGR_CNB_1,'2')
			    		||DECODE(A.CHGR_CNB_2,NULL,NULL,',')||DECODE(A.CHGR_CNB_2,NULL,NULL,F_USR_INFO(A.CHGR_CNB_2,'2'))
			    		||DECODE(A.CHGR_CNB_3,'','',',')||DECODE(A.CHGR_CNB_3,NULL,NULL,F_USR_INFO(A.CHGR_CNB_3,'2'))
			    		||DECODE(A.CHGR_CNB_4,'','',',')||DECODE(A.CHGR_CNB_4,NULL,NULL,F_USR_INFO(A.CHGR_CNB_4,'2')) AS CHGR_CNB1,
				       	A.RPT_DT,
				       	A.DOC_ID,
				       	A.AUD_STD_RMK,
				       	F_CODE_NM('1000605',A.AUD_STD_SPH_CD) AS AUD_STD_SPH_NM,
				       	F_CODE_NM('1000654',A.STD_TYP_CD) AS STD_TYP_NM
				 FROM 	TBCSPURA001M A
				WHERE 	1=1
				AND		STD_YE = #strSTD_YE#
				AND		STD_SLN = #strSTD_SLN#
				AND		STD_TASK_DVSN_CD = #strSTD_TASK_DVSN_CD#
		]]>	
	</select>
	
	
		<select id="CSPURA001EMainListExcel" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
				SELECT /*CSPURA001EMainListExcel*/ 
				       F_CODE_NM('1000294',A.STD_TASK_DVSN_CD) AS STD_TASK_DVSN_NM,
     				   A.STD_TASK_NM AS STD_TASK_NM2,
				      	F_USR_INFO(A.CHGR_CNB_1,'2')
			    		||DECODE(A.CHGR_CNB_2,NULL,NULL,',')||DECODE(A.CHGR_CNB_2,NULL,NULL,F_USR_INFO(A.CHGR_CNB_2,'2'))
			    		||DECODE(A.CHGR_CNB_3,'','',',')||DECODE(A.CHGR_CNB_3,NULL,NULL,F_USR_INFO(A.CHGR_CNB_3,'2'))
			    		||DECODE(A.CHGR_CNB_4,'','',',')||DECODE(A.CHGR_CNB_4,NULL,NULL,F_USR_INFO(A.CHGR_CNB_4,'2')) AS TOT_NM,
				       SUBSTR(A.RPT_DT, 0, 4) || '-' || SUBSTR(A.RPT_DT, 5, 2) || '-' || SUBSTR(A.RPT_DT, 7, 2) AS RPT_DT,
				       F_CODE_NM('1000605',A.AUD_STD_SPH_CD) AS AUD_STD_SPH_NM,
				       F_CODE_NM('1000654',A.STD_TYP_CD) AS STD_TYP_NM
				 FROM TBCSPURA001M A
				WHERE 1=1
		]]>	
			<dynamic>
				<isNotEmpty property="fromYmd">
				  AND A.RPT_DT &gt;= #fromYmd#
				</isNotEmpty>
				<isNotEmpty property="toYmd">
				  AND A.RPT_DT &lt;= #toYmd#
				</isNotEmpty>
				
				<isNotEmpty property="STD_TASK_DVSN_CD"> 
			  	AND A.STD_TASK_DVSN_CD IN 
			  	( SELECT SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
			                                        FROM DUAL A
			                                       CROSS JOIN(SELECT ','|| #STD_TASK_DVSN_CD# ||',' AS CODE FROM DUAL) B
			                                       CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )				
				</isNotEmpty>	
				
				<isNotEmpty property="CHGR_CNB"> 
				  AND (A.CHGR_CNB_1 = #CHGR_CNB# OR A.CHGR_CNB_2 = #CHGR_CNB# 
				  		OR	A.CHGR_CNB_3 = #CHGR_CNB# OR A.CHGR_CNB_4 = #CHGR_CNB#)
				</isNotEmpty>
				<isNotEmpty property="STD_TASK_NM">
				  AND STD_TASK_NM LIKE '%'||#STD_TASK_NM#||'%'
				</isNotEmpty>
				<isNotEmpty property="strSTD_TYP_CD">
				  AND STD_TYP_CD = #strSTD_TYP_CD#
				</isNotEmpty>
				<isNotEmpty property="strAUD_STD_SPH_CD">
				  AND AUD_STD_SPH_CD = #strAUD_STD_SPH_CD#
				</isNotEmpty>
				
			</dynamic>
			 ORDER BY A.RPT_DT DESC
	</select>
	
</sqlMap> 
