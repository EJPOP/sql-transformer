<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/aoe/002">

	<!-- 감사부서별 업무총괄 조회한다.-->
	<select id="CSPAOE112Qmainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[	
			SELECT EVL_YR       /*평가년도*/
			     , HLYR_DVSN_CD /*반기구분코드*/
			     , DPT_NM       /*부서명*/
			     , MDT_ASC      /*조정평점*/
			     , PSO_PER_ASC  /*인당평점*/
			     , ACMP_SUM     /*실적합계*/
			     , AUD_ACTV     /*감사활동*/
			     , MNT          /*모니터링*/
			     , CLSG_TSK     /*결산업무*/
			     , ANN_TSK      /*연보업무*/
			     , BLE_TSK      /*총괄업무*/
			     , ENFM_WHLS    /*집행전말*/
			     , ETC_TSK      /*기타업무*/
			     , OCM_RPRT     /*성과보고서*/
			     , LAW_MNT      /*법령모니터링*/
			     , SPRT_CVS     /*지원환산*/
			     , DPT_NOP      /*부서인원*/
			  FROM TBAOERST01
			 WHERE 1=1
			   AND EVL_YR		= #strEvlYr#
			   AND HLYR_DVSN_CD = #strHlyrDvsnCd#
			   AND DPT_NM       LIKE #strDeptNm#||'%'
			 ORDER BY EVL_YR, HLYR_DVSN_CD, DPT_NM
		  ]]>
	</select>
	
	<!-- 감사업무사항별 실적명세 -->
	<select id="CSPAOE113Qmainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[	
			SELECT EVL_YR           /*평가년도*/
			     , HLYR_DVSN_CD     /*반기구분코드*/
			     , D1.AUD_YR           /*감사년도*/
			     , D1.AUD_SNO          /*감사순번*/
			     , NVL(F_MNG_KND_AUDYRNO(D1.AUD_YR, D1.AUD_SNO, D2.AUD_KND_CD, '-'),D1.AUD_YR||'-'||D1.AUD_SNO) AS AUD_YR_NO
			     , D1.AUD_SBJ_NM       /*감사사항명*/
			     , DPT_NM           /*부서명*/
			     , D1.AUD_KND_NM       /*감사종류명*/
			     , MNDY             /*연인원*/
			     , STND_ASC         /*표준평점*/
			     , EVL_RK           /*평가등급*/
			     , EVL_ADVL         /*평가가중치*/
			     , EVL_ADDWGT_ASC   /*평가가중평점*/
			     , STEP_FNDT        /*단계기초*/
			     , STEP_TEND        /*단계기말*/
			     , DRIVE_RTE        /*추진율*/
			     , DRIVE_MDT_ASC    /*추진조정평점*/
			     , DLAY_PRD         /*지연기간*/
			     , DMK_RTE          /*감점율*/
			     , ASP_MDT_ASC      /*가감점조정평점*/
			     , SPE_ADP          /*특별가산점*/
			     , TSK_ASC          /*업무평점*/
			  FROM TBAOERST02 D1, TBBADDED001M D2
			 WHERE 1=1
			   AND EVL_YR		= #strEvlYr#
			   AND HLYR_DVSN_CD = #strHlyrDvsnCd#
			   AND D1.AUD_YR = D2.AUD_YR(+)
   			   AND D1.AUD_SNO = D2.AUD_NO(+)
		  ]]>
		  <isNotEmpty property="strAudSbjNm">
		  	   AND D1.AUD_SBJ_NM   LIKE #strAudSbjNm#||'%'
		  </isNotEmpty>	   
		  <isNotEmpty property="strAudYr">
		  	   AND D1.AUD_YR       = #strAudYr#
		  </isNotEmpty>	   
		  <isNotEmpty property="strAudNo">
		  	   AND CASE WHEN LENGTH(#strAudNo#) = 3 AND D2.AUD_GRN_NO = #strAudNo# THEN '1'
					WHEN LENGTH(#strAudNo#) <![CDATA[<>]]> 3 AND D1.AUD_SNO = #strAudNo# THEN '1'
					ELSE '' END = '1'
		  </isNotEmpty>	 
		  <isNotEmpty prepend="AND" property="strAudYrNoKndCd">
			SUBSTR(D2.AUD_KND_CD,3,1) = #strAudYrNoKndCd# 
		</isNotEmpty>  
		<![CDATA[				   
			 ORDER BY EVL_YR, HLYR_DVSN_CD, D1.AUD_YR , AUD_SNO
		  ]]>
	</select>
	
	<!-- 개인별 업무실적(감사사항) -->
	<select id="CSPAOE114Qmainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[	
			SELECT EVL_YR       /*평가년도*/
			     , HLYR_DVSN_CD /*반기구분코드*/
			     , NAM          /*성명*/
			     , RANK_NM      /*직급명*/
			     , BRDV_NM      /*국과명*/
			     , BLT_NM       /*소속명*/
			     , SPRT_YN      /*지원여부*/
			     , AUD_ACTV     /*감사활동*/
			     , MNT          /*모니터링*/
			     , CLSG_TSK     /*결산업무*/
			     , ANN_TSK      /*연보업무*/
			     , BLE_TSK      /*총괄업무*/
			     , ENFM_WHLS    /*집행전말*/
			     , ETC_TSK      /*기타업무*/
			     , OCM_RPRT     /*성과보고서*/
			     , LAW_MNT      /*법령모니터링*/
			     , RLTM_MNT     /*실시간모니터링*/
			     , SPRT_CVS     /*지원환산*/
			     , GNR_ASC      /*종합평점*/
			     , RNK      	/*순위*/
			  FROM TBAOERST03
			 WHERE 1=1			  
			   AND EVL_YR		= #strEvlYr#
			   AND HLYR_DVSN_CD = #strHlyrDvsnCd#
		]]>	
		<isNotEmpty property="strBrdvNm">
			   AND BRDV_NM      LIKE #strBrdvNm#||'%'
		</isNotEmpty>	  	
		<isNotEmpty property="strBltNm">
			   AND BLT_NM       LIKE #strBltNm#||'%'
		</isNotEmpty>	 
		<isNotEmpty property="strRankNm">
			   AND RANK_NM      LIKE #strRankNm#||'%'
		</isNotEmpty>
		<isNotEmpty property="strUsrNam">
			   AND NAM          LIKE #strUsrNam#||'%'
		</isNotEmpty>	 					  
		<![CDATA[				   
			 ORDER BY EVL_YR, HLYR_DVSN_CD, NAM
		]]>
	</select>
	
	<!-- 개인별 업무실적(지원부서) -->
	<select id="CSPAOE115Qmainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[	
			SELECT EVL_YR           /*평가년도*/
			     , HLYR_DVSN_CD     /*반기구분코드*/
			     , NAM              /*성명*/
			     , RANK_NM          /*직급명*/
			     , BRDV_NM          /*국과명*/
			     , DPT_NM           /*부서명*/
			     , LOCN_SUM         /*기여도합계*/
			     , PSN_CVS_ASC      /*개인환산평점*/
			     , AUD_SPRT         /*감사지원*/
			     , NAUD_SPRT        /*감사외지원*/
			     , PSN_GNR_ASC      /*개인종합평점*/
			     , RNK              /*순위*/
			  FROM TBAOERST04
			 WHERE 1=1			  
			   AND EVL_YR		= #strEvlYr#
			   AND HLYR_DVSN_CD = #strHlyrDvsnCd#
		]]>	
		<isNotEmpty property="strBrdvNm">
			   AND BRDV_NM       LIKE #strBrdvNm#||'%'
		</isNotEmpty>	  	
		<isNotEmpty property="strBltNm">
			   AND DPT_NM        LIKE #strBltNm#||'%'
		</isNotEmpty>	 
		<isNotEmpty property="strRankNm">
			   AND RANK_NM       LIKE #strRankNm#||'%'
		</isNotEmpty>	
		<isNotEmpty property="strUsrNam">
			   AND NAM           LIKE #strUsrNam#||'%'
		</isNotEmpty> 					  
		<![CDATA[				   
			 ORDER BY EVL_YR, HLYR_DVSN_CD, NAM
		]]>
	</select>	

	<!-- 관리운영직 개인별 업무실적 -->
	<select id="CSPAOE116Qmainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[	
			SELECT EVL_YR       /*평가년도*/
			     , HLYR_DVSN_CD /*반기구분코드*/
			     , BRDV_NM      /*국과명*/
			     , DPT_NM       /*부서명*/
			     , RANK_NM      /*직급명*/
			     , NAM          /*성명*/
			     , ACMP_EVL     /*실적평가*/
			     , RNK          /*순위*/
			     , RANK_DVSN_NM /*직급구분명*/
			  FROM TBAOERST05
			 WHERE 1=1			  
			   AND EVL_YR		= #strEvlYr#
			   AND HLYR_DVSN_CD = #strHlyrDvsnCd#
		]]>	
		<isNotEmpty property="strBrdvNm">
			   AND BRDV_NM      LIKE #strBrdvNm#||'%'
		</isNotEmpty>	  	
		<isNotEmpty property="strBltNm">
			   AND DPT_NM       LIKE #strBltNm#||'%'
		</isNotEmpty>	 
		<isNotEmpty property="strRankNm">
			   AND RANK_NM      LIKE #strRankNm#||'%'
		</isNotEmpty>	
		<isNotEmpty property="strUsrNam">
			   AND NAM          LIKE #strUsrNam#||'%'
		</isNotEmpty> 	 					  
		<![CDATA[				   
			 ORDER BY EVL_YR, HLYR_DVSN_CD, NAM
		]]>
	</select>	
	
	<!-- 국단별 업무실적총괄(감사부서) -->
	<select id="CSPAOE117Qmainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[	
			SELECT EVL_YR       /*평가년도*/
			     , HLYR_DVSN_CD /*반기구분코드*/
			     , BRDV_NM      /*국과명*/
			     , MDT_ASC      /*조정평점*/
			     , PSO_PER_ASC  /*인당평점*/
			     , GNR_ASC      /*종합평점*/
			     , AUD_ACTV     /*감사활동*/
			     , MNT          /*모니터링*/
			     , CLSG_TSK     /*결산업무*/
			     , ANN_TSK      /*연보업무*/
			     , BLE_TSK      /*총괄업무*/
			     , ENFM_WHLS    /*집행전말*/
			     , ETC_TSK      /*기타업무*/
			     , OCM_RPRT     /*성과보고서*/
			     , LAW_MNT      /*법령모니터링*/
			     , RLTM_MNT     /*실시간모니터링*/
			     , SPRT_CVS     /*지원환산*/
			     , RNK          /*순위*/
			  FROM TBAOERST06	
			 WHERE 1=1			  
			   AND EVL_YR		= #strEvlYr#
			   AND HLYR_DVSN_CD = #strHlyrDvsnCd#
		]]>	
		<isNotEmpty property="strBltNm">
			   AND BRDV_NM      LIKE #strBltNm#||'%'
		</isNotEmpty>	 					  
		<![CDATA[				   
			 ORDER BY EVL_YR, HLYR_DVSN_CD, BRDV_NM
		]]>
	</select>		


	<!-- 지원업무 부서별 실적평가 -->
	<select id="CSPAOE118Qmainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[	
			SELECT EVL_YR       /*평가년도*/
			     , HLYR_DVSN_CD /*반기구분코드*/
			     , BRDV_NM      /*국과명*/
			     , DPT_NM       /*부서명*/
			     , PRZE_CLS_PEN_EVL_NM /*상급자평가명*/
			     , EVLT_1_SC    /*평가자1점수*/
			     , EVLT_2_SC    /*평가자2점수*/
			     , EVLT_3_SC    /*평가자3점수*/
			     , EVLT_4_SC    /*평가자4점수*/
			     , EVLT_5_SC    /*평가자5점수*/
			     , EVLT_6_SC    /*평가자6점수*/
			     , EVLT_7_SC    /*평가자7점수*/
			     , EVLT_8_SC    /*평가자8점수*/
			     , EVLT_9_SC    /*평가자9점수*/
			     , EVLT_10_SC   /*평가자10점수*/
			     , EVLT_11_SC   /*평가자11점수*/
			     , EVLT_12_SC   /*평가자12점수*/
			     , EVLT_13_SC   /*평가자13점수*/
			     , EVLT_14_SC   /*평가자14점수*/
			     , EVLT_15_SC   /*평가자15점수*/
			     , EVLT_16_SC   /*평가자16점수*/
			     , EVLT_17_SC   /*평가자17점수*/
			     , EVLT_18_SC   /*평가자18점수*/
			     , EVLT_19_SC   /*평가자19점수*/
			     , EVLT_20_SC   /*평가자20점수*/
			     , EVLT_21_SC   /*평가자21점수*/
			     , EVLT_22_SC   /*평가자22점수*/
			     , EVLT_23_SC   /*평가자23점수*/
			     , TSC          /*총점*/
			     , AV           /*평균*/
			     , RNK          /*순위*/
			  FROM TBAOERST07
			 WHERE 1=1			  
			   AND EVL_YR		= #strEvlYr#
			   AND HLYR_DVSN_CD = #strHlyrDvsnCd#
		]]>	
		<isNotEmpty property="strBrdvNm">
			   AND BRDV_NM      LIKE #strBrdvNm#||'%'
		</isNotEmpty>	  	
		<isNotEmpty property="strBltNm">
			   AND DPT_NM       LIKE #strBltNm#||'%'
		</isNotEmpty>					  
		<![CDATA[				   
			 ORDER BY EVL_YR, HLYR_DVSN_CD, BRDV_NM, DPT_NM, PRZE_CLS_PEN_EVL_NM
		]]>
	</select>			
	
</sqlMap> 	