<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/dcp/614">
 	
 	<resultMap class="java.util.HashMap" id="mainMap">
	
	<result property="CV_PET_CATE_NM" column="CV_PET_CATE_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PET_CATE_CD" column="CV_PET_CATE_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="JUBSUNO" column="JUBSUNO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACCT_ROUTE_CD" column="ACCT_ROUTE_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACCT_ROUTE_NM" column="ACCT_ROUTE_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PETER_NM" column="CV_PETER_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PETER_REL_ORG_NM" column="CV_PETER_REL_ORG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PETER_EMAIL" column="CV_PETER_EMAIL" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PETER_TEL" column="CV_PETER_TEL" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PETER_TEL2" column="CV_PETER_TEL2" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PETER_TEL_RMK" column="CV_PETER_TEL_RMK" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PETER_ADDR" column="CV_PETER_ADDR" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="GWANNO" column="GWANNO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TRAN_ORG_NM" column="TRAN_ORG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACCT_DATE" column="ACCT_DATE" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	
	<result property="SUMM_PSON_DEPT_NM" column="SUMM_PSON_DEPT_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACCT_USR_NM" column="ACCT_USR_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TITLE" column="TITLE" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	
	<result property="USR_NAM" column="USR_NAM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REL_ORG_NM" column="REL_ORG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
     <result property="SUP_ORG_NM" column="SUP_ORG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
    
    <result property="CV_PET_ORIGIN_NM" column="CV_PET_ORIGIN_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PET_CAUSE_NM" column="CV_PET_CAUSE_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
    <result property="CV_PET_HNDL_DIRC_NM" column="CV_PET_HNDL_DIRC_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
    <result property="FREQUENT_OCCUR_YN" column="FREQUENT_OCCUR_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
    <result property="BUDGET_WASTE_YN" column="BUDGET_WASTE_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
    <result property="PERSONAL_PROTECT_YN" column="PERSONAL_PROTECT_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
    <result property="HNDL_ORG_NM" column="HNDL_ORG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
    <result property="APV_DATE" column="APV_DATE" jdbcType="VARCHAR2"	javaType="java.lang.String" /> 
    <result property="OPER_DATE" column="OPER_DATE" jdbcType="VARCHAR2"	javaType="java.lang.String" />
    <result property="OPER_DEGREE" column="OPER_DEGREE" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="OPER_REASON" column="OPER_REASON" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	
	<result property="CV_PET_SUMM" column="CV_PET_SUMM" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="SMG_CVPT_APL_NO" column="SMG_CVPT_APL_NO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
			
    </resultMap>
 	
 	
 	<select id="CSPDCP614QSelectMain" parameterClass="paramMap"
		resultMap="mainMap">
		<![CDATA[
		 SELECT D1.CV_PET_CATE_CD
		       ,(SELECT S1.CD_NM
				  FROM CM_ETCCD S1
				 WHERE S1.CD_TYPE = 'AS09'
				   AND S1.CD      = D1.CV_PET_CATE_CD) CV_PET_CATE_NM
		       ,D1.YEAR||'-'||D1.CV_PET_CATE_CD||'-'||D1.ACCT_NO AS JUBSUNO
		       ,D1.ACCT_ROUTE_CD
		       ,(SELECT S2.CD_NM
		           FROM CM_ETCCD S2
		          WHERE S2.CD_TYPE = 'AS18'
		            AND S2.CD = D1.ACCT_ROUTE_CD) AS ACCT_ROUTE_NM
		       ,D1.CV_PETER_NM
		       ,D1.CV_PETER_REL_ORG_NM
		       ,D1.CV_PETER_EMAIL
		       ,D1.CV_PETER_TEL
		       ,D1.CV_PETER_TEL2
		       ,D1.CV_PETER_TEL_RMK
		       ,D1.CV_PETER_ADDR
		       ,D1.LAST_REPEAT_YEAR||NVL2(D1.LAST_REPEAT_YEAR, '-', '')||D1.LAST_REPEAT_ACCT_NO AS GWANNO
		       ,F_ORG_INFO(D1.TRAN_ORG_CD, '1') AS TRAN_ORG_NM
		       ,TO_CHAR(TO_DATE(D1.ACCT_DATE, 'YYYYMMDD'), 'YYYY-MM-DD') AS ACCT_DATE
		       ,F_DPT_INFO(D1.SUMM_PSON_DEPT_CD, '1') AS SUMM_PSON_DEPT_NM 
		       ,'' AS ACCT_USR_NM
		       ,D1.TITLE
		       ,D1.CV_PET_SUMM
		       ,(SELECT S3.USR_NAM FROM TBDCMACM001M S3 WHERE  S3.CNB = D1.SUMM_PSON_EMPLNUM) AS USR_NAM
		       ,F_ORG_INFO(D1.REL_ORG_CD, '1') AS REL_ORG_NM
		       ,F_ORG_INFO(D1.SUP_ORG_CD, '1') AS SUP_ORG_NM
		       ,(SELECT S6.CD_NM
		           FROM CM_ETCCD S6
		          WHERE S6.CD_TYPE = 'AS11'
		            AND S6.CD = D1.CV_PET_ORIGIN_CD) AS CV_PET_ORIGIN_NM
		       ,(SELECT S4.CD_NM
		           FROM CM_ETCCD S4
		          WHERE S4.CD_TYPE = 'AS12'
		            AND S4.CD = D1.CV_PET_CAUSE_CD)  AS CV_PET_CAUSE_NM
		       ,(SELECT S5.CD_NM
		           FROM CM_ETCCD S5
		          WHERE S5.CD_TYPE = 'AS13'
		            AND S5.CD = D1.CV_PET_HNDL_DIRC_CD)  AS CV_PET_HNDL_DIRC_NM
		       ,D1.FREQUENT_OCCUR_YN
		       ,D1.BUDGET_WASTE_YN
		       ,D1.PERSONAL_PROTECT_YN
		       ,F_ORG_INFO(NVL(D1.HNDL_ORG_CD_1, NVL(D1.HNDL_ORG_CD_2, D1.HNDL_ORG_CD_3)), '1') AS HNDL_ORG_NM
		       /*,TO_CHAR(TO_DATE(D1.APV_DATE,'YYYYMMDD'), 'YYYY-MM-DD') AS APV_DATE*/
		       ,D1.APV_DATE
		       ,TO_CHAR(TO_DATE(D1.OPER_DATE,'YYYYMMDD'), 'YYYY-MM-DD') AS OPER_DATE
		       ,D1.OPER_DEGREE
		       ,D1.OPER_REASON
		       ,D1.SMG_CVPT_APL_NO
		  FROM AM_CV_PET_HNDL_DOC D1
		 WHERE 1=1
		   AND D1.CV_PET_CATE_CD = #CV_PET_CATE_CD#
		   AND D1.YEAR           = #YEAR#
		   AND D1.ACCT_NO        = #ACCT_NO#
   ]]>
	</select>
 	
</sqlMap> 
