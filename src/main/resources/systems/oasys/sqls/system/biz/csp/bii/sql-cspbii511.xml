<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/bii/511">
	<!-- 기본정보 조회 -->   
	<select id="CSPBII511QMainSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[       
			SELECT A.YE || '-' || LPAD(A.SRNO, 5, '0')      AS MTRL_NO
			     , B.NAM
			     , SUBSTR(B.EIN, 1, 6) || '-*******'        AS RRN			     
			     , (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.BLT_ORG_CD)         AS BLT_ORG_NM
			     , A.PST_NM
			     , F_CODE_NM('1000070', A.EVL_MTRL_DVSN_CD)  AS EVL_MTRL_DVSN_NM
			     , (SELECT B.DPT_NM
			          FROM TBDCMACM002M B
			         WHERE B.DPT_CD = A.EVL_DPT_CD)         AS EVL_DPT_NM  /* 평가부서명 */
			     , A.EVL_DPT_CD
			     , A.EVL_DT
			     , CASE B.RSG_YN WHEN 'Y' THEN B.RSG_YN
			                     ELSE ''
			       END                                      AS RSG_YN
			     , A.YE
			     , A.SRNO    
			     , A.EIN
			     , A.FRT_USR_ID
			  FROM TBCSPBII500L A  /* 직무역량평가내역 */
			     , TBCSPBII300M B  /* 대인정보기본 */  
			 WHERE A.EIN = B.EIN			
		]]>
			<isNotEmpty property="strNam">
				AND B.NAM LIKE #strNam# || '%'
			</isNotEmpty>
			<isNotEmpty property="strEin">
				AND A.EIN LIKE #strEin# || '%'
			</isNotEmpty>
			<isNotEmpty property="strStrEvlDt">
				AND A.EVL_DT >= #strStrEvlDt#
			</isNotEmpty>
			<isNotEmpty property="strEndEvlDt">
				AND A.EVL_DT &lt;= #strEndEvlDt#
			</isNotEmpty>			
			<isNotEmpty property="strEvlMtrlDvsnCd">
				AND A.EVL_MTRL_DVSN_CD = #strEvlMtrlDvsnCd#
			</isNotEmpty>
			<isNotEmpty property="strBltOrgCd">
				AND A.BLT_ORG_CD = #strBltOrgCd#
			</isNotEmpty>
			<isNotEmpty property="strRsgYn">
				AND B.RSG_YN = #strRsgYn#
			</isNotEmpty>
			ORDER BY MTRL_NO DESC
	</select>
</sqlMap> 
