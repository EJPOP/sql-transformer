<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/034">

	<select id="FAACAV034Emainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/034/FAACAV034Emainselect */ ]]>
		<include refid="include.pageSelct" />		
        <![CDATA[        
			SELECT 
					ROWNUM AS KEY, 
					COPT_CD||'-'||ACNT_CD||'-'||BLL_CD||'-'||PROF_DRTR_SRNO||'-'|| DL_XPN_RCDB_PBSVT_SRNO AS PROF_DRTR_SG,
			       ORG_NM, 
			       CRE_DT,
			       ABLT_DT AS DEL_YEAR
			 FROM TWFAACAV003M
			 WHERE 1 = 1
			   AND SUBSTR(ABLT_DT,1,4) <= #strYear#		
        ]]>  
		<include refid="include.pageOrder" />
		ORDER BY KEY, PROF_DRTR_SG
	</select>

	
	<delete id="FAACAV034Emaindelete" parameterClass="paramMap"	>
		<![CDATA[  /* faa/cav/034/FAACAV034Emaindelete */ ]]>
        <![CDATA[        
		   DELETE 
			 FROM 	TWFAACAV003M
			WHERE SUBSTR(ABLT_DT,1,4) <= TO_CHAR(TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY'))-6) /* 5년경과된 자료만 대상 */
			
        ]]>  
	</delete>	
	
	
</sqlMap> 
