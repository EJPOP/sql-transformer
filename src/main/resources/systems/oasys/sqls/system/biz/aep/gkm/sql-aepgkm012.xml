<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">
<!-- 

- 인자값 가져오기
컬럼명 = #파라미터명#

- SQLMAP.xml 기본 골격
<sqlMap namespace="">
	<select id="" parameterClass="" resultClass="">
	</select>
	<insert id="" parameterClass="">
	</insert>
	<update id="" parameterClass="">
	</update>
	<delete id="" parameterClass="">
	</delete>
</sqlMap>

- SQLMAP.xml 세부 골격
<isNotNull property="속성명" prepend="AND, OR">
</isNotNull>
<isNotEmpty property="" prepend="" removeFirstPrepend="">
</isNotEmpty>
<isNull property="">
	<isEqual property="" compareValue="">
   	</isEqual>
</isNull>
-->
<sqlMap namespace="AEPGKM012P">
	<select id="AEPGKM012P.SELECT.DGE_CD" resultClass="java.util.HashMap">
		SELECT	*
		FROM	TBDCMACM013C
		WHERE	CMM_CD_DVSN_CD = '1000346'
		AND		PRD_USE_YN IS NULL
	</select>

	<select id="AEPGKM012P.SELECT" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	*
		FROM	(
				SELECT	FLOOR((ROWNUM - 1) / #SRN# + 1) AS PAGE, ROWNUM, A.*
				FROM	(
						SELECT	A.ORG_CD AS ORG_CD<!-- 기관코드 -->,
								A.ORG_NM AS ORG_NM<!-- 기관명 -->,
								A.RGN_CD AS RGN_CD<!-- 지역코드 -->,
								A.ORG_DVSN_CD AS ORG_DVSN_CD<!-- 기관구분코드 -->,
								F_CODE_NM('1000119',A.ORG_DVSN_CD) AS DVSN_NM<!-- 기관구분명 -->,
								A.ORG_DGE_CD AS ORG_DGE_CD<!-- 기관차수코드 -->,
								F_CODE_NM('1000346',A.ORG_DGE_CD) AS DGE_NM<!-- 기관차수명 -->,
								A.COPT_SG_CD AS COPT_SG_CD<!-- 소관부호코드 -->,
								B.ORG_NM AS HIRK_ORG_NM<!-- 소관청명 -->
						FROM	TBDCMACM015M A,
								TBDCMACM015M B
						WHERE	1=1
						AND		(A.COPT_SG_CD || '000000000') = B.ORG_CD(+)
						<isNotEmpty property="ORG_NM_CD" prepend="AND">
								(
								A.ORG_NM LIKE '%' || #ORG_NM_CD# || '%'
								OR
								A.ORG_CD LIKE '%' || #ORG_NM_CD# || '%'
								)
						</isNotEmpty>
						<isNotEmpty property="USE_DVSN_NO" prepend="AND">
								A.USE_DVSN_NO = #USE_DVSN_NO#
						</isNotEmpty>
						<isNotEmpty property="HIRK_ORG_NM" prepend="AND">
								B.ORG_NM LIKE '%' || #HIRK_ORG_NM# || '%'
						</isNotEmpty>
						<isNotEmpty property="ORG_DGE_CD" prepend="AND">
								A.ORG_DGE_CD = #ORG_DGE_CD#
						</isNotEmpty>
						ORDER BY ORG_CD
						) AS A
				)
		WHERE	PAGE = #CPN#
	</select>
	
	<select id="AEPGKM012P.SELECT.TAB" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	TAB,
				MIN(PAGE) AS MIN_PAGE,
				MAX(PAGE) AS MAX_PAGE
		FROM	(
				SELECT	FLOOR((PAGE - 1) / 10) AS TAB, A.PAGE
				FROM	(
						SELECT	FLOOR((ROWNUM - 1) / #SRN# + 1) AS PAGE, ROWNUM AS RN
						FROM	(
								SELECT	A.ORG_CD
								FROM	TBDCMACM015M A,
										TBDCMACM015M B
								WHERE	1=1
								AND		(A.COPT_SG_CD || '000000000') = B.ORG_CD(+)
								<isNotEmpty property="ORG_NM_CD" prepend="AND">
										(
										A.ORG_NM LIKE '%' || #ORG_NM_CD# || '%'
										OR
										A.ORG_CD LIKE '%' || #ORG_NM_CD# || '%'
										)
								</isNotEmpty>
								<isNotEmpty property="USE_DVSN_NO" prepend="AND">
										A.USE_DVSN_NO = #USE_DVSN_NO#
								</isNotEmpty>
								<isNotEmpty property="HIRK_ORG_NM" prepend="AND">
										B.ORG_NM LIKE '%' || #HIRK_ORG_NM# || '%'
								</isNotEmpty>
								<isNotEmpty property="ORG_DGE_CD" prepend="AND">
										A.ORG_DGE_CD = #ORG_DGE_CD#
								</isNotEmpty>
								ORDER BY A.ORG_CD
								)
						) AS A
				GROUP BY A.PAGE
				)
		WHERE	TAB = #TAB#
		GROUP BY TAB
	</select>
	
	<select id="AEPGKM012P.TOTAL" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT	MAX(FLOOR((ROWNUM - 1) / #SRN# + 1)) AS TOTAL
		FROM	(
				SELECT	A.ORG_CD
				FROM	TBDCMACM015M A,
						TBDCMACM015M B
				WHERE	1=1
				AND		(A.COPT_SG_CD || '000000000') = B.ORG_CD(+)
				<isNotEmpty property="ORG_NM_CD" prepend="AND">
						(
						A.ORG_NM LIKE '%' || #ORG_NM_CD# || '%'
						OR
						A.ORG_CD LIKE '%' || #ORG_NM_CD# || '%'
						)
				</isNotEmpty>
				<isNotEmpty property="USE_DVSN_NO" prepend="AND">
						A.USE_DVSN_NO = #USE_DVSN_NO#
				</isNotEmpty>
				<isNotEmpty property="HIRK_ORG_NM" prepend="AND">
						B.ORG_NM LIKE '%' || #HIRK_ORG_NM# || '%'
				</isNotEmpty>
				<isNotEmpty property="ORG_DGE_CD" prepend="AND">
						A.ORG_DGE_CD = #ORG_DGE_CD#
				</isNotEmpty>
				ORDER BY ORG_CD
				)
	</select>
	
	<select id="AEPGKM012P.SELECT.DVSN_NO">
	
	</select>
</sqlMap>