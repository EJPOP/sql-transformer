<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/bii/315">
		
	<!-- 개인사진 조회 -->
	<select id="CSPBII315PMainSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[       
			SELECT A.NAM                                            /* 성명 */
			     , A.EIN                                            /* 암호화주민등록번호 */
			     , (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.BLT_ORG_CD) AS BLT_ORG_NM   /* 소속기관명 */	
			     , A.PST_NM || '/' || A.RANK_NM       AS PST_NM     /* 직위/직급명 */
			     , A.DOC_ID                                     /* 사진문서ID */ 
			  FROM TBCSPBII300M A  /* 대인정보기본 */
			 WHERE A.EIN = #strEin#
		]]>
	</select>
	
	<!-- 개인사진 수정 -->
	<update id="CSPBII315PupdateMain" parameterClass="paramMap">
		UPDATE TBCSPBII300M                       
		   SET DOC_ID          = #DOC_ID#            /* 문서ID */
		     , DOC_TYP_CD      = #DOC_TYP_CD#        /* 문서유형코드 */
		     , FNL_USR_ID      = #FNL_USR_ID#        /* 최종사용자ID */
		     , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#   /* 최종거래부서코드 */
		     , FNL_MNU_ID      = 'CSPBII315P'        /* 최종메뉴ID */
		     <!-- , FNL_MNU_ID      = #FNL_MNU_ID#*/        /* 최종메뉴ID */  -->
		     , FNL_MDF_DH      = SYSDATE             /* 최종수정일시 */
		 WHERE EIN = #EIN#
	</update>
	
	<!-- 개인사진 삭제 -->
	<update id="CSPBII315PdeleteMain" parameterClass="paramMap">
		UPDATE TBCSPBII300M                       
		   SET DOC_ID          = NULL                /* 문서ID */
		     , DOC_TYP_CD      = NULL                /* 문서유형코드 */
		     <!-- , FNL_USR_ID      = #FNL_USR_ID#        /* 최종사용자ID */ -->
		     , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#   /* 최종거래부서코드 */
		     , FNL_MNU_ID      = 'CSPBII315P'        /* 최종메뉴ID */
		     <!-- , FNL_MNU_ID      = #FNL_MNU_ID#*/        /* 최종메뉴ID */  -->
		     , FNL_MDF_DH      = SYSDATE             /* 최종수정일시 */
		 WHERE EIN = #EIN#
	</update>	
</sqlMap> 
