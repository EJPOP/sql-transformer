<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/cor/101">
 	
 	<select id="CSPCOR101EMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	T1.CORR_DVSN_CD
					,T1.ACP_YR
					,T1.CORR_ACP_NO
					,DECODE(T1.RM_CORR_ACP_NO,NULL,NULL,T1.ACP_YR||'-부감-'||T1.RM_CORR_ACP_NO) AS ACP_NO
					,T1.HMP_APL_NO
					,T1.NAM
					,T1.TIT_NM
					,TO_CHAR(T1.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
					,TO_CHAR(T1.FRT_REGI_DH,'YYYY-MM-DD HH24:MI') AS FRT_REGI_DH
					,T1.ACP_RUT_CD
					,F_CODE_NM('1000885',T1.ACP_RUT_CD) AS ACP_RUT_NM
					,T1.HNDL_STA_CD
					,F_CODE_NM('1000886',T1.HNDL_STA_CD) AS HNDL_STA_NM
					,T1.RM_CORR_ACP_NO
					,T1.EIN
					,T1.TNB
			FROM	TBCSPCOR101M T1
			WHERE	T1.CORR_DVSN_CD = '1'
		]]>
		<dynamic>
			<isNotEmpty property="strCORR_KND_CD">
				AND T1.CORR_KND_CD = #strCORR_KND_CD#
			</isNotEmpty>
			<isNotEmpty property="strCORR_KND_DTL_CD">
				AND T1.CORR_KND_DTL_CD = #strCORR_KND_DTL_CD#
			</isNotEmpty>
			<isNotEmpty property="strACP_YR">
				AND	T1.ACP_YR = #strACP_YR#
			</isNotEmpty>
			<isNotEmpty property="strRM_CORR_ACP_NO">
				AND	T1.RM_CORR_ACP_NO = #strRM_CORR_ACP_NO#
			</isNotEmpty>
			<isNotEmpty property="strFRT_REGI_DHS">
				AND	TO_CHAR(T1.FRT_REGI_DH,'YYYYMMDD') &gt;= #strFRT_REGI_DHS#
			</isNotEmpty>
			<isNotEmpty property="strFRT_REGI_DHE">
				AND	TO_CHAR(T1.FRT_REGI_DH,'YYYYMMDD') &lt;= #strFRT_REGI_DHE#
			</isNotEmpty>
			<isNotEmpty property="strHNDL_STA_CD">
				AND	T1.HNDL_STA_CD = #strHNDL_STA_CD#
			</isNotEmpty>
			<isNotEmpty property="strTIT_NM">
				AND	T1.TIT_NM LIKE '%'||#strTIT_NM#||'%'
			</isNotEmpty>
			<isNotEmpty property="strHMP_APL_NO">
				AND	T1.HMP_APL_NO = #strHMP_APL_NO#
			</isNotEmpty>
			<isNotEmpty property="strNAM">
				AND	T1.NAM LIKE '%'||#strNAM#||'%'
			</isNotEmpty>
		</dynamic>
		<![CDATA[
			ORDER BY T1.ACP_YR DESC,TO_NUMBER(T1.RM_CORR_ACP_NO) DESC
		]]>
	</select>
	
	<resultMap class="java.util.HashMap" id="sendINSPOR101Select">
			<result property="CORR_DVSN_CD" 			 column="CORR_DVSN_CD" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="ACP_YR" 						 column="ACP_YR" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="CORR_ACP_NO" 			 column="CORR_ACP_NO" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="DVSN_CD" 			 column="DVSN_CD" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="HMP_APL_NO" 				 column="HMP_APL_NO" 				     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="CORR_KND_CD" 			 column="CORR_KND_CD" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="NAM" 							 column="NAM" 							     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="EIN" 							 column="EIN" 							     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="BLT_ORG_NM" 						 column="BLT_ORG_NM" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="AD" 								 column="AD" 								     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="TNB" 							 column="TNB" 							     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="DTL_AD" 						 column="DTL_AD" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="TIT_NM" 						 column="TIT_NM" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="CORR_EXCU_TXT" 		 column="CORR_EXCU_TXT" 		     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="CORR_TXT" 					 column="CORR_TXT" 					     jdbcType="CLOB" javaType="java.lang.String" />
			<result property="PEROPEN_AGR_YN" 			 column="PEROPEN_AGR_YN" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="OTHER_SUB_YN" 					 column="OTHER_SUB_YN" 					     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="OTHER_SUB_TXT" 				 column="OTHER_SUB_TXT" 				     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="ADMINI_YN" 			 column="ADMINI_YN" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="ACP_DH" 						 column="ACP_DH" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="HNDL_STA_CD" 			 column="HNDL_STA_CD" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="ANS_TXT" 					 column="ANS_TXT" 					     jdbcType="CLOB" javaType="java.lang.String" />
			<result property="FRT_REGI_DH" 			 column="FRT_REGI_DH" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="BLT_DPT_NM" 			 column="BLT_DPT_NM" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="DTY_YN" 			 column="DTY_YN" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="DTY_TXT" 			 column="DTY_TXT" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="HNDL_DH" 			 column="HNDL_DH" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
	</resultMap>
	
	
	<select id="sendINSPOR101Select" parameterClass="paramMap" resultMap="sendINSPOR101Select">
		<![CDATA[
			SELECT	T1.CORR_DVSN_CD
					,T1.ACP_YR
					,T1.RM_CORR_ACP_NO AS CORR_ACP_NO
					,#DVSN_CD# AS DVSN_CD
					,T1.HMP_APL_NO
					,'9999' AS CORR_KND_CD
					,T1.NAM
					,T1.EIN
					,T1.BLT_ORG_NM
					,T1.AD
					,T1.TNB
					,T1.DTL_AD
					,T1.TIT_NM
					,T1.CORR_EXCU_TXT
					,T1.CORR_TXT
					,T1.PEROPEN_AGR_YN
					,T1.OTHER_SUB_YN
					,T1.OTHER_SUB_TXT
					,T1.ADMINI_YN
					,TO_CHAR(T1.ACP_DH, 'YYYYMMDDHH24MISS') AS ACP_DH
					,T1.HNDL_STA_CD
					,T1.ANS_TXT
					,TO_CHAR(T1.FRT_REGI_DH, 'YYYYMMDDHH24MISS') AS FRT_REGI_DH
					,T1.BLT_DPT_NM
					,T1.DTY_YN
					,T1.DTY_TXT
					,TO_CHAR(T1.HNDL_DH, 'YYYYMMDDHH24MISS') HNDL_DH
			FROM	TBCSPCOR101M T1
			WHERE	T1.CORR_DVSN_CD = #CORR_DVSN_CD#
			AND		T1.ACP_YR = #ACP_YR#
			AND		T1.CORR_ACP_NO = #CORR_ACP_NO#
		]]>
	</select>
	
	<insert id="sendINSPOR101Insert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO EH_INF_SP_CP_811
					(	IF_SEQ
						,IF_TYPE
						,DVSN_CD
						,HMP_APL_NO
						,STTM_DVSN_CD
						,ACP_YR
						,STTM_ACP_NO
						,STTM_KND_CD
						,STTM_KND_DTL_CD
						,NAM
						,EIN
						,JB_NM
						,AD
						,TNB
						,TIT_NM
						,STTM_EXCU_TXT
						,STTM_TXT
						,RTRN_WAY_TXT
						,RMK_TXT
						,OTR_ORG_NM
						,INSPC_AGR_YN
						,OTR_INSPC_AGR_YN
						,ACP_DH
						,HNDL_STA_CD
						,ANS_TXT
						,FRT_REGI_DH
						,EML_AD
						,STTM_TXT_DH
						,HNDL_DH
					)			
				VALUES	(	#IF_SEQ#
							,'SND'
							,#DVSN_CD#
							,#HMP_APL_NO#
							,#CORR_DVSN_CD#
							,#ACP_YR#
							,#CORR_ACP_NO#
							,#CORR_KND_CD#
							,#DTY_YN#
							,#NAM#
							,#EIN#
							,#BLT_ORG_NM#
							,#AD#
							,#TNB#
							,#TIT_NM#
							,#CORR_EXCU_TXT#
							,#CORR_TXT#
							,#OTHER_SUB_TXT#
							,#DTY_TXT#
							,#PEROPEN_AGR_YN#
							,#OTHER_SUB_YN#
							,#ADMINI_YN#
							,#ACP_DH#
							,#HNDL_STA_CD#
							,#ANS_TXT#
							,#FRT_REGI_DH#
							,#DTL_AD#
							,#BLT_DPT_NM#
							,#HNDL_DH#
						)
		]]>
	</insert>
	
	<select id="sendINSPOR102Select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	T2.CORR_DVSN_CD
					,T2.ACP_YR
					,#RM_CORR_ACP_NO# AS CORR_ACP_NO
					,#DVSN_CD# AS DVSN_CD
					,999 SRNO
					,T2.RES_NAM
					,T2.RES_TNB
					,T2.RES_JB_NM
					,T2.RES_AD||'|'||T2.RES_DTL_AD AS RES_AD
					,T2.RES_POS
			FROM	TBCSPCOR102M T2
			WHERE	T2.CORR_DVSN_CD = #CORR_DVSN_CD#
			AND		T2.ACP_YR = #ACP_YR#
			AND		T2.CORR_ACP_NO = #CORR_ACP_NO#
		]]>
	</select>
	
	<insert id="sendINSPOR102Insert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO
				EH_INF_SP_CP_812
					(  	IF_SEQ
						, IF_TYPE
						, DVSN_CD
						, SRNO
						, HMP_APL_NO
						, STTM_DVSN_CD
						, ACP_YR
						, STTM_ACP_NO
						, RES_NAM
						, RES_TNB
						, RES_JB_NM
						, RES_AD
						, CRP_NM
					)
					VALUES
						(  	#IF_SEQ#
							, 'SND' 
							, #DVSN_CD#
							, #SRNO#
							,#HMP_APL_NO#
							,#CORR_DVSN_CD#
							,#ACP_YR#
							,#CORR_ACP_NO#
							, #RES_NAM#
							, #RES_TNB#
							, #RES_JB_NM#
							, #RES_AD#
							, #RES_POS# 
						)
		]]>
	</insert>
	
	
	
	<select id="sendINSPOR101SelectSUC" parameterClass="paramMap" resultMap="sendINSPOR101Select">
		<![CDATA[
			SELECT	T1.CORR_DVSN_CD
					,T1.ACP_YR
					,T1.RM_CORR_ACP_NO AS CORR_ACP_NO
					,#DVSN_CD# AS DVSN_CD
					,T1.HMP_APL_NO
					,'9999' AS CORR_KND_CD
					,T1.NAM
					,T1.EIN
					,T1.BLT_ORG_NM
					,T1.AD
					,T1.TNB
					,T1.DTL_AD
					,T1.TIT_NM
					,T1.CORR_EXCU_TXT
					,T1.CORR_TXT
					,T1.PEROPEN_AGR_YN
					,T1.OTHER_SUB_YN
					,T1.OTHER_SUB_TXT
					,T1.ADMINI_YN
					,TO_CHAR(T1.ACP_DH, 'YYYYMMDDHH24MISS') AS ACP_DH
					,T1.HNDL_STA_CD
					,T1.ANS_TXT
					,TO_CHAR(T1.FRT_REGI_DH, 'YYYYMMDDHH24MISS') AS FRT_REGI_DH
					,T1.BLT_DPT_NM
					,T1.DTY_YN
					,T1.DTY_TXT
					,TO_CHAR(T1.HNDL_DH, 'YYYYMMDDHH24MISS') HNDL_DH
			FROM	TBCSPCOR101M T1
			WHERE	T1.CORR_DVSN_CD = #CORR_DVSN_CD#
			AND		T1.ACP_YR = #ACP_YR#
			AND		T1.CORR_ACP_NO = #CORR_ACP_NO#
			UNION ALL
			SELECT	T1.CORR_DVSN_CD
					,T1.ACP_YR
					,T1.RM_CORR_ACP_NO AS CORR_ACP_NO
					,#DVSN_CD# AS DVSN_CD
					,T1.HMP_APL_NO
					,'9999' AS CORR_KND_CD
					,T1.NAM
					,T1.EIN
					,T1.BLT_ORG_NM
					,T1.AD
					,T1.TNB
					,T1.DTL_AD
					,T1.TIT_NM
					,T1.CORR_EXCU_TXT
					,T1.CORR_TXT
					,T1.PEROPEN_AGR_YN
					,T1.OTHER_SUB_YN
					,T1.OTHER_SUB_TXT
					,T1.ADMINI_YN
					,TO_CHAR(T1.ACP_DH, 'YYYYMMDDHH24MISS') AS ACP_DH
					,T1.HNDL_STA_CD
					,T1.ANS_TXT
					,TO_CHAR(T1.FRT_REGI_DH, 'YYYYMMDDHH24MISS') AS FRT_REGI_DH
					,T1.BLT_DPT_NM
					,T1.DTY_YN
					,T1.DTY_TXT
					,TO_CHAR(T1.HNDL_DH, 'YYYYMMDDHH24MISS') HNDL_DH
			FROM	TBCSPCOR101M T1
			WHERE	(T1.CORR_DVSN_CD, T1.ACP_YR, T1.CORR_ACP_NO) IN ( SELECT S1.SUC_CORR_DVSN_CD ,S1.SUC_ACP_YR, S1.SUC_CORR_ACP_NO
			                                                            FROM TBCSPCOR107L S1
			                                                           WHERE S1.CORR_DVSN_CD = #CORR_DVSN_CD#
			                                                             AND S1.ACP_YR = #ACP_YR#
			                                                             AND S1.CORR_ACP_NO = #CORR_ACP_NO#
			                                                        )
			
		]]>
	</select>
	
</sqlMap> 
