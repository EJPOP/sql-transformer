<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="bad/ear/055">
	
	<!--감사결정례 조회-->
	<select id="BADEAR055PMainSelect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[    
                   SELECT T1.DCSEXP_YR                                           AS DCSEXP_YR              /* 결정례년도 */
                         ,T1.DCSEXP_NO                                           AS DCSEXP_NO              /* 결정례순번 */
                         ,T1.DCSEXP_TIT_NM                                       AS DCSEXP_TIT_NM          /* 결정례제목 */
                         ,T1.DCSEXP_SPH_CD                                       AS DCSEXP_SPH_CD          /* 결정례감사분야코드 */
                         ,F_CODE_NM('1000741', T1.DCSEXP_SPH_CD)                 AS DCSEXP_SPH_NM          /* 결정례감사분야명 */
                         ,T1.DCS_SBT                                             AS DCS_SBT                /* 결정요지 */
                         ,T1.AUD_YR                                              AS AUD_YR                 /* 감사년도 */
                         ,T1.AUD_NO                                              AS AUD_NO                 /* 감사번호 */
                         ,T1.DSP_RQ_SNO                                          AS DSP_RQ_SNO             /* 처분요구순번 */
                         ,(SELECT MIN(RLTN_ORG_CD)
                             FROM TBBADEAR006M 
                            WHERE AUD_YR     = T1.AUD_YR
                              AND AUD_NO     = T1.AUD_NO
                              AND DSP_RQ_SNO = T1.DSP_RQ_SNO)                    AS RLTN_ORG_CD            /* 관계기관코드 */
                         ,(SELECT F_ORG_INFO(MIN(RLTN_ORG_CD),'1')
                             FROM TBBADEAR006M 
                            WHERE AUD_YR     = T1.AUD_YR
                              AND AUD_NO     = T1.AUD_NO
                              AND DSP_RQ_SNO = T1.DSP_RQ_SNO)                    AS RLTN_ORG_NM            /* 관계기관명 */
                         ,CASE WHEN T1.DCSEXP_TXT IS NOT NULL THEN 'Y'
                               ELSE 'N'
                           END                                                   AS DCSEXP_TXT_YN          /* 결정례내용 존재여부 */
                         ,CASE WHEN T1.DCSEXP_EXPLA_TXT IS NOT NULL THEN 'Y'
                               ELSE 'N'
                           END                                                   AS DCSEXP_EXPLA_TXT_YN    /* 결정례해설내용 존재여부 */ 
                    FROM TBBADEAR034M T1    /* 감사결정례기본 */
                   WHERE 1=1
		]]>		
        
        <isNotEmpty property="strDcsExpYr">
                     AND T1.DCSEXP_YR = #strDcsExpYr# 
        </isNotEmpty>	
        <isNotEmpty property="strDcsExpNo">
                     AND T1.DCSEXP_NO = #strDcsExpNo# 
        </isNotEmpty>						
	</select>


	<resultMap class="java.util.HashMap" id="hwpselect">
		<result property="DCSEXP_YR"            column="DCSEXP_YR"           jdbcType="VARCHAR2"  javaType="java.lang.String"/>  
		<result property="DCSEXP_NO"            column="DCSEXP_NO"           jdbcType="VARCHAR2"  javaType="java.lang.String"/>  
		<result property="DCSEXP_TIT_NM"        column="DCSEXP_TIT_NM"       jdbcType="VARCHAR2"  javaType="java.lang.String"/>  
		<result property="DCSEXP_SPH_CD"        column="DCSEXP_SPH_CD"       jdbcType="VARCHAR2"  javaType="java.lang.String"/>  
		<result property="DCSEXP_SPH_NM"        column="DCSEXP_SPH_NM"       jdbcType="VARCHAR2"  javaType="java.lang.String"/>  
		<result property="DCS_SBT"              column="DCS_SBT"             jdbcType="VARCHAR2"  javaType="java.lang.String"/>  
		<result property="AUD_YR"               column="AUD_YR"              jdbcType="VARCHAR2"  javaType="java.lang.String"/>  
		<result property="AUD_NO"               column="AUD_NO"              jdbcType="VARCHAR2"  javaType="java.lang.String"/>  
		<result property="DSP_RQ_SNO"           column="DSP_RQ_SNO"          jdbcType="VARCHAR2"  javaType="java.lang.String"/>  
		<result property="DCSEXP_TXT"           column="DCSEXP_TXT"          jdbcType="CLOB"      javaType="java.lang.String"/>
		<result property="DCSEXP_EXPLA_TXT"     column="DCSEXP_EXPLA_TXT"    jdbcType="CLOB"      javaType="java.lang.String"/>
	</resultMap>
	
	
	<!--감사결정례 hwp 조회-->
	<select id="BADEAR055PHwpPopUpSelect" parameterClass="paramMap" resultMap="hwpselect">	
        <![CDATA[    
                   SELECT T1.DCSEXP_YR                                           AS DCSEXP_YR              /* 결정례년도 */
                         ,T1.DCSEXP_NO                                           AS DCSEXP_NO              /* 결정례순번 */
                         ,T1.DCSEXP_TIT_NM                                       AS DCSEXP_TIT_NM          /* 결정례제목 */
                         ,T1.DCSEXP_SPH_CD                                       AS DCSEXP_SPH_CD          /* 결정례감사분야코드 */
                         ,F_CODE_NM('1000741', T1.DCSEXP_SPH_CD)                 AS DCSEXP_SPH_NM          /* 결정례감사분야명 */
                         ,T1.DCS_SBT                                             AS DCS_SBT                /* 결정요지 */
                         ,T1.AUD_YR                                              AS AUD_YR                 /* 감사년도 */
                         ,T1.AUD_NO                                              AS AUD_NO                 /* 감사번호 */
                         ,T1.DSP_RQ_SNO                                          AS DSP_RQ_SNO             /* 처분요구순번 */ 
                         ,T1.DCSEXP_TXT                                          AS DCSEXP_TXT             /* 결정례내용 */ 
                         ,T1.DCSEXP_EXPLA_TXT                                    AS DCSEXP_EXPLA_TXT       /* 결정례해설내용 */   
                    FROM TBBADEAR034M T1    /* 감사결정례기본 */
                   WHERE 1=1
		]]>		
        
        <isNotEmpty property="strDcsExpYr">
                     AND T1.DCSEXP_YR = #strDcsExpYr# 
        </isNotEmpty>	
        <isNotEmpty property="strDcsExpNo">
                     AND T1.DCSEXP_NO = #strDcsExpNo# 
        </isNotEmpty>						
	</select>
</sqlMap> 
