<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/008">
	<!--개별검산 오류내역 상세조회 존재 확인-->
	<select id="FAACAV008ESelectErrDtail" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESelectErrDtail */ ]]>
			SELECT ROWNUM AS RN,
			       A.COPT_CD||'-'||A.ACNT_CD||'-'||A.BLL_CD||'-'||A.PROF_DRTR_SRNO||'-'|| A.DL_XPN_RCDB_PBSVT_SRNO PROF_DRTR_SG,
			       A.COPT_CD,
			       A.ACNT_CD,
			       A.BLL_CD,
			       A.PROF_DRTR_SRNO,
			       A.DL_XPN_RCDB_PBSVT_SRNO,
			       A.PROF_YM,
			       A.ACP_DH ,
			       DECODE(A.HNDL_STA_YN, 'S', '불부합확정', 'K', '불부합대기', 'Y', '불부합사유확인', 'N', '검산오류') HNDL_STA,
			       A.HNDL_DH ,
			       B.ORG_NM,
			       F_AV_ACNT_CD_NM(A.ACNT_CD) ACNTNM,
			       DECODE(B.ABLT_DT, '999999', '') ABLT_DT,
			       B.MDF_PEN_NM,
			       B.TNB,
			       F_AV_BLL_COPT_CD_NM(A.COPT_CD) COPTNM
			  FROM TWFAACAV016M A,
			       TWFAACAV003M B
			 WHERE 1 = 1
		        AND A.COPT_CD = B.COPT_CD
	            AND A.ACNT_CD = B.ACNT_CD
	            AND A.BLL_CD  = B.BLL_CD
	            AND A.PROF_DRTR_SRNO = B.PROF_DRTR_SRNO
	            AND A.DL_XPN_RCDB_PBSVT_SRNO = B.DL_XPN_RCDB_PBSVT_SRNO
		        AND A.COPT_CD = #strCoptCd# 
	            AND A.ACNT_CD = #strAcntCd#
	            AND A.BLL_CD  = #strBllCd#
	            AND A.PROF_DRTR_SRNO = #strProfDrtrSrno# 
	            AND A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno# 
	            AND A.PROF_YM  = #strYm#
	</select>	
	
	
	<!--증명책임자부호 존재 확인-->
	<select id="FAACAV008ESelectExist" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESelectExist */ ]]>
		SELECT COUNT(*) AS CDCNT 
		FROM
		 TWFAACAV003M
		WHERE
		 COPT_CD = #strCoptCd#
		 AND ACNT_CD =#strAcntCd#
		 AND BLL_CD = #strBllCd#
		 AND PROF_DRTR_SRNO = #strProfDrtrSrno#
		 AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#                                  
	</select>	

	<!--지출계산서 UPDATE-->
	<update id="FAACAV008EUpdate_1" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_1 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV048L
			   SET 
			     THMN_EXPN_BND_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXPN_BND_AMT#)), 0)
				,THMN_TO_EXPN_BND_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_BND_ATAG#)), 0)
				,THMN_EXPN_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXPN_AMT#)), 0)
				,LTMN_TO_EXPN_ATAG = NVL(TO_NUMBER(TRIM(#LTMN_TO_EXPN_ATAG#)), 0)
				,THMN_REN_EXPN_AMT = NVL(TO_NUMBER(TRIM(#THMN_REN_EXPN_AMT#)), 0)
				,THMN_SUBJ_ASO_RCTF_EXPN_AMT = NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_EXPN_AMT#)), 0)
				,EXPN_SBTR_ATAG = NVL(TO_NUMBER(TRIM(#EXPN_SBTR_ATAG#)), 0)
				,EXPN_BND_BL = NVL(TO_NUMBER(TRIM(#EXPN_BND_BL#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--지출계산서 DELETE-->
	<update id="FAACAV008EDelete_1" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_1 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV048L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--지출계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_1" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_1 */ ]]>
		INSERT INTO TWFAACAV048L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
			,THMN_EXPN_BND_AMT
			,THMN_TO_EXPN_BND_ATAG
			,THMN_EXPN_AMT
			,LTMN_TO_EXPN_ATAG
			,THMN_REN_EXPN_AMT
			,THMN_SUBJ_ASO_RCTF_EXPN_AMT
			,EXPN_SBTR_ATAG
			,EXPN_BND_BL  
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#CHIF_CD#
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXPN_BND_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_BND_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTMN_TO_EXPN_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_REN_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#EXPN_SBTR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#EXPN_BND_BL#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--지출계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_1" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_1 */ ]]>
		INSERT INTO TWFAACAV048L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
			,THMN_EXPN_BND_AMT
			,THMN_TO_EXPN_BND_ATAG
			,THMN_EXPN_AMT
			,LTMN_TO_EXPN_ATAG
			,THMN_REN_EXPN_AMT
			,THMN_SUBJ_ASO_RCTF_EXPN_AMT
			,EXPN_SBTR_ATAG
			,EXPN_BND_BL  
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','000','0000','000','000'
		    ,NVL(SUM(THMN_EXPN_BND_AMT), 0) AS THMN_EXPN_BND_AMT
		    ,NVL(SUM(THMN_TO_EXPN_BND_ATAG), 0) AS THMN_TO_EXPN_BND_ATAG
		    ,NVL(SUM(THMN_EXPN_AMT), 0) AS THMN_EXPN_AMT
		    ,NVL(SUM(LTMN_TO_EXPN_ATAG), 0) AS LTMN_TO_EXPN_ATAG
		    ,NVL(SUM(THMN_REN_EXPN_AMT), 0) AS THMN_REN_EXPN_AMT
		    ,NVL(SUM(THMN_SUBJ_ASO_RCTF_EXPN_AMT), 0) AS THMN_SUBJ_ASO_RCTF_EXPN_AMT
		    ,NVL(SUM(EXPN_SBTR_ATAG), 0) AS EXPN_SBTR_ATAG
		    ,NVL(SUM(EXPN_BND_BL), 0) AS EXPN_BND_BL
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV048L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 )   
	</insert>	
	
    <!--통합지출관계산서 UPDATE-->
	<update id="FAACAV008EUpdate_2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_2 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV033L
			   SET  
				 THMN_FND_ALC_AMT = NVL(TO_NUMBER(TRIM(#THMN_FND_ALC_AMT#)), 0)
				,THMN_TO_FND_ALC_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_FND_ALC_ATAG#)), 0)
				,THMN_EXPN_RQ_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXPN_RQ_AMT#)), 0)
				,THMN_TO_EXPN_RQ_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_RQ_ATAG#)), 0)
				,EXPN_AMT = NVL(TO_NUMBER(TRIM(#EXPN_AMT#)), 0)
				,THMN_TO_EXPN_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_ATAG#)), 0)
				,THMN_REN_EXPN_AMT = NVL(TO_NUMBER(TRIM(#THMN_REN_EXPN_AMT#)), 0)
				,EXPN_SBTR_ATAG = NVL(TO_NUMBER(TRIM(#EXPN_SBTR_ATAG#)), 0)
				,NEXPN_AMT = NVL(TO_NUMBER(TRIM(#NEXPN_AMT#)), 0)
                ,THMN_GOV_OP_XPN = NVL(TO_NUMBER(TRIM(#THMN_GOV_OP_XPN#)), 0)
				,THMN_TO_GOV_OP_XPN_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_GOV_OP_XPN_ATAG#)), 0)
				,GOV_OP_XPN_REN_AMT = NVL(TO_NUMBER(TRIM(#GOV_OP_XPN_REN_AMT#)), 0)
				,GOV_OP_XPN_SBTR_ATAG = NVL(TO_NUMBER(TRIM(#GOV_OP_XPN_SBTR_ATAG#)), 0)
				,EXPN_ATAG = NVL(TO_NUMBER(TRIM(#EXPN_ATAG#)), 0)
				,BL = NVL(TO_NUMBER(TRIM(#BL#)), 0)
				,NPMT_AMT = NVL(TO_NUMBER(TRIM(#NPMT_AMT#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND DTM_COPT_CD=#DTM_COPT_CD#
			  AND DTM_ACNT_CD=#DTM_ACNT_CD#
			  AND DTM_BLL_CD=#DTM_BLL_CD#
			  AND DTM_PROF_DRTR_SRNO=#DTM_PROF_DRTR_SRNO#
			  AND DTM_DL_XPN_RCDB_PBSVT_SRNO=#DTM_DL_XPN_RCDB_PBSVT_SRNO#
	</update>
	<!--통합지출관계산서 DELETE-->
	<update id="FAACAV008EDelete_2" parameterClass="paramMap">	
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_2 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV033L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND DTM_COPT_CD=#DTM_COPT_CD#
			  AND DTM_ACNT_CD=#DTM_ACNT_CD#
			  AND DTM_BLL_CD=#DTM_BLL_CD#
			  AND DTM_PROF_DRTR_SRNO=#DTM_PROF_DRTR_SRNO#
			  AND DTM_DL_XPN_RCDB_PBSVT_SRNO=#DTM_DL_XPN_RCDB_PBSVT_SRNO#
	</update>
	
	<!--통합지출관계산서 예산과목 추가 -->
	<insert id="FAACAV008EInsert_2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_2 */ ]]>
		INSERT INTO TWFAACAV033L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,DTM_COPT_CD
			,DTM_ACNT_CD
			,DTM_BLL_CD
			,DTM_PROF_DRTR_SRNO
			,DTM_DL_XPN_RCDB_PBSVT_SRNO
			, THMN_FND_ALC_AMT
			, THMN_TO_FND_ALC_ATAG
			, THMN_EXPN_RQ_AMT
			, THMN_TO_EXPN_RQ_ATAG
			, EXPN_AMT
			, THMN_TO_EXPN_ATAG
			, THMN_REN_EXPN_AMT
			, EXPN_SBTR_ATAG
			, NEXPN_AMT
			, THMN_GOV_OP_XPN
			, THMN_TO_GOV_OP_XPN_ATAG
			, GOV_OP_XPN_REN_AMT
			, GOV_OP_XPN_SBTR_ATAG
			, EXPN_ATAG
			, BL
			, NPMT_AMT 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#DTM_COPT_CD#
			  ,#DTM_ACNT_CD#
			  ,#DTM_BLL_CD#
			  ,#DTM_PROF_DRTR_SRNO#
			  ,#DTM_DL_XPN_RCDB_PBSVT_SRNO#
			  ,NVL(TO_NUMBER(TRIM(#THMN_FND_ALC_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_FND_ALC_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXPN_RQ_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_RQ_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_REN_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#EXPN_SBTR_ATAG#)), 0)	  
			  ,NVL(TO_NUMBER(TRIM(#NEXPN_AMT#))	, 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_GOV_OP_XPN#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_GOV_OP_XPN_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#GOV_OP_XPN_REN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#GOV_OP_XPN_SBTR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#EXPN_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#BL#)), 0)  
			  ,NVL(TO_NUMBER(TRIM(#NPMT_AMT#)), 0), 0)              
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--통합지출관계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/"FAACAV008ESumInsert_2" */ ]]>
		INSERT INTO TWFAACAV033L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,DTM_COPT_CD
			,DTM_ACNT_CD
			,DTM_BLL_CD
			,DTM_PROF_DRTR_SRNO
			,DTM_DL_XPN_RCDB_PBSVT_SRNO
			, THMN_FND_ALC_AMT
			, THMN_TO_FND_ALC_ATAG
			, THMN_EXPN_RQ_AMT
			, THMN_TO_EXPN_RQ_ATAG
			, EXPN_AMT
			, THMN_TO_EXPN_ATAG
			, THMN_REN_EXPN_AMT
			, EXPN_SBTR_ATAG
			, NEXPN_AMT
			, THMN_GOV_OP_XPN
			, THMN_TO_GOV_OP_XPN_ATAG
			, GOV_OP_XPN_REN_AMT
			, GOV_OP_XPN_SBTR_ATAG
			, EXPN_ATAG
			, BL
			, NPMT_AMT 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'000','000','00','000','000'
		    ,NVL(SUM(THMN_FND_ALC_AMT), 0) AS THMN_FND_ALC_AMT
		    ,NVL(SUM(THMN_TO_FND_ALC_ATAG), 0) AS THMN_TO_FND_ALC_ATAG
		    ,NVL(SUM(THMN_EXPN_RQ_AMT), 0) AS THMN_EXPN_RQ_AMT
		    ,NVL(SUM(THMN_TO_EXPN_RQ_ATAG), 0) AS THMN_TO_EXPN_RQ_ATAG
		    ,NVL(SUM(EXPN_AMT), 0) AS EXPN_AMT
		    ,NVL(SUM(THMN_TO_EXPN_ATAG), 0) AS THMN_TO_EXPN_ATAG
		    ,NVL(SUM(THMN_REN_EXPN_AMT), 0) AS THMN_REN_EXPN_AMT
		    ,NVL(SUM(EXPN_SBTR_ATAG), 0) AS EXPN_SBTR_ATAG
		    ,NVL(SUM(NEXPN_AMT), 0) AS NEXPN_AMT
		    ,NVL(SUM(THMN_GOV_OP_XPN), 0) AS THMN_GOV_OP_XPN
		    ,NVL(SUM(THMN_TO_GOV_OP_XPN_ATAG), 0) AS THMN_TO_GOV_OP_XPN_ATAG
		    ,NVL(SUM(GOV_OP_XPN_REN_AMT), 0) AS GOV_OP_XPN_REN_AMT
		    ,NVL(SUM(GOV_OP_XPN_SBTR_ATAG), 0) AS GOV_OP_XPN_SBTR_ATAG
		    ,NVL(SUM(EXPN_ATAG), 0) AS EXPN_ATAG
		    ,NVL(SUM(BL), 0) AS BL
		    ,NVL(SUM(NPMT_AMT), 0) AS NPMT_AMT           
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV033L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 )   
	</insert>
	
	<!--지출확인계산서 UPDATE-->
	<update id="FAACAV008EUpdate_3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/"FAACAV008EUpdate_3" */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV049L
			   SET  
				 THMN_TO_BGT_ALC_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_BGT_ALC_ATAG#)), 0)
				,THMN_EXPN_RQ_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXPN_RQ_AMT#)), 0)
				,THMN_TO_EXPN_RQ_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_RQ_ATAG#)), 0)
				,THMN_EXPN_RQ_REN_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXPN_RQ_REN_AMT#)), 0)
				,THMN_EXPN_RQ_SUBJ_RCTF_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXPN_RQ_SUBJ_RCTF_AMT#)), 0)
				,EXPN_RQ_SBTR_ATAG = NVL(TO_NUMBER(TRIM(#EXPN_RQ_SBTR_ATAG#)), 0)
				,THMN_RCT_AMT = NVL(TO_NUMBER(TRIM(#THMN_RCT_AMT#)), 0)
				,THMN_TO_RCT_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_RCT_ATAG#)), 0)
				,THMN_REN_RCT_AMT = NVL(TO_NUMBER(TRIM(#THMN_REN_RCT_AMT#))	, 0)
				,RCT_SBTR_ATAG = NVL(TO_NUMBER(TRIM(#RCT_SBTR_ATAG#)), 0)
				,THMN_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
				,THMN_TO_PMT_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_PMT_ATAG#)), 0)
				,THMN_REN_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_REN_PMT_AMT#)), 0)
				,THMN_SUBJ_RCTF_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_SUBJ_RCTF_PMT_AMT#)), 0)
				,PMT_SBTR_ATAG = NVL(TO_NUMBER(TRIM(#PMT_SBTR_ATAG#)), 0)
				,GOV_OP_XPN_BL = NVL(TO_NUMBER(TRIM(#GOV_OP_XPN_BL#)), 0)
				,EXPN_ATAG = NVL(TO_NUMBER(TRIM(#EXPN_ATAG#)), 0)    
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--지출확인계산서 DELETE-->
	<update id="FAACAV008EDelete_3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_3 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV049L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--지출확인계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_3 */ ]]>
		INSERT INTO TWFAACAV049L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
			,THMN_TO_BGT_ALC_ATAG
			,THMN_EXPN_RQ_AMT
			,THMN_TO_EXPN_RQ_ATAG
			,THMN_EXPN_RQ_REN_AMT
			,THMN_EXPN_RQ_SUBJ_RCTF_AMT
			,EXPN_RQ_SBTR_ATAG
			,THMN_RCT_AMT
			,THMN_TO_RCT_ATAG
			,THMN_REN_RCT_AMT
			,RCT_SBTR_ATAG
			,THMN_PMT_AMT
			,THMN_TO_PMT_ATAG
			,THMN_REN_PMT_AMT
			,THMN_SUBJ_RCTF_PMT_AMT
			,PMT_SBTR_ATAG
			,GOV_OP_XPN_BL
			,EXPN_ATAG 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,SUBSTR(#SSEC_CD#,1,2)||'0'
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_BGT_ALC_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXPN_RQ_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_RQ_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXPN_RQ_REN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXPN_RQ_SUBJ_RCTF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#EXPN_RQ_SBTR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_RCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_RCT_ATAG#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#THMN_REN_RCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#RCT_SBTR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_PMT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_REN_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_SUBJ_RCTF_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#PMT_SBTR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#GOV_OP_XPN_BL#)), 0)	  
			  ,NVL(TO_NUMBER(TRIM(#EXPN_ATAG#)), 0)          
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--지출확인계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_3 */ ]]>
		INSERT INTO TWFAACAV049L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
			,THMN_TO_BGT_ALC_ATAG
			,THMN_EXPN_RQ_AMT
			,THMN_TO_EXPN_RQ_ATAG
			,THMN_EXPN_RQ_REN_AMT
			,THMN_EXPN_RQ_SUBJ_RCTF_AMT
			,EXPN_RQ_SBTR_ATAG
			,THMN_RCT_AMT
			,THMN_TO_RCT_ATAG
			,THMN_REN_RCT_AMT
			,RCT_SBTR_ATAG
			,THMN_PMT_AMT
			,THMN_TO_PMT_ATAG
			,THMN_REN_PMT_AMT
			,THMN_SUBJ_RCTF_PMT_AMT
			,PMT_SBTR_ATAG
			,GOV_OP_XPN_BL
			,EXPN_ATAG 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','000','000','0000','000'
		    ,NVL(SUM(THMN_TO_BGT_ALC_ATAG), 0) AS THMN_TO_BGT_ALC_ATAG
		    ,NVL(SUM(THMN_EXPN_RQ_AMT), 0) AS THMN_EXPN_RQ_AMT
		    ,NVL(SUM(THMN_TO_EXPN_RQ_ATAG), 0) AS THMN_TO_EXPN_RQ_ATAG
		    ,NVL(SUM(THMN_EXPN_RQ_REN_AMT), 0) AS THMN_EXPN_RQ_REN_AMT
		    ,NVL(SUM(THMN_EXPN_RQ_SUBJ_RCTF_AMT), 0) AS THMN_EXPN_RQ_SUBJ_RCTF_AMT
		    ,NVL(SUM(EXPN_RQ_SBTR_ATAG), 0) AS EXPN_RQ_SBTR_ATAG
		    ,NVL(SUM(THMN_RCT_AMT), 0) AS THMN_RCT_AMT
		    ,NVL(SUM(THMN_TO_RCT_ATAG), 0) AS THMN_TO_RCT_ATAG
		    ,NVL(SUM(THMN_REN_RCT_AMT), 0) AS THMN_REN_RCT_AMT
		    ,NVL(SUM(RCT_SBTR_ATAG), 0) AS RCT_SBTR_ATAG
		    ,NVL(SUM(THMN_PMT_AMT), 0) AS THMN_PMT_AMT
		    ,NVL(SUM(THMN_TO_PMT_ATAG), 0) AS THMN_TO_PMT_ATAG
		    ,NVL(SUM(THMN_REN_PMT_AMT), 0) AS THMN_REN_PMT_AMT
		    ,NVL(SUM(THMN_SUBJ_RCTF_PMT_AMT), 0) AS THMN_SUBJ_RCTF_PMT_AMT
		    ,NVL(SUM(PMT_SBTR_ATAG), 0) AS PMT_SBTR_ATAG
		    ,NVL(SUM(GOV_OP_XPN_BL), 0) AS GOV_OP_XPN_BL
		    ,NVL(SUM(EXPN_ATAG), 0) AS EXPN_ATAG            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV049L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 )   
	</insert>		

	<!--관서운영경비출납계산서 UPDATE-->
	<update id="FAACAV008EUpdate_4" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_4 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV029L
			   SET 
				 THMN_RCT_AMT = NVL(TO_NUMBER(TRIM(#THMN_RCT_AMT#)), 0)
				,LTMN_TO_RCT_ATAG = NVL(TO_NUMBER(TRIM(#LTMN_TO_RCT_ATAG#)), 0)
				,THMN_REN_RCT_AMT = NVL(TO_NUMBER(TRIM(#THMN_REN_RCT_AMT#)), 0)
				,SBTR_RCT_ATAG = NVL(TO_NUMBER(TRIM(#SBTR_RCT_ATAG#)), 0)
				,THMN_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
				,LTMN_TO_PMT_ATAG = NVL(TO_NUMBER(TRIM(#LTMN_TO_PMT_ATAG#)), 0)
				,THMN_DRIN_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_DRIN_PMT_AMT#)), 0)
				,THMN_SUBJ_ASO_RCTF_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_PMT_AMT#)), 0)
				,SBTR_PMT_ATAG = NVL(TO_NUMBER(TRIM(#SBTR_PMT_ATAG#)), 0)
				,PMT_BL = NVL(TO_NUMBER(TRIM(#PMT_BL#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--관서운영경비출납계산서 DELETE-->
	<update id="FAACAV008EDelete_4" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_4 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV029L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--관서운영경비출납계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_4" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_4 */ ]]>
		INSERT INTO TWFAACAV029L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
			,THMN_RCT_AMT
			,LTMN_TO_RCT_ATAG
			,THMN_REN_RCT_AMT
			,SBTR_RCT_ATAG
			,THMN_PMT_AMT
			,LTMN_TO_PMT_ATAG
			,THMN_DRIN_PMT_AMT
			,THMN_SUBJ_ASO_RCTF_PMT_AMT
			,SBTR_PMT_ATAG 
			,PMT_BL
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#CHIF_CD#
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#THMN_RCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTMN_TO_RCT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_REN_RCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#SBTR_RCT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTMN_TO_PMT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_DRIN_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_PMT_AMT#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#SBTR_PMT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#PMT_BL#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--관서운영경비출납계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_4" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_4 */ ]]>
		INSERT INTO TWFAACAV029L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
			,THMN_RCT_AMT
			,LTMN_TO_RCT_ATAG
			,THMN_REN_RCT_AMT
			,SBTR_RCT_ATAG
			,THMN_PMT_AMT
			,LTMN_TO_PMT_ATAG
			,THMN_DRIN_PMT_AMT
			,THMN_SUBJ_ASO_RCTF_PMT_AMT
			,SBTR_PMT_ATAG
			,PMT_BL
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','000','0000','000','000'
		    ,NVL(SUM(THMN_RCT_AMT), 0) AS THMN_RCT_AMT
		    ,NVL(SUM(LTMN_TO_RCT_ATAG), 0) AS LTMN_TO_RCT_ATAG
		    ,NVL(SUM(THMN_REN_RCT_AMT), 0) AS THMN_REN_RCT_AMT
		    ,NVL(SUM(SBTR_RCT_ATAG), 0) AS SBTR_RCT_ATAG
		    ,NVL(SUM(THMN_PMT_AMT), 0) AS THMN_PMT_AMT
		    ,NVL(SUM(LTMN_TO_PMT_ATAG), 0) AS LTMN_TO_PMT_ATAG
		    ,NVL(SUM(THMN_DRIN_PMT_AMT), 0) AS THMN_DRIN_PMT_AMT
		    ,NVL(SUM(THMN_SUBJ_ASO_RCTF_PMT_AMT), 0) AS THMN_SUBJ_ASO_RCTF_PMT_AMT
		    ,NVL(SUM(SBTR_PMT_ATAG), 0) AS SBTR_PMT_ATAG
		    ,NVL(SUM(PMT_BL), 0) AS PMT_BL		    
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV029L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert>
	
	<!--선사용자금명령액계산서 UPDATE-->
	<update id="FAACAV008EUpdate_6" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_6 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV059L
			   SET 
               	 THMN_TUM_BND_AMT  = NVL(TO_NUMBER(TRIM(#THMN_TUM_BND_AMT#)), 0)
				,THMN_TO_TUM_BND_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_TUM_BND_ATAG#)), 0)
				,THMN_TUM_CMD_AMT = NVL(TO_NUMBER(TRIM(#THMN_TUM_CMD_AMT#)), 0)
				,LTMN_TO_TUM_CMD_ATAG = NVL(TO_NUMBER(TRIM(#LTMN_TO_TUM_CMD_ATAG#)), 0)
				,THMN_REN_TUM_CMD_AMT = NVL(TO_NUMBER(TRIM(#THMN_REN_TUM_CMD_AMT#)), 0)
				,THMN_SUBJ_ASO_RCTF_TUM_CMD_AMT = NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_TUM_CMD_AMT#)), 0)
				,SBTR_ATAG_TUM_CMD_AMT = NVL(TO_NUMBER(TRIM(#SBTR_ATAG_TUM_CMD_AMT#)), 0)
				,TUM_BND_BL = NVL(TO_NUMBER(TRIM(#TUM_BND_BL#)), 0)
				,FRT_REGI_DH= TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--선사용자금명령액계산서 DELETE-->
	<update id="FAACAV008EDelete_6" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_6 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV059L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--선사용자금명령액계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_6" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_6 */ ]]>
		INSERT INTO TWFAACAV059L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
			,THMN_TUM_BND_AMT
			,THMN_TO_TUM_BND_ATAG
			,THMN_TUM_CMD_AMT
			,LTMN_TO_TUM_CMD_ATAG
			,THMN_REN_TUM_CMD_AMT
			,THMN_SUBJ_ASO_RCTF_TUM_CMD_AMT
			,SBTR_ATAG_TUM_CMD_AMT
			,TUM_BND_BL              
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#CHIF_CD#
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#             
			  ,NVL(TO_NUMBER(TRIM(#THMN_TUM_BND_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_TUM_BND_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TUM_CMD_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTMN_TO_TUM_CMD_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_REN_TUM_CMD_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_TUM_CMD_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#SBTR_ATAG_TUM_CMD_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TUM_BND_BL#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--선사용자금명령액계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_6" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_6 */ ]]>
		INSERT INTO TWFAACAV059L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
			,THMN_TUM_BND_AMT
			,THMN_TO_TUM_BND_ATAG
			,THMN_TUM_CMD_AMT
			,LTMN_TO_TUM_CMD_ATAG
			,THMN_REN_TUM_CMD_AMT
			,THMN_SUBJ_ASO_RCTF_TUM_CMD_AMT
			,SBTR_ATAG_TUM_CMD_AMT
			,TUM_BND_BL
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','000','0000','000','000'
		    ,NVL(SUM(THMN_TUM_BND_AMT), 0) AS THMN_TUM_BND_AMT
		    ,NVL(SUM(THMN_TO_TUM_BND_ATAG), 0) AS THMN_TO_TUM_BND_ATAG
		    ,NVL(SUM(THMN_TUM_CMD_AMT), 0) AS THMN_TUM_CMD_AMT 
		    ,NVL(SUM(LTMN_TO_TUM_CMD_ATAG), 0) AS  LTMN_TO_TUM_CMD_ATAG
		    ,NVL(SUM(THMN_REN_TUM_CMD_AMT), 0) AS THMN_REN_TUM_CMD_AMT
		    ,NVL(SUM(THMN_SUBJ_ASO_RCTF_TUM_CMD_AMT), 0) AS THMN_SUBJ_ASO_RCTF_TUM_CMD_AMT 
		    ,NVL(SUM(SBTR_ATAG_TUM_CMD_AMT), 0) AS SBTR_ATAG_TUM_CMD_AMT 
		    ,NVL(SUM(TUM_BND_BL), 0) AS TUM_BND_BL 
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV059L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		 
		 )   
	</insert>	
	
	<!--선사용자금관서운영경비출납 계산서 UPDATE-->
	<update id="FAACAV008EUpdate_7" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_7 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV030L
			   SET 
				 THMN_RCT_AMT = NVL(TO_NUMBER(TRIM(#THMN_RCT_AMT#)), 0)
				,LTMN_TO_RCT_ATAG = NVL(TO_NUMBER(TRIM(#LTMN_TO_RCT_ATAG#)), 0)
				,THMN_REN_RCT_AMT = NVL(TO_NUMBER(TRIM(#THMN_REN_RCT_AMT#)), 0)
				,SBTR_RCT_ATAG = NVL(TO_NUMBER(TRIM(#SBTR_RCT_ATAG#)), 0)
				,THMN_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
				,LTMN_TO_PMT_ATAG = NVL(TO_NUMBER(TRIM(#LTMN_TO_PMT_ATAG#)), 0)
				,THMN_DRIN_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_DRIN_PMT_AMT#)), 0)
				,THMN_SUBJ_ASO_RCTF_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_PMT_AMT#)), 0)
				,SBTR_PMT_ATAG = NVL(TO_NUMBER(TRIM(#SBTR_PMT_ATAG#)), 0)
				,PMT_BL = NVL(TO_NUMBER(TRIM(#PMT_BL#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--선사용자금관서운영경비출납 계산서 DELETE-->
	<update id="FAACAV008EDelete_7" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_7 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV030L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--선사용자금관서운영경비출납 계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_7" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_7 */ ]]>
		INSERT INTO TWFAACAV030L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
		    ,THMN_RCT_AMT
		    ,LTMN_TO_RCT_ATAG
		    ,THMN_REN_RCT_AMT
		    ,SBTR_RCT_ATAG
		    ,THMN_PMT_AMT 
		    ,LTMN_TO_PMT_ATAG
		    ,THMN_DRIN_PMT_AMT
		    ,THMN_SUBJ_ASO_RCTF_PMT_AMT
		    ,SBTR_PMT_ATAG
		    ,PMT_BL              
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#CHIF_CD#
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#THMN_RCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTMN_TO_RCT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_REN_RCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#SBTR_RCT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTMN_TO_PMT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_DRIN_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_PMT_AMT#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#SBTR_PMT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#PMT_BL#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--선사용자금관서운영경비출납 계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_7" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_7 */ ]]>
		INSERT INTO TWFAACAV030L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
		    ,THMN_RCT_AMT
		    ,LTMN_TO_RCT_ATAG
		    ,THMN_REN_RCT_AMT
		    ,SBTR_RCT_ATAG
		    ,THMN_PMT_AMT 
		    ,LTMN_TO_PMT_ATAG
		    ,THMN_DRIN_PMT_AMT
		    ,THMN_SUBJ_ASO_RCTF_PMT_AMT
		    ,SBTR_PMT_ATAG
		    ,PMT_BL           
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','000','0000','000','000'            
		    ,NVL(SUM(THMN_RCT_AMT), 0) AS THMN_RCT_AMT
		    ,NVL(SUM(LTMN_TO_RCT_ATAG), 0) AS LTMN_TO_RCT_ATAG
		    ,NVL(SUM(THMN_REN_RCT_AMT), 0) AS THMN_REN_RCT_AMT
		    ,NVL(SUM(SBTR_RCT_ATAG), 0) AS SBTR_RCT_ATAG
		    ,NVL(SUM(THMN_PMT_AMT), 0) AS THMN_PMT_AMT 
		    ,NVL(SUM(LTMN_TO_PMT_ATAG), 0) AS LTMN_TO_PMT_ATAG 
		    ,NVL(SUM(THMN_DRIN_PMT_AMT), 0) AS THMN_DRIN_PMT_AMT
		    ,NVL(SUM(THMN_SUBJ_ASO_RCTF_PMT_AMT), 0) AS THMN_SUBJ_ASO_RCTF_PMT_AMT
		    ,NVL(SUM(SBTR_PMT_ATAG), 0) AS SBTR_PMT_ATAG 
		    ,NVL(SUM(PMT_BL), 0) AS PMT_BL             
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV030L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert> 	
	
	<!--기금지출계산서 계산서 UPDATE-->
	<update id="FAACAV008EUpdate_8" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_8 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV027L
			   SET 
				 TQR_EXPN_AMT = NVL(TO_NUMBER(TRIM(#TQR_EXPN_AMT#)), 0)
				,ELT_TO_EXPN_AMT = NVL(TO_NUMBER(TRIM(#ELT_TO_EXPN_AMT#)), 0)
				,TQR_REN_AMT = NVL(TO_NUMBER(TRIM(#TQR_REN_AMT#)), 0)
				,TQR_SUBJ_ASO_RCTF_AMT = NVL(TO_NUMBER(TRIM(#TQR_SUBJ_ASO_RCTF_AMT#)), 0)
				,FUND_EXPN_SBTR_AMT = NVL(TO_NUMBER(TRIM(#FUND_EXPN_SBTR_AMT#))	, 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--기금지출계산서 계산서 DELETE-->
	<update id="FAACAV008EDelete_8" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_8 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV027L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--기금지출계산서 계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_8" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_8 */ ]]>
		INSERT INTO TWFAACAV027L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
			,TQR_EXPN_AMT
			,ELT_TO_EXPN_AMT
			,TQR_REN_AMT
			,TQR_SUBJ_ASO_RCTF_AMT
			,FUND_EXPN_SBTR_AMT 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			   #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,SUBSTR(#SSEC_CD#,1,2)||'0'
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#TQR_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#ELT_TO_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_REN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_SUBJ_ASO_RCTF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#FUND_EXPN_SBTR_AMT#)), 0)	  
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--기금지출계산서 계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_8" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_8 */ ]]>
		INSERT INTO TWFAACAV027L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
			,TQR_EXPN_AMT
			,ELT_TO_EXPN_AMT
			,TQR_REN_AMT
			,TQR_SUBJ_ASO_RCTF_AMT
			,FUND_EXPN_SBTR_AMT 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','000','0000','000','000'
		    ,NVL(SUM(TQR_EXPN_AMT), 0) AS TQR_EXPN_AMT
		    ,NVL(SUM(ELT_TO_EXPN_AMT), 0) AS ELT_TO_EXPN_AMT
		    ,NVL(SUM(TQR_REN_AMT), 0) AS TQR_REN_AMT
		    ,NVL(SUM(TQR_SUBJ_ASO_RCTF_AMT), 0) AS TQR_SUBJ_ASO_RCTF_AMT
		    ,NVL(SUM(FUND_EXPN_SBTR_AMT), 0) AS FUND_EXPN_SBTR_AMT 
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV027L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert>	
	
	<!--기금관서운영경비출납계산서 계산서 UPDATE-->
	<update id="FAACAV008EUpdate_9" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_9 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV028L
			   SET 
				 THMN_RCT_AMT = NVL(TO_NUMBER(TRIM(#THMN_RCT_AMT#)), 0)
				,LTMN_TO_RCT_ATAG = NVL(TO_NUMBER(TRIM(#LTMN_TO_RCT_ATAG#)), 0)
				,THMN_REN_RCT_AMT = NVL(TO_NUMBER(TRIM(#THMN_REN_RCT_AMT#)), 0)
				,SBTR_RCT_ATAG = NVL(TO_NUMBER(TRIM(#SBTR_RCT_ATAG#)), 0)
				,THMN_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
				,LTMN_TO_PMT_ATAG = NVL(TO_NUMBER(TRIM(#LTMN_TO_PMT_ATAG#)), 0)
				,THMN_DRIN_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_DRIN_PMT_AMT#)), 0)
				,THMN_SUBJ_ASO_RCTF_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_PMT_AMT#)), 0)
				,SBTR_PMT_ATAG = NVL(TO_NUMBER(TRIM(#SBTR_PMT_ATAG#)), 0)
				,PMT_BL = NVL(TO_NUMBER(TRIM(#PMT_BL#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = 'TEST'
				,FNL_DEAL_DPT_CD = 'TESTDEPT'
				,FNL_MNU_ID	= 'TESTMENU'
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--기금관서운영경비출납계산서 계산서 DELETE-->
	<update id="FAACAV008EDelete_9" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_9 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV028L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--기금관서운영경비출납계산서 계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_9" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_9 */ ]]>
		INSERT INTO TWFAACAV028L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
		    ,THMN_RCT_AMT
		    ,LTMN_TO_RCT_ATAG
		    ,THMN_REN_RCT_AMT
		    ,SBTR_RCT_ATAG
		    ,THMN_PMT_AMT 
		    ,LTMN_TO_PMT_ATAG
		    ,THMN_DRIN_PMT_AMT
		    ,THMN_SUBJ_ASO_RCTF_PMT_AMT
		    ,SBTR_PMT_ATAG
		    ,PMT_BL 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#CHIF_CD#
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#THMN_RCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTMN_TO_RCT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_REN_RCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#SBTR_RCT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTMN_TO_PMT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_DRIN_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_PMT_AMT#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#SBTR_PMT_ATAG#))	, 0)
 			  ,NVL(TO_NUMBER(TRIM(#PMT_BL#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,'TEST'
		)
	</insert>
	
	<!--기금관서운영경비출납계산서 계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_9" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_9 */ ]]>
		INSERT INTO TWFAACAV028L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
		    ,THMN_RCT_AMT
		    ,LTMN_TO_RCT_ATAG
		    ,THMN_REN_RCT_AMT
		    ,SBTR_RCT_ATAG
		    ,THMN_PMT_AMT 
		    ,LTMN_TO_PMT_ATAG
		    ,THMN_DRIN_PMT_AMT
		    ,THMN_SUBJ_ASO_RCTF_PMT_AMT
		    ,SBTR_PMT_ATAG
		    ,PMT_BL 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','000','0000','000','000'
		    ,NVL(SUM(THMN_RCT_AMT), 0) AS THMN_RCT_AMT 
		    ,NVL(SUM(LTMN_TO_RCT_ATAG), 0) AS LTMN_TO_RCT_ATAG
		    ,NVL(SUM(THMN_REN_RCT_AMT), 0) AS THMN_REN_RCT_AMT
		    ,NVL(SUM(SBTR_RCT_ATAG), 0) AS SBTR_RCT_ATAG
		    ,NVL(SUM(THMN_PMT_AMT), 0) AS THMN_PMT_AMT
		    ,NVL(SUM(LTMN_TO_PMT_ATAG), 0) AS LTMN_TO_PMT_ATAG
		    ,NVL(SUM(THMN_DRIN_PMT_AMT), 0) AS THMN_DRIN_PMT_AMT
		    ,NVL(SUM(THMN_SUBJ_ASO_RCTF_PMT_AMT), 0) AS THMN_SUBJ_ASO_RCTF_PMT_AMT 
		    ,NVL(SUM(SBTR_PMT_ATAG), 0) AS SBTR_PMT_ATAG
		    ,NVL(SUM(PMT_BL), 0) AS PMT_BL            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV028L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert>	
	
    <!--한국은행지출계산서 UPDATE-->
	<update id="FAACAV008EUpdate_14" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_14 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV011L
			   SET 
				 THMN_EXPN_BND_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXPN_BND_AMT#)), 0)
				,THMN_TO_EXPN_BND_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_BND_ATAG#)), 0)
				,THMN_EXPN_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXPN_AMT#)), 0)
				,LTMN_TO_EXPN_ATAG = NVL(TO_NUMBER(TRIM(#LTMN_TO_EXPN_ATAG#)), 0)
				,THMN_EXPN_PCRT_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXPN_PCRT_AMT#)), 0)
				,THMN_SUBJ_ASO_RCTF_EXPN_AMT = NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_EXPN_AMT#)), 0)
				,SBTR_ATAG = NVL(TO_NUMBER(TRIM(#SBTR_ATAG#)), 0)
				,EXPN_BND_BL = NVL(TO_NUMBER(TRIM(#EXPN_BND_BL#)), 0)	
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND DITM_DVSN_CD=#DITM_DVSN_CD#              
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--한국은행지출계산서 DELETE-->
	<update id="FAACAV008EDelete_14" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_14 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV011L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
              AND DITM_DVSN_CD=#DITM_DVSN_CD#  
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--한국은행지출계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_14" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_14 */ ]]>
		INSERT INTO TWFAACAV011L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID            
		    ,DITM_DVSN_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
			,THMN_EXPN_BND_AMT
			,THMN_TO_EXPN_BND_ATAG
			,THMN_EXPN_AMT
			,LTMN_TO_EXPN_ATAG
			,THMN_EXPN_PCRT_AMT
			,THMN_SUBJ_ASO_RCTF_EXPN_AMT
			,SBTR_ATAG
			,EXPN_BND_BL  
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,'1'              
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXPN_BND_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_EXPN_BND_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTMN_TO_EXPN_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXPN_PCRT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_SUBJ_ASO_RCTF_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#SBTR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#EXPN_BND_BL#)), 0)		  			  
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,'TEST'
		)
	</insert>
	
	<!--한국은행지출계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_14" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_14 */ ]]>
		INSERT INTO TWFAACAV011L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
            ,DITM_DVSN_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
			,THMN_EXPN_BND_AMT
			,THMN_TO_EXPN_BND_ATAG
			,THMN_EXPN_AMT
			,LTMN_TO_EXPN_ATAG
			,THMN_EXPN_PCRT_AMT
			,THMN_SUBJ_ASO_RCTF_EXPN_AMT
			,SBTR_ATAG
			,EXPN_BND_BL 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','000','0000','000'
		    ,NVL(SUM(THMN_EXPN_BND_AMT), 0) AS THMN_EXPN_BND_AMT
		    ,NVL(SUM(THMN_TO_EXPN_BND_ATAG), 0) AS THMN_TO_EXPN_BND_ATAG
		    ,NVL(SUM(THMN_EXPN_AMT), 0) AS THMN_EXPN_AMT
		    ,NVL(SUM(LTMN_TO_EXPN_ATAG), 0) AS LTMN_TO_EXPN_ATAG
		    ,NVL(SUM(THMN_EXPN_PCRT_AMT), 0) AS THMN_EXPN_PCRT_AMT
		    ,NVL(SUM(THMN_SUBJ_ASO_RCTF_EXPN_AMT), 0) AS THMN_SUBJ_ASO_RCTF_EXPN_AMT
		    ,NVL(SUM(SBTR_ATAG), 0) AS SBTR_ATAG
		    ,NVL(SUM(EXPN_BND_BL), 0) AS EXPN_BND_BL
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV011L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND SUM_DVSN_ID = '11'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert>	
	
   	<!--환급금결정액계산서 UPDATE-->
	<update id="FAACAV008EUpdate_15" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_15 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV018L
			   SET 
				 RSR_CFM_DCS_AMT = NVL(TO_NUMBER(TRIM(#RSR_CFM_DCS_AMT#)), 0)
				,RSR_CFM_DCS_ATAG = NVL(TO_NUMBER(TRIM(#RSR_CFM_DCS_ATAG#)), 0)
				,APP_AMT = NVL(TO_NUMBER(TRIM(#APP_AMT#)), 0)
				,APP_ATAG = NVL(TO_NUMBER(TRIM(#APP_ATAG#)), 0)
				,TRAC_AMT = NVL(TO_NUMBER(TRIM(#TRAC_AMT#)), 0)
				,TRAC_ATAG = NVL(TO_NUMBER(TRIM(#TRAC_ATAG#)), 0)
				,PMT_AMT = NVL(TO_NUMBER(TRIM(#PMT_AMT#)), 0)
				,PMT_ATAG = NVL(TO_NUMBER(TRIM(#PMT_ATAG#)), 0)
				,DCSAM_NPMT_AMT = NVL(TO_NUMBER(TRIM(#DCSAM_NPMT_AMT#)), 0)	
				,TRACAM_NPMT_AMT = NVL(TO_NUMBER(TRIM(#TRACAM_NPMT_AMT#)), 0)                
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
              AND RSRAM_DCS_AMT_NO = #RSRAM_DCS_AMT_NO#
	</update>
	<!--계산서 DELETE-->
	<update id="FAACAV008EDelete_15" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_15 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV018L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
              AND RSRAM_DCS_AMT_NO = #RSRAM_DCS_AMT_NO#
	</update>
	
	<!--환급금결정액계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_15" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_15 */ ]]>
		INSERT INTO TWFAACAV018L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
            ,RSRAM_DCS_AMT_NO
			,RSR_CFM_DCS_AMT
			,RSR_CFM_DCS_ATAG
			,APP_AMT
			,APP_ATAG
			,TRAC_AMT
			,TRAC_ATAG
			,PMT_AMT
			,PMT_ATAG
			,DCSAM_NPMT_AMT
			,TRACAM_NPMT_AMT 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
              ,#RSRAM_DCS_AMT_NO#  
			  ,NVL(TO_NUMBER(TRIM(#RSR_CFM_DCS_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#RSR_CFM_DCS_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#APP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#APP_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TRAC_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TRAC_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#PMT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#DCSAM_NPMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TRACAM_NPMT_AMT#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--환급금결정액계산서  합계 추가-->
	<insert id="FAACAV008ESumInsert_15" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_15 */ ]]>
		INSERT INTO TWFAACAV018L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
            ,RSRAM_DCS_AMT_NO 
			,RSR_CFM_DCS_AMT
			,RSR_CFM_DCS_ATAG
			,APP_AMT
			,APP_ATAG
			,TRAC_AMT
			,TRAC_ATAG
			,PMT_AMT
			,PMT_ATAG
			,DCSAM_NPMT_AMT
			,TRACAM_NPMT_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'000'
		    ,NVL(SUM(RSR_CFM_DCS_AMT), 0) AS RSR_CFM_DCS_AMT 
		    ,NVL(SUM(RSR_CFM_DCS_ATAG), 0) AS RSR_CFM_DCS_ATAG
		    ,NVL(SUM(APP_AMT), 0) AS APP_AMT
		    ,NVL(SUM(APP_ATAG), 0) AS APP_ATAG
		    ,NVL(SUM(TRAC_AMT), 0) AS TRAC_AMT
		    ,NVL(SUM(TRAC_ATAG), 0) AS TRAC_ATAG
		    ,NVL(SUM(PMT_AMT), 0) AS PMT_AMT
		    ,NVL(SUM(PMT_ATAG), 0) AS PMT_ATAG 
		    ,NVL(SUM(DCSAM_NPMT_AMT), 0) AS DCSAM_NPMT_AMT
		    ,NVL(SUM(TRACAM_NPMT_AMT), 0) AS TRACAM_NPMT_AMT            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,'TEST'
		 FROM
		    TWFAACAV018L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert>	
	
   	<!--한국은행수입계산서  UPDATE-->
	<update id="FAACAV008EUpdate_16" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_16 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV012L
			   SET 
				 THMN_INC_AMT = NVL(TO_NUMBER(TRIM(#THMN_INC_AMT#)), 0)
				,THMN_TO_INC_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_INC_ATAG#)), 0)
				,THMN_RSR_AMT = NVL(TO_NUMBER(TRIM(#THMN_RSR_AMT#)), 0)
				,THMN_TO_RSR_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_RSR_ATAG#)), 0)
				,THMN_NPM_LO_AMT = NVL(TO_NUMBER(TRIM(#THMN_NPM_LO_AMT#)), 0)
				,THMN_TO_NPM_LO_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_NPM_LO_ATAG#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--한국은행수입계산서 DELETE-->
	<update id="FAACAV008EDelete_16" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_16 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV012L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--한국은행수입계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_16" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_16 */ ]]>
		INSERT INTO TWFAACAV012L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SSEC_CD
			,DITM_CD
			,SITM_CD
			,THMN_INC_AMT
			,THMN_TO_INC_ATAG
			,THMN_RSR_AMT
			,THMN_TO_RSR_ATAG
			,THMN_NPM_LO_AMT
			,THMN_TO_NPM_LO_ATAG 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#THMN_INC_AMT#)), 0)
			  ,NVLTO_NUMBER(TRIM(#THMN_TO_INC_ATAG#)), 0)
			  ,NVLTO_NUMBER(TRIM(#THMN_RSR_AMT#)), 0)
			  ,NVLTO_NUMBER(TRIM(#THMN_TO_RSR_ATAG#)), 0)
			  ,NVLTO_NUMBER(TRIM(#THMN_NPM_LO_AMT#)), 0)
			  ,NVLTO_NUMBER(TRIM(#THMN_TO_NPM_LO_ATAG#)), 0)		  
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--한국은행수입계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_16" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_16 */ ]]>
		INSERT INTO TWFAACAV012L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
			,THMN_INC_AMT
			,THMN_TO_INC_ATAG
			,THMN_RSR_AMT
			,THMN_TO_RSR_ATAG
			,THMN_NPM_LO_AMT
			,THMN_TO_NPM_LO_ATAG 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'000','0000','000'
		    ,NVL(SUM(THMN_INC_AMT), 0) AS THMN_INC_AMT 
		    ,NVL(SUM(THMN_TO_INC_ATAG), 0) AS THMN_TO_INC_ATAG
		    ,NVL(SUM(THMN_RSR_AMT), 0) AS THMN_RSR_AMT
		    ,NVL(SUM(THMN_TO_RSR_ATAG), 0) AS THMN_TO_RSR_ATAG
		    ,NVL(SUM(THMN_NPM_LO_AMT), 0) AS THMN_NPM_LO_AMT
		    ,NVL(SUM(THMN_TO_NPM_LO_ATAG), 0) AS THMN_TO_NPM_LO_ATAG
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV012L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND SUM_DVSN_ID = '11'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		 
		 )   
	</insert> 	
	

	<!--지출계산서_지방 UPDATE-->
	<update id="FAACAV008EUpdate_17" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_17 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV021L
			   SET 
				 TQR_BGT_ALC_AMT = NVL(TO_NUMBER(TRIM(#TQR_BGT_ALC_AMT#)), 0)
				,TQR_TO_BGT_ALC_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_BGT_ALC_ATAG#)), 0)
				,TQR_FND_ALC_AMT = NVL(TO_NUMBER(TRIM(#TQR_FND_ALC_AMT#)), 0)
				,TQR_TO_FND_ALC_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_FND_ALC_ATAG#)), 0)
				,TQR_EXPN_AMT = NVL(TO_NUMBER(TRIM(#TQR_EXPN_AMT#)), 0)
				,ELT_TO_EXPN_ATAG = NVL(TO_NUMBER(TRIM(#ELT_TO_EXPN_ATAG#)), 0)
				,TQR_RED_AMT = NVL(TO_NUMBER(TRIM(#TQR_RED_AMT#)), 0)
				,TQR_SUBJ_ASO_RCTF_AMT = NVL(TO_NUMBER(TRIM(#TQR_SUBJ_ASO_RCTF_AMT#)), 0)
				,EXPN_SBTR_ATAG = NVL(TO_NUMBER(TRIM(#EXPN_SBTR_ATAG#))	, 0)
				,FND_ALC_BL = NVL(TO_NUMBER(TRIM(#FND_ALC_BL#)), 0)   
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#              
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
              AND DGE = #DGE#              
	</update>
	<!--지출계산서_지방 DELETE-->
	<update id="FAACAV008EDelete_17" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_17 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV021L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#              
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
              AND DGE = #DGE#
	</update>
	
	<!--지출계산서_지방 예산과목 추가-->
	<insert id="FAACAV008EInsert_17" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_17 */ ]]>
		INSERT INTO TWFAACAV021L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SSEC_CD
			,ITM_CD
			,DITM_CD
			,SITM_CD
            ,DGE
			,TQR_BGT_ALC_AMT
			,TQR_TO_BGT_ALC_ATAG
			,TQR_FND_ALC_AMT
			,TQR_TO_FND_ALC_ATAG
			,TQR_EXPN_AMT
			,ELT_TO_EXPN_ATAG
			,TQR_RED_AMT
			,TQR_SUBJ_ASO_RCTF_AMT
			,EXPN_SBTR_ATAG
			,FND_ALC_BL  
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#SSEC_CD#
			  ,#ITM_CD#              
			  ,#DITM_CD#
			  ,#SITM_CD#
              ,( SELECT NVL(MAX(DGE),0)+1 
                 FROM TWFAACAV021L 
                 WHERE 
                  COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID != '49' 
              AND SUM_DVSN_ID != '51'
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#              
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
              )
			  ,NVL(TO_NUMBER(TRIM(#TQR_BGT_ALC_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_BGT_ALC_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_FND_ALC_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_FND_ALC_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#ELT_TO_EXPN_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_RED_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_SUBJ_ASO_RCTF_AMT#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#EXPN_SBTR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#FND_ALC_BL#)), 0)  
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--지출계산서_지방 합계 추가-->
	<insert id="FAACAV008ESumInsert_17" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_17 */ ]]>
		INSERT INTO TWFAACAV021L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SSEC_CD
			,ITM_CD              
			,DITM_CD
			,SITM_CD
            ,DGE
			,TQR_BGT_ALC_AMT
			,TQR_TO_BGT_ALC_ATAG
			,TQR_FND_ALC_AMT
			,TQR_TO_FND_ALC_ATAG
			,TQR_EXPN_AMT
			,ELT_TO_EXPN_ATAG
			,TQR_RED_AMT
			,TQR_SUBJ_ASO_RCTF_AMT
			,EXPN_SBTR_ATAG
			,FND_ALC_BL
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0000','0000','0000','000',0
		    ,NVL(SUM(TQR_BGT_ALC_AMT), 0) AS TQR_BGT_ALC_AMT
		    ,NVL(SUM(TQR_TO_BGT_ALC_ATAG), 0) AS TQR_TO_BGT_ALC_ATAG
		    ,NVL(SUM(TQR_FND_ALC_AMT), 0) AS TQR_FND_ALC_AMT
		    ,NVL(SUM(TQR_TO_FND_ALC_ATAG), 0) AS TQR_TO_FND_ALC_ATAG
		    ,NVL(SUM(TQR_EXPN_AMT), 0) AS TQR_EXPN_AMT
		    ,NVL(SUM(ELT_TO_EXPN_ATAG), 0) AS ELT_TO_EXPN_ATAG
		    ,NVL(SUM(TQR_RED_AMT), 0) AS TQR_RED_AMT 
		    ,NVL(SUM(TQR_SUBJ_ASO_RCTF_AMT), 0) AS TQR_SUBJ_ASO_RCTF_AMT 
		    ,NVL(SUM(EXPN_SBTR_ATAG), 0) AS EXPN_SBTR_ATAG 
		    ,NVL(SUM(FND_ALC_BL), 0) AS FND_ALC_BL            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV021L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert>

    <!--수입징수액계산서(외) UPDATE-->
	<update id="FAACAV008EUpdate_18" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_18 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV053L
			   SET 
				 TQR_CLCT_DCS_AMT = NVL(TO_NUMBER(TRIM(#TQR_CLCT_DCS_AMT#)), 0)
				,TQR_TO_CLCT_DCS_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_CLCT_DCS_ATAG#)), 0)
				,TQR_RCP_AMT = NVL(TO_NUMBER(TRIM(#TQR_RCP_AMT#)), 0)
				,TQR_TO_RCP_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_RCP_ATAG#)), 0)
				,TQR_RSR_AMT = NVL(TO_NUMBER(TRIM(#TQR_RSR_AMT#)), 0)
				,TQR_TO_RSR_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_RSR_ATAG#)), 0)
				,TQR_NPM_LO_AMT = NVL(TO_NUMBER(TRIM(#TQR_NPM_LO_AMT#)), 0)
				,TQR_TO_NPM_LO_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_NPM_LO_ATAG#)), 0)
				,UNP_AMT = NVL(TO_NUMBER(TRIM(#UNP_AMT#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID# 
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--수입징수액계산서(외) DELETE-->
	<update id="FAACAV008EDelete_18" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_18 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV053L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--수입징수액계산서(외) 예산과목 추가-->
	<insert id="FAACAV008EInsert_18" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_18 */ ]]>
		INSERT INTO TWFAACAV053L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,SSEC_CD
			,ITM_CD
			,SITM_CD
			,TQR_CLCT_DCS_AMT
			,TQR_TO_CLCT_DCS_ATAG
			,TQR_RCP_AMT
			,TQR_TO_RCP_ATAG
			,TQR_RSR_AMT
			,TQR_TO_RSR_ATAG
			,TQR_NPM_LO_AMT
			,TQR_TO_NPM_LO_ATAG
			,UNP_AMT 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#SSEC_CD#
			  ,#ITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#TQR_CLCT_DCS_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_CLCT_DCS_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_RCP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_RCP_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_RSR_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_RSR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_NPM_LO_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_NPM_LO_ATAG#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#UNP_AMT#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--수입징수액계산서(외) 합계 추가-->
	<insert id="FAACAV008ESumInsert_18" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_18 */ ]]>
		INSERT INTO TWFAACAV053L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,SSEC_CD
			,ITM_CD
			,SITM_CD 
			,TQR_CLCT_DCS_AMT
			,TQR_TO_CLCT_DCS_ATAG
			,TQR_RCP_AMT
			,TQR_TO_RCP_ATAG
			,TQR_RSR_AMT
			,TQR_TO_RSR_ATAG
			,TQR_NPM_LO_AMT
			,TQR_TO_NPM_LO_ATAG
			,UNP_AMT           
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','00','00','000'
		    ,NVL(SUM(TQR_CLCT_DCS_AMT), 0) AS TQR_CLCT_DCS_AMT
		    ,NVL(SUM(TQR_TO_CLCT_DCS_ATAG), 0) AS TQR_TO_CLCT_DCS_ATAG
		    ,NVL(SUM(TQR_RCP_AMT), 0) AS TQR_RCP_AMT
		    ,NVL(SUM(TQR_TO_RCP_ATAG), 0) AS TQR_TO_RCP_ATAG
		    ,NVL(SUM(TQR_RSR_AMT), 0) AS TQR_RSR_AMT
		    ,NVL(SUM(TQR_TO_RSR_ATAG), 0) AS TQR_TO_RSR_ATAG
		    ,NVL(SUM(TQR_NPM_LO_AMT), 0) AS TQR_NPM_LO_AMT
		    ,NVL(SUM(TQR_TO_NPM_LO_ATAG), 0) AS TQR_TO_NPM_LO_ATAG
		    ,NVL(SUM(UNP_AMT), 0) AS UNP_AMT
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV053L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#	
		 )   
	</insert>

   	<!--수입징수액계산서(세) UPDATE-->
	<update id="FAACAV008EUpdate_19" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_19 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV055L
			   SET 
				 TOT_CLCT_DCS_AMT = NVL(TO_NUMBER(TRIM(#TOT_CLCT_DCS_AMT#)), 0)
				,TOT_CLCT_DCS_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#TOT_CLCT_DCS_AMT_SUM_AM#)), 0)
				,TOT_RCP_AMT = NVL(TO_NUMBER(TRIM(#TOT_RCP_AMT#)), 0)
				,TOT_RCP_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#TOT_RCP_AMT_SUM_AM#)), 0)
				,TAXOFC_SIM_AMT = NVL(TO_NUMBER(TRIM(#TAXOFC_SIM_AMT#)), 0)
				,TAXOFC_SIM_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#TAXOFC_SIM_AMT_SUM_AM#)), 0)
				,RSRAM_RSR_DCS_AMT = NVL(TO_NUMBER(TRIM(#RSRAM_RSR_DCS_AMT#)), 0)
				,RSRAM_RSR_DCS_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#RSRAM_RSR_DCS_AMT_SUM_AM#)), 0)
				,RSRAM_HNDL_APP_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#RSRAM_HNDL_APP_AMT_SUM_AM#)), 0)
				,RSRAM_HNDL_APP_TOT_AMT = NVL(TO_NUMBER(TRIM(#RSRAM_HNDL_APP_TOT_AMT#)), 0)
				,RSRAM_HNDL_TA_AMT = NVL(TO_NUMBER(TRIM(#RSRAM_HNDL_TA_AMT#)), 0)
				,RSRAM_HNDL_TA_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#RSRAM_HNDL_TA_AMT_SUM_AM#)), 0)
				,CLCT_DCS_AMT = NVL(TO_NUMBER(TRIM(#CLCT_DCS_AMT#)), 0)
				,TQR_TO_CLCT_DCS_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_CLCT_DCS_ATAG#)), 0)
				,RCP_AMT = NVL(TO_NUMBER(TRIM(#RCP_AMT#)), 0)
				,TQR_TO_RCP_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_RCP_ATAG#)), 0)
				,NPM_LO_AMT = NVL(TO_NUMBER(TRIM(#NPM_LO_AMT#)), 0)   
				,NPM_LO_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#NPM_LO_AMT_SUM_AM#)), 0)
				,UNP_AMT = NVL(TO_NUMBER(TRIM(#UNP_AMT#)), 0)
				,UN_RCP_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#UN_RCP_AMT_SUM_AM#)), 0)	              
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--수입징수액계산서(세) DELETE-->
	<update id="FAACAV008EDelete_19" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_19 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV055L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--수입징수액계산서(세) 예산과목 추가-->
	<insert id="FAACAV008EInsert_19" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_19 */ ]]>
		INSERT INTO TWFAACAV055L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,SSEC_CD
			,ITM_CD
			,SITM_CD
			,TOT_CLCT_DCS_AMT
			,TOT_CLCT_DCS_AMT_SUM_AM
			,TOT_RCP_AMT
			,TOT_RCP_AMT_SUM_AM
			,TAXOFC_SIM_AMT
			,TAXOFC_SIM_AMT_SUM_AM
			,RSRAM_RSR_DCS_AMT
			,RSRAM_RSR_DCS_AMT_SUM_AM
			,RSRAM_HNDL_APP_AMT_SUM_AM
			,RSRAM_HNDL_APP_TOT_AMT
			,RSRAM_HNDL_TA_AMT
			,RSRAM_HNDL_TA_AMT_SUM_AM
			,CLCT_DCS_AMT
			,TQR_TO_CLCT_DCS_ATAG
			,RCP_AMT
			,TQR_TO_RCP_ATAG
			,NPM_LO_AMT
			,NPM_LO_AMT_SUM_AM
			,UNP_AMT
			,UN_RCP_AMT_SUM_AM 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#SSEC_CD#
			  ,#ITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#TOT_CLCT_DCS_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TOT_CLCT_DCS_AMT_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TOT_RCP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TOT_RCP_AMT_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TAXOFC_SIM_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TAXOFC_SIM_AMT_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#RSRAM_RSR_DCS_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#RSRAM_RSR_DCS_AMT_SUM_AM#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#RSRAM_HNDL_APP_AMT_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#RSRAM_HNDL_APP_TOT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#RSRAM_HNDL_TA_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#RSRAM_HNDL_TA_AMT_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#CLCT_DCS_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_CLCT_DCS_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#RCP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_RCP_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#NPM_LO_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#NPM_LO_AMT_SUM_AM#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#UNP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#UN_RCP_AMT_SUM_AM#)), 0)	              
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--수입징수액계산서(세) 합계 추가-->
	<insert id="FAACAV008ESumInsert_19" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_19 */ ]]>
		INSERT INTO TWFAACAV055L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,SSEC_CD
			,ITM_CD
			,SITM_CD 
			,TOT_CLCT_DCS_AMT
			,TOT_CLCT_DCS_AMT_SUM_AM
			,TOT_RCP_AMT
			,TOT_RCP_AMT_SUM_AM
			,TAXOFC_SIM_AMT
			,TAXOFC_SIM_AMT_SUM_AM
			,RSRAM_RSR_DCS_AMT
			,RSRAM_RSR_DCS_AMT_SUM_AM
			,RSRAM_HNDL_APP_AMT_SUM_AM
			,RSRAM_HNDL_APP_TOT_AMT
			,RSRAM_HNDL_TA_AMT
			,RSRAM_HNDL_TA_AMT_SUM_AM
			,CLCT_DCS_AMT
			,TQR_TO_CLCT_DCS_ATAG
			,RCP_AMT
			,TQR_TO_RCP_ATAG
			,NPM_LO_AMT
			,NPM_LO_AMT_SUM_AM
			,UNP_AMT
			,UN_RCP_AMT_SUM_AM  
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','00','00','000'
		    ,NVL(SUM(TOT_CLCT_DCS_AMT), 0) AS TOT_CLCT_DCS_AMT
		    ,NVL(SUM(TOT_CLCT_DCS_AMT_SUM_AM), 0) AS TOT_CLCT_DCS_AMT_SUM_AM
		    ,NVL(SUM(TOT_RCP_AMT), 0) AS TOT_RCP_AMT
		    ,NVL(SUM(TOT_RCP_AMT_SUM_AM), 0) AS TOT_RCP_AMT_SUM_AM
		    ,NVL(SUM(TAXOFC_SIM_AMT), 0) AS TAXOFC_SIM_AMT
		    ,NVL(SUM(TAXOFC_SIM_AMT_SUM_AM), 0) AS TAXOFC_SIM_AMT_SUM_AM
		    ,NVL(SUM(RSRAM_RSR_DCS_AMT), 0) AS RSRAM_RSR_DCS_AMT
		    ,NVL(SUM(RSRAM_RSR_DCS_AMT_SUM_AM), 0) AS RSRAM_RSR_DCS_AMT_SUM_AM
		    ,NVL(SUM(RSRAM_HNDL_APP_AMT_SUM_AM), 0) AS RSRAM_HNDL_APP_AMT_SUM_AM
		    ,NVL(SUM(RSRAM_HNDL_APP_TOT_AMT), 0) AS RSRAM_HNDL_APP_TOT_AMT        
		    ,NVL(SUM(RSRAM_HNDL_TA_AMT), 0) AS RSRAM_HNDL_TA_AMT
		    ,NVL(SUM(RSRAM_HNDL_TA_AMT_SUM_AM), 0) AS RSRAM_HNDL_TA_AMT_SUM_AM
		    ,NVL(SUM(CLCT_DCS_AMT), 0) AS CLCT_DCS_AMT
		    ,NVL(SUM(TQR_TO_CLCT_DCS_ATAG), 0) AS TQR_TO_CLCT_DCS_ATAG
		    ,NVL(SUM(RCP_AMT), 0) AS RCP_AMT
		    ,NVL(SUM(TQR_TO_RCP_ATAG), 0) AS TQR_TO_RCP_ATAG
		    ,NVL(SUM(NPM_LO_AMT), 0) AS NPM_LO_AMT
		    ,NVL(SUM(NPM_LO_AMT_SUM_AM), 0) AS NPM_LO_AMT_SUM_AM
		    ,NVL(SUM(UNP_AMT), 0) AS UNP_AMT
		    ,NVL(SUM(UN_RCP_AMT_SUM_AM), 0) AS UN_RCP_AMT_SUM_AM             
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV055L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert> 
	
    <!--조체급출납계산서 UPDATE-->
	<update id="FAACAV008EUpdate_20" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_20 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV060L
			   SET 

				 TQR_INC_AMT = NVL(TO_NUMBER(TRIM(#TQR_INC_AMT#)), 0)
				,TQR_TO_INC_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_INC_ATAG#)), 0)
				,TQR_PMT_AMT = NVL(TO_NUMBER(TRIM(#TQR_PMT_AMT#)), 0)
				,TQR_TO_PMT_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_PMT_ATAG#)), 0)
				,TQR_BL = NVL(TO_NUMBER(TRIM(#TQR_BL#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND TUM_RAD=#TUM_RAD#

	</update>
	<!--조체급출납계산서 DELETE-->
	<update id="FAACAV008EDelete_20" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_20 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV060L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND TUM_RAD=#TUM_RAD#
	</update>
	
	<!--조체급출납계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_20" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_20 */ ]]>
		INSERT INTO TWFAACAV060L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,TUM_RAD	
			,TQR_INC_AMT
			,TQR_TO_INC_ATAG
			,TQR_PMT_AMT
			,TQR_TO_PMT_ATAG
			,TQR_BL 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#TUM_RAD#
			  ,NVL(TO_NUMBER(TRIM(#TQR_INC_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_INC_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_PMT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_BL#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--조체급출납계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_20" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_20 */ ]]>
		INSERT INTO TWFAACAV060L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,TUM_RAD	
			,TQR_INC_AMT
			,TQR_TO_INC_ATAG
			,TQR_PMT_AMT
			,TQR_TO_PMT_ATAG
			,TQR_BL
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'000'
		    ,NVL(SUM(TQR_INC_AMT), 0) AS TQR_INC_AMT
		    ,NVL(SUM(TQR_TO_INC_ATAG), 0) AS TQR_TO_INC_ATAG
		    ,NVL(SUM(TQR_PMT_AMT), 0) AS TQR_PMT_AMT
		    ,NVL(SUM(TQR_TO_PMT_ATAG), 0) AS TQR_TO_PMT_ATAG
		    ,NVL(SUM(TQR_BL), 0) AS TQR_BL
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV060L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#	
		    AND SUBSTR(TUM_RAD,2,2) = '00'	
		 )   
	</insert>		



	<!--기금수입계산서 UPDATE-->
	<update id="FAACAV008EUpdate_21" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_21 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV026L
			   SET  
				 TQR_CLCT_DCS_AMT = NVL(TO_NUMBER(TRIM(#TQR_CLCT_DCS_AMT#)), 0)
				,TQR_TO_CLCT_DCS_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_CLCT_DCS_ATAG#)), 0)
				,TQR_RCP_AMT = NVL(TO_NUMBER(TRIM(#TQR_RCP_AMT#)), 0)
				,TQR_TO_RCP_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_RCP_ATAG#)), 0)
				,TQR_RSR_AMT = NVL(TO_NUMBER(TRIM(#TQR_RSR_AMT#)), 0)
				,TQR_TO_RSR_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_RSR_ATAG#)), 0)
				,TQR_NPM_LO_AMT = NVL(TO_NUMBER(TRIM(#TQR_NPM_LO_AMT#)), 0)
				,TQR_TO_NPM_LO_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_NPM_LO_ATAG#)), 0)
				,UN_RCP_AMT = NVL(TO_NUMBER(TRIM(#UN_RCP_AMT#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--기금수입계산서 DELETE-->
	<update id="FAACAV008EDelete_21" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_21 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV026L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--기금수입계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_21" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_21 */ ]]>
		INSERT INTO TWFAACAV026L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
			,TQR_CLCT_DCS_AMT
			,TQR_TO_CLCT_DCS_ATAG
			,TQR_RCP_AMT
			,TQR_TO_RCP_ATAG
			,TQR_RSR_AMT
			,TQR_TO_RSR_ATAG
			,TQR_NPM_LO_AMT
			,TQR_TO_NPM_LO_ATAG
			,UN_RCP_AMT  
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#TQR_CLCT_DCS_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_CLCT_DCS_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_RCP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_RCP_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_RSR_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_RSR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_NPM_LO_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_NPM_LO_ATAG#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#UN_RCP_AMT#)), 0)  
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--기금수입계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_21" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_21 */ ]]>
		INSERT INTO TWFAACAV026L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
			,TQR_CLCT_DCS_AMT
			,TQR_TO_CLCT_DCS_ATAG
			,TQR_RCP_AMT
			,TQR_TO_RCP_ATAG
			,TQR_RSR_AMT
			,TQR_TO_RSR_ATAG
			,TQR_NPM_LO_AMT
			,TQR_TO_NPM_LO_ATAG
			,UN_RCP_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','00','00','000'
		    ,NVL(SUM(TQR_CLCT_DCS_AMT), 0) AS TQR_CLCT_DCS_AMT
		    ,NVL(SUM(TQR_TO_CLCT_DCS_ATAG), 0) AS TQR_TO_CLCT_DCS_ATAG
		    ,NVL(SUM(TQR_RCP_AMT), 0) AS TQR_RCP_AMT
		    ,NVL(SUM(TQR_TO_RCP_ATAG), 0) AS TQR_TO_RCP_ATAG
		    ,NVL(SUM(TQR_RSR_AMT), 0) AS TQR_RSR_AMT
		    ,NVL(SUM(TQR_TO_RSR_ATAG), 0) AS TQR_TO_RSR_ATAG
		    ,NVL(SUM(TQR_NPM_LO_AMT), 0) AS TQR_NPM_LO_AMT
		    ,NVL(SUM(TQR_TO_NPM_LO_ATAG), 0) AS TQR_TO_NPM_LO_ATAG
		    ,NVL(SUM(UN_RCP_AMT), 0) AS UN_RCP_AMT
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV026L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert>
	
   	<!--수입금출납계산서 UPDATE-->
	<update id="FAACAV008EUpdate_22" parameterClass="paramMap">.
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_22 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV032L
			   SET  
				 TQR_RCT_AMT = NVL(TO_NUMBER(TRIM(#TQR_RCT_AMT#)), 0)
				,TQR_TO_RCT_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_RCT_ATAG#)), 0)
				,TQR_PD_AMT = NVL(TO_NUMBER(TRIM(#TQR_PD_AMT#)), 0)
				,TQR_TO_PD_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_PD_ATAG#)), 0)
				,UNP_AMT = NVL(TO_NUMBER(TRIM(#UNP_AMT#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND INCAM_RAD=#INCAM_RAD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--수입금출납계산서 DELETE-->
	<update id="FAACAV008EDelete_22" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_22 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV032L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND INCAM_RAD=#INCAM_RAD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--수입금출납계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_22" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_22 */ ]]>
		INSERT INTO TWFAACAV032L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
            ,INCAM_RAD
			,CHIF_CD
			,SSEC_CD
			,ITM_CD
			,SITM_CD
			,TQR_RCT_AMT
			,TQR_TO_RCT_ATAG
			,TQR_PD_AMT
			,TQR_TO_PD_ATAG
			,UNP_AMT  
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			   #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,(
                SELECT LPAD(TO_CHAR(MAX(TO_NUMBER(NVL(INCAM_RAD,'0')))+1 ),3,'0') 
                FROM TWFAACAV032L
                WHERE  1=1
                  AND COPT_CD = #COPT_CD#
                  AND ACNT_CD = #ACNT_CD#
                  AND BLL_CD = #BLL_CD#
                  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
                  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
                  AND PROF_YM = #PROF_YM#             
              )
			  ,#CHIF_CD#
			  ,#SSEC_CD#
			  ,#ITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#TQR_RCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_RCT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_PD_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_PD_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#UNP_AMT#)), 0)  
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--수입금출납계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_22" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_22 */ ]]>
		INSERT INTO TWFAACAV032L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,INCAM_RAD
			,CHIF_CD
			,SSEC_CD
			,ITM_CD
			,SITM_CD 
			,TQR_RCT_AMT
			,TQR_TO_RCT_ATAG
			,TQR_PD_AMT
			,TQR_TO_PD_ATAG
			,UNP_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'000','00','00','00','000'
		    ,NVL(SUM(TQR_RCT_AMT), 0) AS TQR_RCT_AMT 
		    ,NVL(SUM(TQR_TO_RCT_ATAG), 0) AS TQR_TO_RCT_ATAG
		    ,NVL(SUM(TQR_PD_AMT), 0) AS TQR_PD_AMT
		    ,NVL(SUM(TQR_TO_PD_ATAG), 0) AS TQR_TO_PD_ATAG
		    ,NVL(SUM(UNP_AMT), 0) AS UNP_AMT 
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,'TEST'
		 FROM
		    TWFAACAV032L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert> 	
	
   	<!--환급금지급액계산서 UPDATE-->
	<update id="FAACAV008EUpdate_23" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_23 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV051L
			   SET  
				 THMN_TRAC_NTF_AMT = NVL(TO_NUMBER(TRIM(#THMN_TRAC_NTF_AMT#)), 0)
				,THMN_TO_TRAC_NTF_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_TRAC_NTF_ATAG#)), 0)
				,THMN_PMT_DCS_AMT = NVL(TO_NUMBER(TRIM(#THMN_PMT_DCS_AMT#)), 0)
				,THMN_TO_PMT_DCS_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_PMT_DCS_ATAG#)), 0)
				,THMN_PMT_AMT = NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
				,THMN_TO_PMT_ATAG = NVL(TO_NUMBER(TRIM(#THMN_TO_PMT_ATAG#)), 0)
				,TRAC_NTF_NPMT_AMT = NVL(TO_NUMBER(TRIM(#TRAC_NTF_NPMT_AMT#)), 0)
				,PMT_DCS_NPMT_AMT = NVL(TO_NUMBER(TRIM(#PMT_DCS_NPMT_AMT#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND RSRAM_DCS_AMT_NO=#RSRAM_DCS_AMT_NO#

	</update>
	<!--환급금지급액계산서 DELETE-->
	<update id="FAACAV008EDelete_23" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_23 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV051L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND RSRAM_DCS_AMT_NO=#RSRAM_DCS_AMT_NO#
	</update>
	
	<!--환급금지급액계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_23" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_23 */ ]]>
		INSERT INTO TWFAACAV051L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,RSRAM_DCS_AMT_NO
			,THMN_TRAC_NTF_AMT
			,THMN_TO_TRAC_NTF_ATAG
			,THMN_PMT_DCS_AMT
			,THMN_TO_PMT_DCS_ATAG
			,THMN_PMT_AMT
			,THMN_TO_PMT_ATAG
			,TRAC_NTF_NPMT_AMT
			,PMT_DCS_NPMT_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#RSRAM_DCS_AMT_NO#
			  ,NVL(TO_NUMBER(TRIM(#THMN_TRAC_NTF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_TRAC_NTF_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_PMT_DCS_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_PMT_DCS_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_PMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_TO_PMT_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TRAC_NTF_NPMT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#PMT_DCS_NPMT_AMT#)), 0)		  			  
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--환급금지급액계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_23" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_23 */ ]]>
		INSERT INTO TWFAACAV051L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,RSRAM_DCS_AMT_NO
			,THMN_TRAC_NTF_AMT
			,THMN_TO_TRAC_NTF_ATAG
			,THMN_PMT_DCS_AMT
			,THMN_TO_PMT_DCS_ATAG
			,THMN_PMT_AMT
			,THMN_TO_PMT_ATAG
			,TRAC_NTF_NPMT_AMT
			,PMT_DCS_NPMT_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'000'
		    ,NVL(SUM(THMN_TRAC_NTF_AMT), 0) AS THMN_TRAC_NTF_AMT
		    ,NVL(SUM(THMN_TO_TRAC_NTF_ATAG), 0) AS THMN_TO_TRAC_NTF_ATAG
		    ,NVL(SUM(THMN_PMT_DCS_AMT), 0) AS THMN_PMT_DCS_AMT
		    ,NVL(SUM(THMN_TO_PMT_DCS_ATAG), 0) AS THMN_TO_PMT_DCS_ATAG
		    ,NVL(SUM(THMN_PMT_AMT), 0) AS THMN_PMT_AMT
		    ,NVL(SUM(THMN_TO_PMT_ATAG), 0) AS THMN_TO_PMT_ATAG
		    ,NVL(SUM(TRAC_NTF_NPMT_AMT), 0) AS TRAC_NTF_NPMT_AMT
		    ,NVL(SUM(PMT_DCS_NPMT_AMT), 0) AS PMT_DCS_NPMT_AMT
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV051L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert> 	
	
   	<!--수입대체경비출납계산서 UPDATE-->
	<update id="FAACAV008EUpdate_24" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_24 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV034L
			   SET  
				 TQR_INC_EXPN_AMT = NVL(TO_NUMBER(TRIM(#TQR_INC_EXPN_AMT#)), 0)
				,TQR_INC_EXPN_ATAG = NVL(TO_NUMBER(TRIM(#TQR_INC_EXPN_ATAG#)), 0)
				,TQR_REV_PD_AMT = NVL(TO_NUMBER(TRIM(#TQR_REV_PD_AMT#)), 0)
				,TQR_TO_REV_PD_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_REV_PD_ATAG#)), 0)
				,INC_REV_SBTR_ATAG = NVL(TO_NUMBER(TRIM(#INC_REV_SBTR_ATAG#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND EXP_DVSN_CD=#EXP_DVSN_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--수입대체경비출납계산서 DELETE-->
	<update id="FAACAV008EDelete_24" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_24 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV034L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND EXP_DVSN_CD=#EXP_DVSN_CD#
			  AND CHIF_CD=#CHIF_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND DITM_CD=#DITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--수입대체경비출납계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_24" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_24 */ ]]>
		INSERT INTO TWFAACAV034L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,EXP_DVSN_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD
			,TQR_INC_EXPN_AMT
			,TQR_INC_EXPN_ATAG
			,TQR_REV_PD_AMT
			,TQR_TO_REV_PD_ATAG
			,INC_REV_SBTR_ATAG 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,'1'
			  ,#CHIF_CD#
			  ,#SSEC_CD#
			  ,#DITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#TQR_INC_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_INC_EXPN_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_REV_PD_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_REV_PD_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#INC_REV_SBTR_ATAG#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--수입대체경비출납계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_24" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_24 */ ]]>
		INSERT INTO TWFAACAV034L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,EXP_DVSN_CD
			,CHIF_CD
			,SSEC_CD
			,DITM_CD
			,SITM_CD 
			,TQR_INC_EXPN_AMT
			,TQR_INC_EXPN_ATAG
			,TQR_REV_PD_AMT
			,TQR_TO_REV_PD_ATAG
			,INC_REV_SBTR_ATAG
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'1','000','000','0000','000'
		    ,NVL(SUM(TQR_INC_EXPN_AMT), 0) AS TQR_INC_EXPN_AMT
		    ,NVL(SUM(TQR_INC_EXPN_ATAG), 0) AS TQR_INC_EXPN_ATAG
		    ,NVL(SUM(TQR_REV_PD_AMT), 0) AS TQR_REV_PD_AMT
		    ,NVL(SUM(TQR_TO_REV_PD_ATAG), 0) AS TQR_TO_REV_PD_ATAG
		    ,NVL(SUM(INC_REV_SBTR_ATAG), 0) AS INC_REV_SBTR_ATAG
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV034L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#		
		 )   
	</insert>	
	
   	<!--세입징수액계산서(지방) UPDATE-->
	<update id="FAACAV008EUpdate_25" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_25 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV054L
			   SET  
				 TQR_CLCT_DCS_AMT = NVL(TO_NUMBER(TRIM(#TQR_CLCT_DCS_AMT#)), 0)
				,TQR_TO_CLCT_DCS_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_CLCT_DCS_ATAG#)), 0)
				,TQR_RCP_AMT = NVL(TO_NUMBER(TRIM(#TQR_RCP_AMT#)), 0)
				,TQR_TO_RCP_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_RCP_ATAG#)), 0)
				,TQR_RSR_AMT = NVL(TO_NUMBER(TRIM(#TQR_RSR_AMT#)), 0)
				,TQR_TO_RSR_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_RSR_ATAG#)), 0)
				,TQR_NPM_LO_AMT = NVL(TO_NUMBER(TRIM(#TQR_NPM_LO_AMT#)), 0)
				,TQR_TO_NPM_LO_ATAG = NVL(TO_NUMBER(TRIM(#TQR_TO_NPM_LO_ATAG#)), 0)
				,UNP_AMT = NVL(TO_NUMBER(TRIM(#UNP_AMT#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
			  AND DGE=#DGE#              
	</update>
	<!--세입징수액계산서(지방) DELETE-->
	<update id="FAACAV008EDelete_25" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_25 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV054L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
			  AND DGE=#DGE#  
	</update>
	
	<!--세입징수액계산서(지방) 예산과목 추가-->
	<insert id="FAACAV008EInsert_25" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_25 */ ]]>
		INSERT INTO TWFAACAV054L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SSEC_CD
			,ITM_CD
			,SITM_CD
            ,DGE
			,TQR_CLCT_DCS_AMT
			,TQR_TO_CLCT_DCS_ATAG
			,TQR_RCP_AMT
			,TQR_TO_RCP_ATAG
			,TQR_RSR_AMT
			,TQR_TO_RSR_ATAG
			,TQR_NPM_LO_AMT
			,TQR_TO_NPM_LO_ATAG
			,UNP_AMT  
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#SSEC_CD#
			  ,#ITM_CD#
			  ,#SITM_CD#
              ,(
                SELECT NVL(MAX(DGE),0)+1 
                FROM TWFAACAV054L 
                WHERE 
                  COPT_CD = #COPT_CD#
                  AND ACNT_CD = #ACNT_CD#
                  AND BLL_CD = #BLL_CD#
                  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
                  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
                  AND PROF_YM = #PROF_YM#
                  AND SUM_DVSN_ID != '49' 
                  AND SUM_DVSN_ID != '51'
                  AND SSEC_CD=#SSEC_CD#
                  AND ITM_CD=#ITM_CD#              
                  AND SITM_CD=#SITM_CD#
              )
			  ,NVL(TO_NUMBER(TRIM(#TQR_CLCT_DCS_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_CLCT_DCS_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_RCP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_RCP_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_RSR_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_RSR_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_NPM_LO_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_TO_NPM_LO_ATAG#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#UNP_AMT#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--세입징수액계산서(지방) 합계 추가-->
	<insert id="FAACAV008ESumInsert_25" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_25 */ ]]>
		INSERT INTO TWFAACAV054L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SSEC_CD
			,ITM_CD
			,SITM_CD
            ,DGE
			,TQR_CLCT_DCS_AMT
			,TQR_TO_CLCT_DCS_ATAG
			,TQR_RCP_AMT
			,TQR_TO_RCP_ATAG
			,TQR_RSR_AMT
			,TQR_TO_RSR_ATAG
			,TQR_NPM_LO_AMT
			,TQR_TO_NPM_LO_ATAG
			,UNP_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'000','000','00',1
		    ,NVL(SUM(TQR_CLCT_DCS_AMT), 0) AS TQR_CLCT_DCS_AMT
		    ,NVL(SUM(TQR_TO_CLCT_DCS_ATAG), 0) AS TQR_TO_CLCT_DCS_ATAG
		    ,NVL(SUM(TQR_RCP_AMT), 0) AS TQR_RCP_AMT
		    ,NVL(SUM(TQR_TO_RCP_ATAG), 0) AS TQR_TO_RCP_ATAG
		    ,NVL(SUM(TQR_RSR_AMT), 0) AS TQR_RSR_AMT
		    ,NVL(SUM(TQR_TO_RSR_ATAG), 0) AS TQR_TO_RSR_ATAG
		    ,NVL(SUM(TQR_NPM_LO_AMT), 0) AS TQR_NPM_LO_AMT
		    ,NVL(SUM(TQR_TO_NPM_LO_ATAG), 0) AS TQR_TO_NPM_LO_ATAG
		    ,NVL(SUM(UNP_AMT), 0) AS UNP_AMT
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV054L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 )   
	</insert> 	
	
    <!--물납액계산서 UPDATE-->
	<update id="FAACAV008EUpdate_26" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_26 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV050L
			   SET  
				  COT = TO_CHAR(#COT#)
				, GOP_RLV_TMT= NVL(TO_NUMBER(TRIM(#GOP_RLV_TMT#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YR = #PROF_YR#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SRNO=#SRNO#
	</update>
	<!--물납액계산서 DELETE-->
	<update id="FAACAV008EDelete_26" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_26 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV050L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YR = #PROF_YR#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SRNO=#SRNO#
	</update>
	
	<!--물납액계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_26" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_26 */ ]]>
		INSERT INTO TWFAACAV050L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YR
		    ,SUM_DVSN_ID
            ,SRNO
			,TAX_SITM_NM
			,GOP_KND_NM
			,TXTN_NOC
			,UNT_NM
			,COT
			,GOP_RLV_TMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YR#
			  ,#SUM_DVSN_ID#
			  ,#SRNO#
			  ,#TAX_SITM_NM#
			  ,#GOP_KND_NM#
			  ,NVL(TO_NUMBER(TRIM(#TXTN_NOC#)), 0)
			  ,#UNT_NM#
			  ,TO_CHAR(#COT#)
			  ,NVL(TO_NUMBER(TRIM(#GOP_RLV_TMT#)), 0)			  
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--물납액계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_26" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_26 */ ]]>
		INSERT INTO TWFAACAV050L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YR
		    ,SUM_DVSN_ID
            ,SRNO
			,TXTN_NOC
			,COT
			,GOP_RLV_TMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YR#,'49' AS SUM_DVSN_ID
		    ,0
		    ,NVL(SUM(TXTN_NOC), 0) AS TXTN_NOC
		    ,NVL(SUM(TO_NUMBER(TRIM(COT))), 0) AS COT
		    ,NVL(SUM(GOP_RLV_TMT), 0) AS GOP_RLV_TMT
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV050L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YR = #PROF_YR#
		 )   
	</insert>	
	
    	<!--세입세출외현금출납계산서 UPDATE-->
	<update id="FAACAV008EUpdate_27" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_27 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV014L
			   SET  
				 LTYR_CRFW_AMT = NVL(TO_NUMBER(TRIM(#LTYR_CRFW_AMT#)), 0)
				,THYR_CRFW_AMT = NVL(TO_NUMBER(TRIM(#THYR_CRFW_AMT#)), 0)
				,THYR_RCIT_AMT = NVL(TO_NUMBER(TRIM(#THYR_RCIT_AMT#)), 0)
				,THYR_DECR_OUT_AMT = NVL(TO_NUMBER(TRIM(#THYR_DECR_OUT_AMT#)), 0)
				,THYR_DECR_AMT = NVL(TO_NUMBER(TRIM(#THYR_DECR_AMT#)), 0)
				,THYR_ED_PRST_AMT_CSH = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_CSH#)), 0)
				,THYR_ED_PRST_BOK_DEPO_AMT = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_BOK_DEPO_AMT#)), 0)
				,THYR_ED_PRST_ATAG = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_ATAG#)), 0)	
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SUM_DTL_DVSN_ID=#SUM_DTL_DVSN_ID#
			  AND SUBJ_NM=#SUBJ_NM#
	</update>
	<!--세입세출외현금출납계산서 DELETE-->
	<update id="FAACAV008EDelete_27" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_27 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV014L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SUM_DTL_DVSN_ID=#SUM_DTL_DVSN_ID#
			  AND SUBJ_NM=#SUBJ_NM#
	</update>
	
	<!--세입세출외현금출납계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_27" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_27 */ ]]>
		INSERT INTO TWFAACAV014L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SUM_DTL_DVSN_ID
			,SUBJ_NM
			,LTYR_CRFW_AMT
			,THYR_CRFW_AMT
			,THYR_RCIT_AMT
			,THYR_DECR_OUT_AMT
			,THYR_DECR_AMT
			,THYR_ED_PRST_AMT_CSH
			,THYR_ED_PRST_BOK_DEPO_AMT
			,THYR_ED_PRST_ATAG 
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			   #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,(
                SELECT LPAD(TO_CHAR(MAX(TO_NUMBER(NVL(SUM_DTL_DVSN_ID,'0')))+1 ),2,'0') 
                FROM TWFAACAV014L
                WHERE  1=1
                    AND SUM_DVSN_ID != '49' 
                    AND COPT_CD = #COPT_CD#
                    AND ACNT_CD = #ACNT_CD#
                    AND BLL_CD = #BLL_CD#
                    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
                    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
                    AND PROF_YM = #PROF_YM#
              )
			  ,#SUBJ_NM#
			  ,NVL(TO_NUMBER(TRIM(#LTYR_CRFW_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_CRFW_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_RCIT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_DECR_OUT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_DECR_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_CSH#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_BOK_DEPO_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_ATAG#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--세입세출외현금출납계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_27" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_27 */ ]]>
		INSERT INTO TWFAACAV014L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SUM_DTL_DVSN_ID
			,SUBJ_NM
			,LTYR_CRFW_AMT
			,THYR_CRFW_AMT
			,THYR_RCIT_AMT
			,THYR_DECR_OUT_AMT
			,THYR_DECR_AMT
			,THYR_ED_PRST_AMT_CSH
			,THYR_ED_PRST_BOK_DEPO_AMT
			,THYR_ED_PRST_ATAG
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'00','  '
		    ,NVL(SUM(LTYR_CRFW_AMT), 0) AS LTYR_CRFW_AMT
		    ,NVL(SUM(THYR_CRFW_AMT), 0) AS THYR_CRFW_AMT
		    ,NVL(SUM(THYR_RCIT_AMT), 0) AS THYR_RCIT_AMT
		    ,NVL(SUM(THYR_DECR_OUT_AMT), 0) AS THYR_DECR_OUT_AMT
		    ,NVL(SUM(THYR_DECR_AMT), 0) AS THYR_DECR_AMT
		    ,NVL(SUM(THYR_ED_PRST_AMT_CSH), 0) AS THYR_ED_PRST_AMT_CSH
		    ,NVL(SUM(THYR_ED_PRST_BOK_DEPO_AMT), 0) AS THYR_ED_PRST_BOK_DEPO_AMT
		    ,NVL(SUM(THYR_ED_PRST_ATAG), 0) AS THYR_ED_PRST_ATAG
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV014L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 )   
	</insert>

   	<!--국가채권관리계산서 UPDATE-->
	<update id="FAACAV008EUpdate_28" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_28 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV013L
			   SET  
				 LTYR_BK_OGN_CRFW_AMT = NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_CRFW_AMT#)), 0)
				,LTYR_BK_OGN_VRT_AMT = NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_VRT_AMT#)), 0)
				,TQR_EXPN_AMT = NVL(TO_NUMBER(TRIM(#TQR_EXPN_AMT#)), 0)
				,OGN_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#OGN_AMT_SUM_AM#)), 0)
				,LTYR_BK_OGN_DAPR_AMT = NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_DAPR_AMT#)), 0)
				,THYR_OGN_DAPR_AMT = NVL(TO_NUMBER(TRIM(#THYR_OGN_DAPR_AMT#)), 0)
				,DAPR_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#DAPR_AMT_SUM_AM#)), 0)
				,LTYR_BK_PFM_DDLN_ADVT_AMT = NVL(TO_NUMBER(TRIM(#LTYR_BK_PFM_DDLN_ADVT_AMT#)), 0)
				,LTYR_BK_PFM_DDLN_UN_ADVT_AMT = NVL(TO_NUMBER(TRIM(#LTYR_BK_PFM_DDLN_UN_ADVT_AMT#)), 0)	
				,LTYR_BK_OGN_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_AMT_SUM_AM#)), 0)
				,THYR_OGN_PFM_DDLN_ADVT_AMT = NVL(TO_NUMBER(TRIM(#THYR_OGN_PFM_DDLN_ADVT_AMT#)), 0)
				,THYR_OGN_PFM_DDLN_UN_ADVT_AMT = NVL(TO_NUMBER(TRIM(#THYR_OGN_PFM_DDLN_UN_ADVT_AMT#)), 0)
				,THYR_OGN_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#THYR_OGN_AMT_SUM_AM#)), 0)
				,THYR_ED_GEN_SUM_AM = NVL(TO_NUMBER(TRIM(#THYR_ED_GEN_SUM_AM#)), 0)
				,LTYR_BK_OGN_MNG_ASG_AMT = NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_MNG_STOP_AMT#)), 0)
				,THYR_OGN_MNG_ASG_AMT = NVL(TO_NUMBER(TRIM(#THYR_OGN_MNG_ASG_AMT#)), 0)
				,MNG_ASG_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#MNG_ASG_AMT_SUM_AM#)), 0)
				,LTYR_BK_OGN_LO_AMT = NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_LO_AMT#)), 0)
				,THYR_LO_AMT = NVL(TO_NUMBER(TRIM(#THYR_LO_AMT#)), 0)
				,LO_ATAG = NVL(TO_NUMBER(TRIM(#LO_ATAG#)), 0)
				,THYR_ED_PRST_AMT_SUM_AM = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_SUM_AM#)), 0)	                
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	<!--국가채권관리계산서 DELETE-->
	<update id="FAACAV008EDelete_28" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_28 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV013L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND SSEC_CD=#SSEC_CD#
			  AND ITM_CD=#ITM_CD#
			  AND SITM_CD=#SITM_CD#
	</update>
	
	<!--국가채권관리계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_28" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_28 */ ]]>
		INSERT INTO TWFAACAV013L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,SSEC_CD
			,ITM_CD
			,SITM_CD
			,LTYR_BK_OGN_CRFW_AMT
			,LTYR_BK_OGN_VRT_AMT
			,TQR_EXPN_AMT
			,OGN_AMT_SUM_AM
			,LTYR_BK_OGN_DAPR_AMT
			,THYR_OGN_DAPR_AMT
			,DAPR_AMT_SUM_AM
			,LTYR_BK_PFM_DDLN_ADVT_AMT
			,LTYR_BK_PFM_DDLN_UN_ADVT_AMT
			,LTYR_BK_OGN_AMT_SUM_AM
			,THYR_OGN_PFM_DDLN_ADVT_AMT
			,THYR_OGN_PFM_DDLN_UN_ADVT_AMT
			,THYR_OGN_AMT_SUM_AM
			,THYR_ED_GEN_SUM_AM
			,LTYR_BK_OGN_MNG_ASG_AMT
			,THYR_OGN_MNG_ASG_AMT
			,MNG_ASG_AMT_SUM_AM
			,LTYR_BK_OGN_LO_AMT
			,THYR_LO_AMT
			,LO_ATAG
			,THYR_ED_PRST_AMT_SUM_AM
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#SSEC_CD#
			  ,#ITM_CD#
			  ,#SITM_CD#
			  ,NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_CRFW_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_VRT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#TQR_EXPN_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#OGN_AMT_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_DAPR_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_OGN_DAPR_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#DAPR_AMT_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTYR_BK_PFM_DDLN_ADVT_AMT#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#LTYR_BK_PFM_DDLN_UN_ADVT_AMT#)), 0)	
			  ,NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_AMT_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_OGN_PFM_DDLN_ADVT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_OGN_PFM_DDLN_UN_ADVT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_OGN_AMT_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_GEN_SUM_AM#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_MNG_STOP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_OGN_MNG_ASG_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#MNG_ASG_AMT_SUM_AM#)), 0)	  
			  ,NVL(TO_NUMBER(TRIM(#LTYR_BK_OGN_LO_AMT#)), 0) 
			  ,NVL(TO_NUMBER(TRIM(#THYR_LO_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LO_ATAG#)), 0)	  
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_SUM_AM#)), 0)               
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--국가채권관리계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_28" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_28 */ ]]>
		INSERT INTO TWFAACAV013L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,SSEC_CD
			,ITM_CD
			,SITM_CD 
			,LTYR_BK_OGN_CRFW_AMT
			,LTYR_BK_OGN_VRT_AMT
			,TQR_EXPN_AMT
			,OGN_AMT_SUM_AM
			,LTYR_BK_OGN_DAPR_AMT
			,THYR_OGN_DAPR_AMT
			,DAPR_AMT_SUM_AM
			,LTYR_BK_PFM_DDLN_ADVT_AMT
			,LTYR_BK_PFM_DDLN_UN_ADVT_AMT
			,LTYR_BK_OGN_AMT_SUM_AM
			,THYR_OGN_PFM_DDLN_ADVT_AMT
			,THYR_OGN_PFM_DDLN_UN_ADVT_AMT
			,THYR_OGN_AMT_SUM_AM
			,THYR_ED_GEN_SUM_AM
			,LTYR_BK_OGN_MNG_ASG_AMT
			,THYR_OGN_MNG_ASG_AMT
			,MNG_ASG_AMT_SUM_AM
			,LTYR_BK_OGN_LO_AMT
			,THYR_LO_AMT
			,LO_ATAG
			,THYR_ED_PRST_AMT_SUM_AM
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','00','00','000'
		    ,NVL(SUM(LTYR_BK_OGN_CRFW_AMT), 0) AS LTYR_BK_OGN_CRFW_AMT
		    ,NVL(SUM(LTYR_BK_OGN_VRT_AMT), 0) AS LTYR_BK_OGN_VRT_AMT
		    ,NVL(SUM(TQR_EXPN_AMT), 0) AS TQR_EXPN_AMT
		    ,NVL(SUM(OGN_AMT_SUM_AM), 0) AS OGN_AMT_SUM_AM
		    ,NVL(SUM(LTYR_BK_OGN_DAPR_AMT), 0) AS LTYR_BK_OGN_DAPR_AMT
		    ,NVL(SUM(THYR_OGN_DAPR_AMT), 0) AS THYR_OGN_DAPR_AMT
		    ,NVL(SUM(DAPR_AMT_SUM_AM), 0) AS DAPR_AMT_SUM_AM
		    ,NVL(SUM(LTYR_BK_PFM_DDLN_ADVT_AMT), 0) AS LTYR_BK_PFM_DDLN_ADVT_AMT
		    ,NVL(SUM(LTYR_BK_PFM_DDLN_UN_ADVT_AMT), 0) AS LTYR_BK_PFM_DDLN_UN_ADVT_AMT
		    ,NVL(SUM(LTYR_BK_OGN_AMT_SUM_AM), 0) AS LTYR_BK_OGN_AMT_SUM_AM
		    ,NVL(SUM(THYR_OGN_PFM_DDLN_ADVT_AMT), 0) AS THYR_OGN_PFM_DDLN_ADVT_AMT
		    ,NVL(SUM(THYR_OGN_PFM_DDLN_UN_ADVT_AMT), 0) AS THYR_OGN_PFM_DDLN_UN_ADVT_AMT
		    ,NVL(SUM(THYR_OGN_AMT_SUM_AM), 0) AS THYR_OGN_AMT_SUM_AM
		    ,NVL(SUM(THYR_ED_GEN_SUM_AM), 0) AS THYR_ED_GEN_SUM_AM
		    ,NVL(SUM(LTYR_BK_OGN_MNG_ASG_AMT), 0) AS LTYR_BK_OGN_MNG_ASG_AMT
		    ,NVL(SUM(THYR_OGN_MNG_ASG_AMT), 0) AS THYR_OGN_MNG_ASG_AMT
		    ,NVL(SUM(MNG_ASG_AMT_SUM_AM), 0) AS MNG_ASG_AMT_SUM_AM
		    ,NVL(SUM(LTYR_BK_OGN_LO_AMT), 0) AS LTYR_BK_OGN_LO_AMT  
		    ,NVL(SUM(THYR_LO_AMT), 0) AS THYR_LO_AMT
		    ,NVL(SUM(LO_ATAG), 0) AS LO_ATAG
		    ,NVL(SUM(THYR_ED_PRST_AMT_SUM_AM), 0) AS THYR_ED_PRST_AMT_SUM_AM            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV013L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 )   
	</insert> 	
	
    <!--국가채무증감계산서 UPDATE-->
	<update id="FAACAV008EUpdate_29" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_29 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV036L
			   SET  
				 LTYR_ED_PRST_AMT = NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT#)), 0)
				,THYR_OGN_BND_AMT = NVL(TO_NUMBER(TRIM(#THYR_OGN_BND_AMT#)), 0)
				,THYR_OGN_LBT_AC_AMT = NVL(TO_NUMBER(TRIM(#THYR_OGN_LBT_AC_AMT#)), 0)
				,THYR_OGN_MGN_SUM_AM = NVL(TO_NUMBER(TRIM(#THYR_OGN_MGN_SUM_AM#)), 0)
				,THYR_SBJ_DAPR_AMT = NVL(TO_NUMBER(TRIM(#THYR_SBJ_DAPR_AMT#)), 0)
				,THYR_ED_PRST_AMT = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT#)), 0)
				,INT_PMT_AMT = NVL(TO_NUMBER(TRIM(#INT_PMT_AMT#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND LBT_VRT_NO=#LBT_VRT_NO#
			  AND TAX_DVSN_CD=#TAX_DVSN_CD#
			  AND DVSN_NM=#DVSN_NM#
	</update>
	
	<!--국가채무증감계산서 DELETE-->
	<update id="FAACAV008EDelete_29" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_29 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV036L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACCT_CD=#ACCT_CD#
			  AND LBT_VRT_NO=#LBT_VRT_NO#
			  AND TAX_DVSN_CD=#TAX_DVSN_CD#
			  AND DVSN_NM=#DVSN_NM#
	</update>
	
	<!--국가채무증감계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_29" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_29 */ ]]>
		INSERT INTO TWFAACAV036L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,LBT_VRT_NO
			,TAX_DVSN_CD
			,DVSN_NM
			,LTYR_ED_PRST_AMT
			,THYR_OGN_BND_AMT
			,THYR_OGN_LBT_AC_AMT
			,THYR_OGN_MGN_SUM_AM
			,TOT_SUM_AM
			,THYR_SBJ_DAPR_AMT
			,THYR_ED_PRST_AMT
            ,INT_PMT_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID  
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACCT_CD#
			  ,#LBT_VRT_NO#
			  ,#TAX_DVSN_CD#
			  ,#DVSN_NM#
			  ,NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_OGN_BND_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_OGN_LBT_AC_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_OGN_MGN_SUM_AM#)), 0)
			  ,0
			  ,NVL(TO_NUMBER(TRIM(#THYR_SBJ_DAPR_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#INT_PMT_AMT#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--국가채무증감계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_29" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_29 */ ]]>
		INSERT INTO TWFAACAV036L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACCT_CD
			,LBT_VRT_NO
			,TAX_DVSN_CD
			,DVSN_NM
			,LTYR_ED_PRST_AMT
			,THYR_OGN_BND_AMT
			,THYR_OGN_LBT_AC_AMT
			,THYR_OGN_MGN_SUM_AM
			,TOT_SUM_AM
			,THYR_SBJ_DAPR_AMT
			,THYR_ED_PRST_AMT
            ,INT_PMT_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#, '49' AS SUM_DVSN_ID
		    ,'0','00','2','000000'
		    ,NVL(SUM(LTYR_ED_PRST_AMT), 0) AS LTYR_ED_PRST_AMT
		    ,NVL(SUM(THYR_OGN_BND_AMT), 0) AS THYR_OGN_BND_AMT
		    ,NVL(SUM(THYR_OGN_LBT_AC_AMT), 0) AS THYR_OGN_LBT_AC_AMT
		    ,NVL(SUM(THYR_OGN_MGN_SUM_AM), 0) AS THYR_OGN_MGN_SUM_AM
		    ,0
		    ,NVL(SUM(THYR_SBJ_DAPR_AMT), 0) AS THYR_SBJ_DAPR_AMT
		    ,NVL(SUM(THYR_ED_PRST_AMT), 0) AS THYR_ED_PRST_AMT
		    ,NVL(SUM(INT_PMT_AMT), 0) AS INT_PMT_AMT
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV036L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		    AND TAX_DVSN_CD = '2'
		    
		 UNION ALL
		 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#, '49' AS SUM_DVSN_ID
		    ,'0','00',TAX_DVSN_CD,'000000'
		    ,NVL(SUM(LTYR_ED_PRST_AMT), 0) AS LTYR_ED_PRST_AMT
		    ,NVL(SUM(THYR_OGN_BND_AMT), 0) AS THYR_OGN_BND_AMT
		    ,NVL(SUM(THYR_OGN_LBT_AC_AMT), 0) AS THYR_OGN_LBT_AC_AMT
		    ,NVL(SUM(THYR_OGN_MGN_SUM_AM), 0) AS THYR_OGN_MGN_SUM_AM
		    ,0
		    ,NVL(SUM(THYR_SBJ_DAPR_AMT), 0) AS THYR_SBJ_DAPR_AMT
		    ,NVL(SUM(THYR_ED_PRST_AMT), 0) AS THYR_ED_PRST_AMT
		    ,NVL(SUM(INT_PMT_AMT), 0) AS INT_PMT_AMT
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV036L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		    AND TAX_DVSN_CD != '2'
		 GROUP BY TAX_DVSN_CD    
		 )   
	</insert>
	
	<!--물품관리계산서 UPDATE-->
	<update id="FAACAV008EUpdate_30" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_30 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV031L
			   SET  
				 LTYR_ED_PRST_AMT_COT = NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_COT#)), 0)
				,LTYR_ED_PRST_AMT_PR = NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_PR#)), 0)
				,THYR_INCR_COT = NVL(TO_NUMBER(TRIM(#THYR_INCR_COT#)), 0)
				,THYR_INCR_PR = NVL(TO_NUMBER(TRIM(#THYR_INCR_PR#)), 0)
				,THYR_DECR_COT = NVL(TO_NUMBER(TRIM(#THYR_DECR_COT#)), 0)
				,THYR_DECR_PR = NVL(TO_NUMBER(TRIM(#THYR_DECR_PR#)), 0)
				,THYR_CMPR_VRT_COT = NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_COT#)), 0)
				,THYR_CMPR_VRT_PR = NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_PR#)), 0)
				,THYR_ED_PRST_AMT_COT = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_COT#)), 0)	
				,THYR_ED_PRST_AMT_PR = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_PR#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND GDS_SRNO=#GDS_SRNO_1#
			  AND GDS_CD=#GDS_CD_1#
	</update>
	
	<!--물품관리계산서 DELETE-->
	<update id="FAACAV008EDelete_30" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_30 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV031L
        ]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND GDS_SRNO=#GDS_SRNO_1#
			  AND GDS_CD=#GDS_CD_1#
	</update>
	
	<!--물품관리계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_30" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_30 */ ]]>
		INSERT INTO TWFAACAV031L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,GDS_SRNO
			,GDS_CD
            ,GDS_UNT_NM
			,LTYR_ED_PRST_AMT_COT
			,LTYR_ED_PRST_AMT_PR
			,THYR_INCR_COT
			,THYR_INCR_PR
			,THYR_DECR_COT
			,THYR_DECR_PR
			,THYR_CMPR_VRT_COT
			,THYR_CMPR_VRT_PR
			,THYR_ED_PRST_AMT_COT
			,THYR_ED_PRST_AMT_PR
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#GDS_SRNO_1#
			  ,#GDS_CD_1#
			  ,#GDS_UNT_NM_1#
			  ,NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_PR#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_INCR_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_INCR_PR#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_DECR_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_DECR_PR#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_PR#)), 0)	  
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_PR#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--물품관리계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_30" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_30 */ ]]>
		INSERT INTO TWFAACAV031L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,GDS_SRNO
            ,GDS_CD
            ,GDS_UNT_NM
			,LTYR_ED_PRST_AMT_COT
			,LTYR_ED_PRST_AMT_PR
			,THYR_INCR_COT
			,THYR_INCR_PR
			,THYR_DECR_COT
			,THYR_DECR_PR
			,THYR_CMPR_VRT_COT
			,THYR_CMPR_VRT_PR
			,THYR_ED_PRST_AMT_COT
			,THYR_ED_PRST_AMT_PR
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0000', ' ', ' '
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT 
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV031L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
            AND GDS_SRNO != '0000'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 UNION ALL
		 SELECT 
		     COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM, SUM_DVSN_ID
		    ,'0000', ' ', ' '
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT 
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV031L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
            AND GDS_SRNO != '0000'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 GROUP BY
		    COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM, SUM_DVSN_ID		    
		 )   
	</insert>
	
   	<!--국유재산증감및현재액계산서 UPDATE-->
	<update id="FAACAV008EUpdate_31" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_31 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV046L
			   SET  
				 LTYR_ED_PRST_AMT_COT = NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_COT#)), 0)
				,LTYR_ED_PRST_AMT_PR = NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_PR#)), 0)
				,THYR_INCR_COT = NVL(TO_NUMBER(TRIM(#THYR_INCR_COT#)), 0)
				,THYR_INCR_PR = NVL(TO_NUMBER(TRIM(#THYR_INCR_PR#)), 0)
				,THYR_DECR_COT = NVL(TO_NUMBER(TRIM(#THYR_DECR_COT#)), 0)
				,THYR_DECR_PR = NVL(TO_NUMBER(TRIM(#THYR_DECR_PR#)), 0)
				,THYR_CMPR_VRT_COT = NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_COT#)), 0)
				,THYR_CMPR_VRT_PR = NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_PR#)), 0)
				,THYR_ED_PRST_AMT_COT = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_COT#)), 0)	
				,THYR_ED_PRST_AMT_PR = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_PR#)), 0)             
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND DITM_DVSN_CD=#DITM_DVSN_CD#
			  AND TAX_DITM_DVSN_CD=#TAX_DITM_DVSN_CD#
	</update>
	<!--국유재산증감및현재액계산서 DELETE-->
	<update id="FAACAV008EDelete_31" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_31 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV046L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND DITM_DVSN_CD=#DITM_DVSN_CD#
			  AND TAX_DITM_DVSN_CD=#TAX_DITM_DVSN_CD#
	</update>
	
	<!--국유재산증감및현재액계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_31" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_31 */ ]]>
		INSERT INTO TWFAACAV046L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,DITM_DVSN_CD
			,TAX_DITM_DVSN_CD
			,LTYR_ED_PRST_AMT_COT
			,LTYR_ED_PRST_AMT_PR
			,THYR_INCR_COT
			,THYR_INCR_PR
			,THYR_DECR_COT
			,THYR_DECR_PR
			,THYR_CMPR_VRT_COT
			,THYR_CMPR_VRT_PR
			,THYR_ED_PRST_AMT_COT
			,THYR_ED_PRST_AMT_PR
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#DITM_DVSN_CD#
			  ,#TAX_DITM_DVSN_CD#
			  ,NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_PR#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_INCR_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_INCR_PR#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_DECR_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_DECR_PR#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_PR#)), 0)	  
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_COT#)), 0)		
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_PR#)), 0)            
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--국유재산증감및현재액계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_31" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_31 */ ]]>
		INSERT INTO TWFAACAV046L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,DITM_DVSN_CD
			,TAX_DITM_DVSN_CD
			,LTYR_ED_PRST_AMT_COT
			,LTYR_ED_PRST_AMT_PR
			,THYR_INCR_COT
			,THYR_INCR_PR
			,THYR_DECR_COT
			,THYR_DECR_PR
			,THYR_CMPR_VRT_COT
			,THYR_CMPR_VRT_PR
			,THYR_ED_PRST_AMT_COT
			,THYR_ED_PRST_AMT_PR
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'00','00'
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV046L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
            AND ( SUM_DVSN_ID = '11' AND TAX_DITM_DVSN_CD NOT IN ('04','14','49') )  
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 UNION ALL            
		 SELECT 
		     COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM,'11' AS SUM_DVSN_ID
		    ,DITM_DVSN_CD
            ,'49'
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV046L
		 WHERE
		        DITM_DVSN_CD IN ('01','02','03' )  
            AND TAX_DITM_DVSN_CD NOT IN ('04','14','49') 
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 GROUP BY
		    COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM, DITM_DVSN_CD  
		 UNION ALL            
		 SELECT 
		     COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM,'11' AS SUM_DVSN_ID
		    ,DITM_DVSN_CD
            ,'04'
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV046L
		 WHERE
		        DITM_DVSN_CD IN ('01','02','03' )   
            AND TAX_DITM_DVSN_CD IN ('01','02','03') 
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 GROUP BY
		    COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM, DITM_DVSN_CD    
		 UNION ALL            
		 SELECT 
		     COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM,'11' AS SUM_DVSN_ID
		    ,DITM_DVSN_CD
            ,'14'
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV046L
		 WHERE
		        DITM_DVSN_CD IN ('01','02','03' )   
            AND TAX_DITM_DVSN_CD IN ('11','12','13') 
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 GROUP BY
		    COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM, DITM_DVSN_CD                
		 )   
	</insert>
	
   	<!--국유재산무상대부액계산서 UPDATE-->
	<update id="FAACAV008EUpdate_32" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_32 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV045L
			   SET  
				 LTYR_ED_PRST_AMT_COT = NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_COT#)), 0)
				,LTYR_ED_PRST_AMT_PR = NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_PR#)), 0)
				,THYR_INCR_COT = NVL(TO_NUMBER(TRIM(#THYR_INCR_COT#)), 0)
				,THYR_INCR_PR = NVL(TO_NUMBER(TRIM(#THYR_INCR_PR#)), 0)
				,THYR_DECR_COT = NVL(TO_NUMBER(TRIM(#THYR_DECR_COT#)), 0)
				,THYR_DECR_PR = NVL(TO_NUMBER(TRIM(#THYR_DECR_PR#)), 0)
				,THYR_CMPR_VRT_COT = NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_COT#)), 0)
				,THYR_CMPR_VRT_PR = NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_PR#)), 0)
				,THYR_ED_PRST_AMT_COT = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_COT#)), 0)	
				,THYR_ED_PRST_AMT_PR = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_PR#)), 0)             
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND DITM_DVSN_CD=#DITM_DVSN_CD#
			  AND TAX_DITM_DVSN_CD=#TAX_DITM_DVSN_CD#
	</update>
	<!--국유재산무상대부액계산서 DELETE-->
	<update id="FAACAV008EDelete_32" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_32 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV045L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND DITM_DVSN_CD=#DITM_DVSN_CD#
			  AND TAX_DITM_DVSN_CD=#TAX_DITM_DVSN_CD#
	</update>
	
	<!--국유재산무상대부액계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_32" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_32 */ ]]>
		INSERT INTO TWFAACAV045L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,DITM_DVSN_CD
			,TAX_DITM_DVSN_CD
			,LTYR_ED_PRST_AMT_COT
			,LTYR_ED_PRST_AMT_PR
			,THYR_INCR_COT
			,THYR_INCR_PR
			,THYR_DECR_COT
			,THYR_DECR_PR
			,THYR_CMPR_VRT_COT
			,THYR_CMPR_VRT_PR
			,THYR_ED_PRST_AMT_COT
			,THYR_ED_PRST_AMT_PR
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#DITM_DVSN_CD#
			  ,#TAX_DITM_DVSN_CD#
			  ,NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTYR_ED_PRST_AMT_PR#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_INCR_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_INCR_PR#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_DECR_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_DECR_PR#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_CMPR_VRT_PR#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_COT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT_PR#)), 0)	              
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
    
	<!--국유재산무상대부액계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_32" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_32 */ ]]>
		INSERT INTO TWFAACAV045L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,DITM_DVSN_CD
			,TAX_DITM_DVSN_CD
			,LTYR_ED_PRST_AMT_COT
			,LTYR_ED_PRST_AMT_PR
			,THYR_INCR_COT
			,THYR_INCR_PR
			,THYR_DECR_COT
			,THYR_DECR_PR
			,THYR_CMPR_VRT_COT
			,THYR_CMPR_VRT_PR
			,THYR_ED_PRST_AMT_COT
			,THYR_ED_PRST_AMT_PR
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'00','00'
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV045L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
            AND ( SUM_DVSN_ID = '11' AND TAX_DITM_DVSN_CD NOT IN ('04','14','49') )  
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 UNION ALL            
		 SELECT 
		     COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM,'11' AS SUM_DVSN_ID
		    ,DITM_DVSN_CD
            ,'49'
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID# 
		 FROM
		    TWFAACAV045L
		 WHERE
		        DITM_DVSN_CD IN ('01','02','03' )  
            AND TAX_DITM_DVSN_CD NOT IN ('04','14','49') 
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 GROUP BY
		    COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM, DITM_DVSN_CD  
		 UNION ALL            
		 SELECT 
		     COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM,'11' AS SUM_DVSN_ID
		    ,DITM_DVSN_CD
            ,'04'
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID# 
		 FROM
		    TWFAACAV045L
		 WHERE
		        DITM_DVSN_CD IN ('01','02','03' )   
            AND TAX_DITM_DVSN_CD IN ('01','02','03') 
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 GROUP BY
		    COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM, DITM_DVSN_CD    
		 UNION ALL            
		 SELECT 
		     COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM,'11' AS SUM_DVSN_ID
		    ,DITM_DVSN_CD
            ,'14'
		    ,NVL(SUM(LTYR_ED_PRST_AMT_COT), 0) AS LTYR_ED_PRST_AMT_COT
		    ,NVL(SUM(LTYR_ED_PRST_AMT_PR), 0) AS LTYR_ED_PRST_AMT_PR
		    ,NVL(SUM(THYR_INCR_COT), 0) AS THYR_INCR_COT
		    ,NVL(SUM(THYR_INCR_PR), 0) AS THYR_INCR_PR
		    ,NVL(SUM(THYR_DECR_COT), 0) AS THYR_DECR_COT
		    ,NVL(SUM(THYR_DECR_PR), 0) AS THYR_DECR_PR
		    ,NVL(SUM(THYR_CMPR_VRT_COT), 0) AS THYR_CMPR_VRT_COT
		    ,NVL(SUM(THYR_CMPR_VRT_PR), 0) AS THYR_CMPR_VRT_PR
		    ,NVL(SUM(THYR_ED_PRST_AMT_COT), 0) AS THYR_ED_PRST_AMT_COT
		    ,NVL(SUM(THYR_ED_PRST_AMT_PR), 0) AS THYR_ED_PRST_AMT_PR            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV045L
		 WHERE
		        DITM_DVSN_CD IN ('01','02','03' )   
            AND TAX_DITM_DVSN_CD IN ('11','12','13') 
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 GROUP BY
		    COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM, DITM_DVSN_CD                
		 )   
	</insert> 
	
	<!--유가증권증감계산서 UPDATE-->
	<update id="FAACAV008EUpdate_33" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_33 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV057L
			   SET  
				 LTYR_ED_CRFW_SHCN = NVL(TO_NUMBER(TRIM(#LTYR_ED_CRFW_SHCN#)), 0)
				,LTYR_CRFW_PF_AMT = NVL(TO_NUMBER(TRIM(#LTYR_CRFW_PF_AMT#)), 0)
				,THYR_INCR_SHCN = NVL(TO_NUMBER(TRIM(#THYR_INCR_SHCN#)), 0)
				,THYR_INCR_PF_AMT = NVL(TO_NUMBER(TRIM(#THYR_INCR_PF_AMT#)), 0)
				,THYR_MIS_SHCN = NVL(TO_NUMBER(TRIM(#THYR_MIS_SHCN#)), 0)
				,THYR_MIS_PF_AMT = NVL(TO_NUMBER(TRIM(#THYR_MIS_PF_AMT#)), 0)
				,THYR_ED_CRNT_STK_SHCN = NVL(TO_NUMBER(TRIM(#THYR_ED_CRNT_STK_SHCN#)), 0)
				,THYR_ED_PRST_AMT = NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND DITM_DVSN_CD=#DITM_DVSN_CD#
			  AND TAX_DITM_DVSN_CD=#TAX_DITM_DVSN_CD#
			  AND TAX_TAX_DITM_DVSN_CD=#TAX_TAX_DITM_DVSN_CD#
	</update>
	
	<!--유가증권증감계산서 DELETE-->
	<update id="FAACAV008EDelete_33" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_33 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV057L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND DITM_DVSN_CD=#DITM_DVSN_CD#
			  AND TAX_DITM_DVSN_CD=#TAX_DITM_DVSN_CD#
			  AND TAX_TAX_DITM_DVSN_CD=#TAX_TAX_DITM_DVSN_CD#
	</update>
	
	<!--유가증권증감계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_33" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_33 */ ]]>
		INSERT INTO TWFAACAV057L (
			COPT_CD 
			,ACNT_CD 
			,BLL_CD 
			,PROF_DRTR_SRNO 
			,DL_XPN_RCDB_PBSVT_SRNO 
			,PROF_YM
			,SUM_DVSN_ID
			,DITM_DVSN_CD 
			,TAX_DITM_DVSN_CD 
			,TAX_TAX_DITM_DVSN_CD 
			,LTYR_ED_CRFW_SHCN 
			,LTYR_CRFW_PF_AMT 
			,THYR_INCR_SHCN 
			,THYR_INCR_PF_AMT 
			,THYR_MIS_SHCN 
			,THYR_MIS_PF_AMT 
			,THYR_ED_CRNT_STK_SHCN 
			,THYR_ED_PRST_AMT 
			,FRT_REGI_DH 
			,FRT_USR_ID
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#DITM_DVSN_CD#
			  ,#TAX_DITM_DVSN_CD#
			  ,'00'
			  ,NVL(TO_NUMBER(TRIM(#LTYR_ED_CRFW_SHCN#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#LTYR_CRFW_PF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_INCR_SHCN#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_INCR_PF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_MIS_SHCN#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_MIS_PF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_CRNT_STK_SHCN#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THYR_ED_PRST_AMT#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--유가증권증감계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_33" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_33 */ ]]>
		INSERT INTO TWFAACAV057L (
			COPT_CD 
			,ACNT_CD 
			,BLL_CD 
			,PROF_DRTR_SRNO 
			,DL_XPN_RCDB_PBSVT_SRNO 
			,PROF_YM
			,SUM_DVSN_ID
			,DITM_DVSN_CD 
			,TAX_DITM_DVSN_CD 
			,TAX_TAX_DITM_DVSN_CD 
			,LTYR_ED_CRFW_SHCN 
			,LTYR_CRFW_PF_AMT 
			,THYR_INCR_SHCN 
			,THYR_INCR_PF_AMT 
			,THYR_MIS_SHCN 
			,THYR_MIS_PF_AMT 
			,THYR_ED_CRNT_STK_SHCN 
			,THYR_ED_PRST_AMT 
			,FRT_REGI_DH 
			,FRT_USR_ID
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','0','00'
		    ,NVL(SUM(LTYR_ED_CRFW_SHCN), 0) AS LTYR_ED_CRFW_SHCN
		    ,NVL(SUM(LTYR_CRFW_PF_AMT), 0) AS LTYR_CRFW_PF_AMT
		    ,NVL(SUM(THYR_INCR_SHCN), 0) AS THYR_INCR_SHCN
		    ,NVL(SUM(THYR_INCR_PF_AMT), 0) AS THYR_INCR_PF_AMT
		    ,NVL(SUM(THYR_MIS_SHCN), 0) AS THYR_MIS_SHCN
		    ,NVL(SUM(THYR_MIS_PF_AMT), 0) AS THYR_MIS_PF_AMT
		    ,NVL(SUM(THYR_ED_CRNT_STK_SHCN), 0) AS THYR_ED_CRNT_STK_SHCN
		    ,NVL(SUM(THYR_ED_PRST_AMT), 0) AS THYR_ED_PRST_AMT
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV057L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
            AND TAX_DITM_DVSN_CD != '0'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
         UNION ALL
		 SELECT 
		     COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM,SUM_DVSN_ID
		    ,DITM_DVSN_CD,'0','00'
		    ,NVL(SUM(LTYR_ED_CRFW_SHCN), 0) AS LTYR_ED_CRFW_SHCN
		    ,NVL(SUM(LTYR_CRFW_PF_AMT), 0) AS LTYR_CRFW_PF_AMT
		    ,NVL(SUM(THYR_INCR_SHCN), 0) AS THYR_INCR_SHCN
		    ,NVL(SUM(THYR_INCR_PF_AMT), 0) AS THYR_INCR_PF_AMT
		    ,NVL(SUM(THYR_MIS_SHCN), 0) AS THYR_MIS_SHCN
		    ,NVL(SUM(THYR_MIS_PF_AMT), 0) AS THYR_MIS_PF_AMT
		    ,NVL(SUM(THYR_ED_CRNT_STK_SHCN), 0) AS THYR_ED_CRNT_STK_SHCN
		    ,NVL(SUM(THYR_ED_PRST_AMT), 0) AS THYR_ED_PRST_AMT
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV057L
		 WHERE
		    DITM_DVSN_CD != '0' 
		    AND TAX_DITM_DVSN_CD != '0'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 GROUP BY
		    COPT_CD,ACNT_CD,BLL_CD,PROF_DRTR_SRNO,DL_XPN_RCDB_PBSVT_SRNO,PROF_YM, SUM_DVSN_ID, DITM_DVSN_CD            
		 )   
	</insert>
	
			 	    
   	<!--유가증권수불계산서 UPDATE-->
	<update id="FAACAV008EUpdate_34" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_34 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV058L
			   SET  
				 THMN_INC_SHCN = NVL(TO_NUMBER(TRIM(#THMN_INC_SHCN#)), 0)
				,THMN_INC_PF_AMT = NVL(TO_NUMBER(TRIM(#THMN_INC_PF_AMT#)), 0)
				,INC_AGG_SHCN = NVL(TO_NUMBER(TRIM(#INC_AGG_SHCN#)), 0)
				,INC_AGG_PF_AMT = NVL(TO_NUMBER(TRIM(#INC_AGG_PF_AMT#)), 0)
				,THMN_OUT_SHCN = NVL(TO_NUMBER(TRIM(#THMN_OUT_SHCN#)), 0)
				,THMN_OUT_PF_AMT = NVL(TO_NUMBER(TRIM(#THMN_OUT_PF_AMT#)), 0)
				,OUT_AGG_SHCN = NVL(TO_NUMBER(TRIM(#OUT_AGG_SHCN#)), 0)
				,OUT_PF_ATAG = NVL(TO_NUMBER(TRIM(#OUT_PF_ATAG#)), 0)
				,BL_CLCT_AMT = NVL(TO_NUMBER(TRIM(#BL_CLCT_AMT#)), 0)	
				,BL_PF_AMT = NVL(TO_NUMBER(TRIM(#BL_PF_AMT#)), 0)	                
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SUM_DTL_DVSN_ID_1=#SUM_DTL_DVSN_ID1#
			  AND ACNT_DVSN_CD=#ACNT_DVSN_CD#
			  AND ACCT_CD=#ACCT_CD#
			  AND SUM_DTL_DVSN_ID_2=#SUM_DTL_DVSN_ID2#
	</update>
	
	<!--유가증권수불계산서 DELETE-->
	<update id="FAACAV008EDelete_34" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_34 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV058L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND SUM_DTL_DVSN_ID_1=#SUM_DTL_DVSN_ID1#
			  AND ACNT_DVSN_CD=#ACNT_DVSN_CD#
			  AND ACCT_CD=#ACCT_CD#
			  AND SUM_DTL_DVSN_ID_2=#SUM_DTL_DVSN_ID2#
	</update>
	
	<!--유가증권수불계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_34" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_34 */ ]]>
		INSERT INTO TWFAACAV058L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SUM_DTL_DVSN_ID_1
			,ACNT_DVSN_CD
			,ACCT_CD
			,SUM_DTL_DVSN_ID_2
			,THMN_INC_SHCN
			,THMN_INC_PF_AMT
			,INC_AGG_SHCN
			,INC_AGG_PF_AMT
			,THMN_OUT_SHCN
			,THMN_OUT_PF_AMT
			,OUT_AGG_SHCN
			,OUT_PF_ATAG
			,BL_CLCT_AMT
			,BL_PF_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			   #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#SUM_DTL_DVSN_ID1#
			  ,#ACNT_DVSN_CD#
			  ,NVL(#ACCT_CD#,' ')
			  ,#SUM_DTL_DVSN_ID2#
			  ,NVL(TO_NUMBER(TRIM(#THMN_INC_SHCN#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_INC_PF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#INC_AGG_SHCN#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#INC_AGG_PF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_OUT_SHCN#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_OUT_PF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#OUT_AGG_SHCN#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#OUT_PF_ATAG#)), 0)			  
			  ,NVL(TO_NUMBER(TRIM(#BL_CLCT_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#BL_PF_AMT#)), 0)
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--유가증권수불계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_34" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_34 */ ]]>
		INSERT INTO TWFAACAV058L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,SUM_DTL_DVSN_ID_1
			,ACNT_DVSN_CD
			,ACCT_CD
			,SUM_DTL_DVSN_ID_2
			,THMN_INC_SHCN
			,THMN_INC_PF_AMT
			,INC_AGG_SHCN
			,INC_AGG_PF_AMT
			,THMN_OUT_SHCN
			,THMN_OUT_PF_AMT
			,OUT_AGG_SHCN
			,OUT_PF_ATAG
			,BL_CLCT_AMT
			,BL_PF_AMT
			,FRT_REGI_DH  
			,FRT_USR_ID  
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'0','000',' ','00'
		    ,NVL(SUM(THMN_INC_SHCN), 0) AS THMN_INC_SHCN
		    ,NVL(SUM(THMN_INC_PF_AMT), 0) AS THMN_INC_PF_AMT
		    ,NVL(SUM(INC_AGG_SHCN), 0) AS INC_AGG_SHCN
		    ,NVL(SUM(INC_AGG_PF_AMT), 0) AS INC_AGG_PF_AMT
		    ,NVL(SUM(THMN_OUT_SHCN), 0) AS THMN_OUT_SHCN
		    ,NVL(SUM(THMN_OUT_PF_AMT), 0) AS THMN_OUT_PF_AMT
		    ,NVL(SUM(OUT_AGG_SHCN), 0) AS OUT_AGG_SHCN
		    ,NVL(SUM(OUT_PF_ATAG), 0) AS OUT_PF_ATAG
		    ,NVL(SUM(BL_CLCT_AMT), 0) AS BL_CLCT_AMT
		    ,NVL(SUM(BL_PF_AMT), 0) AS BL_PF_AMT            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV058L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 )   
	</insert>
	
	     
   	<!--국고금출납계산서 UPDATE-->
	<update id="FAACAV008EUpdate_35" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EUpdate_35 */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV063L
			   SET  
				 THYR_INCR_PF_AMT = NVL(TO_NUMBER(TRIM(#THYR_INCR_PF_AMT#)), 0)
				,REV_ATAG = NVL(TO_NUMBER(TRIM(#REV_ATAG#)), 0)
				,THMN_NREV_AMT = NVL(TO_NUMBER(TRIM(#THMN_NREV_AMT#)), 0)
				,NREV_ATAG = NVL(TO_NUMBER(TRIM(#NREV_ATAG#)), 0)
				,THMN_EXP_AMT = NVL(TO_NUMBER(TRIM(#THMN_EXP_AMT#)), 0)
				,EXP_ATAG = NVL(TO_NUMBER(TRIM(#EXP_ATAG#)), 0)
				,THMN_NEXP_AMT = NVL(TO_NUMBER(TRIM(#THMN_NEXP_AMT#)), 0)
				,NEXP_ATAG = NVL(TO_NUMBER(TRIM(#NEXP_ATAG#)), 0)
				,NAFD_BL = NVL(TO_NUMBER(TRIM(#NAFD_BL#)), 0)
				,FNL_MDF_DH = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID	= #FNL_MNU_ID#
			   
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACNT_DVSN_CD=#ACNT_DVSN_CD_1#
	</update>
	<!--국고금출납계산서 DELETE-->
	<update id="FAACAV008EDelete_35" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EDelete_35 */ ]]>
		<![CDATA[ 	
			DELETE FROM TWFAACAV063L
		]]>	    
			  WHERE 1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YM = #PROF_YM#
			  AND SUM_DVSN_ID=#SUM_DVSN_ID#
			  AND ACNT_DVSN_CD=#ACNT_DVSN_CD_1#
	</update>
	
	<!--국고금출납계산서 예산과목 추가-->
	<insert id="FAACAV008EInsert_35" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008EInsert_35 */ ]]>
		INSERT INTO TWFAACAV063L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACNT_DVSN_CD
            ,ACNT_NM
			,THYR_INCR_PF_AMT
			,REV_ATAG
			,THMN_NREV_AMT
			,NREV_ATAG
			,THMN_EXP_AMT
			,EXP_ATAG
			,THMN_NEXP_AMT
			,NEXP_ATAG
			,NAFD_BL
			,FRT_REGI_DH  
			,FRT_USR_ID 
		) VALUES (
			  #COPT_CD#
			  ,#ACNT_CD#
			  ,#BLL_CD#
			  ,#PROF_DRTR_SRNO# 
			  ,#DL_XPN_RCDB_PBSVT_SRNO#
			  ,#PROF_YM#
			  ,#SUM_DVSN_ID#
			  ,#ACNT_DVSN_CD_1#
              ,#ACNT_NM_1#
			  ,NVL(TO_NUMBER(TRIM(#THYR_INCR_PF_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#REV_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_NREV_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#NREV_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_EXP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#EXP_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#THMN_NEXP_AMT#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#NEXP_ATAG#)), 0)
			  ,NVL(TO_NUMBER(TRIM(#NAFD_BL#)), 0)			  
		      ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		      ,#FRT_USR_ID#
		)
	</insert>
	
	<!--국고금출납계산서 합계 추가-->
	<insert id="FAACAV008ESumInsert_35" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/008/FAACAV008ESumInsert_35 */ ]]>
		INSERT INTO TWFAACAV063L (
		     COPT_CD
		    ,ACNT_CD
		    ,BLL_CD
		    ,PROF_DRTR_SRNO
		    ,DL_XPN_RCDB_PBSVT_SRNO
		    ,PROF_YM
		    ,SUM_DVSN_ID
			,ACNT_DVSN_CD
			,THYR_INCR_PF_AMT
			,REV_ATAG
			,THMN_NREV_AMT
			,NREV_ATAG
			,THMN_EXP_AMT
			,EXP_ATAG
			,THMN_NEXP_AMT
			,NEXP_ATAG
			,NAFD_BL
			,FRT_REGI_DH  
			,FRT_USR_ID 
		)
		( 
		 SELECT 
		     #COPT_CD#,#ACNT_CD#,#BLL_CD#,#PROF_DRTR_SRNO#,#DL_XPN_RCDB_PBSVT_SRNO#,#PROF_YM#,'49' AS SUM_DVSN_ID
		    ,'000'
		    ,NVL(SUM(THYR_INCR_PF_AMT), 0) AS THYR_INCR_PF_AMT
		    ,NVL(SUM(REV_ATAG), 0) AS REV_ATAG
		    ,NVL(SUM(THMN_NREV_AMT), 0) AS THMN_NREV_AMT
		    ,NVL(SUM(NREV_ATAG), 0) AS NREV_ATAG
		    ,NVL(SUM(THMN_EXP_AMT), 0) AS THMN_EXP_AMT
		    ,NVL(SUM(EXP_ATAG), 0) AS EXP_ATAG
		    ,NVL(SUM(THMN_NEXP_AMT), 0) AS THMN_NEXP_AMT
		    ,NVL(SUM(NEXP_ATAG), 0) AS NEXP_ATAG
		    ,NVL(SUM(NAFD_BL), 0) AS NAFD_BL            
		    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS DT
		    ,#FRT_USR_ID#
		 FROM
		    TWFAACAV063L
		 WHERE
		    SUM_DVSN_ID != '49' 
		    AND SUM_DVSN_ID != '51'
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD#
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#  
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO# 
		    AND PROF_YM = #PROF_YM#
		 )   
	</insert>

</sqlMap> 
