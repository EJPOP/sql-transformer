<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/aea/004">
	
	<parameterMap id="FAAAEA004DParams" class="java.util.HashMap">
		<parameter property="I_YEAR"		jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN" />
		<parameter property="O_TOTCNT"    	jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT" />
	</parameterMap>
		
	<procedure id="FAAAEA004EProcCreatOrg" parameterMap="FAAAEA004DParams">
		<![CDATA[  /* faa/aea/004/FAAAEA004EProcCreatOrg */ ]]>
		{ CALL PRC_MAKE_TBFAAAEA033D(?,?) }
	</procedure>
	
	
	<select id="FAAAEA004EReportMain1select" parameterClass="paramMap" resultClass="resultMap">
		SELECT  TITLENAME,
		        ORG_TYPE_CD,
		        OFFC_CD,
		        OFFC_NM,
		        ORG_DIV_CD,
		        SUB_SEQ,
		        ORG_CD,
		        ORG_NM_TEL,
		        ORG_DGE_CD,
		        ADDR_ZIP,
		        STAFF_CNT1,
		        POSLOC_NM,
		        AUDIT_CNT,
		        CHRG_NM_TEL,
		        SUB_ORG_TYPE_NM3,
		        SUB_ORG_TYPE_CNT3,
		        SUB_ORG_TYPE_PSON_CNT3,
		        SUB_ORG_TYPE_NM4,
		        SUB_ORG_TYPE_CNT4,
		        SUB_ORG_TYPE_PSON_CNT4
		FROM    (
		        SELECT #strReportName# AS TITLENAME
		               , A.ORG_TYPE_CD
					   , B.COPT_SG_CD||'000000000' AS OFFC_CD
					   , C.ORG_NM AS OFFC_NM
		               , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
		               , F.SEQ AS SUB_SEQ
					   , A.ORG_CD
					   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_NM_TEL
					   , B.ORG_DGE_CD
				       , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
					   , A.STAFF_CNT1
					   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM AS POSLOC_NM
					   , A.AUDIT_CNT
					   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL AS CHRG_NM_TEL
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '3' THEN F.SUB_ORG_TYPE_NM ELSE '' END AS SUB_ORG_TYPE_NM3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '3' THEN SUM(F.SUB_ORG_CNT) ELSE 0 END AS SUB_ORG_TYPE_CNT3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '3' THEN SUM(F.SUB_ORG_PSON_CNT) ELSE 0 END AS SUB_ORG_TYPE_PSON_CNT3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '4' THEN F.SUB_ORG_TYPE_NM ELSE '' END AS SUB_ORG_TYPE_NM4
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '4' THEN SUM(F.SUB_ORG_CNT) ELSE 0 END AS SUB_ORG_TYPE_CNT4
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '4' THEN SUM(F.SUB_ORG_PSON_CNT) ELSE 0 END AS SUB_ORG_TYPE_PSON_CNT4
				  FROM TBFAAAEA033M A 
		                    LEFT OUTER JOIN TBFAAAEA037M F
		                    ON  F.ORG_TYPE_CD = A.ORG_TYPE_CD
		                    AND F.ORG_CD = A.ORG_CD
		                    AND F.ORG_DEGREE_TYPE_CD IN ('3','4'),
		               TBDCMACM015M B, 
		               TBDCMACM015M C,
		               TBFAAAEA033D D,
					   (SELECT CD
					   		   ,CD_NM 
					   	  FROM TBDCMACM013C 
					   	 WHERE CMM_CD_DVSN_CD = '1000058') E
				 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
				   AND B.ORG_CD = A.ORG_CD
				   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
				   AND D.YEAR = #strYear#
				  <isNotEmpty property="strOrgDiv">
				   AND B.PUB_DVSN_CD = #strOrgDiv#
				  </isNotEmpty>
				   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
				   AND D.ORG_CD = A.ORG_CD
				   AND A.RESPON_PSON_POS_CLASS_CD = E.CD (+)
		        GROUP BY A.ORG_TYPE_CD
					   , B.COPT_SG_CD||'000000000'
					   , C.ORG_NM
		               , B.COPT_SG_CD||'000000000'||A.ORG_CD
		               , F.SEQ
					   , A.ORG_CD
					   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB
					   , B.ORG_DGE_CD
				       , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END)
					   , A.STAFF_CNT1
					   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM
					   , A.AUDIT_CNT
					   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL
		               , F.SUB_ORG_TYPE_NM
		               , F.ORG_DEGREE_TYPE_CD
		        )
		ORDER BY OFFC_CD, ORG_CD, ORG_DIV_CD, SUB_SEQ
	</select>
	
	<select id="FAAAEA004EReportMain11select" parameterClass="paramMap" resultClass="resultMap">
		SELECT  TITLENAME,
		        ORG_TYPE_CD,
		        OFFC_CD,
		        OFFC_NM,
		        ORG_DIV_CD,
		        SUB_SEQ,
		        ORG_CD,
		        ORG_NM_TEL,
		        ORG_DGE_CD,
		        ADDR_ZIP,
		        STAFF_CNT1,
		        POSLOC_NM,
		        AUDIT_CNT,
		        CHRG_NM_TEL,
		        SUB_ORG_TYPE_NM3,
		        SUB_ORG_TYPE_CNT3,
		        SUB_ORG_TYPE_PSON_CNT3,
		        SUB_ORG_TYPE_NM4,
		        SUB_ORG_TYPE_CNT4,
		        SUB_ORG_TYPE_PSON_CNT4
		FROM    (
		        SELECT #strReportName# AS TITLENAME
		               , A.ORG_TYPE_CD
					   , B.COPT_SG_CD||'000000000' AS OFFC_CD
					   , C.ORG_NM AS OFFC_NM
		               , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
		               , F.SEQ AS SUB_SEQ
					   , A.ORG_CD
					   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_NM_TEL
					   , B.ORG_DGE_CD
				       , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
					   , A.STAFF_CNT1
					   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM AS POSLOC_NM
					   , A.AUDIT_CNT
					   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL AS CHRG_NM_TEL
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('1','3') THEN F.SUB_ORG_TYPE_NM ELSE '' END AS SUB_ORG_TYPE_NM3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('1','3') THEN SUM(F.SUB_ORG_CNT) ELSE 0 END AS SUB_ORG_TYPE_CNT3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('1','3') THEN SUM(F.SUB_ORG_PSON_CNT) ELSE 0 END AS SUB_ORG_TYPE_PSON_CNT3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('2','4') THEN F.SUB_ORG_TYPE_NM ELSE '' END AS SUB_ORG_TYPE_NM4
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('2','4') THEN SUM(F.SUB_ORG_CNT) ELSE 0 END AS SUB_ORG_TYPE_CNT4
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('2','4') THEN SUM(F.SUB_ORG_PSON_CNT) ELSE 0 END AS SUB_ORG_TYPE_PSON_CNT4
				  FROM TBFAAAEA033M A 
		                    LEFT OUTER JOIN TBFAAAEA037M F
		                    ON  F.ORG_TYPE_CD = A.ORG_TYPE_CD
		                    AND F.ORG_CD = A.ORG_CD,
		               TBDCMACM015M B, 
		               TBDCMACM015M C,
		               TBFAAAEA033D D,
					   (SELECT CD
					   		   ,CD_NM 
					   	  FROM TBDCMACM013C 
					   	 WHERE CMM_CD_DVSN_CD = '1000058') E
				 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
				   AND B.ORG_CD = A.ORG_CD
				   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
				   AND D.YEAR = #strYear#
				  <isNotEmpty property="strOrgDiv">
				   AND B.PUB_DVSN_CD = #strOrgDiv#
				  </isNotEmpty>
				   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
				   AND D.ORG_CD = A.ORG_CD
				   AND A.RESPON_PSON_POS_CLASS_CD = E.CD (+)
		        GROUP BY A.ORG_TYPE_CD
					   , B.COPT_SG_CD||'000000000'
					   , C.ORG_NM
		               , B.COPT_SG_CD||'000000000'||A.ORG_CD
		               , F.SEQ
					   , A.ORG_CD
					   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB
					   , B.ORG_DGE_CD
				       , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END)
					   , A.STAFF_CNT1
					   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM
					   , A.AUDIT_CNT
					   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL
		               , F.SUB_ORG_TYPE_NM
		               , F.ORG_DEGREE_TYPE_CD
		        )
		ORDER BY OFFC_CD, ORG_CD, ORG_DIV_CD, SUB_SEQ
	</select>
	
	<select id="FAAAEA004EReportMain2select" parameterClass="paramMap" resultClass="resultMap">
		SELECT #strReportName# AS TITLENAME
			   , C.ORG_NM AS OFFC_NM
			   , B.COPT_SG_CD||'000000000' AS OFFC_CD
			   , A.ORG_CD
			   , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , A.LAW_BAS1
			   , A.STAFF_CNT1
			   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM AS POSLOC_CD_NM
			   , A.AUDIT_CNT
			   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL AS CHRG_DEPT_TEL
			   , A.CAPITAL_AMT
			   , A.ORG_TYPE_CD
			   , D.YEAR
			   , D.ORG_TYPE_CD
			   , D.INVESTOR_NM
			   , D.INVESTOR_RATE
			   , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_PSON_CNT
			   , D.SUB_ORG_TYPE_CNT
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D,
			   (SELECT CD
			   		   ,CD_NM 
			   	  FROM TBDCMACM013C 
			   	 WHERE CMM_CD_DVSN_CD = '1000058') E
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND A.RESPON_PSON_POS_CLASS_CD = E.CD (+)
		   AND (D.INVESTOR_YN = 'Y' OR D.SUB_ORG_TYPE_YN = 'Y')
		 ORDER BY C.ORG_NM, B.COPT_SG_CD||'000000000'||A.ORG_CD
	</select>
	
	<select id="FAAAEA004EReportMain3select" parameterClass="paramMap" resultClass="resultMap">
		SELECT #strReportName# AS TITLENAME
			   , C.ORG_NM AS OFFC_NM
			   , B.COPT_SG_CD||'000000000' AS OFFC_CD
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , A.CAPITAL_AMT
			   , A.ORG_TYPE_CD
			   , A.BIB_ETC
			   , D.ORG_CD
			   , D.YEAR
			   , D.ORG_TYPE_CD
			   , D.INVESTOR_NM
			   , D.INVESTOR_RATE
			   , D.SUB_ORG_CNT1
			   , D.SUB_ORG_CNT2
			   , D.SUB_ORG_CNT3
			   , D.SUB_ORG_CNT_SUM
			   , D.SUB_ORG_CNT4
			   , D.SUB_ORG_CNT5
			   , D.SUB_ORG_CNT6
			   , D.SUB_ORG_CNT7
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND (D.INVESTOR_YN = 'Y' OR D.SUB_ORG_YN = 'Y')
		 ORDER BY OFFC_CD, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EReportMain4select" parameterClass="paramMap" resultClass="resultMap">
		SELECT #strReportName# AS TITLENAME
			   , C.ORG_NM AS OFFC_NM
			   , B.COPT_SG_CD||'000000000' AS OFFC_CD
		       , A.ORG_TYPE_CD
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_NM_TEL
			   , A.ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , (CASE WHEN A.LAW_BAS1 = '' THEN 
				  		(CASE WHEN A.LAW_BAS2 = '' THEN '' ELSE 'ⓑ'||A.LAW_BAS2 END)
			          ELSE 'ⓐ'||A.LAW_BAS1||CHR(10)||'ⓑ'||A.LAW_BAS2 END) AS LAW_BAS
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
			   , D.ORG_CD
			   , D.YEAR
			   , D.YEAR - 5 AS YEAR_5
               , D.YEAR - 4 AS YEAR_4
               , D.YEAR - 3 AS YEAR_3
               , D.YEAR - 2 AS YEAR_2
               , D.YEAR - 1 AS YEAR_1
			   , D.ORG_TYPE_CD
			   , D.CONTRIBUTE_TYPE_NM
			   , D.SUBSIDY_AMT_5
			   , D.SUBSIDY_AMT_4
			   , D.SUBSIDY_AMT_3
			   , D.SUBSIDY_AMT_2
			   , D.SUBSIDY_AMT_1
			   , D.SUBSIDY_AMT_0
			   , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_PSON_CNT
			   , D.SUB_ORG_TYPE_CNT
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND (D.CONTRIBUTE_TYPE_YN = 'Y' OR D.SUB_ORG_TYPE_YN = 'Y')
		 ORDER BY OFFC_CD, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EReportMain5select" parameterClass="paramMap" resultClass="resultMap">
		SELECT #strReportName# AS TITLENAME
			   , C.ORG_NM AS OFFC_NM
			   , B.COPT_SG_CD||'000000000' AS OFFC_CD
			   , A.ORG_CD
               , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , (CASE WHEN A.LAW_BAS1 = '' THEN 
				  		(CASE WHEN A.LAW_BAS2 = '' THEN '' ELSE 'ⓑ'||A.LAW_BAS2 END)
			          ELSE 'ⓐ'||A.LAW_BAS1||CHR(10)||'ⓑ'||A.LAW_BAS2 END) AS LAW_BAS
               , NVL(D.CONTRIBUTE_TYPE_NM,'ZZZ') AS CONTRIBUTE_TYPE_NM
               , D.SUBSIDY_AMT_5
			   , D.SUBSIDY_AMT_4
			   , D.SUBSIDY_AMT_3
			   , D.SUBSIDY_AMT_2
			   , D.SUBSIDY_AMT_1
			   , D.SUBSIDY_AMT_0
               , D.SUB_ORG_TYPE_NM
               , D.SUB_ORG_TYPE_CNT
			   , D.SUB_ORG_TYPE_PSON_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
			   , D.YEAR
			   , TO_NUMBER(D.YEAR) - 5 AS YEAR_5
               , TO_NUMBER(D.YEAR) - 4 AS YEAR_4
               , TO_NUMBER(D.YEAR) - 3 AS YEAR_3
               , TO_NUMBER(D.YEAR) - 2 AS YEAR_2
               , TO_NUMBER(D.YEAR) - 1 AS YEAR_1
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND (D.CONTRIBUTE_TYPE_YN = 'Y' OR D.SUB_ORG_TYPE_YN = 'Y')
         ORDER BY OFFC_NM, ORG_DIV_CD, D.CONTRIBUTE_TYPE_NM
	</select>
	
	<select id="FAAAEA004EReportMain6select" parameterClass="paramMap" resultClass="resultMap">
		SELECT #strReportName# AS TITLENAME
			   , C.ORG_NM AS OFFC_NM
			   , B.COPT_SG_CD||'000000000' AS OFFC_CD
			   , A.ORG_CD
               , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , A.LAW_BAS1
			   , A.CAPITAL_AMT
               , D.INVESTOR_NM
			   , D.INVESTOR_RATE
			   , D.SUB_ORG_TYPE_NM
               , D.SUB_ORG_TYPE_PSON_CNT
			   , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
               , A.BIB_ETC
			   , D.YEAR
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND (D.INVESTOR_YN = 'Y' OR D.SUB_ORG_TYPE_YN = 'Y')
         ORDER BY OFFC_NM, ORG_DIV_CD
	</select>
	
	<select id="FAAAEA004EReportMain7select" parameterClass="paramMap" resultClass="resultMap">
		SELECT #strReportName# AS TITLENAME
			   , B.ORG_NM AS OFFC_NM
               ,A.OFFC_CD
               ,A.ORG_CD
               ,A.ORG_DIV_CD
               ,A.ORG_TEL
               ,A.ORG_RPSV_NM
               ,A.ADDR_ZIP
               ,A.CAPITAL_AMT
               ,A.UNIT_NM
               ,A.GRT_PER
               ,A.GRT_END_PER
               ,A.GRT_RMK
               ,A.BIB_ETC
          FROM (
                SELECT A.COPT_SG_CD||'000000000' AS OFFC_CD
                       , A.ORG_CD
                       , A.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
			           , A.ORG_NM||CHR(10)||'('||SUBSTRING(A.BZN,1,3) || '-' || SUBSTRING(A.BZN,4,2) || '-' || SUBSTRING(A.BZN,6,5)||')'||CHR(10)||'☎'||A.TNB AS ORG_TEL
			           , B.ORG_RPSV_NM
		               , (CASE WHEN A.ZCD != '' THEN A.AD||CHR(10)||'('||SUBSTRING(A.ZCD,1,3)||'-'||SUBSTRING(A.ZCD,4,3)||')'
			     		  ELSE A.AD
						   END) AS ADDR_ZIP
			           , B.CAPITAL_AMT
                       , B.UNIT_NM
			           , B.GRT_PER
			           , B.GRT_END_PER
			           , B.GRT_RMK
			           , B.BIB_ETC
                  FROM TBDCMACM015M A, TBFAAAEA033M B
                 WHERE B.ORG_TYPE_CD =  #strOrgTypeCd#
                   AND B.ORG_CD = A.ORG_CD
	         	<isNotEmpty property = "strOrgDiv">
		     	   AND A.PUB_DVSN_CD = #strOrgDiv#
		     	</isNotEmpty>
               ) A, TBDCMACM015M B
         WHERE A.OFFC_CD = B.ORG_CD
         ORDER BY OFFC_NM, A.ORG_DIV_CD
	</select>
	
	<select id="FAAAEA004EReportMain8select" parameterClass="paramMap" resultClass="resultMap">
		SELECT #strReportName# AS TITLENAME
			   , C.ORG_NM AS OFFC_NM
			   , B.COPT_SG_CD||'000000000' AS OFFC_CD
			   , A.ORG_CD
               , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , (CASE WHEN A.LAW_BAS1 = '' THEN 
				  		(CASE WHEN A.LAW_BAS2 = '' THEN '' ELSE 'ⓑ'||A.LAW_BAS2 END)
			          ELSE 'ⓐ'||A.LAW_BAS1||CHR(10)||'ⓑ'||A.LAW_BAS2 END) AS LAW_BAS
			   , A.CAPITAL_AMT
               , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_PSON_CNT
			   , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
			   , D.YEAR
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property = "strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND D.SUB_ORG_TYPE_YN = 'Y'
		 ORDER BY OFFC_NM, ORG_DIV_CD
	</select>
	
	<select id="FAAAEA004EReportMain9select" parameterClass="paramMap" resultClass="resultMap">
		SELECT #strReportName# AS TITLENAME
			   , C.ORG_NM AS OFFC_NM
			   , B.COPT_SG_CD||'000000000' AS OFFC_CD
			   , A.ORG_CD
               , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , A.LAW_BAS1
			   , A.LAW_BAS2
			   , A.GRT_PER
			   , A.CAPITAL_AMT
               , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_PSON_CNT
			   , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
			   , D.YEAR
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property = "strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND D.SUB_ORG_TYPE_YN = 'Y'
		 ORDER BY OFFC_NM, ORG_DIV_CD
	</select>
	
	<select id="FAAAEA004EReportMain10select" parameterClass="paramMap" resultClass="resultMap">
		SELECT #strReportName# AS TITLENAME
			   , C.ORG_NM AS OFFC_NM
			   , B.COPT_SG_CD||'000000000' AS OFFC_CD
			   , A.ORG_CD
               , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , E.ORG_NM KAWAN
			   , A.LAW_BAS1
			   , A.LAW_BAS2
			   , A.GRT_RMK
			   , A.GRT_END_PER
			   , A.CAPITAL_AMT
               , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_PSON_CNT
			   , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
			   , D.YEAR
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, TBDCMACM015M E, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		   AND E.ORG_CD(+) = A.GRT_SUB_ORG_CD
		  <isNotEmpty property = "strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND D.SUB_ORG_TYPE_YN = 'Y'
		 ORDER BY OFFC_NM, ORG_DIV_CD
	</select>
	
	<select id="FAAAEA004EReportSub1select" parameterClass="paramMap" resultClass="resultMap">
		SELECT A.OFFC_ORG
			   ,(SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = A.OFFC_ORG) AS ORG_NM
			   ,SUM(SUB_ORG_CNT1) + SUM(SUB_ORG_CNT2) + SUM(SUB_ORG_CNT3) + SUM(SUB_ORG_CNT4) AS SUB_ORG_CNT
			   ,SUM(SUB_ORG_CNT1) AS SUB_ORG_CNT1
			   ,SUM(SUB_ORG_CNT2) AS SUB_ORG_CNT2
			   ,SUM(SUB_ORG_CNT3) AS SUB_ORG_CNT3
			   ,SUM(SUB_ORG_CNT4) AS SUB_ORG_CNT4
			   ,SUM(STAFF_CNT1) + SUM(STAFF_CNT2) + SUM(STAFF_CNT3) + SUM(STAFF_CNT4) AS STAFF_CNT
			   ,SUM(STAFF_CNT1) AS STAFF_CNT1
			   ,SUM(STAFF_CNT2) AS STAFF_CNT2
			   ,SUM(STAFF_CNT3) AS STAFF_CNT3
			   ,SUM(STAFF_CNT4) AS STAFF_CNT4		
		FROM (
			SELECT A.COPT_SG_CD || '000000000' AS OFFC_ORG
				   ,A.ORG_DGE_CD
				   ,CASE WHEN A.ORG_DGE_CD = 1 THEN 1 ELSE 0 END AS SUB_ORG_CNT1
				   ,CASE WHEN A.ORG_DGE_CD = 2 THEN 1 ELSE 0 END AS SUB_ORG_CNT2
				   ,B.SUB_ORG_TYPE_CNT3 AS SUB_ORG_CNT3
				   ,B.SUB_ORG_TYPE_CNT4 AS SUB_ORG_CNT4
				   ,CASE WHEN A.ORG_DGE_CD = 1 THEN STAFF_CNT1 ELSE 0 END AS STAFF_CNT1
				   ,CASE WHEN A.ORG_DGE_CD = 2 THEN STAFF_CNT1 ELSE 0 END AS STAFF_CNT2
				   ,B.SUB_ORG_TYPE_PSON_CNT3 AS STAFF_CNT3
				   ,B.SUB_ORG_TYPE_PSON_CNT4 AS STAFF_CNT4
			  FROM TBDCMACM015M A, 
				   (SELECT ORG_TYPE_CD
						   ,ORG_CD
						   ,YEAR		
						   ,NVL(STAFF_CNT1, 0) AS STAFF_CNT1
						   ,SUM(NVL(SUB_ORG_TYPE_CNT3, 0)) AS SUB_ORG_TYPE_CNT3
						   ,SUM(NVL(SUB_ORG_TYPE_PSON_CNT3, 0)) AS SUB_ORG_TYPE_PSON_CNT3
						   ,SUM(NVL(SUB_ORG_TYPE_CNT4, 0)) AS SUB_ORG_TYPE_CNT4
						   ,SUM(NVL(SUB_ORG_TYPE_PSON_CNT4, 0)) AS SUB_ORG_TYPE_PSON_CNT4
					  FROM TBFAAAEA033D
					 WHERE 1=1
					   AND ORG_TYPE_CD = #strOrgTypeCd#
					   AND YEAR = #strYear#
				  GROUP BY ORG_TYPE_CD, ORG_CD, YEAR, STAFF_CNT1				
				   ) B	
			 WHERE 1=1
			   AND A.ORG_CD = B.ORG_CD	
			   AND A.ORG_DGE_CD BETWEEN 1 AND 4
			  <isNotEmpty property = "strOrgDiv">
		       AND A.PUB_DVSN_CD = #strOrgDiv#
		      </isNotEmpty>
			) A
	GROUP BY OFFC_ORG
	ORDER BY OFFC_ORG
	</select>
	
	<select id="FAAAEA004EReportSub2select" parameterClass="paramMap" resultClass="resultMap">
		SELECT A.OFFC_ORG
			   ,B.ORG_NM AS OFFC_NM
			   ,A.ORG_CD
			   ,A.ORG_NM
			   ,NVL(A.SUB_ORG_CNT1,0) + NVL(A.SUB_ORG_CNT2,0) AS SUB_ORG_CNT
			   ,NVL(A.SUB_ORG_CNT1,0) AS SUB_ORG_CNT1
			   ,NVL(A.SUB_ORG_CNT2,0) AS SUB_ORG_CNT2
			   ,NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS STAFF_CNT
			   ,NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   ,NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
		  FROM (
			  SELECT C.COPT_SG_CD||'000000000' AS OFFC_ORG
					 ,A.ORG_CD
					 ,C.ORG_NM
					 ,1 AS SUB_ORG_CNT1
					 ,SUM(A.SUB_ORG_TYPE_CNT) AS SUB_ORG_CNT2
					 ,A.STAFF_CNT1
					 ,SUM(A.SUB_ORG_TYPE_PSON_CNT) AS STAFF_CNT2
				FROM TBFAAAEA033D A, TBDCMACM015M C
			   WHERE 1=1
				 AND A.ORG_TYPE_CD IN ('41','30')
				 AND A.YEAR = #strYear#
				 AND A.ORG_CD = C.ORG_CD
		        <isNotEmpty property = "strOrgDiv">
		         AND C.PUB_DVSN_CD = #strOrgDiv#
		        </isNotEmpty>
			GROUP BY A.ORG_CD, A.STAFF_CNT1, C.COPT_SG_CD, C.ORG_NM
			   ) A, TBDCMACM015M B
		 WHERE 1=1
		   AND A.OFFC_ORG = B.ORG_CD
	  ORDER BY OFFC_ORG, ORG_CD
	</select>
	
	<select id="FAAAEA004EReportSub3select" parameterClass="paramMap" resultClass="resultMap">
		SELECT  B.ORG_DIV_CD AS OFFC_ORG,
		        B.ORG_NM AS OFFC_NM,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '61' THEN 1 ELSE 0 END) SUB_ORG_CNT_011,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '61' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_012,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '52' THEN 1 ELSE 0 END) SUB_ORG_CNT_021,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '52' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_022,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '62' THEN 1 ELSE 0 END) SUB_ORG_CNT_031,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '62' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_032,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '53' THEN 1 ELSE 0 END) SUB_ORG_CNT_041,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '53' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_042,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '54' THEN 1 ELSE 0 END) SUB_ORG_CNT_051,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '54' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_052,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '55' THEN 1 ELSE 0 END) SUB_ORG_CNT_061,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '55' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_062,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '56' THEN 1 ELSE 0 END) SUB_ORG_CNT_071,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '56' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_072,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '57' THEN 1 ELSE 0 END) SUB_ORG_CNT_081,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '57' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_082,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '58' THEN 1 ELSE 0 END) SUB_ORG_CNT_091,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '58' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_092,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '63' THEN 1 ELSE 0 END) SUB_ORG_CNT_101,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '63' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_102,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '64' THEN 1 ELSE 0 END) SUB_ORG_CNT_111,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '64' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_112,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '71' THEN 1 ELSE 0 END) SUB_ORG_CNT_121,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '71' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_122,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '61' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_011,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '61' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_012,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '52' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_021,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '52' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_022,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '62' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_031,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '62' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_032,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '53' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_041,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '53' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_042,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '54' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_051,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '54' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_052,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '55' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_061,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '55' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_062,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '56' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_071,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '56' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_072,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '57' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_081,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '57' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_082,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '58' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_091,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '58' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_092,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '63' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_101,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '63' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_102,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '64' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_111,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '64' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_112,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '71' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_121,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '71' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_122
		FROM    (
		        SELECT  C.ORG_TYPE_CD,
		                C.ORG_CD,
		                C.ORG_DIV_CD,
		                C.ORG_NM,
		                C.YEAR,
		                NVL(C.SUB_ORG_CNT1,0) AS SUB_ORG_CNT1,
		                NVL(C.SUB_ORG_CNT2,0) AS SUB_ORG_CNT2,
		                NVL(D.STAFF_CNT1,0) AS STAFF_CNT1,
		                NVL(D.STAFF_CNT2,0) AS STAFF_CNT2
		        FROM    TBFAAAEA033M D,
		                (
		                SELECT  A.ORG_TYPE_CD,
		                        A.ORG_CD,
		                        B.COPT_SG_CD||'000000000' AS ORG_DIV_CD,
		                        C.ORG_NM,
		                        A.YEAR,
		                        SUM(BELONG_ORG_CNT1) AS SUB_ORG_CNT1,
		                        SUM(NVL(SUB_ORG_CNT1, 0)) + SUM(NVL(SUB_ORG_CNT2, 0)) + SUM(NVL(SUB_ORG_CNT3, 0)) + SUM(NVL(SUB_ORG_CNT4, 0)) + SUM(NVL(SUB_ORG_CNT5, 0)) + SUM(NVL(SUB_ORG_CNT6, 0)) + SUM(NVL(SUB_ORG_CNT7, 0)) + SUM(NVL(SUB_ORG_TYPE_CNT, 0)) + SUM(NVL(SUB_ORG_TYPE_CNT3, 0)) + SUM(NVL(SUB_ORG_TYPE_CNT4, 0)) AS SUB_ORG_CNT2
		                FROM    TBFAAAEA033D A,
		                        TBDCMACM015M B,
		                        TBDCMACM015M C
		                WHERE   A.ORG_TYPE_CD IN ('61','52','62','53','54','55','56','57','58','63','64','71')
		                AND     A.YEAR = #strYear#
		                AND     A.ORG_CD = B.ORG_CD
		                AND     B.COPT_SG_CD||'000000000' = C.ORG_CD
		                <isNotEmpty property = "strOrgDiv">
		                    AND B.PUB_DVSN_CD = #strOrgDiv#
		                </isNotEmpty>
		                GROUP BY A.ORG_TYPE_CD,
		                        A.ORG_CD,
		                        B.COPT_SG_CD||'000000000',
		                        C.ORG_NM,
		                        A.YEAR
		                ) C
		        WHERE   C.ORG_TYPE_CD = D.ORG_TYPE_CD
		        AND     C.ORG_CD = D.ORG_CD
		) B
		GROUP BY B.ORG_DIV_CD, B.ORG_NM
		ORDER BY 1
	</select>
	
	<select id="FAAAEA004EReportSub4select" parameterClass="paramMap" resultClass="resultMap">
		SELECT  OFFC_ORG,
		        OFFC_NM,
		        SUM(ORG_CNT1 + SUB_ORG_TYPE_CNT1) AS SUB_ORG_CNT,
		        SUM(ORG_CNT1) AS SUB_ORG_CNT1,
		        SUM(SUB_ORG_TYPE_CNT1) AS SUB_ORG_CNT2,
		        SUM(STAFF_CNT1 + SUB_ORG_TYPE_PSON_CNT1) AS STAFF_CNT,
		        SUM(STAFF_CNT1) AS STAFF_CNT1,
		        SUM(SUB_ORG_TYPE_PSON_CNT1) AS STAFF_CNT2
		FROM    (
		        SELECT  OFFC_ORG,
		                F_ORG_INFO(OFFC_ORG, '1') AS OFFC_NM,
		                COUNT(ORG_CD) AS ORG_CNT1,
		                SUM(STAFF_CNT1) AS STAFF_CNT1,
		                SUM(SUB_ORG_TYPE_CNT1) AS SUB_ORG_TYPE_CNT1,
		                SUM(SUB_ORG_TYPE_PSON_CNT1) AS SUB_ORG_TYPE_PSON_CNT1
		        FROM    (
		                SELECT  B.COPT_SG_CD||'000000000' AS OFFC_ORG,
		                        A.ORG_TYPE_CD,
		                        A.ORG_CD,
		                        A.YEAR,
		                        B.COPT_SG_CD,
		                        NVL(A.STAFF_CNT1, 0) AS STAFF_CNT1,
		                        SUM(NVL(A.SUB_ORG_TYPE_CNT, 0)) AS SUB_ORG_TYPE_CNT1,
		                        SUM(NVL(A.SUB_ORG_TYPE_PSON_CNT, 0)) AS SUB_ORG_TYPE_PSON_CNT1
		                FROM    TBFAAAEA033D A,
		                        TBDCMACM015M B
		                WHERE   A.ORG_CD = B.ORG_CD
		                AND     A.ORG_TYPE_CD = #strOrgTypeCd#
						AND     A.YEAR = #strYear#
		                AND     B.ORG_DGE_CD BETWEEN 1 AND 4
		                <isNotEmpty property = "strOrgDiv">
		                    AND     B.PUB_DVSN_CD = #strOrgDiv#
		                </isNotEmpty>
		                GROUP BY B.COPT_SG_CD||'000000000', A.ORG_TYPE_CD, A.ORG_CD, B.COPT_SG_CD, A.YEAR, A.STAFF_CNT1
		                )
		        GROUP BY OFFC_ORG, F_ORG_INFO(OFFC_ORG, '1')
		        )
		GROUP BY OFFC_ORG, OFFC_NM
		ORDER BY 1
	</select>

	<select id="FAAAEA004EReportSub5select" parameterClass="paramMap" resultClass="resultMap">
		SELECT A.OFFC_ORG
			   ,B.ORG_NM AS OFFC_NM
			   ,A.ORG_CD
			   ,A.ORG_NM
			   ,NVL(A.SUB_ORG_CNT1,0) + NVL(A.SUB_ORG_CNT2,0) AS SUB_ORG_CNT
			   ,NVL(A.SUB_ORG_CNT1,0) AS SUB_ORG_CNT1
			   ,NVL(A.SUB_ORG_CNT2,0) AS SUB_ORG_CNT2
			   ,NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS STAFF_CNT
			   ,NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   ,NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
		  FROM (
			  SELECT C.COPT_SG_CD||'000000000' AS OFFC_ORG
					 ,A.ORG_CD
					 ,C.ORG_NM
					 ,1 AS SUB_ORG_CNT1
					 ,SUM(A.SUB_ORG_TYPE_CNT) AS SUB_ORG_CNT2
					 ,A.STAFF_CNT1
					 ,SUM(A.SUB_ORG_TYPE_PSON_CNT) AS STAFF_CNT2
				FROM TBFAAAEA033D A, TBDCMACM015M C
			   WHERE 1=1
				 AND A.ORG_TYPE_CD = #strOrgTypeCd#
				 AND A.YEAR = #strYear#
				 AND A.ORG_CD = C.ORG_CD
		        <isNotEmpty property = "strOrgDiv">
		         AND C.PUB_DVSN_CD = #strOrgDiv#
		        </isNotEmpty>
			GROUP BY A.ORG_CD, A.STAFF_CNT1, C.COPT_SG_CD, C.ORG_NM
			   ) A, TBDCMACM015M B
		 WHERE 1=1
		   AND A.OFFC_ORG = B.ORG_CD
	  ORDER BY OFFC_ORG, ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelMain1select" parameterClass="paramMap" resultClass="resultMap">
		SELECT  OFFC_NM
				,ORG_CD
				,ORG_NM_TEL
				,ORG_DGE_CD
				,ADDR_ZIP
				,STAFF_CNT1
				,POSLOC_NM
				,AUDIT_CNT
				,CHRG_NM_TEL
				,SUB_ORG_TYPE_NM3
				,SUB_ORG_TYPE_CNT3
				,SUB_ORG_TYPE_PSON_CNT3
				,SUB_ORG_TYPE_NM4
				,SUB_ORG_TYPE_CNT4
				,SUB_ORG_TYPE_PSON_CNT4
		FROM    (
		        SELECT #strReportName# AS TITLENAME
		               , A.ORG_TYPE_CD
					   , B.COPT_SG_CD||'000000000' AS OFFC_CD
					   , C.ORG_NM AS OFFC_NM
		               , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
		               , F.SEQ AS SUB_SEQ
					   , A.ORG_CD
					   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_NM_TEL
					   , B.ORG_DGE_CD
				       , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
					   , A.STAFF_CNT1
					   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM AS POSLOC_NM
					   , A.AUDIT_CNT
					   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL AS CHRG_NM_TEL
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '3' THEN F.SUB_ORG_TYPE_NM ELSE '' END AS SUB_ORG_TYPE_NM3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '3' THEN SUM(F.SUB_ORG_CNT) ELSE 0 END AS SUB_ORG_TYPE_CNT3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '3' THEN SUM(F.SUB_ORG_PSON_CNT) ELSE 0 END AS SUB_ORG_TYPE_PSON_CNT3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '4' THEN F.SUB_ORG_TYPE_NM ELSE '' END AS SUB_ORG_TYPE_NM4
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '4' THEN SUM(F.SUB_ORG_CNT) ELSE 0 END AS SUB_ORG_TYPE_CNT4
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD = '4' THEN SUM(F.SUB_ORG_PSON_CNT) ELSE 0 END AS SUB_ORG_TYPE_PSON_CNT4
				  FROM TBFAAAEA033M A 
		                    LEFT OUTER JOIN TBFAAAEA037M F
		                    ON  F.ORG_TYPE_CD = A.ORG_TYPE_CD
		                    AND F.ORG_CD = A.ORG_CD
		                    AND F.ORG_DEGREE_TYPE_CD IN ('3','4'),
		               TBDCMACM015M B, 
		               TBDCMACM015M C,
		               TBFAAAEA033D D,
					   (SELECT CD
					   		   ,CD_NM 
					   	  FROM TBDCMACM013C 
					   	 WHERE CMM_CD_DVSN_CD = '1000058') E
				 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
				   AND B.ORG_CD = A.ORG_CD
				   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
				   AND D.YEAR = #strYear#
				  <isNotEmpty property="strOrgDiv">
				   AND B.PUB_DVSN_CD = #strOrgDiv#
				  </isNotEmpty>
				   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
				   AND D.ORG_CD = A.ORG_CD
				   AND A.RESPON_PSON_POS_CLASS_CD = E.CD (+)
		        GROUP BY A.ORG_TYPE_CD
					   , B.COPT_SG_CD||'000000000'
					   , C.ORG_NM
		               , B.COPT_SG_CD||'000000000'||A.ORG_CD
		               , F.SEQ
					   , A.ORG_CD
					   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB
					   , B.ORG_DGE_CD
				       , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END)
					   , A.STAFF_CNT1
					   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM
					   , A.AUDIT_CNT
					   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL
		               , F.SUB_ORG_TYPE_NM
		               , F.ORG_DEGREE_TYPE_CD
		        )
		ORDER BY OFFC_CD, ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelMain11select" parameterClass="paramMap" resultClass="resultMap">
		SELECT  OFFC_NM
				,ORG_CD
				,ORG_NM_TEL
				,ORG_DGE_CD
				,ADDR_ZIP
				,STAFF_CNT1
				,POSLOC_NM
				,AUDIT_CNT
				,CHRG_NM_TEL
				,SUB_ORG_TYPE_NM3
				,SUB_ORG_TYPE_CNT3
				,SUB_ORG_TYPE_PSON_CNT3
				,SUB_ORG_TYPE_NM4
				,SUB_ORG_TYPE_CNT4
				,SUB_ORG_TYPE_PSON_CNT4
		FROM    (
		        SELECT #strReportName# AS TITLENAME
		               , A.ORG_TYPE_CD
					   , B.COPT_SG_CD||'000000000' AS OFFC_CD
					   , C.ORG_NM AS OFFC_NM
		               , B.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
		               , F.SEQ AS SUB_SEQ
					   , A.ORG_CD
					   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_NM_TEL
					   , B.ORG_DGE_CD
				       , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
					   , A.STAFF_CNT1
					   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM AS POSLOC_NM
					   , A.AUDIT_CNT
					   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL AS CHRG_NM_TEL
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('1','3') THEN F.SUB_ORG_TYPE_NM ELSE '' END AS SUB_ORG_TYPE_NM3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('1','3') THEN SUM(F.SUB_ORG_CNT) ELSE 0 END AS SUB_ORG_TYPE_CNT3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('1','3') THEN SUM(F.SUB_ORG_PSON_CNT) ELSE 0 END AS SUB_ORG_TYPE_PSON_CNT3
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('2','4') THEN F.SUB_ORG_TYPE_NM ELSE '' END AS SUB_ORG_TYPE_NM4
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('2','4') THEN SUM(F.SUB_ORG_CNT) ELSE 0 END AS SUB_ORG_TYPE_CNT4
		               , CASE WHEN F.ORG_DEGREE_TYPE_CD IN ('2','4') THEN SUM(F.SUB_ORG_PSON_CNT) ELSE 0 END AS SUB_ORG_TYPE_PSON_CNT4
				  FROM TBFAAAEA033M A 
		                    LEFT OUTER JOIN TBFAAAEA037M F
		                    ON  F.ORG_TYPE_CD = A.ORG_TYPE_CD
		                    AND F.ORG_CD = A.ORG_CD,
		               TBDCMACM015M B, 
		               TBDCMACM015M C,
		               TBFAAAEA033D D,
					   (SELECT CD
					   		   ,CD_NM 
					   	  FROM TBDCMACM013C 
					   	 WHERE CMM_CD_DVSN_CD = '1000058') E
				 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
				   AND B.ORG_CD = A.ORG_CD
				   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
				   AND D.YEAR = #strYear#
				  <isNotEmpty property="strOrgDiv">
				   AND B.PUB_DVSN_CD = #strOrgDiv#
				  </isNotEmpty>
				   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
				   AND D.ORG_CD = A.ORG_CD
				   AND A.RESPON_PSON_POS_CLASS_CD = E.CD (+)
		        GROUP BY A.ORG_TYPE_CD
					   , B.COPT_SG_CD||'000000000'
					   , C.ORG_NM
		               , B.COPT_SG_CD||'000000000'||A.ORG_CD
		               , F.SEQ
					   , A.ORG_CD
					   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB
					   , B.ORG_DGE_CD
				       , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END)
					   , A.STAFF_CNT1
					   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM
					   , A.AUDIT_CNT
					   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL
		               , F.SUB_ORG_TYPE_NM
		               , F.ORG_DEGREE_TYPE_CD
		        )
		ORDER BY OFFC_CD, ORG_CD, ORG_DIV_CD, SUB_SEQ
	</select>
	
	<select id="FAAAEA004EExcelMain2select" parameterClass="paramMap" resultClass="resultMap">
		SELECT C.ORG_NM AS OFFC_NM
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , A.LAW_BAS1
			   , A.STAFF_CNT1
			   , A.RESPON_PSON_POSLOC_NM||' '||E.CD_NM AS POSLOC_CD_NM
			   , A.AUDIT_CNT
			   , A.CHRG_DEPT_NM||CHR(10)||'☎'||A.TEL AS CHRG_DEPT_TEL
			   , A.CAPITAL_AMT
			   , D.INVESTOR_NM
			   , D.INVESTOR_RATE
			   , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_CNT
			   , D.SUB_ORG_TYPE_PSON_CNT
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D,
			   (SELECT CD
			   		   ,CD_NM 
			   	  FROM TBDCMACM013C 
			   	 WHERE CMM_CD_DVSN_CD = '1000058') E
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND A.RESPON_PSON_POS_CLASS_CD = E.CD (+)
		   AND (D.INVESTOR_YN = 'Y' OR D.SUB_ORG_TYPE_YN = 'Y')
		 ORDER BY C.ORG_NM, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelMain3select" parameterClass="paramMap" resultClass="resultMap">
		SELECT C.ORG_NM AS OFFC_NM
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , A.CAPITAL_AMT
			   , D.INVESTOR_NM
			   , D.INVESTOR_RATE
			   , D.SUB_ORG_CNT1
			   , D.SUB_ORG_CNT2
			   , D.SUB_ORG_CNT3
			   , D.SUB_ORG_CNT_SUM
			   , D.SUB_ORG_CNT4
			   , D.SUB_ORG_CNT5
			   , D.SUB_ORG_CNT6
			   , D.SUB_ORG_CNT7
			   , A.BIB_ETC
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND (D.INVESTOR_YN = 'Y' OR D.SUB_ORG_YN = 'Y')
		 ORDER BY OFFC_NM, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelMain4select" parameterClass="paramMap" resultClass="resultMap">
		SELECT C.ORG_NM AS OFFC_NM
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_NM_TEL
			   , A.ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , (CASE WHEN A.LAW_BAS1 = '' THEN 
				  		(CASE WHEN A.LAW_BAS2 = '' THEN '' ELSE 'ⓑ'||A.LAW_BAS2 END)
			          ELSE 'ⓐ'||A.LAW_BAS1||CHR(10)||'ⓑ'||A.LAW_BAS2 END) AS LAW_BAS
			   , D.CONTRIBUTE_TYPE_NM
			   , D.SUBSIDY_AMT_5
			   , D.SUBSIDY_AMT_4
			   , D.SUBSIDY_AMT_3
			   , D.SUBSIDY_AMT_2
			   , D.SUBSIDY_AMT_1
			   , D.SUBSIDY_AMT_0
			   , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND (C.ORG_CD = B.COPT_SG_CD||'000000000')
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND (D.CONTRIBUTE_TYPE_YN = 'Y' OR D.SUB_ORG_TYPE_YN = 'Y')
		 ORDER BY OFFC_NM, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelMain5select" parameterClass="paramMap" resultClass="resultMap">
		SELECT C.ORG_NM AS OFFC_NM
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , (CASE WHEN A.LAW_BAS1 = '' THEN 
				  		(CASE WHEN A.LAW_BAS2 = '' THEN '' ELSE 'ⓑ'||A.LAW_BAS2 END)
			          ELSE 'ⓐ'||A.LAW_BAS1||CHR(10)||'ⓑ'||A.LAW_BAS2 END) AS LAW_BAS
               , NVL(D.CONTRIBUTE_TYPE_NM,'') AS CONTRIBUTE_TYPE_NM
               , D.SUBSIDY_AMT_5
			   , D.SUBSIDY_AMT_4
			   , D.SUBSIDY_AMT_3
			   , D.SUBSIDY_AMT_2
			   , D.SUBSIDY_AMT_1
			   , D.SUBSIDY_AMT_0
               , D.SUB_ORG_TYPE_NM
               , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND (D.CONTRIBUTE_TYPE_YN = 'Y' OR D.SUB_ORG_TYPE_YN = 'Y')
         ORDER BY OFFC_NM, A.ORG_CD, D.CONTRIBUTE_TYPE_NM
	</select>
	
	<select id="FAAAEA004EExcelMain6select" parameterClass="paramMap" resultClass="resultMap">
		SELECT C.ORG_NM AS OFFC_NM
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , A.LAW_BAS1
			   , A.CAPITAL_AMT
               , D.INVESTOR_NM
			   , D.INVESTOR_RATE
			   , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
               , A.BIB_ETC
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property="strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND (D.INVESTOR_YN = 'Y' OR D.SUB_ORG_TYPE_YN = 'Y')
         ORDER BY OFFC_NM, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelMain7select" parameterClass="paramMap" resultClass="resultMap">
		SELECT B.ORG_NM AS OFFC_NM
               ,A.ORG_CD
               ,A.ORG_TEL
               ,A.ORG_RPSV_NM
               ,A.ADDR_ZIP
               ,A.CAPITAL_AMT
               ,A.UNIT_NM
               ,A.GRT_PER
               ,A.GRT_END_PER
               ,A.GRT_RMK
               ,A.BIB_ETC
          FROM (
                SELECT A.COPT_SG_CD||'000000000' AS OFFC_CD
                       , A.ORG_CD
                       , A.COPT_SG_CD||'000000000'||A.ORG_CD AS ORG_DIV_CD
			           , A.ORG_NM||CHR(10)||'('||SUBSTRING(A.BZN,1,3) || '-' || SUBSTRING(A.BZN,4,2) || '-' || SUBSTRING(A.BZN,6,5)||')'||CHR(10)||'☎'||A.TNB AS ORG_TEL
			           , B.ORG_RPSV_NM
		               , (CASE WHEN A.ZCD != '' THEN A.AD||CHR(10)||'('||SUBSTRING(A.ZCD,1,3)||'-'||SUBSTRING(A.ZCD,4,3)||')'
			     		  ELSE A.AD
						   END) AS ADDR_ZIP
			           , B.CAPITAL_AMT
                       , B.UNIT_NM
			           , B.GRT_PER
			           , B.GRT_END_PER
			           , B.GRT_RMK
			           , B.BIB_ETC
                  FROM TBDCMACM015M A, TBFAAAEA033M B
                 WHERE B.ORG_TYPE_CD =  #strOrgTypeCd#
                   AND B.ORG_CD = A.ORG_CD
	         	<isNotEmpty property = "strOrgDiv">
		     	   AND A.PUB_DVSN_CD = #strOrgDiv#
		     	</isNotEmpty>
               ) A, TBDCMACM015M B
         WHERE A.OFFC_CD = B.ORG_CD
         ORDER BY OFFC_NM, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelMain8select" parameterClass="paramMap" resultClass="resultMap">
		SELECT C.ORG_NM AS OFFC_NM
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , (CASE WHEN A.LAW_BAS1 = '' THEN 
				  		(CASE WHEN A.LAW_BAS2 = '' THEN '' ELSE 'ⓑ'||A.LAW_BAS2 END)
			          ELSE 'ⓐ'||A.LAW_BAS1||CHR(10)||'ⓑ'||A.LAW_BAS2 END) AS LAW_BAS
			   , A.CAPITAL_AMT
               , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property = "strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND D.SUB_ORG_TYPE_YN = 'Y'
		 ORDER BY OFFC_NM, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelMain9select" parameterClass="paramMap" resultClass="resultMap">
		SELECT C.ORG_NM AS OFFC_NM
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , A.LAW_BAS1
			   , A.LAW_BAS2
			   , A.GRT_PER
			   , A.CAPITAL_AMT
               , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		  <isNotEmpty property = "strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND D.SUB_ORG_TYPE_YN = 'Y'
		 ORDER BY OFFC_NM, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelMain10select" parameterClass="paramMap" resultClass="resultMap">
		SELECT C.ORG_NM AS OFFC_NM
			   , A.ORG_CD
			   , B.ORG_NM||CHR(10)||'('||SUBSTRING(B.BZN,1,3) || '-' || SUBSTRING(B.BZN,4,2) || '-' || SUBSTRING(B.BZN,6,5)||')'||CHR(10)||'☎'||B.TNB AS ORG_TEL
			   , (CASE WHEN A.ESTABLISH_DATE != '' THEN SUBSTRING(A.ESTABLISH_DATE,1,4)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,5,2)||'/'
									||SUBSTRING(A.ESTABLISH_DATE,7,2)
									||CHR(10)||A.ORG_RPSV_NM
				      	ELSE A.ORG_RPSV_NM END) AS ORG_RPSV_NM
			   , (CASE WHEN B.ZCD != '' THEN B.AD||CHR(10)||'('||SUBSTRING(B.ZCD,1,3)||'-'||SUBSTRING(B.ZCD,4,3)||')' ELSE B.AD END) AS ADDR_ZIP
			   , E.ORG_NM KAWAN
			   , A.LAW_BAS1
			   , A.LAW_BAS2
			   , A.GRT_RMK
			   , A.GRT_END_PER
			   , A.CAPITAL_AMT
               , D.SUB_ORG_TYPE_NM
			   , D.SUB_ORG_TYPE_CNT
			   , NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   , NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
			   , NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS TOT_STAFF_CNT
			   , A.BIB_ETC
		  FROM TBFAAAEA033M A, TBDCMACM015M B, TBDCMACM015M C, TBDCMACM015M E, 
			   TBFAAAEA033D D
		 WHERE A.ORG_TYPE_CD = #strOrgTypeCd#
		   AND B.ORG_CD = A.ORG_CD
		   AND C.ORG_CD = B.COPT_SG_CD||'000000000'
		   AND D.YEAR = #strYear#
		   AND D.ORG_TYPE_CD = A.ORG_TYPE_CD
		   AND D.ORG_CD = A.ORG_CD
		   AND E.ORG_CD(+) = A.GRT_SUB_ORG_CD
		  <isNotEmpty property = "strOrgDiv">
		   AND B.PUB_DVSN_CD = #strOrgDiv#
		  </isNotEmpty>
		   AND D.SUB_ORG_TYPE_YN = 'Y'
		 ORDER BY OFFC_NM, A.ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelSub1select" parameterClass="paramMap" resultClass="resultMap">
		SELECT A.OFFC_ORG
			   ,(SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = A.OFFC_ORG) AS ORG_NM
			   ,SUM(SUB_ORG_CNT1) + SUM(SUB_ORG_CNT2) + SUM(SUB_ORG_CNT3) + SUM(SUB_ORG_CNT4) AS SUB_ORG_CNT
			   ,SUM(SUB_ORG_CNT1) AS SUB_ORG_CNT1
			   ,SUM(SUB_ORG_CNT2) AS SUB_ORG_CNT2
			   ,SUM(SUB_ORG_CNT3) AS SUB_ORG_CNT3
			   ,SUM(SUB_ORG_CNT4) AS SUB_ORG_CNT4
			   ,SUM(STAFF_CNT1) + SUM(STAFF_CNT2) + SUM(STAFF_CNT3) + SUM(STAFF_CNT4) AS STAFF_CNT
			   ,SUM(STAFF_CNT1) AS STAFF_CNT1
			   ,SUM(STAFF_CNT2) AS STAFF_CNT2
			   ,SUM(STAFF_CNT3) AS STAFF_CNT3
			   ,SUM(STAFF_CNT4) AS STAFF_CNT4		
		FROM (
			SELECT A.COPT_SG_CD || '000000000' AS OFFC_ORG
				   ,A.ORG_DGE_CD
				   ,CASE WHEN A.ORG_DGE_CD = 1 THEN 1 ELSE 0 END AS SUB_ORG_CNT1
				   ,CASE WHEN A.ORG_DGE_CD = 2 THEN 1 ELSE 0 END AS SUB_ORG_CNT2
				   ,B.SUB_ORG_TYPE_CNT3 AS SUB_ORG_CNT3
				   ,B.SUB_ORG_TYPE_CNT4 AS SUB_ORG_CNT4
				   ,CASE WHEN A.ORG_DGE_CD = 1 THEN STAFF_CNT1 ELSE 0 END AS STAFF_CNT1
				   ,CASE WHEN A.ORG_DGE_CD = 2 THEN STAFF_CNT1 ELSE 0 END AS STAFF_CNT2
				   ,B.SUB_ORG_TYPE_PSON_CNT3 AS STAFF_CNT3
				   ,B.SUB_ORG_TYPE_PSON_CNT4 AS STAFF_CNT4
			  FROM TBDCMACM015M A, 
				   (SELECT ORG_TYPE_CD
						   ,ORG_CD
						   ,YEAR		
						   ,NVL(STAFF_CNT1, 0) AS STAFF_CNT1
						   ,SUM(NVL(SUB_ORG_TYPE_CNT3, 0)) AS SUB_ORG_TYPE_CNT3
						   ,SUM(NVL(SUB_ORG_TYPE_PSON_CNT3, 0)) AS SUB_ORG_TYPE_PSON_CNT3
						   ,SUM(NVL(SUB_ORG_TYPE_CNT4, 0)) AS SUB_ORG_TYPE_CNT4
						   ,SUM(NVL(SUB_ORG_TYPE_PSON_CNT4, 0)) AS SUB_ORG_TYPE_PSON_CNT4
					  FROM TBFAAAEA033D
					 WHERE 1=1
					   AND ORG_TYPE_CD = #strOrgTypeCd#
					   AND YEAR = #strYear#
				  GROUP BY ORG_TYPE_CD, ORG_CD, YEAR, STAFF_CNT1				
				   ) B	
			 WHERE 1=1
			   AND A.ORG_CD = B.ORG_CD	
			   AND A.ORG_DGE_CD BETWEEN 1 AND 4
			  <isNotEmpty property = "strOrgDiv">
		       AND A.PUB_DVSN_CD = #strOrgDiv#
		      </isNotEmpty>
			) A
		GROUP BY OFFC_ORG
		ORDER BY OFFC_ORG
	</select>
	
	<select id="FAAAEA004EExcelSub2select" parameterClass="paramMap" resultClass="resultMap">
		SELECT A.OFFC_ORG
			   ,B.ORG_NM AS OFFC_NM
			   ,A.ORG_CD
			   ,A.ORG_NM
			   ,NVL(A.SUB_ORG_CNT1,0) + NVL(A.SUB_ORG_CNT2,0) AS SUB_ORG_CNT
			   ,NVL(A.SUB_ORG_CNT1,0) AS SUB_ORG_CNT1
			   ,NVL(A.SUB_ORG_CNT2,0) AS SUB_ORG_CNT2
			   ,NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS STAFF_CNT
			   ,NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   ,NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
		  FROM (
			  SELECT C.COPT_SG_CD||'000000000' AS OFFC_ORG
					 ,A.ORG_CD
					 ,C.ORG_NM
					 ,1 AS SUB_ORG_CNT1
					 ,SUM(A.SUB_ORG_TYPE_CNT) AS SUB_ORG_CNT2
					 ,A.STAFF_CNT1
					 ,SUM(A.SUB_ORG_TYPE_PSON_CNT) AS STAFF_CNT2
				FROM TBFAAAEA033D A, TBDCMACM015M C
			   WHERE 1=1
				 AND A.ORG_TYPE_CD IN ('41','30')
				 AND A.YEAR = #strYear#
				 AND A.ORG_CD = C.ORG_CD
		        <isNotEmpty property = "strOrgDiv">
		         AND C.PUB_DVSN_CD = #strOrgDiv#
		        </isNotEmpty>
			GROUP BY A.ORG_CD, A.STAFF_CNT1, C.COPT_SG_CD, C.ORG_NM
			   ) A, TBDCMACM015M B
		 WHERE 1=1
		   AND A.OFFC_ORG = B.ORG_CD
	  ORDER BY OFFC_ORG, ORG_CD
	</select>
	
	<select id="FAAAEA004EExcelSub3select" parameterClass="paramMap" resultClass="resultMap">
		SELECT  B.ORG_DIV_CD AS OFFC_ORG,
		        B.ORG_NM AS OFFC_NM,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '61' THEN 1 ELSE 0 END) SUB_ORG_CNT_011,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '61' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_012,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '52' THEN 1 ELSE 0 END) SUB_ORG_CNT_021,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '52' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_022,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '62' THEN 1 ELSE 0 END) SUB_ORG_CNT_031,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '62' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_032,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '53' THEN 1 ELSE 0 END) SUB_ORG_CNT_041,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '53' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_042,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '54' THEN 1 ELSE 0 END) SUB_ORG_CNT_051,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '54' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_052,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '55' THEN 1 ELSE 0 END) SUB_ORG_CNT_061,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '55' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_062,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '56' THEN 1 ELSE 0 END) SUB_ORG_CNT_071,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '56' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_072,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '57' THEN 1 ELSE 0 END) SUB_ORG_CNT_081,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '57' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_082,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '58' THEN 1 ELSE 0 END) SUB_ORG_CNT_091,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '58' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_092,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '63' THEN 1 ELSE 0 END) SUB_ORG_CNT_101,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '63' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_102,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '64' THEN 1 ELSE 0 END) SUB_ORG_CNT_111,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '64' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_112,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '71' THEN 1 ELSE 0 END) SUB_ORG_CNT_121,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '71' THEN B.SUB_ORG_CNT2 ELSE 0 END) SUB_ORG_CNT_122,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '61' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_011,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '61' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_012,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '52' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_021,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '52' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_022,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '62' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_031,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '62' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_032,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '53' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_041,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '53' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_042,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '54' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_051,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '54' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_052,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '55' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_061,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '55' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_062,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '56' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_071,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '56' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_072,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '57' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_081,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '57' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_082,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '58' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_091,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '58' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_092,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '63' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_101,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '63' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_102,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '64' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_111,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '64' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_112,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '71' THEN B.STAFF_CNT1   ELSE 0 END) STAFF_CNT_121,
		        SUM(CASE WHEN B.ORG_TYPE_CD = '71' THEN B.STAFF_CNT2   ELSE 0 END) STAFF_CNT_122
		FROM    (
		        SELECT  C.ORG_TYPE_CD,
		                C.ORG_CD,
		                C.ORG_DIV_CD,
		                C.ORG_NM,
		                C.YEAR,
		                NVL(C.SUB_ORG_CNT1,0) AS SUB_ORG_CNT1,
		                NVL(C.SUB_ORG_CNT2,0) AS SUB_ORG_CNT2,
		                NVL(D.STAFF_CNT1,0) AS STAFF_CNT1,
		                NVL(D.STAFF_CNT2,0) AS STAFF_CNT2
		        FROM    TBFAAAEA033M D,
		                (
		                SELECT  A.ORG_TYPE_CD,
		                        A.ORG_CD,
		                        B.COPT_SG_CD||'000000000' AS ORG_DIV_CD,
		                        C.ORG_NM,
		                        A.YEAR,
		                        SUM(BELONG_ORG_CNT1) AS SUB_ORG_CNT1,
		                        SUM(NVL(SUB_ORG_CNT1, 0)) + SUM(NVL(SUB_ORG_CNT2, 0)) + SUM(NVL(SUB_ORG_CNT3, 0)) + SUM(NVL(SUB_ORG_CNT4, 0)) + SUM(NVL(SUB_ORG_CNT5, 0)) + SUM(NVL(SUB_ORG_CNT6, 0)) + SUM(NVL(SUB_ORG_CNT7, 0)) + SUM(NVL(SUB_ORG_TYPE_CNT, 0)) + SUM(NVL(SUB_ORG_TYPE_CNT3, 0)) + SUM(NVL(SUB_ORG_TYPE_CNT4, 0)) AS SUB_ORG_CNT2
		                FROM    TBFAAAEA033D A,
		                        TBDCMACM015M B,
		                        TBDCMACM015M C
		                WHERE   A.ORG_TYPE_CD IN ('61','52','62','53','54','55','56','57','58','63','64','71')
		                AND     A.YEAR = #strYear#
		                AND     A.ORG_CD = B.ORG_CD
		                AND     B.COPT_SG_CD||'000000000' = C.ORG_CD
		                <isNotEmpty property = "strOrgDiv">
		                    AND B.PUB_DVSN_CD = #strOrgDiv#
		                </isNotEmpty>
		                GROUP BY A.ORG_TYPE_CD,
		                        A.ORG_CD,
		                        B.COPT_SG_CD||'000000000',
		                        C.ORG_NM,
		                        A.YEAR
		                ) C
		        WHERE   C.ORG_TYPE_CD = D.ORG_TYPE_CD
		        AND     C.ORG_CD = D.ORG_CD
		) B
		GROUP BY B.ORG_DIV_CD, B.ORG_NM
		ORDER BY 1
	</select>
	
	<select id="FAAAEA004EExcelSub4select" parameterClass="paramMap" resultClass="resultMap">
		SELECT  OFFC_ORG,
		        OFFC_NM,
		        SUM(ORG_CNT1 + SUB_ORG_TYPE_CNT1) AS SUB_ORG_CNT,
		        SUM(ORG_CNT1) AS SUB_ORG_CNT1,
		        SUM(SUB_ORG_TYPE_CNT1) AS SUB_ORG_CNT2,
		        SUM(STAFF_CNT1 + SUB_ORG_TYPE_PSON_CNT1) AS STAFF_CNT,
		        SUM(STAFF_CNT1) AS STAFF_CNT1,
		        SUM(SUB_ORG_TYPE_PSON_CNT1) AS STAFF_CNT2
		FROM    (
		        SELECT  OFFC_ORG,
		                F_ORG_INFO(OFFC_ORG, '1') AS OFFC_NM,
		                COUNT(ORG_CD) AS ORG_CNT1,
		                SUM(STAFF_CNT1) AS STAFF_CNT1,
		                SUM(SUB_ORG_TYPE_CNT1) AS SUB_ORG_TYPE_CNT1,
		                SUM(SUB_ORG_TYPE_PSON_CNT1) AS SUB_ORG_TYPE_PSON_CNT1
		        FROM    (
		                SELECT  B.COPT_SG_CD||'000000000' AS OFFC_ORG,
		                        A.ORG_TYPE_CD,
		                        A.ORG_CD,
		                        A.YEAR,
		                        B.COPT_SG_CD,
		                        NVL(A.STAFF_CNT1, 0) AS STAFF_CNT1,
		                        SUM(NVL(A.SUB_ORG_TYPE_CNT, 0)) AS SUB_ORG_TYPE_CNT1,
		                        SUM(NVL(A.SUB_ORG_TYPE_PSON_CNT, 0)) AS SUB_ORG_TYPE_PSON_CNT1
		                FROM    TBFAAAEA033D A,
		                        TBDCMACM015M B
		                WHERE   A.ORG_CD = B.ORG_CD
		                AND     A.ORG_TYPE_CD = #strOrgTypeCd#
						AND     A.YEAR = #strYear#
		                AND     B.ORG_DGE_CD BETWEEN 1 AND 4
		                <isNotEmpty property = "strOrgDiv">
		                    AND     B.PUB_DVSN_CD = #strOrgDiv#
		                </isNotEmpty>
		                GROUP BY B.COPT_SG_CD||'000000000', A.ORG_TYPE_CD, A.ORG_CD, B.COPT_SG_CD, A.YEAR, A.STAFF_CNT1
		                )
		        GROUP BY OFFC_ORG, F_ORG_INFO(OFFC_ORG, '1')
		        )
		GROUP BY OFFC_ORG, OFFC_NM
		ORDER BY 1
	</select>

	<select id="FAAAEA004EExcelSub5select" parameterClass="paramMap" resultClass="resultMap">
		SELECT A.OFFC_ORG
			   ,B.ORG_NM AS OFFC_NM
			   ,A.ORG_CD
			   ,A.ORG_NM
			   ,NVL(A.SUB_ORG_CNT1,0) + NVL(A.SUB_ORG_CNT2,0) AS SUB_ORG_CNT
			   ,NVL(A.SUB_ORG_CNT1,0) AS SUB_ORG_CNT1
			   ,NVL(A.SUB_ORG_CNT2,0) AS SUB_ORG_CNT2
			   ,NVL(A.STAFF_CNT1,0) + NVL(A.STAFF_CNT2,0) AS STAFF_CNT
			   ,NVL(A.STAFF_CNT1,0) AS STAFF_CNT1
			   ,NVL(A.STAFF_CNT2,0) AS STAFF_CNT2
		  FROM (
			  SELECT C.COPT_SG_CD||'000000000' AS OFFC_ORG
					 ,A.ORG_CD
					 ,C.ORG_NM
					 ,1 AS SUB_ORG_CNT1
					 ,SUM(A.SUB_ORG_TYPE_CNT) AS SUB_ORG_CNT2
					 ,A.STAFF_CNT1
					 ,SUM(A.SUB_ORG_TYPE_PSON_CNT) AS STAFF_CNT2
				FROM TBFAAAEA033D A, TBDCMACM015M C
			   WHERE 1=1
				 AND A.ORG_TYPE_CD = #strOrgTypeCd#
				 AND A.YEAR = #strYear#
				 AND A.ORG_CD = C.ORG_CD
		        <isNotEmpty property = "strOrgDiv">
		         AND C.PUB_DVSN_CD = #strOrgDiv#
		        </isNotEmpty>
			GROUP BY A.ORG_CD, A.STAFF_CNT1, C.COPT_SG_CD, C.ORG_NM
			   ) A, TBDCMACM015M B
		 WHERE 1=1
		   AND A.OFFC_ORG = B.ORG_CD
	  ORDER BY OFFC_ORG, ORG_CD
	</select>
	
</sqlMap> 
