<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/019">

	<select id="FAACAV019ERselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/019/FAACAV019ERselect */ ]]>
		SELECT 
			A.BR_CD||'-'||A.DIV_CD AS 주무과
			,TO_CHAR(A.ACP_DH,'YYYYMMDD') AS 접수일자
			,F_COPT_NM(A.COPT_CD) AS 소관
			,B.ACNT_CD_NM AS 회계
			,A.COPT_CD || A.ACNT_CD || A.BLL_CD || A.PROF_DRTR_SRNO || A.DL_XPN_RCDB_PBSVT_SRNO || CHR(10) || D.ORG_NM AS 증명기관
			,F_AV_BLL_CD_NM(A.BLL_CD,  A.DL_XPN_RCDB_PBSVT_SRNO) AS 계산서명
			,A.PROF_YM || CHR(10) || '(분기)' AS 증명년월
			,A.DISAG_NO AS 불부합번호
			,NVL((SELECT SUBSTR(A1.DISAG_CD,4,1) 
				FROM TWFAACAV020D A1 
				WHERE A1.COPT_CD = A.COPT_CD 
					AND A1.ACNT_CD = A.ACNT_CD 
					AND A1.BLL_CD = A.BLL_CD 
					AND A1.PROF_DRTR_SRNO  = A.PROF_DRTR_SRNO 
					AND A1.DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO 
					AND A1.PROF_YM = A.PROF_YM  
					AND A1.DISAG_NO  = '00001'),' ') AS 구분 
			, (SELECT B1.RMK_2 
				FROM TWFAACAV024C B1, TWFAACAV020D A1 
				WHERE A1.COPT_CD = A.COPT_CD 
					AND A1.ACNT_CD = A.ACNT_CD 
					AND A1.BLL_CD = A.BLL_CD 
					AND A1.PROF_DRTR_SRNO  = A.PROF_DRTR_SRNO 
					AND A1.DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO 
					AND A1.PROF_YM = A.PROF_YM  
					AND A1.DISAG_NO  = '00001' 
					AND B1.ACNT_DVSN_CD = '12' 
					AND B1.ACNT_CD = A1.DISAG_CD ) AS 내용 
			, (SELECT  A1.DISAG_MGN 
				FROM TWFAACAV020D A1 
				WHERE A1.COPT_CD = A.COPT_CD 
					AND A1.ACNT_CD = A.ACNT_CD 
					AND A1.BLL_CD = A.BLL_CD 
					AND A1.PROF_DRTR_SRNO  = A.PROF_DRTR_SRNO 
					AND A1.DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO 
					AND A1.PROF_YM = A.PROF_YM  
					AND A1.DISAG_NO  = '00001' ) AS 금액 
			FROM   TWFAACAV003M D, TWFAACAV024C C, TWFAACAV024C B, TWFAACAV019M A
			WHERE 1=1
				AND    B.ACNT_DVSN_CD = '02' 	
				AND    B.ACNT_CD = A.COPT_CD 	
				AND    C.ACNT_DVSN_CD = '01' 	
				AND    C.ACNT_CD = A.ACNT_CD 	
				AND    D.COPT_CD = A.COPT_CD 	
				AND    D.ACNT_CD = A.ACNT_CD 	
				AND    D.BLL_CD = A.BLL_CD 	
				AND    D.PROF_DRTR_SRNO  = A.PROF_DRTR_SRNO 	
				AND    D.DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
			<isEqual property="strMm" compareValue="00">
				AND A.BLL_CD IN ('14','28','30','31','32','33','34','35') 	
				AND A.PROF_YM = #strYr# || '00'	 
			</isEqual>
			<isEqual property="strMm" compareValue="01">
				AND (A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000'))
				AND A.PROF_YM = #strYr# || '01'
			</isEqual>
			<isEqual property="strMm" compareValue="02">
				AND (A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000'))
				AND A.PROF_YM = #strYr# || '02'
			</isEqual>
			<isEqual property="strMm" compareValue="03">
				AND (A.PROF_YM = #strYr# || #strMm#
				OR  A.PROF_YM = #strYr# ||'01') 	
				AND (((A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND A.PROF_YM = #strYr# || '03') 	
				OR (A.BLL_CD IN ('20','22','23','24','54','42','43','11','12','21','13','15','16','29','41') 	
				AND A.PROF_YM = '04'))
			</isEqual>
			<isEqual property="strMm" compareValue="04">
				AND (A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000'))	
				AND	A.PROF_YM = #strYr# || '04'
			</isEqual>
			<isEqual property="strMm" compareValue="05">
				AND (A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND	A.PROF_YM = #strYr# || '05'
			</isEqual>
			<isEqual property="strMm" compareValue="06">
				AND (A.PROF_YM = #strYr# || #strMm# 
				OR  A.PROF_YM = #strYr#||'02') 	
				AND (((A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND A.PROF_YM = #strYr# || '06' ) 	
				OR (A.BLL_CD IN ('20','22','23','24','54','42','43','11','12','21','13','15','16','29','41') 	
				AND A.PROF_YM = #strYr# ||'02')) 
			</isEqual>
			<isEqual property="strMm" compareValue="07">
				AND (A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND	A.PROF_YM = #strYr# || '07'	
			</isEqual>
			<isEqual property="strMm" compareValue="08">
				AND (A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND	A.PROF_YM = #strYr# || '08'
			</isEqual>
			<isEqual property="strMm" compareValue="09">
				AND (A.PROF_YM = #strYr# || '09' 
				OR  A.PROF_YM = #strYr# ||'03') 	
				AND (((A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND A.PROF_YM = #strYr# || '09') 	
				OR (A.BLL_CD IN ('20','22','23','24','54','42','43','11','12','21','13','15','16','29','41') 	
				AND A.PROF_YM = #strYr# || '03')) 
			</isEqual>
			<isEqual property="strMm" compareValue="10">
				AND (A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND	A.PROF_YM = #strYr# || '10'
			</isEqual>
			<isEqual property="strMm" compareValue="11">
				AND (A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND	A.PROF_YM = #strYr# || '11'	
			</isEqual>
			<isEqual property="strMm" compareValue="12">
				AND (A.PROF_YM = #strYr# || '12' 
				OR  A.PROF_YM = #strYr# || '04') 	
				AND (((A.BLL_CD IN ('17','26','27','18','19','52','53','51') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND A.PROF_YM = #strYr# || '12') 	
				OR (A.BLL_CD IN ('20','22','23','24','54','11','12','21','13','15','16','29') 	
				AND A.PROF_YM = #strYr# + 4)) 	
			</isEqual>
			<isEqual property="strMm" compareValue="13">
				AND (A.PROF_YM = #strYr# || '13' 
				OR  A.PROF_YM = #strYr# || '04') 	
				AND (((A.BLL_CD IN ('17','26','27','18') 	
				OR (A.BLL_CD IN ('22','23','24') AND A.DL_XPN_RCDB_PBSVT_SRNO != '000')) 	
				AND A.PROF_YM = #strYr# || '13') 	
				OR (A.BLL_CD IN ('42','43','41') 	
				AND A.PROF_YM = #strYr# || '04')) 	
			</isEqual>
			ORDER BY A.BR_CD, A.DIV_CD, A.DISAG_NO 
		</select>
</sqlMap> 
