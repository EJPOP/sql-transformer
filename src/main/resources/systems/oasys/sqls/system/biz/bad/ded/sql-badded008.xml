<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="bad/ded/008">
	<!-- 감사연번호  -->
	<select id="BADDED008QSelect1_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT AUD.AUD_KND_CD
			     , F_CODE_NM('1000007',MAX(AUD.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
			     , COUNT(AUD.AUD_NO) AS AUD_ITEM_CNT
			     , SUM(PSON.PSON_CNT) PSON_CNT
			     , SUM(TTO.ORG_CNT) AS ORG_CNT
			     , SUM(PSON.MAN_DAY) MAN_DAY
			     , SUM(PSON.IN_PSON_CNT) IN_PSON_CNT
			     , SUM(PSON.EXT_PSON_CNT) EXT_PSON_CNT
			     , SUM(PSON.EXT_PSON1_CNT) EXT_PSON1_CNT
			     , SUM(PSON.EXT_PSON2_CNT) EXT_PSON2_CNT
			     , SUM(PSON.IN_PSON_MAN_DAY) IN_PSON_MAN_DAY
			     , SUM(PSON.EXT_PSON_MAN_DAY) EXT_PSON_MAN_DAY
			     , SUM(PSON.IN_PSON_TYPE1_MAN_DAY) IN_PSON_TYPE1_MAN_DAY
			     , SUM(PSON.IN_PSON_TYPE2_MAN_DAY) IN_PSON_TYPE2_MAN_DAY
			     , SUM(PSON.IN_PSON_TYPE3_MAN_DAY) IN_PSON_TYPE3_MAN_DAY
			     , SUM(PSON.IN_PSON_TYPE4_MAN_DAY) IN_PSON_TYPE4_MAN_DAY
			     , SUM(PSON.EXT_PSON_TYPE1_MAN_DAY) EXT_PSON_TYPE1_MAN_DAY
			     , SUM(PSON.EXT_PSON_TYPE2_MAN_DAY) EXT_PSON_TYPE2_MAN_DAY
			     , SUM(PSON.EXT_PSON_TYPE3_MAN_DAY) EXT_PSON_TYPE3_MAN_DAY
			     , SUM(PSON.EXT_PSON_TYPE4_MAN_DAY) EXT_PSON_TYPE4_MAN_DAY
			     , SUM(TTO.ORG_TYPE1_CNT) AS ORG_TYPE1_CNT
			     , SUM(TTO.ORG_TYPE2_CNT) AS ORG_TYPE2_CNT
			     , SUM(TTO.ORG_TYPE3_CNT) AS ORG_TYPE3_CNT
			     , SUM(TTO.ORG_TYPE4_CNT) AS ORG_TYPE4_CNT
			  FROM TBBADDED002M SITU
			     , TBBADDED001M AUD
			     , (SELECT BZT_YR
			             , /*감사년도*/
			          BZT_SNO
			             , /*감사순번*/
			          MIN(AUD_STR_DT) AS AUD_STR_DT
			             , /*감사시작일*/
			          MAX(AUD_END_DT) AS AUD_END_DT
			             , /*감사종료일*/
			          MAX(AUD_DCN) AS AUD_DCN
			             , /*최대감사일수*/
			          SUM(AUD_DCN) AS MAN_DAY
			             , /*감사일수합*/
			          COUNT(*) AS PSON_CNT
			             , SUM( CASE
			                                         WHEN STF_DVSN_CD = '0' THEN 1
			                                         ELSE 0
			                                       END) AS IN_PSON_CNT
			             , /*내부직원*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD = '0' THEN 0
			                                         ELSE 1
			                                       END) AS EXT_PSON_CNT
			             , /*외부직원*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD = '1' THEN 0
			                                         ELSE 1
			                                       END) AS EXT_PSON1_CNT
			             , /* 수견*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD = '2'
			                    OR STF_DVSN_CD = '9' THEN 0
			                                         ELSE 1
			                                       END) AS EXT_PSON2_CNT
			             , /*차출*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD = '0' THEN AUD_DCN /*감사일수*/
			                                         ELSE 0
			                                       END) AS IN_PSON_MAN_DAY
			             , /*내부직원감사일수*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD = '0' THEN 0
			                                         ELSE AUD_DCN
			                                       END) AS EXT_PSON_MAN_DAY
			             , /*외부인감사일수*/ 
			/* ORG_TYPE_CATE : 
			                10	국가기관
			                21	지방자치단체
			                22	교육자치단체
			                30	공공기관 20개
			                40	기타필요적대상기관▼
			               */
			          SUM( CASE
			                                         WHEN STF_DVSN_CD = '0'
			                   AND ORG_TYPE_CATE = '1' THEN AUD_DCN
			                                         ELSE 0
			                                       END) AS IN_PSON_TYPE1_MAN_DAY
			             , /*내부직원이고 국가기관의 감사일수*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD = '0'
			                   AND ORG_TYPE_CATE = '2' THEN AUD_DCN
			                                         ELSE 0
			                                       END) AS IN_PSON_TYPE2_MAN_DAY
			             , /*내부직원이고 지방자치단체의 감사일수*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD = '0'
			                   AND ORG_TYPE_CATE = '3' THEN AUD_DCN
			                                         ELSE 0
			                                       END) AS IN_PSON_TYPE3_MAN_DAY
			             , /*내부직원이고 공공기관 20개의 감사일수*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD = '0'
			                   AND ORG_TYPE_CATE >= '4' THEN AUD_DCN
			                                         ELSE 0
			                                       END) AS IN_PSON_TYPE4_MAN_DAY
			             , /*내부직원이고 기타필요적대상기관의 감사일수*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD != '0'
			                   AND ORG_TYPE_CATE = '1' THEN AUD_DCN
			                                         ELSE 0
			                                       END) AS EXT_PSON_TYPE1_MAN_DAY
			             , /*외부인이고 국가기관의 감사일수*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD != '0'
			                   AND ORG_TYPE_CATE = '2' THEN AUD_DCN
			                                         ELSE 0
			                                       END) AS EXT_PSON_TYPE2_MAN_DAY
			             , /*외부인이고 지방자치단체의 감사일수*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD != '0'
			                   AND ORG_TYPE_CATE = '3' THEN AUD_DCN
			                                         ELSE 0
			                                       END) AS EXT_PSON_TYPE3_MAN_DAY
			             , /*외부인이고 공공기관 20개의 감사일수*/
			          SUM( CASE
			                                         WHEN STF_DVSN_CD != '0'
			                   AND ORG_TYPE_CATE >= '4' THEN AUD_DCN
			                                         ELSE 0
			                                       END) AS EXT_PSON_TYPE4_MAN_DAY /*외부인이고 기타필요적대상기관의 감사일수*/
			          FROM (SELECT /*+USE_HASH(TMA,PTD)*/
			                  TMA.BZT_YR
			                     , TMA.BZT_SNO
			                     , TMA.PCT_CNB
			                     , TMA.STF_DVSN_CD
			                     , SUBSTR(ORG.ORG_DVSN_CD, 1, 1) AS ORG_TYPE_CATE /*기관구분코드*/
			                     , MIN(PTD.AUD_STR_DT) AS AUD_STR_DT
			                     , MAX(PTD.AUD_END_DT) AS AUD_END_DT
			                     , SUM(PTD.AUD_DCN) AS AUD_DCN
			                  FROM TBBADDED005L TMA
			                     , TBBADDED006L PTD
			                     , TBBADDED008L TTO
			                     , TBDCMACM015M ORG
			                 WHERE TMA.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# /*인자값1  FROM ~ TO*/
			                   AND PTD.BZT_YR = TMA.BZT_YR
			                   AND PTD.BZT_SNO = TMA.BZT_SNO
			                   AND PTD.TEAM_SNO = TMA.TEAM_SNO
			                   AND PTD.PCT_ALC_SNO = TMA.PCT_ALC_SNO
			                   AND TTO.BZT_YR= PTD.BZT_YR
			                   AND TTO.BZT_SNO = PTD.BZT_SNO
			                   AND TTO.TEAM_SNO = PTD.TEAM_SNO
			                   AND TTO.BGRP_TG_ORG_SNO = PTD.BGRP_TG_ORG_SNO
			                   AND TTO.ORG_CD =ORG.ORG_CD(+)
			                   AND SUBSTR(PTD.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM# /*인자값2  FROM ~ TO*/
			                 GROUP BY TMA.BZT_YR, TMA.BZT_SNO, TMA.PCT_CNB, TMA.STF_DVSN_CD, SUBSTR(ORG.ORG_DVSN_CD, 1, 1) ) PTD1
			         GROUP BY BZT_YR, BZT_SNO ) PSON
			     , (SELECT BZT_YR
			             , BZT_SNO
			             , COUNT(*) AS ORG_CNT
			             , SUM( CASE
			                                         WHEN SUBSTR(ORG.ORG_DVSN_CD, 1, 1) = '1' THEN 1
			                                         ELSE 0
			                                       END) AS ORG_TYPE1_CNT
			             , SUM( CASE
			                                         WHEN SUBSTR(ORG.ORG_DVSN_CD, 1, 1) = '2' THEN 1
			                                         ELSE 0
			                                       END) AS ORG_TYPE2_CNT
			             , SUM( CASE
			                                         WHEN SUBSTR(ORG.ORG_DVSN_CD, 1, 1) = '3' THEN 1
			                                         ELSE 0
			                                       END) AS ORG_TYPE3_CNT
			             , SUM( CASE
			                                         WHEN SUBSTR(ORG.ORG_DVSN_CD, 1, 1) >= '4' THEN 1
			                                         ELSE 0
			                                       END) AS ORG_TYPE4_CNT
			          FROM (SELECT DISTINCT BZT_YR
			                     , BZT_SNO
			                     , ORG_CD
			                  FROM TBBADDED008L
			                 WHERE 1=1
			                   AND BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# /*인자값1  FROM ~ TO*/
			                   AND SUBSTR(AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*인자값2  FROM ~ TO*/
			                  ) TTO0
			             , TBDCMACM015M ORG
			         WHERE TTO0.ORG_CD = ORG.ORG_CD
			         GROUP BY BZT_YR, BZT_SNO ) TTO
			 WHERE SITU.REL_AUD_YR = AUD.AUD_YR
			   AND SITU.REL_AUD_NO = AUD.AUD_NO
			   AND PSON.BZT_YR = SITU.BZT_YR
			   AND PSON.BZT_SNO = SITU.BZT_SNO
			   AND TTO.BZT_YR = SITU.BZT_YR
			   AND TTO.BZT_SNO = SITU.BZT_SNO
			 GROUP BY AUD.AUD_KND_CD 
        ]]>
	</select>
	
	<select id="BADDED008QSelect1_2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[     
			SELECT A.AUD_YR
			     , A.AUD_NO
			     , A.AUD_KND_CD
			  FROM TBBADDED001M A
			     , TBBADDED002M B
			     , TBBADDED008L C
			     , TBBADDED005L D
			     , TBBADDED006L E
			 WHERE 1 =1
			   AND A.AUD_KND_CD = #AUD_KND_CD#
			   AND B.REL_AUD_YR = A.AUD_YR
			   AND B.REL_AUD_NO = A.AUD_NO
			   AND B.BZT_DVSN_CD = '1'
			   AND C.BZT_YR = B.BZT_YR
			   AND C.BZT_SNO = B.BZT_SNO
			   AND D.BZT_YR = B.BZT_YR
			   AND D.BZT_SNO = B.BZT_SNO
			   AND E.BZT_YR = D.BZT_YR
			   AND E.BZT_SNO = D.BZT_SNO
			   AND E.TEAM_SNO = D.TEAM_SNO
			   AND E.BGRP_TG_ORG_SNO = C.BGRP_TG_ORG_SNO
			   AND E.PCT_ALC_SNO = D.PCT_ALC_SNO
			   AND SUBSTR(E.AUD_STR_DT,1,6) BETWEEN #strBztStYY#||#strBztStMM#  AND #strBztEndYY#||#strBztEndMM# /*인자값2*/
			 GROUP BY A.AUD_YR, A.AUD_NO, A.AUD_KND_CD 
        ]]>
	</select>
	
	<select id="BADDED008QSelect1_3" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[     
				SELECT F_MNG_KND_AUDYRNO(A.AUD_YR, A.AUD_NO, A.AUD_KND_CD, '-') AS AUD_SNO
				     , A.AUD_YR
				     , A.AUD_NO
				     , MAX(A.AUD_SBJ_NM) AS AUD_SBJ_NM
				     , COUNT(C.ORG_CD) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) ORG_CNT
				     , MIN(MIN(E.AUD_STR_DT)) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) SDATE
				     , MAX(MAX(E.AUD_END_DT)) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) EDATE
				     , SUM(E.AUD_DCN) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) DAYS
				     , SUM(SUM(CASE
				                                         WHEN D.STF_DVSN_CD = '0' THEN E.AUD_DCN
				                                         ELSE 0
				                                       END)) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) IN_PSON_MAN_TOT
				     , SUM(SUM( CASE
				                                         WHEN D.STF_DVSN_CD = '0' THEN 0
				                                         ELSE E.AUD_DCN
				                                       END)) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) AS EXT_PSON_MAN_TOT
				     , F.ORG_NM
				     , G.CD_NM
				     , MIN(E.AUD_STR_DT) AS AUD_SDATE
				     , MAX(E.AUD_END_DT) AS AUD_EDATE
				     , E.AUD_DCN AUD_DAYS
				     , SUM( CASE
				                         WHEN D.STF_DVSN_CD = '0' THEN 1
				                         ELSE 0
				                       END) AS IN_PSON_CNT
				     , SUM( CASE
				                         WHEN D.STF_DVSN_CD = '0' THEN 0
				                         ELSE 1
				                       END) AS EXT_PSON_CNT
				     , SUM( CASE
				                         WHEN D.STF_DVSN_CD = '0' THEN E.AUD_DCN
				                         ELSE 0
				                       END) AS IN_PSON_MAN_DAY
				     , SUM( CASE
				                         WHEN D.STF_DVSN_CD = '0' THEN 0
				                         ELSE E.AUD_DCN
				                       END) AS EXT_PSON_MAN_DAY
				  FROM TBBADDED001M A
				     , TBBADDED002M B
				     , TBBADDED008L C
				     , TBBADDED005L D
				     , TBBADDED006L E
				     , TBDCMACM015M F
				     , (SELECT CD
				             , CD_NM
				          FROM TBDCMACM013C
				         WHERE CMM_CD_DVSN_CD = '1000119') G
				 WHERE 1 =1
				   AND A.AUD_KND_CD = #AUD_KND_CD#		/*인자값2*/
				   AND A.AUD_YR = #AUD_YR# 				/*인자값1*/
				   AND A.AUD_NO = #AUD_NO# 				/*인자값1*/
				   AND B.REL_AUD_YR = A.AUD_YR
				   AND B.REL_AUD_NO = A.AUD_NO
				   AND B.BZT_DVSN_CD = '1'
				   AND C.BZT_YR = B.BZT_YR
				   AND C.BZT_SNO = B.BZT_SNO
				   AND D.BZT_YR = B.BZT_YR
				   AND D.BZT_SNO = B.BZT_SNO
				   AND E.BZT_YR = D.BZT_YR
				   AND E.BZT_SNO = D.BZT_SNO
				   AND E.TEAM_SNO = D.TEAM_SNO
				   AND E.BGRP_TG_ORG_SNO = C.BGRP_TG_ORG_SNO
				   AND E.PCT_ALC_SNO = D.PCT_ALC_SNO
				   AND SUBSTR(E.AUD_STR_DT,1,6) BETWEEN #strBztStYY#||#strBztStMM#  AND #strBztEndYY#||#strBztEndMM# /*인자값3*/
				   AND F.ORG_CD = C.ORG_CD
				   AND G.CD = A.ORG_DVSN_CD
				 GROUP BY A.AUD_YR, A.AUD_NO, C.ORG_CD, D.STF_DVSN_CD, E.AUD_DCN, F.ORG_NM, G.CD_NM 
        ]]>
	</select>

	<select id="BADDED008QSelect1_4" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[      
			SELECT AA.AUD_YR
			     , AA.AUD_NO
			     , MAX(BB.ORG_CNT) ORG_CNT
			     , MAX(BB.ORG_TYPE_1_CNT) AS ORG_TYPE_1_CNT
			     , MAX(BB.ORG_TYPE_2_CNT) AS ORG_TYPE_2_CNT
			     , MAX(BB.ORG_TYPE_3_CNT) AS ORG_TYPE_3_CNT
			     , MAX(BB.ORG_TYPE_4_CNT) AS ORG_TYPE_4_CNT
			     , SUM (AA.AUD_DCN) AS DAYS
			     , SUM(AA.IN_PSON_CNT) AS IN_PSON_CNT
			     , SUM(AA.EXT_PSON_CNT) AS EXT_PSON_CNT
			     , SUM(AA.IN_PSON_MAN_DAY) AS IN_PSON_MAN_DAY
			     , SUM(AA.EXT_PSON_MAN_DAY) AS EXT_PSON_MAN_DAY
			     , SUM(CASE
			                         WHEN SUBSTRING(AA.ORG_DVSN_CD,1,1) = '1' THEN IN_PSON_MAN_DAY
			                         ELSE 0
			                       END) AS IN_PSON_MAN_DAY_1_TOT
			     , SUM(CASE
			                         WHEN SUBSTRING(AA.ORG_DVSN_CD,1,1) = '2' THEN IN_PSON_MAN_DAY
			                         ELSE 0
			                       END) AS IN_PSON_MAN_DAY_2_TOT
			     , SUM(CASE
			                         WHEN SUBSTRING(AA.ORG_DVSN_CD,1,1) = '3' THEN IN_PSON_MAN_DAY
			                         ELSE 0
			                       END) AS IN_PSON_MAN_DAY_3_TOT
			     , SUM(CASE
			                         WHEN SUBSTRING(AA.ORG_DVSN_CD,1,1) > '3' THEN IN_PSON_MAN_DAY
			                         ELSE 0
			                       END) AS IN_PSON_MAN_DAY_4_TOT
			     , SUM(CASE
			                         WHEN SUBSTRING(AA.ORG_DVSN_CD,1,1) = '1' THEN EXT_PSON_MAN_DAY
			                         ELSE 0
			                       END) AS EXT_PSON_MAN_DAY_1_TOT
			     , SUM(CASE
			                         WHEN SUBSTRING(AA.ORG_DVSN_CD,1,1) = '2' THEN EXT_PSON_MAN_DAY
			                         ELSE 0
			                       END) AS EXT_PSON_MAN_DAY_2_TOT
			     , SUM(CASE
			                         WHEN SUBSTRING(AA.ORG_DVSN_CD,1,1) = '3' THEN EXT_PSON_MAN_DAY
			                         ELSE 0
			                       END) AS EXT_PSON_MAN_DAY_3_TOT
			     , SUM(CASE
			                         WHEN SUBSTRING(AA.ORG_DVSN_CD,1,1) > '3' THEN EXT_PSON_MAN_DAY
			                         ELSE 0
			                       END) AS EXT_PSON_MAN_DAY_4_TOT
			  FROM (SELECT A.AUD_YR
			             , A.AUD_NO
			             , C.ORG_CD
			             , E.AUD_DCN
			             , F.ORG_DVSN_CD
			             , SUM(CASE
			                                         WHEN D.STF_DVSN_CD = '0' THEN 1
			                                         ELSE 0
			                                       END) AS IN_PSON_CNT
			             , SUM(CASE
			                                         WHEN D.STF_DVSN_CD = '0' THEN 0
			                                         ELSE 1
			                                       END) AS EXT_PSON_CNT
			             , SUM(CASE
			                                         WHEN D.STF_DVSN_CD = '0' THEN E.AUD_DCN
			                                         ELSE 0
			                                       END) AS IN_PSON_MAN_DAY
			             , SUM(CASE
			                                         WHEN D.STF_DVSN_CD = '0' THEN 0
			                                         ELSE E.AUD_DCN
			                                       END) AS EXT_PSON_MAN_DAY
			          FROM TBBADDED001M A
			             , TBBADDED002M B
			             , TBBADDED008L C
			             , TBBADDED005L D
			             , TBBADDED006L E
			             , TBDCMACM015M F
			         WHERE 1 =1
			           AND A.AUD_YR = #AUD_YR# /*인자값1*/
			           AND A.AUD_NO = #AUD_NO# /*인자값1*/
			           AND B.REL_AUD_YR = A.AUD_YR
			           AND B.REL_AUD_NO = A.AUD_NO
			           AND B.BZT_DVSN_CD = '1'
			           AND C.BZT_YR = B.BZT_YR
			           AND C.BZT_SNO = B.BZT_SNO
			           AND D.BZT_YR = B.BZT_YR
			           AND D.BZT_SNO = B.BZT_SNO
			           AND E.BZT_YR = D.BZT_YR
			           AND E.BZT_SNO = D.BZT_SNO
			           AND E.TEAM_SNO = D.TEAM_SNO
			           AND E.BGRP_TG_ORG_SNO = C.BGRP_TG_ORG_SNO
			           AND E.PCT_ALC_SNO = D.PCT_ALC_SNO
			           AND F.ORG_CD = C.ORG_CD
			         GROUP BY A.AUD_YR, A.AUD_NO, C.ORG_CD, E.AUD_DCN, F.ORG_DVSN_CD ) AA
			     , (SELECT AUD_YR
			             , AUD_NO
			             , COUNT(*) AS ORG_CNT
			             , SUM(CASE
			                                         WHEN SUBSTR(BB.ORG_DVSN_CD,1,1) = '1' THEN 1
			                                         ELSE 0
			                                       END) AS ORG_TYPE_1_CNT
			             , SUM(CASE
			                                         WHEN SUBSTR(BB.ORG_DVSN_CD,1,1) = '2' THEN 1
			                                         ELSE 0
			                                       END) AS ORG_TYPE_2_CNT
			             , SUM(CASE
			                                         WHEN SUBSTR(BB.ORG_DVSN_CD,1,1) = '3' THEN 1
			                                         ELSE 0
			                                       END) AS ORG_TYPE_3_CNT
			             , SUM(CASE
			                                         WHEN SUBSTR(BB.ORG_DVSN_CD,1,1) >= '4' THEN 1
			                                         ELSE 0
			                                       END) AS ORG_TYPE_4_CNT
			          FROM (SELECT DISTINCT C.AUD_YR
			                     , C.AUD_NO
			                     , A.ORG_CD
			                  FROM TBBADDED008L A
			                     , TBBADDED002M B
			                     , TBBADDED001M C
			                 WHERE 1=1
			                   AND C.AUD_YR = #AUD_YR# /*인자값1*/
			                   AND C.AUD_NO = #AUD_NO# /*인자값1*/
			                   AND B.REL_AUD_YR =C.AUD_YR
			                   AND B.REL_AUD_NO = C.AUD_NO
			                   AND B.BZT_DVSN_CD = '1'
			                   AND A.BZT_YR = B.BZT_YR
			                   AND A.BZT_SNO = B.BZT_SNO ) AA
			             , TBDCMACM015M BB
			         WHERE AA.ORG_CD = BB.ORG_CD
			         GROUP BY AUD_YR, AUD_NO ) BB
			 WHERE 1 =1
			   AND BB.AUD_YR = AA.AUD_YR
			   AND BB.AUD_NO = AA.AUD_NO
			 GROUP BY AA.AUD_YR, AA.AUD_NO 
        ]]>
	</select>

	<!-- 대상기관별 감사종류별 현황  -->
	<select id="BADDED008QSelect2_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			/*인자값
			  1) 화면의 감사기간 년도 FROM ~ TO --필수
			  2) 화면의 감사기간 년월 FROM ~ TO --필수
			  3) 화면의 기관코드범위 FROM ~ TO 
			*/
			
			SELECT /*+ LEADING(SITU,AUD,ORG,TTO,PSON) */ 
			       F_ORG_INFO(ORG.ORG_CD,'1') ORG_NM,
			       ORG.ORG_CD,
			       SUM(PSON.AUD_DCN) AS AUD_DAY_TOT,  /*총계_일수*/
			       SUM(PSON.MAN_DAY ) AS MAN_DAY_TOT, /*총계_연인원*/
			       SUM (TTO.ORG_CNT ) AS ORG_CNT_TOT, /*총계_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) + COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) + COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) + COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) + COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) > '4' THEN AUD.AUD_NO 
			                         ELSE NULL
			                       END) AS AUD_ITEM_TOT, /* 총계_사항*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN PSON.AUD_DCN
			                         ELSE 0
			                       END) AS AUD_DAYS1,  /*재무감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN PSON.MAN_DAY
			                         ELSE 0
			                       END) AS MAN_DAY1,  /*재무감사_연인원*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN TTO.ORG_CNT
			                         ELSE 0
			                       END) AS ORG_CNT1,  /*재무감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT1, /*재무감사_사항*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN PSON.AUD_DCN
			                         ELSE 0
			                       END) AS AUD_DAYS2, /*특정과제감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN PSON.MAN_DAY
			                         ELSE 0
			                       END) AS MAN_DAY2, /*특정과제감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN TTO.ORG_CNT
			                         ELSE 0
			                       END) AS ORG_CNT2, /*특정과제감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT2, /*특정과제감사_사항*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN PSON.AUD_DCN
			                         ELSE 0
			                       END) AS AUD_DAYS3, /*사업성과감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN PSON.MAN_DAY
			                         ELSE 0 
			                       END) AS MAN_DAY3, /*사업성과감사_연인원*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN TTO.ORG_CNT
			                         ELSE 0
			                       END) AS ORG_CNT3,  /*사업성과감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT3, /*사업성과감사_사항*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN PSON.AUD_DCN
			                         ELSE 0
			                       END) AS AUD_DAYS4, /*기관운영성과감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN PSON.MAN_DAY
			                         ELSE 0
			                       END) AS MAN_DAY4,  /*기관운영성과감사_연인원*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN TTO.ORG_CNT
			                         ELSE 0
			                       END) AS ORG_CNT4, /*기관운영성과감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT4, /*기관운영성과감사_감사*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN PSON.AUD_DCN 
			                         ELSE 0
			                       END) AS AUD_DAYS5, /*기타감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN PSON.MAN_DAY 
			                         ELSE 0
			                       END) AS MAN_DAY5, /*기타감사_연인원*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN TTO.ORG_CNT 
			                         ELSE 0
			                       END) AS ORG_CNT5,  /*기타감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN AUD.AUD_NO 
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT5 /*기타감사_사항*/
			  FROM TBBADDED002M SITU,
			       TBBADDED001M AUD,
			       TBBADDED008L ORG,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               MIN(AUD_STR_DT) AS AUD_STR_DT,
			               MAX(AUD_END_DT) AS AUD_END_DT,
			               MAX(AUD_DCN) AS AUD_DCN,
			               SUM(AUD_DCN) AS MAN_DAY
			          FROM (SELECT TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB,
			                       MIN(PTD.AUD_STR_DT) AS AUD_STR_DT,
			                       MAX(PTD.AUD_END_DT) AS AUD_END_DT,
			                       SUM(PTD.AUD_DCN) AS AUD_DCN
			                  FROM TBBADDED005L TMA,
			                       TBBADDED006L PTD
			                 WHERE PTD.BZT_YR = TMA.BZT_YR
			                   AND PTD.BZT_SNO = TMA.BZT_SNO
			                   AND PTD.TEAM_SNO = TMA.TEAM_SNO
			                   AND PTD.PCT_ALC_SNO = TMA.PCT_ALC_SNO
			                   AND PTD.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# /*인자값1*/
			                   AND SUBSTR(PTD.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*인자값2*/
			                 GROUP BY TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB) PTD1
			         GROUP BY BZT_YR,
			               BZT_SNO ) PSON,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               COUNT(*) AS ORG_CNT
			          FROM (SELECT DISTINCT BZT_YR,
			                       BZT_SNO,
			                       BGRP_TG_ORG_SNO
			                  FROM TBBADDED008L
			                 WHERE SUBSTR(AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM# /*인자값2*/
			               ) TTO0
			         GROUP BY BZT_YR,
			               BZT_SNO ) TTO
			 WHERE SITU.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# /*인자값1*/
			   AND SITU.REL_AUD_YR = AUD.AUD_YR
			   AND SITU.REL_AUD_NO = AUD.AUD_NO
			   AND SITU.BZT_DVSN_CD ='1'
			   AND ORG.BZT_YR = SITU.BZT_YR
			   AND ORG.BZT_SNO = SITU.BZT_SNO
        ]]>
        <isNotEmpty property="strOrgCdSt">
	        <![CDATA[
	        	AND ORG.ORG_CD >=#strOrgCdSt#
	        ]]>
        </isNotEmpty>

        <isNotEmpty property="strOrgCdEnd">
	        <![CDATA[
	        	AND ORG.ORG_CD <=#strOrgCdEnd#
	        ]]>
        </isNotEmpty>			          			   
        <![CDATA[  
			   AND PSON.BZT_YR = SITU.BZT_YR
			   AND PSON.BZT_SNO = SITU.BZT_SNO
			   AND TTO.BZT_YR = SITU.BZT_YR
			   AND TTO.BZT_SNO = SITU.BZT_SNO
			 GROUP BY ORG.ORG_CD         
        ]]>
	</select>

	<!-- 대상기관별 감사종류별 명세  -->
	<select id="BADDED008QSelect2_2_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			/*인자값
			  1) 화면의 감사기간 년도 FROM ~ TO  --필수
			  2) 화면의 감사기간 년월 FROM ~ TO  --필수
			  3) 화면의 기관코드범위 FROM ~ TO 
			*/
			
			SELECT /*+INDEX(A, KBDCMDCMACM015001) USE_HASH(A,B)*/
			       A.BZT_YR,
			       B.ORG_CD,  
			       E.ORG_NM
			  FROM TBBADDED006L A,
			       TBBADDED008L B,
			       TBBADDED002M C,
			       TBDCMACM015M E
			 WHERE 1=1
			   AND A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /* 인자값1  화면 감사년도FROM ~ TO*/
			   AND SUBSTR(A.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#   /* 인자값2 화면 감사기간년월 */
			   AND B.BZT_YR = A.BZT_YR
			   AND B.BZT_SNO = A.BZT_SNO
		]]>			   
        <isNotEmpty property="strOrgCdSt">
	        <![CDATA[
	        	AND B.ORG_CD >=#strOrgCdSt#
	        ]]>
        </isNotEmpty>

        <isNotEmpty property="strOrgCdEnd">
	        <![CDATA[
	        	AND B.ORG_CD <=#strOrgCdEnd#
	        ]]>
        </isNotEmpty>		
        <![CDATA[
			   AND C.BZT_YR = B.BZT_YR
			   AND C.BZT_SNO = B.BZT_SNO
			   AND C.BZT_DVSN_CD = '1'
			   AND E.ORG_CD = B.ORG_CD
			 GROUP BY A.BZT_YR,
			       B.ORG_CD,
			       E.ORG_NM
        ]]>
	</select>

	<!-- 대상기관별 감사종류별 명세  -->
	<select id="BADDED008QSelect2_2_2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			SELECT F_MNG_KND_AUDYRNO(MAX(AUD_YR), MAX(AUD_NO), MAX(AUD_KND_CD), '-') AS GUBUN,
			       F_MNG_KND_AUDYRNO(MAX(AUD_YR), MAX(AUD_NO), MAX(AUD_KND_CD), '-') AS AUD_NO,
			       AA.BZT_YR,
			       AA.BZT_SNO,
			       AA.TEAM_SNO,
			       AA.AUD_STR_DT,
			       AA.AUD_END_DT,
			       AA.AUD_DCN,
			       AA.ORG_NM,
			       MAX(AA.AUD_YR) AS AUD_YR,
			       MAX(AA.AUD_NO) AS AUD_NO,
			       MAX(AA.AUD_TASK_CD) AS AUD_TASK_CD,
			       MAX(AA.ORG_DVSN_CD) AS ORG_DVSN_CD,
			       MAX(AA.AUD_KND_CD) AS AUD_KND_CD,
			       MAX(AA.SPV_BRDV_CD) AS SPV_BRDV_CD,
			       MAX(AA.AUD_WAY_CD) AS AUD_WAY_CD,
			       MAX(AA.AUD_EXEC_DVSN_CD_NM) AS AUD_EXEC_DVSN_CD_NM,
			       MAX(AA.AUD_SBJ_NM) AS AUD_SBJ_NM,
			       AA.AUD_STEP_SNO,
			       MAX(BB.IN_PSON_CNT) AS IN_PSON_CNT,
			       MAX(BB.EXT_PSON_CNT) AS EXT_PSON_CNT,
			       MAX(CC.IN_PSON_MAN_CNT) AS IN_PSON_MAN_CNT,
			       MAX(CC.EXT_PSON_MAN_CNT) AS EXT_PSON_MAN_CNT,
			       MAX(DD.IN_PSON_TOT_CNT) AS IN_PSON_TOT_CNT,
			       MAX(DD.EXT_PSON_TOT_CNT) AS EXT_PSON_TOT_CNT,
			       MIN(DD.SDATE) AS SDATE,
			       MAX(DD.EDATE) AS EDATE,
			       '' AS DAYS,
			       MAX(EE.ORG_CNT) AS ORG_CNT
			  FROM (SELECT A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               C.AUD_STEP_SNO,
			               MIN( A.AUD_STR_DT) AS AUD_STR_DT,
			               MAX(A.AUD_END_DT) AS AUD_END_DT,
			               MAX(A.AUD_DCN) AS AUD_DCN,
			               B.BGRP_TG_ORG_SNO,
			               MAX(D.AUD_YR) AS AUD_YR,
			               MAX(D.AUD_NO) AS AUD_NO,
			               MAX(D.AUD_TASK_CD) AS AUD_TASK_CD,
			               MAX(D.ORG_DVSN_CD) AS ORG_DVSN_CD,
			               MAX(D.AUD_KND_CD) AS AUD_KND_CD,
			               MAX(D.SPV_BRDV_CD) AS SPV_BRDV_CD,
			               MAX(D.AUD_WAY_CD) AS AUD_WAY_CD,
			               MAX(D.AUD_SBJ_NM) AS AUD_SBJ_NM,
			               MAX(E.ORG_NM) AS ORG_NM,
			               F_CODE_NM('1000007',MAX(D.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
			            FROM TBBADDED006L A,
			               TBBADDED008L B,
			               TBBADDED002M C,
			               TBBADDED001M D,
			               TBDCMACM015M E
			         WHERE 1=1
			           AND A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /* 인자값1  화면 감사년도FROM ~ TO*/
			           AND SUBSTR(A.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#   /* 인자값2 화면 감사기간년월 */
			           AND B.BZT_YR = A.BZT_YR
			           AND B.BZT_SNO = A.BZT_SNO
			           AND B.TEAM_SNO = A.TEAM_SNO
			           AND B.BGRP_TG_ORG_SNO = A.BGRP_TG_ORG_SNO
			           AND B.ORG_CD = #MASTER_ORG_CD#			/*MASTER의 ORG_CD*/
			           AND C.BZT_YR = B.BZT_YR
			           AND C.BZT_SNO = B.BZT_SNO
			           AND D.AUD_YR = C.REL_AUD_YR
			           AND D.AUD_NO = C.REL_AUD_NO
			           AND E.ORG_CD = B.ORG_CD
			         GROUP BY A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               B.BGRP_TG_ORG_SNO,
			               C.AUD_STEP_SNO ) AA,
			       (SELECT /*+ INDEX(A KBBADBADDED005001) */
			               BZT_YR,
			               BZT_SNO,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 1
			                     ELSE 0
			                   END) AS IN_PSON_CNT,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 0
			                     ELSE 1
			                   END) AS EXT_PSON_CNT
			          FROM (SELECT DISTINCT BZT_YR,
			                       BZT_SNO,
			                       PCT_CNB,
			                       STF_DVSN_CD
			                  FROM TBBADDED005L) A
			         GROUP BY BZT_YR,
			               BZT_SNO ) BB,
			       (SELECT  /*+ USE_NL_WITH_INDEX(A, KBBADBADDED005001)*/
			               A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               C.BGRP_TG_ORG_SNO,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN B.AUD_DCN
			                     ELSE 0
			                   END) AS IN_PSON_MAN_CNT,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 0
			                     ELSE B.AUD_DCN
			                   END) AS EXT_PSON_MAN_CNT
			          FROM TBBADDED005L A,
			               TBBADDED006L B,
			               TBBADDED008L C
			         WHERE 1 = 1
			           AND B.BZT_YR = A.BZT_YR
			           AND B.BZT_SNO = A.BZT_SNO
			           AND B.TEAM_SNO = A.TEAM_SNO
			           AND B.PCT_ALC_SNO = A.PCT_ALC_SNO
			           AND C.BZT_YR = B.BZT_YR
			           AND C.BZT_SNO = B.BZT_SNO
			           AND C.TEAM_SNO = B.TEAM_SNO
			           AND C.BGRP_TG_ORG_SNO = B.BGRP_TG_ORG_SNO
			         GROUP BY A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               C.BGRP_TG_ORG_SNO ) CC,
			       (SELECT A.BZT_YR,
			               A.BZT_SNO,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN B.AUD_DCN
			                     ELSE 0
			                   END) AS IN_PSON_TOT_CNT,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 0
			                     ELSE B.AUD_DCN
			                   END) AS EXT_PSON_TOT_CNT,
			               MIN(B.AUD_STR_DT) AS SDATE,
			               MAX(B.AUD_END_DT) AS EDATE
			          FROM TBBADDED005L A,
			               TBBADDED006L B
			         WHERE 1 = 1
			           AND B.BZT_YR = A.BZT_YR
			           AND B.BZT_SNO = A.BZT_SNO
			           AND B.TEAM_SNO = A.TEAM_SNO
			           AND B.PCT_ALC_SNO = A.PCT_ALC_SNO
			         GROUP BY A.BZT_YR,
			               A.BZT_SNO ) DD,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               COUNT(DISTINCT ORG_CD) ORG_CNT
			         FROM TBBADDED008L 
			         GROUP BY BZT_YR,
			               BZT_SNO) EE
			 WHERE 1 = 1
			   AND BB.BZT_YR = AA.BZT_YR
			   AND BB.BZT_SNO = AA.BZT_SNO
			   AND CC.BZT_YR = AA.BZT_YR
			   AND CC.BZT_SNO = AA.BZT_SNO
			   AND CC.TEAM_SNO = AA.TEAM_SNO
			   AND CC.BGRP_TG_ORG_SNO = AA.BGRP_TG_ORG_SNO
			   AND DD.BZT_YR = CC.BZT_YR
			   AND DD.BZT_SNO = CC.BZT_SNO
			   AND EE.BZT_YR = DD.BZT_YR
			   AND EE.BZT_SNO = DD.BZT_SNO
			 GROUP BY AA.BZT_YR,
			       AA.BZT_SNO,
			       AA.TEAM_SNO,
			       AA.AUD_STR_DT,
			       AA.AUD_END_DT,
			       AA.AUD_DCN,
			       AA.ORG_NM,
			       AA.AUD_STEP_SNO       
        ]]>
	</select>

	<!-- 주관국과별 감사종류별 현황  -->
	<select id="BADDED008QSelect3_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			SELECT F_DPT_INFO(AUD.SPV_BRDV_CD ,'1') DPT_NM, /*국과*/
			
			       SUM(PSON.AUD_DCN) AS AUD_DAY_TOT,  /*총계_일수*/
			       SUM(PSON.MAN_DAY ) AS MAN_DAY_TOT, /*총계_연인원*/
			       SUM (TTO.ORG_CNT ) AS ORG_CNT_TOT, /*총계_기관*/
			       COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN AUD.AUD_NO 
			                 ELSE NULL
			               END) AS AUD_ITEM_TOT, /*총계_사항*/
			               
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN PSON.AUD_DCN
			                     ELSE 0
			                   END) AS AUD_DAYS1, /*재무감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN PSON.MAN_DAY
			                     ELSE 0
			                   END) AS MAN_DAY1, /*재무감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN TTO.ORG_CNT
			                     ELSE 0
			                   END) AS ORG_CNT1, /*재무감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN AUD.AUD_NO
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT1, /*재무감사_사항*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN PSON.AUD_DCN
			                     ELSE 0
			                   END) AS AUD_DAYS2, /*특정과제감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN PSON.MAN_DAY
			                     ELSE 0
			                   END) AS MAN_DAY2, /*특정과제감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN TTO.ORG_CNT
			                     ELSE 0
			                   END) AS ORG_CNT2, /*특정과제감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN AUD.AUD_NO
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT2, /*특정과제감사_사항*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN PSON.AUD_DCN
			                     ELSE 0
			                   END) AS AUD_DAYS3, /*사업성과감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN PSON.MAN_DAY
			                     ELSE 0
			                   END) AS MAN_DAY3,  /*사업성과감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN TTO.ORG_CNT
			                     ELSE 0
			                   END) AS ORG_CNT3,  /*사업성과감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN AUD.AUD_NO
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT3,  /*사업성과감사_기관*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN PSON.AUD_DCN
			                     ELSE 0
			                   END) AS AUD_DAYS4, /*기업운영성과감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN PSON.MAN_DAY
			                     ELSE 0
			                   END) AS MAN_DAY4, /*기업운영성과감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN TTO.ORG_CNT
			                     ELSE 0
			                   END) AS ORG_CNT4, /*기업운영성과감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN AUD.AUD_NO
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT4, /*기업운영성과감사_사항*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN PSON.AUD_DCN 
			                     ELSE 0
			                   END) AS AUD_DAYS5, /*기타감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN PSON.MAN_DAY 
			                     ELSE 0
			                   END) AS MAN_DAY5, /*기타감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN TTO.ORG_CNT 
			                     ELSE 0
			                   END) AS ORG_CNT5, /*기타감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN AUD.AUD_NO 
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT5 /*기타감사_사항*/
			  FROM TBBADDED002M SITU,
			       TBBADDED001M AUD,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               MIN(AUD_STR_DT) AS AUD_STR_DT,
			               MAX(AUD_END_DT) AS AUD_END_DT,
			               MAX(AUD_DCN) AS AUD_DCN,
			               SUM(AUD_DCN) AS MAN_DAY
			          FROM (SELECT TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB,
			                       MIN(PTD.AUD_STR_DT) AS AUD_STR_DT,
			                       MAX(PTD.AUD_END_DT) AS AUD_END_DT,
			                       SUM(PTD.AUD_DCN) AS AUD_DCN
			                  FROM TBBADDED005L TMA,
			                       TBBADDED006L PTD
			                 WHERE PTD.BZT_YR = TMA.BZT_YR
			                   AND PTD.BZT_SNO = TMA.BZT_SNO
			                   AND PTD.TEAM_SNO = TMA.TEAM_SNO
			                   AND PTD.PCT_ALC_SNO = TMA.PCT_ALC_SNO
			                   AND PTD.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY#   /*화면 감사년도 FROM ~ TO*/
			                   AND SUBSTR(PTD.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면 감사기간 FROM ~ TO*/
			                 GROUP BY TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB) PTD1
			         GROUP BY BZT_YR,
			               BZT_SNO ) PSON,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               COUNT(*) AS ORG_CNT
			          FROM (SELECT DISTINCT BZT_YR,
			                       BZT_SNO,
			                       BGRP_TG_ORG_SNO
			                  FROM TBBADDED008L
			                 WHERE SUBSTR(AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#    /*화면 감사기간 FROM ~ TO*/
			               ) TTO0
			         GROUP BY BZT_YR,
			               BZT_SNO ) TTO
			 WHERE AUD.AUD_YR BETWEEN #strBztStYY# AND #strBztEndYY#   /*화면 감사년도 FROM ~ TO*/
			   AND SITU.REL_AUD_YR = AUD.AUD_YR
			   AND SITU.REL_AUD_NO = AUD.AUD_NO
			   AND SITU.BZT_DVSN_CD ='1'
			   AND PSON.BZT_YR = SITU.BZT_YR
			   AND PSON.BZT_SNO = SITU.BZT_SNO
			   AND TTO.BZT_YR = SITU.BZT_YR
			   AND TTO.BZT_SNO = SITU.BZT_SNO
		]]>
		<isNotEmpty property="strSpvBrdvCd">
			   AND SUBSTR(AUD.SPV_BRDV_CD,1,3) = SUBSTR(#strSpvBrdvCd#,1,3) 	/*화면 주관실국*/
		</isNotEmpty>			   
        <![CDATA[  			   
			 GROUP BY AUD.SPV_BRDV_CD
        ]]>
	</select>
	
	
	<!-- 주관국과별 감사종류별 명세1  -->
	<select id="BADDED008QSelect3_2_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			 SELECT A.BZT_YR,
			       D.SPV_BRDV_CD,
			       E.DPT_NM
			  FROM TBBADDED006L A,
			       TBBADDED008L B,
			       TBBADDED002M C,
			       TBBADDED001M D,
			       (SELECT DPT_NM,
			               DPT_CD
			          FROM TBDCMACM002M
			         WHERE USE_YN = 'Y') E
			 WHERE 1=1
			   AND A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY#  
			   AND SUBSTR(A.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  
			   AND B.BZT_YR = A.BZT_YR
			   AND B.BZT_SNO = A.BZT_SNO
			   AND C.BZT_YR = B.BZT_YR
			   AND C.BZT_SNO = B.BZT_SNO
			   AND C.BZT_DVSN_CD = '1'
			   AND D.AUD_YR = C.REL_AUD_YR
			   AND D.AUD_NO = C.REL_AUD_NO
			   AND SUBSTR(D.SPV_BRDV_CD, 1, 3) = SUBSTR(#strSpvBrdvCd#,1,3)   
			   AND E.DPT_CD = D.SPV_BRDV_CD
			 GROUP BY A.BZT_YR,
			       D.SPV_BRDV_CD,
			       E.DPT_NM        
        ]]>
	</select>	

	<!-- 주관국과별 감사종류별 명세2  -->
	<select id="BADDED008QSelect3_2_2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			SELECT F_MNG_KND_AUDYRNO(MAX(AUD_YR), MAX(AUD_NO), MAX(AUD_KND_CD), '-') AS GUBUN,
			       F_MNG_KND_AUDYRNO(MAX(AUD_YR), MAX(AUD_NO), MAX(AUD_KND_CD), '-') AS AUD_NO,
			       AA.BZT_YR,
			       AA.BZT_SNO,
			       AA.TEAM_SNO,
			       AA.AUD_STR_DT,
			       AA.AUD_END_DT,
			       AA.AUD_DCN,
			       AA.ORG_NM,
			       MAX(AA.AUD_YR) AS AUD_YR,
			       MAX(AA.AUD_NO) AS AUD_NO,
			       MAX(AA.AUD_TASK_CD) AS AUD_TASK_CD,
			       MAX(AA.ORG_DVSN_CD) AS ORG_DVSN_CD,
			       MAX(AA.AUD_KND_CD) AS AUD_KND_CD,
			       MAX(AA.SPV_BRDV_CD) AS SPV_BRDV_CD,
			       MAX(AA.AUD_WAY_CD) AS AUD_WAY_CD,
			       MAX(AA.AUD_EXEC_DVSN_CD_NM) AS AUD_EXEC_DVSN_CD_NM,
			       MAX(AA.AUD_SBJ_NM) AS AUD_SBJ_NM,
			       AA.AUD_STEP_SNO,
			       MAX(BB.IN_PSON_CNT) AS IN_PSON_CNT,
			       MAX(BB.EXT_PSON_CNT) AS EXT_PSON_CNT,
			       MAX(CC.IN_PSON_MAN_CNT) AS IN_PSON_MAN_CNT,
			       MAX(CC.EXT_PSON_MAN_CNT) AS EXT_PSON_MAN_CNT,
			       MAX(DD.IN_PSON_TOT_CNT) AS IN_PSON_TOT_CNT,
			       MAX(DD.EXT_PSON_TOT_CNT) AS EXT_PSON_TOT_CNT,
			       MIN(DD.SDATE) AS SDATE,
			       MAX(DD.EDATE) AS EDATE,
			       '' AS DAYS,
			       MAX(EE.ORG_CNT) AS ORG_CNT
			  FROM (SELECT A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               C.AUD_STEP_SNO,
			               MIN( A.AUD_STR_DT) AS AUD_STR_DT,
			               MAX(A.AUD_END_DT) AS AUD_END_DT,
			               MAX(A.AUD_DCN) AS AUD_DCN,
			               B.BGRP_TG_ORG_SNO,
			               MAX(D.AUD_YR) AS AUD_YR,
			               MAX(D.AUD_NO) AS AUD_NO,
			               MAX(D.AUD_TASK_CD) AS AUD_TASK_CD,
			               MAX(D.ORG_DVSN_CD) AS ORG_DVSN_CD,
			               MAX(D.AUD_KND_CD) AS AUD_KND_CD,
			               MAX(D.SPV_BRDV_CD) AS SPV_BRDV_CD,
			               MAX(D.AUD_WAY_CD) AS AUD_WAY_CD,
			               MAX(D.AUD_SBJ_NM) AS AUD_SBJ_NM,
			               MAX(E.ORG_NM) AS ORG_NM,
			               F_CODE_NM('1000007',MAX(D.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
			          FROM TBBADDED006L A,
			               TBBADDED008L B,
			               TBBADDED002M C,
			               TBBADDED001M D,
			               TBDCMACM015M E 
			         WHERE 1=1
			           AND A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY#  
			           AND SUBSTR(A.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  
			           AND B.BZT_YR = A.BZT_YR
			           AND B.BZT_SNO = A.BZT_SNO
			           AND B.TEAM_SNO = A.TEAM_SNO
			           AND B.BGRP_TG_ORG_SNO = A.BGRP_TG_ORG_SNO
			           AND C.BZT_YR = B.BZT_YR
			           AND C.BZT_SNO = B.BZT_SNO
			           AND D.AUD_YR = C.REL_AUD_YR
			           AND D.AUD_NO = C.REL_AUD_NO
			           AND D.SPV_BRDV_CD = #MASTER_SPV_BRDV_CD#   
			           AND E.ORG_CD = B.ORG_CD
			         GROUP BY A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               B.BGRP_TG_ORG_SNO,
			               C.AUD_STEP_SNO ) AA,
			       (SELECT /*+ INDEX(A KBBADBADDED005001) */
			               BZT_YR,
			               BZT_SNO,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 1
			                     ELSE 0
			                   END) AS IN_PSON_CNT,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 0
			                     ELSE 1
			                   END) AS EXT_PSON_CNT
			          FROM (SELECT DISTINCT BZT_YR,
			                       BZT_SNO,
			                       PCT_CNB,
			                       STF_DVSN_CD
			                  FROM TBBADDED005L) A
			         GROUP BY BZT_YR,
			               BZT_SNO ) BB,
			       (SELECT /*+ USE_NL_WITH_INDEX(A, KBBADBADDED005001)*/
			               A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               C.BGRP_TG_ORG_SNO,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN B.AUD_DCN
			                     ELSE 0
			                   END) AS IN_PSON_MAN_CNT,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 0
			                     ELSE B.AUD_DCN
			                   END) AS EXT_PSON_MAN_CNT
			          FROM TBBADDED005L A,
			               TBBADDED006L B,
			               TBBADDED008L C
			         WHERE 1 = 1
			           AND B.BZT_YR = A.BZT_YR
			           AND B.BZT_SNO = A.BZT_SNO
			           AND B.TEAM_SNO = A.TEAM_SNO
			           AND B.PCT_ALC_SNO = A.PCT_ALC_SNO
			           AND C.BZT_YR = B.BZT_YR
			           AND C.BZT_SNO = B.BZT_SNO
			           AND C.TEAM_SNO = B.TEAM_SNO
			           AND C.BGRP_TG_ORG_SNO = B.BGRP_TG_ORG_SNO
			         GROUP BY A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               C.BGRP_TG_ORG_SNO ) CC,
			       (SELECT 
			               A.BZT_YR,
			               A.BZT_SNO,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN B.AUD_DCN
			                     ELSE 0
			                   END) AS IN_PSON_TOT_CNT,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 0
			                     ELSE B.AUD_DCN
			                   END) AS EXT_PSON_TOT_CNT,
			               MIN(B.AUD_STR_DT) AS SDATE,
			               MAX(B.AUD_END_DT) AS EDATE
			          FROM TBBADDED005L A,
			               TBBADDED006L B
			         WHERE 1 = 1
			           AND B.BZT_YR = A.BZT_YR
			           AND B.BZT_SNO = A.BZT_SNO
			           AND B.TEAM_SNO = A.TEAM_SNO
			           AND B.PCT_ALC_SNO = A.PCT_ALC_SNO
			         GROUP BY A.BZT_YR,
			               A.BZT_SNO ) DD,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               COUNT(DISTINCT ORG_CD) ORG_CNT
			         FROM TBBADDED008L 
			         GROUP BY BZT_YR,
			               BZT_SNO) EE
			 WHERE 1 = 1
			   AND BB.BZT_YR = AA.BZT_YR
			   AND BB.BZT_SNO = AA.BZT_SNO
			   AND CC.BZT_YR = AA.BZT_YR
			   AND CC.BZT_SNO = AA.BZT_SNO
			   AND CC.TEAM_SNO = AA.TEAM_SNO
			   AND CC.BGRP_TG_ORG_SNO = AA.BGRP_TG_ORG_SNO
			   AND DD.BZT_YR = CC.BZT_YR
			   AND DD.BZT_SNO = CC.BZT_SNO
			   AND EE.BZT_YR = DD.BZT_YR
			   AND EE.BZT_SNO = DD.BZT_SNO
			 GROUP BY AA.BZT_YR,
			       AA.BZT_SNO,
			       AA.TEAM_SNO,
			       AA.AUD_STR_DT,
			       AA.AUD_END_DT,
			       AA.AUD_DCN,
			       AA.ORG_NM,
			       AA.AUD_STEP_SNO         
        ]]>
	</select>	

	<!-- 감사방침별 기관구분별 현황  -->
	<select id="BADDED008QSelect4_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			SELECT  F_CODE_NM('1000008',AUD.AUD_TASK_CD) STRTG_GOAL_NM,  /*감사방침*/
			        SUM(PSON.AUD_DCN) AS AUD_DAY_TOT,  /*총계_일수 */
			        SUM(PSON.MAN_DAY ) AS MAN_DAY_TOT, /*총계_연인원*/
			        SUM (TTO.ORG_CNT ) AS ORG_CNT_TOT,  /*총계_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD >'30' THEN AUD.AUD_NO 
			                 ELSE NULL
			               END) AS AUD_ITEM_TOT, /*총계_사항 */
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN PSON.AUD_DCN
			                 ELSE 0
			               END) AS AUD_DAYS1,  /*국가기관_일수*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN PSON.MAN_DAY
			                 ELSE 0
			               END) AS MAN_DAY1, /*국가기관_연인원*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN TTO.ORG_CNT
			                 ELSE 0
			               END) AS ORG_CNT1, /*국가기관_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) AS AUD_ITEM_CNT1,  /*국가기관_사항*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN PSON.AUD_DCN
			                 ELSE 0
			               END) AS AUD_DAYS2, /*자치단체_일수*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN PSON.MAN_DAY
			                 ELSE 0
			               END) AS MAN_DAY2, /*자치단체_연인원*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN TTO.ORG_CNT
			                 ELSE 0
			               END) AS ORG_CNT2, /*자치단체_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN AUD.AUD_NO
			                 ELSE NULL
			               END) AS AUD_ITEM_CNT2, /*자치단체_사항*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN PSON.AUD_DCN
			                 ELSE 0
			               END) AS AUD_DAYS3, /*투자기관_일수*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN PSON.MAN_DAY
			                 ELSE 0
			               END) AS MAN_DAY3, /*투자기관_연인원*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN TTO.ORG_CNT
			                 ELSE 0
			               END) AS ORG_CNT3, /*투자기관_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) AS AUD_ITEM_CNT3, /*투자기관_사항*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD >'30' THEN PSON.AUD_DCN 
			                 ELSE 0
			               END) AS AUD_DAYS4, /*기타기관_일수*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD >'30' THEN PSON.MAN_DAY 
			                 ELSE 0
			               END) AS MAN_DAY4, /*기타기관_연인원*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD >'30' THEN TTO.ORG_CNT 
			                 ELSE 0
			               END) AS ORG_CNT4, /*기타기관_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD  >'30' THEN AUD.AUD_NO 
			                 ELSE NULL
			               END) AS AUD_ITEM_CNT4 /*기타기관_사항*/
			  FROM TBBADDED002M SITU,
			       TBBADDED001M AUD,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               MIN(AUD_STR_DT) AS AUD_STR_DT,
			               MAX(AUD_END_DT) AS AUD_END_DT,
			               MAX(AUD_DCN) AS AUD_DCN,
			               SUM(AUD_DCN) AS MAN_DAY
			          FROM (SELECT TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB,
			                       MIN(PTD.AUD_STR_DT) AS AUD_STR_DT,
			                       MAX(PTD.AUD_END_DT) AS AUD_END_DT,
			                       SUM(PTD.AUD_DCN) AS AUD_DCN
			                  FROM TBBADDED005L TMA,
			                       TBBADDED006L PTD
			                 WHERE PTD.BZT_YR = TMA.BZT_YR
			                   AND PTD.BZT_SNO = TMA.BZT_SNO
			                   AND PTD.TEAM_SNO = TMA.TEAM_SNO
			                   AND PTD.PCT_ALC_SNO = TMA.PCT_ALC_SNO
			                   AND PTD.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# /*화면 감사년도 */
			                   AND SUBSTR(PTD.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#    /*화면 감사기간*/
			                 GROUP BY TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB) PTD1
			         GROUP BY BZT_YR,
			               BZT_SNO ) PSON,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               COUNT(*) AS ORG_CNT
			          FROM (SELECT DISTINCT BZT_YR,
			                       BZT_SNO,
			                       BGRP_TG_ORG_SNO
			                  FROM TBBADDED008L
			                 WHERE SUBSTR(AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면 감사기간*/
			                 ) TTO0
			         GROUP BY BZT_YR,
			               BZT_SNO ) TTO
			 WHERE AUD.AUD_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /*화면 감사년도*/
			   AND SITU.REL_AUD_YR = AUD.AUD_YR
			   AND SITU.REL_AUD_NO = AUD.AUD_NO
			   AND SITU.BZT_DVSN_CD ='1'
			   AND PSON.BZT_YR = SITU.BZT_YR
			   AND PSON.BZT_SNO = SITU.BZT_SNO
			   AND TTO.BZT_YR = SITU.BZT_YR
			   AND TTO.BZT_SNO = SITU.BZT_SNO
			   AND SUBSTR(AUD.AUD_TASK_CD,-1) BETWEEN #strAudTaskCdSt# AND #strAudTaskCdEnd#  /*화면 감사지침 1~9*/
			 GROUP BY AUD.AUD_YR,
			       AUD.AUD_TASK_CD         
        ]]>
	</select>	
	
	<!--  감사방침별 기관구분별 명세  -->
	<select id="BADDED008QSelect4_2_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			SELECT A.AUD_TASK_CD,
			       A.AUD_YR,
			       F_CODE_NM('1000008',A.AUD_TASK_CD) STRTG_GOAL_NM  
			  FROM TBBADDED001M A,
			       TBBADDED002M B,
			       TBBADDED008L C
			 WHERE A.AUD_YR BETWEEN #strBztStYY# AND #strBztEndYY#  
			   AND SUBSTR(A.AUD_TASK_CD, -1) BETWEEN #strAudTaskCdSt# AND #strAudTaskCdEnd# 
			   AND B.REL_AUD_YR = A.AUD_YR
			   AND B.REL_AUD_NO = A.AUD_NO
			   AND B.BZT_DVSN_CD = '1'
			   AND C.BZT_YR = B.BZT_YR
			   AND C.BZT_SNO = B.BZT_SNO
			   AND C.AUD_STR_DT BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  
			 GROUP BY A.AUD_TASK_CD,
			       A.AUD_YR 
        ]]>
	</select>	

	<!-- 주관국과별 감사종류별 명세  -->
	<select id="BADDED008QSelect4_2_2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			SELECT MAX(X.AUD_YR) AS AUD_YR,
			       MAX(X.AUD_NO) AS AUD_NO,
			       MAX(X.AUD_TASK_CD) AS AUD_TASK_CD,
			       X.ORG_DVSN_CD,
			       MAX(X.BZT_YR) AS BZT_YR,
			       MAX(X.BZT_SNO) AS BZT_SNO,
			       SUM(X.ORG_CNT) AS ORG_TOT_CNT,
			       SUM(X.IN_PSON_MAN_CNT) AS IN_PSON_TOT_CNT,
			       SUM(X.EXT_PSON_MAN_CNT) AS EXT_PSON_TOT_CNT,       
			       F_CODE_NM('1000119',X.ORG_DVSN_CD) ORG_TYPE_NM,  /*기관구분명*/
			       COUNT(*) AS CNT
			  FROM (SELECT AA.AUD_YR,
			               AA.AUD_NO,
			               AA.AUD_TASK_CD,
			               AA.ORG_DVSN_CD,
			               AA.BZT_YR,
			               AA.BZT_SNO,
			               BB. ORG_CNT,
			               CC.IN_PSON_MAN_CNT,
			               CC.EXT_PSON_MAN_CNT
			          FROM (SELECT A.AUD_YR,
			                       A.AUD_NO,
			                       MAX(A.AUD_TASK_CD) AS AUD_TASK_CD,
			                       A.ORG_DVSN_CD,
			                       MAX(C.BZT_YR) AS BZT_YR,
			                       MAX(C.BZT_SNO) AS BZT_SNO
			                  FROM TBBADDED001M A,
			                       TBBADDED002M B,
			                       TBBADDED008L C
			                 WHERE A.AUD_YR = #MASTER_AUD_YR#
			                   AND A.AUD_TASK_CD = #MASTER_AUD_TASK_CD# 
			                   AND B.REL_AUD_YR = A.AUD_YR
			                   AND B.REL_AUD_NO = A.AUD_NO
			                   AND B.BZT_DVSN_CD = '1'
			                   AND C.BZT_YR = B.BZT_YR
			                   AND C.BZT_SNO = B.BZT_SNO
			                   AND C.AUD_STR_DT BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM# 
			                 GROUP BY A.AUD_YR,
			                       A.AUD_NO,
			                       A.ORG_DVSN_CD) AA,
			               (SELECT BZT_YR,
			                       BZT_SNO,
			                       COUNT(DISTINCT ORG_CD) ORG_CNT,
			                       MIN(AUD_STR_DT) AUD_STR_DT,
			                       MAX(AUD_END_DT) AUD_END_DT
			                 FROM TBBADDED008L
			                 GROUP BY BZT_YR,
			                          BZT_SNO) BB,
			               (SELECT A.BZT_YR,
			                       A.BZT_SNO,
			                       SUM(
			                           CASE
			                             WHEN A.STF_DVSN_CD = '0' THEN B.AUD_DCN
			                             ELSE 0
			                           END) AS IN_PSON_MAN_CNT,
			                       SUM(
			                           CASE
			                             WHEN A.STF_DVSN_CD = '0' THEN 0
			                             ELSE B.AUD_DCN
			                           END) AS EXT_PSON_MAN_CNT,
			                       MIN(B.AUD_STR_DT) AS AUD_STR_DT,
			                       MAX(B.AUD_END_DT) AS AUD_END_DT,
			                       MAX(B.AUD_DCN) AS AUD_DCN
			                  FROM TBBADDED005L A,
			                       TBBADDED006L B
			                 WHERE B.BZT_YR = A.BZT_YR
			                   AND B.BZT_SNO = A.BZT_SNO
			                   AND B.TEAM_SNO = A.TEAM_SNO
			                   AND B.PCT_ALC_SNO = A.PCT_ALC_SNO
			                 GROUP BY A.BZT_YR,
			                       A.BZT_SNO ) CC
			         WHERE 1=1
			           AND BB.BZT_YR(+) = AA.BZT_YR
			           AND BB.BZT_SNO(+) = AA.BZT_SNO
			           AND CC.BZT_YR(+) = AA.BZT_YR
			           AND CC.BZT_SNO(+) = AA.BZT_SNO ) X
			 GROUP BY ORG_DVSN_CD,
			          X.ORG_DVSN_CD 
        ]]>
	</select>			
	
	<!-- 주관국과별 감사종류별 명세  -->
	<select id="BADDED008QSelect4_2_3" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  
			SELECT F_MNG_KND_AUDYRNO(MAX(AUD_YR), MAX(AUD_NO), MAX(AUD_KND_CD), '-') AS GUBUN,
			       F_MNG_KND_AUDYRNO(MAX(AUD_YR), MAX(AUD_NO), MAX(AUD_KND_CD), '-') AS FULL_AUD_NO,
			       AA.BZT_YR,
			       AA.BZT_SNO,
			       AA.TEAM_SNO,
			       AA.AUD_STR_DT,
			       AA.AUD_END_DT,
			       AA.AUD_DCN,
			       AA.ORG_NM,
			       MAX(AA.AUD_YR) AS AUD_YR,
			       MAX(AA.AUD_NO) AS AUD_NO,
			       MAX(AA.AUD_TASK_CD) AS AUD_TASK_CD,
			       MAX(AA.ORG_DVSN_CD) AS ORG_DVSN_CD,
			       MAX(AA.AUD_KND_CD) AS AUD_KND_CD,
			       MAX(AA.SPV_BRDV_CD) AS SPV_BRDV_CD,
			       MAX(AA.AUD_WAY_CD) AS AUD_WAY_CD,
			       MAX(AA.AUD_EXEC_DVSN_CD_NM) AS AUD_EXEC_DVSN_CD_NM,
			       MAX(AA.AUD_SBJ_NM) AS AUD_SBJ_NM,
			       AA.AUD_STEP_SNO,
			       MAX(BB.IN_PSON_CNT) AS IN_PSON_CNT,
			       MAX(BB.EXT_PSON_CNT) AS EXT_PSON_CNT,
			       MAX(CC.IN_PSON_MAN_CNT) AS IN_PSON_MAN_CNT,
			       MAX(CC.EXT_PSON_MAN_CNT) AS EXT_PSON_MAN_CNT,
			       MAX(DD.IN_PSON_TOT_CNT) AS IN_PSON_TOT_CNT,
			       MAX(DD.EXT_PSON_TOT_CNT) AS EXT_PSON_TOT_CNT,
			       MIN(DD.SDATE) AS SDATE,
			       MAX(DD.EDATE) AS EDATE,
			       '' AS DAYS,
			       MAX(EE.ORG_CNT) AS ORG_CNT
			  FROM (SELECT A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               C.AUD_STEP_SNO,
			               MIN( A.AUD_STR_DT) AS AUD_STR_DT,
			               MAX(A.AUD_END_DT) AS AUD_END_DT,
			               MAX(A.AUD_DCN) AS AUD_DCN,
			               B.BGRP_TG_ORG_SNO,
			               MAX(D.AUD_YR) AS AUD_YR,
			               MAX(D.AUD_NO) AS AUD_NO,
			               MAX(D.AUD_TASK_CD) AS AUD_TASK_CD,
			               MAX(D.ORG_DVSN_CD) AS ORG_DVSN_CD,
			               MAX(D.AUD_KND_CD) AS AUD_KND_CD,
			               MAX(D.SPV_BRDV_CD) AS SPV_BRDV_CD,
			               MAX(D.AUD_WAY_CD) AS AUD_WAY_CD,
			               MAX(D.AUD_SBJ_NM) AS AUD_SBJ_NM,
			               MAX(E.ORG_NM) AS ORG_NM,               
			               F_CODE_NM('1000007',MAX(D.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
			          FROM TBBADDED006L A,
			               TBBADDED008L B,
			               TBBADDED002M C,
			               TBBADDED001M D,
			               TBDCMACM015M E
			
			         WHERE 1=1
			           AND A.BZT_YR = #SUB1_BZT_YR#   
			           AND SUBSTR(A.AUD_STR_DT, 1, 6) BETWEEN  #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM# 
			           AND B.BZT_YR = A.BZT_YR
			           AND B.BZT_SNO = A.BZT_SNO
			           AND B.TEAM_SNO = A.TEAM_SNO
			           AND B.BGRP_TG_ORG_SNO = A.BGRP_TG_ORG_SNO
			           AND C.BZT_YR = B.BZT_YR
			           AND C.BZT_SNO = B.BZT_SNO
			           AND D.AUD_YR = C.REL_AUD_YR
			           AND D.AUD_NO = C.REL_AUD_NO
			           AND D.AUD_TASK_CD = #SUB1_AUD_TASK_CD#
			           AND D.ORG_DVSN_CD = #SUB1_ORG_DVSN_CD#
			           AND E.ORG_CD = B.ORG_CD
			         GROUP BY A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               B.BGRP_TG_ORG_SNO,
			               C.AUD_STEP_SNO ) AA,
			       (SELECT /*+ INDEX(A KBBADBADDED005001) */
			               BZT_YR,
			               BZT_SNO,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 1
			                     ELSE 0
			                   END) AS IN_PSON_CNT,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 0
			                     ELSE 1
			                   END) AS EXT_PSON_CNT
			          FROM (SELECT DISTINCT BZT_YR,
			                       BZT_SNO,
			                       PCT_CNB,
			                       STF_DVSN_CD
			                  FROM TBBADDED005L) A
			         GROUP BY BZT_YR,
			               BZT_SNO ) BB,
			       (SELECT /*+ USE_NL_WITH_INDEX(A, KBBADBADDED005001)*/
			               A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               C.BGRP_TG_ORG_SNO,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN B.AUD_DCN
			                     ELSE 0
			                   END) AS IN_PSON_MAN_CNT,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 0
			                     ELSE B.AUD_DCN
			                   END) AS EXT_PSON_MAN_CNT
			          FROM TBBADDED005L A,
			               TBBADDED006L B,
			               TBBADDED008L C
			         WHERE 1 = 1
			           AND B.BZT_YR = A.BZT_YR
			           AND B.BZT_SNO = A.BZT_SNO
			           AND B.TEAM_SNO = A.TEAM_SNO
			           AND B.PCT_ALC_SNO = A.PCT_ALC_SNO
			           AND C.BZT_YR = B.BZT_YR
			           AND C.BZT_SNO = B.BZT_SNO
			           AND C.TEAM_SNO = B.TEAM_SNO
			           AND C.BGRP_TG_ORG_SNO = B.BGRP_TG_ORG_SNO
			         GROUP BY A.BZT_YR,
			               A.BZT_SNO,
			               A.TEAM_SNO,
			               C.BGRP_TG_ORG_SNO ) CC,
			       (SELECT A.BZT_YR,
			               A.BZT_SNO,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN B.AUD_DCN
			                     ELSE 0
			                   END) AS IN_PSON_TOT_CNT,
			               SUM(
			                   CASE
			                     WHEN A.STF_DVSN_CD = '0' THEN 0
			                     ELSE B.AUD_DCN
			                   END) AS EXT_PSON_TOT_CNT,
			               MIN(B.AUD_STR_DT) AS SDATE,
			               MAX(B.AUD_END_DT) AS EDATE
			          FROM TBBADDED005L A,
			               TBBADDED006L B
			         WHERE 1 = 1
			           AND B.BZT_YR = A.BZT_YR
			           AND B.BZT_SNO = A.BZT_SNO
			           AND B.TEAM_SNO = A.TEAM_SNO
			           AND B.PCT_ALC_SNO = A.PCT_ALC_SNO
			         GROUP BY A.BZT_YR,
			               A.BZT_SNO ) DD,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               COUNT(DISTINCT ORG_CD) ORG_CNT
			         FROM TBBADDED008L 
			         GROUP BY BZT_YR,
			               BZT_SNO) EE
			 WHERE 1 = 1
			   AND BB.BZT_YR = AA.BZT_YR
			   AND BB.BZT_SNO = AA.BZT_SNO
			   AND CC.BZT_YR = AA.BZT_YR
			   AND CC.BZT_SNO = AA.BZT_SNO
			   AND CC.TEAM_SNO = AA.TEAM_SNO
			   AND CC.BGRP_TG_ORG_SNO = AA.BGRP_TG_ORG_SNO
			   AND DD.BZT_YR = CC.BZT_YR
			   AND DD.BZT_SNO = CC.BZT_SNO
			   AND EE.BZT_YR = DD.BZT_YR
			   AND EE.BZT_SNO = DD.BZT_SNO
			 GROUP BY AA.BZT_YR,
			       AA.BZT_SNO,
			       AA.TEAM_SNO,
			       AA.AUD_STR_DT,
			       AA.AUD_END_DT,
			       AA.AUD_DCN,
			       AA.ORG_NM,
			       AA.AUD_STEP_SNO 
        ]]>
	</select>		
	
	<!-- 감사종류별 명세  -->
	<select id="BADDED008QSelect1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  	
			 SELECT   
			         AUD_YR
			        ,AUD_NO
			        ,AUD_KND_CD
			        ,AUD_EXEC_DVSN_CD_NM
			        ,AUD_ITEM_CNT
			        ,PSON_CNT
			        ,A_ORG_CNT 
			        ,MAN_DAY
			        ,A_IN_PSON_CNT 
			        ,EXT_PSON_CNT
			        ,EXT_PSON1_CNT
			        ,EXT_PSON2_CNT
			        ,IN_PSON_MAN_DAY
			        ,EXT_PSON_MAN_DAY
			        ,IN_PSON_TYPE1_MAN_DAY
			        ,IN_PSON_TYPE2_MAN_DAY
			        ,IN_PSON_TYPE3_MAN_DAY
			        ,IN_PSON_TYPE4_MAN_DAY
			        ,EXT_PSON_TYPE1_MAN_DAY
			        ,EXT_PSON_TYPE2_MAN_DAY
			        ,EXT_PSON_TYPE3_MAN_DAY
			        ,EXT_PSON_TYPE4_MAN_DAY
			        ,ORG_TYPE1_CNT
			        ,ORG_TYPE2_CNT
			        ,ORG_TYPE3_CNT
			        ,ORG_TYPE4_CNT
			        ,AUD_SNO
			        ,AUD_SBJ_NM
			        ,C_ORG_CNT
			        ,SDATE
			        ,EDATE
			        ,DAYS
			        ,IN_PSON_MAN_TOT
			        ,EXT_PSON_MAN_TOT
			        ,ORG_NM
			        ,CD_NM
			        ,AUD_SDATE
			        ,AUD_EDATE
			        ,AUD_DAYS
			        ,C_IN_PSON_CNT 
			        ,C_EXT_PSON_CNT 
			        ,C_IN_PSON_MAN_DAY
			        ,C_EXT_PSON_MAN_DAY
			        ,D_ORG_CNT 
			        ,ORG_TYPE_1_CNT
			        ,ORG_TYPE_2_CNT
			        ,ORG_TYPE_3_CNT
			        ,ORG_TYPE_4_CNT
			        ,DAYS1 AS  DAYS
			        ,D_IN_PSON_CNT  
			        ,D_EXT_PSON_CNT 
			        ,D_IN_PSON_MAN_DAY 
			        ,D_EXT_PSON_MAN_DAY 
			        ,IN_PSON_MAN_DAY_1_TOT
			        ,IN_PSON_MAN_DAY_2_TOT
			        ,IN_PSON_MAN_DAY_3_TOT
			        ,IN_PSON_MAN_DAY_4_TOT
			        ,EXT_PSON_MAN_DAY_1_TOT
			        ,EXT_PSON_MAN_DAY_2_TOT
			        ,EXT_PSON_MAN_DAY_3_TOT
			        ,EXT_PSON_MAN_DAY_4_TOT
			   FROM TBBADDED029L
			  WHERE DVSN_CD = '1'
			    AND SUBSTR(AUD_SDATE,1,6) BETWEEN #strBztStYY# || #strBztStMM#  AND #strBztEndYY# || #strBztEndMM#
        ]]>
	</select>		
	<select id="BADDED008QSelect1_tmp" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  	
			 SELECT   /*+no_merge leading(a,b,c,d)*/
			         B.AUD_YR
			        ,B.AUD_NO
			        ,B.AUD_KND_CD
			        ,A.AUD_EXEC_DVSN_CD_NM
			        ,A.AUD_ITEM_CNT
			        ,A.PSON_CNT
			        ,A.ORG_CNT A_ORG_CNT  /*메인 기관수*/
			        ,A.MAN_DAY
			        ,A.IN_PSON_CNT A_IN_PSON_CNT
			        ,A.EXT_PSON_CNT
			        ,A.EXT_PSON1_CNT
			        ,A.EXT_PSON2_CNT
			        ,A.IN_PSON_MAN_DAY
			        ,A.EXT_PSON_MAN_DAY
			        ,A.IN_PSON_TYPE1_MAN_DAY
			        ,A.IN_PSON_TYPE2_MAN_DAY
			        ,A.IN_PSON_TYPE3_MAN_DAY
			        ,A.IN_PSON_TYPE4_MAN_DAY
			        ,A.EXT_PSON_TYPE1_MAN_DAY
			        ,A.EXT_PSON_TYPE2_MAN_DAY
			        ,A.EXT_PSON_TYPE3_MAN_DAY
			        ,A.EXT_PSON_TYPE4_MAN_DAY
			        ,A.ORG_TYPE1_CNT
			        ,A.ORG_TYPE2_CNT
			        ,A.ORG_TYPE3_CNT
			        ,A.ORG_TYPE4_CNT
			        ,C.AUD_SNO
			        ,C.AUD_SBJ_NM
			        ,C.ORG_CNT AS C_ORG_CNT
			        ,C.SDATE
			        ,C.EDATE
			        ,C.DAYS
			        ,C.IN_PSON_MAN_TOT
			        ,C.EXT_PSON_MAN_TOT
			        ,C.ORG_NM
			        ,C.CD_NM
			        ,C.AUD_SDATE
			        ,C.AUD_EDATE
			        ,C.AUD_DAYS
			        ,C.IN_PSON_CNT  AS C_IN_PSON_CNT
			        ,C.EXT_PSON_CNT AS C_EXT_PSON_CNT
			        ,C.IN_PSON_MAN_DAY AS C_IN_PSON_MAN_DAY
			        ,C.EXT_PSON_MAN_DAY AS C_EXT_PSON_MAN_DAY
			        ,D.ORG_CNT AS D_ORG_CNT
			        ,D.ORG_TYPE_1_CNT
			        ,D.ORG_TYPE_2_CNT
			        ,D.ORG_TYPE_3_CNT
			        ,D.ORG_TYPE_4_CNT
			        ,D.DAYS
			        ,D.IN_PSON_CNT  AS D_IN_PSON_CNT
			        ,D.EXT_PSON_CNT AS D_EXT_PSON_CNT
			        ,D.IN_PSON_MAN_DAY AS  D_IN_PSON_MAN_DAY
			        ,D.EXT_PSON_MAN_DAY AS  D_EXT_PSON_MAN_DAY
			        ,D.IN_PSON_MAN_DAY_1_TOT
			        ,D.IN_PSON_MAN_DAY_2_TOT
			        ,D.IN_PSON_MAN_DAY_3_TOT
			        ,D.IN_PSON_MAN_DAY_4_TOT
			        ,D.EXT_PSON_MAN_DAY_1_TOT
			        ,D.EXT_PSON_MAN_DAY_2_TOT
			        ,D.EXT_PSON_MAN_DAY_3_TOT
			        ,D.EXT_PSON_MAN_DAY_4_TOT
			from  (
			        select max(rownum),
			               aud.AUD_KND_CD,
			               F_CODE_NM('1000007',MAX(aud.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM,       
			               count(aud.AUD_NO) as AUD_ITEM_CNT,
			               sum(pson.PSON_CNT) PSON_CNT,
			               sum(tto.ORG_CNT) as ORG_CNT,
			               sum(pson.MAN_DAY) MAN_DAY,
			               sum(pson.IN_PSON_CNT) IN_PSON_CNT,
			               sum(pson.EXT_PSON_CNT) EXT_PSON_CNT,
			               sum(pson.EXT_PSON1_CNT) EXT_PSON1_CNT,
			               sum(pson.EXT_PSON2_CNT) EXT_PSON2_CNT,
			               sum(pson.IN_PSON_MAN_DAY) IN_PSON_MAN_DAY,
			               sum(pson.EXT_PSON_MAN_DAY) EXT_PSON_MAN_DAY,
			               sum(pson.IN_PSON_TYPE1_MAN_DAY) IN_PSON_TYPE1_MAN_DAY,
			               sum(pson.IN_PSON_TYPE2_MAN_DAY) IN_PSON_TYPE2_MAN_DAY,
			               sum(pson.IN_PSON_TYPE3_MAN_DAY) IN_PSON_TYPE3_MAN_DAY,
			               sum(pson.IN_PSON_TYPE4_MAN_DAY) IN_PSON_TYPE4_MAN_DAY,
			               sum(pson.EXT_PSON_TYPE1_MAN_DAY) EXT_PSON_TYPE1_MAN_DAY,
			               sum(pson.EXT_PSON_TYPE2_MAN_DAY) EXT_PSON_TYPE2_MAN_DAY,
			               sum(pson.EXT_PSON_TYPE3_MAN_DAY) EXT_PSON_TYPE3_MAN_DAY,
			               sum(pson.EXT_PSON_TYPE4_MAN_DAY) EXT_PSON_TYPE4_MAN_DAY,
			               sum(tto.ORG_TYPE1_CNT) as ORG_TYPE1_CNT,
			               sum(tto.ORG_TYPE2_CNT) as ORG_TYPE2_CNT,
			               sum(tto.ORG_TYPE3_CNT) as ORG_TYPE3_CNT,
			               sum(tto.ORG_TYPE4_CNT) as ORG_TYPE4_CNT
			          from TBBADDED002M situ,
			               TBBADDED001M aud,
			               (select BZT_YR,  /*감사년도*/
			                       BZT_SNO,  /*감사순번*/
			                       min(AUD_STR_DT) as AUD_STR_DT,  /*감사시작일*/
			                       max(AUD_END_DT) as AUD_END_DT,  /*감사종료일*/
			                       max(AUD_DCN) as AUD_DCN,  /*최대감사일수*/
			                       sum(AUD_DCN) as MAN_DAY,  /*감사일수합*/
			                       count(*) as PSON_CNT,
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '0' then 1
			                             else 0
			                           end) AS IN_PSON_CNT,  /*내부직원*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '0' then 0
			                             else 1
			                           end) AS EXT_PSON_CNT,  /*외부직원*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '1' then 0  
			                             else 1
			                           end) AS EXT_PSON1_CNT, /* 수견*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '2' or STF_DVSN_CD = '9' then 0
			                             else 1
			                           end) AS EXT_PSON2_CNT,  /*차출*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '0' then AUD_DCN /*감사일수*/
			                             else 0
			                           end) AS IN_PSON_MAN_DAY, /*내부직원감사일수*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '0' then 0
			                             else AUD_DCN
			                           end) AS EXT_PSON_MAN_DAY, /*외부인감사일수*/
			                       
			                       /* ORG_TYPE_CATE : 
			                        10	국가기관
			                        21	지방자치단체
			                        22	교육자치단체
			                        30	공공기관 20개
			                        40	기타필요적대상기관▼
			                       */  
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '0' and ORG_TYPE_CATE = '1' then AUD_DCN
			                             else 0
			                           end) AS IN_PSON_TYPE1_MAN_DAY,  /*내부직원이고 국가기관의 감사일수*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '0' and ORG_TYPE_CATE = '2' then AUD_DCN
			                             else 0
			                           end) AS IN_PSON_TYPE2_MAN_DAY, /*내부직원이고 지방자치단체의 감사일수*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '0' and ORG_TYPE_CATE = '3' then AUD_DCN
			                             else 0
			                           end) AS IN_PSON_TYPE3_MAN_DAY, /*내부직원이고 공공기관 20개의 감사일수*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD = '0' and ORG_TYPE_CATE >= '4' then AUD_DCN 
			                             else 0
			                           end) AS IN_PSON_TYPE4_MAN_DAY, /*내부직원이고 기타필요적대상기관의 감사일수*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD != '0' and ORG_TYPE_CATE = '1' then AUD_DCN
			                             else 0
			                           end) AS EXT_PSON_TYPE1_MAN_DAY, /*외부인이고 국가기관의 감사일수*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD != '0' and ORG_TYPE_CATE = '2' then AUD_DCN
			                             else 0
			                           end) AS EXT_PSON_TYPE2_MAN_DAY, /*외부인이고 지방자치단체의 감사일수*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD != '0' and ORG_TYPE_CATE = '3' then AUD_DCN
			                             else 0
			                           end) AS EXT_PSON_TYPE3_MAN_DAY, /*외부인이고 공공기관 20개의 감사일수*/
			                       SUM(
			                           case
			                             when STF_DVSN_CD != '0' and ORG_TYPE_CATE >= '4' then AUD_DCN 
			                             else 0
			                           end) AS EXT_PSON_TYPE4_MAN_DAY /*외부인이고 기타필요적대상기관의 감사일수*/
			                  from (select  /*+USE_HASH(tma,ptd)*/
			                               tma.BZT_YR,
			                               tma.BZT_SNO,
			                               tma.PCT_CNB,
			                               tma.STF_DVSN_CD,
			                               SUBSTR(org.ORG_DVSN_CD, 1, 1) as ORG_TYPE_CATE,  /*기관구분코드*/
			                               min(ptd.AUD_STR_DT) as AUD_STR_DT,
			                               max(ptd.AUD_END_DT) as AUD_END_DT,
			                               sum(ptd.AUD_DCN) as AUD_DCN
			                          from TBBADDED005L tma,
			                               TBBADDED006L ptd,
			                               TBBADDED008L tto,
			                               TBDCMACM015M org
			                         where tma.BZT_YR between #strBztStYY# and #strBztEndYY#  /*인자값1  FROM ~ TO*/
			                           and ptd.BZT_YR = tma.BZT_YR
			                           and ptd.BZT_SNO = tma.BZT_SNO
			                           and ptd.TEAM_SNO = tma.TEAM_SNO
			                           and ptd.PCT_ALC_SNO = tma.PCT_ALC_SNO
			                           and tto.BZT_YR= ptd.BZT_YR
			                           and tto.BZT_SNO = ptd.BZT_SNO
			                           and tto.TEAM_SNO = ptd.TEAM_SNO
			                           and tto.BGRP_TG_ORG_SNO = ptd.BGRP_TG_ORG_SNO
			                           and tto.ORG_CD =org.ORG_CD(+) 
			                           and SUBSTR(ptd.AUD_STR_DT, 1, 6) between #strBztStYY# || #strBztStMM#  and #strBztEndYY# || #strBztEndMM# /*인자값2  FROM ~ TO*/
			                         group by tma.BZT_YR,
			                               tma.BZT_SNO,
			                               tma.PCT_CNB,
			                               tma.STF_DVSN_CD,
			                               SUBSTR(org.ORG_DVSN_CD, 1, 1) ) ptd1
			                 group by BZT_YR,
			                          BZT_SNO ) pson,
			               (select BZT_YR,
			                       BZT_SNO,
			                       count(*) as ORG_CNT,
			                       SUM(
			                           case
			                             when SUBSTR(org.ORG_DVSN_CD, 1, 1) = '1' then 1
			                             else 0
			                           end) AS ORG_TYPE1_CNT,
			                       SUM(
			                           case
			                             when SUBSTR(org.ORG_DVSN_CD, 1, 1) = '2' then 1
			                             else 0
			                           end) AS ORG_TYPE2_CNT,
			                       SUM(
			                           case
			                             when SUBSTR(org.ORG_DVSN_CD, 1, 1) = '3' then 1
			                             else 0
			                           end) AS ORG_TYPE3_CNT,
			                       SUM(
			                           case
			                             when SUBSTR(org.ORG_DVSN_CD, 1, 1) >= '4' then 1 
			                             else 0
			                           end) AS ORG_TYPE4_CNT
			                  from (select distinct BZT_YR,
			                               BZT_SNO,
			                               ORG_CD
			                          from TBBADDED008L
			                         where 1=1
			                           and BZT_YR between #strBztStYY# and #strBztEndYY# /*인자값1  FROM ~ TO*/
			                           and SUBSTR(AUD_STR_DT, 1, 6) between #strBztStYY# || #strBztStMM#  and #strBztEndYY# || #strBztEndMM#  /*인자값2  FROM ~ TO*/
			                       ) tto0,
			                       TBDCMACM015M org
			                 where tto0.ORG_CD = org.ORG_CD
			                 group by BZT_YR,
			                       BZT_SNO ) tto
			         where situ.REL_AUD_YR = aud.AUD_YR
			           and situ.REL_AUD_NO = aud.AUD_NO
			           and pson.BZT_YR = situ.BZT_YR
			           and pson.BZT_SNO = situ.BZT_SNO
			           and tto.BZT_YR = situ.BZT_YR
			           and tto.BZT_SNO = situ.BZT_SNO
			         group by aud.AUD_KND_CD
			      ) A,
			      (
			        select A.AUD_YR, A.AUD_NO, A.AUD_KND_CD
			        from TBBADDED001M A, TBBADDED002M B, TBBADDED008L C, TBBADDED005L D, TBBADDED006L E
			          where 1 =1 
			             and B.REL_AUD_YR = A.AUD_YR
			             and B.REL_AUD_NO = A.AUD_NO
			             and B.BZT_DVSN_CD = '1'
			             and C.BZT_YR = B.BZT_YR
			             and C.BZT_SNO = B.BZT_SNO
			             and D.BZT_YR = B.BZT_YR
			             and D.BZT_SNO = B.BZT_SNO
			             and E.BZT_YR = D.BZT_YR
			             and E.BZT_SNO = D.BZT_SNO
			             and E.TEAM_SNO = D.TEAM_SNO
			             and E.BGRP_TG_ORG_SNO = C.BGRP_TG_ORG_SNO
			             and E.PCT_ALC_SNO = D.PCT_ALC_SNO
			             and SUBSTR(E.AUD_STR_DT,1,6) between #strBztStYY# || #strBztStMM#  and #strBztEndYY# || #strBztEndMM#  /*인자값2*/
			        group by A.AUD_YR, A.AUD_NO, A.AUD_KND_CD
			      ) B,
			      (
			         select F_MNG_KND_AUDYRNO(A.AUD_YR, A.AUD_NO, max(A.AUD_KND_CD), '-')  as AUD_SNO,
			                A.AUD_YR,
			                A.AUD_NO,
			               max(A.AUD_KND_CD) AS AUD_KND_CD,
			               max(A.AUD_SBJ_NM) as AUD_SBJ_NM,
			               COUNT(C.ORG_CD) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) ORG_CNT,
			               MIN(MIN(E.AUD_STR_DT))  OVER (PARTITION BY A.AUD_YR,A.AUD_NO) SDATE,
			               MAX(MAX(E.AUD_END_DT))  OVER (PARTITION BY A.AUD_YR,A.AUD_NO) EDATE,
			               SUM(E.AUD_DCN)  OVER (PARTITION BY A.AUD_YR,A.AUD_NO) DAYS,
			               SUM(SUM(CASE
			                     WHEN D.STF_DVSN_CD = '0' THEN E.AUD_DCN
			                     ELSE 0
			                   END))  OVER (PARTITION BY A.AUD_YR,A.AUD_NO) IN_PSON_MAN_TOT,
			               SUM(SUM(
			                   CASE
			                     WHEN D.STF_DVSN_CD = '0' THEN 0
			                     ELSE E.AUD_DCN
			                   END)) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) AS EXT_PSON_MAN_TOT,
			               F.ORG_NM,
			               G.CD_NM,       
			               min(E.AUD_STR_DT) as AUD_SDATE,
			               max(E.AUD_END_DT) as AUD_EDATE,
			               E.AUD_DCN AUD_DAYS,
			               sum(
			                   case
			                     when D.STF_DVSN_CD = '0' then 1
			                     else 0
			                   end) as IN_PSON_CNT,
			               sum(
			                   case
			                     when D.STF_DVSN_CD = '0' then 0
			                     else 1
			                   end) as EXT_PSON_CNT,
			               sum(
			                   case
			                     when D.STF_DVSN_CD = '0' then E.AUD_DCN
			                     else 0
			                   end) as IN_PSON_MAN_DAY,
			               sum(
			                   case
			                     when D.STF_DVSN_CD = '0' then 0
			                     else E.AUD_DCN
			                   end) as EXT_PSON_MAN_DAY
			          from TBBADDED001M A,
			               TBBADDED002M B,
			               TBBADDED008L C,
			               TBBADDED005L D,
			               TBBADDED006L E,
			               TBDCMACM015M F,
			               (select CD,
			                       CD_NM
			                  from TBDCMACM013C
			                 where CMM_CD_DVSN_CD = '1000119') G
			         where 1 =1
			           and A.AUD_YR BETWEEN  #strBztStYY# AND #strBztEndYY# /*인자값1*/
			           and B.REL_AUD_YR = A.AUD_YR
			           and B.REL_AUD_NO = A.AUD_NO
			           and B.BZT_DVSN_CD = '1'
			           and C.BZT_YR = B.BZT_YR
			           and C.BZT_SNO = B.BZT_SNO
			           and D.BZT_YR = B.BZT_YR
			           and D.BZT_SNO = B.BZT_SNO
			           and E.BZT_YR = D.BZT_YR
			           and E.BZT_SNO = D.BZT_SNO
			           and E.TEAM_SNO = D.TEAM_SNO
			           and E.BGRP_TG_ORG_SNO = C.BGRP_TG_ORG_SNO
			           and E.PCT_ALC_SNO = D.PCT_ALC_SNO
			           and SUBSTR(E.AUD_STR_DT,1,6) between #strBztStYY# || #strBztStMM#  and #strBztEndYY# || #strBztEndMM#   /*인자값3*/
			           and F.ORG_CD = C.ORG_CD
			           and G.CD = A.ORG_DVSN_CD
			         group by A.AUD_YR,
			               A.AUD_NO,
			               C.ORG_CD,
			               D.STF_DVSN_CD,
			               E.AUD_DCN,
			               F.ORG_NM,
			               G.CD_NM      
			      ) C,
			      (
			      select    /*+leading(aa,bb)*/
			                AA.AUD_YR, AA.AUD_NO, 
			                max(BB.ORG_CNT) ORG_CNT,
			                max(BB.ORG_TYPE_1_CNT) as ORG_TYPE_1_CNT,
			                max(BB.ORG_TYPE_2_CNT) as ORG_TYPE_2_CNT,
			                max(BB.ORG_TYPE_3_CNT) as ORG_TYPE_3_CNT,
			                max(BB.ORG_TYPE_4_CNT) as ORG_TYPE_4_CNT,
			                sum (AA.AUD_DCN) as DAYS,        
			                sum(AA.IN_PSON_CNT) as IN_PSON_CNT,
			                sum(AA.EXT_PSON_CNT) as EXT_PSON_CNT,
			                sum(AA.IN_PSON_MAN_DAY) as IN_PSON_MAN_DAY,
			                sum(AA.EXT_PSON_MAN_DAY) as EXT_PSON_MAN_DAY,
			                sum(case when substring(AA.ORG_DVSN_CD,1,1) = '1' then IN_PSON_MAN_DAY else 0 end) as IN_PSON_MAN_DAY_1_TOT,
			                sum(case when substring(AA.ORG_DVSN_CD,1,1) = '2' then IN_PSON_MAN_DAY else 0 end) as IN_PSON_MAN_DAY_2_TOT,
			                sum(case when substring(AA.ORG_DVSN_CD,1,1) = '3' then IN_PSON_MAN_DAY else 0 end) as IN_PSON_MAN_DAY_3_TOT,
			                sum(case when substring(AA.ORG_DVSN_CD,1,1) > '3' then IN_PSON_MAN_DAY else 0 end) as IN_PSON_MAN_DAY_4_TOT,
			                sum(case when substring(AA.ORG_DVSN_CD,1,1) = '1' then EXT_PSON_MAN_DAY else 0 end) as EXT_PSON_MAN_DAY_1_TOT,
			                sum(case when substring(AA.ORG_DVSN_CD,1,1) = '2' then EXT_PSON_MAN_DAY else 0 end) as EXT_PSON_MAN_DAY_2_TOT,
			                sum(case when substring(AA.ORG_DVSN_CD,1,1) = '3' then EXT_PSON_MAN_DAY else 0 end) as EXT_PSON_MAN_DAY_3_TOT,
			                sum(case when substring(AA.ORG_DVSN_CD,1,1) > '3' then EXT_PSON_MAN_DAY else 0 end) as EXT_PSON_MAN_DAY_4_TOT
			        from
			            (
			                select /*+ index(B KBBADBADDED002M001)*/
			                        A.AUD_YR, A.AUD_NO, C.ORG_CD, E.AUD_DCN, F.ORG_DVSN_CD,           
			                        sum(case when D.STF_DVSN_CD = '0' then 1 else 0 end) as IN_PSON_CNT,
			                        sum(case when D.STF_DVSN_CD = '0' then 0 else 1 end) as EXT_PSON_CNT,
			                        sum(case when D.STF_DVSN_CD = '0' then E.AUD_DCN else 0 end) as IN_PSON_MAN_DAY,
			                        sum(case when D.STF_DVSN_CD = '0' then 0 else E.AUD_DCN end) as EXT_PSON_MAN_DAY
			                from TBBADDED001M A, TBBADDED002M B, TBBADDED008L C, TBBADDED005L D, TBBADDED006L E, TBDCMACM015M F 
			                  where 1 =1 
			                     and A.AUD_YR BETWEEN   #strBztStYY# AND #strBztEndYY#/*인자값1*/
			                      and SUBSTR(E.AUD_STR_DT,1,6) between  #strBztStYY# || #strBztStMM#  and #strBztEndYY# || #strBztEndMM#  /*인자값3*/
			                     and B.REL_AUD_YR = A.AUD_YR
			                     and B.REL_AUD_NO = A.AUD_NO
			                     and B.BZT_DVSN_CD = '1'
			                     and C.BZT_YR = B.BZT_YR
			                     and C.BZT_SNO = B.BZT_SNO
			                     and D.BZT_YR = B.BZT_YR
			                     and D.BZT_SNO = B.BZT_SNO
			                     and E.BZT_YR = D.BZT_YR
			                     and E.BZT_SNO = D.BZT_SNO
			                     and E.TEAM_SNO = D.TEAM_SNO
			                     and E.BGRP_TG_ORG_SNO = C.BGRP_TG_ORG_SNO
			                     and E.PCT_ALC_SNO = D.PCT_ALC_SNO
			                     and F.ORG_CD = C.ORG_CD
			                group by A.AUD_YR, A.AUD_NO, C.ORG_CD, E.AUD_DCN, F.ORG_DVSN_CD
			            )  AA,
			            (  select /*+no_merge*/
			                      AUD_YR, AUD_NO,
			                      count(*) as ORG_CNT,
			                      SUM(case when SUBSTR(BB.ORG_DVSN_CD,1,1) = '1' then 1 else 0 end) AS ORG_TYPE_1_CNT,
			                      SUM(case when SUBSTR(BB.ORG_DVSN_CD,1,1) = '2' then 1 else 0 end) AS ORG_TYPE_2_CNT,
			                      SUM(case when SUBSTR(BB.ORG_DVSN_CD,1,1) = '3' then 1 else 0 end) AS ORG_TYPE_3_CNT,        
			                      SUM(case when SUBSTR(BB.ORG_DVSN_CD,1,1) >= '4' then 1 else 0 end) AS ORG_TYPE_4_CNT               
			                from 
			                       (select /*+index(B KBBADBADDED002M001)*/distinct C.AUD_YR, C.AUD_NO, A.ORG_CD
			                          from TBBADDED008L A,  TBBADDED002M B, TBBADDED001M C
			                         where  1=1
			                           and C.AUD_YR BETWEEN  #strBztStYY# AND #strBztEndYY#/*인자값1*/
			                           and B.REL_AUD_YR =C.AUD_YR
			                           and B.REL_AUD_NO = C.AUD_NO
			                           and B.BZT_DVSN_CD = '1'
			                           and A.BZT_YR = B.BZT_YR
			                           and A.BZT_SNO = B.BZT_SNO
			                        ) AA, 
			                       TBDCMACM015M BB
			                where AA.ORG_CD = BB.ORG_CD
			             group by AUD_YR, AUD_NO
			            ) BB
			        where 1 =1
			             and BB.AUD_YR  = AA.AUD_YR
			              and BB.AUD_NO = AA.AUD_NO
			        group by AA.AUD_YR, AA.AUD_NO
			      ) D
			 where A.AUD_KND_CD =B.AUD_KND_CD
			   AND B.AUD_YR = C.AUD_YR
			   AND B.AUD_NO = C.AUD_NO
			   AND B.AUD_KND_CD = C.AUD_KND_CD
			   AND B.AUD_YR = D.AUD_YR
			   AND B.AUD_NO = D.AUD_NO       

        ]]>
	</select>	

	<!-- 대상기관별 명세  -->
	<select id="BADDED008QSelect2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  	
		SELECT   A.BZT_YR
		        ,A.ORG_CD
		        ,A.ORG_NM
		        ,B.GUBUN
		        ,B.FULL_AUD_NO /*기존 AUD_NO 중복으로 변경*/
		        ,B.BZT_YR
		        ,B.BZT_SNO
		        ,B.TEAM_SNO
		        ,B.AUD_STR_DT
		        ,B.AUD_END_DT
		        ,B.AUD_DCN
		        ,B.AUD_YR
		        ,B.AUD_NO
		        ,B.AUD_TASK_CD
		        ,B.ORG_DVSN_CD
		        ,B.AUD_KND_CD
		        ,B.SPV_BRDV_CD
		        ,B.AUD_WAY_CD
		        ,B.AUD_EXEC_DVSN_CD_NM
		        ,B.AUD_SBJ_NM
		        ,B.AUD_STEP_SNO
		        ,B.IN_PSON_CNT
		        ,B.EXT_PSON_CNT
		        ,B.IN_PSON_MAN_CNT
		        ,B.EXT_PSON_MAN_CNT
		        ,B.IN_PSON_TOT_CNT
		        ,B.EXT_PSON_TOT_CNT
		        ,B.SDATE
		        ,B.EDATE
		        ,B.DAYS
		        ,B.ORG_CNT
		
		FROM 
		(
		    select 
		           A.BZT_YR,
		           B.ORG_CD,  
		           F_ORG_INFO(B.ORG_CD,'1') ORG_NM 
		      from TBBADDED006L A,
		           TBBADDED008L B,
		           TBBADDED002M C
		     where 1=1
		       and B.BZT_YR  = A.BZT_YR
		       and B.BZT_SNO = A.BZT_SNO   
		       and C.BZT_YR = B.BZT_YR
		       and C.BZT_SNO = B.BZT_SNO
		       and A.BZT_YR between #strBztStYY# and #strBztEndYY#  /* 인자값1  화면 감사년도from ~ to*/
		       and SUBSTR(A.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		       and B.ORG_CD between #strOrgCdSt# and #strOrgCdEnd#  /* 인자값3 화면의 기관코드범위 From ~ to  */   
		       and C.BZT_DVSN_CD = '1'
		     group by A.BZT_YR,
		              B.ORG_CD
		) A,
		(
		select /*+NO_MERGE*/
		       F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as GUBUN,
		       F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as FULL_AUD_NO,
		       AA.BZT_YR,
		       AA.BZT_SNO,
		       AA.TEAM_SNO,
		       AA.AUD_STR_DT,
		       AA.AUD_END_DT,
		       AA.AUD_DCN,
		       AA.ORG_CD,
		       AA.ORG_NM,
		       max(AA.AUD_YR) as AUD_YR,
		       max(AA.AUD_NO) as AUD_NO,
		       max(AA.AUD_TASK_CD) as AUD_TASK_CD,
		       max(AA.ORG_DVSN_CD) as ORG_DVSN_CD,
		       max(AA.AUD_KND_CD) as AUD_KND_CD,
		       max(AA.SPV_BRDV_CD) as SPV_BRDV_CD,
		       max(AA.AUD_WAY_CD) as AUD_WAY_CD,
		       max(AA.AUD_EXEC_DVSN_CD_NM) as AUD_EXEC_DVSN_CD_NM,
		       max(AA.AUD_SBJ_NM) as AUD_SBJ_NM,
		       AA.AUD_STEP_SNO,
		       max(BB.IN_PSON_CNT) as IN_PSON_CNT,
		       max(BB.EXT_PSON_CNT) as EXT_PSON_CNT,
		       max(CC.IN_PSON_MAN_CNT) as IN_PSON_MAN_CNT,
		       max(CC.EXT_PSON_MAN_CNT) as EXT_PSON_MAN_CNT,
		       max(DD.IN_PSON_TOT_CNT) as IN_PSON_TOT_CNT,
		       max(DD.EXT_PSON_TOT_CNT) as EXT_PSON_TOT_CNT,
		       min(DD.SDATE) as SDATE,
		       max(DD.EDATE) as EDATE,
		       '' as DAYS,
		       max(EE.ORG_CNT) as ORG_CNT
		  from (select A.BZT_YR,
		               A.BZT_SNO,
		               A.TEAM_SNO,
		               C.AUD_STEP_SNO,
		               min( A.AUD_STR_DT) as AUD_STR_DT,
		               max(A.AUD_END_DT) as AUD_END_DT,
		               max(A.AUD_DCN) as AUD_DCN,
		               B.BGRP_TG_ORG_SNO,
		               max(D.AUD_YR) as AUD_YR,
		               max(D.AUD_NO) as AUD_NO,
		               max(D.AUD_TASK_CD) as AUD_TASK_CD,
		               max(D.ORG_DVSN_CD) as ORG_DVSN_CD,
		               max(D.AUD_KND_CD) as AUD_KND_CD,
		               max(D.SPV_BRDV_CD) as SPV_BRDV_CD,
		               max(D.AUD_WAY_CD) as AUD_WAY_CD,
		               max(D.AUD_SBJ_NM) as AUD_SBJ_NM,
		               max(B.ORG_CD) AS ORG_CD,
		               F_ORG_INFO(max(B.ORG_CD),'1') ORG_NM, 
		               F_CODE_NM('1000007',MAX(D.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
		            from TBBADDED006L A,
		               TBBADDED008L B,
		               TBBADDED002M C,
		               TBBADDED001M D
		         where 1=1
		           and A.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		           and SUBSTR(A.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		           and B.BZT_YR = A.BZT_YR
		           and B.BZT_SNO = A.BZT_SNO
		           and B.TEAM_SNO = A.TEAM_SNO
		           and B.BGRP_TG_ORG_SNO = A.BGRP_TG_ORG_SNO
		           and C.BZT_YR = B.BZT_YR
		           and C.BZT_SNO = B.BZT_SNO
		           and D.AUD_YR = C.REL_AUD_YR
		           and D.AUD_NO = C.REL_AUD_NO
		         group by A.BZT_YR,
		               A.BZT_SNO,
		               A.TEAM_SNO,
		               B.BGRP_TG_ORG_SNO,
		               C.AUD_STEP_SNO ) AA,
		       (select 
		               BZT_YR,
		               BZT_SNO,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then 1
		                     else 0
		                   end) as IN_PSON_CNT,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then 0
		                     else 1
		                   end) as EXT_PSON_CNT
		          from (select distinct BZT_YR,
		                       BZT_SNO,
		                       PCT_CNB,
		                       STF_DVSN_CD
		                  from TBBADDED005L
		                 WHERE BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		                 ) A
		         group by BZT_YR,
		               BZT_SNO ) BB,
		       (select  
		               A.BZT_YR,
		               A.BZT_SNO,
		               A.TEAM_SNO,
		               C.BGRP_TG_ORG_SNO,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                     else 0
		                   end) as IN_PSON_MAN_CNT,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then 0
		                     else B.AUD_DCN
		                   end) as EXT_PSON_MAN_CNT
		          from TBBADDED005L A,
		               TBBADDED006L B,
		               TBBADDED008L C
		         where 1 = 1
		           and B.BZT_YR = A.BZT_YR
		           and B.BZT_SNO = A.BZT_SNO
		           and B.TEAM_SNO = A.TEAM_SNO
		           and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		           and C.BZT_YR = B.BZT_YR
		           and C.BZT_SNO = B.BZT_SNO
		           and C.TEAM_SNO = B.TEAM_SNO
		           and C.BGRP_TG_ORG_SNO = B.BGRP_TG_ORG_SNO
		           and A.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		           and SUBSTR(B.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		         group by A.BZT_YR,
		               A.BZT_SNO,
		               A.TEAM_SNO,
		               C.BGRP_TG_ORG_SNO ) CC,
		       (select A.BZT_YR,
		               A.BZT_SNO,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                     else 0
		                   end) as IN_PSON_TOT_CNT,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then 0
		                     else B.AUD_DCN
		                   end) as EXT_PSON_TOT_CNT,
		               MIN(B.AUD_STR_DT) as SDATE,
		               MAX(B.AUD_END_DT) as EDATE
		          from TBBADDED005L A,
		               TBBADDED006L B
		         where 1 = 1
		           and B.BZT_YR = A.BZT_YR
		           and B.BZT_SNO = A.BZT_SNO
		           and B.TEAM_SNO = A.TEAM_SNO
		           and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		           and A.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		           and SUBSTR(B.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		         group by A.BZT_YR,
		               A.BZT_SNO ) DD,
		       (select BZT_YR,
		               BZT_SNO,
		               COUNT(DISTINCT ORG_CD) ORG_CNT
		         from TBBADDED008L 
		         WHERE BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		         group by BZT_YR,
		               BZT_SNO) EE
		 where 1 = 1
		   and BB.BZT_YR = AA.BZT_YR
		   and BB.BZT_SNO = AA.BZT_SNO
		   and CC.BZT_YR = AA.BZT_YR
		   and CC.BZT_SNO = AA.BZT_SNO
		   and CC.TEAM_SNO = AA.TEAM_SNO
		   and CC.BGRP_TG_ORG_SNO = AA.BGRP_TG_ORG_SNO
		   and DD.BZT_YR = CC.BZT_YR
		   and DD.BZT_SNO = CC.BZT_SNO
		   and EE.BZT_YR = DD.BZT_YR
		   and EE.BZT_SNO = DD.BZT_SNO
		 group by AA.BZT_YR,
		       AA.BZT_SNO,
		       AA.TEAM_SNO,
		       AA.AUD_STR_DT,
		       AA.AUD_END_DT,
		       AA.AUD_DCN,
		       AA.ORG_CD,
		       AA.ORG_NM,
		       AA.AUD_STEP_SNO 
		
		) B
		WHERE A.BZT_YR = B.BZT_YR
		  AND A.ORG_CD = B.ORG_CD
		order by B.GUBUN
        ]]>
	</select>	
	
	<!-- 주관국가별 명세  -->
	<select id="BADDED008QSelect3" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  	
		SELECT   A.BZT_YR
		        ,A.SPV_BRDV_CD
		        ,A.DPT_NM
		        ,B.GUBUN
		        ,B.FULL_AUD_NO /*기존 AUD_NO 중복으로 변경*/
		        ,B.BZT_YR
		        ,B.BZT_SNO
		        ,B.TEAM_SNO
		        ,B.AUD_STR_DT
		        ,B.AUD_END_DT
		        ,B.AUD_DCN
		        ,B.ORG_NM
		        ,B.AUD_YR
		        ,B.AUD_NO
		        ,B.AUD_TASK_CD
		        ,B.ORG_DVSN_CD
		        ,B.AUD_KND_CD
		        ,B.SPV_BRDV_CD
		        ,B.AUD_WAY_CD
		        ,B.AUD_EXEC_DVSN_CD_NM
		        ,B.AUD_SBJ_NM
		        ,B.AUD_STEP_SNO
		        ,B.IN_PSON_CNT
		        ,B.EXT_PSON_CNT
		        ,B.IN_PSON_MAN_CNT
		        ,B.EXT_PSON_MAN_CNT
		        ,B.IN_PSON_TOT_CNT
		        ,B.EXT_PSON_TOT_CNT
		        ,B.SDATE
		        ,B.EDATE
		        ,B.DAYS
		        ,B.ORG_CNT
		
		FROM 
		    (
		    select A.BZT_YR,
		           D.SPV_BRDV_CD,
		           F_DPT_INFO(D.SPV_BRDV_CD,'1') DPT_NM
		      from TBBADDED006L A,
		           TBBADDED002M C,
		           TBBADDED001M D
		     where 1=1
		       and A.BZT_YR between #strBztStYY# and #strBztEndYY#  /*화면 감사년도 FROM ~TO*/
		       and SUBSTR(A.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /*화면 감사기간 FROM ~TO*/
		       and A.BZT_YR  = C.BZT_YR
		       and A.BZT_SNO = C.BZT_SNO
		       and C.BZT_DVSN_CD = '1'
		       and D.AUD_YR = C.REL_AUD_YR
		       and D.AUD_NO = C.REL_AUD_NO
		       and D.SPV_BRDV_CD like '010%'  /*화면 주관실국*/
		     group by A.BZT_YR,
		              D.SPV_BRDV_CD
		    ) A,          
		    (         
		    select F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as GUBUN,
		           F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as FULL_AUD_NO,
		           AA.BZT_YR,
		           AA.BZT_SNO,
		           AA.TEAM_SNO,
		           AA.AUD_STR_DT,
		           AA.AUD_END_DT,
		           AA.AUD_DCN,
		           AA.ORG_NM,
		           max(AA.AUD_YR) as AUD_YR,
		           max(AA.AUD_NO) as AUD_NO,
		           max(AA.AUD_TASK_CD) as AUD_TASK_CD,
		           max(AA.ORG_DVSN_CD) as ORG_DVSN_CD,
		           max(AA.AUD_KND_CD) as AUD_KND_CD,
		           max(AA.SPV_BRDV_CD) as SPV_BRDV_CD,
		           max(AA.AUD_WAY_CD) as AUD_WAY_CD,
		           max(AA.AUD_EXEC_DVSN_CD_NM) as AUD_EXEC_DVSN_CD_NM,
		           max(AA.AUD_SBJ_NM) as AUD_SBJ_NM,
		           AA.AUD_STEP_SNO,
		           max(BB.IN_PSON_CNT) as IN_PSON_CNT,
		           max(BB.EXT_PSON_CNT) as EXT_PSON_CNT,
		           max(CC.IN_PSON_MAN_CNT) as IN_PSON_MAN_CNT,
		           max(CC.EXT_PSON_MAN_CNT) as EXT_PSON_MAN_CNT,
		           max(DD.IN_PSON_TOT_CNT) as IN_PSON_TOT_CNT,
		           max(DD.EXT_PSON_TOT_CNT) as EXT_PSON_TOT_CNT,
		           min(DD.SDATE) as SDATE,
		           max(DD.EDATE) as EDATE,
		           '' as DAYS,
		           max(EE.ORG_CNT) as ORG_CNT
		      from (select A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.AUD_STEP_SNO,
		                   min( A.AUD_STR_DT) as AUD_STR_DT,
		                   max(A.AUD_END_DT) as AUD_END_DT,
		                   max(A.AUD_DCN) as AUD_DCN,
		                   B.BGRP_TG_ORG_SNO,
		                   max(D.AUD_YR) as AUD_YR,
		                   max(D.AUD_NO) as AUD_NO,
		                   max(D.AUD_TASK_CD) as AUD_TASK_CD,
		                   max(D.ORG_DVSN_CD) as ORG_DVSN_CD,
		                   max(D.AUD_KND_CD) as AUD_KND_CD,
		                   max(D.SPV_BRDV_CD) as SPV_BRDV_CD,
		                   max(D.AUD_WAY_CD) as AUD_WAY_CD,
		                   max(D.AUD_SBJ_NM) as AUD_SBJ_NM,
		                   F_ORG_INFO(max(B.ORG_CD),'1') ORG_NM, 
		                   F_CODE_NM('1000007',MAX(D.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
		              from TBBADDED006L A,
		                   TBBADDED008L B,
		                   TBBADDED002M C,
		                   TBBADDED001M D
		             where 1=1
		               and A.BZT_YR between #strBztStYY# and #strBztEndYY#  /*감사년도 FROM ~TO*/
		               and SUBSTR(A.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /*화면 감사기간FROM ~TO*/
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.BGRP_TG_ORG_SNO = A.BGRP_TG_ORG_SNO
		               and C.BZT_YR = B.BZT_YR
		               and C.BZT_SNO = B.BZT_SNO
		               and D.AUD_YR = C.REL_AUD_YR
		               and D.AUD_NO = C.REL_AUD_NO
		             group by A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   B.BGRP_TG_ORG_SNO,
		                   C.AUD_STEP_SNO ) AA,
		           (select 
		                   BZT_YR,
		                   BZT_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 1
		                         else 0
		                       end) as IN_PSON_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else 1
		                       end) as EXT_PSON_CNT
		              from (select distinct BZT_YR,
		                           BZT_SNO,
		                           PCT_CNB,
		                           STF_DVSN_CD
		                      from TBBADDED005L
		                      WHERE BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		                      ) A
		             group by BZT_YR,
		                   BZT_SNO ) BB,
		           (select 
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.BGRP_TG_ORG_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                         else 0
		                       end) as IN_PSON_MAN_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else B.AUD_DCN
		                       end) as EXT_PSON_MAN_CNT
		              from TBBADDED005L A,
		                   TBBADDED006L B,
		                   TBBADDED008L C
		             where 1 = 1
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		               and C.BZT_YR = B.BZT_YR
		               and C.BZT_SNO = B.BZT_SNO
		               and C.TEAM_SNO = B.TEAM_SNO
		               and C.BGRP_TG_ORG_SNO = B.BGRP_TG_ORG_SNO
		               and B.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		               and SUBSTR(B.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		             group by A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.BGRP_TG_ORG_SNO ) CC,
		           (select 
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                         else 0
		                       end) as IN_PSON_TOT_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else B.AUD_DCN
		                       end) as EXT_PSON_TOT_CNT,
		                   MIN(B.AUD_STR_DT) as SDATE,
		                   MAX(B.AUD_END_DT) as EDATE
		              from TBBADDED005L A,
		                   TBBADDED006L B
		             where 1 = 1
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		               and B.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		               and SUBSTR(B.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		             group by A.BZT_YR,
		                   A.BZT_SNO ) DD,
		           (select BZT_YR,
		                   BZT_SNO,
		                   COUNT(DISTINCT ORG_CD) ORG_CNT
		             from TBBADDED008L
		             WHERE BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		             group by BZT_YR,
		                   BZT_SNO) EE
		     where 1 = 1
		       and BB.BZT_YR = AA.BZT_YR
		       and BB.BZT_SNO = AA.BZT_SNO
		       and CC.BZT_YR = AA.BZT_YR
		       and CC.BZT_SNO = AA.BZT_SNO
		       and CC.TEAM_SNO = AA.TEAM_SNO
		       and CC.BGRP_TG_ORG_SNO = AA.BGRP_TG_ORG_SNO
		       and DD.BZT_YR = CC.BZT_YR
		       and DD.BZT_SNO = CC.BZT_SNO
		       and EE.BZT_YR = DD.BZT_YR
		       and EE.BZT_SNO = DD.BZT_SNO
		     group by AA.BZT_YR,
		           AA.BZT_SNO,
		           AA.TEAM_SNO,
		           AA.AUD_STR_DT,
		           AA.AUD_END_DT,
		           AA.AUD_DCN,
		           AA.ORG_NM,
		           AA.AUD_STEP_SNO 
		    ) B
		WHERE A.BZT_YR = B.BZT_YR 
		  AND A.SPV_BRDV_CD = B.SPV_BRDV_CD
		order by B.GUBUN
        ]]>
	</select>	
	<!-- 감사방침별 명세  -->
	<select id="BADDED008QSelect4" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[  	
		SELECT   
		         A.AUD_TASK_CD
		        ,A.AUD_YR
		        ,A.STRTG_GOAL_NM
		        ,B.AUD_NO
		        ,B.ORG_DVSN_CD
		        ,B.BZT_YR
		        ,B.BZT_SNO
		        ,B.ORG_TOT_CNT
		        ,B.IN_PSON_TOT_CNT
		        ,B.EXT_PSON_TOT_CNT
		        ,B.ORG_TYPE_NM
		        ,B.CNT
		        ,C.GUBUN
		        ,C.FULL_AUD_NO
		        ,C.BZT_YR
		        ,C.BZT_SNO
		        ,C.TEAM_SNO
		        ,C.AUD_STR_DT
		        ,C.AUD_END_DT
		        ,C.AUD_DCN
		        ,C.ORG_NM
		        ,C.AUD_YR
		        ,C.AUD_NO
		        ,C.AUD_TASK_CD
		        ,C.ORG_DVSN_CD
		        ,C.AUD_KND_CD
		        ,C.SPV_BRDV_CD
		        ,C.AUD_WAY_CD
		        ,C.AUD_EXEC_DVSN_CD_NM
		        ,C.AUD_SBJ_NM
		        ,C.AUD_STEP_SNO
		        ,C.IN_PSON_CNT
		        ,C.EXT_PSON_CNT
		        ,C.IN_PSON_MAN_CNT
		        ,C.EXT_PSON_MAN_CNT
		        ,C.IN_PSON_TOT_CNT
		        ,C.EXT_PSON_TOT_CNT
		        ,C.SDATE
		        ,C.EDATE
		        ,C.DAYS
		        ,C.ORG_CNT
		    from 
		    (
		        select A.AUD_TASK_CD,
		               A.AUD_YR,
		               F_CODE_NM('1000008',A.AUD_TASK_CD) STRTG_GOAL_NM  /*감사방침*/
		          from TBBADDED001M A,
		               TBBADDED002M B,
		               TBBADDED008L C
		         where A.AUD_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /*화면 감사년도*/
		           and SUBSTR(A.AUD_TASK_CD, -1) BETWEEN #strAudTaskCdSt# AND #strAudTaskCdEnd# /*화면 감사방침 1~9*/
		           and B.REL_AUD_YR = A.AUD_YR
		           and B.REL_AUD_NO = A.AUD_NO
		           and B.BZT_DVSN_CD = '1'
		           and C.BZT_YR = B.BZT_YR
		           and C.BZT_SNO = B.BZT_SNO
		           and C.AUD_STR_DT BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면 감사기간*/
		         group by A.AUD_TASK_CD,
		               A.AUD_YR 
		    ) A,
		    (
		        select max(X.AUD_YR) as AUD_YR,
		               max(X.AUD_NO) as AUD_NO,
		               MAX(X.AUD_TASK_CD) as AUD_TASK_CD,
		               X.ORG_DVSN_CD,
		               max(X.BZT_YR) as BZT_YR,
		               max(X.BZT_SNO) as BZT_SNO,
		               SUM(X.ORG_CNT) as ORG_TOT_CNT,
		               SUM(X.IN_PSON_MAN_CNT) as IN_PSON_TOT_CNT,
		               SUM(X.EXT_PSON_MAN_CNT) as EXT_PSON_TOT_CNT,       
		               F_CODE_NM('1000119',X.ORG_DVSN_CD) ORG_TYPE_NM,  /*기관구분명*/
		               /*--Z.CD_NM as ORG_TYPE_NM,*/
		               count(*) as CNT
		          from (select AA.AUD_YR,
		                       AA.AUD_NO,
		                       AA.AUD_TASK_CD,
		                       AA.ORG_DVSN_CD,
		                       AA.BZT_YR,
		                       AA.BZT_SNO,
		                       BB. ORG_CNT,
		                       CC.IN_PSON_MAN_CNT,
		                       CC.EXT_PSON_MAN_CNT
		                  from (select A.AUD_YR,
		                               A.AUD_NO,
		                               max(A.AUD_TASK_CD) as AUD_TASK_CD,
		                               A.ORG_DVSN_CD,
		                               max(C.BZT_YR) as BZT_YR,
		                               max(C.BZT_SNO) as BZT_SNO
		                          from TBBADDED001M A,
		                               TBBADDED002M B,
		                               TBBADDED008L C
		                         where A.AUD_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /*화면 감사년도*/
		                           and B.REL_AUD_YR = A.AUD_YR
		                           and B.REL_AUD_NO = A.AUD_NO
		                           and B.BZT_DVSN_CD = '1'
		                           and C.BZT_YR = B.BZT_YR
		                           and C.BZT_SNO = B.BZT_SNO
		                           and C.AUD_STR_DT BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면의 감사기간*/
		                         group by A.AUD_YR,
		                               A.AUD_NO,
		                               A.ORG_DVSN_CD) AA,
		                       (select BZT_YR,
		                               BZT_SNO,
		                               count(distinct ORG_CD) ORG_cnt,
		                               min(AUD_STR_DT) AUD_STR_DT,
		                               max(AUD_END_DT) AUD_END_DT
		                         from TBBADDED008L
		                         group by BZT_YR,
		                                  BZT_SNO) BB,
		                       (select A.BZT_YR,
		                               A.BZT_SNO,
		                               sum(
		                                   case
		                                     when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                                     else 0
		                                   end) as IN_PSON_MAN_CNT,
		                               sum(
		                                   case
		                                     when A.STF_DVSN_CD = '0' then 0
		                                     else B.AUD_DCN
		                                   end) as EXT_PSON_MAN_CNT,
		                               MIN(B.AUD_STR_DT) as AUD_STR_DT,
		                               MAX(B.AUD_END_DT) as AUD_END_DT,
		                               MAX(B.AUD_DCN) as AUD_DCN
		                          from TBBADDED005L A,
		                               TBBADDED006L B
		                         where B.BZT_YR = A.BZT_YR
		                           and B.BZT_SNO = A.BZT_SNO
		                           and B.TEAM_SNO = A.TEAM_SNO
		                           and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		                         group by A.BZT_YR,
		                               A.BZT_SNO ) CC
		                 where 1=1
		                   and BB.BZT_YR(+) = AA.BZT_YR
		                   and BB.BZT_SNO(+) = AA.BZT_SNO
		                   and CC.BZT_YR(+) = AA.BZT_YR
		                   and CC.BZT_SNO(+) = AA.BZT_SNO ) X
		         group by ORG_DVSN_CD,
		                  X.ORG_DVSN_CD 
		
		    ) B,
		    (
		        select /*+NO_MERGE*/
		           F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as GUBUN,
		           F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as FULL_AUD_NO,		           
		           AA.BZT_YR,
		           AA.BZT_SNO,
		           AA.TEAM_SNO,
		           AA.AUD_STR_DT,
		           AA.AUD_END_DT,
		           AA.AUD_DCN,
		           AA.ORG_NM,
		           max(AA.AUD_YR) as AUD_YR,
		           max(AA.AUD_NO) as AUD_NO,
		           max(AA.AUD_TASK_CD) as AUD_TASK_CD,
		           max(AA.ORG_DVSN_CD) as ORG_DVSN_CD,
		           max(AA.AUD_KND_CD) as AUD_KND_CD,
		           max(AA.SPV_BRDV_CD) as SPV_BRDV_CD,
		           max(AA.AUD_WAY_CD) as AUD_WAY_CD,
		           max(AA.AUD_EXEC_DVSN_CD_NM) as AUD_EXEC_DVSN_CD_NM,
		           max(AA.AUD_SBJ_NM) as AUD_SBJ_NM,
		           AA.AUD_STEP_SNO,
		           max(BB.IN_PSON_CNT) as IN_PSON_CNT,
		           max(BB.EXT_PSON_CNT) as EXT_PSON_CNT,
		           max(CC.IN_PSON_MAN_CNT) as IN_PSON_MAN_CNT,
		           max(CC.EXT_PSON_MAN_CNT) as EXT_PSON_MAN_CNT,
		           max(DD.IN_PSON_TOT_CNT) as IN_PSON_TOT_CNT,
		           max(DD.EXT_PSON_TOT_CNT) as EXT_PSON_TOT_CNT,
		           min(DD.SDATE) as SDATE,
		           max(DD.EDATE) as EDATE,
		           '' as DAYS,
		           max(EE.ORG_CNT) as ORG_CNT
		      from (select 
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.AUD_STEP_SNO,
		                   min( A.AUD_STR_DT) as AUD_STR_DT,
		                   max(A.AUD_END_DT) as AUD_END_DT,
		                   max(A.AUD_DCN) as AUD_DCN,
		                   B.BGRP_TG_ORG_SNO,
		                   max(D.AUD_YR) as AUD_YR,
		                   max(D.AUD_NO) as AUD_NO,
		                   max(D.AUD_TASK_CD) as AUD_TASK_CD,
		                   max(D.ORG_DVSN_CD) as ORG_DVSN_CD,
		                   max(D.AUD_KND_CD) as AUD_KND_CD,
		                   max(D.SPV_BRDV_CD) as SPV_BRDV_CD,
		                   max(D.AUD_WAY_CD) as AUD_WAY_CD,
		                   max(D.AUD_SBJ_NM) as AUD_SBJ_NM,
		                   max(E.ORG_NM) as ORG_NM,               
		                   F_CODE_NM('1000007',MAX(D.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
		              from TBBADDED006L A,
		                   TBBADDED008L B,
		                   TBBADDED002M C,
		                   TBBADDED001M D,
		                   TBDCMACM015M E
		
		             where 1=1
		               and A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# 
		               and SUBSTR(A.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면의 감사기간*/
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.BGRP_TG_ORG_SNO = A.BGRP_TG_ORG_SNO
		               and C.BZT_YR = B.BZT_YR
		               and C.BZT_SNO = B.BZT_SNO
		               and D.AUD_YR = C.REL_AUD_YR
		               and D.AUD_NO = C.REL_AUD_NO
		               and E.ORG_CD = B.ORG_CD
		             group by A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   B.BGRP_TG_ORG_SNO,
		                   C.AUD_STEP_SNO ) AA,
		           (select 
		                   BZT_YR,
		                   BZT_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 1
		                         else 0
		                       end) as IN_PSON_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else 1
		                       end) as EXT_PSON_CNT
		              from (select distinct BZT_YR,
		                           BZT_SNO,
		                           PCT_CNB,
		                           STF_DVSN_CD
		                      from TBBADDED005L) A
		             group by BZT_YR,
		                   BZT_SNO ) BB,
		           (select 
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.BGRP_TG_ORG_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                         else 0
		                       end) as IN_PSON_MAN_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else B.AUD_DCN
		                       end) as EXT_PSON_MAN_CNT
		              from TBBADDED005L A,
		                   TBBADDED006L B,
		                   TBBADDED008L C
		             where 1 = 1
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# 
		               and SUBSTR(B.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면의 감사기간*/
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		               and C.BZT_YR = B.BZT_YR
		               and C.BZT_SNO = B.BZT_SNO
		               and C.TEAM_SNO = B.TEAM_SNO
		               and C.BGRP_TG_ORG_SNO = B.BGRP_TG_ORG_SNO
		             group by A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.BGRP_TG_ORG_SNO ) CC,
		           (select /*+ INDEX(A KBBADBADDED005001) INDEX(B KBBADBADDED006001)*/
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                         else 0
		                       end) as IN_PSON_TOT_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else B.AUD_DCN
		                       end) as EXT_PSON_TOT_CNT,
		                   MIN(B.AUD_STR_DT) as SDATE,
		                   MAX(B.AUD_END_DT) as EDATE
		              from TBBADDED005L A,
		                   TBBADDED006L B
		             where 1 = 1
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		               and A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# 
		               and SUBSTR(B.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면의 감사기간*/
		             group by A.BZT_YR,
		                   A.BZT_SNO ) DD,
		           (select BZT_YR,
		                   BZT_SNO,
		                   COUNT(DISTINCT ORG_CD) ORG_CNT
		             from TBBADDED008L
		             WHERE BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /*화면의 감사기간*/
		             group by BZT_YR,
		                   BZT_SNO) EE
		     where 1 = 1
		       and BB.BZT_YR = AA.BZT_YR
		       and BB.BZT_SNO = AA.BZT_SNO
		       and CC.BZT_YR = AA.BZT_YR
		       and CC.BZT_SNO = AA.BZT_SNO
		       and CC.TEAM_SNO = AA.TEAM_SNO
		       and CC.BGRP_TG_ORG_SNO = AA.BGRP_TG_ORG_SNO
		       and DD.BZT_YR = CC.BZT_YR
		       and DD.BZT_SNO = CC.BZT_SNO
		       and EE.BZT_YR = DD.BZT_YR
		       and EE.BZT_SNO = DD.BZT_SNO
		     group by AA.BZT_YR,
		           AA.BZT_SNO,
		           AA.TEAM_SNO,
		           AA.AUD_STR_DT,
		           AA.AUD_END_DT,
		           AA.AUD_DCN,
		           AA.ORG_NM,
		           AA.AUD_STEP_SNO
		    ) C
		WHERE A.AUD_TASK_CD = B.AUD_TASK_CD
		  AND A.AUD_YR      = B.AUD_YR
		  AND B.AUD_TASK_CD = C.AUD_TASK_CD
		  AND B.ORG_DVSN_CD = C.ORG_DVSN_CD
		  AND B.BZT_YR      = C.BZT_YR
		  AND B.BZT_SNO     = C.BZT_SNO 
		order by C.FULL_AUD_NO
        ]]>
	</select>	

	<!-- 감사종류별 명세  -->
	<select id="BADDED008QSelect1Page" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />	
        <![CDATA[  	
			 SELECT  F_CODE_NM('1000007',AUD_KND_CD)                                                               AS AUD_EXEC_DVSN_CD_NM
			        ,AUD_YR                                                                                        AS AUD_YR
			        ,AUD_NO                                                                                        AS AUD_NO
			        ,AUD_KND_CD                                                                                    AS AUD_KND_CD
			        ,AUD_SNO                                                                                       AS AUD_SNO
			        ,AUD_SBJ_NM                                                                                    AS AUD_SBJ_NM
			        ,C_ORG_CNT                                                                                     AS ORG_CNT     
			        ,TO_CHAR(TO_DATE(SDATE),'YYYY.MM.DD') || '~' || TO_CHAR(TO_DATE(EDATE),'YYYY.MM.DD')           AS AUD_DATE
			        ,DAYS                                                                                          AS DAYS         
			        ,IN_PSON_MAN_TOT || '(' || EXT_PSON_MAN_TOT || ')'                                             AS PSON_MAN_TOT
			        ,ORG_NM                                                                                        AS ORG_NM
			        ,CD_NM                                                                                         AS CD_NM
			        ,TO_CHAR(TO_DATE(AUD_SDATE),'YYYY.MM.DD') || '~' || TO_CHAR(TO_DATE(AUD_EDATE),'YYYY.MM.DD')   AS BZT_DATE
			        ,AUD_DAYS                                                                                      AS AUD_DAYS
			        ,C_IN_PSON_CNT   || '(' || C_IN_PSON_MAN_DAY  || ')'                                           AS IN_PSON
			        ,C_EXT_PSON_CNT  || '(' || C_EXT_PSON_MAN_DAY || ')'                                           AS EXT_PSON
			   FROM TBBADDED029L
			  WHERE DVSN_CD = '1'
			    AND SUBSTR(AUD_SDATE,1,6) BETWEEN #strBztStYY# || #strBztStMM#  AND #strBztEndYY# || #strBztEndMM#			        
        ]]>
        <include refid="include.pageOrder" />         
	</select>		
	<select id="BADDED008QSelect1Page_tmp" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />	
        <![CDATA[  	

			 SELECT  F_CODE_NM('1000007',B.AUD_KND_CD)                                                               AS AUD_EXEC_DVSN_CD_NM
			        ,B.AUD_YR                                                                                        AS AUD_YR
			        ,B.AUD_NO                                                                                        AS AUD_NO
			        ,B.AUD_KND_CD                                                                                    AS AUD_KND_CD
			        ,C.AUD_SNO                                                                                       AS AUD_SNO
			        ,C.AUD_SBJ_NM                                                                                    AS AUD_SBJ_NM
			        ,C.ORG_CNT                                                                                       AS ORG_CNT     
			        ,TO_CHAR(TO_DATE(C.SDATE),'YYYY.MM.DD') || '~' || TO_CHAR(TO_DATE(C.EDATE),'YYYY.MM.DD')         AS AUD_DATE
			        ,C.DAYS                                                                                          AS DAYS         
			        ,C.IN_PSON_MAN_TOT || '(' || C.EXT_PSON_MAN_TOT || ')'                                           AS PSON_MAN_TOT
			        ,C.ORG_NM                                                                                        AS ORG_NM
			        ,C.CD_NM                                                                                         AS CD_NM
			        ,TO_CHAR(TO_DATE(C.AUD_SDATE),'YYYY.MM.DD') || '~' || TO_CHAR(TO_DATE(C.AUD_EDATE),'YYYY.MM.DD') AS BZT_DATE
			        ,C.AUD_DAYS                                                                                      AS AUD_DAYS
			        ,C.IN_PSON_CNT   || '(' || C.IN_PSON_MAN_DAY  || ')'                                             AS IN_PSON
			        ,C.EXT_PSON_CNT  || '(' || C.EXT_PSON_MAN_DAY || ')'                                             AS EXT_PSON
			from  (
			        select A.AUD_YR, A.AUD_NO, A.AUD_KND_CD
			        from TBBADDED001M A, TBBADDED002M B, TBBADDED008L C, TBBADDED005L D, TBBADDED006L E
			          where 1 =1 
			             and B.REL_AUD_YR = A.AUD_YR
			             and B.REL_AUD_NO = A.AUD_NO
			             and B.BZT_DVSN_CD = '1'
			             and C.BZT_YR = B.BZT_YR
			             and C.BZT_SNO = B.BZT_SNO
			             and D.BZT_YR = B.BZT_YR
			             and D.BZT_SNO = B.BZT_SNO
			             and E.BZT_YR = D.BZT_YR
			             and E.BZT_SNO = D.BZT_SNO
			             and E.TEAM_SNO = D.TEAM_SNO
			             and E.BGRP_TG_ORG_SNO = C.BGRP_TG_ORG_SNO
			             and E.PCT_ALC_SNO = D.PCT_ALC_SNO
			             and SUBSTR(E.AUD_STR_DT,1,6) between #strBztStYY# || #strBztStMM#  and #strBztEndYY# || #strBztEndMM#  /*인자값2*/
			        group by A.AUD_YR, A.AUD_NO, A.AUD_KND_CD
			      ) B,
			      (
			         select F_MNG_KND_AUDYRNO(A.AUD_YR, A.AUD_NO, max(A.AUD_KND_CD), '-') as AUD_SNO,
			               A.AUD_YR,
			               A.AUD_NO,
			               max(A.AUD_KND_CD) AS AUD_KND_CD,
			               max(A.AUD_SBJ_NM) as AUD_SBJ_NM,
			               COUNT(C.ORG_CD) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) ORG_CNT,
			               MIN(MIN(E.AUD_STR_DT))  OVER (PARTITION BY A.AUD_YR,A.AUD_NO) SDATE,
			               MAX(MAX(E.AUD_END_DT))  OVER (PARTITION BY A.AUD_YR,A.AUD_NO) EDATE,
			               SUM(E.AUD_DCN)  OVER (PARTITION BY A.AUD_YR,A.AUD_NO) DAYS,
			               SUM(SUM(CASE
			                     WHEN D.STF_DVSN_CD = '0' THEN E.AUD_DCN
			                     ELSE 0
			                   END))  OVER (PARTITION BY A.AUD_YR,A.AUD_NO) IN_PSON_MAN_TOT,
			               SUM(SUM(
			                   CASE
			                     WHEN D.STF_DVSN_CD = '0' THEN 0
			                     ELSE E.AUD_DCN
			                   END)) OVER (PARTITION BY A.AUD_YR,A.AUD_NO) AS EXT_PSON_MAN_TOT,
			               F.ORG_NM,
			               G.CD_NM,       
			               min(E.AUD_STR_DT) as AUD_SDATE,
			               max(E.AUD_END_DT) as AUD_EDATE,
			               E.AUD_DCN AUD_DAYS,
			               sum(
			                   case
			                     when D.STF_DVSN_CD = '0' then 1
			                     else 0
			                   end) as IN_PSON_CNT,
			               sum(
			                   case
			                     when D.STF_DVSN_CD = '0' then 0
			                     else 1
			                   end) as EXT_PSON_CNT,
			               sum(
			                   case
			                     when D.STF_DVSN_CD = '0' then E.AUD_DCN
			                     else 0
			                   end) as IN_PSON_MAN_DAY,
			               sum(
			                   case
			                     when D.STF_DVSN_CD = '0' then 0
			                     else E.AUD_DCN
			                   end) as EXT_PSON_MAN_DAY
			          from TBBADDED001M A,
			               TBBADDED002M B,
			               TBBADDED008L C,
			               TBBADDED005L D,
			               TBBADDED006L E,
			               TBDCMACM015M F,
			               (select CD,
			                       CD_NM
			                  from TBDCMACM013C
			                 where CMM_CD_DVSN_CD = '1000119') G
			         where 1 =1
			           and A.AUD_YR BETWEEN  #strBztStYY# AND #strBztEndYY# /*인자값1*/
			           and B.REL_AUD_YR = A.AUD_YR
			           and B.REL_AUD_NO = A.AUD_NO
			           and B.BZT_DVSN_CD = '1'
			           and C.BZT_YR = B.BZT_YR
			           and C.BZT_SNO = B.BZT_SNO
			           and D.BZT_YR = B.BZT_YR
			           and D.BZT_SNO = B.BZT_SNO
			           and E.BZT_YR = D.BZT_YR
			           and E.BZT_SNO = D.BZT_SNO
			           and E.TEAM_SNO = D.TEAM_SNO
			           and E.BGRP_TG_ORG_SNO = C.BGRP_TG_ORG_SNO
			           and E.PCT_ALC_SNO = D.PCT_ALC_SNO
			           and SUBSTR(E.AUD_STR_DT,1,6) between #strBztStYY# || #strBztStMM#  and #strBztEndYY# || #strBztEndMM#   /*인자값3*/
			           and F.ORG_CD = C.ORG_CD
			           and G.CD = A.ORG_DVSN_CD
			         group by A.AUD_YR,
			               A.AUD_NO,
			               C.ORG_CD,
			               D.STF_DVSN_CD,
			               E.AUD_DCN,
			               F.ORG_NM,
			               G.CD_NM      
			      ) C
			 where 1=1
			   AND B.AUD_YR = C.AUD_YR
			   AND B.AUD_NO = C.AUD_NO
			   AND B.AUD_KND_CD = C.AUD_KND_CD
        ]]>
        <include refid="include.pageOrder" />         
	</select>	
	
	<!-- 대상기관별 감사종류별 현황  -->
	<select id="BADDED008QSelect2_1Page" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />	
        <![CDATA[  
			/*인자값
			  1) 화면의 감사기간 년도 FROM ~ TO --필수
			  2) 화면의 감사기간 년월 FROM ~ TO --필수
			  3) 화면의 기관코드범위 FROM ~ TO 
			*/
			
			SELECT /*+ LEADING(SITU,AUD,ORG,TTO,PSON) */ 
			       F_ORG_INFO(ORG.ORG_CD,'1') ORG_NM,
			       ORG.ORG_CD,
			       SUM(PSON.AUD_DCN) AS AUD_DAY_TOT,  /*총계_일수*/
			       SUM(PSON.MAN_DAY ) AS MAN_DAY_TOT, /*총계_연인원*/
			       SUM (TTO.ORG_CNT ) AS ORG_CNT_TOT, /*총계_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) + COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) + COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) + COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) + COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) > '4' THEN AUD.AUD_NO 
			                         ELSE NULL
			                       END) AS AUD_ITEM_TOT, /* 총계_사항*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN PSON.AUD_DCN
			                         ELSE 0
			                       END) AS AUD_DAYS1,  /*재무감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN PSON.MAN_DAY
			                         ELSE 0
			                       END) AS MAN_DAY1,  /*재무감사_연인원*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN TTO.ORG_CNT
			                         ELSE 0
			                       END) AS ORG_CNT1,  /*재무감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT1, /*재무감사_사항*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN PSON.AUD_DCN
			                         ELSE 0
			                       END) AS AUD_DAYS2, /*특정과제감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN PSON.MAN_DAY
			                         ELSE 0
			                       END) AS MAN_DAY2, /*특정과제감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN TTO.ORG_CNT
			                         ELSE 0
			                       END) AS ORG_CNT2, /*특정과제감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT2, /*특정과제감사_사항*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN PSON.AUD_DCN
			                         ELSE 0
			                       END) AS AUD_DAYS3, /*사업성과감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN PSON.MAN_DAY
			                         ELSE 0 
			                       END) AS MAN_DAY3, /*사업성과감사_연인원*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN TTO.ORG_CNT
			                         ELSE 0
			                       END) AS ORG_CNT3,  /*사업성과감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT3, /*사업성과감사_사항*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN PSON.AUD_DCN
			                         ELSE 0
			                       END) AS AUD_DAYS4, /*기관운영성과감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN PSON.MAN_DAY
			                         ELSE 0
			                       END) AS MAN_DAY4,  /*기관운영성과감사_연인원*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN TTO.ORG_CNT
			                         ELSE 0
			                       END) AS ORG_CNT4, /*기관운영성과감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN AUD.AUD_NO
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT4, /*기관운영성과감사_감사*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN PSON.AUD_DCN 
			                         ELSE 0
			                       END) AS AUD_DAYS5, /*기타감사_일수*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN PSON.MAN_DAY 
			                         ELSE 0
			                       END) AS MAN_DAY5, /*기타감사_연인원*/
			       SUM(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN TTO.ORG_CNT 
			                         ELSE 0
			                       END) AS ORG_CNT5,  /*기타감사_기관*/
			       COUNT(
			                       CASE
			                         WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN AUD.AUD_NO 
			                         ELSE NULL
			                       END) AS AUD_ITEM_CNT5 /*기타감사_사항*/
			  FROM TBBADDED002M SITU,
			       TBBADDED001M AUD,
			       TBBADDED008L ORG,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               MIN(AUD_STR_DT) AS AUD_STR_DT,
			               MAX(AUD_END_DT) AS AUD_END_DT,
			               MAX(AUD_DCN) AS AUD_DCN,
			               SUM(AUD_DCN) AS MAN_DAY
			          FROM (SELECT TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB,
			                       MIN(PTD.AUD_STR_DT) AS AUD_STR_DT,
			                       MAX(PTD.AUD_END_DT) AS AUD_END_DT,
			                       SUM(PTD.AUD_DCN) AS AUD_DCN
			                  FROM TBBADDED005L TMA,
			                       TBBADDED006L PTD
			                 WHERE PTD.BZT_YR = TMA.BZT_YR
			                   AND PTD.BZT_SNO = TMA.BZT_SNO
			                   AND PTD.TEAM_SNO = TMA.TEAM_SNO
			                   AND PTD.PCT_ALC_SNO = TMA.PCT_ALC_SNO
			                   AND PTD.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# /*인자값1*/
			                   AND SUBSTR(PTD.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*인자값2*/
			                 GROUP BY TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB) PTD1
			         GROUP BY BZT_YR,
			               BZT_SNO ) PSON,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               COUNT(*) AS ORG_CNT
			          FROM (SELECT DISTINCT BZT_YR,
			                       BZT_SNO,
			                       BGRP_TG_ORG_SNO
			                  FROM TBBADDED008L
			                 WHERE SUBSTR(AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM# /*인자값2*/
			               ) TTO0
			         GROUP BY BZT_YR,
			               BZT_SNO ) TTO
			 WHERE SITU.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# /*인자값1*/
			   AND SITU.REL_AUD_YR = AUD.AUD_YR
			   AND SITU.REL_AUD_NO = AUD.AUD_NO
			   AND SITU.BZT_DVSN_CD ='1'
			   AND ORG.BZT_YR = SITU.BZT_YR
			   AND ORG.BZT_SNO = SITU.BZT_SNO
        ]]>
        <isNotEmpty property="strOrgCdSt">
	        <![CDATA[
	        	AND ORG.ORG_CD >=#strOrgCdSt#
	        ]]>
        </isNotEmpty>

        <isNotEmpty property="strOrgCdEnd">
	        <![CDATA[
	        	AND ORG.ORG_CD <=#strOrgCdEnd#
	        ]]>
        </isNotEmpty>			          			   
        <![CDATA[  
			   AND PSON.BZT_YR = SITU.BZT_YR
			   AND PSON.BZT_SNO = SITU.BZT_SNO
			   AND TTO.BZT_YR = SITU.BZT_YR
			   AND TTO.BZT_SNO = SITU.BZT_SNO
			 GROUP BY ORG.ORG_CD         
        ]]>
        <include refid="include.pageOrder" />         
	</select>	
	
		<!-- 대상기관별 명세  -->
	<select id="BADDED008QSelect2Page" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />	
        <![CDATA[  	
		SELECT   B.GUBUN                                                                                            AS GUBUN
		        ,B.AUD_EXEC_DVSN_CD_NM                                                                              AS AUD_EXEC_DVSN_CD_NM
				,B.FULL_AUD_NO                                                                                      AS AUD_SNO 
		        ,B.AUD_SBJ_NM		                                                                                AS AUD_SBJ_NM		
		        ,B.ORG_CNT                                                                                          AS ORG_CNT
		        ,TO_CHAR(TO_DATE(B.AUD_STR_DT),'YYYY.MM.DD') || '~' || TO_CHAR(TO_DATE(B.AUD_END_DT),'YYYY.MM.DD')  AS AUD_DATE
		        ,B.AUD_DCN                                                                                          AS DAYS
		        ,B.IN_PSON_TOT_CNT || '(' || B.EXT_PSON_TOT_CNT || ')'                                              AS PSON_MAN_TOT      
		        ,A.ORG_NM	                                                                                        AS ORG_NM	        		        
		        ,TO_CHAR(TO_DATE(B.SDATE),'YYYY.MM.DD') || '~' || TO_CHAR(TO_DATE(B.EDATE),'YYYY.MM.DD')            AS BZT_DATE
		        ,B.AUD_DCN                                                                                          AS AUD_DAYS
			    ,B.IN_PSON_CNT   || '/' || B.IN_PSON_MAN_CNT                                                        AS IN_PSON
			    ,B.EXT_PSON_CNT  || '/' || B.EXT_PSON_MAN_CNT                                                       AS EXT_PSON
		FROM 
		(
		    select 
		           A.BZT_YR,
		           B.ORG_CD,  
		           F_ORG_INFO(B.ORG_CD,'1') ORG_NM 
		      from TBBADDED006L A,
		           TBBADDED008L B,
		           TBBADDED002M C
		     where 1=1
		       and B.BZT_YR  = A.BZT_YR
		       and B.BZT_SNO = A.BZT_SNO   
		       and C.BZT_YR = B.BZT_YR
		       and C.BZT_SNO = B.BZT_SNO
		       and A.BZT_YR between #strBztStYY# and #strBztEndYY#  /* 인자값1  화면 감사년도from ~ to*/
		       and SUBSTR(A.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		       and B.ORG_CD between #strOrgCdSt# and #strOrgCdEnd#  /* 인자값3 화면의 기관코드범위 From ~ to  */   
		       and C.BZT_DVSN_CD = '1'
		     group by A.BZT_YR,
		              B.ORG_CD
		) A,
		(
		select /*+NO_MERGE*/
		       F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as GUBUN,
		       F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as FULL_AUD_NO,		       
		       AA.BZT_YR,
		       AA.BZT_SNO,
		       AA.TEAM_SNO,
		       AA.AUD_STR_DT,
		       AA.AUD_END_DT,
		       AA.AUD_DCN,
		       AA.ORG_CD,
		       AA.ORG_NM,
		       max(AA.AUD_YR) as AUD_YR,
		       max(AA.AUD_NO) as AUD_NO,
		       max(AA.AUD_TASK_CD) as AUD_TASK_CD,
		       max(AA.ORG_DVSN_CD) as ORG_DVSN_CD,
		       max(AA.AUD_KND_CD) as AUD_KND_CD,
		       max(AA.SPV_BRDV_CD) as SPV_BRDV_CD,
		       max(AA.AUD_WAY_CD) as AUD_WAY_CD,
		       max(AA.AUD_EXEC_DVSN_CD_NM) as AUD_EXEC_DVSN_CD_NM,
		       max(AA.AUD_SBJ_NM) as AUD_SBJ_NM,
		       AA.AUD_STEP_SNO,
		       max(BB.IN_PSON_CNT) as IN_PSON_CNT,
		       max(BB.EXT_PSON_CNT) as EXT_PSON_CNT,
		       max(CC.IN_PSON_MAN_CNT) as IN_PSON_MAN_CNT,
		       max(CC.EXT_PSON_MAN_CNT) as EXT_PSON_MAN_CNT,
		       max(DD.IN_PSON_TOT_CNT) as IN_PSON_TOT_CNT,
		       max(DD.EXT_PSON_TOT_CNT) as EXT_PSON_TOT_CNT,
		       min(DD.SDATE) as SDATE,
		       max(DD.EDATE) as EDATE,
		       '' as DAYS,
		       max(EE.ORG_CNT) as ORG_CNT
		  from (select A.BZT_YR,
		               A.BZT_SNO,
		               A.TEAM_SNO,
		               C.AUD_STEP_SNO,
		               min( A.AUD_STR_DT) as AUD_STR_DT,
		               max(A.AUD_END_DT) as AUD_END_DT,
		               max(A.AUD_DCN) as AUD_DCN,
		               B.BGRP_TG_ORG_SNO,
		               max(D.AUD_YR) as AUD_YR,
		               max(D.AUD_NO) as AUD_NO,
		               max(D.AUD_TASK_CD) as AUD_TASK_CD,
		               max(D.ORG_DVSN_CD) as ORG_DVSN_CD,
		               max(D.AUD_KND_CD) as AUD_KND_CD,
		               max(D.SPV_BRDV_CD) as SPV_BRDV_CD,
		               max(D.AUD_WAY_CD) as AUD_WAY_CD,
		               max(D.AUD_SBJ_NM) as AUD_SBJ_NM,
		               max(B.ORG_CD) AS ORG_CD,
		               F_ORG_INFO(max(B.ORG_CD),'1') ORG_NM, 
		               F_CODE_NM('1000007',MAX(D.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
		            from TBBADDED006L A,
		               TBBADDED008L B,
		               TBBADDED002M C,
		               TBBADDED001M D
		         where 1=1
		           and A.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		           and SUBSTR(A.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		           and B.BZT_YR = A.BZT_YR
		           and B.BZT_SNO = A.BZT_SNO
		           and B.TEAM_SNO = A.TEAM_SNO
		           and B.BGRP_TG_ORG_SNO = A.BGRP_TG_ORG_SNO
		           and C.BZT_YR = B.BZT_YR
		           and C.BZT_SNO = B.BZT_SNO
		           and D.AUD_YR = C.REL_AUD_YR
		           and D.AUD_NO = C.REL_AUD_NO
		         group by A.BZT_YR,
		               A.BZT_SNO,
		               A.TEAM_SNO,
		               B.BGRP_TG_ORG_SNO,
		               C.AUD_STEP_SNO ) AA,
		       (select 
		               BZT_YR,
		               BZT_SNO,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then 1
		                     else 0
		                   end) as IN_PSON_CNT,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then 0
		                     else 1
		                   end) as EXT_PSON_CNT
		          from (select distinct BZT_YR,
		                       BZT_SNO,
		                       PCT_CNB,
		                       STF_DVSN_CD
		                  from TBBADDED005L
		                 WHERE BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		                 ) A
		         group by BZT_YR,
		               BZT_SNO ) BB,
		       (select  
		               A.BZT_YR,
		               A.BZT_SNO,
		               A.TEAM_SNO,
		               C.BGRP_TG_ORG_SNO,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                     else 0
		                   end) as IN_PSON_MAN_CNT,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then 0
		                     else B.AUD_DCN
		                   end) as EXT_PSON_MAN_CNT
		          from TBBADDED005L A,
		               TBBADDED006L B,
		               TBBADDED008L C
		         where 1 = 1
		           and B.BZT_YR = A.BZT_YR
		           and B.BZT_SNO = A.BZT_SNO
		           and B.TEAM_SNO = A.TEAM_SNO
		           and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		           and C.BZT_YR = B.BZT_YR
		           and C.BZT_SNO = B.BZT_SNO
		           and C.TEAM_SNO = B.TEAM_SNO
		           and C.BGRP_TG_ORG_SNO = B.BGRP_TG_ORG_SNO
		           and A.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		           and SUBSTR(B.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		         group by A.BZT_YR,
		               A.BZT_SNO,
		               A.TEAM_SNO,
		               C.BGRP_TG_ORG_SNO ) CC,
		       (select A.BZT_YR,
		               A.BZT_SNO,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                     else 0
		                   end) as IN_PSON_TOT_CNT,
		               sum(
		                   case
		                     when A.STF_DVSN_CD = '0' then 0
		                     else B.AUD_DCN
		                   end) as EXT_PSON_TOT_CNT,
		               MIN(B.AUD_STR_DT) as SDATE,
		               MAX(B.AUD_END_DT) as EDATE
		          from TBBADDED005L A,
		               TBBADDED006L B
		         where 1 = 1
		           and B.BZT_YR = A.BZT_YR
		           and B.BZT_SNO = A.BZT_SNO
		           and B.TEAM_SNO = A.TEAM_SNO
		           and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		           and A.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		           and SUBSTR(B.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		         group by A.BZT_YR,
		               A.BZT_SNO ) DD,
		       (select BZT_YR,
		               BZT_SNO,
		               COUNT(DISTINCT ORG_CD) ORG_CNT
		         from TBBADDED008L 
		         WHERE BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		         group by BZT_YR,
		               BZT_SNO) EE
		 where 1 = 1
		   and BB.BZT_YR = AA.BZT_YR
		   and BB.BZT_SNO = AA.BZT_SNO
		   and CC.BZT_YR = AA.BZT_YR
		   and CC.BZT_SNO = AA.BZT_SNO
		   and CC.TEAM_SNO = AA.TEAM_SNO
		   and CC.BGRP_TG_ORG_SNO = AA.BGRP_TG_ORG_SNO
		   and DD.BZT_YR = CC.BZT_YR
		   and DD.BZT_SNO = CC.BZT_SNO
		   and EE.BZT_YR = DD.BZT_YR
		   and EE.BZT_SNO = DD.BZT_SNO
		 group by AA.BZT_YR,
		       AA.BZT_SNO,
		       AA.TEAM_SNO,
		       AA.AUD_STR_DT,
		       AA.AUD_END_DT,
		       AA.AUD_DCN,
		       AA.ORG_CD,
		       AA.ORG_NM,
		       AA.AUD_STEP_SNO 
		
		) B
		WHERE A.BZT_YR = B.BZT_YR
		  AND A.ORG_CD = B.ORG_CD
        ]]>
        <include refid="include.pageOrder" />         
	</select>	
	
	
	<!-- 주관국과별 감사종류별 현황 화면 -->
	<select id="BADDED008QSelect3_1Page" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />		
        <![CDATA[  
			SELECT F_DPT_INFO(AUD.SPV_BRDV_CD ,'1') DPT_NM, /*국과*/
			
			       SUM(PSON.AUD_DCN) AS AUD_DAY_TOT,  /*총계_일수*/
			       SUM(PSON.MAN_DAY ) AS MAN_DAY_TOT, /*총계_연인원*/
			       SUM (TTO.ORG_CNT ) AS ORG_CNT_TOT, /*총계_기관*/
			       COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN AUD.AUD_NO 
			                 ELSE NULL
			               END) AS AUD_ITEM_TOT, /*총계_사항*/
			               
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN PSON.AUD_DCN
			                     ELSE 0
			                   END) AS AUD_DAYS1, /*재무감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN PSON.MAN_DAY
			                     ELSE 0
			                   END) AS MAN_DAY1, /*재무감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN TTO.ORG_CNT
			                     ELSE 0
			                   END) AS ORG_CNT1, /*재무감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='1' THEN AUD.AUD_NO
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT1, /*재무감사_사항*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN PSON.AUD_DCN
			                     ELSE 0
			                   END) AS AUD_DAYS2, /*특정과제감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN PSON.MAN_DAY
			                     ELSE 0
			                   END) AS MAN_DAY2, /*특정과제감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN TTO.ORG_CNT
			                     ELSE 0
			                   END) AS ORG_CNT2, /*특정과제감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='2' THEN AUD.AUD_NO
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT2, /*특정과제감사_사항*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN PSON.AUD_DCN
			                     ELSE 0
			                   END) AS AUD_DAYS3, /*사업성과감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN PSON.MAN_DAY
			                     ELSE 0
			                   END) AS MAN_DAY3,  /*사업성과감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN TTO.ORG_CNT
			                     ELSE 0
			                   END) AS ORG_CNT3,  /*사업성과감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='3' THEN AUD.AUD_NO
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT3,  /*사업성과감사_기관*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN PSON.AUD_DCN
			                     ELSE 0
			                   END) AS AUD_DAYS4, /*기업운영성과감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN PSON.MAN_DAY
			                     ELSE 0
			                   END) AS MAN_DAY4, /*기업운영성과감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN TTO.ORG_CNT
			                     ELSE 0
			                   END) AS ORG_CNT4, /*기업운영성과감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1)='4' THEN AUD.AUD_NO
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT4, /*기업운영성과감사_사항*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN PSON.AUD_DCN 
			                     ELSE 0
			                   END) AS AUD_DAYS5, /*기타감사_일수*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN PSON.MAN_DAY 
			                     ELSE 0
			                   END) AS MAN_DAY5, /*기타감사_연인원*/
			               SUM(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN TTO.ORG_CNT 
			                     ELSE 0
			                   END) AS ORG_CNT5, /*기타감사_기관*/
			               COUNT(
			                   CASE
			                     WHEN SUBSTR(AUD.AUD_KND_CD, 3, 1) >'4' THEN AUD.AUD_NO 
			                     ELSE NULL
			                   END) AS AUD_ITEM_CNT5 /*기타감사_사항*/
			  FROM TBBADDED002M SITU,
			       TBBADDED001M AUD,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               MIN(AUD_STR_DT) AS AUD_STR_DT,
			               MAX(AUD_END_DT) AS AUD_END_DT,
			               MAX(AUD_DCN) AS AUD_DCN,
			               SUM(AUD_DCN) AS MAN_DAY
			          FROM (SELECT TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB,
			                       MIN(PTD.AUD_STR_DT) AS AUD_STR_DT,
			                       MAX(PTD.AUD_END_DT) AS AUD_END_DT,
			                       SUM(PTD.AUD_DCN) AS AUD_DCN
			                  FROM TBBADDED005L TMA,
			                       TBBADDED006L PTD
			                 WHERE PTD.BZT_YR = TMA.BZT_YR
			                   AND PTD.BZT_SNO = TMA.BZT_SNO
			                   AND PTD.TEAM_SNO = TMA.TEAM_SNO
			                   AND PTD.PCT_ALC_SNO = TMA.PCT_ALC_SNO
			                   AND PTD.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY#   /*화면 감사년도 FROM ~ TO*/
			                   AND SUBSTR(PTD.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면 감사기간 FROM ~ TO*/
			                 GROUP BY TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB) PTD1
			         GROUP BY BZT_YR,
			               BZT_SNO ) PSON,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               COUNT(*) AS ORG_CNT
			          FROM (SELECT DISTINCT BZT_YR,
			                       BZT_SNO,
			                       BGRP_TG_ORG_SNO
			                  FROM TBBADDED008L
			                 WHERE SUBSTR(AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#    /*화면 감사기간 FROM ~ TO*/
			               ) TTO0
			         GROUP BY BZT_YR,
			               BZT_SNO ) TTO
			 WHERE AUD.AUD_YR BETWEEN #strBztStYY# AND #strBztEndYY#   /*화면 감사년도 FROM ~ TO*/
			   AND SITU.REL_AUD_YR = AUD.AUD_YR
			   AND SITU.REL_AUD_NO = AUD.AUD_NO
			   AND SITU.BZT_DVSN_CD ='1'
			   AND PSON.BZT_YR = SITU.BZT_YR
			   AND PSON.BZT_SNO = SITU.BZT_SNO
			   AND TTO.BZT_YR = SITU.BZT_YR
			   AND TTO.BZT_SNO = SITU.BZT_SNO
		]]>
		<isNotEmpty property="strSpvBrdvCd">
			   AND SUBSTR(AUD.SPV_BRDV_CD,1,3) = SUBSTR(#strSpvBrdvCd#,1,3) 	/*화면 주관실국*/
		</isNotEmpty>			   
        <![CDATA[  			   
			 GROUP BY AUD.SPV_BRDV_CD
        ]]>
        <include refid="include.pageOrder" />            
	</select>

	<!-- 감사방침별 기관구분별 현황 화면 -->
	<select id="BADDED008QSelect4_1Page" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />		
        <![CDATA[  
			SELECT  F_CODE_NM('1000008',AUD.AUD_TASK_CD) STRTG_GOAL_NM,  /*감사방침*/
			        SUM(PSON.AUD_DCN) AS AUD_DAY_TOT,  /*총계_일수 */
			        SUM(PSON.MAN_DAY ) AS MAN_DAY_TOT, /*총계_연인원*/
			        SUM (TTO.ORG_CNT ) AS ORG_CNT_TOT,  /*총계_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) + COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD >'30' THEN AUD.AUD_NO 
			                 ELSE NULL
			               END) AS AUD_ITEM_TOT, /*총계_사항 */
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN PSON.AUD_DCN
			                 ELSE 0
			               END) AS AUD_DAYS1,  /*국가기관_일수*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN PSON.MAN_DAY
			                 ELSE 0
			               END) AS MAN_DAY1, /*국가기관_연인원*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN TTO.ORG_CNT
			                 ELSE 0
			               END) AS ORG_CNT1, /*국가기관_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='10' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) AS AUD_ITEM_CNT1,  /*국가기관_사항*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN PSON.AUD_DCN
			                 ELSE 0
			               END) AS AUD_DAYS2, /*자치단체_일수*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN PSON.MAN_DAY
			                 ELSE 0
			               END) AS MAN_DAY2, /*자치단체_연인원*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN TTO.ORG_CNT
			                 ELSE 0
			               END) AS ORG_CNT2, /*자치단체_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD IN ('21','22') THEN AUD.AUD_NO
			                 ELSE NULL
			               END) AS AUD_ITEM_CNT2, /*자치단체_사항*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN PSON.AUD_DCN
			                 ELSE 0
			               END) AS AUD_DAYS3, /*투자기관_일수*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN PSON.MAN_DAY
			                 ELSE 0
			               END) AS MAN_DAY3, /*투자기관_연인원*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN TTO.ORG_CNT
			                 ELSE 0
			               END) AS ORG_CNT3, /*투자기관_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD='30' THEN AUD.AUD_NO
			                 ELSE NULL
			               END) AS AUD_ITEM_CNT3, /*투자기관_사항*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD >'30' THEN PSON.AUD_DCN 
			                 ELSE 0
			               END) AS AUD_DAYS4, /*기타기관_일수*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD >'30' THEN PSON.MAN_DAY 
			                 ELSE 0
			               END) AS MAN_DAY4, /*기타기관_연인원*/
			        SUM(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD >'30' THEN TTO.ORG_CNT 
			                 ELSE 0
			               END) AS ORG_CNT4, /*기타기관_기관*/
			        COUNT(
			               CASE
			                 WHEN AUD.ORG_DVSN_CD  >'30' THEN AUD.AUD_NO 
			                 ELSE NULL
			               END) AS AUD_ITEM_CNT4 /*기타기관_사항*/
			  FROM TBBADDED002M SITU,
			       TBBADDED001M AUD,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               MIN(AUD_STR_DT) AS AUD_STR_DT,
			               MAX(AUD_END_DT) AS AUD_END_DT,
			               MAX(AUD_DCN) AS AUD_DCN,
			               SUM(AUD_DCN) AS MAN_DAY
			          FROM (SELECT TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB,
			                       MIN(PTD.AUD_STR_DT) AS AUD_STR_DT,
			                       MAX(PTD.AUD_END_DT) AS AUD_END_DT,
			                       SUM(PTD.AUD_DCN) AS AUD_DCN
			                  FROM TBBADDED005L TMA,
			                       TBBADDED006L PTD
			                 WHERE PTD.BZT_YR = TMA.BZT_YR
			                   AND PTD.BZT_SNO = TMA.BZT_SNO
			                   AND PTD.TEAM_SNO = TMA.TEAM_SNO
			                   AND PTD.PCT_ALC_SNO = TMA.PCT_ALC_SNO
			                   AND PTD.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# /*화면 감사년도 */
			                   AND SUBSTR(PTD.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#    /*화면 감사기간*/
			                 GROUP BY TMA.BZT_YR,
			                       TMA.BZT_SNO,
			                       TMA.PCT_CNB) PTD1
			         GROUP BY BZT_YR,
			               BZT_SNO ) PSON,
			       (SELECT BZT_YR,
			               BZT_SNO,
			               COUNT(*) AS ORG_CNT
			          FROM (SELECT DISTINCT BZT_YR,
			                       BZT_SNO,
			                       BGRP_TG_ORG_SNO
			                  FROM TBBADDED008L
			                 WHERE SUBSTR(AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면 감사기간*/
			                 ) TTO0
			         GROUP BY BZT_YR,
			               BZT_SNO ) TTO
			 WHERE AUD.AUD_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /*화면 감사년도*/
			   AND SITU.REL_AUD_YR = AUD.AUD_YR
			   AND SITU.REL_AUD_NO = AUD.AUD_NO
			   AND SITU.BZT_DVSN_CD ='1'
			   AND PSON.BZT_YR = SITU.BZT_YR
			   AND PSON.BZT_SNO = SITU.BZT_SNO
			   AND TTO.BZT_YR = SITU.BZT_YR
			   AND TTO.BZT_SNO = SITU.BZT_SNO
			   AND SUBSTR(AUD.AUD_TASK_CD,-1) BETWEEN #strAudTaskCdSt# AND #strAudTaskCdEnd#  /*화면 감사지침 1~9*/
			 GROUP BY AUD.AUD_YR,
			       AUD.AUD_TASK_CD         
        ]]>
        <include refid="include.pageOrder" />   
	</select>
	
	<!-- 주관국가별 명세  -->
	<select id="BADDED008QSelect3Page" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />		
        <![CDATA[  	
		SELECT   A.DPT_NM
		        ,B.GUBUN
		        ,B.FULL_AUD_NO /*기존 AUD_NO 중복으로 변경*/
		        ,B.BZT_YR
		        ,B.BZT_SNO
		        ,B.TEAM_SNO
		        ,B.AUD_STR_DT
		        ,B.AUD_END_DT
		        ,B.AUD_DCN
		        ,B.ORG_NM
		        ,B.AUD_YR
		        ,B.AUD_NO
		        ,B.AUD_TASK_CD
		        ,B.ORG_DVSN_CD
		        ,B.AUD_KND_CD
		        ,B.SPV_BRDV_CD
		        ,B.AUD_WAY_CD
		        ,B.AUD_EXEC_DVSN_CD_NM
		        ,B.AUD_SBJ_NM
		        ,B.AUD_STEP_SNO
		        ,B.IN_PSON_CNT
		        ,B.EXT_PSON_CNT
		        ,B.IN_PSON_MAN_CNT
		        ,B.EXT_PSON_MAN_CNT
		        ,B.IN_PSON_TOT_CNT
		        ,B.EXT_PSON_TOT_CNT
		        ,B.SDATE
		        ,B.EDATE
		        ,B.DAYS
		        ,B.ORG_CNT
		
		FROM 
		    (
		    select A.BZT_YR,
		           D.SPV_BRDV_CD,
		           F_DPT_INFO(D.SPV_BRDV_CD,'1') DPT_NM
		      from TBBADDED006L A,
		           TBBADDED002M C,
		           TBBADDED001M D
		     where 1=1
		       and A.BZT_YR between #strBztStYY# and #strBztEndYY#  /*화면 감사년도 FROM ~TO*/
		       and SUBSTR(A.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /*화면 감사기간 FROM ~TO*/
		       and A.BZT_YR  = C.BZT_YR
		       and A.BZT_SNO = C.BZT_SNO
		       and C.BZT_DVSN_CD = '1'
		       and D.AUD_YR = C.REL_AUD_YR
		       and D.AUD_NO = C.REL_AUD_NO
		       and D.SPV_BRDV_CD like '010%'  /*화면 주관실국*/
		     group by A.BZT_YR,
		              D.SPV_BRDV_CD
		    ) A,          
		    (         
		    select F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as GUBUN,
				   F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as FULL_AUD_NO,
		           AA.BZT_YR,
		           AA.BZT_SNO,
		           AA.TEAM_SNO,
		           AA.AUD_STR_DT,
		           AA.AUD_END_DT,
		           AA.AUD_DCN,
		           AA.ORG_NM,
		           max(AA.AUD_YR) as AUD_YR,
		           max(AA.AUD_NO) as AUD_NO,
		           max(AA.AUD_TASK_CD) as AUD_TASK_CD,
		           max(AA.ORG_DVSN_CD) as ORG_DVSN_CD,
		           max(AA.AUD_KND_CD) as AUD_KND_CD,
		           max(AA.SPV_BRDV_CD) as SPV_BRDV_CD,
		           max(AA.AUD_WAY_CD) as AUD_WAY_CD,
		           max(AA.AUD_EXEC_DVSN_CD_NM) as AUD_EXEC_DVSN_CD_NM,
		           max(AA.AUD_SBJ_NM) as AUD_SBJ_NM,
		           AA.AUD_STEP_SNO,
		           max(BB.IN_PSON_CNT) as IN_PSON_CNT,
		           max(BB.EXT_PSON_CNT) as EXT_PSON_CNT,
		           max(CC.IN_PSON_MAN_CNT) as IN_PSON_MAN_CNT,
		           max(CC.EXT_PSON_MAN_CNT) as EXT_PSON_MAN_CNT,
		           max(DD.IN_PSON_TOT_CNT) as IN_PSON_TOT_CNT,
		           max(DD.EXT_PSON_TOT_CNT) as EXT_PSON_TOT_CNT,
		           min(DD.SDATE) as SDATE,
		           max(DD.EDATE) as EDATE,
		           '' as DAYS,
		           max(EE.ORG_CNT) as ORG_CNT
		      from (select A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.AUD_STEP_SNO,
		                   min( A.AUD_STR_DT) as AUD_STR_DT,
		                   max(A.AUD_END_DT) as AUD_END_DT,
		                   max(A.AUD_DCN) as AUD_DCN,
		                   B.BGRP_TG_ORG_SNO,
		                   max(D.AUD_YR) as AUD_YR,
		                   max(D.AUD_NO) as AUD_NO,
		                   max(D.AUD_TASK_CD) as AUD_TASK_CD,
		                   max(D.ORG_DVSN_CD) as ORG_DVSN_CD,
		                   max(D.AUD_KND_CD) as AUD_KND_CD,
		                   max(D.SPV_BRDV_CD) as SPV_BRDV_CD,
		                   max(D.AUD_WAY_CD) as AUD_WAY_CD,
		                   max(D.AUD_SBJ_NM) as AUD_SBJ_NM,
		                   F_ORG_INFO(max(B.ORG_CD),'1') ORG_NM, 
		                   F_CODE_NM('1000007',MAX(D.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
		              from TBBADDED006L A,
		                   TBBADDED008L B,
		                   TBBADDED002M C,
		                   TBBADDED001M D
		             where 1=1
		               and A.BZT_YR between #strBztStYY# and #strBztEndYY#  /*감사년도 FROM ~TO*/
		               and SUBSTR(A.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /*화면 감사기간FROM ~TO*/
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.BGRP_TG_ORG_SNO = A.BGRP_TG_ORG_SNO
		               and C.BZT_YR = B.BZT_YR
		               and C.BZT_SNO = B.BZT_SNO
		               and D.AUD_YR = C.REL_AUD_YR
		               and D.AUD_NO = C.REL_AUD_NO
		             group by A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   B.BGRP_TG_ORG_SNO,
		                   C.AUD_STEP_SNO ) AA,
		           (select 
		                   BZT_YR,
		                   BZT_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 1
		                         else 0
		                       end) as IN_PSON_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else 1
		                       end) as EXT_PSON_CNT
		              from (select distinct BZT_YR,
		                           BZT_SNO,
		                           PCT_CNB,
		                           STF_DVSN_CD
		                      from TBBADDED005L
		                      WHERE BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		                      ) A
		             group by BZT_YR,
		                   BZT_SNO ) BB,
		           (select 
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.BGRP_TG_ORG_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                         else 0
		                       end) as IN_PSON_MAN_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else B.AUD_DCN
		                       end) as EXT_PSON_MAN_CNT
		              from TBBADDED005L A,
		                   TBBADDED006L B,
		                   TBBADDED008L C
		             where 1 = 1
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		               and C.BZT_YR = B.BZT_YR
		               and C.BZT_SNO = B.BZT_SNO
		               and C.TEAM_SNO = B.TEAM_SNO
		               and C.BGRP_TG_ORG_SNO = B.BGRP_TG_ORG_SNO
		               and B.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		               and SUBSTR(B.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		             group by A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.BGRP_TG_ORG_SNO ) CC,
		           (select 
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                         else 0
		                       end) as IN_PSON_TOT_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else B.AUD_DCN
		                       end) as EXT_PSON_TOT_CNT,
		                   MIN(B.AUD_STR_DT) as SDATE,
		                   MAX(B.AUD_END_DT) as EDATE
		              from TBBADDED005L A,
		                   TBBADDED006L B
		             where 1 = 1
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		               and B.BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		               and SUBSTR(B.AUD_STR_DT, 1, 6) between #strBztStYY#||#strBztStMM# and #strBztEndYY#||#strBztEndMM#  /* 인자값2 화면 감사기간년월 */
		             group by A.BZT_YR,
		                   A.BZT_SNO ) DD,
		           (select BZT_YR,
		                   BZT_SNO,
		                   COUNT(DISTINCT ORG_CD) ORG_CNT
		             from TBBADDED008L
		             WHERE BZT_YR between #strBztStYY# and #strBztEndYY#   /* 인자값1  화면 감사년도from ~ to*/
		             group by BZT_YR,
		                   BZT_SNO) EE
		     where 1 = 1
		       and BB.BZT_YR = AA.BZT_YR
		       and BB.BZT_SNO = AA.BZT_SNO
		       and CC.BZT_YR = AA.BZT_YR
		       and CC.BZT_SNO = AA.BZT_SNO
		       and CC.TEAM_SNO = AA.TEAM_SNO
		       and CC.BGRP_TG_ORG_SNO = AA.BGRP_TG_ORG_SNO
		       and DD.BZT_YR = CC.BZT_YR
		       and DD.BZT_SNO = CC.BZT_SNO
		       and EE.BZT_YR = DD.BZT_YR
		       and EE.BZT_SNO = DD.BZT_SNO
		     group by AA.BZT_YR,
		           AA.BZT_SNO,
		           AA.TEAM_SNO,
		           AA.AUD_STR_DT,
		           AA.AUD_END_DT,
		           AA.AUD_DCN,
		           AA.ORG_NM,
		           AA.AUD_STEP_SNO 
		    ) B
		WHERE A.BZT_YR = B.BZT_YR 
		  AND A.SPV_BRDV_CD = B.SPV_BRDV_CD
        ]]>
		<include refid="include.pageOrder" />   
	</select>	
	
	<!-- 감사방침별 명세  -->
	<select id="BADDED008QSelect4Page" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />		
        <![CDATA[  	
		SELECT   A.STRTG_GOAL_NM
		        ,B.ORG_TOT_CNT
		        ,B.ORG_TYPE_NM
		        ,B.CNT
		        ,C.GUBUN
		        ,C.FULL_AUD_NO
		        ,C.BZT_YR
		        ,C.BZT_SNO
		        ,C.TEAM_SNO
		        ,C.AUD_STR_DT
		        ,C.AUD_END_DT
		        ,C.AUD_DCN
		        ,C.ORG_NM
		        ,C.AUD_YR
		        ,C.AUD_NO
		        ,C.AUD_TASK_CD
		        ,C.ORG_DVSN_CD
		        ,C.AUD_KND_CD
		        ,C.SPV_BRDV_CD
		        ,C.AUD_WAY_CD
		        ,C.AUD_EXEC_DVSN_CD_NM
		        ,C.AUD_SBJ_NM
		        ,C.AUD_STEP_SNO
		        ,C.IN_PSON_CNT
		        ,C.EXT_PSON_CNT
		        ,C.IN_PSON_MAN_CNT
		        ,C.EXT_PSON_MAN_CNT
		        ,C.IN_PSON_TOT_CNT
		        ,C.EXT_PSON_TOT_CNT
		        ,C.SDATE
		        ,C.EDATE
		        ,C.DAYS
		        ,C.ORG_CNT
		    from 
		    (
		        select A.AUD_TASK_CD,
		               A.AUD_YR,
		               F_CODE_NM('1000008',A.AUD_TASK_CD) STRTG_GOAL_NM  /*감사방침*/
		          from TBBADDED001M A,
		               TBBADDED002M B,
		               TBBADDED008L C
		         where A.AUD_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /*화면 감사년도*/
		           and SUBSTR(A.AUD_TASK_CD, -1) BETWEEN #strAudTaskCdSt# AND #strAudTaskCdEnd# /*화면 감사방침 1~9*/
		           and B.REL_AUD_YR = A.AUD_YR
		           and B.REL_AUD_NO = A.AUD_NO
		           and B.BZT_DVSN_CD = '1'
		           and C.BZT_YR = B.BZT_YR
		           and C.BZT_SNO = B.BZT_SNO
		           and C.AUD_STR_DT BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면 감사기간*/
		         group by A.AUD_TASK_CD,
		               A.AUD_YR 
		    ) A,
		    (
		        select max(X.AUD_YR) as AUD_YR,
		               max(X.AUD_NO) as AUD_NO,
		               MAX(X.AUD_TASK_CD) as AUD_TASK_CD,
		               X.ORG_DVSN_CD,
		               max(X.BZT_YR) as BZT_YR,
		               max(X.BZT_SNO) as BZT_SNO,
		               SUM(X.ORG_CNT) as ORG_TOT_CNT,
		               SUM(X.IN_PSON_MAN_CNT) as IN_PSON_TOT_CNT,
		               SUM(X.EXT_PSON_MAN_CNT) as EXT_PSON_TOT_CNT,       
		               F_CODE_NM('1000119',X.ORG_DVSN_CD) ORG_TYPE_NM,  /*기관구분명*/
		               /*--Z.CD_NM as ORG_TYPE_NM,*/
		               count(*) as CNT
		          from (select AA.AUD_YR,
		                       AA.AUD_NO,
		                       AA.AUD_TASK_CD,
		                       AA.ORG_DVSN_CD,
		                       AA.BZT_YR,
		                       AA.BZT_SNO,
		                       BB. ORG_CNT,
		                       CC.IN_PSON_MAN_CNT,
		                       CC.EXT_PSON_MAN_CNT
		                  from (select A.AUD_YR,
		                               A.AUD_NO,
		                               max(A.AUD_TASK_CD) as AUD_TASK_CD,
		                               A.ORG_DVSN_CD,
		                               max(C.BZT_YR) as BZT_YR,
		                               max(C.BZT_SNO) as BZT_SNO
		                          from TBBADDED001M A,
		                               TBBADDED002M B,
		                               TBBADDED008L C
		                         where A.AUD_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /*화면 감사년도*/
		                           and B.REL_AUD_YR = A.AUD_YR
		                           and B.REL_AUD_NO = A.AUD_NO
		                           and B.BZT_DVSN_CD = '1'
		                           and C.BZT_YR = B.BZT_YR
		                           and C.BZT_SNO = B.BZT_SNO
		                           and C.AUD_STR_DT BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면의 감사기간*/
		                         group by A.AUD_YR,
		                               A.AUD_NO,
		                               A.ORG_DVSN_CD) AA,
		                       (select BZT_YR,
		                               BZT_SNO,
		                               count(distinct ORG_CD) ORG_cnt,
		                               min(AUD_STR_DT) AUD_STR_DT,
		                               max(AUD_END_DT) AUD_END_DT
		                         from TBBADDED008L
		                         group by BZT_YR,
		                                  BZT_SNO) BB,
		                       (select A.BZT_YR,
		                               A.BZT_SNO,
		                               sum(
		                                   case
		                                     when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                                     else 0
		                                   end) as IN_PSON_MAN_CNT,
		                               sum(
		                                   case
		                                     when A.STF_DVSN_CD = '0' then 0
		                                     else B.AUD_DCN
		                                   end) as EXT_PSON_MAN_CNT,
		                               MIN(B.AUD_STR_DT) as AUD_STR_DT,
		                               MAX(B.AUD_END_DT) as AUD_END_DT,
		                               MAX(B.AUD_DCN) as AUD_DCN
		                          from TBBADDED005L A,
		                               TBBADDED006L B
		                         where B.BZT_YR = A.BZT_YR
		                           and B.BZT_SNO = A.BZT_SNO
		                           and B.TEAM_SNO = A.TEAM_SNO
		                           and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		                         group by A.BZT_YR,
		                               A.BZT_SNO ) CC
		                 where 1=1
		                   and BB.BZT_YR(+) = AA.BZT_YR
		                   and BB.BZT_SNO(+) = AA.BZT_SNO
		                   and CC.BZT_YR(+) = AA.BZT_YR
		                   and CC.BZT_SNO(+) = AA.BZT_SNO ) X
		         group by ORG_DVSN_CD,
		                  X.ORG_DVSN_CD 
		
		    ) B,
		    (
		        select /*+NO_MERGE*/
		           F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as GUBUN,
		           F_MNG_KND_AUDYRNO(max(AUD_YR), max(AUD_NO), max(AUD_KND_CD), '-') as FULL_AUD_NO,
		           AA.BZT_YR,
		           AA.BZT_SNO,
		           AA.TEAM_SNO,
		           AA.AUD_STR_DT,
		           AA.AUD_END_DT,
		           AA.AUD_DCN,
		           AA.ORG_NM,
		           max(AA.AUD_YR) as AUD_YR,
		           max(AA.AUD_NO) as AUD_NO,
		           max(AA.AUD_TASK_CD) as AUD_TASK_CD,
		           max(AA.ORG_DVSN_CD) as ORG_DVSN_CD,
		           max(AA.AUD_KND_CD) as AUD_KND_CD,
		           max(AA.SPV_BRDV_CD) as SPV_BRDV_CD,
		           max(AA.AUD_WAY_CD) as AUD_WAY_CD,
		           max(AA.AUD_EXEC_DVSN_CD_NM) as AUD_EXEC_DVSN_CD_NM,
		           max(AA.AUD_SBJ_NM) as AUD_SBJ_NM,
		           AA.AUD_STEP_SNO,
		           max(BB.IN_PSON_CNT) as IN_PSON_CNT,
		           max(BB.EXT_PSON_CNT) as EXT_PSON_CNT,
		           max(CC.IN_PSON_MAN_CNT) as IN_PSON_MAN_CNT,
		           max(CC.EXT_PSON_MAN_CNT) as EXT_PSON_MAN_CNT,
		           max(DD.IN_PSON_TOT_CNT) as IN_PSON_TOT_CNT,
		           max(DD.EXT_PSON_TOT_CNT) as EXT_PSON_TOT_CNT,
		           min(DD.SDATE) as SDATE,
		           max(DD.EDATE) as EDATE,
		           '' as DAYS,
		           max(EE.ORG_CNT) as ORG_CNT
		      from (select 
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.AUD_STEP_SNO,
		                   min( A.AUD_STR_DT) as AUD_STR_DT,
		                   max(A.AUD_END_DT) as AUD_END_DT,
		                   max(A.AUD_DCN) as AUD_DCN,
		                   B.BGRP_TG_ORG_SNO,
		                   max(D.AUD_YR) as AUD_YR,
		                   max(D.AUD_NO) as AUD_NO,
		                   max(D.AUD_TASK_CD) as AUD_TASK_CD,
		                   max(D.ORG_DVSN_CD) as ORG_DVSN_CD,
		                   max(D.AUD_KND_CD) as AUD_KND_CD,
		                   max(D.SPV_BRDV_CD) as SPV_BRDV_CD,
		                   max(D.AUD_WAY_CD) as AUD_WAY_CD,
		                   max(D.AUD_SBJ_NM) as AUD_SBJ_NM,
		                   max(E.ORG_NM) as ORG_NM,               
		                   F_CODE_NM('1000007',MAX(D.AUD_KND_CD)) AUD_EXEC_DVSN_CD_NM
		              from TBBADDED006L A,
		                   TBBADDED008L B,
		                   TBBADDED002M C,
		                   TBBADDED001M D,
		                   TBDCMACM015M E
		
		             where 1=1
		               and A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# 
		               and SUBSTR(A.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면의 감사기간*/
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.BGRP_TG_ORG_SNO = A.BGRP_TG_ORG_SNO
		               and C.BZT_YR = B.BZT_YR
		               and C.BZT_SNO = B.BZT_SNO
		               and D.AUD_YR = C.REL_AUD_YR
		               and D.AUD_NO = C.REL_AUD_NO
		               and E.ORG_CD = B.ORG_CD
		             group by A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   B.BGRP_TG_ORG_SNO,
		                   C.AUD_STEP_SNO ) AA,
		           (select 
		                   BZT_YR,
		                   BZT_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 1
		                         else 0
		                       end) as IN_PSON_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else 1
		                       end) as EXT_PSON_CNT
		              from (select distinct BZT_YR,
		                           BZT_SNO,
		                           PCT_CNB,
		                           STF_DVSN_CD
		                      from TBBADDED005L) A
		             group by BZT_YR,
		                   BZT_SNO ) BB,
		           (select 
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.BGRP_TG_ORG_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                         else 0
		                       end) as IN_PSON_MAN_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else B.AUD_DCN
		                       end) as EXT_PSON_MAN_CNT
		              from TBBADDED005L A,
		                   TBBADDED006L B,
		                   TBBADDED008L C
		             where 1 = 1
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# 
		               and SUBSTR(B.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면의 감사기간*/
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		               and C.BZT_YR = B.BZT_YR
		               and C.BZT_SNO = B.BZT_SNO
		               and C.TEAM_SNO = B.TEAM_SNO
		               and C.BGRP_TG_ORG_SNO = B.BGRP_TG_ORG_SNO
		             group by A.BZT_YR,
		                   A.BZT_SNO,
		                   A.TEAM_SNO,
		                   C.BGRP_TG_ORG_SNO ) CC,
		           (select /*+ INDEX(A KBBADBADDED005001) INDEX(B KBBADBADDED006001)*/
		                   A.BZT_YR,
		                   A.BZT_SNO,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then B.AUD_DCN
		                         else 0
		                       end) as IN_PSON_TOT_CNT,
		                   sum(
		                       case
		                         when A.STF_DVSN_CD = '0' then 0
		                         else B.AUD_DCN
		                       end) as EXT_PSON_TOT_CNT,
		                   MIN(B.AUD_STR_DT) as SDATE,
		                   MAX(B.AUD_END_DT) as EDATE
		              from TBBADDED005L A,
		                   TBBADDED006L B
		             where 1 = 1
		               and B.BZT_YR = A.BZT_YR
		               and B.BZT_SNO = A.BZT_SNO
		               and B.TEAM_SNO = A.TEAM_SNO
		               and B.PCT_ALC_SNO = A.PCT_ALC_SNO
		               and A.BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY# 
		               and SUBSTR(B.AUD_STR_DT, 1, 6) BETWEEN #strBztStYY#||#strBztStMM# AND #strBztEndYY#||#strBztEndMM#  /*화면의 감사기간*/
		             group by A.BZT_YR,
		                   A.BZT_SNO ) DD,
		           (select BZT_YR,
		                   BZT_SNO,
		                   COUNT(DISTINCT ORG_CD) ORG_CNT
		             from TBBADDED008L
		             WHERE BZT_YR BETWEEN #strBztStYY# AND #strBztEndYY#  /*화면의 감사기간*/
		             group by BZT_YR,
		                   BZT_SNO) EE
		     where 1 = 1
		       and BB.BZT_YR = AA.BZT_YR
		       and BB.BZT_SNO = AA.BZT_SNO
		       and CC.BZT_YR = AA.BZT_YR
		       and CC.BZT_SNO = AA.BZT_SNO
		       and CC.TEAM_SNO = AA.TEAM_SNO
		       and CC.BGRP_TG_ORG_SNO = AA.BGRP_TG_ORG_SNO
		       and DD.BZT_YR = CC.BZT_YR
		       and DD.BZT_SNO = CC.BZT_SNO
		       and EE.BZT_YR = DD.BZT_YR
		       and EE.BZT_SNO = DD.BZT_SNO
		     group by AA.BZT_YR,
		           AA.BZT_SNO,
		           AA.TEAM_SNO,
		           AA.AUD_STR_DT,
		           AA.AUD_END_DT,
		           AA.AUD_DCN,
		           AA.ORG_NM,
		           AA.AUD_STEP_SNO
		    ) C
		WHERE A.AUD_TASK_CD = B.AUD_TASK_CD
		  AND A.AUD_YR      = B.AUD_YR
		  AND B.AUD_TASK_CD = C.AUD_TASK_CD
		  AND B.ORG_DVSN_CD = C.ORG_DVSN_CD
		  AND B.BZT_YR      = C.BZT_YR
		  AND B.BZT_SNO     = C.BZT_SNO 
        ]]>
        <include refid="include.pageOrder" />          
	</select>		
</sqlMap> 

