<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/aea/007">

	<select id="FAAAEA007EOrgInfoSelect" parameterClass="paramMap" resultClass="resultMap">
        SELECT T1.ORG_CD
              ,T1.SRNO
              ,T1.HG_ORG_NM
              ,T1.ENG_ORG_NM
              ,T1.HMP_AD
              ,T1.TNB
              ,T1.ZCD
              ,T1.AD
              ,(SELECT MIN(GCC_ORG_CD) FROM TBCSPIIT006M WHERE BAI_ORG_CD = #strOrgCd# AND ABLT_YN_CD = '0') AS GCC_ORG_CD
              ,(SELECT MIN(GCC_HHT_ORG_CD) FROM TBCSPIIT006M WHERE BAI_ORG_CD = #strOrgCd# AND ABLT_YN_CD = '0') AS GCC_HHT_ORG_CD
         FROM TBFAAAEA010M T1
        WHERE T1.ORG_CD = #strOrgCd#
          AND T1.SRNO   = (SELECT MAX(SRNO)
                             FROM TBFAAAEA010M
                            WHERE ORG_CD = T1.ORG_CD)
    UNION ALL
    
        SELECT ORG_CD
              ,0       AS SRNO
              ,ORG_NM  AS HG_ORG_NM
              ,''      AS ENG_ORG_NM
              ,''      AS HMP_AD
              ,TNB
              ,ZCD
              ,AD
              ,(SELECT MIN(GCC_ORG_CD) FROM TBCSPIIT006M WHERE BAI_ORG_CD = #strOrgCd# AND ABLT_YN_CD = '0') AS GCC_ORG_CD
              ,(SELECT MIN(GCC_HHT_ORG_CD) FROM TBCSPIIT006M WHERE BAI_ORG_CD = #strOrgCd# AND ABLT_YN_CD = '0') AS GCC_HHT_ORG_CD
          FROM TBDCMACM015M
         WHERE ORG_CD = #strOrgCd#
	</select>
	
	<select id="FAAAEA007EMenuHeadTitleSelect" parameterClass="paramMap" resultClass="resultMap">
              SELECT MAX(CASE WHEN CD = '1100' THEN CD            ELSE '' END) AS CD_11
                    ,MAX(CASE WHEN CD = '1200' THEN CD            ELSE '' END) AS CD_12
                    ,MAX(CASE WHEN CD = '1300' THEN CD            ELSE '' END) AS CD_13
                    ,MAX(CASE WHEN CD = '1400' THEN CD            ELSE '' END) AS CD_14
                    ,MAX(CASE WHEN CD = '1500' THEN CD            ELSE '' END) AS CD_15
                    ,MAX(CASE WHEN CD = '1600' THEN CD            ELSE '' END) AS CD_16
                    ,MAX(CASE WHEN CD = '2100' THEN CD            ELSE '' END) AS CD_21
                    ,MAX(CASE WHEN CD = '2200' THEN CD            ELSE '' END) AS CD_22
                    ,MAX(CASE WHEN CD = '2300' THEN CD            ELSE '' END) AS CD_23
                    ,MAX(CASE WHEN CD = '2400' THEN CD            ELSE '' END) AS CD_24
                    ,MAX(CASE WHEN CD = '2500' THEN CD            ELSE '' END) AS CD_25
                    ,MAX(CASE WHEN CD = '2600' THEN CD            ELSE '' END) AS CD_26
                     
                    ,MAX(CASE WHEN CD = '1100' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_11
                    ,MAX(CASE WHEN CD = '1200' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_12
                    ,MAX(CASE WHEN CD = '1300' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_13
                    ,MAX(CASE WHEN CD = '1400' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_14
                    ,MAX(CASE WHEN CD = '1500' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_15
                    ,MAX(CASE WHEN CD = '1600' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_16
                    ,MAX(CASE WHEN CD = '2100' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_21
                    ,MAX(CASE WHEN CD = '2200' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_22
                    ,MAX(CASE WHEN CD = '2300' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_23
                    ,MAX(CASE WHEN CD = '2400' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_24
                    ,MAX(CASE WHEN CD = '2500' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_25
                    ,MAX(CASE WHEN CD = '2600' THEN $strTxtColNm$ ELSE '' END) AS CD_NM_26
                    
                FROM TBDCMACM013C
               WHERE CMM_CD_DVSN_CD = '1000854'
                 AND CD             LIKE '%00'
                 AND USE_YN         = 'Y'
	</select>	
		
	<select id="FAAAEA007EMenuSelect" parameterClass="paramMap" resultClass="resultMap">
        WITH DATA 
          AS (
              SELECT ROW_NUMBER() OVER(PARTITION BY SUBSTR(CD,1,2) ORDER BY CD ASC) AS DVSN
                    ,SUBSTR(CD,1,2) AS CUT_CD 
                    ,CD             AS CD
                FROM TBDCMACM013C
               WHERE CMM_CD_DVSN_CD  = '1000854'
                 AND CD              NOT IN ('000000000','1000','2000')
                 AND SUBSTR(CD,3,4) != '00'
                 AND USE_YN          = 'Y' 
             )
    
             SELECT CD_11                       
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_11)        AS CD_NM_11
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_11)        AS LINK_11
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_11)        AS LINK_REG_11
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_11     AND ORG_CD = #strOrgCd#) AS CD_CNT_11
                   
                   ,CD_12                       
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_12)        AS CD_NM_12
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_12)        AS LINK_12
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_12)        AS LINK_REG_12
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_12     AND ORG_CD = #strOrgCd#) AS CD_CNT_12
                   
                   ,CD_13                      
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_13)        AS CD_NM_13
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_13)        AS LINK_13
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_13)        AS LINK_REG_13
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_13     AND ORG_CD = #strOrgCd#) AS CD_CNT_13
                   
                   ,CD_14                      
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_14)        AS CD_NM_14
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_14)        AS LINK_14
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_14)        AS LINK_REG_14
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_14     AND ORG_CD = #strOrgCd#) AS CD_CNT_14
                   
                   ,CD_15                       
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_15)        AS CD_NM_15
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_15)        AS LINK_15
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_15)        AS LINK_REG_15
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_15     AND ORG_CD = #strOrgCd#) AS CD_CNT_15
                   
                   ,CD_16                      
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_16)        AS CD_NM_16
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_16)        AS LINK_16
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_16)        AS LINK_REG_16
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_16     AND ORG_CD = #strOrgCd#) AS CD_CNT_16
                   
                   ,CD_21                      
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_21)        AS CD_NM_21
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_21)        AS LINK_21
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_21)        AS LINK_REG_21
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_21     AND ORG_CD = #strOrgCd#) AS CD_CNT_21
                   
                   ,CD_22                      
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_22)        AS CD_NM_22
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_22)  AS LINK_22
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_22)    AS LINK_REG_22
                   ,CASE WHEN (SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_22) = 'Y'
                   			THEN (SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_22     AND ORG_CD = #strOrgCd#) 
                   			ELSE 0 END AS CD_CNT_22
                   ,CD_23                      
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_23)        AS CD_NM_23
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_23)        AS LINK_23
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_23)        AS LINK_REG_23
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_23     AND ORG_CD = #strOrgCd#) AS CD_CNT_23
                   
                   ,CD_24                       
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_24)        AS CD_NM_24
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_24)        AS LINK_24
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_24)        AS LINK_REG_24
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_24     AND ORG_CD = #strOrgCd#) AS CD_CNT_24
                   
                   ,CD_25                       
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_25)        AS CD_NM_25
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_25)        AS LINK_25
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_25)        AS LINK_REG_25
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_25     AND ORG_CD = #strOrgCd#) AS CD_CNT_25
                           
                   ,CD_26                       
                   ,(SELECT $strTxtColNm$ FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_26)        AS CD_NM_26
                   ,(SELECT USR_DFN_TXT_2 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_26)        AS LINK_26
                   ,(SELECT USR_DFN_TXT_3 FROM TBDCMACM013C A WHERE CMM_CD_DVSN_CD = '1000854' AND A.CD = CD_26)        AS LINK_REG_26
                   ,(SELECT COUNT(1)      FROM TBFAAAEA043M A WHERE MTRL_DVSN_CD   = CD_26     AND ORG_CD = #strOrgCd#) AS CD_CNT_26
                                              
               FROM DATA
               PIVOT 
                    (
                     MAX(CD) 
                     FOR CUT_CD IN (
                                        '11' AS CD_11
                                       ,'12' AS CD_12
                                       ,'13' AS CD_13
                                       ,'14' AS CD_14
                                       ,'15' AS CD_15
                                       ,'16' AS CD_16
                                       ,'21' AS CD_21
                                       ,'22' AS CD_22
                                       ,'23' AS CD_23
                                       ,'24' AS CD_24
                                       ,'25' AS CD_25
                                       ,'26' AS CD_26
                                   )
                    )
           ORDER BY DVSN
	</select>	
	
	
	<select id="FAAAEA007EMainSelect" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		
            SELECT SRNO             
                  ,MTRL_DVSN_CD
                  ,F_CODE_NM('1000854',MTRL_DVSN_CD)  AS MTRL_DVSN_NM
                  ,ORG_CD
                  ,F_ORG_INFO(ORG_CD,'1')             AS ORG_NM
                  ,TIT_NM
                  ,DTL_TXT
                  ,DOC_ID
                  ,REGN_CNB
                  ,F_USR_INFO(REGN_CNB,'2')           AS REGN_NM   
                  ,TO_CHAR(FRT_REGI_DH, 'YYYY-MM-DD') AS FRT_REGI_DT     
              FROM TBFAAAEA043M
             WHERE MTRL_DVSN_CD = #strMtrlDvsnCd#
	           AND ORG_CD       = #strOrgCd#
	           
			<isNotEmpty property="strTitNm">
			   AND TIT_NM LIKE '%'||#strTitNm#||'%'
			</isNotEmpty>
				           
    	<include refid="include.pageOrder" />
	</select>		
	
	
	<select id="FAAAEA007E1105CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
			 SELECT COUNT(1) AS CNT
			   FROM TBBADEAR001M D1
	  	           ,TBBADEAR002D D2
                   ,TBBADDED001M D3
			  WHERE D1.AUD_YR       = D2.AUD_YR
				AND D1.AUD_NO       = D2.AUD_NO
				AND D1.DSP_RQ_SNO   = D2.DSP_RQ_SNO
                AND D1.AUD_YR       = D3.AUD_YR
				AND D1.AUD_NO       = D3.AUD_NO
			    AND D1.AUD_YR       BETWEEN (TO_CHAR(SYSDATE,'YYYY') -1) AND TO_CHAR(SYSDATE,'YYYY')
				AND D2.COPT_OFI_CD  = #strOrgCd#
	</select>
				
	<select id="FAAAEA007E1105Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		
			 SELECT  D1.AUD_YR
                    ,D1.AUD_NO
                    ,D1.DSP_RQ_SNO
                    ,D3.AUD_SBJ_NM
                    ,F_MNG_KND_AUDYRNO(D1.AUD_YR, D1.AUD_NO, '', '-') ||'-'|| D1.DSP_RQ_SNO  AS AUD_YR_NO
					,F_CODE_NM('1000002',D1.DSP_RQ_KND_CD)                                   AS DSP_RQ_KND_NM                                                      
					,D1.TIT_TXT
                    ,D2.ENF_DT                      
			   FROM TBBADEAR001M D1
	  	           ,TBBADEAR002D D2
                   ,TBBADDED001M D3
			  WHERE D1.AUD_YR       = D2.AUD_YR
				AND D1.AUD_NO       = D2.AUD_NO
				AND D1.DSP_RQ_SNO   = D2.DSP_RQ_SNO
                AND D1.AUD_YR       = D3.AUD_YR
				AND D1.AUD_NO       = D3.AUD_NO
			    AND D1.AUD_YR       BETWEEN #strAudYrStr# AND #strAudYrEnd#	
				AND D2.COPT_OFI_CD  = #strOrgCd#
				
            <isNotEmpty property="strDspRqKndCd">				
			    AND D1.DSP_RQ_KND_CD = #strDspRqKndCd#
			</isNotEmpty>
							
            <isNotEmpty property="strTitTxt">				
			    AND D1.TIT_TXT LIKE '%'||#strTitTxt#||'%'
			</isNotEmpty>
			
		   ORDER BY D1.AUD_YR DESC
                   ,D1.AUD_NO DESC 
                   ,D1.DSP_RQ_SNO

    	<include refid="include.pageOrder" />
	</select>			
	
	
	<select id="FAAAEA007E1201CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
		<![CDATA[		
			 SELECT COUNT(1) AS CNT  
			   FROM TBCSPBII100M D1
			  WHERE D1.REL_ORG_CD = #strOrgCd#
                AND D1.AUD_INF_PRSS_STA_CD >= '05'
           ]]>      
	</select>
	
		
	<select id="FAAAEA007E1201Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		
		<![CDATA[		
			  SELECT D1.YE                                           AS YE
			        ,D1.SRNO                                         AS SRNO
			        ,D1.YE || '-' || D1.SRNO                         AS INF_NO 
					,TO_CHAR(TO_DATE(D1.SMT_DT),'YYYY-MM-DD')        AS SMT_DT 
					,F_USR_INFO(D1.PRSR_CNB,'2')                     AS PRSR_NAM
					,D1.TIT_TXT                                      AS TIT_TXT
					,F_ORG_INFO(D1.REL_ORG_CD, '1')                  AS REL_ORG_NM
					,F_DPT_INFO(D1.AUD_DPT_CD,'1')                   AS DPT_NM
					,F_CODE_NM('1000039', D1.HNDL_ORD_CD)            AS HNDL_ORD_NM
					,F_CODE_NM('1000085', D1.AUD_INF_PRSS_STA_CD)    AS AUD_INF_PRSS_STA_NM
					,TO_CHAR(TO_DATE(D1.HNDL_DT),'YYYY-MM-DD')       AS HNDL_DT 
					,F_CODE_NM('1000042', D1.HNDL_RSLT_CD)           AS HNDL_RSLT_NM
			   FROM TBCSPBII100M D1
			  WHERE D1.REL_ORG_CD = #strOrgCd#
                AND D1.AUD_INF_PRSS_STA_CD >= '05'
           ]]>      
              
        <isNotEmpty property="strYeStr">	
        	<![CDATA[			
		    	AND D1.YE >= #strYeStr#
		    ]]>
		</isNotEmpty>       
		
        <isNotEmpty property="strYeEnd">				
        	<![CDATA[			
		    	AND D1.YE <= #strYeEnd#
		    ]]>
		</isNotEmpty>   
				
        <isNotEmpty property="strTitTxt">				
		    AND D1.TIT_TXT LIKE '%'||#strTitTxt#||'%'
		</isNotEmpty>                
              
    	<include refid="include.pageOrder" />
	</select>
		
		
	<select id="FAAAEA007E1401CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
			  SELECT COUNT(1) AS CNT 
			   FROM TBFAAAEA011M D1
                   ,TBFAAAEA012M D2
		      WHERE D1.ORG_CD = D2.ORG_CD(+)
                AND D1.SRNO   = D2.SRNO(+)
                AND D1.DEL_YN = 'N'
                AND D1.ORG_CD = #strOrgCd#
	</select>
			
	<select id="FAAAEA007E1401Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		
			  SELECT D1.ORG_CD                                                             AS ORG_CD
                    ,D1.SRNO                                                               AS SRNO
			        ,D1.ORGA_NM                                                            AS ORGA_NM
                    ,D1.RPS_ORGA_NM                                                        AS RPS_ORGA_NM
					,D1.ORGA_BLT_TYP_NM                                                    AS ORGA_BLT_TYP_NM
					,D1.PSST_CNT||'/'||D1.FN_CNT                                           AS CNT
					,REPLACE(TO_CHAR(D1.BGT_AMT,'999,999,999') ,'','')                     AS BGT_AMT
					,D1.FAN                                                                AS FAN
					,D1.ORZT_COMPO_TXT                                                     AS ORZT_COMPO_TXT
					,D1.DVDT_TSK_TXT                                                       AS DVDT_TSK_TXT
					,D2.PST_CD                                                             AS PST_CD
					,D2.RANK_NM                                                            AS RANK_NM
					,D2.NAM                                                                AS NAM
					,CASE WHEN D2.BTDT IS NOT NULL THEN SUBSTRING(D2.BTDT,0,4)||'.'||SUBSTRING(D2.BTDT,5,2)||'.'||SUBSTRING(D2.BTDT,7,2) ELSE D2.BTDT END 
                                                                                           AS BTDT
					,D2.MAIN_SCLS_TXT                                                      AS MAIN_SCLS_TXT
					,D2.MAIN_CRR_TXT                                                       AS MAIN_CRR_TXT
					,D2.APM_SHP_NM                                                         AS APM_SHP_NM
					,(CASE WHEN D2.TNR_STR_DT IS NOT NULL THEN SUBSTRING(D2.TNR_STR_DT,0,4)||'.'||SUBSTRING(D2.TNR_STR_DT,5,2)||'.'||SUBSTRING(D2.TNR_STR_DT,7,2) ELSE D2.TNR_STR_DT END)
					 ||' ~ '||
					 (CASE WHEN D2.TNR_COMEND_DT IS NOT NULL THEN SUBSTRING(D2.TNR_COMEND_DT,0,4)||'.'||SUBSTRING(D2.TNR_COMEND_DT,5,2)||'.'||SUBSTRING(D2.TNR_COMEND_DT,7,2) ELSE D2.TNR_COMEND_DT END) 
                                                                                           AS TNR_DT
					,D2.QLF_SBJ                                                            AS QLF_SBJ
					
					,TO_CHAR(D1.FRT_REGI_DH, 'YYYY.MM.DD')                                 AS FRT_REGI_DT
					
			   FROM TBFAAAEA011M D1
                   ,TBFAAAEA012M D2
		      WHERE D1.ORG_CD = D2.ORG_CD(+)
                AND D1.SRNO   = D2.SRNO(+)
                AND D1.DEL_YN = 'N'
                AND D1.ORG_CD = #strOrgCd#

    	<include refid="include.pageOrder" />
	</select>
		
	<select id="FAAAEA007E1402CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
                SELECT COUNT(1) AS CNT 
                  FROM TBFAAAEA019M T1
                      ,TBFAAAEA020L T2
                      ,TBFAAAEA021M T3
                 WHERE T1.ORG_CD         = T2.ORG_CD
                   AND T1.AUD_YR         = T2.AUD_YR
                   AND T1.AUD_SRNO       = T2.AUD_SRNO
                   AND T2.ORG_CD         = T3.ORG_CD
                   AND T2.AUD_YR         = T3.AUD_YR
                   AND T2.AUD_SRNO       = T3.AUD_SRNO
                   AND T2.EXPOT_MNG_SRNO = T3.EXPOT_MNG_SRNO
                   AND T1.DEL_YN         = 'N'
                   AND T2.DEL_YN         = 'N'
                   AND T3.DEL_YN         = 'N'
                   AND T1.ORG_CD         = #strOrgCd#
                   AND T1.AUD_YR         BETWEEN (TO_CHAR(SYSDATE,'YYYY') -1) AND TO_CHAR(SYSDATE,'YYYY')
	</select>			
		
	<select id="FAAAEA007E1402Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		
                SELECT T3.ORG_CD
                      ,T3.AUD_YR
                      ,T3.AUD_SRNO
                      ,T3.EXPOT_MNG_SRNO
                      ,T3.SRNO
                      ,T1.AUD_SBJ||'('||T1.AUD_KND_CD_NM||')'                            AS AUD_SBJ
                      ,T1.AUD_STR_DT||' ~ '||T1.AUD_END_DT||'('||T1.AUD_DCN||')'         AS AUD_DT         
                      
                      ,T3.DSP_RQ_DT                                                      AS DSP_RQ_DT            /* 처분일자 */
                      ,T2.EXPOT_MNG_TIT_NM || '(' || T3.DSP_RQ_KND_NM || ')'             AS EXPOT_MNG_TIT_NM     /* 처분제목명 */
                      ,F_ORG_INFO(T3.REL_ORG_CD,'1') || '(' || T3.AC_THN_DPT_NM || ')'   AS REL_ORG_CD           /* 관련기관 */
                      ,T3.REL_PEN_NM || '(' || TRIM(T3.BTDT) || ')'                      AS REL_PEN_NM           /* 관련자 */
                      ,T3.DSP_RQ_AM                                                      AS DSP_RQ_AM            /* 관련금액 */
                      ,T3.ENFM_DT                                                        AS ENFM_DT              /* 이행일자 */
                      ,T3.ENFM_KND_NM                                                    AS ENFM_KND_NM          /* 이행종류 */
                      ,T3.AUD_RSLT_ENFM_TXT                                              AS AUD_RSLT_ENFM_TXT    /* 이행내용 */                        
                      
                  FROM TBFAAAEA019M T1
                      ,TBFAAAEA020L T2
                      ,TBFAAAEA021M T3
                 WHERE T1.ORG_CD         = T2.ORG_CD
                   AND T1.AUD_YR         = T2.AUD_YR
                   AND T1.AUD_SRNO       = T2.AUD_SRNO
                   AND T2.ORG_CD         = T3.ORG_CD
                   AND T2.AUD_YR         = T3.AUD_YR
                   AND T2.AUD_SRNO       = T3.AUD_SRNO
                   AND T2.EXPOT_MNG_SRNO = T3.EXPOT_MNG_SRNO
                   AND T1.DEL_YN         = 'N'
                   AND T2.DEL_YN         = 'N'
                   AND T3.DEL_YN         = 'N'
                   AND T1.ORG_CD         = #strOrgCd#
                   AND T1.AUD_YR         BETWEEN #strAudYrStr# AND #strAudYrEnd#
                   
                   <isNotEmpty property="strExpotMngTitNm">
                   		AND T2.EXPOT_MNG_TIT_NM  LIKE '%' || #strExpotMngTitNm# || '%'
                   </isNotEmpty>
                   
                   <isNotEmpty property="strDspRqKndNm">
                   		AND T3.DSP_RQ_KND_NM  LIKE '%' || #strDspRqKndNm# || '%'
                   </isNotEmpty>
                   
                   <isNotEmpty property="strRelPenNm">
                   		AND T3.REL_PEN_NM  LIKE '%' || #strRelPenNm# || '%'
                   </isNotEmpty>                                      

    	<include refid="include.pageOrder" />
	</select>			
		
	<select id="FAAAEA007E1403CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
	    SELECT COUNT(1) AS CNT
	      FROM TBBADGDA001M  D1    
	     WHERE D1.NTF_DVSN_CD  = '1' /* 통보구분코드 (1:범죄및징계, 2:망실및훼손) */
	       AND D1.ACP_STA_CD  != '51'      
	       AND D1.ORG_CD       = #strOrgCd# 
	       AND D1.ACP_DT BETWEEN TO_CHAR(ADD_MONTHS(SYSDATE, -12), 'YYYYMMDD') AND TO_CHAR(SYSDATE, 'YYYYMMDD') 
	</select>	
			
	<select id="FAAAEA007E1403Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		
	     SELECT D1.ORG_CD                                     /* 기관코드 */     
	           ,D1.NTF_DVSN_CD                                /* 통보구분코드 */ 
	           ,D1.NNB                                        /* 통보번호 */     
	           ,D1.YR                                         /* 년도 */         
	           ,D1.DPT_CD                                     /* 부서코드 */  
	           ,(SELECT ORG_NM
	               FROM TBDCMACM015M
	              WHERE ORG_CD = D1.ORG_CD) 
	            || '-' ||  
	            (SELECT CD_NM 
	               FROM TBDCMACM013C
	              WHERE CMM_CD_DVSN_CD  ='1000202'
	                AND CD              = D1.OGN_DVSN_CD)                        
	            || '-' ||  
	            D1.NNB             AS   NTF_SBJ_NO            /* 통보사항번호 */   
	           ,D1.TIT_NM                                     /* 제목명 */  
	          ,(SELECT  CASE WHEN COUNT(1) = 1 THEN MAX( DFNT_NM || '(' || CON_RANK_NM || ')' )
	                         WHEN COUNT(1) > 1 THEN MAX( DFNT_NM || '(' || CON_RANK_NM || ')' ) || '외 ' || ( COUNT(SRNO) - 1 ) || '명'
	                         ELSE ''
	                     END      
	                FROM TBBADGDA001L    
	               WHERE 1=1
	                 AND ORG_CD      = D1.ORG_CD
	                 AND NTF_DVSN_CD = D1.NTF_DVSN_CD
	                 AND NNB         = D1.NNB
	            GROUP BY ORG_CD, NTF_DVSN_CD, NNB) AS DFNT_NMS                    
	           ,D1.ACP_DT                                     /* 접수일 */                      
	           ,CASE WHEN D1.ACP_STA_CD IN ('58','59')      THEN '미접수'
	                 WHEN D1.ACP_STA_CD IN ('71','72','76') THEN '처리중' 
	                 WHEN D1.ACP_STA_CD = '75'              THEN '결재중' 
	                 WHEN D1.ACP_STA_CD = '77'              THEN '완결'
	                 ELSE D1.ACP_STA_CD 
	             END    AS ACP_STA_NM                         /* 접수상태코드 */     
	           ,CASE WHEN D1.HNDL_OPIN_CD IS NOT NULL 
	                      THEN F_CODE_NM('1000200', D1.HNDL_OPIN_CD)
	                 ELSE '미처리'
	             END                                      AS  HNDL_OPIN_NM   /* 처리의견 */       
	           ,D1.CPLT_DT                                                   /* 완결일 */ 
	           ,F_CODE_NM('1000650', D1.CRM_NTF_DVSN_CD)  AS CRM_NTF_DVSN_NM /* 범죄통보구분명 */
	           ,D1.BAI_RPT_DT                             AS BAI_RPT_DT      /* 감사원통보일 */   
	           ,D1.WRDO_NM                                AS WRDO_NM         /* 비위유형 */                       
	      FROM TBBADGDA001M  D1    
	     WHERE D1.NTF_DVSN_CD  = '1' /* 통보구분코드 (1:범죄및징계, 2:망실및훼손) */
	       AND D1.ACP_STA_CD  != '51'      
	       AND D1.ORG_CD       = #strOrgCd# 
	       AND D1.ACP_DT BETWEEN #strAcpDtStr# AND #strAcpDtEnd#
	       
        <isNotEmpty property="strTitNm">				
		    AND D1.TIT_NM LIKE '%'||#strTitNm#||'%'
		</isNotEmpty>  	       
	       
        <isNotEmpty property="strDfntNm">	
        	<![CDATA[        			
		        AND 0 < (SELECT COUNT(1)      
  	                       FROM TBBADGDA001L    
	                      WHERE 1=1
	                        AND ORG_CD      = D1.ORG_CD
	                        AND NTF_DVSN_CD = D1.NTF_DVSN_CD
	                        AND NNB         = D1.NNB
	                        AND DFNT_NM     LIKE '%'||#strDfntNm#||'%'   )
		    ]]>	                    
		</isNotEmpty>  
			       
    	<include refid="include.pageOrder" />
	</select>	
	
	<select id="FAAAEA007E1404CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
	    SELECT COUNT(1) AS CNT
	      FROM TBBADGDA001M  D1    
	     WHERE D1.NTF_DVSN_CD  = '2' /* 통보구분코드 (1:범죄및징계, 2:망실및훼손) */
	       AND D1.ACP_STA_CD  != '51'      
	       AND D1.ORG_CD       = #strOrgCd# 
	       AND D1.ACP_DT BETWEEN TO_CHAR(ADD_MONTHS(SYSDATE, -12), 'YYYYMMDD') AND TO_CHAR(SYSDATE, 'YYYYMMDD') 
	</select>		
	
	<select id="FAAAEA007E1404Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		
	     SELECT D1.ORG_CD                                     /* 기관코드 */     
	           ,D1.NTF_DVSN_CD                                /* 통보구분코드 */ 
	           ,D1.NNB                                        /* 통보번호 */     
	           ,D1.YR                                         /* 년도 */         
	           ,D1.DPT_CD                                     /* 부서코드 */  
               ,F_CODE_NM('1000202',D1.OGN_DVSN_CD)                      AS OGN_DVSN_NM
               ,CASE WHEN D1.ACP_NO IS NOT NULL
               	          THEN YR || '-' || DECODE(D1.OGN_DVSN_CD,'6','판청','손망') || '-' || D1.ACP_NO 
                     ELSE ''
                 END              AS   ACP_NO_TXT             /* 접수번호 */
               ,F_CODE_NM('1000766', D1.LAD_REL_RULE_CD) AS LAD_REL_RULE_NM /* 손망실관련규정코드명 - 2016.11.17 yyh */                
               ,(SELECT ORG_NM
                   FROM TBDCMACM015M
                  WHERE ORG_CD = D1.ORG_CD) 
                 || '-' ||  
                (SELECT CD_NM 
                   FROM TBDCMACM013C
                  WHERE CMM_CD_DVSN_CD  ='1000202'
                    AND CD              = D1.OGN_DVSN_CD)                        
                 || '-' ||  
                D1.NNB            AS   NTF_SBJ_NO             /* 통보사항번호 */           
               ,F_DPT_INFO(D1.DPT_CD,'1') AS DPT_NM           /* 부서명 */      
	           ,D1.TIT_NM                                     /* 제목명 */    
               ,D1.LOS_AM                                     /* 손해금액 */    
	           ,(SELECT  CASE WHEN COUNT(1) = 1 THEN MAX( DFNT_NM || '(' || CON_RANK_NM || ')' )
	                          WHEN COUNT(1) > 1 THEN MAX( DFNT_NM || '(' || CON_RANK_NM || ')' ) || '외 ' || ( COUNT(SRNO) - 1 ) || '명'
	                          ELSE ''
	                      END      
	                FROM TBBADGDA001L    
	               WHERE 1=1
	                 AND ORG_CD      = D1.ORG_CD
	                 AND NTF_DVSN_CD = D1.NTF_DVSN_CD
	                 AND NNB         = D1.NNB
	            GROUP BY ORG_CD, NTF_DVSN_CD, NNB) AS DFNT_NMS    
	           ,D1.ACP_DT                                     /* 접수일 */
	           ,CASE WHEN D1.ACP_STA_CD IN ('58','59')      THEN '미접수'
	                 WHEN D1.ACP_STA_CD IN ('71','72','76') THEN '처리중' 
	                 WHEN D1.ACP_STA_CD = '75'              THEN '결재중' 
	                 WHEN D1.ACP_STA_CD = '77'              THEN '완결'
	                 ELSE D1.ACP_STA_CD 
	             END    AS ACP_STA_NM                         /* 접수상태코드 */     
	           ,CASE WHEN D1.HNDL_OPIN_CD IS NOT NULL 
	                      THEN F_CODE_NM('1000200', D1.HNDL_OPIN_CD)
	                 ELSE '미처리'
	             END                       AS HNDL_OPIN_NM    /* 처리의견 */    
	           ,D1.CPLT_DT                                    /* 완결일 */      
	           ,D1.BAI_RPT_DT              AS BAI_RPT_DT      /* 감사원통보일 */   	                                               
	      FROM TBBADGDA001M  D1    
	     WHERE D1.NTF_DVSN_CD  = '2' /* 통보구분코드 (1:범죄및징계, 2:망실및훼손) */
	       AND D1.ACP_STA_CD  != '51'      
	       AND D1.ORG_CD       = #strOrgCd# 
	       AND D1.ACP_DT BETWEEN #strAcpDtStr# AND #strAcpDtEnd#
	       
        <isNotEmpty property="strTitNm">				
		    AND D1.TIT_NM LIKE '%'||#strTitNm#||'%'
		</isNotEmpty>  	       
	       
        <isNotEmpty property="strDfntNm">	
        	<![CDATA[        			
		        AND 0 < (SELECT COUNT(1)      
  	                       FROM TBBADGDA001L    
	                      WHERE 1=1
	                        AND ORG_CD      = D1.ORG_CD
	                        AND NTF_DVSN_CD = D1.NTF_DVSN_CD
	                        AND NNB         = D1.NNB
	                        AND DFNT_NM     LIKE '%'||#strDfntNm#||'%'   )
		    ]]>	                    
		</isNotEmpty>  
			       
    	<include refid="include.pageOrder" />
	</select>	
	
	
	<select id="FAAAEA007E1605CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
			SELECT COUNT(1) AS CNT 
              FROM TBFAAAEA001M D1 
             WHERE 1=1
               AND D1.BAI_ORG_CD = #strOrgCd#
	</select>	
		
	<select id="FAAAEA007E1605Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		
			SELECT F_ORG_INFO(D1.BAI_ORG_CD,'1')                                        AS BAI_ORG_NM       /* 운용기관 - 2018.09.27 yyh */
			      ,D1.COPT_ORG_CD                                                       AS COPT_ORG_CD      /* 소관기관코드 */
			      ,D1.SYS_NM                                                            AS SYS_NM           /* 시스템명 */
                  ,D1.SYS_DES                                                           AS SYS_DES          /* 시스템설명 */
                  ,CASE WHEN LENGTH(D1.SYS_BGN_DT) = 8 THEN TO_CHAR(TO_DATE(D1.SYS_BGN_DT), 'YYYY.MM.DD') 
                        ELSE D1.SYS_BGN_DT
                    END 
                   || '~' || 
                   CASE WHEN LENGTH(D1.SYS_END_DT) = 8 THEN NVL(TO_CHAR(TO_DATE(D1.SYS_END_DT), 'YYYY.MM.DD'), '현재') 
                        ELSE D1.SYS_END_DT
                    END                                                                 AS SYS_DT           /* 시스템적용일 */
                  ,D1.OP_DPT_NM                                                         AS OP_DPT_NM        /* 운영부서 */
                  ,D1.OP_CHGR_NM                                                        AS OP_CHGR_NM       /* 운영담당자 */
                  ,D1.OP_CHGR_CNIF_NM                                                   AS OP_CHGR_CNIF_NM  /* 운영연락처 */
                  ,'[' || F_ORG_INFO(D1.BAI_ORG_CD,'1') || '] ' || D1.SYS_NM || ' (' || URL_AD || ')'  
                                                                                        AS SYS_INFO     
                  ,D1.SYS_DES                                                           AS UNT_SYS_DES
                  ,OP_DPT_NM || ' ' || OP_CHGR_NM || '(' || OP_CHGR_CNIF_NM || ')'      AS OP_INFO
              FROM TBFAAAEA001M D1 
             WHERE 1=1
               AND D1.BAI_ORG_CD = #strOrgCd#
               
        <isNotEmpty property="strSysNm">	
        	   AND D1.SYS_NM LIKE '%'||#strSysNm#||'%'       
		</isNotEmpty>    
		                   
        <isNotEmpty property="strTblNm">	
        	<![CDATA[                  
               AND 0 < (SELECT COUNT(1)
                          FROM TBFAAAEA003M
                         WHERE COPT_ORG_CD = D1.COPT_ORG_CD
                           AND SYS_NM      = D1.SYS_NM
                           AND TBL_NM      LIKE '%'||#strTblNm#||'%'   )
		    ]]>	     
		</isNotEmpty>
		 		    
        <isNotEmpty property="strColNm">	
        	<![CDATA[                  
               AND 0 < (SELECT COUNT(1)
                          FROM TBFAAAEA004M
                         WHERE COPT_ORG_CD = D1.COPT_ORG_CD
                           AND SYS_NM      = D1.SYS_NM
                           AND COL_NM      LIKE '%'||#strColNm#||'%'   )
		    ]]>	     
		</isNotEmpty>
				 		    
    	<include refid="include.pageOrder" />
	</select>		


	<select id="FAAAEA007E1605SubSelect" parameterClass="paramMap" resultClass="resultMap">
				SELECT D1.COPT_ORG_CD
					   ,D1.SYS_NM
					   ,D1.UNT_SYS_NM
					   ,D1.UNT_SYS_DES
					   ,CASE WHEN MAX(TRIM(D2.TBL_NM)) IS NOT NULL 
							 THEN MAX(TRIM(D2.TBL_NM))||' 등 '||(
							 	SELECT COUNT(TBL_ID) 
								  FROM TBFAAAEA003M 
								 WHERE COPT_ORG_CD = D1.COPT_ORG_CD 
								   AND SYS_NM = D1.SYS_NM 
								   AND UNT_SYS_NM = D1.UNT_SYS_NM
							  GROUP BY SYS_NM, UNT_SYS_NM
							 )||'개 자료' 
							 ELSE '' END AS TBL_CNT
					   ,D1.CHR_DPT_NM||' '||D1.CHGR_NM||' ('||D1.CHGR_CNIF_NM||')' AS CHR_INFO
				  FROM TBFAAAEA002M D1
	   LEFT OUTER JOIN TBFAAAEA003M D2
					ON D1.COPT_ORG_CD = D2.COPT_ORG_CD
				   AND D1.SYS_NM      = D2.SYS_NM
				   AND D1.UNT_SYS_NM  = D2.UNT_SYS_NM
				 WHERE D1.COPT_ORG_CD = #strCoptOrgCd#
				   AND D1.SYS_NM      = #strSysNm#
			  GROUP BY D1.COPT_ORG_CD
					  ,D1.SYS_NM
					  ,D1.UNT_SYS_NM
					  ,D1.UNT_SYS_DES
					  ,D1.CHR_DPT_NM
					  ,D1.CHGR_NM
					  ,D1.CHGR_CNIF_NM
			  ORDER BY D1.UNT_SYS_NM
	</select>

	
	<!-- **************************************************** 1차 개발 **************************************************** -->
	<select id="FAAAEA007E1203CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
        <![CDATA[  
        
			    SELECT COUNT(1) AS CNT  
		          FROM (
					    SELECT (SELECT MIN(AUD_STR_DT)  FROM TBBADDED002M A 
						   		 WHERE REL_AUD_YR = D1.AUD_YR AND REL_AUD_NO = D1.AUD_NO AND AUD_BZT_KND_CD IN ('02','03')) AS AUD_STR_DT
						FROM TBBADDED001M D1
					   WHERE 1=1
				         AND SUBSTR(D1.AUD_KND_CD, -1) != '5'  /* 확인출장 제외 */
		     			 AND D1.AUD_RPST_ORG_CD = #strOrgCd#
                       ) T1 
                 WHERE 1=1
                   AND T1.AUD_STR_DT >= '20170908' 
                   AND T1.AUD_STR_DT <= TO_CHAR(SYSDATE,'YYYYMMDD') 
        ]]>
	</select>
		
	<select id="FAAAEA007E1203Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />	
        <![CDATA[     
				    SELECT T1.AUD_YR           		AS AUD_YR           		/*감사년도*/
				         , T1.AUD_NO           		AS AUD_NO           		/*감사번호*/
			       		 , T1.AUD_YR_NO             AS AUD_YR_NO 
				         , T1.AUD_GRN_NO       		AS AUD_GRN_NO         		/*감사부여번호 - 2016.05.25 yyh*/
				         , T1.AUD_YR_NO_KND_CD      AS AUD_YR_NO_KND_CD         /*감사연번호종류코드*/
				         , T1.AUD_YR_NO_KND_NM      AS AUD_YR_NO_KND_NM         /*감사연번호종류코드명*/
				         , T1.AUD_DTL_NO    		AS AUD_DTL_NO    		    /*세부연번호*/
				         , T1.AUD_TASK_CD      		AS AUD_TASK_CD      		/*감사과제코드*/
			             , T1.AUD_TASK_NM      		AS AUD_TASK_NM      		
				         , T1.ORG_DVSN_CD      		AS ORG_DVSN_CD      		/*기관구분코드*/
				         , T1.AUD_KND_CD       		AS AUD_KND_CD       		/*감사종류코드*/
			             , T1.AUD_KND_NM       		AS AUD_KND_NM       		
				         , T1.SPV_BRDV_CD      		AS SPV_BRDV_CD      		/*주관국과코드*/
				         , T1.SPV_BRDV_NM  			AS SPV_BRDV_NM  			/*주관국과명*/
				         , T1.AUD_WAY_CD       		AS AUD_WAY_CD       		/*감사방법코드*/
			             , T1.AUD_WAY_NM       		AS AUD_WAY_NM       		
				         , T1.AUD_SBJ_NM       		AS AUD_SBJ_NM       		/*감사사항명*/
				         , T1.AUD_SCL_CD       		AS AUD_SCL_CD       		/*감사규모코드*/
				         , T1.TSK_CAT_CD       		AS TSK_CAT_CD       		/*업무분류코드*/
				         , T1.TSK_CAT_NM       		AS TSK_CAT_NM       		
				         , T1.AUD_RPST_ORG_CD  		AS AUD_RPST_ORG_CD  		/*감사대표기관코드*/
				         , T1.AUD_RPST_ORG_NM  		AS AUD_RPST_ORG_NM  		
				         , T1.MNG_DPT_CD       		AS MNG_DPT_CD       		/*관리부서코드*/
				         , T1.MNG_DPT_NM			AS MNG_DPT_NM
			             , T1.PRSS_STEP_CD          AS PRSS_STEP_CD             /*진행단계코드*/
						 , F_CODE_NM('1000785',T1.PRSS_STEP_CD)  
					       || 
					       (CASE WHEN T1.BZT_BGT_DVSN_CD = '1' AND T1.PRSS_STEP_CD = '02'
					                 THEN 
									     (SELECT '/'|| F_CODE_NM('1000030',AUD_BZT_KND_CD)
									        FROM TBBADDED002M 
									       WHERE BZT_YR || BZT_SNO = (SELECT MAX(BZT_YR || BZT_SNO)
															            FROM TBBADDED002M
															           WHERE REL_AUD_YR = T1.AUD_YR
															             AND REL_AUD_NO = T1.AUD_NO
															          )
										 )
							   END) AS PRSS_STEP_NM     		                /*진행단계코드명*/
					       
						 , T1.AUD_STR_DT, T1.AUD_END_DT
						 , T1.FLD_AUD_END_DT AS FLD_AUD_END_DT  /* 종료보고일- 2017.10.31 EUNOK */
					     , T1.DOC_LIST, T1.RPRT_NM,   TO_CHAR(T1.FNL_APV_DH,'YYYYMMDD') AS FNL_APV_DH
					     , T1.RMK_TXT /* 담당자비고 - 2018.02.01 EUNOK */
					     , T1.APV_STA_CD 
			          FROM (
			          
						    SELECT D1.AUD_YR                   	AS AUD_YR           /*감사년도*/
						         , D1.AUD_NO                   	AS AUD_NO           /*감사번호*/
						         , D1.AUD_GRN_NO                AS AUD_GRN_NO       /*감사부여번호*/
						         , F_MNG_KND_AUDYRNO(D1.AUD_YR, D1.AUD_NO, D1.AUD_KND_CD, '-')
						                                        AS AUD_YR_NO        /*감사년번호 - 수정(2015.12.17-yyh)*/
						         , CASE WHEN D1.AUD_YR >= '2016' 
						                     THEN SUBSTR(D1.AUD_KND_CD,3,1)
						                ELSE '' 
						            END                         AS AUD_YR_NO_KND_CD /*감사연번호종류코드 추가 - 2015.12.18 yyh*/
						         , CASE WHEN D1.AUD_YR >= '2016' 
						                     THEN F_CODE_NM('1000739',SUBSTR(D1.AUD_KND_CD,3,1))   
						                ELSE '-' 
						            END                         AS AUD_YR_NO_KND_NM /*감사연번호종류코드명 추가 - 2015.12.22 yyh*/			            
						         , D1.AUD_YR||'-'||SUBSTR(D1.AUD_TASK_CD,-1)||'-'||D1.ORG_DVSN_CD||'-'||SUBSTR(D1.AUD_KND_CD,-1)
						         ||'-'||SUBSTR(D1.SPV_BRDV_CD,1,2)||SUBSTR(D1.SPV_BRDV_CD,4,2)||'-'||SUBSTR(D1.AUD_WAY_CD,-1)||'-'||D1.AUD_NO AS AUD_DTL_NO    /*세부연번호*/
						         , D1.AUD_TASK_CD              	AS AUD_TASK_CD      /*감사과제코드*/
			                     , F_CODE_NM_YEAR('1000008', D1.AUD_TASK_CD, D1.AUD_YR) AS AUD_TASK_NM 
						         , D1.ORG_DVSN_CD              	AS ORG_DVSN_CD      /*기관구분코드*/
						         , D1.AUD_KND_CD               	AS AUD_KND_CD       /*감사종류코드*/
			                     , F_CODE_NM_YEAR('1000007', D1.AUD_KND_CD, D1.AUD_YR) AS AUD_KND_NM 
						         , D1.SPV_BRDV_CD              	AS SPV_BRDV_CD      /*주관국과코드*/
						         , F_DPT_INFO(D1.SPV_BRDV_CD,'1')	AS SPV_BRDV_NM  /*주관국과명*/
						         , D1.AUD_WAY_CD               	AS AUD_WAY_CD       /*감사방법코드*/
			                     , F_CODE_NM_YEAR('1000009', D1.AUD_WAY_CD, D1.AUD_YR) AS AUD_WAY_NM 
						         , D1.AUD_SBJ_NM               	AS AUD_SBJ_NM       /*감사사항명*/
						         , D1.AUD_SCL_CD               	AS AUD_SCL_CD       /*감사규모코드*/
						         , D1.TSK_CAT_CD               	AS TSK_CAT_CD       /*업무분류코드*/
						         , F_CODE_NM('1000120',D1.TSK_CAT_CD) AS TSK_CAT_NM			        
						         , D1.AUD_RPST_ORG_CD          	AS AUD_RPST_ORG_CD  /*감사대표기관코드*/
						         , F_ORG_INFO(D1.AUD_RPST_ORG_CD,'1')  AS AUD_RPST_ORG_NM 
						         , D1.MNG_DPT_CD               	AS MNG_DPT_CD       /*관리부서코드*/
						         , F_DPT_INFO(D1.MNG_DPT_CD,'1') 		AS MNG_DPT_NM	
			 					 , D1.PRSS_STEP_CD                          AS PRSS_STEP_CD   /*진행단계코드*/         
							     , D1.RMK_TXT /* 종료보고일- 2017.10.31 EUNOK */	
							     , D1.BZT_BGT_DVSN_CD	
							     , (SELECT MIN(AUD_STR_DT)  FROM TBBADDED002M A 
							   		 WHERE REL_AUD_YR = D1.AUD_YR AND REL_AUD_NO = D1.AUD_NO AND AUD_BZT_KND_CD IN ('02','03')) AS AUD_STR_DT /* 실지감사 02:실지감사, 03:실지감사연장- 2017.11.14 EUNOK */
							     , (SELECT MAX(AUD_END_DT)  FROM TBBADDED002M A 
							   		 WHERE REL_AUD_YR = D1.AUD_YR AND REL_AUD_NO = D1.AUD_NO AND AUD_BZT_KND_CD IN ('02','03')) AS AUD_END_DT /* 감사종료일 02:실지감사, 03:실지감사연장- 2017.11.07 EUNOK */ 
							   
							   , D3.FLD_AUD_END_DT  /* 종료보고일 - 2017.10.31 EUNOK */
							   , D4.DOC_LIST, D4.RPRT_NM , D4.APV_STA_CD , D5.FNL_APV_DH
							FROM TBBADDED001M D1
						       , TBCSPDCP101M D2
			      			   , TBBADDED003M D3
			                   ,(SELECT A1.AUD_YR ,A1.AUD_NO, MAX (A1.APV_STA_CD) AS APV_STA_CD
			                           ,SUBSTR(XMLAGG(XMLELEMENT(X,',',DOC_ID) ORDER BY AUD_YR,AUD_NO,AUD_STEP_CD,doc_ID).EXTRACT('//text()'),2) DOC_LIST 
			                           ,SUBSTR(XMLAGG(XMLELEMENT(X,',',RPRT_NM) ORDER BY AUD_YR,AUD_NO,AUD_STEP_CD,doc_ID).EXTRACT('//text()'),2) RPRT_NM 
			                       FROM TBBADDED103M A1
			                      WHERE A1.AUD_STEP_CD = 'A1050'
			                        AND A1.RPRT_CD     = 'A10500400'
									AND (A1.APV_STA_CD IS  NULL OR A1.APV_STA_CD <= '30' )
			                      GROUP BY A1.AUD_YR 
			                              ,A1.AUD_NO 
			                     ) D4     
			                    ,(  SELECT AA.AUD_YR ,AA.AUD_NO,BB.APV_DH AS FNL_APV_DH
			                         FROM TBBADDED103M AA,TBDCMACM023L BB
			                         WHERE AA.AUD_STEP_CD = 'A1050' 
			                               AND AA.RPRT_CD  = 'A10500200' 
			                               AND AA.APV_RQS_ID = BB.APV_DOC_NO
			                               AND AA.APV_STA_CD <=    '30' 
									       AND BB.APVR_PST_CD = (SELECT APVR_PST_CD FROM TBDCMACM023L 
			                                                       WHERE APV_SNO = (SELECT MAX(APV_SNO) FROM TBDCMACM023L WHERE APV_DOC_NO = BB.APV_DOC_NO)  
			                                                         AND APV_DOC_NO = BB.APV_DOC_NO)  
			                   			   AND BB.APVR_PST_CD IN ('0067400','0055700') 
						   			GROUP BY AA.AUD_YR 
						   			        ,AA.AUD_NO
						   			        ,AA.APV_RQS_ID
						   			        ,AA.RPRT_CD
						   			        ,BB.APV_DH
						   		) D5	
						   WHERE 1=1
						     AND D1.ACP_YR        = D2.ACP_YR(+)
						     AND D1.CVPT_ACP_NO   = D2.CVPT_ACP_NO(+)
						     AND D1.REQ_DVSN_CD   = D2.REQ_DVSN_CD(+)
						     AND D1.AUD_YR 		  = D3.AUD_YR(+)
						     AND D1.AUD_NO 		  = D3.AUD_NO(+)
						     AND D1.AUD_YR 		  = D4.AUD_YR(+)
						     AND D1.AUD_NO 		  = D4.AUD_NO(+)
						     AND D1.AUD_YR 		  = D5.AUD_YR(+)
						     AND D1.AUD_NO 		  = D5.AUD_NO(+)
					         AND SUBSTR(D1.AUD_KND_CD, -1) != '5'  /* 확인출장 제외 */
			     			 AND D1.AUD_RPST_ORG_CD = #strOrgCd#
        	) T1 
        	WHERE 1=1
        	  AND T1.AUD_STR_DT >= '20170908' 
        	  AND T1.AUD_STR_DT <= TO_CHAR(SYSDATE,'YYYYMMDD') /*실지감사 시작일이 20170908 이후 이고, 실지감사 시작한 감사사항*/
        ]]>
    	<include refid="include.pageOrder" />        
	</select>
	
	
	<select id="FAAAEA007E1101CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
        <![CDATA[
            SELECT COUNT(1) AS CNT 
            FROM TBBADDED001M D1
                ,TBBADDED003M D3
           WHERE 1=1
             AND D1.AUD_YR          = D3.AUD_YR 
             AND D1.AUD_NO          = D3.AUD_NO
             AND D1.AUD_RPST_ORG_CD = #strOrgCd#
             AND SUBSTR(D1.AUD_KND_CD, 3, 1) <> '5' /*확인출장은 조회하지 않음*/
             AND D1.MNG_DPT_CD NOT IN ('100000','100100')
        ]]>
	</select>
		
	<select id="FAAAEA007E1101Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />	
        <![CDATA[
            SELECT D1.AUD_YR                                                            AS AUD_YR
                 , D1.AUD_NO                                                            AS AUD_NO
                 , D1.AUD_KND_CD                                                        AS AUD_KND_CD
                 , D1.AUD_GRN_NO                                                        AS AUD_GRN_NO
                 , F_CODE_NM('1000753',D1.AUD_CTRL_CD)                                  AS AUD_CTRL_NM
                 , F_MNG_KND_AUDYRNO(D1.AUD_YR, D1.AUD_NO, D1.AUD_KND_CD, '-')          AS AUD_YR_NO
                 , CASE WHEN D1.AUD_YR >= '2016' 
                        THEN SUBSTR(D1.AUD_KND_CD,3,1)
                        ELSE '' END                                                     AS AUD_YR_NO_KND_CD /*감사연번호종류코드*/
                 , CASE WHEN D1.AUD_YR >= '2016' 
                        THEN F_CODE_NM('1000739',SUBSTR(D1.AUD_KND_CD,3,1))   
                        ELSE '-' END                                                    AS AUD_YR_NO_KND_NM /*감사연번호종류코드명*/
                 , D1.AUD_YR||'-'||D1.AUD_KND_CD||'-'||D1.AUD_NO                        AS AUD_YR_KND_NO_CD
                 , F_DPT_INFO(D1.SPV_BRDV_CD,'1')                                       AS SPV_BRDV_NM
                 , F_CODE_NM('1000007', D1.AUD_KND_CD)                                  AS AUD_KND_NM
                 , F_CODE_NM('1000751',D1.BZT_BGT_DVSN_CD)                              AS BZT_BGT_DVSN_NM
                 , D1.AUD_SBJ_NM                                                        AS AUD_SBJ_NM
                 , F_ORG_INFO(D1.AUD_RPST_ORG_CD,'1')                                   AS AUD_RPST_ORG_NM
                 , F_DPT_INFO(D1.MNG_DPT_CD,'1')                                        AS MNG_DPT_NM
                 , D1.MNG_DPT_CD                                                        AS MNG_DPT_CD  /*관리국코드 - 2017.02.01 EUNOK */
                 , F_CODE_NM('1000742',D1.REQ_DVSN_CD)                                  AS REQ_DVSN_NM /*관련업무 코드 변경 1000337 -> 1000742  2017.07.07 EUNOK */
                 , CASE WHEN D1.PRSS_STEP_CD LIKE 'A10%' THEN (SELECT AUD_STEP_NM 
                                                                 FROM TBBADDED101M 
                                                                WHERE AUD_YR = D1.AUD_YR
                                                                  AND AUD_NO = D1.AUD_NO
                                                                  AND AUD_STEP_CD = D1.PRSS_STEP_CD)
                        ELSE F_CODE_NM('1000475',CASE WHEN SUBSTR(D1.AUD_KND_CD,3) = '55' THEN '' 
                                                      WHEN D3.AUD_EXEC_HNDL_STA_CD = '9'  THEN '10'
                                                      ELSE
                                                        CASE WHEN TRIM(D3.ENF_APV_DT) IS NOT NULL THEN '10'
                                                             WHEN TRIM(D3.CHF_CMTR_APV_DT)IS NOT NULL THEN '09'
                                                             WHEN TRIM(D3.OW_DHD_APV_DT)  IS NOT NULL THEN '08'
                                                             WHEN TRIM(D3.JA_JDG_SSEC_APV_DT) IS NOT NULL THEN '07'
                                                             WHEN TRIM(D3.MDT_DDG_APV_DT) IS NOT NULL THEN '06'
                                                             WHEN TRIM(D3.MDT_OFER_APV_DT)IS NOT NULL THEN '05'
                                                             WHEN TRIM(D3.AUD_BRDV_APV_DT)IS NOT NULL THEN '04'
                                                             WHEN TRIM(D3.RTN_RPT_DT) IS NOT NULL THEN '03'
                                                        ELSE
                                                            (CASE WHEN
                                                                        (CASE WHEN (D3.AUD_EXEC_HNDL_STA_CD = '1' AND TO_DATE(D3.RTN_DT) > TO_DATE(SYSDATE)) THEN '7'
                                                                              WHEN ((D3.AUD_EXEC_HNDL_STA_CD = '1' AND TRIM(D3.HNDL_DDLN_DT) IS NULL) OR D3.AUD_EXEC_HNDL_STA_CD = '3') OR (D3.AUD_EXEC_HNDL_STA_CD = '1'AND NVL(TO_DATE(D3.HNDL_DDLN_DT),'99991231') < TO_DATE(SYSDATE) )THEN '8'
                                                                              WHEN D3.AUD_EXEC_HNDL_STA_CD = '1'AND NVL(TO_DATE(D3.HNDL_DDLN_DT),'99991231') < TO_DATE(SYSDATE) THEN '6'
                                                                              WHEN D3.AUD_EXEC_HNDL_STA_CD = '3' THEN '3'
                                                                              WHEN D3.AUD_EXEC_HNDL_STA_CD = '9' THEN '9'
                                                                              ELSE '8' END) = '8' AND D3.RTN_RPT_DT IS NULL AND D3.FLD_AUD_END_DT IS NULL THEN '02'
                                                                  WHEN
                                                                        (CASE WHEN (D3.AUD_EXEC_HNDL_STA_CD = '1' AND TO_DATE(D3.RTN_DT) > TO_DATE(SYSDATE)) THEN '7'
                                                                              WHEN ((D3.AUD_EXEC_HNDL_STA_CD = '1' AND TRIM(D3.HNDL_DDLN_DT) IS NULL) OR D3.AUD_EXEC_HNDL_STA_CD = '3') OR (D3.AUD_EXEC_HNDL_STA_CD = '1'AND NVL(TO_DATE(D3.HNDL_DDLN_DT),'99991231') < TO_DATE(SYSDATE) )THEN '8'
                                                                              WHEN D3.AUD_EXEC_HNDL_STA_CD = '1'AND NVL(TO_DATE(D3.HNDL_DDLN_DT),'99991231') < TO_DATE(SYSDATE) THEN '6'
                                                                              WHEN D3.AUD_EXEC_HNDL_STA_CD = '3' THEN '3'
                                                                              WHEN D3.AUD_EXEC_HNDL_STA_CD = '9' THEN '9'
                                                                              ELSE '8' END) = '8' AND D3.RTN_RPT_DT IS NULL THEN '11'
                                                                  WHEN
                                                                        (CASE WHEN (D3.AUD_EXEC_HNDL_STA_CD = '1' AND TO_DATE(D3.RTN_DT) > TO_DATE(SYSDATE)) THEN '7'
                                                                              WHEN ((D3.AUD_EXEC_HNDL_STA_CD = '1' AND TRIM(D3.HNDL_DDLN_DT) IS NULL) OR D3.AUD_EXEC_HNDL_STA_CD = '3') OR (D3.AUD_EXEC_HNDL_STA_CD = '1'AND NVL(TO_DATE(D3.HNDL_DDLN_DT),'99991231') < TO_DATE(SYSDATE) )THEN '8'
                                                                              WHEN D3.AUD_EXEC_HNDL_STA_CD = '1'AND NVL(TO_DATE(D3.HNDL_DDLN_DT),'99991231') < TO_DATE(SYSDATE) THEN '6'
                                                                              WHEN D3.AUD_EXEC_HNDL_STA_CD = '3' THEN '3'
                                                                              WHEN D3.AUD_EXEC_HNDL_STA_CD = '9' THEN '9'
                                                                              ELSE '8' END) = '7' THEN '02'
                                                                   END)
                                                        END
                                                      END)
                        END    AS PRSS_STEP_NM
                 ,DECODE(NVL((SELECT SUM(NVL(CNT,0)) AS SBCN_CNT
                                              FROM (
                                                    SELECT 
                                                        REL_AUD_YR AS AUD_YR
                                                        , REL_AUD_NO AS AUD_NO
                                                        , COUNT(1) CNT
                                                    FROM TBBADDED121M
                                                    WHERE WORK_DVSN_CD = 'A10'
                                                    GROUP BY REL_AUD_YR, REL_AUD_NO
                                                    UNION
                                                    SELECT 
                                                        AUD_YR
                                                        , AUD_NO
                                                        , COUNT(1) CNT
                                                    FROM TBBADDED113M T1
                                                    WHERE EXISTS (SELECT 1
                                                                                 FROM TBBADDED120M ST1
                                                                               WHERE ST1.CMT_DY = T1.SBCN_DY
                                                                                    AND ST1.CMT_DVSN_CD = '10')
                                                    GROUP BY AUD_YR, AUD_NO
                                                    UNION
                                                    SELECT 
                                                        AUD_YR
                                                        , AUD_NO
                                                        , COUNT(1) CNT
                                                    FROM TBBADDED114M T1
                                                    WHERE EXISTS (SELECT 1
                                                                                 FROM TBBADDED120M ST1
                                                                               WHERE ST1.CMT_DY = REPLACE(T1.SBMT_FIX_DT,'-')
                                                                                    AND ST1.CMT_DVSN_CD = '20')
                                                    GROUP BY AUD_YR, AUD_NO
                                                   )
                                             WHERE AUD_YR = D1.AUD_YR
                                               AND AUD_NO = D1.AUD_NO
                                             GROUP BY AUD_YR, AUD_NO),0),0,'N','Y') AS SBCN_YN /*부의 실시 여부 */
                 , D1.PRSS_STEP_CD
                 , D3.REQ_NTAS_DCS_DT  /*20170817 EUNOK 청구국회결정일 */
                 , D1.FRT_REGI_DH 
            FROM TBBADDED001M D1
                ,TBBADDED003M D3
           WHERE 1=1
             AND D1.AUD_YR          = D3.AUD_YR 
             AND D1.AUD_NO          = D3.AUD_NO
             AND D1.AUD_RPST_ORG_CD = #strOrgCd#
             AND SUBSTR(D1.AUD_KND_CD, 3, 1) <> '5' /*확인출장은 조회하지 않음*/
             AND D1.MNG_DPT_CD NOT IN ('100000','100100')
        ]]>
        
        <isNotEmpty property="strAudYrStr">	
        	<![CDATA[			
		    	AND D1.AUD_YR >= #strAudYrStr#
		    ]]>
		</isNotEmpty>       
		
        <isNotEmpty property="strAudYrEnd">				
        	<![CDATA[			
		    	AND D1.AUD_YR <= #strAudYrEnd#
		    ]]>
		</isNotEmpty>   
				
        <isNotEmpty property="strAudKndCd">				
		    AND D1.AUD_KND_CD LIKE '%' || SUBSTR(#strAudKndCd#,3,1)
		</isNotEmpty>   		 
        
        <isNotEmpty property="strAudSbjNm">				
		    AND D1.AUD_SBJ_NM LIKE '%'||#strAudSbjNm#||'%'
		</isNotEmpty>   	        
        
    	<include refid="include.pageOrder" />        
	</select>
	
	<select id="FAAAEA007E1101DocSelectBfEip" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[	
			SELECT DECODE(D1.DOC_TYP_CD,'AD-AR-002','실지감사계획서','AD-AR-003','실지감사종료보고','AD-AR-001','감사결과보고서') 
			                                            AS AUD_DOC_NM
			      ,D2.FILE_NAME                         AS RPRT_NM
			      ,''                                   AS DISP_APV_STA_NM
			      ,D1.DOC_TYP_CD                        AS RPRT_CD
			      ,''                                   AS APV_RQS_ID
			      ,''                                   AS APV_STA_CD
			      ,D1.DOC_ID                            AS DOC_ID
			 FROM TBBADDED021M D1
			    , ECM_FILE_LIST_VIEW2 D2
			WHERE 1=1
			  AND D1.DOC_ID = D2.DOC_ID
			  AND D1.AUD_YR = #strAudYr#
			  AND D1.AUD_NO = #strAudNo#
			  AND D1.DOC_TYP_CD IN ('AD-AR-003','AD-AR-001','AD-AR-002')
			ORDER BY DECODE(D1.DOC_TYP_CD,  'AD-AR-002', 1, 'AD-AR-003', 2,  'AD-AR-001', 3)	
        ]]>
	</select>			
	
	<select id="FAAAEA007E1101DocSelectYn" parameterClass="paramMap" resultClass="String">
        <![CDATA[	
			SELECT DECODE(COUNT(DOC_ID),0,'N','Y')
			  FROM TBBADDED103M 
			 WHERE AUD_YR          = #strAudYr#
			   AND AUD_NO          = #strAudNo#
			   AND RPRT_CD         = 'A10600200' /*감사보고서*/
			   AND AUD_STEP_CD     = 'A1070'
			   AND FNL_BAI_RPRT_YN = 'Y'
			   AND APV_STA_CD      = '30'        
        ]]>
	</select>	
	
	<select id="FAAAEA007E1101DocSelect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[	
			SELECT DECODE(DT.RPRT_CD, 'A10700500', '부의안/부의안요약문', F_CODE_NM('1000786',DT.RPRT_CD)) AS AUD_DOC_NM
			      ,DT.RPRT_NM
			      ,DT.DISP_APV_STA_NM 
			      ,DT.RPRT_CD
			      ,DT.APV_RQS_ID
			      ,DT.APV_STA_CD
			      ,DT.APV_DVSN_CD
			      ,DT.DOC_ID
			      ,DT.REF_ID
			  FROM (
					SELECT T1.RPRT_NM
					      ,F_CODE_NM('1000773',T1.APV_STA_CD) || '(' || TO_CHAR(APV.FNL_APV_DH,'YYYY-MM-DD') || ')' AS DISP_APV_STA_NM 
					      ,T1.RPRT_CD
					      ,T1.APV_RQS_ID
					      ,T1.APV_STA_CD
					      ,T1.DOC_ID
					      ,T1.REF_ID
					      ,APV.APV_DVSN_CD
					  FROM (
					  		/*예비조사계획서, 감사실시계획서, 감사종료보고서, 부의안/부의안요약문, 공개문전문*/
							SELECT  A.RPRT_CD
							       ,CASE WHEN A.RPRT_CD = 'A10700500'     /*부의안 요약 + 부의안 한줄로 처리 */
							             THEN A.RPRT_NM ||'/'|| (SELECT ST1.RPRT_NM
										                           FROM TBBADDED103M ST1
										                          WHERE ST1.AUD_YR      = A.AUD_YR
										                            AND ST1.AUD_NO      = A.AUD_NO
										                            AND ST1.AUD_STEP_CD = A.AUD_STEP_CD
										                            AND ST1.AUD_KND_CD  = A.AUD_KND_CD
										                            AND ST1.REF_DY      = A.REF_DY
										                            AND ST1.REF_DOC_ID  = A.REF_DOC_ID
										                            AND ST1.REF_ID      = A.DOC_ID
										                            AND ST1.RPRT_CD     = 'A10700800')   
							             ELSE A.RPRT_NM
							        END AS RPRT_NM
							       ,A.APV_STA_CD
							       ,A.APV_RQS_ID
							       ,A.DOC_ID
							       ,CASE WHEN A.RPRT_CD = 'A10700500'     /*부의안 인 경우 부의안요약문(원장용) DOC_ID를 조회*/
							             THEN (SELECT ST1.DOC_ID
							                     FROM TBBADDED103M ST1
					                            WHERE ST1.AUD_YR      = A.AUD_YR
					                              AND ST1.AUD_NO      = A.AUD_NO
					                              AND ST1.AUD_STEP_CD = A.AUD_STEP_CD
					                              AND ST1.AUD_KND_CD  = A.AUD_KND_CD
					                              AND ST1.REF_DY      = A.REF_DY
					                              AND ST1.REF_DOC_ID  = A.REF_DOC_ID
					                              AND ST1.REF_ID      = A.DOC_ID
					                              AND ST1.RPRT_CD     = 'A10700800')
							        	 ELSE REF_ID
							        END AS REF_ID
							  FROM TBBADDED103M A
							 WHERE A.AUD_YR     = #strAudYr#
							   AND A.AUD_NO     = #strAudNo#
							   AND A.RPRT_CD IN ('A10200100','A10300100','A10500200','A10700500') 
							   AND A.APV_STA_CD = '30'
							UNION
							/*감사보고서 : 결재완료된 최종보고서가 있으면 기존의 결재완료된 보고서(감사결과 처리단계의 보고서)가 아니라 최종보고서만 조회 */
							SELECT  A.RPRT_CD
							       ,A.RPRT_NM
							       ,A.APV_STA_CD
							       ,A.APV_RQS_ID
							       ,A.DOC_ID
							       ,A.REF_ID     
							  FROM TBBADDED103M A
							 WHERE A.AUD_YR     = #strAudYr#
							   AND A.AUD_NO     = #strAudNo#
							   AND A.RPRT_CD    = 'A10600200' 
					 		   AND A.APV_STA_CD = '30'
						]]>
						
					 	<isEqual property="strFnlBaiRprtYn" compareValue="Y">
					 		   /*최종보고서가 결재 완료면 최종보고서만 조회*/
							   AND AUD_STEP_CD = 'A1070' 
							   AND FNL_BAI_RPRT_YN = 'Y'
						</isEqual>
						
					<![CDATA[
					 	   ) T1
					 	 , TBDCMACM022L APV
					 WHERE T1.APV_RQS_ID  = APV.APV_DOC_NO
					   AND APV.APV_STA_CD = '3'
				UNION
				/*공개문전문 : 공개문 전문은 REF_ID, 감사보고서의 DOC_ID 가 있음*/
					SELECT A.RPRT_NM
					      ,'제출일자('|| TO_CHAR(TO_DATE(MAX(B.PRL_SMT_DT)),'YYYY-MM-DD') || ')' AS DISP_APV_STA_NM
					      ,A.RPRT_CD
					      ,A.APV_RQS_ID
					      ,A.APV_STA_CD
					      ,A.DOC_ID
					      ,A.REF_ID
					      ,'' AS APV_DVSN_CD
					  FROM TBBADDED103M A
					      ,TBBADEAR028M B
					 WHERE A.AUD_YR     = SUBSTR(B.AUD_SLN, 0, 4)
					   AND A.AUD_NO     = SUBSTR(B.AUD_SLN, 5, 3)
					   AND A.AUD_YR     = #strAudYr#
					   AND A.AUD_NO     = #strAudNo#
					   AND A.RPRT_CD    = 'A10800500' 
					   AND B.TSK_CAT_CD = 'KP1'
					   AND B.PRSS_STA_CD IN ('50','30')
					   AND A.REF_ID IN (SELECT AA.DOC_ID FROM TBBADDED103M AA
					                     WHERE AA.AUD_YR          = A.AUD_YR
					                       AND AA.AUD_NO          = A.AUD_NO
					                       AND AA.RPRT_CD         = 'A10600200'
					                       AND AA.AUD_STEP_CD     = 'A1070'
					                       AND AA.FNL_BAI_RPRT_YN = 'Y')
					 GROUP BY A.RPRT_NM
					         ,A.RPRT_CD
 					         ,A.APV_RQS_ID
					         ,A.APV_STA_CD
					         ,A.DOC_ID,A.REF_ID
				) DT
			ORDER BY DT.RPRT_CD      
        ]]>
	</select>		
		
		
	<select id="FAAAEA007E1501CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
        <![CDATA[
			SELECT COUNT(1) AS CNT 
			  FROM TBCSPBII500L A  /* 직무역량평가내역 */
			     , TBCSPBII300M B  /* 대인정보기본 */  
			 WHERE A.EIN = B.EIN
			   AND A.BLT_ORG_CD = #strOrgCd#
		]]>
	</select>
			
	<select id="FAAAEA007E1501Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />	
        <![CDATA[
        
			SELECT A.YE || '-' || LPAD(A.SRNO, 5, '0')       AS MTRL_NO
			     , B.NAM
			     , '******-*******'  AS RRN_MASK	/* 모든 사용자 주민번호 비공개  */ 			     
			     , (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.BLT_ORG_CD)          AS BLT_ORG_NM
			     , A.PST_NM
			     , F_CODE_NM('1000070', A.EVL_MTRL_DVSN_CD)  AS EVL_MTRL_DVSN_NM
			     , (SELECT B.DPT_NM
			          FROM TBDCMACM002M B
			         WHERE B.DPT_CD = A.EVL_DPT_CD)          AS EVL_DPT_NM  /* 평가부서명 */
			     , A.EVL_DT
			     , CASE B.RSG_YN WHEN 'Y' THEN B.RSG_YN
			                     ELSE ''
			       END                                       AS RSG_YN
			     , A.YE
			     , A.SRNO    
			     , A.EIN
			  FROM TBCSPBII500L A  /* 직무역량평가내역 */
			     , TBCSPBII300M B  /* 대인정보기본 */  
			 WHERE A.EIN = B.EIN
			   AND A.BLT_ORG_CD = #strOrgCd#
		]]>
		
    	<include refid="include.pageOrder" />        
	</select>
	
	<select id="FAAAEA007E1502CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
		<![CDATA[
	    SELECT COUNT(1) AS CNT
          FROM (
			    SELECT (SELECT MIN(AUD_STR_DT)  FROM TBBADDED002M A 
				   		 WHERE REL_AUD_YR = D1.AUD_YR AND REL_AUD_NO = D1.AUD_NO AND AUD_BZT_KND_CD IN ('02','03')) AS AUD_STR_DT /* 감사착수일 02:실지감사, 03:실지감사연장- 2017.11.14 EUNOK */
				FROM TBBADDED001M D1
			   WHERE 1=1
		         AND SUBSTR(D1.AUD_KND_CD, -1) != '5'  /* 확인출장 제외 */   		
				 AND D1.AUD_RPST_ORG_CD = #strOrgCd#
        	) T1
        	WHERE 1=1
        	 AND T1.AUD_STR_DT >= '20170908' 
        	 AND T1.AUD_STR_DT <= TO_CHAR(SYSDATE,'YYYYMMDD') /*실지감사 시작일이 20170908 이후 이고, 실지감사 시작한 감사사항*/   	
           ]]>        
	</select>	
	
	<select id="FAAAEA007E1502Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		<![CDATA[
		
	    SELECT T1.AUD_YR           		AS AUD_YR           		/*감사년도*/
	         , T1.AUD_NO           		AS AUD_NO           		/*감사번호*/
       		 , T1.AUD_YR_NO             AS AUD_YR_NO 
	         , T1.AUD_GRN_NO       		AS AUD_GRN_NO         		/*감사부여번호 - 2016.05.25 yyh*/   		
	         , T1.AUD_KND_CD       		AS AUD_KND_CD       		/*감사종류코드*/
             , T1.AUD_KND_NM       		AS AUD_KND_NM       		
	         , T1.SPV_BRDV_CD      		AS SPV_BRDV_CD      		/*주관국과코드*/
	         , T1.SPV_BRDV_NM  			AS SPV_BRDV_NM  			/*주관국과명*/      		
	         , T1.AUD_SBJ_NM       		AS AUD_SBJ_NM       		/*감사사항명*/		
	         , T1.AUD_RPST_ORG_CD  		AS AUD_RPST_ORG_CD  		/*감사대표기관코드*/
	         , T1.AUD_RPST_ORG_NM  		AS AUD_RPST_ORG_NM  		
	         , T1.MNG_DPT_CD       		AS MNG_DPT_CD       		/*관리부서코드*/
	         , T1.MNG_DPT_NM			AS MNG_DPT_NM			    		      
             , T1.PRSS_STEP_CD          AS PRSS_STEP_CD             /*진행단계코드*/
			 , F_CODE_NM('1000785',T1.PRSS_STEP_CD)  
		       || 
		       (CASE WHEN T1.BZT_BGT_DVSN_CD = '1' AND T1.PRSS_STEP_CD = '02'
		                 THEN 
						     (SELECT '/'|| F_CODE_NM('1000030',AUD_BZT_KND_CD)
						        FROM TBBADDED002M 
						       WHERE BZT_YR || BZT_SNO = (SELECT MAX(BZT_YR || BZT_SNO)
												            FROM TBBADDED002M
												           WHERE REL_AUD_YR = T1.AUD_YR
												             AND REL_AUD_NO = T1.AUD_NO
												          )
							 )
				   END) AS PRSS_STEP_NM     		                /*진행단계코드명*/
			 , T1.AUD_STR_DT                     AS AUD_STR_DT
			 , T1.AUD_END_DT                     AS AUD_END_DT      /* 실지감사 시작일, 종료일 - 2017.11.08 EUNOK */
			 , T1.FLD_AUD_END_DT                 AS FLD_AUD_END_DT  /* 종료보고일- 2017.10.31 EUNOK */
		     , T1.DOC_LIST                       AS DOC_LIST_A
		     , T1.RPRT_NM                        AS RPRT_NM_A
		     , TO_CHAR(T1.FNL_APV_DH,'YYYYMMDD') AS FNL_APV_DH
		     , T1.APV_STA_CD 
          FROM (
          
			    SELECT D1.AUD_YR                   	AS AUD_YR           /*감사년도*/
			         , D1.AUD_NO                   	AS AUD_NO           /*감사번호*/
			         , D1.AUD_GRN_NO                AS AUD_GRN_NO       /*감사부여번호*/
			         , F_MNG_KND_AUDYRNO(D1.AUD_YR, D1.AUD_NO, D1.AUD_KND_CD, '-')
			                                        AS AUD_YR_NO        /*감사년번호 - 수정(2015.12.17-yyh)*/		            
			         , D1.AUD_KND_CD               	AS AUD_KND_CD       /*감사종류코드*/
                     , F_CODE_NM_YEAR('1000007', D1.AUD_KND_CD, D1.AUD_YR) AS AUD_KND_NM 
			         , D1.SPV_BRDV_CD              	AS SPV_BRDV_CD      /*주관국과코드*/
			         , F_DPT_INFO(D1.SPV_BRDV_CD,'1')	AS SPV_BRDV_NM  /*주관국과명*/
			         , D1.AUD_SBJ_NM               	AS AUD_SBJ_NM       /*감사사항명*/
			         , D1.AUD_RPST_ORG_CD          	AS AUD_RPST_ORG_CD  /*감사대표기관코드*/
			         , F_ORG_INFO(D1.AUD_RPST_ORG_CD,'1')  AS AUD_RPST_ORG_NM 
			         , D1.MNG_DPT_CD               	AS MNG_DPT_CD       /*관리부서코드*/
			         , F_DPT_INFO(D1.MNG_DPT_CD,'1') 		AS MNG_DPT_NM			   
 					 , D1.PRSS_STEP_CD                          AS PRSS_STEP_CD   /*진행단계코드*/         
				     
				     , D1.BZT_BGT_DVSN_CD	
				     ,(SELECT MIN(AUD_STR_DT)  FROM TBBADDED002M A 
				   		WHERE REL_AUD_YR = D1.AUD_YR AND REL_AUD_NO = D1.AUD_NO AND AUD_BZT_KND_CD IN ('02','03')) AS AUD_STR_DT /* 감사착수일 02:실지감사, 03:실지감사연장- 2017.11.14 EUNOK */
				     ,(SELECT MAX(AUD_END_DT)  FROM TBBADDED002M A 
				   		WHERE REL_AUD_YR = D1.AUD_YR AND REL_AUD_NO = D1.AUD_NO AND AUD_BZT_KND_CD IN ('02','03')) AS AUD_END_DT /* 감사종료일 02:실지감사, 03:실지감사연장- 2017.11.07 EUNOK */ 
				     , D3.FLD_AUD_END_DT  /* 종료보고일 - 2017.10.31 EUNOK */
				     , D4.DOC_LIST
				     , D4.RPRT_NM 
				     , D4.APV_STA_CD 
				     , D5.FNL_APV_DH
				FROM TBBADDED001M D1
			       , TBCSPDCP101M D2
      			   , TBBADDED003M D3
                   , (SELECT A1.AUD_YR 
                            ,A1.AUD_NO
                            ,MAX (A1.APV_STA_CD) AS APV_STA_CD 
                   		    ,SUBSTR(XMLAGG(XMLELEMENT(X,',',DOC_ID)  ORDER BY AUD_YR,AUD_NO,AUD_STEP_CD,doc_ID).EXTRACT('//text()'),2) DOC_LIST 
                            ,SUBSTR(XMLAGG(XMLELEMENT(X,',',RPRT_NM) ORDER BY AUD_YR,AUD_NO,AUD_STEP_CD,doc_ID).EXTRACT('//text()'),2) RPRT_NM 
                       FROM TBBADDED103M A1
                	  WHERE A1.AUD_STEP_CD = 'A1050'
                  		AND A1.RPRT_CD = 'A10500500'
						AND (A1.APV_STA_CD IS  NULL OR A1.APV_STA_CD <= '30' )
                      GROUP BY A1.AUD_YR 
                              ,A1.AUD_NO ) D4 
                         
                    ,(SELECT AA.AUD_YR ,AA.AUD_NO,BB.APV_DH AS FNL_APV_DH
                    	FROM TBBADDED103M AA,TBDCMACM023L BB
                   		WHERE AA.AUD_STEP_CD     = 'A1050' 
                              AND AA.RPRT_CD     = 'A10500200' 
                        	  AND AA.APV_RQS_ID  = BB.APV_DOC_NO
                              AND AA.APV_STA_CD <= '30' 
						      AND BB.APVR_PST_CD = (SELECT APVR_PST_CD FROM TBDCMACM023L 
                                                     WHERE APV_SNO = (SELECT MAX(APV_SNO) 
                                                                        FROM TBDCMACM023L 
                                                                       WHERE APV_DOC_NO = BB.APV_DOC_NO)  
                                                       AND APV_DOC_NO = BB.APV_DOC_NO)  
                   			   AND BB.APVR_PST_CD IN ('0067400','0055700')  /* 최종결재자 원장이나 사무총장인경우 */  
			   			GROUP BY AA.AUD_YR 
			   			        ,AA.AUD_NO
			   			        ,AA.APV_RQS_ID
			   			        ,AA.RPRT_CD
			   			        ,BB.APV_DH) D5	
			   WHERE 1=1
			     AND D1.ACP_YR        = D2.ACP_YR(+)
			     AND D1.CVPT_ACP_NO   = D2.CVPT_ACP_NO(+)
			     AND D1.REQ_DVSN_CD   = D2.REQ_DVSN_CD(+)
			     AND D1.AUD_YR 		  = D3.AUD_YR(+)
			     AND D1.AUD_NO 		  = D3.AUD_NO(+)
			     AND D1.AUD_YR 		  = D4.AUD_YR(+)
			     AND D1.AUD_NO 		  = D4.AUD_NO(+)
			     AND D1.AUD_YR 		  = D5.AUD_YR(+)
			     AND D1.AUD_NO 		  = D5.AUD_NO(+)
		         AND SUBSTR(D1.AUD_KND_CD, -1) != '5'  /* 확인출장 제외 */   		
				 AND D1.AUD_RPST_ORG_CD = #strOrgCd#
        	) T1
        	WHERE 1=1
        	 AND T1.AUD_STR_DT >= '20170908' 
        	 AND T1.AUD_STR_DT <= TO_CHAR(SYSDATE,'YYYYMMDD') /*실지감사 시작일이 20170908 이후 이고, 실지감사 시작한 감사사항*/   				 
           ]]>        
        <include refid="include.pageOrder" />
	</select>
	
	<select id="FAAAEA007E1205CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
		<![CDATA[
                   SELECT COUNT(1) AS CNT 
                     FROM (SELECT * 
                             FROM TBAEPGKM001M A,
                                  TBDCMACM013C B,
                                  TBBADDED001M C
                            WHERE 1=1
                              AND B.CMM_CD_DVSN_CD = '1000836'
                              AND A.NEW_KLD_CAT_CD = B.CD
                              AND A.AUD_YR = C.AUD_YR
                              AND A.AUD_NO = C.AUD_NO
                              AND C.AUD_RPST_ORG_CD = #strOrgCd#
                            ORDER BY TO_NUMBER(A.KNB) DESC ) C,
                          (SELECT KNB,
                                  COUNT(KNB) AS COUNT
                             FROM (SELECT KNB
                                     FROM TBAEPGKM002L
                                    UNION ALL
                                   SELECT KNB
                                     FROM TBAEPGKM004L )
                            GROUP BY KNB) D,
                          (SELECT KNB,
                                  MAX(COFM_YN) AS COFM_YN
                             FROM TBAEPGKM016L
                            WHERE COFM_YN = 'Y'
                              AND KNB IS NOT NULL
                            GROUP BY KNB) E,
                          (SELECT POST_SEQ,
                                  COUNT(*) AS CMMT_CNT
                             FROM CTT_POST_CMMT
                            WHERE BOARD_ID = '1550'
                            GROUP BY POST_SEQ) F,
                          (SELECT KNB,
                                  SUM(CASE
                                        WHEN RCMD_YN = 'Y' THEN 1
                                        ELSE 0
                                      END ) AS RCMD_CNT
                             FROM TBAEPGKM021M
                            GROUP BY KNB) G
                    WHERE 1=1
                      AND C.KNB = D.KNB(+)
                      AND C.KNB = E.KNB(+)
                      AND C.KNB = F.POST_SEQ(+)
                      AND C.KNB = G.KNB(+) 
                           		
           ]]>        
	</select>		
		
	<select id="FAAAEA007E1205Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />
		<![CDATA[
		
                        SELECT C.KEY,
                               C.KNB,
                               C.KLD_CAT_NM,
                               C.CAT_SPH_NM,
                               C.KLD_NM,
                               C.REGN_NM,
                               C.REGI_RQS_DT,
                               C.KLD_STA_NM,
                               C.KLD_STA_CD,
                               C.PRSV_WAY_NM,
                               C.ABRG_DH,
                               C.SRCH_CNT,
                               C.DOC_YN,
                               C.DOC_ID,
                               C.ECL_KLD,
                               NVL(D.COUNT, '0') AS COUNT,
                               NVL(E.COFM_YN, 'N') AS COFM_YN,
                               NVL(F.CMMT_CNT, 0) AS CMMT_CNT,
                               NVL(G.RCMD_CNT, 0) AS RCMD_CNT,
                               AUD_RPST_ORG_CD,
                               F_ORG_INFO(AUD_RPST_ORG_CD, '1') AS  AUD_RPST_ORG_NM
                          FROM (SELECT ROWNUM AS KEY,
                                       A.KNB,
                                       F_CODE_NM('1000836', A.NEW_KLD_CAT_CD) AS KLD_CAT_NM,
                                       F_CODE_NM('1000837', A.NEW_CAT_SPH_CD) AS CAT_SPH_NM,
                                       A.KLD_NM,
                                       F_USR_INFO(A.REGN_CNB, '2') AS REGN_NM,
                                       A.REGI_RQS_DT,
                                       F_CODE_NM('1000351', A.KLD_STA_CD) AS KLD_STA_NM,
                                       A.KLD_STA_CD,
                                       DECODE(A.PRSV_WAY_CD, '0', '영구보존', '1', '기간제한') AS PRSV_WAY_NM,
                                       TO_CHAR(A.ABRG_DH, 'YYYYMMDD') AS ABRG_DH,
                                       A.SRCH_CNT,
                                       DECODE(A.DOC_ID, NULL, 'N', 'Y') AS DOC_YN,
                                       A.DOC_ID,
                                       NVL(A.ECL_KLD, 'N') AS ECL_KLD,
                                       C.AUD_RPST_ORG_CD
                                  FROM TBAEPGKM001M A,
                                       TBDCMACM013C B,
                                       TBBADDED001M C
                                 WHERE 1=1
                                   AND B.CMM_CD_DVSN_CD = '1000836'
                                   AND A.NEW_KLD_CAT_CD = B.CD
                                   AND A.AUD_YR = C.AUD_YR
                                   AND A.AUD_NO = C.AUD_NO
                                   AND C.AUD_RPST_ORG_CD = #strOrgCd#
                                 ORDER BY TO_NUMBER(A.KNB) DESC ) C,
                               (SELECT KNB,
                                       COUNT(KNB) AS COUNT
                                  FROM (SELECT KNB
                                          FROM TBAEPGKM002L
                                         UNION ALL
                                        SELECT KNB
                                          FROM TBAEPGKM004L )
                                 GROUP BY KNB) D,
                               (SELECT KNB,
                                       MAX(COFM_YN) AS COFM_YN
                                  FROM TBAEPGKM016L
                                 WHERE COFM_YN = 'Y'
                                   AND KNB IS NOT NULL
                                 GROUP BY KNB) E,
                               (SELECT POST_SEQ,
                                       COUNT(*) AS CMMT_CNT
                                  FROM CTT_POST_CMMT
                                 WHERE BOARD_ID = '1550'
                                 GROUP BY POST_SEQ) F,
                               (SELECT KNB,
                                       SUM(CASE
                                             WHEN RCMD_YN = 'Y' THEN 1
                                             ELSE 0
                                           END ) AS RCMD_CNT
                                  FROM TBAEPGKM021M
                                 GROUP BY KNB) G
                         WHERE 1=1
                           AND C.KNB = D.KNB(+)
                           AND C.KNB = E.KNB(+)
                           AND C.KNB = F.POST_SEQ(+)
                           AND C.KNB = G.KNB(+) 
                           		
           ]]>        
        <include refid="include.pageOrder" />
	</select>		
	
	
	<!-- *********************************************** 2차 개발 (2018.06.01) ******************************************** -->
  	<select id="FAAAEA007E1204CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
        <![CDATA[    
        
			SELECT COUNT(1) AS CNT 
			  FROM TBBADCMR016M T1
			 WHERE 1=1	 
               AND (SELECT COUNT(1)
                      FROM TBBADCMR017L
                     WHERE YE       = T1.YE
                       AND TASK_SNO = T1.TASK_SNO
                       AND ORG_CD   = #strOrgCd#) > 0 
			  ]]>
	</select>	
		
  	<select id="FAAAEA007E1204Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid="include.pageSelct" />  
        <![CDATA[    
        
			SELECT T1.YE        
			     , T1.TASK_SNO
			     , T1.YE ||'-'|| T1.TASK_SNO    AS TASK_YE_SNO
			     , TASK_TIT_NM
			     , TASK_TXT
			     , CHR_DPT_CD 
			     , F_DPT_INFO (CHR_DPT_CD,'1')  AS DPT_NM
			     , T2.CHGR_ID_1                 AS CHGR_ID
			     , F_USR_INFO(T2.CHGR_ID_1,'2') AS CHGR_NM
			     , ORG_CD
			     , (SELECT F_ORG_INFO(MIN(ORG_CD), '1') || CASE WHEN COUNT(1) > 1 THEN  ' 외 ' || (COUNT(1) - 1) 
                                                                ELSE ''
                                                            END 
                      FROM TBBADCMR017L
                     WHERE YE       = T1.YE
                       AND TASK_SNO = T1.TASK_SNO
                     GROUP BY YE
                             ,TASK_SNO)         AS ORG_NM			     
			     , CMPT_YN
                 , T2.CHGR_ID_1
                 , F_USR_INFO(T2.CHGR_ID_1,'2') AS CHGR_NM_1
                 , T2.CHGR_ID_2
                 , F_USR_INFO(T2.CHGR_ID_2,'2') AS CHGR_NM_2
                 , T2.CHGR_ID_3
                 , F_USR_INFO(T2.CHGR_ID_3,'2') AS CHGR_NM_3
			  FROM TBBADCMR016M T1
                  ,(SELECT YE
                          ,TASK_SNO
                          ,MAX(CASE WHEN ROW_CNT = 1 THEN CHGR_ID ELSE '' END) AS CHGR_ID_1
                          ,MAX(CASE WHEN ROW_CNT = 2 THEN CHGR_ID ELSE '' END) AS CHGR_ID_2
                          ,MAX(CASE WHEN ROW_CNT = 3 THEN CHGR_ID ELSE '' END) AS CHGR_ID_3
                      FROM (
                            SELECT YE
                                  ,TASK_SNO
                                  ,ROW_NUMBER() OVER(PARTITION BY YE, TASK_SNO ORDER BY CHGR_ID ASC) AS ROW_CNT
                                  ,CHGR_ID
                              FROM TBBADCMR021L
                            )
                     GROUP BY YE
                             ,TASK_SNO) T2
			 WHERE 1=1
               AND T1.YE       = T2.YE(+)
               AND T1.TASK_SNO = T2.TASK_SNO(+)			 
               AND (SELECT COUNT(1)
                      FROM TBBADCMR017L
                     WHERE YE       = T1.YE
                       AND TASK_SNO = T1.TASK_SNO
                       AND ORG_CD   = #strOrgCd#) > 0 
            	
                          
		]]>
        <include refid="include.pageOrder" />			  
	</select>	
	
	<select id="FAAAEA007E1107CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
        <![CDATA[       
                  SELECT COUNT(1) AS CNT
                   FROM TBDCMIDM001L A
                  WHERE 1=1
                    AND A.PRSR_ORG_CD = #strOrgCd#
		]]>
	</select>	
		
	<select id="FAAAEA007E1107Select" parameterClass="paramMap" resultClass="resultMap">
		<include refid = "include.pageSelct"/>
        <![CDATA[       
                
                  SELECT A.AUD_SMT_MTRL_ID      
                        ,A.REGI_RQS_DT             
                        ,A.AUD_SMT_MTRL_TIT_NM     
                        ,A.RQS_TXT                 
                        ,A.RQR_CNB                 
                        ,A.RQS_DOC_ID              
                        ,A.SMT_DT                  
                        ,A.SMT_TXT                 
                        ,A.PRSR_NAM                
                        ,A.PRSR_TNB                
                        ,A.PRSR_EML_AD             
                        ,A.SMT_DOC_ID              
                        ,A.PRSR_ORG_CD   
                        ,C.ORG_NM AS PRSR_ORG_NM
                        ,A.SMT_ORG_CD              
                        ,A.SMT_ORG_NM              
                        ,A.SMT_ORG_BRDV_CD         
                        ,A.VLD_PRD_STR_YM || '01' AS  VLD_PRD_STR_YM     
                        ,A.VLD_PRD_END_YM || '01' AS  VLD_PRD_END_YM               
                        ,CASE WHEN A.SMT_DVSN_CD = '1' THEN '홈페이지'
                              WHEN A.SMT_DVSN_CD = '2' THEN '공공감사정보시스템'
                              WHEN A.SMT_DVSN_CD = '3' THEN '메일'
                              WHEN A.SMT_DVSN_CD = '4' THEN 'Fax서버'
                              WHEN A.SMT_DVSN_CD = '5' THEN '감사관수집'
                              WHEN A.SMT_DVSN_CD = '6' THEN '감사자료제출(업무망)'
                              WHEN A.SMT_DVSN_CD = '7' THEN '온나라문서'
                          END                                             AS SMT_DVSN_CD        
                        ,CASE WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '1'  THEN '미제출'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '2'  THEN '미제출(대상기관 접수))'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '3'  THEN '미접수(대상기관 자료 제출건)'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '4'  THEN '접수'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '5'  THEN '캐비닛'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '6'  THEN '지식'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '7'  THEN '지식/캐비닛'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '9'  THEN '요구취소'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '10' THEN '이관완료'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '11' THEN '결재 승인대기'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '12' THEN '결재승인'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '13' THEN '결재반려'
                              WHEN A.AUD_SMT_MTRL_ACP_STA_CD = '14' THEN '자료요청'
                          END                                             AS AUD_SMT_MTRL_ACP_STA_CD
                        ,CASE WHEN A.OPEN_STA_CD = 'Y' THEN '공개'
                              ELSE '비공개'
                          END                                             AS OPEN_STA_CD            
                        ,A.SMT_ORG_CNCT_DT         
                        ,A.RQS_ORG_CNCT_DT         
                        ,A.RQR_DPT_CD              
                        ,B.USR_NAM AS RQR_CNB_NM
                        ,B.EML_AD AS RQR_CNB_EML
                        ,CASE WHEN B.TNB IS NULL THEN B.HOM_TNB ELSE B.TNB END AS RQR_CNT_TEL
                        ,A.SMT_ORG_BRDV_NM AS SMT_ORG_BRDV_NM
                        ,B.DPT_NM
                        ,(SELECT SUBSTR(REPLACE(REPLACE(XMLAGG(XMLELEMENT(X,CHR(10), PAGE_NAME) ORDER BY PAGE_NAME), '<X>', ''), '</X>' ,''), 2)
                            FROM UBJDRAPP.ECM_FILE_LIST_VIEW 
                           WHERE DOC_ID = A.RQS_DOC_ID)        AS RQS_ATTACK_FILE_INFO
                        ,(SELECT SUBSTR(REPLACE(REPLACE(XMLAGG(XMLELEMENT(X,CHR(10), PAGE_NAME) ORDER BY PAGE_NAME), '<X>', ''), '</X>' ,''), 2)
                            FROM UBJDRAPP.ECM_FILE_LIST_VIEW 
                           WHERE DOC_ID = A.SMT_DOC_ID)        AS SMT_ATTACK_FILE_INFO
                        ,A.AUD_YR
                        ,A.AUD_NO
                        ,D.AUD_SBJ_NM
                        ,CASE WHEN D.AUD_YR >= '2016' 
                                   THEN F_CODE_NM('1000739', SUBSTR(D.AUD_KND_CD,3,1))
                              ELSE '' 
                         END                                   AS AUD_YR_NO_KND_NM /*감사연번호종류코드 추가 - 2015.12.18 yyh*/	
                        ,D.AUD_GRN_NO                          AS AUD_GRN_NO	
                   FROM TBDCMIDM001L A
                       ,(SELECT USR.USR_NAM
                               ,USR.EML_AD
                               ,USR.TNB
                               ,USR.HOM_TNB
                               ,USR.CNB
                               ,DPT.DPT_NM
                           FROM TBDCMACM001M USR, TBDCMACM002M DPT
                          WHERE USR.DPT_CD = DPT.DPT_CD(+)
                         ) B
                       ,TBDCMACM015M C
                       ,TBBADDED001M D
                  WHERE A.RQR_CNB     = B.CNB(+)
                    AND A.PRSR_ORG_CD = C.ORG_CD(+)
                    AND A.AUD_YR      = D.AUD_YR(+)
                    AND A.AUD_NO      = D.AUD_NO(+)
                    AND A.PRSR_ORG_CD = #strOrgCd#
		]]>
		<include refid = "include.pageOrder"/> 
	</select>	
	
	<select id="FAAAEA007E2601CntSelect" parameterClass="paramMap" resultClass="java.lang.Integer">
			 SELECT COUNT(1) AS CNT
			   FROM TBCSPTSM002L D1
			  WHERE D1.BBS_ID='BBSMSTR_100000000032'
				AND D1.USE_AT = 'Y' 
				AND D1.REL_ORG_CD  = #strOrgCd#
				AND D1.APV_STA_CD='3' 
	</select>

	<resultMap class="java.util.HashMap" id="faaaea007eMap">
		<result property="NUM" column="NUM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="TOT_CNT" column="TOT_CNT" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="NTT_ID" column="NTT_ID" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="NTT_SJ" column="NTT_SJ" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FRST_REGISTER_ID" column="FRST_REGISTER_ID" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FRST_REGISTER_NM" column="FRST_REGISTER_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="FRST_REGIST_PNTTM" column="FRST_REGIST_PNTTM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="EMAIL" column="EMAIL" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="TEL" column="TEL" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="JUSO" column="JUSO" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="NTT_CN" column="NTT_CN" jdbcType="CLOB" javaType="java.lang.String" />
		<result property="RDCNT" column="RDCNT" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="CATEGORY" column="CATEGORY" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="PARNTSCTT_NO" column="PARNTSCTT_NO" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ANSWER_AT" column="ANSWER_AT" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ANSWER_LC" column="ANSWER_LC" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="USE_AT" column="USE_AT" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="DOC_ID" column="DOC_ID" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="BBS_ID" column="BBS_ID" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="NTCE_BGNDE" column="NTCE_BGNDE" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="NTCE_ENDDE" column="NTCE_ENDDE" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="NTCR_NM" column="NTCR_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="REL_ORG_CD" column="REL_ORG_CD" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="REL_ORG_NM" column="REL_ORG_NM" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ORG_REGI_YN" column="ORG_REGI_YN" jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="INSTITUTION" column="INSTITUTION" jdbcType="VARCHAR2" javaType="java.lang.String" />
	</resultMap>
				
	<select id="FAAAEA007E2601Select" parameterClass="paramMap" resultMap="faaaea007eMap">
		<include refid="include.pageSelct" />
			SELECT
				D1.NTT_ID, D1.NTT_SJ, D1.FRST_REGISTER_ID, NVL(D2.USR_NAM, D1.NTCR_NM) AS FRST_REGISTER_NM,
				TO_CHAR(D1.FRST_REGIST_PNTTM, 'YYYY-MM-DD') AS FRST_REGIST_PNTTM, D1.EMAIL, D1.TEL, D1.JUSO, D1.SUB1, D1.SUB2,
				D1.RDCNT,D1.CATEGORY, D1.PARNTSCTT_NO, D1.ANSWER_AT, D1.ANSWER_LC, D1.USE_AT, D1.DOC_ID ,
				CASE WHEN D1.SUB1 IS NOT NULL AND D1.NTT_CN IS NOT NULL AND D1.SUB2 IS NOT NULL THEN TO_CLOB(D1.SUB1) || CHR(13)||CHR(10) || TO_CLOB(D1.NTT_CN) || CHR(13)||CHR(10) ||TO_CLOB(D1.SUB2)
					 WHEN D1.SUB1 IS NOT NULL AND D1.NTT_CN IS NOT NULL AND D1.SUB2 IS NULL     THEN TO_CLOB(D1.SUB1) || CHR(13)||CHR(10) || TO_CLOB(D1.NTT_CN)
					 WHEN D1.SUB1 IS NOT NULL AND D1.NTT_CN IS NULL AND D1.SUB2 IS NOT NULL     THEN TO_CLOB(D1.SUB1) || CHR(13)||CHR(10) || TO_CLOB(D1.SUB2)
					 WHEN D1.SUB1 IS NULL AND D1.NTT_CN IS NOT NULL AND D1.SUB2 IS NOT NULL     THEN TO_CLOB(D1.NTT_CN) || CHR(13)||CHR(10) || TO_CLOB(D1.SUB2)
					 WHEN D1.SUB1 IS NOT NULL AND D1.NTT_CN IS NULL AND D1.SUB2 IS NULL         THEN TO_CLOB(D1.SUB1)
					 WHEN D1.SUB1 IS NULL AND D1.NTT_CN IS NOT NULL AND D1.SUB2 IS NULL         THEN TO_CLOB(D1.NTT_CN)
					 WHEN D1.SUB1 IS NULL AND D1.NTT_CN IS NULL AND D1.SUB2 IS NOT NULL         THEN TO_CLOB(D1.SUB2)
					 ELSE TO_CLOB('')
					 END NTT_CN,
				D1.BBS_ID, RTRIM(D1.NTCE_BGNDE) NTCE_BGNDE, RTRIM(D1.NTCE_ENDDE) NTCE_ENDDE,  D1.NTCR_NM, D1.INSTITUTION,
				D1.REL_ORG_CD, F_ORG_INFO(D1.REL_ORG_CD,'1') AS REL_ORG_NM , CASE WHEN D1.ORG_REGI_YN='Y' THEN '등록' ELSE '미등록' END AS ORG_REGI_YN
			FROM
				TBCSPTSM002L D1
			LEFT OUTER JOIN 
				TBDCMACM001M D2
			ON D1.FRST_REGISTER_ID = D2.USR_ID 
			WHERE BBS_ID='BBSMSTR_100000000032'
			AND D1.USE_AT = 'Y'
			AND D1.REL_ORG_CD = #strOrgCd#
			AND D1.APV_STA_CD='3' 
			
			<isNotEmpty property="strSearchBox"><!-- 제목, 내용, 작성자 -->
			AND (D1.NTT_SJ  LIKE '%' || #strSearchBox# || '%' OR  D1.NTT_CN  LIKE '%' || #strSearchBox# || '%' OR D1.NTCR_NM  LIKE '%' || #strSearchBox# || '%')	
			</isNotEmpty>
			<isNotEmpty property="strFRST_REGIST_PNTTMS"><!-- 시작 작성일 -->
			AND (TO_CHAR(D1.FRST_REGIST_PNTTM,'YYYYMMDD') <![CDATA[ >= ]]> #strFRST_REGIST_PNTTMS# OR  D1.FRST_REGIST_PNTTM IS NULL)
			</isNotEmpty>
	
			<isNotEmpty  property="strFRST_REGIST_PNTTME"><!-- 종료 작성일 -->
			AND (TO_CHAR(D1.FRST_REGIST_PNTTM,'YYYYMMDD') <![CDATA[ <= ]]> #strFRST_REGIST_PNTTME# OR D1.FRST_REGIST_PNTTM IS NULL)
			</isNotEmpty>
			<isNotEmpty property="strYr" > <!-- 연도별 -->
			AND SUBSTR(D1.FRST_REGIST_PNTTM,1,4) = #strYr#	
			</isNotEmpty>
    	<include refid="include.pageOrder" />
	</select>
			
</sqlMap> 
