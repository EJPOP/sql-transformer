<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/gsu/007">
 
 	<select id="CSPGSU007EMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	DECODE(A.PRPS_ACP_NO,NULL,'',A.PRPS_YE||'-'||A.PRPS_ACP_NO) AS PRPS_ACP_NO	/*접수번호*/
					,A.PRPS_TIT_NM		/*제안제목*/
					,A.ACP_DT			/*접수일자*/
					,A.PRPS_STA_CD		/*제안상태코드*/
					,F_CODE_NM('1000075',A.PRPS_STA_CD) AS PRPS_STA_NM		/*제안상태코드*/
					,A.PRPS_YE			/*제안연도*/
					,A.PRPS_SLN			/*제안연번*/
					,A.PRPS_ACP_NO AS ACP_NO
					,A.EXAM_APV_DOC_NO	/*검토결재문서번호*/
					,A.EXAM_RSLT_CD
			FROM	TBCSPGSU001M A		/*도서자료기본*/
			WHERE	1=1
			AND		EXAM_DPT_CD = #strDPT_CD#
			
		]]>
		<dynamic>
			<isEmpty property="strPRPS_STA_CD">
				AND	A.PRPS_STA_CD &gt;= 'G' 
			</isEmpty>
			<isNotEmpty property="strPRPS_STA_CD">
				AND	A.PRPS_STA_CD = #strPRPS_STA_CD#
			</isNotEmpty>
			<isNotEmpty property="strACP_DTS">
				AND	A.ACP_DT &gt;= #strACP_DTS#
			</isNotEmpty>
			<isNotEmpty property="strACP_DTE">
				AND	A.ACP_DT &lt;= #strACP_DTE#
			</isNotEmpty>
			<isNotEmpty property="strPRPS_TIT_NM">
				AND	A.PRPS_TIT_NM LIKE '%'||#strPRPS_TIT_NM#||'%'
			</isNotEmpty>
		</dynamic> 
		<![CDATA[
			ORDER BY  TO_NUMBER(A.PRPS_YE) DESC , TO_NUMBER(A.PRPS_ACP_NO) DESC
		]]>
	</select>
	
	<update id="CSPGSU007EExAcceptUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPGSU001M
			SET		PRPS_STA_CD = 'H'		/*진행상태*/
					,FNL_USR_ID = #FNL_USR_ID#	/*최종사용자ID*/
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#	/*최종부서*/
					,FNL_MNU_ID = #FNL_MNU_ID#		/*최종메뉴*/
					,FNL_MDF_DH = SYSDATE			/*최종수정일시*/
		]]>
			<dynamic>
				<isNotEmpty property="EXAM_PEN_CNB">
					,EXAM_PEN_CNB = #EXAM_PEN_CNB#	/*검토자전산번호*/
				</isNotEmpty>
				<isEmpty property="EXAM_PEN_CNB">
					,EXAM_PEN_CNB = #S_CNB#	/*검토자전산번호*/
				</isEmpty>
			</dynamic>
		<![CDATA[
			WHERE	PRPS_YE = #PRPS_YE#
			AND		PRPS_SLN = #PRPS_SLN#
		]]>
	</update>
	
	<update id="CSPGSU007EExActCancleUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPGSU001M
			SET		EXAM_PEN_CNB = ''	/*검토자전산번호*/
					,PRPS_STA_CD = 'G'		/*진행상태*/
					,FNL_USR_ID = #FNL_USR_ID#	/*최종사용자ID*/
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#	/*최종부서*/
					,FNL_MNU_ID = #FNL_MNU_ID#		/*최종메뉴*/
					,FNL_MDF_DH = SYSDATE			/*최종수정일시*/
			WHERE	PRPS_YE = #PRPS_YE#
			AND		PRPS_SLN = #PRPS_SLN#
		]]>
	</update>
	
	<update id="CSPGSU007EExCompletionUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPGSU001M
			SET		PRPS_STA_CD = 'L'		/*진행상태*/
					,FNL_USR_ID = #FNL_USR_ID#	/*최종사용자ID*/
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#	/*최종부서*/
					,FNL_MNU_ID = #FNL_MNU_ID#		/*최종메뉴*/
					,FNL_MDF_DH = SYSDATE			/*최종수정일시*/
			WHERE	PRPS_YE = #PRPS_YE#
			AND		PRPS_SLN = #PRPS_SLN#
		]]>
	</update>
	
	<update id="CSPGSU007EExCompCancleUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPGSU001M
			SET		PRPS_STA_CD = 'K'		/*진행상태*/
					,FNL_USR_ID = #FNL_USR_ID#	/*최종사용자ID*/
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#	/*최종부서*/
					,FNL_MNU_ID = #FNL_MNU_ID#		/*최종메뉴*/
					,FNL_MDF_DH = SYSDATE			/*최종수정일시*/
			WHERE	PRPS_YE = #PRPS_YE#
			AND		PRPS_SLN = #PRPS_SLN#
		]]>
	</update>
	
	<select id="CSPGSU008EMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	DECODE(A.PRPS_ACP_NO,NULL,'',A.PRPS_YE||'-'||A.PRPS_ACP_NO) AS PRPS_ACP_NO	/*접수번호*/
					,A.ACP_DT			/*접수일자*/
					,A.SMT_DT			/*제출일자*/
					,A.PRPS_TIT_NM		/*제안제목*/
					,F_USR_INFO(A.PRPS_PEN_CNB,'2')	AS PRPS_PEN_NAM /*제안자명*/
					,A.PRPS_PEN_CNB		/*제안자전산번호*/
					,B.JNT_PRPS_PEN_NAM	/*공동제안자*/
					,F_CODE_NM('1000075',A.PRPS_STA_CD) AS PRPS_STA_NM	/*진행단계*/
					,A.PRPS_STA_CD		/*제안상태코드*/
					,A.CUR_SYE_TXT		/*현행제도내용*/
					,A.PRB_TXT			/*문제점내용*/
					,A.IMP_ATV_TXT		/*개선대안내용*/
					,A.IMP_EFCT_TXT		/*개선효과내용*/
					,(SELECT 	Z.DOC_ID	
						FROM	TBCSPGSU004M Z
						WHERE	Z.PRPS_YE = A.PRPS_YE
						AND		Z.PRPS_SLN = A.PRPS_SLN
						AND		Z.PRPS_ATT_FL_DVSN_CD = '1') AS DOC_ID	/*첨부파일 문서*/
					,F_DPT_INFO(A.EXAM_DPT_CD,'1') AS EXAM_DPT_NM		/*검토부서*/
					,A.EXAM_DPT_CD		/*검토부서코드*/
					,A.EXAM_DT			/*검토일자*/
					,F_USR_INFO(A.EXAM_PEN_CNB,'2') AS EXAM_PEN_NAM		/*검토자*/
					,A.EXAM_PEN_CNB
					,A.EXAM_TXT			/*검토의견*/
					,A.EXAM_RSLT_CD		/*검토결과*/
					,(SELECT 	Z.DOC_ID	
						FROM	TBCSPGSU004M Z
						WHERE	Z.PRPS_YE = A.PRPS_YE
						AND		Z.PRPS_SLN = A.PRPS_SLN
						AND		Z.PRPS_ATT_FL_DVSN_CD = '2') AS EXAM_DOC_ID	/*검토첨부파일 문서*/
					,DECODE(A.PRPS_STA_CD,'N','Y','M','N','') AS PRPS_STA_YN	/*채택여부*/
					,A.JDG_DT			/*위원회일자*/
					,A.RK_CD			/*제안등급*/
					,A.PRPS_ASC			/*제안평점*/
					,A.CNTR_PRPS_RCMD_DVSN_CD	/*중앙제안추천여부*/
					,A.PRPS_YE			/*제안연도*/
					,A.PRPS_SLN			/*제안연번*/
					,A.EXAM_APV_DOC_NO	/*검토결재문서번호*/
					,A.EXEC_APT_DT /*실시예정일*/
			FROM	TBCSPGSU001M A /*도서자료기본*/
					, (	SELECT 	PRPS_YE, PRPS_SLN, AGGR_CONCAT(F_USR_INFO (A.PRPS_PEN_CNB,'2'),'/') AS JNT_PRPS_PEN_NAM 
						FROM 	TBCSPGSU002L A WHERE 1=1
					    AND 	A.PRPS_YE = #strPRPS_YE#
					    AND 	A.PRPS_SLN = #strPRPS_SLN#
					    AND		A.SNO <> 1
					    GROUP BY PRPS_YE, PRPS_SLN) B
			WHERE 	1=1
		    AND 	A.PRPS_YE = #strPRPS_YE#
		    AND 	A.PRPS_SLN = #strPRPS_SLN#
		    AND	 	A.PRPS_YE = B.PRPS_YE(+)
		    AND 	A.PRPS_SLN = B.PRPS_SLN(+)
		]]>
	</select>
	
	<update id="CSPGSU008EExamUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPGSU001M
			SET		EXAM_PEN_CNB = #EXAM_PEN_CNB#		/*검토자*/
					,EXAM_RSLT_CD = NVL(#EXAM_RSLT_CD#,'N')
					,EXAM_DT = #EXAM_DT#
					,EXAM_TXT = #EXAM_TXT#
					,PRPS_STA_CD = 'H'
					,EXEC_APT_DT = #EXEC_APT_DT#		/*실시예정일시*/
					,FNL_USR_ID = #FNL_USR_ID#	/*최종사용자ID*/
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#	/*최종부서*/
					,FNL_MNU_ID = #FNL_MNU_ID#		/*최종메뉴*/
					,FNL_MDF_DH = SYSDATE			/*최종수정일시*/
			WHERE	PRPS_YE = #PRPS_YE#
			AND		PRPS_SLN = #PRPS_SLN#
		]]>
	</update>
	
	<update id="CSPGSU007EExamApvSave" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPGSU001M
			SET		PRPS_STA_CD = 'I'		/*진행상태*/
					,EXAM_APV_DOC_NO = #APV_DOC_NO#
			WHERE	PRPS_YE = #PRPS_YE#
			AND		PRPS_SLN = #PRPS_SLN#
		]]>
	</update>
	
	<select id="CSPGSU007PApvMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	DECODE(A.PRPS_ACP_NO,NULL,'',A.PRPS_YE||'-'||A.PRPS_ACP_NO) AS PRPS_ACP_NO	/*접수번호*/
					,A.ACP_DT			/*접수일자*/
					,A.SMT_DT			/*제출일자*/
					,A.PRPS_TIT_NM		/*제안제목*/
					,F_USR_INFO(A.PRPS_PEN_CNB,'2')	AS PRPS_PEN_NAM /*제안자명*/
					,A.PRPS_PEN_CNB		/*제안자전산번호*/
					,B.JNT_PRPS_PEN_NAM	/*공동제안자*/
					,F_CODE_NM('1000075',A.PRPS_STA_CD) AS PRPS_STA_NM	/*진행단계*/
					,A.PRPS_STA_CD		/*제안상태코드*/
					,A.CUR_SYE_TXT		/*현행제도내용*/
					,A.PRB_TXT			/*문제점내용*/
					,A.IMP_ATV_TXT		/*개선대안내용*/
					,A.IMP_EFCT_TXT		/*개선효과내용*/
					,(SELECT 	Z.DOC_ID	
						FROM	TBCSPGSU004M Z
						WHERE	Z.PRPS_YE = A.PRPS_YE
						AND		Z.PRPS_SLN = A.PRPS_SLN
						AND		Z.PRPS_ATT_FL_DVSN_CD = '1') AS DOC_ID	/*첨부파일 문서*/
					,F_DPT_INFO(A.EXAM_DPT_CD,'1') AS EXAM_DPT_NM		/*검토부서*/
					,A.EXAM_DPT_CD		/*검토부서코드*/
					,A.EXAM_DT			/*검토일자*/
					,F_USR_INFO(A.EXAM_PEN_CNB,'2') AS EXAM_PEN_NAM		/*검토자*/
					,A.EXAM_TXT			/*검토의견*/
					,F_CODE_NM('1000077',A.EXAM_RSLT_CD) AS EXAM_RSLT_NM
					,(SELECT 	Z.DOC_ID	
						FROM	TBCSPGSU004M Z
						WHERE	Z.PRPS_YE = A.PRPS_YE
						AND		Z.PRPS_SLN = A.PRPS_SLN
						AND		Z.PRPS_ATT_FL_DVSN_CD = '2') AS EXAM_DOC_ID	/*검토첨부파일 문서*/
					,DECODE(A.PRPS_STA_CD,'N','Y','M','N','') AS PRPS_STA_YN	/*채택여부*/
					,A.JDG_DT			/*위원회일자*/
					,A.RK_CD			/*제안등급*/
					,A.PRPS_ASC			/*제안평점*/
					,A.CNTR_PRPS_RCMD_DVSN_CD	/*중앙제안추천여부*/
					,A.PRPS_YE			/*제안연도*/
					,A.PRPS_SLN			/*제안연번*/
					,A.EXEC_APT_DT		/*실시예정일*/
			FROM	TBCSPGSU001M A /*도서자료기본*/
					, (	SELECT 	PRPS_YE, PRPS_SLN, AGGR_CONCAT(F_USR_INFO (A.PRPS_PEN_CNB,'2'),'/') AS JNT_PRPS_PEN_NAM 
						FROM 	TBCSPGSU002L A WHERE 1=1
						AND		A.SNO <> 1
					    GROUP BY PRPS_YE, PRPS_SLN) B
			WHERE 	1=1
		]]>
		<dynamic>
			<isNotEmpty property="strPRPS_YE">
				AND 	A.PRPS_YE = #strPRPS_YE#
		    AND 	A.PRPS_SLN = #strPRPS_SLN#
			</isNotEmpty>
			<isNotEmpty property="strDOC_NO">
				AND A.EXAM_APV_DOC_NO = #strDOC_NO#
			</isNotEmpty>
		</dynamic>
		 <![CDATA[   
		    AND	 	A.PRPS_YE = B.PRPS_YE(+)
		    AND 	A.PRPS_SLN = B.PRPS_SLN(+)
		]]>
	</select>
	
	<update id="CSPGSU007EApvSave" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPGSU001M
			SET		PRPS_STA_CD = 'L'		/*진행상태*/
			WHERE	EXAM_APV_DOC_NO = #APV_DOC_NO#
		]]>
	</update>
	
	<update id="CSPGSU007EApvRetSave" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPGSU001M
			SET		PRPS_STA_CD = 'J'		/*진행상태*/
			WHERE	EXAM_APV_DOC_NO = #APV_DOC_NO#
		]]>
	</update>
	
	<insert id="CSPGSU008EFileInsert" parameterClass="paramMap">
		<![CDATA[
			MERGE INTO TBCSPGSU004M T1
			USING (
					SELECT
					#PRPS_YE# AS PRPS_YE
					,#PRPS_SLN# AS PRPS_SLN
					,'2' AS PRPS_ATT_FL_DVSN_CD
					FROM DUAL
				) T2
			ON	(	
					T1.PRPS_YE = T2.PRPS_YE
					AND T1.PRPS_SLN = T2.PRPS_SLN
					AND T1.PRPS_ATT_FL_DVSN_CD = T2.PRPS_ATT_FL_DVSN_CD
				)
			WHEN MATCHED THEN
					UPDATE	
        			SET		DOC_ID = #EXAM_DOC_ID#
        	WHEN NOT MATCHED THEN
					INSERT (
								PRPS_YE				/*제안연도*/
								,PRPS_SLN			/*제안연번*/
								,PRPS_ATT_FL_DVSN_CD	/*제안천부파일구분코드*/
								,DOC_ID				/*첨부파일문서ID*/
								,DOC_TYP_CD			/*문서유형코드*/
								,FRT_USR_ID			/*최초사용자ID*/
								,FNL_USR_ID			/*최종사용자ID*/
								,FNL_DEAL_DPT_CD	/*최종거래부서코드*/
								,FNL_MNU_ID			/*최종메뉴ID*/
								,FRT_REGI_DH		/*최초등록일시*/
								,FNL_MDF_DH			/*최종수정일시*/
							)
						VALUES	(
									#PRPS_YE#			/*제안연도*/
									,#PRPS_SLN#			/*제안연번*/
									,'2'				/*제안천부파일구분코드*/
									,#EXAM_DOC_ID#			/*첨부파일문서ID*/
									,''					/*문서유형코드*/
									,DECODE(#FRT_USR_ID#,NULL,#FNL_USR_ID#,#FRT_USR_ID#)		/*최초사용자ID*/
									,#FNL_USR_ID#		/*최종사용자ID*/
									,#FNL_DEAL_DPT_CD#	/*최종거래부서코드*/
									,#FNL_MNU_ID#		/*최종메뉴ID*/
									,SYSDATE			/*최초등록일시*/
									,SYSDATE			/*최종수정일시*/
								)
		]]>
	</insert>
	
	<update id="CSPGSU007EExApvCancleUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPGSU001M
			SET		PRPS_STA_CD = 'H'		/*진행상태*/
					,FNL_MDF_DH = SYSDATE			/*최종수정일시*/
			WHERE	EXAM_APV_DOC_NO = #APV_DOC_NO#
		]]>
	</update>
	
	<delete id="CSPGSU007EApvDDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE	
			FROM	TBDCMACM023L
			WHERE	APV_DOC_NO = #EXAM_APV_DOC_NO#
		]]>
	</delete>
	
	<delete id="CSPGSU007EApvMDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE	
			FROM	TBDCMACM022L
			WHERE	APV_DOC_NO = #EXAM_APV_DOC_NO#
		]]>
	</delete>
	
	
	<select id="CSPGSU007EReportSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	DECODE(A.PRPS_ACP_NO,NULL,'',A.PRPS_YE||'-'||A.PRPS_ACP_NO) AS PRPS_ACP_NO	/*접수번호*/
					,A.PRPS_TIT_NM		/*제안제목*/
					,F_USR_INFO(A.PRPS_PEN_CNB,'2') AS PRPS_PEN_NAM	/*제안자명*/
					,TO_CHAR(TO_DATE(A.ACP_DT),'YYYY-MM-DD') AS ACP_DT
					,F_CODE_NM('1000075',A.PRPS_STA_CD) AS PRPS_STA_NM		/*제안상태코드*/
			FROM	TBCSPGSU001M A		/*도서자료기본*/
			WHERE	1=1
			AND		EXAM_DPT_CD = #strDPT_CD#
			
		]]>
		<dynamic>
			<isEmpty property="strPRPS_STA_CD">
				AND	A.PRPS_STA_CD &gt;= 'G' 
			</isEmpty>
			<isNotEmpty property="strPRPS_STA_CD">
				AND	A.PRPS_STA_CD = #strPRPS_STA_CD#
			</isNotEmpty>
			<isNotEmpty property="strACP_DTS">
				AND	A.ACP_DT &gt;= #strACP_DTS#
			</isNotEmpty>
			<isNotEmpty property="strACP_DTE">
				AND	A.ACP_DT &lt;= #strACP_DTE#
			</isNotEmpty>
			<isNotEmpty property="strPRPS_TIT_NM">
				AND	A.PRPS_TIT_NM LIKE '%'||#strPRPS_TIT_NM#||'%'
			</isNotEmpty>
		</dynamic> 
		<![CDATA[
			ORDER BY  TO_NUMBER(A.PRPS_YE) DESC , TO_NUMBER(A.PRPS_ACP_NO) DESC
		]]>
	</select>
	
	<select id="CSPGSU008EReportSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT	DECODE(A.PRPS_ACP_NO,NULL,'',A.PRPS_YE||'-'||A.PRPS_ACP_NO) AS PRPS_ACP_NO	/*접수번호*/
					,TO_CHAR(TO_DATE(A.ACP_DT),'YYYY-MM-DD') AS ACP_DT			/*접수일자*/
					,TO_CHAR(TO_DATE(A.SMT_DT),'YYYY-MM-DD') AS SMT_DT			/*제출일자*/
					,A.PRPS_TIT_NM		/*제안제목*/
					,F_USR_INFO(A.PRPS_PEN_CNB,'2')	AS PRPS_PEN_NAM /*제안자명*/
					,B.JNT_PRPS_PEN_NAM	/*공동제안자*/
					,F_CODE_NM('1000075',A.PRPS_STA_CD) AS PRPS_STA_NM	/*진행단계*/
					,A.CUR_SYE_TXT		/*현행제도내용*/
					,A.PRB_TXT			/*문제점내용*/
					,A.IMP_ATV_TXT		/*개선대안내용*/
					,A.IMP_EFCT_TXT		/*개선효과내용*/
					,F_DPT_INFO(A.EXAM_DPT_CD,'1') AS EXAM_DPT_NM		/*검토부서*/
					,A.EXAM_DT			/*검토일자*/
					,F_USR_INFO(A.EXAM_PEN_CNB,'2') AS EXAM_PEN_NAM		/*검토자*/
					,A.EXAM_TXT			/*검토의견*/
					,A.EXAM_RSLT_CD		/*검토결과*/
					,DECODE(A.PRPS_STA_CD,'N','Y','M','N','') AS PRPS_STA_YN	/*채택여부*/
					,TO_CHAR(TO_DATE(A.JDG_DT),'YYYY-MM-DD') AS JDG_DT			/*위원회일자*/
					,F_CODE_NM('1000076',A.RK_CD) AS RK_NM			/*제안등급*/
					,A.PRPS_ASC			/*제안평점*/
					,F_CODE_NM('1000286',A.CNTR_PRPS_RCMD_DVSN_CD) AS CNTR_PRPS_RCMD_DVSN_NM	/*중앙제안추천여부*/
			FROM	TBCSPGSU001M A /*도서자료기본*/
					, (	SELECT 	PRPS_YE, PRPS_SLN, AGGR_CONCAT(F_USR_INFO (A.PRPS_PEN_CNB,'2'),'/') AS JNT_PRPS_PEN_NAM 
						FROM 	TBCSPGSU002L A WHERE 1=1
					    AND 	A.PRPS_YE = #strPRPS_YE#
					    AND 	A.PRPS_SLN = #strPRPS_SLN#
					    AND		A.SNO <> 1
					    GROUP BY PRPS_YE, PRPS_SLN) B
			WHERE 	1=1
		    AND 	A.PRPS_YE = #strPRPS_YE#
		    AND 	A.PRPS_SLN = #strPRPS_SLN#
		    AND	 	A.PRPS_YE = B.PRPS_YE(+)
		    AND 	A.PRPS_SLN = B.PRPS_SLN(+)
		]]>
	</select>
	<select id="CSPGSU007ECnbSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[       
			SELECT  DECODE(A.PRPS_ACP_NO,NULL,'',A.PRPS_YE||'-'||A.PRPS_ACP_NO) AS PRPS_ACP_NO	/*접수번호*/ 
					,A.PRPS_TIT_NM		/*제안제목*/
					,A.PRPS_PEN_CNB 	/*제안자전산번호*/
					,A.EXAM_DPT_CD		/*검토부서코드*/
					,TO_CHAR(TO_DATE(A.EXEC_APT_DT,'YYYYMMDD'), 'YYYY-MM-DD') AS EXEC_APT_DT 	/*실시예정일*/
					,F_DPT_INFO(A.EXAM_DPT_CD,'1') AS EXAM_DPT_NM		/*검토부서명*/
					,F_CODE_NM('1000077',A.EXAM_RSLT_CD) AS EXAM_RSLT_NM		/*검토결과명*/
					,A.EXAM_RSLT_CD		/*검토결과코드*/
			  FROM TBCSPGSU001M A  
			 WHERE 1=1
			 ]]>
			<isNotEmpty property="APV_DOC_NO">
				AND	A.EXAM_APV_DOC_NO =  #APV_DOC_NO#
			</isNotEmpty>
			<isNotEmpty property="PRPS_YE">
				AND A.PRPS_YE = #PRPS_YE#
			</isNotEmpty>
			<isNotEmpty property="PRPS_SLN">
				AND 	A.PRPS_SLN= #PRPS_SLN#
			</isNotEmpty>
		
	</select>
	
	<insert id="CSPGSU007EMsgInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO
			TBDCMACM026L
			(
			  MSG_SNO
			, TSK_CAT_CD
			, FUNC_CAT_CD
			, SEND_ID
	        , MSG_TP_YN
	        , MSG_TXT_2
	        , RCNT_CNT
	        , RCNT_HIS
	        , MSG_REGI_DH
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			, FNL_MDF_DH
			)
			VALUES
			(
			  (SELECT NVL(MAX(MSG_SNO),0)+1 FROM TBDCMACM026L)
			, 'SP'
			, 'BO'
			, 'SYSTEM'
	        , '0'
	        , #MSG_TXT#
	        , 1
	        , #APL_CNB#
	        , SYSDATE
			, 'SYSTEM'
			, 'SYSTEM'
			, #FNL_DEAL_DPT_CD#
			, 'CSPGSU007E'
			, SYSDATE
			, SYSDATE
			);
			
		]]>
	</insert>
</sqlMap> 
