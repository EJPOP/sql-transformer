<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/cis/401">
	
	<select id="CSPCIS401PUsrInfoSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	USR_NAM, F_DPT_INFO(DPT_CD,'1') AS DPT_NM, EML_AD,DGUARD.DECRYPT('TB_ENC','EIN',EIN) AS EIN, AD, HOM_TNB
			FROM	TBDCMACM001M
			WHERE	USR_ID = #strUSR_ID#
		]]>
	</select>
	
	<resultMap class="java.util.HashMap" id="CSPCIS401PMainSelect">
			<result property="STTM_DVSN_CD" 			 column="STTM_DVSN_CD" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="ACP_YR" 						 column="ACP_YR" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="STTM_ACP_NO" 			 column="STTM_ACP_NO" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="HMP_APL_NO" 				 column="HMP_APL_NO" 				     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="STTM_KND_CD" 			 column="STTM_KND_CD" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="STTM_KND_DTL_CD" 	 column="STTM_KND_DTL_CD" 	     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="STTM_KND_DTL_NM" 	 column="STTM_KND_DTL_NM" 	     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="NAM" 							 column="NAM" 							     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="EIN" 							 column="EIN" 							     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="JB_NM" 						 column="JB_NM" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="AD" 								 column="AD" 								     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="TNB" 							 column="TNB" 							     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="EML_AD" 						 column="EML_AD" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="TIT_NM" 						 column="TIT_NM" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="DOC_ID" 						 column="DOC_ID" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="STTM_EXCU_TXT" 		 column="STTM_EXCU_TXT" 		     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="STTM_TXT_DH" 			 column="STTM_TXT_DH" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="STTM_PLC_NM" 			 column="STTM_PLC_NM" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="STTM_TXT" 					 column="STTM_TXT" 					     jdbcType="CLOB" javaType="java.lang.String" />
			<result property="RTRN_WAY_TXT" 			 column="RTRN_WAY_TXT" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="RMK_TXT" 					 column="RMK_TXT" 					     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="OTR_ORG_NM" 				 column="OTR_ORG_NM" 				     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="INSPC_AGR_YN" 			 column="INSPC_AGR_YN" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="OTR_INSPC_AGR_YN" 	 column="OTR_INSPC_AGR_YN" 	     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="ACP_DH" 						 column="ACP_DH" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="ACP_RUT_CD" 				 column="ACP_RUT_CD" 				     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="HNDL_STA_CD" 			 column="HNDL_STA_CD" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="HNDL_STA_NM" 			 column="HNDL_STA_NM" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="HNDL_DH" 					 column="HNDL_DH" 					     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="ANS_TXT" 					 column="ANS_TXT" 					     jdbcType="CLOB" javaType="java.lang.String" />
			<result property="FRT_REGI_DH" 			 column="FRT_REGI_DH" 			     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="RES_NAM" 					 column="RES_NAM" 					     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="RES_TNB" 					 column="RES_TNB" 					     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="RES_JB_NM" 				 column="RES_JB_NM" 				     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="RES_AD" 						 column="RES_AD" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="CRP_NM" 						 column="CRP_NM" 						     jdbcType="VARCHAR2" javaType="java.lang.String" />
			<result property="FRT_USR_ID" 				 column="FRT_USR_ID" 				     jdbcType="VARCHAR2" javaType="java.lang.String" />
	</resultMap>
	
	<select id="CSPCIS401PMainSelect" parameterClass="paramMap" resultMap="CSPCIS401PMainSelect">
		<![CDATA[
			SELECT	T1.STTM_DVSN_CD
					,T1.ACP_YR
					,T1.STTM_ACP_NO
					,T1.HMP_APL_NO
					,T1.STTM_KND_CD
					,T1.STTM_KND_DTL_CD
					,F_CODE_NM('1000759',T1.STTM_KND_DTL_CD) AS STTM_KND_DTL_NM
					,T1.NAM
					,DGUARD.DECRYPT('TB_ENC','EIN',T1.EIN) AS EIN
					,T1.JB_NM
					,T1.AD
					,T1.TNB
					,T1.EML_AD
					,T1.TIT_NM
					,T1.DOC_ID
					,T1.STTM_EXCU_TXT
					,T1.STTM_TXT_DH
					,T1.STTM_PLC_NM
					,T1.STTM_TXT
					,T1.RTRN_WAY_TXT
					,T1.RMK_TXT
					,T1.OTR_ORG_NM
					,T1.INSPC_AGR_YN
					,T1.OTR_INSPC_AGR_YN
					,T1.ACP_DH
					,T1.ACP_RUT_CD
					,T1.HNDL_STA_CD
					,F_CODE_NM('1000760',T1.HNDL_STA_CD) AS HNDL_STA_NM
					,T1.HNDL_DH
					,T1.ANS_TXT
					,T1.FRT_REGI_DH
					,T2.RES_NAM
					,T2.RES_TNB
					,T2.RES_JB_NM
					,T2.RES_AD
					,T2.CRP_NM
					,T1.FRT_USR_ID
			FROM	TBCSPDCP811M T1
					,TBCSPDCP812M T2
			WHERE	T1.STTM_DVSN_CD = T2.STTM_DVSN_CD(+)
			AND		T1.ACP_YR = T2.ACP_YR(+)
			AND		T1.STTM_ACP_NO = T2.STTM_ACP_NO(+)
			AND		T1.STTM_DVSN_CD = '2'
			AND		T1.FRT_USR_ID = #strUSR_ID#
		]]>
	</select>
	
	<insert id="CSPCIS401PInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP811M
					(	STTM_DVSN_CD
						,ACP_YR
						,STTM_ACP_NO
						,HMP_APL_NO
						,STTM_KND_CD
						,STTM_KND_DTL_CD
						,NAM
						,EIN
						,JB_NM
						,AD
						,TNB
						,EML_AD
						,TIT_NM
						,DOC_ID
						,STTM_EXCU_TXT
						,STTM_TXT_DH
						,STTM_PLC_NM
						,STTM_TXT
						,RTRN_WAY_TXT
						,RMK_TXT
						,OTR_ORG_NM
						,INSPC_AGR_YN
						,OTR_INSPC_AGR_YN
						,ACP_RUT_CD
						,HNDL_STA_CD
						,FRT_REGN_IP
						,FRT_USR_ID
						,FNL_USR_ID
						,FNL_DEAL_DPT_CD
						,FNL_MNU_ID
						,FRT_REGI_DH
						,FNL_MDF_DH
					)
				VALUES	(	#STTM_DVSN_CD#
							,#ACP_YR#
							,#STTM_ACP_NO#
							,#HMP_APL_NO#
							,#STTM_KND_CD#
							,#STTM_KND_DTL_CD#
							,#NAM#
							,DGUARD.ENCRYPT('TB_ENC','EIN',#EIN#)
							,#JB_NM#
							,#AD#
							,#TNB#
							,#EML_AD#
							,#TIT_NM#
							,#DOC_ID#
							,#STTM_EXCU_TXT#
							,#STTM_TXT_DH#
							,#STTM_PLC_NM#
							,#STTM_TXT#
							,#RTRN_WAY_TXT#
							,#RMK_TXT#
							,#OTR_ORG_NM#
							,#INSPC_AGR_YN#
							,#OTR_INSPC_AGR_YN#
							,'9'	/*접수경로*/
							,'1'  
							,#FRT_REGN_IP#
							,#FRT_USR_ID#
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
				
		]]>
	</insert>
	
	<insert id="CSPCIS401PSubInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP812M
					(	STTM_DVSN_CD
						,ACP_YR
						,STTM_ACP_NO
						,SRNO
						,RES_NAM
						,RES_TNB
						,RES_JB_NM
						,RES_AD
						,CRP_NM
						,FRT_USR_ID
						,FNL_USR_ID
						,FNL_DEAL_DPT_CD
						,FNL_MNU_ID
						,FRT_REGI_DH
						,FNL_MDF_DH
					)
				VALUES	(	#STTM_DVSN_CD#
							,#ACP_YR#
							,#STTM_ACP_NO#
							,1
							,#RES_NAM#
							,#RES_TNB#
							,#RES_JB_NM#
							,#RES_AD#
							,#CRP_NM#
							,#FRT_USR_ID#
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>
	
	<select id="CSPDCP811MKeySelect" parameterClass="paramMap" resultClass="String">
		<![CDATA[
			SELECT	NVL(MAX(STTM_ACP_NO),0)+1 AS STTM_ACP_NO
			FROM	TBCSPDCP811M
			WHERE	STTM_DVSN_CD = #STTM_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
		]]>
	</select>
	
	<update id="CSPCIS401PUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP811M
			SET		STTM_KND_CD = #STTM_KND_CD#
					,STTM_KND_DTL_CD = #STTM_KND_DTL_CD#
					,NAM = #NAM#
					,EIN = DGUARD.ENCRYPT('TB_ENC','EIN',#EIN#)
					,JB_NM = #JB_NM#
					,AD = #AD#
					,TNB = #TNB#
					,EML_AD = #EML_AD#
					,TIT_NM = #TIT_NM#
					,DOC_ID = #DOC_ID#
					,STTM_EXCU_TXT = #STTM_EXCU_TXT#
					,STTM_TXT_DH = #STTM_TXT_DH#
					,STTM_PLC_NM = #STTM_PLC_NM#
					,STTM_TXT = #STTM_TXT#
					,RTRN_WAY_TXT = #RTRN_WAY_TXT#
					,RMK_TXT = #RMK_TXT#
					,OTR_ORG_NM = #OTR_ORG_NM#
					,INSPC_AGR_YN = #INSPC_AGR_YN#
					,OTR_INSPC_AGR_YN = #OTR_INSPC_AGR_YN#
					,FNL_USR_ID = #FNL_USR_ID#
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
					,FNL_MNU_ID = #FNL_MNU_ID#
					,FNL_MDF_DH = SYSDATE
			WHERE	STTM_DVSN_CD = #STTM_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		STTM_ACP_NO = #STTM_ACP_NO#
		]]>
	</update>
	
	<update id="CSPCIS401PSubUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP812M
			SET		RES_NAM = #RES_NAM#
					,RES_TNB = #RES_TNB#
					,RES_JB_NM = #RES_JB_NM#
					,RES_AD = #RES_AD#
					,CRP_NM = #CRP_NM#
					,FNL_USR_ID = #FNL_USR_ID#
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
					,FNL_MNU_ID = #FNL_MNU_ID#
					,FNL_MDF_DH = SYSDATE
			WHERE	STTM_DVSN_CD = #STTM_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		STTM_ACP_NO = #STTM_ACP_NO#
		]]>
	</update>
	
	<delete id="CSPCIS401PSubDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPDCP812M
			WHERE	STTM_DVSN_CD = #STTM_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		STTM_ACP_NO = #STTM_ACP_NO#
		]]>
	</delete>
	
	<delete id="CSPCIS401PDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPDCP811M
			WHERE	STTM_DVSN_CD = #STTM_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		STTM_ACP_NO = #STTM_ACP_NO#
		]]>
	</delete>
</sqlMap> 
