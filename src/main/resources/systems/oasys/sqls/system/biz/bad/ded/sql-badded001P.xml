<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="bad/ded/001P">
	
	<select id="BADDED001EPDeptselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			select DEPT_CD, DEPT_NM
			  from ebaiusr.CM_DEPT
			 where 1=1
         AND DEPT_CD like '%00'
			   and USE_YN = 'Y'
			 order by DEPT_CD 
        ]]>
	</select>        

	<select id="BADDED001EPSubDeptselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			select DEPT_CD, DEPT_NM
			  from ebaiusr.CM_DEPT
			 where 1=1
         AND DEPT_CD NOT like '%00'
			   and USE_YN = 'Y'
			 order by DEPT_CD 
        ]]>
	</select>       


	<!--감사사항관리 조회-->
	<select id="BADDED001EPMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[       
               SELECT D1.AUD_YEAR                  AS AUD_YEAR				/*감사년도*/
			     , D1.AUD_SNO                   AS AUD_SNO				/*감사연번*/
			     , D1.AUD_YEAR||'-'||D1.STRTG_GOAL_CD||'-'||D1.AUD_REP_ORG_CD||'-'||D1.AUD_TYPE_CD
			     ||'-'||D1.EXEC_DEPT_CD||'-'||D1.AUD_METHOD_CD||'-'||D1.AUD_SNO AS AUD_SNO_DETAIL
			     , D1.AUD_YEAR ||'-'||D1.AUD_SNO   AS AUD_YEAR_SNO		/*감사연번*/
			    
                ,(SELECT NM_KOR
                    FROM COM030TL
                   WHERE CODE_DIV='AA07'
                    AND CODE =D1.AUD_TYPE_CD  ) AS  AUD_TYPE_NM	/*감사종류코드명*/			
			    , D1.AUD_TYPE_CD AS AUD_TYPE_CD                         /*감사종류코드*/	
                , D1.AUD_ITEM_NM               AS AUD_ITEM_NM       	/*감사사항명*/
                
			     , (SELECT NM_KOR
                       FROM COM030TL
                       WHERE CODE_DIV='DEPT02'
                     AND CODE =D1.EXEC_DEPT_CD )             AS EXEC_DEPT_NM		/*주관국과명*/
                 ,   D1.EXEC_DEPT_CD AS EXEC_DEPT_CD                    /*주관국과코드*/
			     , D1.SDATE                     AS SDATE				/*감사시작일*/
			     , D1.EDATE                     AS EDATE 				/*감사종료일*/
			     , D1.MGR_DEPT_CD               AS MGR_DEPT_CD			/*관리부서*/
			     , D1.AUD_SCL_CD                AS AUD_SCL_CD			/*감사규모코드*/
                 
			     , D1.TASK_CATE_CD         AS TASK_CATE_CD			/*업무분류222*/
                 
			     , (SELECT NM_KOR
                    FROM COM030TL
                     WHERE CODE_DIV='CM01'
                     AND CODE =D1.AUD_REP_ORG_CD )           AS AUD_REP_ORG_NM		/*대표기관코드명*/
                 , D1.AUD_REP_ORG_CD            AS AUD_REP_ORG_CD       /*대표기관코드*/
			     , D1.ORG_TYPE_CD               AS ORG_TYPE_CD			/*기관구분코드*/	
			     , D1.AUD_METHOD_CD             AS AUD_METHOD_CD		/*감사방법코드*/
			     , D1.STRTG_GOAL_CD             AS STRTG_GOAL_CD		/*감사과제코드*/
			     , D1.EMPHS_SJT_CD              AS EMPHS_SJT_CD			/*중점과제코드*/
			     , D1.AUD_LEADER_EMPLNUM        AS AUD_LEADER_EMPLNUM	/*감사반장전산번호*/
			     , D1.AUD_LEADER_DEPT_CD        AS AUD_LEADER_DEPT_CD   /*감사반장부서번호*/     	
			     , D1.AUD_LEADER_POS_CLASS      AS AUD_LEADER_POS_CLASS		/*감사반장직급코드*/
			     , D1.MANAGER_EMPLNUM           AS MANAGER_EMPLNUM		/*감사주관자전산번호*/
			     , D1.MANAGER_DEPT_CD           AS MANAGER_DEPT_CD		/*감사주관자부서코드*/
			     , D1.MANAGER_POS_CLASS_CD      AS MANAGER_POS_CLASS_CD	/*감사주관자직급코드*/
			     , D1.ASSIST_EMPLNUM            AS ASSIST_EMPLNUM		/*감사보조자전산번호*/		
			     , D1.ASSIST_POS_CLASS_CD       AS ASSIST_POS_CLASS_CD	/*감사보조자직급코드*/
			     , D1.ASSIST_DEPT_CD            AS ASSIST_DEPT_CD		/*감사보조자부서코드*/

			  FROM TBBADDED001M D1
			 WHERE 1=1
			   AND DEL_YN IS NULL
		]]>
		<isNotEmpty property="strAudYear">	 
			   AND D1.AUD_YEAR     = #strAudYear#
		</isNotEmpty>
		<isNotEmpty property="strAudSno">	 	
			   AND D1.AUD_SNO      = #strAudSno#
		</isNotEmpty>
		<isNotEmpty property="strAudItemNm">	 	   
			   AND D1.AUD_ITEM_NM LIKE '%'||#strAudItemNm#||'%'
		</isNotEmpty>
		<isNotEmpty property="strAudStep">	 
			   AND D1.AUD_STEP     = #strAudStep#
		</isNotEmpty>
		<isNotEmpty property="strAudTypeCd">	 
			   AND D1.AUD_TYPE_CD  = #strAudTypeCd#
		</isNotEmpty>
		<isNotEmpty property="strExecDeptCd">	 
			   AND D1.EXEC_DEPT_CD = #strExecDeptCd#
		</isNotEmpty>   
		<isNotEmpty property="strAudFg">	 
			   AND D1.AUD_FG = #strAudFg#
		</isNotEmpty>     
        <![CDATA[       
			  ORDER BY D1.AUD_SNO
        ]]>
	</select>
	
	<!--감사사항관리 insert-->
	<insert id="BADDED001EPMainInsert" parameterClass="paramMap">
		INSERT INTO TBBADDED001M
		 (
		     AUD_YEAR 
		   , AUD_SNO 
		   , AUD_TYPE_CD 
		   , AUD_ITEM_NM 
		   , EXEC_DEPT_CD 
		   , SDATE 
		   , EDATE 
		   , MGR_DEPT_CD 
		   , AUD_SCL_CD 
		   , TASK_CATE_CD 
		   , AUD_REP_ORG_CD 
		   , ORG_TYPE_CD
		   , AUD_METHOD_CD
		   , STRTG_GOAL_CD 
		   , EMPHS_SJT_CD 
		   , AUD_LEADER_EMPLNUM 
		   , AUD_LEADER_DEPT_CD 
		   , AUD_LEADER_POS_CLASS
		   , MANAGER_EMPLNUM 
		   , MANAGER_DEPT_CD 
		   , MANAGER_POS_CLASS_CD
		   , ASSIST_EMPLNUM 
		   , ASSIST_POS_CLASS_CD 
		   , ASSIST_DEPT_CD 
		   , AUD_STEP
		   , DEL_YN 
		   , AUD_FG
		   , AUD_REQ_NO
		   , AUD_REQ_NM
		   , AUD_REQ_ORG
		   , FIRST_USERID
		   , FINAL_USERID 
		   , FINAL_TRANS_ORG_CD
		   , FIRST_RDTIME  
		 ) VALUES
		 (
		     #AUD_YEAR# 
		   , #AUD_SNO#
		   , #AUD_TYPE_CD#
		   , #AUD_ITEM_NM# 
		   , #EXEC_DEPT_CD# 
		   , #SDATE# 
		   , #EDATE# 
		   , #MGR_DEPT_CD# 
		   , #AUD_SCL_CD# 
		   , #TASK_CATE_CD# 
		   , #AUD_REP_ORG_CD# 
		   , #ORG_TYPE_CD#
		   , #AUD_METHOD_CD#
		   , #STRTG_GOAL_CD# 
		   , #EMPHS_SJT_CD# 
		   , #AUD_LEADER_EMPLNUM#
		   , #AUD_LEADER_DEPT_CD#
		   , #AUD_LEADER_POS_CLASS#
		   , #MANAGER_EMPLNUM# 
		   , #MANAGER_DEPT_CD# 
		   , #MANAGER_POS_CLASS_CD#
		   , #ASSIST_EMPLNUM# 
		   , #ASSIST_POS_CLASS_CD# 
		   , #ASSIST_DEPT_CD# 
		   , #AUD_STEP#
		   , #DEL_YN# 
		   , #AUD_FG# 
		   , #AUD_REQ_NO# 
		   , #AUD_REQ_NM#
		   , #AUD_REQ_ORG# 
		   , #FIRST_USERID#
		   , #FINAL_USERID# 
		   , #FINAL_TRANS_ORG_CD#
		   , #FIRST_RDTIME#
		 ) 
	</insert>
	
	<!--감사사항관리 update-->
	<update id="BADDED001EPMainUpdate" parameterClass="paramMap">
		<![CDATA[ 	
			UPDATE TBBADDED001M
			   SET AUD_YEAR               = #AUD_YEAR# 
			     , AUD_SNO                = #AUD_SNO# 		
			   
		]]>	    
		<isNotNull prepend="," property="AUD_TYPE_CD">
			   	   AUD_TYPE_CD            = #AUD_TYPE_CD#
		</isNotNull>
		<isNotNull prepend="," property="AUD_ITEM_NM">	       
			       AUD_ITEM_NM            = #AUD_ITEM_NM#
		</isNotNull>
		<isNotNull prepend="," property="EXEC_DEPT_CD">	       
			       EXEC_DEPT_CD           = #EXEC_DEPT_CD#
		</isNotNull>			       
		<isNotNull prepend="," property="SDATE">	       
			       SDATE                  = #SDATE#
		</isNotNull>				       
		<isNotNull prepend="," property="EDATE">	       
			       EDATE                  = #EDATE#             
		</isNotNull>	       
		<isNotNull prepend="," property="MGR_DEPT_CD">	       
			       MGR_DEPT_CD            = #MGR_DEPT_CD#            
		</isNotNull>		
		<isNotNull prepend="," property="AUD_SCL_CD">	       
			       AUD_SCL_CD             = #AUD_SCL_CD#       
		</isNotNull>		
		<isNotNull prepend="," property="TASK_CATE_CD">	       
			       TASK_CATE_CD           = #TASK_CATE_CD#     
		</isNotNull>			
		<isNotNull prepend="," property="AUD_REP_ORG_CD">	       
			       AUD_REP_ORG_CD         = #AUD_REP_ORG_CD#
		</isNotNull>			
		<isNotNull prepend="," property="ORG_TYPE_CD">	       
			       ORG_TYPE_CD            = #ORG_TYPE_CD#
		</isNotNull>			
		<isNotNull prepend="," property="AUD_METHOD_CD">	       
			        AUD_METHOD_CD          = #AUD_METHOD_CD#
		</isNotNull>			
		<isNotNull prepend="," property="STRTG_GOAL_CD">	       
			        STRTG_GOAL_CD          = #STRTG_GOAL_CD#
		</isNotNull>			
		<isNotNull prepend="," property="EMPHS_SJT_CD">	       
			        EMPHS_SJT_CD           = #EMPHS_SJT_CD#
		</isNotNull>				
		<isNotNull prepend="," property="AUD_LEADER_EMPLNUM">	       
			         AUD_LEADER_EMPLNUM     = #AUD_LEADER_EMPLNUM#
		</isNotNull>				
		<isNotNull prepend="," property="AUD_LEADER_DEPT_CD">	       
			        AUD_LEADER_DEPT_CD     = #AUD_LEADER_DEPT_CD#    
		</isNotNull>			
		<isNotNull prepend="," property="AUD_LEADER_POS_CLASS">	       
			        AUD_LEADER_POS_CLASS   = #AUD_LEADER_POS_CLASS#      
		</isNotNull>		
		<isNotNull prepend="," property="MANAGER_EMPLNUM">	       
			        MANAGER_EMPLNUM        = #MANAGER_EMPLNUM#
		</isNotNull>		
		<isNotNull prepend="," property="MANAGER_DEPT_CD">	       
			       MANAGER_DEPT_CD        = #MANAGER_DEPT_CD#
		</isNotNull>	
		<isNotNull prepend="," property="MANAGER_POS_CLASS_CD">	       
			       MANAGER_POS_CLASS_CD   = #MANAGER_POS_CLASS_CD#
		</isNotNull>	
		<isNotNull prepend="," property="ASSIST_EMPLNUM">	       
			       ASSIST_EMPLNUM         = #ASSIST_EMPLNUM#
		</isNotNull>	
		<isNotNull prepend="," property="ASSIST_POS_CLASS_CD">	       
			      ASSIST_POS_CLASS_CD    = #ASSIST_POS_CLASS_CD#
		</isNotNull>	
		<isNotNull prepend="," property="ASSIST_DEPT_CD">	       
			      ASSIST_DEPT_CD         = #ASSIST_DEPT_CD#
		</isNotNull>		
		<isNotNull prepend="," property="AUD_STEP">	       
			     AUD_STEP               = #AUD_STEP#
		</isNotNull>		
		<isNotNull prepend="," property="DEL_YN">	       
			     DEL_YN                 = #DEL_YN#
		</isNotNull>			
		<isNotNull prepend="," property="FINAL_USERID">	       
			     FINAL_USERID           = #FINAL_USERID#
		</isNotNull>		
		<isNotNull prepend="," property="FINAL_TRANS_ORG_CD">	       
			     FINAL_TRANS_ORG_CD     = #FINAL_TRANS_ORG_CD# 
		</isNotNull>						
		<isNotNull prepend="," property="AUD_FG">	       
			     AUD_FG     = #AUD_FG# 
		</isNotNull>							
		<isNotNull prepend="," property="AUD_REQ_NO">	       
			     AUD_REQ_NO     = #AUD_REQ_NO# 
		</isNotNull>						
		<isNotNull prepend="," property="AUD_REQ_NM">	       
			     AUD_REQ_NM     = #AUD_REQ_NM# 
		</isNotNull>						
		<isNotNull prepend="," property="AUD_REQ_ORG">	       
			     AUD_REQ_ORG     = #AUD_REQ_ORG# 
		</isNotNull>		
			  WHERE 1=1
			    AND AUD_YEAR               = #AUD_YEAR# 
			    AND AUD_SNO                = #AUD_SNO# 		    
	</update>
	
	<!--감사사항관리 delete-->
	<update id="BADDED001EPMainDelete" parameterClass="paramMap">
			DELETE 
			FROM 	TBBADDED001M
			WHERE 1=1
			AND AUD_YEAR               = #AUD_YEAR# 
			AND AUD_SNO                = #AUD_SNO# 
	</update>
	
	<!-- 연번 Max값 찾기 -->
	<select id="BADDED001EPMainMaxSnoSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[     	
			    SELECT LPAD(NVL(MAX(TO_NUMBER(AUD_SNO)),0)+1,3,0) AS MAX_SEQ
				  FROM TBBADDED001M
				 WHERE 1=1
				   AND AUD_YEAR               = #AUD_YEAR# 
		]]>
	</select>
	
</sqlMap> 
