<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="bad/ear/019">


	<select id="BADEAR019Qselect1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			/*쿼리명 : SQL_Sum*/
		select sum(A1 + B1 + C1 + D1 + D4 + E1 + E2 + F1 + G1 + H1 + I1 + J1 + K1 + L1 + M1 + N1) as SUM1,  /*합계 건수*/
		       sum(A2 + C2 + D2 + D5 + J2 + N2)                                                   as SUM2,  /*합계 금액(상)*/
		       sum(B2 + K2 + L2 + M2)           		                                          as SUM3,  /*합계 인원*/
		       sum(A3 + C3 + D3 + D6 + J3 + N3)                                                   as SUM4   /*합계 금액(하)*/
		  from (
		        select case when SUBSTR(KIKGU, 1, 1) = '1' then '1'                                                                                    
		                    when SUBSTR(KIKGU, 1, 1) = '2' then '2'                                                                                    
		                    when SUBSTR(KIKGU, 1, 1) = '3' then '3'                                                                                    
		               else '4' 
		               end as KIKW,                                                                 
		               sum(case when CHBCD = '110' then NVL(GUNSU,0)                                                                                        
		                   else 0 end)                                                as A1,                                                                   
		               sum(case when CHBCD = '110' then NVL(AM1,0)                                                                                         
		                   else 0 end)                                                as A2,                                                                   
		               sum(case when CHBCD = '110' then NVL(AM2,0) + NVL(AM3,0)                                                                        
		                   else 0 end)                                                as A3,                                                                   
		               sum(case when CHBCD = '210' then NVL(GUNSU,0)                                                                                        
		                   else 0 end)                                                as B1,                                                                   
		               sum(case when CHBCD = '210' then NVL(MAN,0)                                                                                          
		                   else 0 end)                                                as B2,                                                                   
		               sum(     case when CHBCD = '310' then NVL(GUNSU,0)                                                                                   
		                   else case when CHBCD = '320' then NVL(GUNSU,0)                                                                                   
		                   else 0 end end)                                            as C1,                                                                   
		               sum(     case when CHBCD = '310' then NVL(AM1,0)                                                                                    
		                   else case when CHBCD = '320' then NVL(AM1,0)                                                                                    
		                   else 0 end end)                                            as C2,                                                                   
		               sum(     case when CHBCD = '310' then NVL(AM2,0) + NVL(AM3,0)                                                                   
		                   else case when CHBCD = '320' then NVL(AM2,0) + NVL(AM3,0)                                                                   
		                   else 0 end end)                                            as C3,                                                                   
		               sum(     case when CHBCD = '390' then NVL(GUNSU,0)                                                                                   
		                   else case when CHBCD = '391' then NVL(GUNSU,0)                                                                                   
		                   else 0 end end)                                            as D1,                                                                   
		               sum(     case when CHBCD = '390' then NVL(AM1,0)                                                                                    
		                   else case when CHBCD = '391' then NVL(AM1,0)                                                                                    
		                   else 0 end end)                                            as D2,                                                                   
		               sum(     case when CHBCD = '390' then NVL(AM2,0) + NVL(AM3,0)                                                                   
		                   else case when CHBCD = '391' then NVL(AM2,0) + NVL(AM3,0)                                                                   
		                   else 0 end end)                                            as D3,
		               sum(     case when CHBCD = '395' then NVL(GUNSU,0)                                                                                   
		                   else case when CHBCD = '396' then NVL(GUNSU,0)                                                                                   
		                   else 0 end end)                                            as D4,                                                                   
		               sum(     case when CHBCD = '395' then NVL(AM1,0)                                                                                    
		                   else case when CHBCD = '396' then NVL(AM1,0)                                                                                    
		                   else 0 end end)                                            as D5,                                                                   
		               sum(     case when CHBCD = '395' then NVL(AM2,0) + NVL(AM3,0)                                                                   
		                   else case when CHBCD = '396' then NVL(AM2,0) + NVL(AM3,0)                                                                   
		                   else 0 end end)                                            as D6,                                                                       
		               sum(     case when CHBCD = '410' then NVL(GUNSU,0)                                                                                   
		                   else case when CHBCD = '490' then NVL(GUNSU,0)                                                                                   
		                   else 0 end end)                                            as E1,
		               sum(case when CHBCD = '495' then NVL(GUNSU,0)                                                                                   
		                   else 0 end)                                                as E2,                                                                       
		               sum(case when CHBCD = '510' then NVL(GUNSU,0)                                                                                        
		                   else 0 end)                                                as F1,                                                                   
		               sum(case when CHBCD = '520' then NVL(GUNSU,0)                                                                                        
		                   else 0 end)                                                as G1,                                                                   
		               sum(case when CHBCD = '530' then NVL(GUNSU,0)                                                                                        
		                   else 0 end)                                                as H1,                                                                   
		               sum(case when CHBCD = '611' then NVL(GUNSU,0)                                                                                        
		                   else 0 end)                                                as I1,  
		                   
		                   
		               sum(case when CHBCD in ('610', '630') then NVL(GUNSU,0)                                                                                        
		                        else 0 end)                                               as J1, /* 통보 */
		               sum(case when CHBCD in ('610', '630') then NVL(AM1,0)                                                                                                                                                                     
                                else 0 end)                                                as J2,                                   
                       sum(case when CHBCD in ('610', '630') then NVL(AM2,0) + NVL(AM3,0)                                                                                                                                                                     
                                else 0 end)                                                as J3,
		               sum(case when CHBCD = '623' then NVL(GUNSU,0)                                                                                                                                                                     
		                        else 0 end)                                               as K1, /* 통보(비위) - 623 */                                                                   
		               sum(case when CHBCD = '623' then NVL(MAN,0)                                                                                                                                                                        
		                        else 0 end)                                               as K2,                                                                   
		               sum(case when CHBCD in ('620', '621')  then NVL(GUNSU,0)                                                                                                                                                                    
		                        else 0 end)                                               as L1,  /* 통보(인사) - 620 */                                                                  
		               sum(case when CHBCD in ('620', '621')  then NVL(MAN,0)                                                                                                                                                                         
		                        else 0 end)                                               as L2,
		               sum(case when CHBCD IN ('710', '720', '730')  then NVL(GUNSU,0)                                                                                                                                                                
		                        else 0 end)                                                as M1,   /* 고발 - 710,720,730 */                                                              
		               sum(case when CHBCD IN ('710', '720', '730')  then NVL(MAN,0)                                                                                                                                                                       
		                        else 0 end)                                                as M2,    

                       sum(case when CHBCD = '625' then NVL(GUNSU,0)                                                                                                                                                                     
                                else 0 end)                                                as N1, /* 통보(시정완료):625 추가 - 2017.01.20 yyh*/                                                                   
                       sum(case when CHBCD = '625' then NVL(AM1,0)                                                                                                                                                                     
                                else 0 end)                                                as N2,                                   
                       sum(case when CHBCD = '625' then NVL(AM2,0) + NVL(AM3,0)                                                                                                                                                                     
                                else 0 end)                                                as N3  
                                		                   
/*		                                                                                    
		               sum(case when CHBCD = '610' then NVL(GUNSU,0)                                                                                        
		                   else 0 end)                                                as J1,                                                                   
		               sum(     case when CHBCD = '620' then NVL(GUNSU,0)                                                                                   
		                   else case when CHBCD = '621' then NVL(GUNSU,0)                                                                                   
		                   else 0 end end)                                            as K1,                                                                   
		               sum(     case when CHBCD = '620' then NVL(MAN,0)                                                                                     
		                   else case when CHBCD = '621' then NVL(MAN,0)                                                                                     
		                   else 0 end end)                                            as K2,                                                                   
		               sum(     case when CHBCD = '710' then NVL(GUNSU,0)                                                                                   
		                   else case when CHBCD = '720' then NVL(GUNSU,0)                                                                                   
		                   else case when CHBCD = '730' then NVL(GUNSU,0)                                                                                   
		                   else 0 end end end)                                        as L1,                                                                   
		               sum(     case when CHBCD = '710' then NVL(MAN,0)                                                                                     
		                   else case when CHBCD = '720' then NVL(MAN,0)                                                                                     
		                   else case when CHBCD = '730' then NVL(MAN,0)                                                                                     
		                   else 0 end end end)                                        as L2,
		               sum(     case when CHBCD = '623' then NVL(GUNSU,0)                                                                                                                                                                
		                   else 0 end)                                                as M1,                                                                   
		               sum(     case when CHBCD = '623' then NVL(MAN,0)                                                                                                                                                                       
		                   else 0 end)                                                as M2
*/		                   
		                   
		                                                                                       
		          from (select YYMM,                                                                                                                           
		                       KIKGU,                                                                                                                          
		                       SOKIK,                                                                                                                          
		                       (case when CHB_CD < '930' and CHB_CD not in('390','391','395','396','800','810','820','830','840','850')             then CHB_CD                                      
		                             when CHB_CD < '800' and CHB_CD in ('390','391') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0  then '390'
		                             when CHB_CD < '800' and CHB_CD in ('395','396') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0  then '395'                                       
		                             when CHB_CD < '800' and CHB_CD in ('390','391') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0  then '391'
		                             when CHB_CD < '800' and CHB_CD in ('395','396') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0  then '396'                                       
		                        end)  AS CHBCD,                                                                                                          
		                       sum(case when CHB_CD in('110','310','320','390','391','395','396','410','490','495')                                                              
		                                  or CHB_CD in('320','410','490','495','510','520','530','610','611','630','910','911','912','913','914','915','916','625')  then 0
		                           else CHB_SU end) AS MAN,                                                                                                     
		                       sum(case when CHB_CD in('210','620','621', '623','710','720','730', '800','810','820','830','840','850')                               
		                                  or CHB_CD in('410','490','495','510','520','530', '611','910','911','912','913','914','915','916') then 0
		                           else CAM1  end)  AS AM1,                                                                                                    
		                       sum(case when CHB_CD in('210','620','621', '623','710','720','730', '800','810','820','830','840','850')                               
		                                  or CHB_CD in('320','410','490','495','510','520','530', '611','910','911','912','913','914','915','916') then 0
		                           else CAM2  end)  AS AM2,                                                                                                    
		                       sum(case when CHB_CD in('210','620','621', '623','710','720','730', '800','810','820','830','840','850')                               
		                                  or CHB_CD in('320','410','490','495','510','520','530', '611','910','911','912','913','914','915','916') then 0
		                           else CAM3  end)  AS AM3,                                                                                                    
		                       
		                    
		                       (NVL(sum(case when CHB_CD < '930'                                                                                          
		                                     and CHB_CD not in('390','391','395','396','800','810','820','830','840','850') then 1 end), 0)  +                        
		                        NVL(sum(case when CHB_CD < '800'                                                                                          
		                                     and CHB_CD in ('390','391','395','396')                                                                                 
		                                     and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0 then 1 end),0) +                               
		                        NVL(sum(case when CHB_CD < '800'                                                                                          
		                                     and CHB_CD in ('390','391','395','396')                                                                                 
		                                     and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 then 1 end),0)) AS GUNSU 
		
		                  from (select SUBSTR(detail.ENF_DT, 1, 6)        as YYMM  ,                                                                         
		                               master.ORG_DVSN_CD                 as KIKGU ,
		                               (select MAX(RLTN_ORG_CD) 
		                                 from TBBADEAR008M SO
		                                where SO.AUD_YR      = detail.AUD_YR
		                                  AND SO.AUD_NO      = detail.AUD_NO
		                                  AND SO.DSP_RQ_SNO  = detail.DSP_RQ_SNO) SOKIK,  /*소관청코드 AS-IS: 처분요구상세사항-> TO-BE: 소관기관기본에서 추출*/
		                               master.DSP_RQ_KND_CD               as CHB_CD,                                                                         
		                               NVL(detail.NOP_CNT, 0)             as CHB_SU,                                                                         
		                               NVL(detail.PNL_DRIN_PSVT_AM, 0)    as CAM1 ,                                                                         
		                               NVL(detail.RSR_AM, 0)              as CAM2 ,                                                                         
		                               NVL(detail.SPLP_AM, 0)             as CAM3
		                          from TBBADEAR001M   master,
		                               TBBADEAR002D detail
		                         where master.AUD_YR     = detail.AUD_YR
		                           and master.AUD_NO      = detail.AUD_NO
		                           and master.DSP_RQ_SNO     = detail.DSP_RQ_SNO
		                           and detail.ENF_DT    is not null
		                           and detail.DTM_STA_CD != '0'
        ]]>		   
                        
		                        /* 확정일자 기준 추가 - 2017.03.21 yyh*/
								<isEqual property="strSrchDvsn" compareValue="1">
								   /* 시행일자 기준 */		                           
		                           and detail.ENF_DT            between #strFromDt# and #strToDt#  /*화면의 기간 인자값*/
		                        </isEqual>   
		                        <isEqual property="strSrchDvsn" compareValue="2">
		                           /* 확정일자 기준 */
		                           and detail.ENFM_WHLS_DTM_DT  between #strFromDt# and #strToDt#  /*화면의 기간 인자값*/
		                        </isEqual>
		                        
		<![CDATA[                                                                                                             
		                       ) a                                                                                                                             
		                   group by YYMM,
		                            KIKGU,
		                            SOKIK,                                                                                                               
		                            (case when CHB_CD < '930' and CHB_CD not in('390','391','395','396','800','810','820','830','840','850')            then CHB_CD                                      
		                                  when CHB_CD < '800' and CHB_CD in ('390','391') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0  then '390'
		                                  when CHB_CD < '800' and CHB_CD in ('395','396') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0  then '395'                                       
		                                  when CHB_CD < '800' and CHB_CD in ('390','391') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0  then '391'
		                                  when CHB_CD < '800' and CHB_CD in ('395','396') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0  then '396'                                       
		                             else null 
		                             end)  
		             
		             ) STKIKW_F                                                                                                                              
		         group by (case when SUBSTR(KIKGU, 1, 1) = '1' then '1'                                                                                    
		                        when SUBSTR(KIKGU, 1, 1) = '2' then '2'                                                                                    
		                        when SUBSTR(KIKGU, 1, 1) = '3' then '3'                                                                                    
		                   else '4' 
		                   end)
		    ) STKIKW_F_SUM
        ]]>
	</select>	

	<select id="BADEAR019Qselect1_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			 /*쿼리명 : SQL_Detail*/
    
        select case when SUBSTR(KIKGU, 1, 1) = '1' then '1'                                                                                    
                    when SUBSTR(KIKGU, 1, 1) = '2' then '2'                                                                                    
                    when SUBSTR(KIKGU, 1, 1) = '3' then '3'                                                                                    
               else '4' 
               end as KIKW,     
               case when SUBSTR(KIKGU, 1, 1) = '1' then '국가기관'                                                                                    
                    when SUBSTR(KIKGU, 1, 1) = '2' then '자치단체'                                                                                    
                    when SUBSTR(KIKGU, 1, 1) = '3' then '공공기관'                                                                                    
               else '기타단체' 
               end as KIKW_NM, 
               
               sum(case when CHBCD = '110' then NVL(GUNSU,0)                                                                                        
                   else 0 end)                                                as A1,                                                                   
               sum(case when CHBCD = '110' then NVL(AM1,0)                                                                                         
                   else 0 end)                                                as A2,                                                                   
               sum(case when CHBCD = '110' then NVL(AM2,0) + NVL(AM3,0)                                                                        
                   else 0 end)                                                as A3,                                                                   
               sum(case when CHBCD = '210' then NVL(GUNSU,0)                                                                                        
                   else 0 end)                                                as B1,                                                                   
               sum(case when CHBCD = '210' then NVL(MAN,0)                                                                                          
                   else 0 end)                                                as B2,                                                                   
               sum(     case when CHBCD = '310' then NVL(GUNSU,0)                                                                                   
                   else case when CHBCD = '320' then NVL(GUNSU,0)                                                                                   
                   else 0 end end)                                            as C1,                                                                   
               sum(     case when CHBCD = '310' then NVL(AM1,0)                                                                                    
                   else case when CHBCD = '320' then NVL(AM1,0)                                                                                    
                   else 0 end end)                                            as C2,                                                                   
               sum(     case when CHBCD = '310' then NVL(AM2,0) + NVL(AM3,0)                                                                   
                   else case when CHBCD = '320' then NVL(AM2,0) + NVL(AM3,0)                                                                   
                   else 0 end end)                                            as C3,                                                                   
               sum(     case when CHBCD = '390' then NVL(GUNSU,0)                                                                                   
                   else case when CHBCD = '391' then NVL(GUNSU,0)                                                                                   
                   else 0 end end)                                            as D1,                                                                   
               sum(     case when CHBCD = '390' then NVL(AM1,0)                                                                                    
                   else case when CHBCD = '391' then NVL(AM1,0)                                                                                    
                   else 0 end end)                                            as D2,                                                                   
               sum(     case when CHBCD = '390' then NVL(AM2,0) + NVL(AM3,0)                                                                   
                   else case when CHBCD = '391' then NVL(AM2,0) + NVL(AM3,0)                                                                   
                   else 0 end end)                                            as D3,
               sum(     case when CHBCD = '395' then NVL(GUNSU,0)                                                                                   
                   else case when CHBCD = '396' then NVL(GUNSU,0)                                                                                   
                   else 0 end end)                                            as D4,                                                                   
               sum(     case when CHBCD = '395' then NVL(AM1,0)                                                                                    
                   else case when CHBCD = '396' then NVL(AM1,0)                                                                                    
                   else 0 end end)                                            as D5,                                                                   
               sum(     case when CHBCD = '395' then NVL(AM2,0) + NVL(AM3,0)                                                                   
                   else case when CHBCD = '396' then NVL(AM2,0) + NVL(AM3,0)                                                                   
                   else 0 end end)                                            as D6,                                                                       
               sum(     case when CHBCD = '410' then NVL(GUNSU,0)                                                                                   
                   else case when CHBCD = '490' then NVL(GUNSU,0)                                                                                   
                   else 0 end end)                                            as E1,
               sum(case when CHBCD = '495' then NVL(GUNSU,0)                                                                                   
                   else 0 end)                                                as E2,                                                                       
               sum(case when CHBCD = '510' then NVL(GUNSU,0)                                                                                        
                   else 0 end)                                                as F1,                                                                   
               sum(case when CHBCD = '520' then NVL(GUNSU,0)                                                                                        
                   else 0 end)                                                as G1,                                                                   
               sum(case when CHBCD = '530' then NVL(GUNSU,0)                                                                                        
                   else 0 end)                                                as H1,                                                                   
               sum(case when CHBCD = '611' then NVL(GUNSU,0)                                                                                        
                   else 0 end)                                                as I1,
                   
                                                                                      
               sum(case when CHBCD in ('610', '630') then NVL(GUNSU,0)                                                                                        
                        else 0 end)                                               as J1, /* 통보 */
               sum(case when CHBCD in ('610', '630') then NVL(AM1,0)                                                                                                                                                                     
                        else 0 end)                                               as J2,                                   
               sum(case when CHBCD in ('610', '630') then NVL(AM2,0) + NVL(AM3,0)                                                                                                                                                                     
                        else 0 end)                                               as J3,
               sum(case when CHBCD = '623' then NVL(GUNSU,0)                                                                                                                                                                     
                        else 0 end)                                               as K1, /* 통보(비위) - 623 */                                                                   
               sum(case when CHBCD = '623' then NVL(MAN,0)                                                                                                                                                                        
                        else 0 end)                                               as K2,                                                                   
               sum(case when CHBCD in ('620', '621') then NVL(GUNSU,0)                                                                                                                                                                    
                        else 0 end)                                               as L1,  /* 통보(인사) - 620 */                                                                  
               sum(case when CHBCD in ('620', '621') then NVL(MAN,0)                                                                                                                                                                         
                        else 0 end)                                               as L2,
               sum(case when CHBCD IN ('710', '720', '730')  then NVL(GUNSU,0)                                                                                                                                                                
                        else 0 end)                                                as M1,   /* 고발 - 710,720,730 */                                                              
               sum(case when CHBCD IN ('710', '720', '730')  then NVL(MAN,0)                                                                                                                                                                       
                        else 0 end)                                                as M2,
                        
               sum(case when CHBCD = '625' then NVL(GUNSU,0)                                                                                                                                                                     
                        else 0 end)                                               as N1, /* 통보(시정완료):625 추가 - 2017.01.20 yyh*/                                                                   
               sum(case when CHBCD = '625' then NVL(AM1,0)                                                                                                                                                                     
                        else 0 end)                                               as N2,                                   
               sum(case when CHBCD = '625' then NVL(AM2,0) + NVL(AM3,0)                                                                                                                                                                     
                        else 0 end)                                               as N3    
                                                
/* 주석 
               sum(case when CHBCD = '610' then NVL(GUNSU,0)
                   else 0 end)                                                as J1,
               sum(     case when CHBCD = '620' then NVL(GUNSU,0)
                   else case when CHBCD = '621' then NVL(GUNSU,0)
                   else 0 end end)                                            as K1,
               sum(     case when CHBCD = '620' then NVL(MAN,0)
                   else case when CHBCD = '621' then NVL(MAN,0)
                   else 0 end end)                                            as K2,
               sum(     case when CHBCD = '710' then NVL(GUNSU,0)
                   else case when CHBCD = '720' then NVL(GUNSU,0)
                   else case when CHBCD = '730' then NVL(GUNSU,0)
                   else 0 end end end)                                        as L1,
               sum(     case when CHBCD = '710' then NVL(MAN,0)
                   else case when CHBCD = '720' then NVL(MAN,0)
                   else case when CHBCD = '730' then NVL(MAN,0)
                   else 0 end end end)                                        as L2,
               sum(     case when CHBCD = '623' then NVL(GUNSU,0)
                   else 0 end)                                                as M1,
               sum(     case when CHBCD = '623' then NVL(MAN,0)
                   else 0 end)                                                as M2
*/                        
                        
                        
                                                                                    
          from (select YYMM,                                                                                                                           
                       KIKGU,                                                                                                                          
                       SOKIK,                                                                                                                          
                       (case when CHB_CD < '930' and CHB_CD not in('390','391','395','396','800','810','820','830','840','850')             then CHB_CD                                      
                             when CHB_CD < '800' and CHB_CD in ('390','391') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0  then '390'                                       
                             when CHB_CD < '800' and CHB_CD in ('395','396') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0  then '395'                                       
                             when CHB_CD < '800' and CHB_CD in ('390','391') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0  then '391'                                       
                             when CHB_CD < '800' and CHB_CD in ('395','396') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0  then '396'                                       
                        end)  AS CHBCD,                                                                                                          
                       sum(case when CHB_CD in('110','310','320','390','391','395','396','410','490','495')                                                              
                                  or CHB_CD in('320','410','490','495','510','520','530','610','611','630','910','911','912','913','914','915','916','625')  then 0
                           else CHB_SU end) AS MAN,                                                                                                     
                       sum(case when CHB_CD in('210','620','621', '623','710','720','730', '800','810','820','830','840','850')                               
                                  or CHB_CD in('410','490','495','510','520','530', '611','910','911','912','913','914','915','916') then 0
                           else CAM1  end)  AS AM1,                                                                                                    
                       sum(case when CHB_CD in('210','620','621', '623','710','720','730', '800','810','820','830','840','850')                               
                                  or CHB_CD in('320','410','490','495','510','520','530', '611','910','911','912','913','914','915','916') then 0
                           else CAM2  end)  AS AM2,                                                                                                    
                       sum(case when CHB_CD in('210','620','621', '623','710','720','730', '800','810','820','830','840','850')                               
                                  or CHB_CD in('320','410','490','495','510','520','530', '611','910','911','912','913','914','915','916') then 0
                           else CAM3  end)  AS AM3,                                                                                                    
                       
                       /*GUNSU*/
                       (NVL(sum(case when CHB_CD < '930'                                                                                          
                                     and CHB_CD not in('390','391','395','396','800','810','820','830','840','850') then 1 end), 0)  +                        
                        NVL(sum(case when CHB_CD < '800'                                                                                          
                                     and CHB_CD in ('390','391','395','396')                                                                                 
                                     and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0 then 1 end),0) +                               
                        NVL(sum(case when CHB_CD < '800'                                                                                          
                                     and CHB_CD in ('390','391','395','396')                                                                                 
                                     and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 then 1 end),0)) AS GUNSU 
              
                  from (select SUBSTR(detail.ENF_DT, 1, 6)        as YYMM  ,                                                                         
                               master.ORG_DVSN_CD                 as KIKGU ,
                               (select MAX(RLTN_ORG_CD) 
                                 from TBBADEAR008M SO
                                where SO.AUD_YR      = detail.AUD_YR
                                  AND SO.AUD_NO      = detail.AUD_NO
                                  AND SO.DSP_RQ_SNO  = detail.DSP_RQ_SNO) SOKIK,  /*소관청코드 AS-IS: 처분요구상세사항-> TO-BE: 소관기관기본에서 추출*/
                               master.DSP_RQ_KND_CD               as CHB_CD,                                                                         
                               NVL(detail.NOP_CNT, 0)             as CHB_SU,                                                                         
                               NVL(detail.PNL_DRIN_PSVT_AM, 0)    as CAM1 ,                                                                         
                               NVL(detail.RSR_AM, 0)              as CAM2 ,                                                                         
                               NVL(detail.SPLP_AM, 0)             as CAM3
                          from TBBADEAR001M   master,
                               TBBADEAR002D detail
                         where master.AUD_YR     = detail.AUD_YR
                           and master.AUD_NO      = detail.AUD_NO
                           and master.DSP_RQ_SNO     = detail.DSP_RQ_SNO
                           and detail.ENF_DT    is not null
                           and detail.DTM_STA_CD != '0'
        ]]>		   
                        
		                 /* 확정일자 기준 추가 - 2017.03.21 yyh*/
					  <isEqual property="strSrchDvsn" compareValue="1">
						   /* 시행일자 기준 */		                           
		                   and detail.ENF_DT            between #strFromDt# and #strToDt#  /*화면의 기간 인자값*/
		              </isEqual>   
		              <isEqual property="strSrchDvsn" compareValue="2">
		                   /* 확정일자 기준 */
		                   and detail.ENFM_WHLS_DTM_DT  between #strFromDt# and #strToDt#  /*화면의 기간 인자값*/
		              </isEqual>
		                        
		<![CDATA[  
                       ) a                                                                                                                             
                   group by YYMM,
                            KIKGU,
                            SOKIK,                                                                                                               
                            (case when CHB_CD < '930' and CHB_CD not in('390','391','395','396','800','810','820','830','840','850')            then CHB_CD                                      
                                  when CHB_CD < '800' and CHB_CD in ('390','391') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0  then '390'                                       
                                  when CHB_CD < '800' and CHB_CD in ('395','396') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0  then '395'                                       
                                  when CHB_CD < '800' and CHB_CD in ('390','391') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0  then '391'                                       
                                  when CHB_CD < '800' and CHB_CD in ('395','396') and (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0  then '396'                                       
                             else null 
                             end)  
             
             ) STKIKW_F                                                                                                                              
         group by (case when SUBSTR(KIKGU, 1, 1) = '1' then '1'                                                                                    
                        when SUBSTR(KIKGU, 1, 1) = '2' then '2'                                                                                    
                        when SUBSTR(KIKGU, 1, 1) = '3' then '3'                                                                                    
                   else '4' 
                   end
                  ,case when SUBSTR(KIKGU, 1, 1) = '1' then '국가기관'                                                                                    
                        when SUBSTR(KIKGU, 1, 1) = '2' then '자치단체'                                                                                    
                        when SUBSTR(KIKGU, 1, 1) = '3' then '공공기관'                                                                                    
                   else '기타단체' 
                   end )
         ORDER BY KIKW
        ]]>
	</select>	

	<select id="BADEAR019Qselect2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
		/*쿼리명 : SQL_Main04*/
			select  
			        CASE WHEN ORG_DVSN_CD ='10' THEN '국가기관'
			             WHEN ORG_DVSN_CD ='21' THEN '자치단체'
			             WHEN ORG_DVSN_CD ='30' THEN '공공기관'
			             WHEN ORG_DVSN_CD ='40' THEN '기타단체'
			        END RLTN_ORG_DVSN_CD_NM
			       ,NVL(AA.TOT,0)  as TOT
			       ,NVL(AA.PA,0)   as PA
			       ,NVL(AA.GANG,0) as GANG
			       ,NVL(AA.HAE,0)  as HAE
			       ,NVL(AA.JUNG,0) as JUNG
			       ,NVL(AA.BU,0)   as BU
			 from (select  case when master.ORG_DVSN_CD in ('21','22') then '21'
			                     when master.ORG_DVSN_CD in ('10','30') then master.ORG_DVSN_CD
			                     else '40'
			                end                                                                  as ORG_DVSN_CD
			               , sum(case when relpsn.HND_RQ_KND_CD = '001' then 1 else 0 end)
			               + sum(case when relpsn.HND_RQ_KND_CD = '002' then 1 else 0 end)
			               + sum(case when relpsn.HND_RQ_KND_CD = '003' then 1 else 0 end)
			               + sum(case when relpsn.HND_RQ_KND_CD = '004' then 1 else 0 end)
			               + sum(case when relpsn.HND_RQ_KND_CD = '013' then 1 else 0 end)      as TOT 
			               ,sum(case when relpsn.HND_RQ_KND_CD = '001' then 1 else 0 end)       as PA  
			               ,sum(case when relpsn.HND_RQ_KND_CD = '013' then 1 else 0 end)       as GANG  
			               ,sum(case when relpsn.HND_RQ_KND_CD = '002' then 1 else 0 end)       as HAE 
			               ,sum(case when relpsn.HND_RQ_KND_CD = '003' then 1 else 0 end)       as JUNG
			               ,sum(case when relpsn.HND_RQ_KND_CD = '004' then 1 else 0 end)       as BU
			         from TBBADEAR001M master,
			              TBBADEAR002D detail,
			              TBBADEAR007M relpsn
			        where master.AUD_YR      = detail.AUD_YR
			          and master.AUD_NO      = detail.AUD_NO
			          and master.DSP_RQ_SNO  = detail.DSP_RQ_SNO
			          and master.AUD_YR      = relpsn.AUD_YR
			          and master.AUD_NO      = relpsn.AUD_NO
			          and master.DSP_RQ_SNO  = relpsn.DSP_RQ_SNO
			          and master.DSP_RQ_KND_CD = '210'
			          and detail.DTM_STA_CD != '0'
			          and detail.ENF_DT between #strFromDt# and #strToDt#
			        group by case when master.ORG_DVSN_CD in ('21','22') then '21'
			                      when master.ORG_DVSN_CD in ('10','30') then master.ORG_DVSN_CD
			                 else '40'
			                 end    
			       ) AA
			ORDER BY ORG_DVSN_CD
       
        ]]>
	</select>	

	<select id="BADEAR019Qselect3" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			/*쿼리명 : SQL_Main05*/
			select  sum(case when master.ORG_DVSN_CD >= '10'                        then 1 else 0 end) as TOT  /*전체건수 합계*/
			       ,sum(case when master.ORG_DVSN_CD = '10'                         then 1 else 0 end) as AAA  /*전체건수 국가기관*/
			       ,sum(case when master.ORG_DVSN_CD in ('21','22')                 then 1 else 0 end) as BBB  /*전체건수 자치단체*/
			       ,sum(case when master.ORG_DVSN_CD = '30'                         then 1 else 0 end) as CCC  /*전체건수 투자기관*/
			       ,sum(case when master.ORG_DVSN_CD not in ('10','21','22','30')   then 1 else 0 end) as DDD  /*전체건수 기타단체*/
			  from  TBBADEAR002D  detail
			       ,TBBADEAR001M  master
			 where  1=1
			   and  master.AUD_YR      = detail.AUD_YR
			   and  master.AUD_NO      = detail.AUD_NO
			   and  master.DSP_RQ_SNO  = detail.DSP_RQ_SNO
			   and  master.DSP_RQ_KND_CD in ('810','820','830','840','850')
			   and  detail.DTM_STA_CD != '0'
			   and  detail.ENF_DT     between #strFromDt# and #strToDt#  /*화면의 기간(인자값)*/
			
        ]]>
	</select>	
		<select id="BADEAR019Qselect3_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			/*쿼리명 : SQL_Sub05*/
				select  BB.NM           as DISP_REQ_NM  /*명칭*/
				       ,NVL(TOT_BG_1,0) as TOT_BG_1  /*합계  기관건수 */
				       ,NVL(TOT_BG_2,0) as TOT_BG_2  /*합계 기관수 */
				       ,NVL(TOT_BP_1,0) as TOT_BP_1  /*합계 인원건수 */
				       ,NVL(TOT_BP_2,0) as TOT_BP_2  /*합계 인원수 */
				       ,NVL(AG_1,0)     as AG_1     /*국가기관 기관건수*/
				       ,NVL(AG_2,0)     as AG_2     /*국가기관 기관수*/
				       ,NVL(AP_1,0)     as AP_1     /*국가기관 인원건수*/
				       ,NVL(AP_2,0)     as AP_2     /*국가기관 인원수*/
				       ,NVL(BG_1,0)     as BG_1     /*자치단체 기관건수*/
				       ,NVL(BG_2,0)     as BG_2     /*자치단체 기관수*/
				       ,NVL(BP_1,0)     as BP_1     /*자치단체 인원건수*/
				       ,NVL(BP_2,0)     as BP_2     /*자치단체 인원수*/
				       ,NVL(CG_1,0)     as CG_1     /*투자기관 기관건수*/
				       ,NVL(CG_2,0)     as CG_2     /*투자기관 기관수*/
				       ,NVL(CP_1,0)     as CP_1     /*투자기관 인원건수*/
				       ,NVL(CP_2,0)     as CP_2     /*투자기관 인원수*/
				       ,NVL(DG_1,0)     as DG_1     /*기타단체 기관건수*/
				       ,NVL(DG_2,0)     as DG_2     /*기타단체 기관수*/
				       ,NVL(DP_1,0)     as DP_1     /*기타단체 인원건수*/
				       ,NVL(DP_2,0)     as DP_2     /*기타단체 인원수*/
				  from (select   master.DSP_RQ_KND_CD
				                ,sum(case when master.ORG_DVSN_CD >= '10'  then 
				                           (case when detail.NOP_CNT > 0 then 0  else 1 end) 
				                     else 0 
				                     end) as TOT_BG_1
				                
				                ,sum(case when master.ORG_DVSN_CD >= '10'  then 
				                           (case when detail.NOP_CNT > 0   then 0                                  
				                                 when detail.NOP_CNT <= 0 and detail.ORG_CNT = 0 then 1 
				                            else detail.ORG_CNT 
				                            end) 
				                     else 0
				                     end) as TOT_BG_2
				                
				                ,sum(case when master.ORG_DVSN_CD >= '10'  then 
				                           (case when detail.NOP_CNT > 0   then 1 else 0 end) 
				                     else 0
				                     end) as TOT_BP_1
				                
				                ,sum(case when master.ORG_DVSN_CD >= '10'  then 
				                         (case when detail.NOP_CNT > 0     then detail.NOP_CNT else 0 end) 
				                     else 0
				                     end) as TOT_BP_2 
				                
				                ,sum(case when master.ORG_DVSN_CD = '10'   then 
				                         (case when detail.NOP_CNT > 0     then 0 else 1 end) 
				                     else 0 
				                     end) as AG_1
				                
				                ,sum(case when master.ORG_DVSN_CD = '10'   then 
				                         (case when detail.NOP_CNT > 0     then 0
				                               when detail.NOP_CNT <= 0 and detail.ORG_CNT = 0 then 1 
				                          else detail.ORG_CNT 
				                          end) 
				                     else 0 
				                     end) as AG_2
				                
				                ,sum(case when master.ORG_DVSN_CD = '10'   then 
				                          (case when detail.NOP_CNT > 0    then 1 else 0 end) 
				                     else 0 
				                     end) as AP_1
				                
				                ,sum(case when master.ORG_DVSN_CD = '10'   then 
				                          (case when detail.NOP_CNT > 0    then detail.NOP_CNT else 0 end) 
				                     else 0 end) as AP_2
				                
				                ,sum(case when master.ORG_DVSN_CD in ('21', '22') then 
				                          (case when detail.NOP_CNT > 0    then 0  else 1 end) 
				                     else 0 
				                     end) as BG_1
				                
				                ,sum(case when master.ORG_DVSN_CD in ('21', '22') then 
				                          (case when detail.NOP_CNT > 0    then 0                                                      
				                                when detail.NOP_CNT <= 0 and detail.ORG_CNT = 0 then 1 
				                           else detail.ORG_CNT 
				                           end) 
				                     else 0 end) as BG_2
				                
				                ,sum(case when master.ORG_DVSN_CD in ('21', '22') then 
				                          (case when detail.NOP_CNT > 0  then 1 else 0 end) 
				                     else 0 
				                     end) as BP_1
				                
				                ,sum(case when master.ORG_DVSN_CD in ('21', '22') then 
				                          (case when detail.NOP_CNT > 0    then detail.NOP_CNT else 0 end) 
				                     else 0 
				                     end) as BP_2
				                
				                ,sum(case when master.ORG_DVSN_CD = '30' then 
				                          (case when detail.NOP_CNT > 0    then 0 else 1 end) 
				                     else 0 
				                     end) as CG_1                
				                
				                ,sum(case when master.ORG_DVSN_CD = '30' then 
				                          (case when detail.NOP_CNT > 0    then 0                                                               
				                                when detail.NOP_CNT <= 0   and detail.ORG_CNT = 0 then 1 
				                           else detail.ORG_CNT 
				                           end) 
				                     else 0 
				                     end) as CG_2
				                
				                ,sum(case when master.ORG_DVSN_CD = '30' then 
				                         (case when detail.NOP_CNT > 0    then 1 else 0 end) 
				                     else 0 
				                     end) as CP_1
				                
				                ,sum(case when master.ORG_DVSN_CD = '30' then 
				                          (case when detail.NOP_CNT > 0  then detail.NOP_CNT else 0 end) 
				                     else 0 
				                     end) as CP_2
				                
				                ,sum(case when master.ORG_DVSN_CD not in ('10','21','22','30')  then 
				                          (case when detail.NOP_CNT > 0  then 0 else 1 end) 
				                     else 0 
				                     end) as DG_1
				                
				                ,sum(case when master.ORG_DVSN_CD not in ('10','21','22','30')  then 
				                          (case when detail.NOP_CNT > 0    then 0 
				                                when detail.NOP_CNT <= 0   and detail.ORG_CNT = 0 then 1 
				                           else detail.ORG_CNT 
				                           end) 
				                     else 0 
				                     end) as DG_2
				                
				                ,sum(case when master.ORG_DVSN_CD not in ('10','21','22','30')  then 
				                          (case when detail.NOP_CNT > 0    then 1 else 0 end) 
				                     else 0 
				                     end) as DP_1
				                
				                ,sum(case when master.ORG_DVSN_CD not in ('10','21','22','30')  then 
				                          (case when detail.NOP_CNT > 0    then detail.NOP_CNT  else 0 end) 
				                     else 0 end) as DP_2  
				          from   TBBADEAR002D detail
				                ,TBBADEAR001M master
				         where   1=1
				           and   master.AUD_YR = detail.AUD_YR
				           and   master.AUD_NO  = detail.AUD_NO
				           and   master.DSP_RQ_SNO = detail.DSP_RQ_SNO
				           and   master.DSP_RQ_KND_CD in ('810','820','830','840','850')  /*모범목록코드(고정)*/
				           and   detail.ENF_DT between #strFromDt# and #strToDt#  /*화면의 기간(인자값)*/
				           and  detail.DTM_STA_CD != '0'
				         group 
				            by   master.DSP_RQ_KND_CD  
				       ) AA, 
				       (select '810' as CD, '예산절감'   as NM  FROM DUAL
				        union all
				        select '820' as CD, '업무개선'   as NM  FROM DUAL
				        union all
				        select '830' as CD, '성실근무'   as NM  FROM DUAL
				        union all
				        select '840' as CD, '민원해소'   as NM  FROM DUAL
				        union all
				        select '850' as CD, '모범(기타)' as NM  FROM DUAL
				       ) BB
				 where AA.DSP_RQ_KND_CD(+) = BB.CD
				 ORDER BY BB.CD
			
        ]]>
	</select>	
	<select id="BADEAR019Qselect4" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[   			
        select detail.ENF_BRDV_CD||'-'||detail.DOC_SEN_NO||'('||detail.DSP_RQ_SRNO||')' as NO ,  /*시행문번호 및 일련번호*/
		       detail.ENF_BRDV_CD ,
		       master.AUD_NO ,
		       master.DSP_RQ_SNO ,
		       detail.ENF_DT ,               /*시행일자*/
		       F_ORG_INFO(SUBSTR(detail.RLTN_ORG_CD, 1, 3)||'000000000','1')  as SOKIK,  /*소관청명*/
		       F_ORG_INFO(detail.RLTN_ORG_CD,'1')  as ORG_NM,   /*기관명    */
		       NVL(detail.PNL_DRIN_PSVT_AM, 0) as AM ,  /*금액(상단)*/
		       NVL(detail.RSR_AM, 0) + NVL(detail.SPLP_AM, 0) as TOT_AM ,   /*금액(하단)*/
		       master.TIT_TXT  /*제목*/
		  from TBBADEAR001M master,
		       TBBADEAR002D detail
		 where 1=1
		   and master.AUD_YR = detail.AUD_YR
		   and master.AUD_NO = detail.AUD_NO
		   and master.DSP_RQ_SNO = detail.DSP_RQ_SNO
		   and master.DSP_RQ_KND_CD in ('310', '390', '391', '395', '396')
		   and NVL(detail.PNL_DRIN_PSVT_AM, 0) + NVL(detail.RSR_AM, 0) + NVL(detail.SPLP_AM, 0) != 0
		   and detail.ENF_DT between #strFromDt# and #strToDt#  /*화면 기간 인자값*/
		   and detail.DTM_STA_CD != '0'
		  ORDER BY AM DESC , TOT_AM DESC 
        ]]>
	</select>	    
		<select id="BADEAR019Qselect5" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[   			
		select  BB.NM                                   as NM
		       ,NVL(AA.C_TOT,0) + NVL(AA.A_TOT,0) + NVL(AA.B_TOT,0) as TOTAL
		       ,NVL(AA.C_TOT,0)                      as C_TOT
		       ,NVL(AA.C_1,0)                        as C_1
		       ,NVL(AA.C_2,0)                        as C_2
		       ,NVL(AA.C_3,0)                        as C_3
		       ,NVL(AA.C_4,0)                        as C_4		       
		       ,NVL(AA.A_TOT,0)                      as A_TOT
		       ,NVL(AA.A_1,0)                        as A_1
		       ,NVL(AA.A_2,0)                        as A_2
		       ,NVL(AA.A_3,0)                        as A_3
		       ,NVL(AA.A_4,0)                        as A_4
		       ,NVL(AA.B_TOT,0)                      as B_TOT
		       ,NVL(AA.B_1,0)                        as B_1
		       ,NVL(AA.B_2,0)                        as B_2
		       ,NVL(AA.B_3,0)                        as B_3
		       ,NVL(AA.B_4,0)                        as B_4
		  from (select  relpsn.HND_RQ_KND_CD
		                /* 국가 및 지방자치단체를 국가와 지방자치단체로 분리 - 2016.06.23 yyh */
						/* 국가 */
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '1'                    then 1 else 0 end)             as C_TOT
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '1'
		                         then (case when relpsn.RANK_CD in ('01','02','03','04','05') then 1 else 0 end) else 0 end) as C_1
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '1'
		                         then (case when relpsn.RANK_CD in ('06','07')                then 1 else 0 end) else 0 end) as C_2
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '1'
		                         then (case when relpsn.RANK_CD in ('08','09')                then 1 else 0 end) else 0 end) as C_3
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '1' 
		                         then (case when relpsn.RANK_CD between '01' and '09'         then 0 else 1 end) else 0 end) as C_4	
								                
		                /* 지방자치단체 */
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '2'                    then 1 else 0 end)             as A_TOT
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '2' 
		                         then (case when relpsn.RANK_CD in ('01','02','03','04','05') then 1 else 0 end) else 0 end) as A_1
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '2'
		                         then (case when relpsn.RANK_CD in ('06','07')                then 1 else 0 end) else 0 end) as A_2
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '2'
		                         then (case when relpsn.RANK_CD in ('08','09')                then 1 else 0 end) else 0 end) as A_3
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) = '2'
		                         then (case when relpsn.RANK_CD between '01' and '09'         then 0 else 1 end) else 0 end) as A_4

		               /* 정부투자기관 및 기타단체 */
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) not in ('1','2') or master.ORG_DVSN_CD is null then 1 else 0 end)  as B_TOT
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) not in ('1','2') or master.ORG_DVSN_CD is null
		                         then (case when relpsn.RANK_CD in ('61','62','63')           then 1 else 0 end) else 0 end) as B_1
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) not in ('1','2') or master.ORG_DVSN_CD is null
		                         then (case when relpsn.RANK_CD in ('64','65')                then 1 else 0 end) else 0 end) as B_2
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) not in ('1','2') or master.ORG_DVSN_CD is null
		                         then (case when relpsn.RANK_CD = '66'                        then 1 else 0 end) else 0 end) as B_3
		               ,sum(case when SUBSTR(master.ORG_DVSN_CD,1,1) not in ('1','2') or master.ORG_DVSN_CD is null
		                         then (case when relpsn.RANK_CD between '61' and '66'         then 0 else 1 end) else 0 end) as B_4
		                         
		          from  TBBADEAR001M   master
		               ,TBBADEAR002D detail
		               ,TBBADEAR007M relpsn
		         where 1=1
		           and master.AUD_YR                 = detail.AUD_YR
		           and master.AUD_NO                 = detail.AUD_NO
		           and master.DSP_RQ_SNO             = detail.DSP_RQ_SNO
		           and master.AUD_YR                 = relpsn.AUD_YR
		           and master.AUD_NO                 = relpsn.AUD_NO
		           and master.DSP_RQ_SNO             = relpsn.DSP_RQ_SNO
		           and master.DSP_RQ_KND_CD            in ('210','620','621','623')
		           and detail.ENF_DT                between #strFromDt# and #strToDt#  /*화면인자값*/
		           and detail.DTM_STA_CD             != '0'
		           and relpsn.HND_RQ_KND_CD           in ('001','002','003','004','005','013','015')
		         group 
		            by relpsn.HND_RQ_KND_CD 
		       ) AA,
		       (select '001' as CD, '파        면' as NM, 1 sort from dual
		        union all
		        select '002' as CD, '해        임' as NM,  2 from dual
		        union all
		        select '013' as CD, '강        등' as NM,  3 from dual
		        union all
		        select '003' as CD, '정        직' as NM,  4 from dual
		        union all
		        select '004' as CD, '경징계  이상' as NM, 5 from dual
		        union all
		        select '015' as CD, '비 위  통 보' as NM, 6 from dual 
		        union all
		        select '005' as CD, '인사자료통보' as NM, 7  from dual
		       ) BB
		 where 1=1
		   and AA.HND_RQ_KND_CD(+) = BB.CD
		 order by bb.sort
        	
        ]]>
	</select>	  
		<select id="BADEAR019Qselect6" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[   			
        
        	select  M.ORG_DVSN_CD       as ORG_DVSN_CD
	              , case when SUBSTR(M.ORG_DVSN_CD, 1, 1) = '1' then '국가기관'                                                                                    
	                    when SUBSTR(M.ORG_DVSN_CD, 1, 1) = '2' then '자치단체'                                                                                    
	                    when SUBSTR(M.ORG_DVSN_CD, 1, 1) = '3' then '공공기관'                                                                                    
	               else '기타단체' 
	               end as KIKW_NM
			      , M.C1+M.C3+M.C5+M.C7 as T_GUNSU
			      , M.C2+M.C6           as T_AM
			      , M.C1 ,M.C2 ,M.C3 ,M.C4 ,M.C5 ,M.C6 ,M.C7
			  from (select  master.ORG_DVSN_CD                                                                                       as ORG_DVSN_CD
			               ,sum(case when master.DSP_RQ_KND_CD = '110'              then 1                              else 0 end ) as C1
			               ,sum(case when master.DSP_RQ_KND_CD = '110'              then NVL(detail.PNL_DRIN_PSVT_AM,0) else 0 end ) as C2
			               ,sum(case when master.DSP_RQ_KND_CD = '210'              then 1                              else 0 end ) as C3
			               ,sum(case when master.DSP_RQ_KND_CD = '210'              then NVL(detail.NOP_CNT,0)          else 0 end ) as C4
			               ,sum(case when SUBSTR(master.DSP_RQ_KND_CD,1,1) = '3'    then 1                              else 0 end ) as C5
			               ,sum(case when SUBSTR(master.DSP_RQ_KND_CD,1,1) = '3'    then NVL(detail.PNL_DRIN_PSVT_AM,0) else 0 end ) as C6
			               ,sum(case when SUBSTR(master.DSP_RQ_KND_CD,1,1) = '5'    then 1                              else 0 end ) as C7
			          from  TBBADEAR001M master
			               ,TBBADEAR002D detail
			               ,(select  AUD_YR
			                        ,AUD_NO
			                        ,DSP_RQ_SNO
			                        ,COUNT(*)  as CNT
			                   from  TBBADFRE009M
			                  where  1=1
			                    and  ENFM_PRSU_DT between #strFromDt# and #strToDt#  /*화면의 인자값 기간*/
			                  group 
			                     by  AUD_YR
			                        ,AUD_NO
			                        ,DSP_RQ_SNO 
			                ) prss
			         where  1=1
			           and  master.AUD_YR   = detail.AUD_YR
			           and  master.AUD_NO    = detail.AUD_NO
			           and  master.DSP_RQ_SNO   = detail.DSP_RQ_SNO
			           and  master.AUD_YR   = prss.AUD_YR
			           and  master.AUD_NO    = prss.AUD_NO
			           and  master.DSP_RQ_SNO   = prss.DSP_RQ_SNO
			           and  detail.ENF_DT  between #strFromDt# and #strToDt# /*화면의 인자값 기간*/
			           and  detail.DTM_STA_CD !='2'
			           and  prss.CNT          >= #strPressCnt# /*화면의 인자값 독촉회수 1이상이면 :1,   독촉회수 2이상이면:2*/
			         group 
			            by  master.ORG_DVSN_CD 
			       ) M
			 order by M.ORG_DVSN_CD
        	
        ]]>
	</select>	  
	
	
	<select id="BADEAR019Qselect7" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[   			
        
        	select  detail.COPT_OFI_CD                                              as COPT_OFI_CD
			       ,org1.ORG_NM                                                     as COMPTAUTH_NM
			       ,org2.ORG_NM                                                     as REL_ORG_NM
			       ,detail.ENF_BRDV_CD ||'-'|| detail.DOC_SEN_NO ||'-'|| detail.DSP_RQ_SNO  as NO
			       ,detail.ENF_DT                                                   as ENF_DT
			       ,etccd.CD_NM                                                     as DISP_REQ_NM 
			       ,master.TIT_TXT                                                  as TIT_TXT
			       ,detail.PNL_DRIN_PSVT_AM                                         as PNL_DRIN_PSVT_AM
			       ,detail.NOP_CNT                                                  as NOP_CNT
			  from  TBBADEAR001M   master
			       ,TBBADEAR002D   detail
			       ,(select  relorg.AUD_YR  as AUD_YR
			                ,relorg.AUD_NO   as AUD_NO
			                ,relorg.DSP_RQ_SNO  as DSP_RQ_SNO
			                ,COUNT(*)         as CNT
			           from  TBBADEAR006M relorg
			                ,TBBADFRE009M prss
			          where  relorg.AUD_YR     = prss.AUD_YR
			            and  relorg.AUD_NO     = prss.AUD_NO
			            and  relorg.DSP_RQ_SNO = prss.DSP_RQ_SNO
			            and  relorg.RLTN_ORG_CD= prss.RLTN_ORG_CD
			          group by  relorg.AUD_YR
			                   ,relorg.AUD_NO
			                   ,relorg.DSP_RQ_SNO 
			        ) prsset
			       ,TBDCMACM015M   org1
			       ,TBDCMACM015M   org2
			       ,TBDCMACM013C   etccd
			 where  1=1
			       
	
			   and  detail.ENF_DT     between #strFromDt# and #strToDt# /*화면의 기간*/
			   and  detail.DTM_STA_CD    != '2'
			   and  prsset.CNT           >= #strPressCnt# /*화면의 인자값 독촉회수 1이상이면 :1,   독촉회수 2이상이면:2*/
			   and  master.AUD_YR      = detail.AUD_YR
			   and  master.AUD_NO      = detail.AUD_NO
			   and  master.DSP_RQ_SNO  = detail.DSP_RQ_SNO
			   and  master.AUD_YR      = prsset.AUD_YR
			   and  master.AUD_NO      = prsset.AUD_NO
			   and  master.DSP_RQ_SNO  = prsset.DSP_RQ_SNO
			   and  detail.COPT_OFI_CD = org1.ORG_CD
			   and  detail.RLTN_ORG_CD = org2.ORG_CD
			   and  master.DSP_RQ_KND_CD = etccd.CD
			   and  etccd.CMM_CD_DVSN_CD ='1000002'
			     ]]>
		<isNotEmpty prepend="AND" property="strOrgDvsn">
			master.ORG_DVSN_CD  = #strOrgDvsn#||'%' /*화면의 기관분류코드*/
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="strOrgEtcDvsn">
		 master.ORG_DVSN_CD NOT IN ('10','21','22','30')/*기타 선택시*/
		</isNotEmpty>
			   
			 order by  detail.COPT_OFI_CD
			          ,detail.RLTN_ORG_CD
	</select>	  


	<!-- 처분요구사항 집행현황 - 기관별  -->
	<select id="BADEAR019Qselect8_1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[   			

			WITH BASE AS (
			select   MAIN.ORG_DVSN_CD
			        ,DE04.DTM_STA_CD
			        ,DE04.ENFM_WHLS_DTM_DT
			        ,MAIN.DSP_RQ_KND_CD
			        ,DE04.PNL_DRIN_PSVT_AM
			        ,DE04.RSR_AM
			        ,DE04.SPLP_AM
			        ,DE04.NOP_CNT
			        ,CASE  SUBSTR(MAIN.ORG_DVSN_CD,1,1)  WHEN '1'  THEN '1' WHEN '2' THEN '2' WHEN '3' THEN '3' ELSE '4' END KIKAN_KBN
			        ,CASE WHEN NVL(DE04.DTM_STA_CD, '0') = '2' AND DE04.ENFM_WHLS_DTM_DT <= #strStdDt# THEN '1' /*집행완료*/
			              WHEN (NVL(DE04.DTM_STA_CD, '0') != '2' OR NVL(DE04.DTM_STA_CD, '0') = '2' AND DE04.ENFM_WHLS_DTM_DT > #strStdDt#) THEN '2' /*집행중*/
			         END JIBHANG_KBN
			        
			    from TBBADEAR001M   MAIN
			        ,TBBADEAR002D DE04
			    where 1=1
			      and MAIN.AUD_YR = DE04.AUD_YR
			      and MAIN.AUD_NO  = DE04.AUD_NO
			      and MAIN.DSP_RQ_SNO = DE04.DSP_RQ_SNO
			      and NVL(DE04.DTM_STA_CD, '0') != '0'
			      and DE04.ENF_DT BETWEEN  #strFromDt#  and  #strToDt#  /*화면 FROM ~TO*/
			      and ((NVL(DE04.DTM_STA_CD, '0') = '2' AND DE04.ENFM_WHLS_DTM_DT <= #strStdDt#) or /*기준일*/
			          ((NVL(DE04.DTM_STA_CD, '0') != '2' OR NVL(DE04.DTM_STA_CD, '0') = '2' AND DE04.ENFM_WHLS_DTM_DT > #strStdDt#))) /*기준일*/
			)
			,GROUP_BASE AS (
			 select
			             CASE WHEN GROUPING(KIKAN_KBN) = '1' THEN '0'
			             ELSE 
			                KIKAN_KBN
			             END AS CODE1
			            ,CASE WHEN GROUPING(CASE WHEN JIBHANG_KBN ='1' THEN '집행완료' 
			                                     WHEN JIBHANG_KBN ='2' THEN '집행중'
			                                END) = '1' THEN '계'
			             ELSE                   
			                  (CASE WHEN JIBHANG_KBN ='1' THEN '집행완료' 
			                        WHEN JIBHANG_KBN ='2' THEN '집행중'
			                   END)
			             END CODE2
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) IN ('1','2','3','4','5','6','8') then 1 else 0 end)  as SUM_CNT
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) IN ('1','2','3','4','5','6','8') then NVL(PNL_DRIN_PSVT_AM,0) else 0 end)  as SUM_PNL_DRIN_PSVT_AM
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) IN ('1','2','3','4','5','6','8') then (NVL(RSR_AM,0)+NVL(SPLP_AM,0)) else 0 end)  as SUM_RSTORTN_SPLP_AM
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) IN ('1','2','3','4','5','6','8') then NVL(NOP_CNT,0) else 0 end)  as SUM_NOP_CNT
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '1' then 1 else 0 end)  as CNT1
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '1' then NVL(PNL_DRIN_PSVT_AM,0) else 0 end)  as PNL_DRIN_PSVT_AM1
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '2' then 1 else 0 end)  as CNT2
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '2' then NVL(NOP_CNT,0) else 0 end)  as NOP_CNT1
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '3' then 1 else 0 end)  as CNT3
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '3' then NVL(PNL_DRIN_PSVT_AM,0) else 0 end)  as PNL_DRIN_PSVT_AM2
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '3' then (NVL(RSR_AM,0)+NVL(SPLP_AM,0)) else 0 end)  as RSTORTN_SPLP_AM1
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '4' then 1 else 0 end)  as CNT4
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '5' then 1 else 0 end)  as CNT5
			            , sum(case when DSP_RQ_KND_CD = '611' then 1 else 0 end)  as CNT6
			            , sum(case when DSP_RQ_KND_CD IN ('610','620','621','630','623','625') then 1 else 0 end)  as CNT7
			            , sum(case when DSP_RQ_KND_CD IN ('610','620','621','630','623','625') then NVL(NOP_CNT,0) else 0 end)  as NOP_CNT2
                        , sum(case when DSP_RQ_KND_CD IN ('810','820','830','840','850') then 1 else 0 end)  as CNT8 
                        , sum(case when DSP_RQ_KND_CD IN ('810','820','830','840','850') then NVL(NOP_CNT,0) else 0 end)  as NOP_CNT3  			            
			    from BASE
			    group by   rollup(KIKAN_KBN)
			              ,rollup(CASE WHEN JIBHANG_KBN ='1' THEN '집행완료' 
			                           WHEN JIBHANG_KBN ='2' THEN '집행중'
			                      END)
			    UNION ALL
			    SELECT to_char(LEVEL-1) CODE1
			           ,'집행률(%)' CODE2
			           ,0  as CNT1, 0  as SUM_CNT, 0  as SUM_PNL_DRIN_PSVT_AM, 0  as SUM_RSTORTN_SPLP_AM,
			            0  as SUM_NOP_CNT, 0  as PNL_DRIN_PSVT_AM1, 0  as CNT2, 0  as NOP_CNT1, 0  as CNT3, 0  as PNL_DRIN_PSVT_AM2,
			            0  as RSTORTN_SPLP_AM1, 0  as CNT4, 0  as CNT5, 0  as CNT6, 0  as CNT7, 0  as NOP_CNT2, 0 as CNT8 , 0  as NOP_CNT3
			     FROM DUAL
			   CONNECT BY LEVEL <=5
			)
			SELECT  DECODE(NVL(CODE1,'0'),'0', '전체합계', '1', '국가기관', '2' ,'자치단체','3','공공기관' ,'4' , '기타단체') AS CODE_NM
			       ,CODE1
			       ,CODE2               
			       ,SUM_CNT
			       ,SUM_PNL_DRIN_PSVT_AM
			       ,SUM_RSTORTN_SPLP_AM
			       ,SUM_NOP_CNT
			       ,CASE WHEN CODE2 = '집행률(%)' then /*집행완료 CNT1*100/계 CNT1*/
			           CASE WHEN lag(CNT1,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) = 0 THEN 0
			           ELSE
			            ROUND((lag(CNT1,2) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) *100)   /
			                   lag(CNT1,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)),2)
			           END
			        ELSE
			          CNT1
			        END AS CNT1 
			       ,PNL_DRIN_PSVT_AM1
			       ,CASE WHEN CODE2 = '집행률(%)' then /*집행완료 CNT2*100/계 CNT2*/
			           CASE WHEN lag(CNT2,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) = 0 THEN 0
			           ELSE
			            ROUND((lag(CNT2,2) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) *100)   /
			                   lag(CNT2,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)),2)
			           END
			        ELSE
			          CNT2
			        END AS CNT2
			       ,NOP_CNT1
			       ,CASE WHEN CODE2 = '집행률(%)' then /*집행완료 CNT3*100/계 CNT3*/
			           CASE WHEN lag(CNT3,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) = 0 THEN 0
			           ELSE
			            ROUND((lag(CNT3,2) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) *100)   /
			                   lag(CNT3,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)),2)
			           END
			        ELSE
			          CNT3
			        END AS CNT3
			       ,PNL_DRIN_PSVT_AM2
			       ,RSTORTN_SPLP_AM1
			       ,CNT4
			       ,CNT5
			       ,CNT6
			       ,CNT7
			       ,NOP_CNT2
                   ,CNT8 
                   ,NOP_CNT3			       
			FROM  GROUP_BASE A
			order by code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)

	     ]]>
	</select>
	

	<!-- 처분요구사항 집행현황 - 연도별  -->
	<select id="BADEAR019Qselect8_2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[ 
        			
			WITH BASE AS (
			select   MAIN.ORG_DVSN_CD
			        ,DE04.DTM_STA_CD
			        ,DE04.ENFM_WHLS_DTM_DT
			        ,MAIN.DSP_RQ_KND_CD
			        ,DE04.PNL_DRIN_PSVT_AM
			        ,DE04.RSR_AM
			        ,DE04.SPLP_AM
			        ,DE04.NOP_CNT
			        ,SUBSTR(DE04.ENF_DT ,1,4) as YYYY_KBN
			        ,CASE WHEN NVL(DE04.DTM_STA_CD, '0') = '2' AND DE04.ENFM_WHLS_DTM_DT <= #strStdDt#/*화면기준일자*/ THEN '1' /*집행완료*/
			              WHEN (NVL(DE04.DTM_STA_CD, '0') != '2' OR NVL(DE04.DTM_STA_CD, '0') = '2' AND DE04.ENFM_WHLS_DTM_DT > #strStdDt#/*화면기준일자*/) THEN '2' /*집행중*/
			         END JIBHANG_KBN
			        
			    from TBBADEAR001M   MAIN
			        ,TBBADEAR002D DE04
			    where 1=1
			      and MAIN.AUD_YR = DE04.AUD_YR
			      and MAIN.AUD_NO  = DE04.AUD_NO
			      and MAIN.DSP_RQ_SNO = DE04.DSP_RQ_SNO
			      and NVL(DE04.DTM_STA_CD, '0') != '0'
			      and DE04.ENF_DT BETWEEN #strFromDt#/*화면 FROM일자*/ and #strToDt# /*화면 TO일자*/
			      and ((NVL(DE04.DTM_STA_CD, '0') = '2' AND DE04.ENFM_WHLS_DTM_DT <= #strStdDt#/*화면기준일자*/) or 
			          ((NVL(DE04.DTM_STA_CD, '0') != '2' OR NVL(DE04.DTM_STA_CD, '0') = '2' AND DE04.ENFM_WHLS_DTM_DT > #strStdDt#/*화면기준일자*/))) 
			)
			,GROUP_BASE AS (
			 select
			             CASE WHEN GROUPING(YYYY_KBN) = '1' THEN '0'
			             ELSE 
			                YYYY_KBN
			             END AS CODE1
			            ,CASE WHEN GROUPING(CASE WHEN JIBHANG_KBN ='1' THEN '집행완료' 
			                                     WHEN JIBHANG_KBN ='2' THEN '집행중'
			                                END) = '1' THEN '계'
			             ELSE                   
			                  (CASE WHEN JIBHANG_KBN ='1' THEN '집행완료' 
			                        WHEN JIBHANG_KBN ='2' THEN '집행중'
			                   END)
			             END CODE2
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) IN ('1','2','3','4','5','6','8') then 1 else 0 end)  as SUM_CNT
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) IN ('1','2','3','4','5','6','8') then NVL(PNL_DRIN_PSVT_AM,0) else 0 end)  as SUM_PNL_DRIN_PSVT_AM
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) IN ('1','2','3','4','5','6','8') then (NVL(RSR_AM,0)+NVL(SPLP_AM,0)) else 0 end)  as SUM_RSTORTN_SPLP_AM
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) IN ('1','2','3','4','5','6','8') then NVL(NOP_CNT,0) else 0 end)  as SUM_NOP_CNT
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '1' then 1 else 0 end)  as CNT1
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '1' then NVL(PNL_DRIN_PSVT_AM,0) else 0 end)  as PNL_DRIN_PSVT_AM1
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '2' then 1 else 0 end)  as CNT2
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '2' then NVL(NOP_CNT,0) else 0 end)  as NOP_CNT1
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '3' then 1 else 0 end)  as CNT3
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '3' then NVL(PNL_DRIN_PSVT_AM,0) else 0 end)  as PNL_DRIN_PSVT_AM2
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '3' then (NVL(RSR_AM,0)+NVL(SPLP_AM,0)) else 0 end)  as RSTORTN_SPLP_AM1
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '4' then 1 else 0 end)  as CNT4
			            , sum(case when SUBSTR(DSP_RQ_KND_CD,1,1) = '5' then 1 else 0 end)  as CNT5
			            , sum(case when DSP_RQ_KND_CD = '611' then 1 else 0 end)  as CNT6
			            , sum(case when DSP_RQ_KND_CD IN ('610','620','621','630','623','625') then 1 else 0 end)  as CNT7
			            , sum(case when DSP_RQ_KND_CD IN ('610','620','621','630','623','625') then NVL(NOP_CNT,0) else 0 end)  as NOP_CNT2
                        , sum(case when DSP_RQ_KND_CD IN ('810','820','830','840','850') then 1 else 0 end)  as CNT8 
                        , sum(case when DSP_RQ_KND_CD IN ('810','820','830','840','850') then NVL(NOP_CNT,0) else 0 end)  as NOP_CNT3  			            
			    from BASE
			    group by   rollup(YYYY_KBN)
			              ,rollup(CASE WHEN JIBHANG_KBN ='1' THEN '집행완료' 
			                           WHEN JIBHANG_KBN ='2' THEN '집행중'
			                      END)
			    UNION ALL
			    SELECT to_char(decode(LEVEL-1,0,0,substr(#strFromDt#,1,4)/*화면FROM일자*/ + LEVEL-2))CODE1   
			           ,'집행률(%)' CODE2
			           ,0  as CNT1, 0  as SUM_CNT, 0  as SUM_PNL_DRIN_PSVT_AM, 0  as SUM_RSTORTN_SPLP_AM,
			            0  as SUM_NOP_CNT, 0  as PNL_DRIN_PSVT_AM1, 0  as CNT2, 0  as NOP_CNT1, 0  as CNT3, 0  as PNL_DRIN_PSVT_AM2,
			            0  as RSTORTN_SPLP_AM1, 0  as CNT4, 0  as CNT5, 0  as CNT6, 0  as CNT7, 0  as NOP_CNT2, 0 as CNT8 , 0  as NOP_CNT3
			     FROM DUAL
			   CONNECT BY LEVEL <= substr(#strToDt#,1,4) - substr(#strFromDt#,1,4) + 2 /*화면from~to일자    TO~FROM 으로 바인딩 */
			)
			SELECT  DECODE(NVL(CODE1,'0'),'0', '전체합계',CODE1 ) AS CODE_NM
			       ,CODE1
			       ,CODE2               
			       ,SUM_CNT
			       ,SUM_PNL_DRIN_PSVT_AM
			       ,SUM_RSTORTN_SPLP_AM
			       ,SUM_NOP_CNT
			       ,CASE WHEN CODE2 = '집행률(%)' then /*집행완료 CNT1*100/계 CNT1*/
			           CASE WHEN lag(CNT1,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) = 0 THEN 0
			           ELSE
			            ROUND((lag(CNT1,2) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) *100)   /
			                   lag(CNT1,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)),2)
			           END
			        ELSE
			          CNT1
			        END AS CNT1 
			       ,PNL_DRIN_PSVT_AM1
			       ,CASE WHEN CODE2 = '집행률(%)' then /*집행완료 CNT2*100/계 CNT2*/
			           CASE WHEN lag(CNT2,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) = 0 THEN 0
			           ELSE
			            ROUND((lag(CNT2,2) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) *100)   /
			                   lag(CNT2,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)),2)
			           END
			        ELSE
			          CNT2
			        END AS CNT2
			       ,NOP_CNT1
			       ,CASE WHEN CODE2 = '집행률(%)' then /*집행완료 CNT3*100/계 CNT3*/
			           CASE WHEN lag(CNT3,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) = 0 THEN 0
			           ELSE
			            ROUND((lag(CNT3,2) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)) *100)   /
			                   lag(CNT3,3) OVER(partition by code1 ORDER BY  code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)),2)
			           END
			        ELSE
			          CNT3
			        END AS CNT3
			       ,PNL_DRIN_PSVT_AM2
			       ,RSTORTN_SPLP_AM1
			       ,CNT4
			       ,CNT5
			       ,CNT6
			       ,CNT7
			       ,NOP_CNT2
                   ,CNT8  
                   ,NOP_CNT3			       
			FROM  GROUP_BASE A
			order by code1, decode(CODE2,'계',1,'집행완료',2, '집행중',3,'집행률(%)',4)

	     ]]>
	</select>
	
	
	<!-- 징계대상자별 집행현황 -->
	<select id="BADEAR019Qselect9" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[ 
        			
			SELECT  A.AUD_YR
			       ,A.AUD_NO
			       ,A.DSP_RQ_SNO
			       ,F_MNG_KND_AUDYRNO(A.AUD_YR, A.AUD_NO, C.AUD_KND_CD, '-') || '(' || A.DSP_RQ_SNO || ')'   
			                                                                                       AS TOT_DSP_RQ_NO /*처분번호*/
			       ,C.AUD_SBJ_NM                                                                                    /*감사사항명*/
			       ,TO_CHAR(TO_DATE(B.ENF_DT),'YYYY.MM.DD')                                        AS ENF_DT        /*시행일자*/
			       ,F_DPT_INFO(B.ENFM_MNG_BRDV_CD,'1') ENFM_MNG_BRDV_NM                                             /*집행관리국과*/
			       ,TIT_TXT                                                                                         /*처분요구제목*/
			       ,D2.HND_NM                                                                       AS HND_NM       /*조치요구*/ 
			       ,CASE WHEN D2.DFNT_SNO IS NOT NULL THEN D2.ENFM_SHP_NM ELSE D1.ENFM_SHP_NM END  AS ENFM_SHP_NM   /*집행형태*/
			       ,F_ORG_INFO(B.COPT_OFI_CD,'1') COPT_OFI_NM                                                       /*소관청*/       
			       ,F_ORG_INFO(D1.RLTN_ORG_CD,'1')                                                  AS RLTN_ORG_NM  /*관계기관*/
			       ,OCP_NM                                                                                          /*직종명*/
			       ,RANK_NM                                                                                         /*직급명*/
			       ,D2.DFNT_NAM                                                                     AS DFNT_NAM     /*이름*/
			       ,DECODE(B.DTM_STA_CD, '2', '확정', '1', DECODE(B.DSP_RQ_APV_STA_CD, '3', '완결', '미결') , '') AS DTM_YN_NM /*집행상태*/
			       ,TO_CHAR(TO_DATE(B.ENFM_WHLS_DTM_DT),'YYYY.MM.DD')                               AS ENFM_WHLS_DTM_DT      /*완결확정일*/
			    from TBBADEAR001M   A
			        ,TBBADEAR002D   B
			        ,TBBADDED001M   C
			        ,(
			            SELECT D1.AUD_YR 
			                 , D1.AUD_NO 
			                 , D1.DSP_RQ_SNO 
			                 , D1.RLTN_ORG_CD
			                 , D2.ENFM_SNO
			                 , D2.ENFM_DT                                           /*집행일*/
			                 , F_CODE_NM('1000003',D2.ENFM_SHP_CD) AS ENFM_SHP_NM   /*집행형태*/
			                 , DECODE(D1.CPLT_YN,'Y','O','X') AS CPLT_YN            /*완결여부*/
			              FROM TBBADEAR006M D1
			                 , TBBADFRE006M D2
			             WHERE 1=1
			               AND D1.AUD_YR        = D2.AUD_YR(+)
			               AND D1.AUD_NO        = D2.AUD_NO(+)
			               AND D1.DSP_RQ_SNO    = D2.DSP_RQ_SNO(+)    
			               AND D1.RLTN_ORG_CD   = D2.RLTN_ORG_CD(+)  
			          ) D1 /*관계기관*/
			        , (
			             SELECT D1.AUD_YR 
			                 , D1.AUD_NO 
			                 , D1.DSP_RQ_SNO 
			                 , D1.RLTN_ORG_CD
			                 , D1.DFNT_SNO
			                 , D1.DFNT_NAM
			                 , D1.HND_RQ_KND_CD
			                 , F_CODE_NM('1000011',D1.HND_RQ_KND_CD) AS HND_NM                 
			                 , F_CODE_NM('1000057',OCP_CD) OCP_NM
			                 , F_CODE_NM('1000058',RANK_CD) RANK_NM  
			                 , D2.ENFM_SNO
			                 , D2.ENFM_DT
			                 , F_CODE_NM('1000003',D2.ENFM_SHP_CD) AS ENFM_SHP_NM
			
			                 , D2.PNL_AM
			                 , DECODE(D1.CPLT_YN,'Y','O','X') AS CPLT_YN
			              FROM TBBADEAR007M D1 
			                 , TBBADFRE008M D2
			             WHERE 1=1
			               AND D1.AUD_YR        = D2.AUD_YR(+)
			               AND D1.AUD_NO        = D2.AUD_NO(+)
			               AND D1.DSP_RQ_SNO    = D2.DSP_RQ_SNO(+)    
			               AND D1.RLTN_ORG_CD   = D2.RLTN_ORG_CD(+) 
			               AND D1.DFNT_SNO      = D2.DFNT_SNO(+)   
			          ) D2 /*관계자*/
			    where 1=1
			      and A.AUD_YR       = B.AUD_YR
			      and A.AUD_NO       = B.AUD_NO
			      and A.DSP_RQ_SNO   = B.DSP_RQ_SNO
			      and A.AUD_YR       = C.AUD_YR
			      and A.AUD_NO       = C.AUD_NO
			      AND A.AUD_YR       = D1.AUD_YR
			      and A.AUD_NO       = D1.AUD_NO
			      and A.DSP_RQ_SNO   = D1.DSP_RQ_SNO
			      AND D1.AUD_YR      = D2.AUD_YR(+)
			      AND D1.AUD_NO      = D2.AUD_NO(+)
			      AND D1.DSP_RQ_SNO  = D2.DSP_RQ_SNO(+)    
			      AND D1.RLTN_ORG_CD = D2.RLTN_ORG_CD(+)      
			      AND B.DTM_STA_CD IN ('1','2')
			      AND B.ENF_DT BETWEEN  #strFromDt#  AND  #strToDt#  /*시행기간*/
			      AND B.ENFM_WHLS_DTM_DT <=  #strStdDt#  /*기준일자*/
			      ORDER BY AUD_YR DESC,
			               AUD_NO DESC,
			               DSP_RQ_SNO DESC
	     ]]>
	</select>	  		
</sqlMap> 

