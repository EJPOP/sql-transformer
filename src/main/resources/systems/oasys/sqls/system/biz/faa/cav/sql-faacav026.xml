<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/026">
	<select id="FAACAV026EMainSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/026/FAACAV026EMainSelect */ ]]>
		<include refid="include.pageSelct" />	
        <![CDATA[
			 SELECT 
			        A.COPT_CD || '-' || A.ACNT_CD || '-' || A.BLL_CD || '-' || A.PROF_DRTR_SRNO || '-' || A.DL_XPN_RCDB_PBSVT_SRNO AS ACCMN_ID,
			        A.COPT_CD,
			        A.ACNT_CD,
			        A.BLL_CD,
			        A.PROF_DRTR_SRNO,
			        A.DL_XPN_RCDB_PBSVT_SRNO,
			        F_ORG_INFO(A.ORG_CD,1) AS ORG_NM,
			        F_AV_BLL_COPT_CD_NM (A.COPT_CD) AS COPT_NM,
			        F_AV_ACNT_CD_NM (A.ACNT_CD) AS ACNT_NM,
			        CASE 
			        	WHEN (A.BLL_CD ='17' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '관서운영경비출납계산서'
						WHEN (A.BLL_CD='22' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '기금관서운영경비' 
						ELSE B.ACNT_CD_NM
					END BLL_NM,
					CASE WHEN A.CRE_DT = '000000' THEN ' ' ELSE
                              SUBSTR(A.CRE_DT,1,4) || '.' || SUBSTR(A.CRE_DT,5,2) || '.' || SUBSTR(A.CRE_DT,7,2) END AS CRE_DT,
                    CASE WHEN A.ABLT_DT = '999999' THEN ' ' ELSE     
                              SUBSTR(A.ABLT_DT,1,4) || '.' || SUBSTR(A.ABLT_DT,5,2) || '.' || SUBSTR(A.ABLT_DT,7,2) END AS ABLT_DT,
                    C.DPT_NM,
                    SUBSTR(A.MDF_DT,1,4)||'.'||SUBSTR(A.MDF_DT,5,2)||'.'||SUBSTR(A.MDF_DT,7,2) AS MDF_DT
			   FROM TWFAACAV003M A,
			        TWFAACAV024C B,
			        TBDCMACM002M C
			  WHERE A.BLL_CD = B.ACNT_CD
			    AND RPAD(A.BR_CD,3,'0') || RPAD(DIV_CD,3,'0') = C.DPT_CD (+ )
			    AND B.ACNT_DVSN_CD = '03'
		]]>
		<isNotEmpty property="strOrgNm">
				AND A.ORG_NM = #strOrgNm#
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isNotEmpty property="strOrgCd4">
				AND A.ORG_CD = #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
					</isNotEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
				AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'000' AND #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'999' 
					</isEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
				AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||'000000' AND #strOrgCd1#||#strOrgCd2#||'999999' 
					</isEmpty>
				</isEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
				AND A.ORG_CD BETWEEN #strOrgCd1#||'000000000' AND #strOrgCd1#||'999999999' 
					</isEmpty>
				</isEmpty>
			</isEmpty>
		</isNotEmpty>			  	
		<include refid="include.pageOrder" />
		   ORDER BY ACCMN_ID
	</select>
	
	<select id="FAACAV025EMainSelect"	parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[  /* faa/cav/026/FAACAV025EMainSelect */ ]]>
		<include refid="include.pageSelct" />	
        <![CDATA[
			 SELECT  
			        A.COPT_CD || '-' || A.ACNT_CD || '-' || A.BLL_CD || '-' || A.PROF_DRTR_SRNO || '-' || A.DL_XPN_RCDB_PBSVT_SRNO AS ACCMN_ID,
			        A.COPT_CD,
			        A.ACNT_CD,
			        A.BLL_CD,
			        A.PROF_DRTR_SRNO,
			        A.DL_XPN_RCDB_PBSVT_SRNO,
			        ORG_NM,
			        F_AV_BLL_COPT_CD_NM (A.COPT_CD) AS COPT_NM,
			        F_AV_ACNT_CD_NM (A.ACNT_CD) AS ACNT_NM,
			        CASE 
			        	WHEN (A.BLL_CD ='17' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '관서운영경비출납계산서'
						WHEN (A.BLL_CD='22' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '기금관서운영경비출납계산서' 
						ELSE B.ACNT_CD_NM
					END BLL_NM,
					CASE WHEN A.CRE_DT = '000000' THEN ' ' ELSE SUBSTR(A.CRE_DT,1,4) || '.' || SUBSTR(A.CRE_DT,5,2) || '.' || SUBSTR(A.CRE_DT,7,2) END CRE_DT,
                    CASE WHEN A.ABLT_DT = '999999' THEN ' ' ELSE SUBSTR(A.ABLT_DT,1,4) || '.' || SUBSTR(A.ABLT_DT,5,2) || '.' || SUBSTR(A.ABLT_DT,7,2) END ABLT_DT,
                    C.DPT_NM,
                    CASE WHEN SUBSTR(A.MDF_DT,1,4) = '0000' THEN ' ' ELSE SUBSTR(A.MDF_DT,1,4) || '.' || SUBSTR(A.MDF_DT,5,2) || '.' || SUBSTR(A.MDF_DT,7,2) END MDF_DT
			   FROM TWFAACAV003M A, 
			        TWFAACAV024C B,
			        TBDCMACM002M C
			  WHERE A.BLL_CD = B.ACNT_CD 
			    AND RPAD(A.BR_CD,3,'0') || RPAD(DIV_CD,3,'0') = C.DPT_CD (+ )
			    AND B.ACNT_DVSN_CD = '03'
		]]>
		
		<isNotEmpty property="strOrgNm">
				AND A.ORG_NM = #strOrgNm#
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isNotEmpty property="strOrgCd4">
						AND A.ORG_CD = #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
					</isNotEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
						AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'000' AND #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'999'  
					</isEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
						AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||'000000' AND #strOrgCd1#||#strOrgCd2#||'999999' 
					</isEmpty>
				</isEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
						AND A.ORG_CD BETWEEN #strOrgCd1#||'000000000' AND #strOrgCd1#||'999999999' 
					</isEmpty>
				</isEmpty>
			</isEmpty>
		</isNotEmpty>
		<isEqual property="strType" compareValue="D">
			AND MDF_DVSN_CD = #strType#
		</isEqual>
		<isNotEqual property="strType" compareValue="D">
			<isEqual property="strType" compareValue="">
				AND MDF_DVSN_CD != 'D'	
			</isEqual>
			<isNotEqual property="strType" compareValue="">
				AND MDF_DVSN_CD = #strType#
			</isNotEqual>
		</isNotEqual>
		<isNotEmpty property="strCoptCd">
				AND A.COPT_CD LIKE '%'||#strCoptCd#||'%'
		</isNotEmpty>
		<isNotEmpty property="strAcntCd">
				AND A.ACNT_CD LIKE '%'||#strAcntCd#||'%'
		</isNotEmpty>
		<isNotEmpty property="strBllCd">
	        <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
	            <isEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
	                AND A.DL_XPN_RCDB_PBSVT_SRNO = '000'
	                <isEqual property="strBllCd" compareValue="17">
	                    AND A.BLL_CD IN ('17','18')
	                </isEqual>
	                <isEqual property="strBllCd" compareValue="22">
	                    AND A.BLL_CD IN ('22','23','24')
	                </isEqual>
	                <isEqual property="strBllCd" compareValue="42">
	                    AND A.BLL_CD IN ('42','43')
	                </isEqual>
	                <isNotEmpty property="strBllCd">
	                    AND A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_CD 
	                                           ELSE #strBllCd#
	                                      END
	                </isNotEmpty>
	            </isEqual>
	            <isNotEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
	                AND A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	                <isEqual property="strBllCd" compareValue="17">
	                    AND A.BLL_CD IN ('17','18')
	                </isEqual>
	                <isEqual property="strBllCd" compareValue="22">
	                    AND A.BLL_CD IN ('22','23','24')
	                </isEqual>
	                <isNotEmpty property="strBllCd">
	                    AND A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN A.BLL_CD 
	                                           ELSE #strBllCd#
	                                      END
	                </isNotEmpty>
	            </isNotEqual>
	        </isNotEmpty>
	        <isEmpty property="strDlXpnRcdbPbsvtSrno">
	        	<isEqual property="strBllCd" compareValue="17">
                    AND A.BLL_CD IN ('17','18')
                </isEqual>
                <isEqual property="strBllCd" compareValue="22">
                    AND A.BLL_CD IN ('22','23','24')
                </isEqual>
                <isEqual property="strBllCd" compareValue="42">
                    AND A.BLL_CD IN ('42','43')
                </isEqual>
                <isNotEmpty property="strBllCd">
                    AND A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_CD 
                                           ELSE #strBllCd#
                                      END
                </isNotEmpty>
	        </isEmpty>
        </isNotEmpty>
		<isNotEmpty property="strProfDrtrSrno">
				AND A.PROF_DRTR_SRNO LIKE '%'||#strProfDrtrSrno#||'%'
		</isNotEmpty>
		<isNotEmpty property="strCreDt1">
				AND SUBSTR(A.CRE_DT,1,4) = #strCreDt1# 
		</isNotEmpty>
		<isNotEmpty property="strCreDt2">
				AND SUBSTR(A.CRE_DT,5,2) = #strCreDt2#
		</isNotEmpty>
		<isNotEmpty property="strAbltDt1">
				AND SUBSTR(A.ABLT_DT,1,7) LIKE '%'||#strAbltDt1#||#strAbltDt2#||'%' 
		</isNotEmpty>
		<isNotEmpty property="strDivCd">
				AND RPAD(A.DIV_CD,3,0) = #strDivCd#
		</isNotEmpty>
		<isNotEmpty property="strBrCd">
				AND RPAD(A.BR_CD,3,0) = #strBrCd#
		</isNotEmpty>
		<isNotEmpty property="strMdfDt1">
				AND SUBSTR(A.MDF_DT,1,4) >= #strMdfDt1#
		</isNotEmpty>
		<isNotEmpty property="strMdfDt2">
				AND SUBSTR(A.MDF_DT,5,2) >= #strMdfDt2#
		</isNotEmpty>
		<isNotEmpty property="strMdfDt3">
				AND SUBSTR(A.MDF_DT,7,2) >= #strMdfDt3#
		</isNotEmpty>
		<include refid="include.pageOrder" />	
		   ORDER BY ACCMN_ID
	</select>
	
	<select id="FAACAV026ESearchOrgCountSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/026/FAACAV026ESearchOrgCountSelect */ ]]>
	        SELECT  COUNT(1) AS COUNT,
	                MAX(A.ORG_NM) AS ORG_NM,
	                MAX(A.ORG_CD) AS ORG_CD,
	                MAX(A.BR_CD) AS BR_CD,
	                MAX(A.DIV_CD) AS DIV_CD
	        FROM    (
	                SELECT  B.ORG_CD,
	                        B.ORG_NM,
	                        SUBSTR(B.ENFM_DPT_CD,1,3) AS BR_CD,
	                        SUBSTR(B.ENFM_DPT_CD,4,3) AS DIV_CD,
	                        COPT_SG_CD,
	                        USE_DVSN_NO
	                FROM    TBDCMACM015M B LEFT OUTER JOIN (    SELECT  COPT_SG_CD || '000000000' COPT_SG_CD_A
			                                                    FROM    TBDCMACM015M A
			                                                    WHERE   ORG_CD LIKE '___000000000'
			                                                    GROUP BY COPT_SG_CD) A ON (B.ORG_CD = A.COPT_SG_CD_A) ) A
	        WHERE   1=1
	        AND     USE_DVSN_NO = 'Y'
	    <isNotEmpty property="strOrgCd1" prepend="AND">
		      SUBSTRING(A.ORG_CD,0,3) LIKE '%' || #strOrgCd1# || '%' <!-- 기관코드 -->
		</isNotEmpty>	
	    <isNotEmpty property="strOrgCd2" prepend="AND">
	          SUBSTRING(A.ORG_CD,4,3) LIKE '%' || #strOrgCd2# || '%' <!-- 기관코드 -->
	    </isNotEmpty>
	    <isNotEmpty property="strOrgCd3" prepend="AND">
			  SUBSTRING(A.ORG_CD,7,3) LIKE '%' || #strOrgCd3# || '%' <!-- 기관코드 -->
	    </isNotEmpty>
	    <isNotEmpty property="strOrgCd4" prepend="AND">
	    	  SUBSTRING(A.ORG_CD,10,3) LIKE '%' || #strOrgCd4# || '%' <!-- 기관코드 -->
	    </isNotEmpty>
		<isNotEmpty property="strOrgNm" prepend="AND">
			  A.ORG_NM LIKE '%' || #strOrgNm# || '%' <!-- 기관명 -->
		</isNotEmpty>
	</select>
	
	
	<select id="FAACAV027EMainSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/026/FAACAV027EMainSelect */ ]]>
		<include refid="include.pageSelct" />	
        <![CDATA[
			 SELECT 
			        A.COPT_CD || '-' || A.ACNT_CD || '-' || A.BLL_CD || '-' || A.PROF_DRTR_SRNO || '-' || A.DL_XPN_RCDB_PBSVT_SRNO AS ACCMN_ID,
			        A.COPT_CD,
			        A.ACNT_CD,
			        A.BLL_CD,
			        A.PROF_DRTR_SRNO,
			        A.DL_XPN_RCDB_PBSVT_SRNO,
			        F_ORG_INFO(A.ORG_CD,1) AS ORG_NM,
			        F_AV_BLL_COPT_CD_NM (A.COPT_CD) AS COPT_NM,
			        F_AV_ACNT_CD_NM (A.ACNT_CD) AS ACNT_NM,
			        CASE 
			        	WHEN (A.BLL_CD ='17' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '관서운영경비출납계산서'
						WHEN (A.BLL_CD='22' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '기금관서운영경비' 
						ELSE B.ACNT_CD_NM
					END BLL_NM,
					CASE WHEN A.CRE_DT = '000000' THEN ' ' ELSE
                              SUBSTR(A.CRE_DT,1,4) || '.' || SUBSTR(A.CRE_DT,5,2) || '.' || SUBSTR(A.CRE_DT,7,2) END AS CRE_DT,
                    CASE WHEN A.ABLT_DT = '999999' THEN ' ' ELSE     
                              SUBSTR(A.ABLT_DT,1,4) || '.' || SUBSTR(A.ABLT_DT,5,2) || '.' || SUBSTR(A.ABLT_DT,7,2) END AS ABLT_DT,
                    C.DPT_NM,
                    SUBSTR(A.MDF_DT,1,4)||'.'||SUBSTR(A.MDF_DT,5,2)||'.'||SUBSTR(A.MDF_DT,7,2) AS MDF_DT
			   FROM TWFAACAV003M A,
			        TWFAACAV024C B,
			        TBDCMACM002M C
			  WHERE A.BLL_CD = B.ACNT_CD
			    AND RPAD(A.BR_CD,3,'0') || RPAD(DIV_CD,3,'0') = C.DPT_CD (+ )
			    AND B.ACNT_DVSN_CD = '03'
		]]>		  	
		
		<isEqual property="strFildSsecYn" compareValue="N">
	        AND     A.DL_XPN_RCDB_PBSVT_SRNO = '000'
	    </isEqual>
	    <isEqual property="strFildSsecYn" compareValue="Y">
	        AND     A.DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
	    </isEqual>
		
        <isEqual property="strBllCd" compareValue="17">
            AND     A.BLL_CD IN ('17','18')
        </isEqual>
        <isEqual property="strBllCd" compareValue="22">
            AND     A.BLL_CD IN ('22','23','24')
        </isEqual>
        <isEqual property="strBllCd" compareValue="42">
            AND     A.BLL_CD IN ('42','43')
        </isEqual>
        <isNotEmpty property="strBllCd">
            AND     A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_CD 
                                    ELSE #strBllCd#
                               END
        </isNotEmpty>
	    
		<isEqual property="dayDiv" compareValue="01">
			<isEqual property="strDiv" compareValue="1">
				<isEmpty property="strMm">
					AND A.CRE_DT BETWEEN #strYy#||'00' AND #strYy# ||'13'
				</isEmpty>
				<isNotEmpty property="strMm">
					AND A.CRE_DT = #strYy#||#strMm#
				</isNotEmpty>
			</isEqual>
			
			<isEqual property="strDiv" compareValue="2">
				<isEmpty property="strMm">
					AND A.ABLT_DT BETWEEN #strYy#||'00' AND #strYy# ||'13'
				</isEmpty>
				<isNotEmpty property="strMm">
					AND A.ABLT_DT = #strYy#||#strMm#
				</isNotEmpty>
			</isEqual>
			  
			<isEqual property="strDiv" compareValue="0">
				AND (A.CRE_DT  BETWEEN #strYy#||'00' AND #strYy#||'13'
				OR  A.ABLT_DT BETWEEN #strYy#||'00' AND #strYy#||'13')
			</isEqual>
		</isEqual>
		
		<isEqual property="dayDiv" compareValue="03">
			<isEqual property="strDiv" compareValue="1">				
				<isEmpty property="strMm">
					AND A.CRE_DT BETWEEN #strYy#||'00' AND #strYy# ||'13'
				</isEmpty>
						
				<isNotEmpty property="strMm">
					<isEqual property="strMm" compareValue="01">
						AND A.CRE_DT BETWEEN #strYy#||'01' AND #strYy#||'03'
					</isEqual>
					<isEqual property="strMm" compareValue="02">
						AND A.CRE_DT BETWEEN #strYy#||'04' AND #strYy#||'06'
					</isEqual>
					<isEqual property="strMm" compareValue="03">
						AND A.CRE_DT BETWEEN #strYy#||'07' AND #strYy#||'09'
					</isEqual>
					<isEqual property="strMm" compareValue="04">
						AND A.CRE_DT BETWEEN #strYy#||'10' AND #strYy#||'13'
					</isEqual>
				</isNotEmpty>
			</isEqual>
			
			<isEqual property="strDiv" compareValue="2">
				<isEmpty property="strMm">
					AND A.ABLT_DT BETWEEN #strYy#||'00' AND #strYy# ||'13'
				</isEmpty>
				
				<isNotEmpty property="strMm">
					<isEqual property="strMm" compareValue="01">
						AND A.ABLT_DT BETWEEN #strYy#||'01' AND #strYy#||'03'
					</isEqual>
					<isEqual property="strMm" compareValue="02">
						AND A.ABLT_DT BETWEEN #strYy#||'04' AND #strYy#||'06'
					</isEqual>
					<isEqual property="strMm" compareValue="03">
						AND A.ABLT_DT BETWEEN #strYy#||'07' AND #strYy#||'09'
					</isEqual>
					<isEqual property="strMm" compareValue="04">
						AND A.ABLT_DT BETWEEN #strYy#||'10' AND #strYy#||'13'
					</isEqual>
				</isNotEmpty>
			</isEqual>
			
			<isEqual property="strDiv" compareValue="0">
				AND (A.CRE_DT  BETWEEN #strYy#||'00' AND #strYy#||'13'
				OR  A.ABLT_DT BETWEEN #strYy#||'00' AND #strYy#||'13')
			</isEqual>
		</isEqual>
		
		<isEqual property="dayDiv" compareValue="05">
			<isEqual property="strDiv" compareValue="1">
				AND A.CRE_DT LIKE '%'|| #strYy# ||'%'
			</isEqual>  
			<isEqual property="strDiv" compareValue="2">
				AND A.ABLT_DT LIKE '%'|| #strYy# ||'%'
			</isEqual>  
			<isEqual property="strDiv" compareValue="0">
				AND (A.CRE_DT  BETWEEN #strYy#||'00' AND #strYy#||'13'
				OR  A.ABLT_DT BETWEEN #strYy#||'00' AND #strYy#||'13')
			</isEqual>  
		</isEqual>
		
		<include refid="include.pageOrder" />
		 ORDER BY ACCMN_ID
	</select>
	
	<select id="FAACAV027EReportSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/026/FAACAV027EReportSelect */ ]]>
        <![CDATA[
			 SELECT 
			        A.COPT_CD || '-' || A.ACNT_CD || '-' || A.BLL_CD || '-' || A.PROF_DRTR_SRNO || '-' || A.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호,
			        F_ORG_INFO(A.ORG_CD,1) AS 기관명,
			        F_AV_BLL_COPT_CD_NM (A.COPT_CD) AS 소관명,
			        F_AV_ACNT_CD_NM (A.ACNT_CD) AS 회계명,
			        CASE 
			        	WHEN (A.BLL_CD ='17' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '관서운영경비출납계산서'
						WHEN (A.BLL_CD='22' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '기금관서운영경비' 
						ELSE B.ACNT_CD_NM
					END 계산서명,          			
          			CASE WHEN A.CRE_DT = '000000' THEN '' ELSE
                              SUBSTR(A.CRE_DT,1,4) || '.' || SUBSTR(A.CRE_DT,5,2) || '.' || SUBSTR(A.CRE_DT,7,2) END AS 신설일자,
                    CASE WHEN A.ABLT_DT = '999999' THEN '' ELSE     
                              SUBSTR(A.ABLT_DT,1,4) || '.' || SUBSTR(A.ABLT_DT,5,2) || '.' || SUBSTR(A.ABLT_DT,7,2) END AS 폐지일자
			   FROM TWFAACAV003M A,
			        TWFAACAV024C B,
			        TBDCMACM002M C
			  WHERE A.BLL_CD = B.ACNT_CD
			    AND RPAD(A.BR_CD,3,'0') || RPAD(DIV_CD,3,'0') = C.DPT_CD (+)
			    AND B.ACNT_DVSN_CD = '03'
		]]>		  	
		
			<isNotEqual property="strBllCd" compareValue="22">
			<isNotEqual property="strBllCd" compareValue="17">
				<isNotEqual property="strBllCd" compareValue="42">
				AND A.BLL_CD = #strBllCd#
				</isNotEqual>
			</isNotEqual>
		</isNotEqual>
			 
		<isEqual property="strBllCd" compareValue="22">
			 AND A.BLL_CD IN ('22','23','24')
		</isEqual>
		<isEqual property="strBllCd" compareValue="17">
			 AND A.BLL_CD IN ('17','18')
		</isEqual>	
		<isEqual property="strBllCd" compareValue="42">
			 AND A.BLL_CD IN ('42','43')
		</isEqual>	
			
		<isEqual property="dayDiv" compareValue="01">
			<isEqual property="strDiv" compareValue="1">
				<isEmpty property="strMm">
					AND A.CRE_DT LIKE '%'|| #strYy# ||'%'
				</isEmpty>
				<isNotEmpty property="strMm">
					AND A.CRE_DT BETWEEN #strYy#||#strMm# AND #strYy#||#strMm#
				</isNotEmpty>
			</isEqual>
			  
			<isEqual property="strDiv" compareValue="2">
				<isEmpty property="strMm">
					AND A.ABLT_DT LIKE '%'|| #strYy# ||'%'
				</isEmpty>
				<isNotEmpty property="strMm">
					AND A.ABLT_DT BETWEEN #strYy#||#strMm# AND #strYy#||#strMm#
				</isNotEmpty>
			</isEqual>
			  
			<isEqual property="strDiv" compareValue="0">
				AND A.CRE_DT BETWEEN '0000'||'00' AND '9999'||'99'
			</isEqual>  
	
		</isEqual>
		
		<isEqual property="dayDiv" compareValue="03">

			<isEqual property="strDiv" compareValue="1">
			
				<isNotEqual property="strBllCd" compareValue="22">
					<isEmpty property="strMm">
						AND A.CRE_DT LIKE '%'|| #strYy# ||'%'
					</isEmpty>
				
					<isNotEmpty property="strMm">
						<isEqual property="strMm" compareValue="01">
							AND A.CRE_DT BETWEEN #strYy#||'01' AND #strYy#||'03'
						</isEqual>
						<isEqual property="strMm" compareValue="02">
							AND A.CRE_DT BETWEEN #strYy#||'04' AND #strYy#||'06'
						</isEqual>
						<isEqual property="strMm" compareValue="03">
							AND A.CRE_DT BETWEEN #strYy#||'07' AND #strYy#||'09'
						</isEqual>
						<isEqual property="strMm" compareValue="04">
							AND A.CRE_DT BETWEEN #strYy#||'10' AND #strYy#||'12'
						</isEqual>
					</isNotEmpty>
				</isNotEqual>
				
				<isEqual property="strBllCd" compareValue="22">
					<isEqual property="strChk" compareValue="N">
						<isEmpty property="strMm">
								AND A.CRE_DT LIKE '%'|| #strYy# ||'%'
						</isEmpty>
						
						<isNotEmpty property="strMm">
							<isEqual property="strMm" compareValue="01">
								AND A.CRE_DT BETWEEN #strYy#||'01' AND #strYy#||'03'
							</isEqual>
							<isEqual property="strMm" compareValue="02">
								AND A.CRE_DT BETWEEN #strYy#||'04' AND #strYy#||'06'
							</isEqual>
							<isEqual property="strMm" compareValue="03">
								AND A.CRE_DT BETWEEN #strYy#||'07' AND #strYy#||'09'
							</isEqual>
							<isEqual property="strMm" compareValue="04">
								AND A.CRE_DT BETWEEN #strYy#||'10' AND #strYy#||'12'
							</isEqual>
						</isNotEmpty>
					</isEqual>
					
					<isEqual property="strChk" compareValue="Y">
						<isEmpty property="strMm">
							AND A.CRE_DT LIKE '%'|| #strYy# ||'%'
						</isEmpty>
					
						<isNotEmpty property="strMm">
							AND A.CRE_DT BETWEEN #strYy#||#strMm# AND #strYy#||#strMm#
						</isNotEmpty>
					</isEqual>
				</isEqual>
			</isEqual>
		</isEqual>
			
		<isEqual property="strDiv" compareValue="2">
		
			<isNotEqual property="strBllCd" compareValue="22">
				<isEmpty property="strMm">
					AND A.ABLT_DT LIKE '%'|| #strYy# ||'%'
				</isEmpty>
			
				<isNotEmpty property="strMm">
					<isEqual property="strMm" compareValue="01">
						AND A.ABLT_DT BETWEEN #strYy#||'01' AND #strYy#||'03'
					</isEqual>
					<isEqual property="strMm" compareValue="02">
						AND A.ABLT_DT BETWEEN #strYy#||'04' AND #strYy#||'06'
					</isEqual>
					<isEqual property="strMm" compareValue="03">
						AND A.ABLT_DT BETWEEN #strYy#||'07' AND #strYy#||'09'
					</isEqual>
					<isEqual property="strMm" compareValue="04">
						AND A.ABLT_DT BETWEEN #strYy#||'10' AND #strYy#||'12'
					</isEqual>
				</isNotEmpty>
			</isNotEqual>
			
			<isEqual property="strBllCd" compareValue="22">
				<isEqual property="strChk" compareValue="N">
					<isEmpty property="strMm">
							AND A.ABLT_DT LIKE '%'|| #strYy# ||'%'
					</isEmpty>
					
					<isNotEmpty property="strMm">
						<isEqual property="strMm" compareValue="01">
							AND A.ABLT_DT BETWEEN #strYy#||'01' AND #strYy#||'03'
						</isEqual>
						<isEqual property="strMm" compareValue="02">
							AND A.ABLT_DT BETWEEN #strYy#||'04' AND #strYy#||'06'
						</isEqual>
						<isEqual property="strMm" compareValue="03">
							AND A.ABLT_DT BETWEEN #strYy#||'07' AND #strYy#||'09'
						</isEqual>
						<isEqual property="strMm" compareValue="04">
							AND A.ABLT_DT BETWEEN #strYy#||'10' AND #strYy#||'12'
						</isEqual>
					</isNotEmpty>
				</isEqual>
				
				<isEqual property="strChk" compareValue="Y">
					<isEmpty property="strMm">
						AND A.ABLT_DT LIKE '%'|| #strYy# ||'%'
					</isEmpty>
				
					<isNotEmpty property="strMm">
						AND A.ABLT_DT BETWEEN #strYy#||#strMm# AND #strYy#||#strMm#
					</isNotEmpty>
				</isEqual>
			</isEqual>
			
			<isEqual property="strDiv" compareValue="0">
				AND A.CRE_DT BETWEEN '0000'||'01' AND '9999'||'12'
			</isEqual>
			
		</isEqual>
			
		<isEqual property="dayDiv" compareValue="05">
			<isEqual property="strDiv" compareValue="1">
				AND A.CRE_DT LIKE '%'|| #strYy# ||'%'
			</isEqual>  
			<isEqual property="strDiv" compareValue="2">
				AND A.ABLT_DT LIKE '%'|| #strYy# ||'%'
			</isEqual>  
			<isEqual property="strDiv" compareValue="0">
				AND A.CRE_DT BETWEEN '0000'||'01' AND '9999'||'12'
			</isEqual>  
		</isEqual>
		
		<isNotEmpty property="strChk">
			<isEqual property="strChk" compareValue="N">
				AND A.DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>
			<isEqual property="strChk" compareValue="Y">
				AND A.DL_XPN_RCDB_PBSVT_SRNO != '000'
			</isEqual>
		</isNotEmpty>
		ORDER BY 증명책임자부호
	</select>

	<select id="FAACAV025EReportSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/026/FAACAV025EReportSelect */ ]]>
        <![CDATA[
 			SELECT  
			        A.COPT_CD || '-' || A.ACNT_CD || '-' || A.BLL_CD || '-' || A.PROF_DRTR_SRNO || '-' || A.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호,
			        ORG_NM AS 기관명,
			        F_AV_BLL_COPT_CD_NM (A.COPT_CD) AS 소관명,
			        F_AV_ACNT_CD_NM (A.ACNT_CD) AS 회계명,
			        CASE 
			        	WHEN (A.BLL_CD ='17' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '관서운영경비출납계산서'
						WHEN (A.BLL_CD='22' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '기금관서운영경비' 
						ELSE B.ACNT_CD_NM
					END 계산서명,
					CASE WHEN A.CRE_DT = '000000' THEN ' ' ELSE SUBSTR(A.CRE_DT,1,4) || '.' || SUBSTR(A.CRE_DT,5,2) || '.' || SUBSTR(A.CRE_DT,7,2) END 신설일자,
                    CASE WHEN A.ABLT_DT = '999999' THEN ' ' ELSE SUBSTR(A.ABLT_DT,1,4) || '.' || SUBSTR(A.ABLT_DT,5,2) || '.' || SUBSTR(A.ABLT_DT,7,2) END 폐지일자,
                    F_DPT_INFO (RPAD(A.BR_CD,3,'0')||RPAD(A.DIV_CD,3,'0'), '1') AS 담당국과명,
                    CASE WHEN SUBSTR(A.MDF_DT,1,4) = '0000' THEN ' ' ELSE SUBSTR(A.MDF_DT,1,4) || '.' || SUBSTR(A.MDF_DT,5,2) || '.' || SUBSTR(A.MDF_DT,7,2) END MDF_DT
			   FROM TWFAACAV003M A, 
			        TWFAACAV024C B,
			        TBDCMACM002M C
			  WHERE A.BLL_CD = B.ACNT_CD 
			  	AND RPAD(A.BR_CD, 3, '0') || RPAD(DIV_CD, 3, '0') = C.DPT_CD (+ )
			    AND B.ACNT_DVSN_CD = '03'
		]]>
		<isNotEqual property="strType" compareValue="D">
			<isEqual property="strType" compareValue="">
				AND MDF_DVSN_CD != 'D'	
			</isEqual>
			<isNotEqual property="strType" compareValue="">
				AND MDF_DVSN_CD = #strType#
			</isNotEqual>
		</isNotEqual>
		<isNotEmpty property="strOrgNm">
				AND A.ORG_NM = #strOrgNm#
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isNotEmpty property="strOrgCd4">
						AND A.ORG_CD = #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
					</isNotEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
						AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'000' AND #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'999'  
					</isEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
						AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||'000000' AND #strOrgCd1#||#strOrgCd2#||'999999' 
					</isEmpty>
				</isEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
						AND A.ORG_CD BETWEEN #strOrgCd1#||'000000000' AND #strOrgCd1#||'999999999' 
					</isEmpty>
				</isEmpty>
			</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="strCoptCd">
				AND A.COPT_CD LIKE '%'||#strCoptCd#||'%'
		</isNotEmpty>
		<isNotEmpty property="strAcntCd">
				AND A.ACNT_CD LIKE '%'||#strAcntCd#||'%'
		</isNotEmpty>
		<isNotEmpty property="strBllCd">
	        <isNotEmpty property="strDlXpnRcdbPbsvtSrno">
	            <isEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
	                AND A.DL_XPN_RCDB_PBSVT_SRNO = '000'
	                <isEqual property="strBllCd" compareValue="17">
	                    AND A.BLL_CD IN ('17','18')
	                </isEqual>
	                <isEqual property="strBllCd" compareValue="22">
	                    AND A.BLL_CD IN ('22','23','24')
	                </isEqual>
	                <isEqual property="strBllCd" compareValue="42">
	                    AND A.BLL_CD IN ('42','43')
	                </isEqual>
	                <isNotEmpty property="strBllCd">
	                    AND A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_CD 
	                                           ELSE #strBllCd#
	                                      END
	                </isNotEmpty>
	            </isEqual>
	            <isNotEqual property="strDlXpnRcdbPbsvtSrno" compareValue="000">
	                AND A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	                <isEqual property="strBllCd" compareValue="17">
	                    AND A.BLL_CD IN ('17','18')
	                </isEqual>
	                <isEqual property="strBllCd" compareValue="22">
	                    AND A.BLL_CD IN ('22','23','24')
	                </isEqual>
	                <isNotEmpty property="strBllCd">
	                    AND A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22') THEN A.BLL_CD 
	                                           ELSE #strBllCd#
	                                      END
	                </isNotEmpty>
	            </isNotEqual>
	        </isNotEmpty>
	        <isEmpty property="strDlXpnRcdbPbsvtSrno">
	        	<isEqual property="strBllCd" compareValue="17">
                    AND A.BLL_CD IN ('17','18')
                </isEqual>
                <isEqual property="strBllCd" compareValue="22">
                    AND A.BLL_CD IN ('22','23','24')
                </isEqual>
                <isEqual property="strBllCd" compareValue="42">
                    AND A.BLL_CD IN ('42','43')
                </isEqual>
                <isNotEmpty property="strBllCd">
                    AND A.BLL_CD = CASE WHEN #strBllCd# IN ('17','22','42') THEN A.BLL_CD 
                                           ELSE #strBllCd#
                                      END
                </isNotEmpty>
	        </isEmpty>
        </isNotEmpty>
		<isNotEmpty property="strProfDrtrSrno">
				AND A.PROF_DRTR_SRNO LIKE '%'||#strProfDrtrSrno#||'%'
		</isNotEmpty>
		<isNotEmpty property="strDlXpnRcdbPbsvtSrno">
				AND A.DL_XPN_RCDB_PBSVT_SRNO LIKE '%'||#strDlXpnRcdbPbsvtSrno#||'%'
		</isNotEmpty>
		<isNotEmpty property="strCreDt1">
				AND SUBSTR(A.CRE_DT,1,4) = #strCreDt1# 
		</isNotEmpty>
		<isNotEmpty property="strCreDt2">
				AND SUBSTR(A.CRE_DT,5,2) = #strCreDt2#
		</isNotEmpty>
		<isNotEmpty property="strAbltDt1">
				AND SUBSTR(A.ABLT_DT,1,7) LIKE '%'||#strAbltDt1#||#strAbltDt2#||'%' 
		</isNotEmpty>
		<isNotEmpty property="strDivCd">
				AND RPAD(A.DIV_CD,3,0) = #strDivCd#
		</isNotEmpty>
		<isNotEmpty property="strBrCd">
				AND RPAD(A.BR_CD,3,0) = #strBrCd#
		</isNotEmpty>
		<isNotEmpty property="strMdfDt1">
				AND SUBSTR(A.MDF_DT,1,4) >= #strMdfDt1#
		</isNotEmpty>
		<isNotEmpty property="strMdfDt2">
				AND SUBSTR(A.MDF_DT,5,2) >= #strMdfDt2#
		</isNotEmpty>
		<isNotEmpty property="strMdfDt3">
				AND SUBSTR(A.MDF_DT,7,2) >= #strMdfDt3#
		</isNotEmpty>
		ORDER BY 증명책임자부호
	</select>
	
	<select id="FAACAV026EReportSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/026/FAACAV026EReportSelect */ ]]>
        <![CDATA[
			SELECT * FROM ( SELECT T.*,COUNT(1) OVER ( ) AS 총계
 			 FROM (
				 SELECT 
				        A.COPT_CD || '-' || A.ACNT_CD || '-' || A.BLL_CD || '-' || A.PROF_DRTR_SRNO || '-' || A.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호,
				        F_AV_BLL_COPT_CD_NM (A.COPT_CD) AS 소관명,
				        F_AV_ACNT_CD_NM (A.ACNT_CD) AS 회계명,
				        CASE 
				        	WHEN (A.BLL_CD ='17' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
								THEN '관서운영경비출납계산서'
							WHEN (A.BLL_CD='22' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
								THEN '기금관서운영경비' 
							ELSE B.ACNT_CD_NM
						END 계산서명,
						NVL(C.DPT_NM,' ') AS 담당국과,
						ORG_NM AS 기관명 
				   FROM TWFAACAV003M A,
				        TWFAACAV024C B,
				        TBDCMACM002M C
				  WHERE A.BLL_CD = B.ACNT_CD
				    AND RPAD(A.BR_CD,3,'0') || RPAD(DIV_CD,3,'0') = C.DPT_CD (+ )
				    AND B.ACNT_DVSN_CD = '03'
		]]>
		<isNotEmpty property="strOrgNm">
				AND A.ORG_NM = #strOrgNm#
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isNotEmpty property="strOrgCd4">
				AND A.ORG_CD = #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
					</isNotEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
				AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'000' AND #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'999' 
					</isEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
				AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||'000000' AND #strOrgCd1#||#strOrgCd2#||'999999' 
					</isEmpty>
				</isEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
				AND A.ORG_CD BETWEEN #strOrgCd1#||'000000000' AND #strOrgCd1#||'999999999' 
					</isEmpty>
				</isEmpty>
			</isEmpty>
		</isNotEmpty>			  	
		   ORDER BY 증명책임자부호 ) T )
	</select>
	
	
	<select id="FAACAV026ECancelChk" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/026/FAACAV026ECancelChk */ ]]>
		SELECT DISTINCT COPT_CD 
		FROM TWFAACAV002H
		WHERE COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
			AND PROF_YM >= REPLACE(#strCreDt#,'.','')
	</select>
	
	
	<update id="FAACAV026ECancel" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/026/FAACAV026ECancel */ ]]>
		UPDATE TWFAACAV003M
		SET MDF_DVSN_CD = 'D'
			,DOC_ENF_DT = #strDocDt1# || #strDocDt2# || #strDocDt3#
			,DOC_ENF_NO = #strDocEnfNo#
			,MDF_DT = #strMdfDt1# || #strMdfDt2# || #strMdfDt3#
			,ABLT_DT = #strCreDt1# || #strCreDt2#
			,ENS_USE_YN = 'N'
		WHERE COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</update>
	
	<update id="FAACAV026EDelete" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/026/FAACAV026EDelete */ ]]>
		DELETE TWFAACAV007M
		WHERE COPT_CD = #strCoptCd#
			AND ACNT_CD = #strAcntCd#
			AND BLL_CD = #strBllCd#
			AND PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno# 
	</update>
	
	<select id="FAACAV025EMainSelectForCsv"	parameterClass="paramMap"	resultClass="resultMap">
	<include refid="include.pageSelct" />
	<![CDATA[
			 SELECT 
			 		A.COPT_CD,
			 		A.ACNT_CD,
			 		A.BLL_CD,
			 		A.PROF_DRTR_SRNO,
			 		A.DL_XPN_RCDB_PBSVT_SRNO,
			        A.COPT_CD || '-' || A.ACNT_CD || '-' || A.BLL_CD || '-' || A.PROF_DRTR_SRNO || '-' || A.DL_XPN_RCDB_PBSVT_SRNO AS ACCMN_ID, /*증명자부호*/
			        ORG_NM,																						/*기관명*/
			        F_AV_BLL_COPT_CD_NM (A.COPT_CD) AS COPT_CD_NM,												/*소관명*/
			        F_AV_ACNT_CD_NM (A.ACNT_CD) AS ACNT_CD_NM,													/*회계명*/
			        CASE 
			        	WHEN (A.BLL_CD ='17' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '관서운영경비출납계산서'
						WHEN (A.BLL_CD='22' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '기금관서운영경비출납계산서' 
						ELSE B.ACNT_CD_NM
					END BLL_NM,																					/*계산서명*/
			        CASE
			         WHEN A.CRE_DT = '000000' THEN ' '
			         ELSE SUBSTR(A.CRE_DT, 1, 4) || '.' || SUBSTR(A.CRE_DT, 5, 2) || '.' || SUBSTR(A.CRE_DT, 7, 2)
			        END CRE_DT,																					/*지정년월*/
			        CASE
			         WHEN A.ABLT_DT = '999999' THEN ' '
			         ELSE SUBSTR(A.ABLT_DT, 1, 4) || '.' || SUBSTR(A.ABLT_DT, 5, 2) || '.' || SUBSTR(A.ABLT_DT, 7, 2)
			        END ABLT_DT,																				/*폐지년월*/
			        PST_NM,																						/*증명책임자 직위*/
			        SUBSTR(A.MDF_DT,1,4)||'.'||SUBSTR(A.MDF_DT,5,2)||'.'||SUBSTR(A.MDF_DT,7,2) AS MDF_DT,		/*작업일자*/
			        CASE
				    WHEN A.CON_DT IS NULL THEN ' '
				    ELSE SUBSTR(A.CON_DT, 1, 4)||'.'||SUBSTR(A.CON_DT, 6, 2)||'.'||SUBSTR(A.CON_DT, 9, 2)
				    END CON_DT																					/*연계일자*/
			   FROM TWFAACAV003M A, 
			        TWFAACAV024C B,
			        TBDCMACM002M C
			  WHERE A.BLL_CD = B.ACNT_CD 
			    AND RPAD(A.BR_CD,3,'0') || RPAD(DIV_CD,3,'0') = C.DPT_CD (+ )
			    AND B.ACNT_DVSN_CD = '03'
			    AND A.COPT_CD NOT IN ('301','069','155')
                AND A.BLL_CD NOT IN ('41', '42', '43')
		]]>
		<isNotEmpty property="strStartDt">
			<![CDATA[ AND A.MDF_DT >= #strStartDt# ]]>
		</isNotEmpty>
		<isNotEmpty property="strEndDt">
			<![CDATA[ AND A.MDF_DT <= #strEndDt# ]]>
		</isNotEmpty>
		<isNotEmpty property="strABltDt">
			<![CDATA[ AND SUBSTR(A.ABLT_DT, 1, 4) >= #strABltDt# ]]>
		</isNotEmpty>
		<include refid="include.pageOrder" />
		   ORDER BY ACCMN_ID
	</select>
	
	
	<select id="FAACAV025EMainSelectForCsvLink"	parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[  /* faa/cav/026/FAACAV025EMainSelectForCsvLink */ ]]>
        <![CDATA[
            /* 증명책임자부호,소관명,계산서명,회계코드,기관명,기관책임자,지정년월,폐지년월,작업일자,소관코드*/
			SELECT  chr(34)|| #linkId# ||chr(34)  AS AA,
					chr(34)|| A.COPT_CD || A.ACNT_CD || A.BLL_CD || A.PROF_DRTR_SRNO || A.DL_XPN_RCDB_PBSVT_SRNO ||chr(34) AS BB, /*증명책임자부호*/
			        chr(34)|| A.COPT_CD ||chr(34) AS CC,                                                   						  /*소관코드*/
			        chr(34)|| F_AV_BLL_COPT_CD_NM (A.COPT_CD) ||chr(34) AS DD,                                                    /*소관명*/
			        CASE 
			        	WHEN (A.BLL_CD ='17' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '"관서운영경비출납계산서"'
						WHEN (A.BLL_CD='22' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND A.DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '"기금관서운영경비출납계산서"' 
						ELSE chr(34)|| B.ACNT_CD_NM ||chr(34)
					END EE,                                                                                   /*계산서명*/
			        chr(34)|| A.ACNT_CD ||chr(34) AS FF,                                                                          /*회계코드*/
			        chr(34)|| F_AV_ACNT_CD_NM (A.ACNT_CD) ||chr(34) AS GG,														  /*회계코드명*/
			        chr(34)|| ORG_NM ||chr(34) AS HH,                                                                             /*기관명*/
			        chr(34)|| PST_NM || chr(34) AS II,                                                                          /*증명책임자 직위*/
			        CASE
			         WHEN A.CRE_DT = '000000' THEN ' '
			         ELSE chr(34)|| A.CRE_DT ||chr(34)
			        END JJ,                                                                                   /*지정년월*/
			        CASE
			         WHEN A.ABLT_DT = '999999' THEN ' '
			         ELSE chr(34)|| A.ABLT_DT ||chr(34)
			        END KK                                                                                    /*폐지년월*/
			        /* '' AS LL                                                                                 연계메시지ID*/
			        /* '' AS MM                                                                                 연계처리상세일시*/
			        /* SUBSTR(A.MDF_DT,1,4)||'.'||SUBSTR(A.MDF_DT,5,2)||'.'||SUBSTR(A.MDF_DT,7,2) AS KK,         작업일자*/
			        /* A.COPT_CD AS LL                                                                           소관코드*/
			 
			   FROM TWFAACAV003M A, 
			        TWFAACAV024C B,
			        TBDCMACM002M C
			  WHERE A.BLL_CD = B.ACNT_CD 
			    AND RPAD(A.BR_CD,3,'0') || RPAD(DIV_CD,3,'0') = C.DPT_CD (+ )
			    AND B.ACNT_DVSN_CD = '03'
			    AND A.COPT_CD NOT IN ('301','069','155')
                AND A.BLL_CD NOT IN ('41', '42', '43')
		]]>
		<isNotEmpty property="strStartDt">
			<![CDATA[ AND A.MDF_DT >= #strStartDt# ]]>
		</isNotEmpty>
		<isNotEmpty property="strEndDt">
			<![CDATA[ AND A.MDF_DT <= #strEndDt# ]]>
		</isNotEmpty>
		<isNotEmpty property="strABltDt">
			<![CDATA[ AND SUBSTR(A.ABLT_DT, 1, 4) >= #strABltDt# ]]>
		</isNotEmpty>
		<isNotEmpty property="strAA">
			AND A.COPT_CD|| '-' ||A.ACNT_CD|| '-' || A.BLL_CD || '-' || A.PROF_DRTR_SRNO || '-' || A.DL_XPN_RCDB_PBSVT_SRNO NOT IN
			<iterate property="strAA" open="(" close=")" conjunction=",">
				#strAA[]#
			</iterate>
		</isNotEmpty>
		<isNotEmpty property="strBB">
			AND A.COPT_CD|| '-' ||A.ACNT_CD|| '-' || A.BLL_CD || '-' || A.PROF_DRTR_SRNO || '-' || A.DL_XPN_RCDB_PBSVT_SRNO NOT IN #strBB#
		</isNotEmpty>
		ORDER BY BB
	</select>
	
	<update id="FAACAV025ECsvMainUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE 	TWFAACAV003M
			SET		CON_DT = SYSDATE
			WHERE	1=1
			AND COPT_CD NOT IN ('301','069','155')
	        AND BLL_CD NOT IN ('41', '42', '43')
		]]>
			<isNotEmpty property="strStartDt">
					<![CDATA[ AND MDF_DT >= #strStartDt# ]]>
			</isNotEmpty>
			<isNotEmpty property="strEndDt">
					<![CDATA[ AND MDF_DT <= #strEndDt# ]]>
			</isNotEmpty>
				
			<isNotEmpty property="strAA">
				AND COPT_CD|| '-' ||ACNT_CD|| '-' || BLL_CD || '-' || PROF_DRTR_SRNO || '-' || DL_XPN_RCDB_PBSVT_SRNO NOT IN
				<iterate property="strAA" open="(" close=")" conjunction=",">
					#strAA[]#
				</iterate>
			</isNotEmpty>
			<isNotEmpty property="strBB">
				AND COPT_CD|| '-' ||ACNT_CD|| '-' || BLL_CD || '-' || PROF_DRTR_SRNO || '-' || DL_XPN_RCDB_PBSVT_SRNO NOT IN #strBB#
			</isNotEmpty>
			<isNotEmpty property="strCC">
				AND COPT_CD|| '-' ||ACNT_CD|| '-' || BLL_CD || '-' || PROF_DRTR_SRNO || '-' || DL_XPN_RCDB_PBSVT_SRNO IN
				<iterate property="strCC" open="(" close=")" conjunction=",">
					#strCC[]#
				</iterate>
			</isNotEmpty>
			
	</update>
	
</sqlMap> 
