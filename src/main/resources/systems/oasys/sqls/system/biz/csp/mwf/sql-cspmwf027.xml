<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/mwf/027">
	
	<!-- 한의과 예약 -->
	<select id="CSPMWF027QClinicBokgSelect" parameterClass="paramMap"	resultClass="resultMap">
    	<include refid="include.pageSelct" />
		<![CDATA[
                SELECT TO_CHAR(TO_DATE(T1.BOKG_DT), 'YYYY-MM-DD')                     || '(' || 
                       TO_CHAR(TO_DATE(T1.BOKG_DT), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'           AS BOKG_DT
                      ,SUBSTR(T2.SCO_TM_STR_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_STR_CD,3) || ' ~ ' || 
                       SUBSTR(T2.SCO_TM_END_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_END_CD,3)               AS SCO_TM_NM
                      ,T5.USR_NAM                                                                      AS BOKG_PEN_NM
                      ,F_DPT_INFO(T1.BOKG_PEN_DPT_CD, '1')                                             AS BOKG_PEN_DPT_NM
                      ,F_CODE_NM('1000173', T5.RANK_CD)                                                AS RANK_NM
                      ,T5.TNB                                                                          AS TNB
                      ,T4.TRTMT_FNDT_TXT                                                               AS TRTMT_FNDT_TXT
                      ,CASE WHEN T4.TRTMT_NBC_CD = '1' THEN '초진' 
                            WHEN T4.TRTMT_NBC_CD = '2' THEN '재진'
                        END                                                                            AS TRTMT_NBC_NM
                      ,T1.SCO_SNO                                                                      AS SCO_SNO
                  FROM TBCSPMWF008M T1
                      ,TBCSPMWF009M T2 
                      ,TBCSPMWF007M T4
                      ,TBDCMACM001M T5
                 WHERE 1=1
                   AND T1.SCO_HST_SNO     = T2.SCO_HST_SNO
                   AND T1.SCO_SNO         = T2.SCO_SNO
                   AND T2.BOKG_DVSN_CD    = '1'
                   AND T1.BOKG_APL_DH     = T4.BOKG_APL_DH(+)
                   AND T1.BOKG_PEN_CNB    = T5.CNB
                   AND T1.BOKG_DT BETWEEN #strStrDt# AND #strEndDt#
		]]>      
    	<include refid="include.pageOrder" />		                   
	</select>	
	
	<!-- 한의과 예약 excel -->	
	<select id="CSPMWF027QClinicBokgExcelSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
                SELECT TO_CHAR(TO_DATE(T1.BOKG_DT), 'YYYY-MM-DD')                     || '(' || 
                       TO_CHAR(TO_DATE(T1.BOKG_DT), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'           AS BOKG_DT                   
                      ,SUBSTR(T2.SCO_TM_STR_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_STR_CD,3) || ' ~ ' || 
                       SUBSTR(T2.SCO_TM_END_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_END_CD,3)               AS SCO_TM_NM
                      ,T5.USR_NAM                                                                      AS BOKG_PEN_NM
                      ,F_DPT_INFO(T1.BOKG_PEN_DPT_CD, '1')                                             AS BOKG_PEN_DPT_NM
                      ,F_CODE_NM('1000173', T5.RANK_CD)                                                AS RANK_NM
                      ,T5.TNB                                                                          AS TNB
                      ,T4.TRTMT_FNDT_TXT                                                               AS TRTMT_FNDT_TXT
                      ,CASE WHEN T4.TRTMT_NBC_CD = '1' THEN '초진' 
                            WHEN T4.TRTMT_NBC_CD = '2' THEN '재진'
                        END                                                                            AS TRTMT_NBC_NM
                  FROM TBCSPMWF008M T1
                      ,TBCSPMWF009M T2 
                      ,TBCSPMWF007M T4
                      ,TBDCMACM001M T5
                 WHERE 1=1
                   AND T1.SCO_HST_SNO     = T2.SCO_HST_SNO
                   AND T1.SCO_SNO         = T2.SCO_SNO
                   AND T2.BOKG_DVSN_CD    = '1'
                   AND T1.BOKG_APL_DH     = T4.BOKG_APL_DH(+)
                   AND T1.BOKG_PEN_CNB    = T5.CNB
                   AND T1.BOKG_DT BETWEEN #strStrDt# AND #strEndDt#
                 ORDER BY T1.BOKG_DT
                         ,T1.SCO_SNO
		]]>      
	</select>	
	
	
	
		
	<!-- 한의과 방문 -->
	<select id="CSPMWF027QVisitSelect" parameterClass="paramMap"	resultClass="resultMap">
    	<include refid="include.pageSelct" />
		<![CDATA[
                   SELECT TO_CHAR(TO_DATE(SUBSTR(T1.BOKG_APL_DH,0,8)), 'YYYY-MM-DD')                     || '(' || 
                          TO_CHAR(TO_DATE(SUBSTR(T1.BOKG_APL_DH,0,8)), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'
                                                                                        AS BOKG_DT                        
                        ,(SELECT SUBSTR(SCO_TM_STR_CD,0,2) || ':' || SUBSTR(SCO_TM_STR_CD,3) || ' ~ ' || 
                                 SUBSTR(SCO_TM_END_CD,0,2) || ':' || SUBSTR(SCO_TM_END_CD,3) 
                            FROM TBCSPMWF009M
                           WHERE BOKG_DVSN_CD = '1'
                             AND SCO_HST_SNO  = T3.SCO_HST_SNO
                             AND SCO_SNO      = T3.SCO_SNO
                        )                                                               AS SCO_TM_NM
                        ,T2.USR_NAM                                                     AS BOKG_PEN_NM
                        ,F_DPT_INFO(T1.DPT_CD, '1')                                     AS BOKG_PEN_DPT_NM
                        ,F_CODE_NM('1000173', T2.RANK_CD)                               AS RANK_NM
                        ,T2.TNB                                                         AS TNB          
                        
                        ,T1.TRTMT_FNDT_TXT                                              AS TRTMT_FNDT_TXT
                        ,CASE WHEN T1.TRTMT_NBC_CD = '1' THEN '초진' 
                              WHEN T1.TRTMT_NBC_CD = '2' THEN '재진'
                          END                                                           AS TRTMT_NBC_NM
                        ,CASE WHEN T3.BOKG_DT IS NOT NULL THEN '예약확정'
                              ELSE ''
                          END                                                           AS BOKG_DTM_YN
                        ,T1.BOKG_APL_DH
                    FROM TBCSPMWF007M T1
                        ,TBDCMACM001M T2
                        ,TBCSPMWF008M T3
                   WHERE T1.VI_PPS_DVSN_CD = '10'
                     AND T1.CNB            = T2.CNB
                     AND T1.BOKG_APL_DH    = T3.BOKG_APL_DH(+)
                     AND SUBSTR(T1.BOKG_APL_DH,0,8) BETWEEN #strStrDt# AND #strEndDt#
		]]>      
    	<include refid="include.pageOrder" />		                   
	</select>		
	
	<!-- 한의과 방문 excel -->
	<select id="CSPMWF027QVisitExcelSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
                   SELECT TO_CHAR(TO_DATE(SUBSTR(T1.BOKG_APL_DH,0,8)), 'YYYY-MM-DD')                     || '(' || 
                          TO_CHAR(TO_DATE(SUBSTR(T1.BOKG_APL_DH,0,8)), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'
                                                                                        AS BOKG_DT                    
                        ,(SELECT SUBSTR(SCO_TM_STR_CD,0,2) || ':' || SUBSTR(SCO_TM_STR_CD,3) || ' ~ ' || 
                                 SUBSTR(SCO_TM_END_CD,0,2) || ':' || SUBSTR(SCO_TM_END_CD,3) 
                            FROM TBCSPMWF009M
                           WHERE BOKG_DVSN_CD = '1'
                             AND SCO_HST_SNO  = T3.SCO_HST_SNO
                             AND SCO_SNO      = T3.SCO_SNO
                        )                                                               AS SCO_TM_NM
                        ,T2.USR_NAM                                                     AS BOKG_PEN_NM
                        ,F_DPT_INFO(T1.DPT_CD, '1')                                     AS BOKG_PEN_DPT_NM
                        ,F_CODE_NM('1000173', T2.RANK_CD)                               AS RANK_NM
                        ,T2.TNB                                                         AS TNB          
                        
                        ,T1.TRTMT_FNDT_TXT                                              AS TRTMT_FNDT_TXT
                        ,CASE WHEN T1.TRTMT_NBC_CD = '1' THEN '초진' 
                              WHEN T1.TRTMT_NBC_CD = '2' THEN '재진'
                          END                                                           AS TRTMT_NBC_NM
                        ,CASE WHEN T3.BOKG_DT IS NOT NULL THEN '예약확정'
                              ELSE ''
                          END                                                           AS BOKG_DTM_YN
                        ,T1.BOKG_APL_DH
                    FROM TBCSPMWF007M T1
                        ,TBDCMACM001M T2
                        ,TBCSPMWF008M T3
                   WHERE T1.VI_PPS_DVSN_CD = '10'
                     AND T1.CNB            = T2.CNB
                     AND T1.BOKG_APL_DH    = T3.BOKG_APL_DH(+)
                     AND SUBSTR(T1.BOKG_APL_DH,0,8) BETWEEN #strStrDt# AND #strEndDt#
                   ORDER BY T1.BOKG_APL_DH
		]]>      
	</select>
	
	
	<!-- 치과 예약 -->
	<select id="CSPMWF027QDentalClinicBokgSelect" parameterClass="paramMap"	resultClass="resultMap">
    	<include refid="include.pageSelct" />
		<![CDATA[
                SELECT TO_CHAR(TO_DATE(T1.BOKG_DT), 'YYYY-MM-DD')                     || '(' || 
                       TO_CHAR(TO_DATE(T1.BOKG_DT), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'           AS BOKG_DT
                      ,SUBSTR(T2.SCO_TM_STR_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_STR_CD,3) || ' ~ ' || 
                       SUBSTR(T2.SCO_TM_END_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_END_CD,3)               AS SCO_TM_NM
                      ,T5.USR_NAM                                                                      AS BOKG_PEN_NM
                      ,F_DPT_INFO(T1.BOKG_PEN_DPT_CD, '1')                                             AS BOKG_PEN_DPT_NM
                      ,F_CODE_NM('1000173', T5.RANK_CD)                                                AS RANK_NM
                      ,T5.TNB                                                                          AS TNB
                      ,T4.TRTMT_FNDT_TXT                                                               AS TRTMT_FNDT_TXT
                      ,CASE WHEN T4.TRTMT_NBC_CD = '1' THEN '초진' 
                            WHEN T4.TRTMT_NBC_CD = '2' THEN '재진'
                        END                                                                            AS TRTMT_NBC_NM
                      ,T1.SCO_SNO                                                                      AS SCO_SNO
                  FROM TBCSPMWF013M T1
                      ,TBCSPMWF009M T2 
                      ,TBCSPMWF012M T4
                      ,TBDCMACM001M T5
                 WHERE 1=1
                   AND T1.SCO_HST_SNO     = T2.SCO_HST_SNO
                   AND T1.SCO_SNO         = T2.SCO_SNO
                   AND T2.BOKG_DVSN_CD    = '3'
                   AND T1.BOKG_APL_DH     = T4.BOKG_APL_DH(+)
                   AND T1.BOKG_PEN_CNB    = T5.CNB
                   AND T1.BOKG_DT BETWEEN #strStrDt# AND #strEndDt#
		]]>      
    	<include refid="include.pageOrder" />		                   
	</select>	
	
	<!-- 치과 예약 excel -->	
	<select id="CSPMWF027QDentalClinicBokgExcelSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
                SELECT TO_CHAR(TO_DATE(T1.BOKG_DT), 'YYYY-MM-DD')                     || '(' || 
                       TO_CHAR(TO_DATE(T1.BOKG_DT), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'           AS BOKG_DT                   
                      ,SUBSTR(T2.SCO_TM_STR_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_STR_CD,3) || ' ~ ' || 
                       SUBSTR(T2.SCO_TM_END_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_END_CD,3)               AS SCO_TM_NM
                      ,T5.USR_NAM                                                                      AS BOKG_PEN_NM
                      ,F_DPT_INFO(T1.BOKG_PEN_DPT_CD, '1')                                             AS BOKG_PEN_DPT_NM
                      ,F_CODE_NM('1000173', T5.RANK_CD)                                                AS RANK_NM
                      ,T5.TNB                                                                          AS TNB
                      ,T4.TRTMT_FNDT_TXT                                                               AS TRTMT_FNDT_TXT
                      ,CASE WHEN T4.TRTMT_NBC_CD = '1' THEN '초진' 
                            WHEN T4.TRTMT_NBC_CD = '2' THEN '재진'
                        END                                                                            AS TRTMT_NBC_NM
                  FROM TBCSPMWF013M T1
                      ,TBCSPMWF009M T2 
                      ,TBCSPMWF012M T4
                      ,TBDCMACM001M T5
                 WHERE 1=1
                   AND T1.SCO_HST_SNO     = T2.SCO_HST_SNO
                   AND T1.SCO_SNO         = T2.SCO_SNO
                   AND T2.BOKG_DVSN_CD    = '3'
                   AND T1.BOKG_APL_DH     = T4.BOKG_APL_DH(+)
                   AND T1.BOKG_PEN_CNB    = T5.CNB
                   AND T1.BOKG_DT BETWEEN #strStrDt# AND #strEndDt#
                 ORDER BY T1.BOKG_DT
                         ,T1.SCO_SNO
		]]>      
	</select>	
	
	
	
		
	<!-- 치과 방문 -->
	<select id="CSPMWF027QDentalVisitSelect" parameterClass="paramMap"	resultClass="resultMap">
    	<include refid="include.pageSelct" />
		<![CDATA[
                   SELECT TO_CHAR(TO_DATE(SUBSTR(T1.BOKG_APL_DH,0,8)), 'YYYY-MM-DD')                     || '(' || 
                          TO_CHAR(TO_DATE(SUBSTR(T1.BOKG_APL_DH,0,8)), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'
                                                                                        AS BOKG_DT                        
                        ,(SELECT SUBSTR(SCO_TM_STR_CD,0,2) || ':' || SUBSTR(SCO_TM_STR_CD,3) || ' ~ ' || 
                                 SUBSTR(SCO_TM_END_CD,0,2) || ':' || SUBSTR(SCO_TM_END_CD,3) 
                            FROM TBCSPMWF009M
                           WHERE BOKG_DVSN_CD = '1'
                             AND SCO_HST_SNO  = T3.SCO_HST_SNO
                             AND SCO_SNO      = T3.SCO_SNO
                        )                                                               AS SCO_TM_NM
                        ,T2.USR_NAM                                                     AS BOKG_PEN_NM
                        ,F_DPT_INFO(T1.DPT_CD, '1')                                     AS BOKG_PEN_DPT_NM
                        ,F_CODE_NM('1000173', T2.RANK_CD)                               AS RANK_NM
                        ,T2.TNB                                                         AS TNB          
                        
                        ,T1.TRTMT_FNDT_TXT                                              AS TRTMT_FNDT_TXT
                        ,CASE WHEN T1.TRTMT_NBC_CD = '1' THEN '초진' 
                              WHEN T1.TRTMT_NBC_CD = '2' THEN '재진'
                          END                                                           AS TRTMT_NBC_NM
                        ,CASE WHEN T3.BOKG_DT IS NOT NULL THEN '예약확정'
                              ELSE ''
                          END                                                           AS BOKG_DTM_YN
                        ,T1.BOKG_APL_DH
                    FROM TBCSPMWF012M T1
                        ,TBDCMACM001M T2
                        ,TBCSPMWF013M T3
                   WHERE T1.VI_PPS_DVSN_CD = '10'
                     AND T1.CNB            = T2.CNB
                     AND T1.BOKG_APL_DH    = T3.BOKG_APL_DH(+)
                     AND SUBSTR(T1.BOKG_APL_DH,0,8) BETWEEN #strStrDt# AND #strEndDt#
		]]>      
    	<include refid="include.pageOrder" />		                   
	</select>		
	
	<!-- 치과 방문 excel -->
	<select id="CSPMWF027QDentalVisitExcelSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
                   SELECT TO_CHAR(TO_DATE(SUBSTR(T1.BOKG_APL_DH,0,8)), 'YYYY-MM-DD')                     || '(' || 
                          TO_CHAR(TO_DATE(SUBSTR(T1.BOKG_APL_DH,0,8)), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'
                                                                                        AS BOKG_DT                    
                        ,(SELECT SUBSTR(SCO_TM_STR_CD,0,2) || ':' || SUBSTR(SCO_TM_STR_CD,3) || ' ~ ' || 
                                 SUBSTR(SCO_TM_END_CD,0,2) || ':' || SUBSTR(SCO_TM_END_CD,3) 
                            FROM TBCSPMWF009M
                           WHERE BOKG_DVSN_CD = '1'
                             AND SCO_HST_SNO  = T3.SCO_HST_SNO
                             AND SCO_SNO      = T3.SCO_SNO
                        )                                                               AS SCO_TM_NM
                        ,T2.USR_NAM                                                     AS BOKG_PEN_NM
                        ,F_DPT_INFO(T1.DPT_CD, '1')                                     AS BOKG_PEN_DPT_NM
                        ,F_CODE_NM('1000173', T2.RANK_CD)                               AS RANK_NM
                        ,T2.TNB                                                         AS TNB          
                        
                        ,T1.TRTMT_FNDT_TXT                                              AS TRTMT_FNDT_TXT
                        ,CASE WHEN T1.TRTMT_NBC_CD = '1' THEN '초진' 
                              WHEN T1.TRTMT_NBC_CD = '2' THEN '재진'
                          END                                                           AS TRTMT_NBC_NM
                        ,CASE WHEN T3.BOKG_DT IS NOT NULL THEN '예약확정'
                              ELSE ''
                          END                                                           AS BOKG_DTM_YN
                        ,T1.BOKG_APL_DH
                    FROM TBCSPMWF012M T1
                        ,TBDCMACM001M T2
                        ,TBCSPMWF013M T3
                   WHERE T1.VI_PPS_DVSN_CD = '10'
                     AND T1.CNB            = T2.CNB
                     AND T1.BOKG_APL_DH    = T3.BOKG_APL_DH(+)
                     AND SUBSTR(T1.BOKG_APL_DH,0,8) BETWEEN #strStrDt# AND #strEndDt#
                   ORDER BY T1.BOKG_APL_DH
		]]>      
	</select>
	
	
	<!-- 안마기 예약 -->
	<select id="CSPMWF027QChairBokgSelect" parameterClass="paramMap"	resultClass="resultMap">
    	<include refid="include.pageSelct" />
		<![CDATA[
		
                SELECT TO_CHAR(TO_DATE(T1.BOKG_DT), 'YYYY-MM-DD')                     || '(' || 
                       TO_CHAR(TO_DATE(T1.BOKG_DT), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'           AS BOKG_DT                                                       
                      ,SUBSTR(T2.SCO_TM_STR_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_STR_CD,3) || ' ~ ' || 
                       SUBSTR(T2.SCO_TM_END_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_END_CD,3)               AS SCO_TM_NM
                      ,F_CODE_NM('1000896', T1.MSGCHR_CD)                                              AS MSGCHR_NM
                      ,T3.USR_NAM                                                                      AS BOKG_PEN_NM
                      ,F_DPT_INFO(T1.BOKG_PEN_DPT_CD, '1')                                             AS BOKG_PEN_DPT_NM
                      ,F_CODE_NM('1000173', T3.RANK_CD)                                                AS RANK_NM
                      ,T3.TNB                                                                          AS TNB
                      ,T1.SCO_HST_SNO                                                                  AS SCO_HST_SNO
                      ,T1.SCO_SNO                                                                      AS SCO_SNO
                      ,T1.MSGCHR_CD                                                                    AS MSGCHR_CD                      
                  FROM TBCSPMWF010M T1
                      ,TBCSPMWF009M T2 
                      ,TBDCMACM001M T3
                 WHERE 1=1
                   AND T1.SCO_HST_SNO     = T2.SCO_HST_SNO
                   AND T1.SCO_SNO         = T2.SCO_SNO
                   AND T2.BOKG_DVSN_CD    = '2'
                   AND T1.BOKG_PEN_CNB    = T3.CNB
                   AND T1.BOKG_DT BETWEEN #strStrDt# AND #strEndDt#
		]]>      
    	<include refid="include.pageOrder" />		                   
	</select>	
	
	<!-- 안마기 예약 excel -->	
	<select id="CSPMWF027QChairBokgExcelSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
                SELECT TO_CHAR(TO_DATE(T1.BOKG_DT), 'YYYY-MM-DD')                     || '(' || 
                       TO_CHAR(TO_DATE(T1.BOKG_DT), 'DY', 'NLS_DATE_LANGUAGE=korean') || ')'           AS BOKG_DT                       
                      ,SUBSTR(T2.SCO_TM_STR_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_STR_CD,3) || ' ~ ' || 
                       SUBSTR(T2.SCO_TM_END_CD,0,2) || ':' || SUBSTR(T2.SCO_TM_END_CD,3)               AS SCO_TM_NM
                      ,F_CODE_NM('1000896', T1.MSGCHR_CD)                                              AS MSGCHR_NM
                      ,T3.USR_NAM                                                                      AS BOKG_PEN_NM
                      ,F_DPT_INFO(T1.BOKG_PEN_DPT_CD, '1')                                             AS BOKG_PEN_DPT_NM
                      ,F_CODE_NM('1000173', T3.RANK_CD)                                                AS RANK_NM
                      ,T3.TNB                                                                          AS TNB
                      ,T1.SCO_SNO                                                                      AS SCO_SNO
                  FROM TBCSPMWF010M T1
                      ,TBCSPMWF009M T2 
                      ,TBDCMACM001M T3
                 WHERE 1=1
                   AND T1.SCO_HST_SNO     = T2.SCO_HST_SNO
                   AND T1.SCO_SNO         = T2.SCO_SNO
                   AND T2.BOKG_DVSN_CD    = '2'
                   AND T1.BOKG_PEN_CNB    = T3.CNB
                   AND T1.BOKG_DT BETWEEN #strStrDt# AND #strEndDt#
                 ORDER BY T1.BOKG_DT
                         ,T1.SCO_HST_SNO
                         ,T1.SCO_SNO
                         ,T1.MSGCHR_CD
		]]>      
	</select>	
	
</sqlMap> 
