<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="bad/ear/034">

	<!--##################### 처분요구 및 권고 통보사항/ 기관별 지적사항 시작 #################################-->
	<select id="BADEAR34QSumselect1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT SUM(A1 + B1 + C1 + D1 + D4 + E1 + E2 + F1 + G1 + H1 + I1 + J1 + K1 + L1 + M1 + N1) AS SUM1,
			       SUM(A2 + C2 + D2 + D5 + J2 + N2)                                                        AS SUM2,
			       SUM(B2 + K2 + L2 + M2)                                                             AS SUM3,
			       SUM(A3 + C3 + D3 + D6 + J3 + N3)                                                        AS SUM4
			FROM (
			        SELECT      CASE WHEN SUBSTR(KIKGU, 1, 1) = '1' THEN '1'                                                                                    
			                         WHEN SUBSTR(KIKGU, 1, 1) = '2' THEN '2'                                                                                    
			                         WHEN SUBSTR(KIKGU, 1, 1) = '3' THEN '3'                                                                                    
			                    ELSE '4' END                                              AS KIKW,                                                                 
			               SUM(CASE WHEN CHBCD = '110' THEN NVL(GUNSU,0)                                                                                        
			                   ELSE 0 END)                                                AS A1,                                                                   
			               SUM(CASE WHEN CHBCD = '110' THEN NVL(AM1,0)                                                                                         
			                   ELSE 0 END)                                                AS A2,                                                                   
			               SUM(CASE WHEN CHBCD = '110' THEN NVL(AM2,0) + NVL(AM3,0)                                                                        
			                   ELSE 0 END)                                                AS A3,                                                                   
			               SUM(CASE WHEN CHBCD = '210' THEN NVL(GUNSU,0)                                                                                        
			                   ELSE 0 END)                                                AS B1,                                                                   
			               SUM(CASE WHEN CHBCD = '210' THEN NVL(MAN,0)                                                                                          
			                   ELSE 0 END)                                                AS B2,                                                                   
			               SUM(     CASE WHEN CHBCD = '310' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE CASE WHEN CHBCD = '320' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE 0 END END)                                            AS C1,                                                                   
			               SUM(     CASE WHEN CHBCD = '310' THEN NVL(AM1,0)                                                                                    
			                   ELSE CASE WHEN CHBCD = '320' THEN NVL(AM1,0)                                                                                    
			                   ELSE 0 END END)                                            AS C2,                                                                   
			               SUM(     CASE WHEN CHBCD = '310' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			                   ELSE CASE WHEN CHBCD = '320' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			                   ELSE 0 END END)                                            AS C3,                                                                   
			               SUM(     CASE WHEN CHBCD = '390' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE CASE WHEN CHBCD = '391' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE 0 END END)                                            AS D1,                                                                   
			               SUM(     CASE WHEN CHBCD = '390' THEN NVL(AM1,0)                                                                                    
			                   ELSE CASE WHEN CHBCD = '391' THEN NVL(AM1,0)                                                                                    
			                   ELSE 0 END END)                                            AS D2,                                                                   
			               SUM(     CASE WHEN CHBCD = '390' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			                   ELSE CASE WHEN CHBCD = '391' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			                   ELSE 0 END END)                                            AS D3,
			               SUM(     CASE WHEN CHBCD = '395' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE CASE WHEN CHBCD = '396' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE 0 END END)                                            AS D4,                                                                   
			               SUM(     CASE WHEN CHBCD = '395' THEN NVL(AM1,0)                                                                                    
			                   ELSE CASE WHEN CHBCD = '396' THEN NVL(AM1,0)                                                                                    
			                   ELSE 0 END END)                                            AS D5,                                                                   
			               SUM(     CASE WHEN CHBCD = '395' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			                   ELSE CASE WHEN CHBCD = '396' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			                   ELSE 0 END END)                                            AS D6,                                                                   
			               SUM(     CASE WHEN CHBCD = '410' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE CASE WHEN CHBCD = '490' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE 0 END END)                                            AS E1,                                                                   
			               SUM(CASE WHEN CHBCD = '495' THEN NVL(GUNSU,0)                                                                                        
			                   ELSE 0 END)                                                AS E2,                                                                   
			               SUM(CASE WHEN CHBCD = '510' THEN NVL(GUNSU,0)                                                                                        
			                   ELSE 0 END)                                                AS F1,                                                                   
			               SUM(CASE WHEN CHBCD = '520' THEN NVL(GUNSU,0)                                                                                        
			                   ELSE 0 END)                                                AS G1,                                                                   
			               SUM(CASE WHEN CHBCD = '530' THEN NVL(GUNSU,0)                                                                                        
			                   ELSE 0 END)                                                AS H1,                                                                   
			               SUM(CASE WHEN CHBCD = '611' THEN NVL(GUNSU,0)                                                                                        
			                   ELSE 0 END)                                                AS I1,                                                                   
			               SUM(CASE WHEN CHBCD IN ('610','630') THEN NVL(GUNSU,0) 
			                   ELSE 0 END)                                                AS J1,     
			               SUM(CASE WHEN CHBCD IN ('610','630') THEN NVL(AM1,0)                                                                                         
			                   ELSE 0 END)                                                AS J2,                                                                   
			               SUM(CASE WHEN CHBCD IN ('610','630') THEN NVL(AM2,0) + NVL(AM3,0)                                                                        
			                   ELSE 0 END)                                                AS J3,                                                                  
			               SUM(     CASE WHEN CHBCD = '620' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE CASE WHEN CHBCD = '621' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE 0 END END)                                            AS K1,                                                                   
			               SUM(     CASE WHEN CHBCD = '620' THEN NVL(MAN,0)                                                                                     
			                   ELSE CASE WHEN CHBCD = '621' THEN NVL(MAN,0)                                                                                     
			                   ELSE 0 END END)                                            AS K2,                                                                   
			               SUM(     CASE WHEN CHBCD = '710' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE CASE WHEN CHBCD = '720' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE CASE WHEN CHBCD = '730' THEN NVL(GUNSU,0)                                                                                   
			                   ELSE 0 END END END)                                        AS L1,                                                                   
			               SUM(     CASE WHEN CHBCD = '710' THEN NVL(MAN,0)                                                                                     
			                   ELSE CASE WHEN CHBCD = '720' THEN NVL(MAN,0)                                                                                     
			                   ELSE CASE WHEN CHBCD = '730' THEN NVL(MAN,0)                                                                                     
			                   ELSE 0 END END END)                                        AS L2,
			               SUM(     CASE WHEN CHBCD = '623' THEN NVL(GUNSU,0)                                                                                                                                                                 
			                   ELSE 0 END)                                                AS M1,                                                                   
			               SUM(     CASE WHEN CHBCD = '623' THEN NVL(MAN,0)                                                                                                                                                                     
			                   ELSE 0 END)                                                AS M2,

						   /* 통보(시정완료):625 추가 - 2017.01.20 yyh*/   
			               SUM(CASE WHEN CHBCD = '625' THEN NVL(GUNSU,0)                                                                                        
			                   ELSE 0 END)                                                AS N1,                                                                   
			               SUM(CASE WHEN CHBCD = '625' THEN NVL(AM1,0)                                                                                         
			                   ELSE 0 END)                                                AS N2,                                                                   
			               SUM(CASE WHEN CHBCD = '625' THEN NVL(AM2,0) + NVL(AM3,0)                                                                        
			                   ELSE 0 END)                                                AS N3  
			                   			                                                                                       
			          FROM (SELECT YYMM,                                                                                                                           
			                       KIKGU,                                                                                                                          
			                       SOKIK,                                                                                                                          
			                       (CASE WHEN CHB_CD < '930' AND CHB_CD NOT IN('390','391','395','396','800','810','820','830','840','850')                      THEN CHB_CD                                      
			                                  WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0      THEN '390'                                       
			                                  WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0      THEN '395'                                       
			                                  WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0      THEN '391'                                       
			                                  WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0      THEN '396'                                       
			                             ELSE NULL END) AS CHBCD,                                                                                                          
			                       SUM(CASE WHEN CHB_CD IN('110','310','320','390','391','395','396','410','490','495')                                                              
			                                  OR CHB_CD IN('320','410','490','495','510','520','530','610','611','630','910','911','912','913','914','915','916','625')  THEN 0
			                           ELSE CHB_SU END) AS MAN,                                                                                                     
			                       SUM(CASE WHEN CHB_CD IN('210','620','621','623','710','720','730', '800','810','820','830','840','850')                               
			                           
			                           		  /* 320 제외 - 2016.01.29 yyh */
			                                  /* OR CHB_CD IN('320','410','490','510','520','530', '610','611','630','910','911','912','913','914','915','916') THEN 0 */
			                                  OR CHB_CD IN('410','490','495','510','520','530', '611','910','911','912','913','914','915','916') THEN 0
			                                  
			                           ELSE CAM1  END)  AS AM1,                                                                                                    
			                           
			                       SUM(CASE WHEN CHB_CD IN('210','620','621','623','710','720','730', '800','810','820','830','840','850')                               
			                                  OR CHB_CD IN('320','410','490','495','510','520','530', '611','910','911','912','913','914','915','916') THEN 0
			                           ELSE CAM2  END)  AS AM2,                                                                                                    
			                       SUM(CASE WHEN CHB_CD IN('210','620','621','623','710','720','730', '800','810','820','830','840','850')                               
			                                  OR CHB_CD IN('320','410','490','495','510','520','530', '611','910','911','912','913','914','915','916') THEN 0
			                           ELSE CAM3  END)  AS AM3,                                                                                                    
			                       (NVL(SUM(CASE WHEN CHB_CD < '930' AND CHB_CD NOT IN('390','391','395','396','800','810','820','830','840','850') THEN 1 END), 0)                          
			                      + NVL(SUM(CASE WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0 THEN 1 END),0)                                
			                      + NVL(SUM(CASE WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0 THEN 1 END),0)                                
			                      + NVL(SUM(CASE WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 THEN 1 END),0)
			                      + NVL(SUM(CASE WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 THEN 1 END),0)) AS GUNSU                       
			                  FROM (SELECT SUBSTR(DETAIL.ENF_DT, 1, 6)      AS YYMM  ,                                                                         
			                               MASTER.ORG_DVSN_CD               AS KIKGU ,                                                                         
			                               DETAIL.COPT_OFI_CD               AS SOKIK ,                                                                         
			                               MASTER.DSP_RQ_KND_CD             AS CHB_CD,                                                                         
			                               NVL(DETAIL.NOP_CNT, 0)           AS CHB_SU,                                                                         
			                               NVL(DETAIL.PNL_DRIN_PSVT_AM, 0)  AS CAM1 ,                                                                         
			                               NVL(DETAIL.RSR_AM, 0)            AS CAM2 ,                                                                         
			                               NVL(DETAIL.SPLP_AM, 0)           AS CAM3
			                          FROM TBBADEAR001M MASTER,
			                               TBBADEAR002D DETAIL
			                         WHERE MASTER.AUD_YR      = DETAIL.AUD_YR
			                           AND MASTER.AUD_NO      = DETAIL.AUD_NO
			                           AND MASTER.DSP_RQ_SNO  = DETAIL.DSP_RQ_SNO
			                           AND DETAIL.ENF_DT      IS NOT NULL
			                           AND DETAIL.ENF_DT      BETWEEN #strStartFromDt# ||'01' AND #strStartToDt# ||'31'
			                           AND DETAIL.DTM_STA_CD != '0'                                                                                              
			                       ) A                                                                                                                             
			                 GROUP BY YYMM,                                                                                                                           
			                          KIKGU,                                                                                                                          
			                          SOKIK,                                                                                                             
			                         (CASE WHEN CHB_CD < '930' AND CHB_CD NOT IN('390','391','395','396','800','810','820','830','840','850')                 THEN CHB_CD                                      
			                               WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0      THEN '390'                                       
			                               WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0      THEN '395'                                       
			                               WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0      THEN '391'                                       
			                               WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0      THEN '396'                                       
			                          ELSE NULL END)                                                                                                         
			               ) STKIKW_F                                                                                                                              
			         GROUP BY (CASE WHEN SUBSTR(KIKGU, 1, 1) = '1' THEN '1'                                                                                    
			                        WHEN SUBSTR(KIKGU, 1, 1) = '2' THEN '2'                                                                                    
			                        WHEN SUBSTR(KIKGU, 1, 1) = '3' THEN '3'                                                                                    
			                    ELSE '4' END)
			) STKIKW_F_SUM 
        ]]>
	</select>
	
	<select id="BADEAR34QDetailselect1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT      CASE WHEN SUBSTR(KIKGU, 1, 1) = '1' THEN '1'                                                                                    
			                 WHEN SUBSTR(KIKGU, 1, 1) = '2' THEN '2'                                                                                    
			                 WHEN SUBSTR(KIKGU, 1, 1) = '3' THEN '3'                                                                                    
			            ELSE '4' END                                              AS KIKW,                                                                 
			       SUM(CASE WHEN CHBCD = '110' THEN NVL(GUNSU,0)                                                                                        
			           ELSE 0 END)                                                AS A1,                                                                   
			       SUM(CASE WHEN CHBCD = '110' THEN NVL(AM1,0)                                                                                         
			           ELSE 0 END)                                                AS A2,                                                                   
			       SUM(CASE WHEN CHBCD = '110' THEN NVL(AM2,0) + NVL(AM3,0)                                                                        
			           ELSE 0 END)                                                AS A3,                                                                   
			       SUM(CASE WHEN CHBCD = '210' THEN NVL(GUNSU,0)                                                                                        
			           ELSE 0 END)                                                AS B1,                                                                   
			       SUM(CASE WHEN CHBCD = '210' THEN NVL(MAN,0)                                                                                          
			           ELSE 0 END)                                                AS B2,                                                                   
			       SUM(     CASE WHEN CHBCD = '310' THEN NVL(GUNSU,0)                                                                                   
			           ELSE CASE WHEN CHBCD = '320' THEN NVL(GUNSU,0)                                                                                   
			           ELSE 0 END END)                                            AS C1,                                                                   
			       SUM(     CASE WHEN CHBCD = '310' THEN NVL(AM1,0)                                                                                    
			           ELSE CASE WHEN CHBCD = '320' THEN NVL(AM1,0)                                                                                    
			           ELSE 0 END END)                                            AS C2,                                                                   
			       SUM(     CASE WHEN CHBCD = '310' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			           ELSE CASE WHEN CHBCD = '320' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			           ELSE 0 END END)                                            AS C3,                                                                   
			       SUM(     CASE WHEN CHBCD = '390' THEN NVL(GUNSU,0)                                                                                   
			           ELSE CASE WHEN CHBCD = '391' THEN NVL(GUNSU,0)                                                                                   
			           ELSE 0 END END)                                            AS D1,                                                                   
			       SUM(     CASE WHEN CHBCD = '390' THEN NVL(AM1,0)                                                                                    
			           ELSE CASE WHEN CHBCD = '391' THEN NVL(AM1,0)                                                                                    
			           ELSE 0 END END)                                            AS D2,                                                                   
			       SUM(     CASE WHEN CHBCD = '390' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			           ELSE CASE WHEN CHBCD = '391' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			           ELSE 0 END END)                                            AS D3,                                                                   
			       SUM(     CASE WHEN CHBCD = '395' THEN NVL(GUNSU,0)                                                                                   
			           ELSE CASE WHEN CHBCD = '396' THEN NVL(GUNSU,0)                                                                                   
			           ELSE 0 END END)                                            AS D4,                                                                   
			       SUM(     CASE WHEN CHBCD = '395' THEN NVL(AM1,0)                                                                                    
			           ELSE CASE WHEN CHBCD = '396' THEN NVL(AM1,0)                                                                                    
			           ELSE 0 END END)                                            AS D5,                                                                   
			       SUM(     CASE WHEN CHBCD = '395' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			           ELSE CASE WHEN CHBCD = '396' THEN NVL(AM2,0) + NVL(AM3,0)                                                                   
			           ELSE 0 END END)                                            AS D6,                                                                   
			       SUM(     CASE WHEN CHBCD = '410' THEN NVL(GUNSU,0)                                                                                   
			           ELSE CASE WHEN CHBCD = '490' THEN NVL(GUNSU,0)                                                                                   
			           ELSE 0 END END)                                            AS E1,                                                                   
			       SUM(CASE WHEN CHBCD = '495' THEN NVL(GUNSU,0)                                                                                        
			           ELSE 0 END)                                                AS E2,                                                                   
			       SUM(CASE WHEN CHBCD = '510' THEN NVL(GUNSU,0)                                                                                        
			           ELSE 0 END)                                                AS F1,                                                                   
			       SUM(CASE WHEN CHBCD = '520' THEN NVL(GUNSU,0)                                                                                        
			           ELSE 0 END)                                                AS G1,                                                                   
			       SUM(CASE WHEN CHBCD = '530' THEN NVL(GUNSU,0)                                                                                        
			           ELSE 0 END)                                                AS H1,                                                                   
			       SUM(CASE WHEN CHBCD = '611' THEN NVL(GUNSU,0)                                                                                        
			           ELSE 0 END)                                                AS I1,                                                                   
			       SUM(CASE WHEN CHBCD IN ('610','630') THEN NVL(GUNSU,0) 
			           ELSE 0 END)                                                AS J1, 
			       SUM(CASE WHEN CHBCD IN ('610','630') THEN NVL(AM1,0)                                                                                         
			                ELSE 0 END)                                           AS J2,                                                                   
			       SUM(CASE WHEN CHBCD IN ('610','630') THEN NVL(AM2,0) + NVL(AM3,0)                                                                        
			                ELSE 0 END)                                           AS J3,                           
			       SUM(     CASE WHEN CHBCD = '620' THEN NVL(GUNSU,0)                                                                                   
			           ELSE CASE WHEN CHBCD = '621' THEN NVL(GUNSU,0)                                                                                   
			           ELSE 0 END END)                                            AS K1,                                                                   
			       SUM(     CASE WHEN CHBCD = '620' THEN NVL(MAN,0)                                                                                     
			           ELSE CASE WHEN CHBCD = '621' THEN NVL(MAN,0)                                                                                     
			           ELSE 0 END END)                                            AS K2,                                                                   
			       SUM(     CASE WHEN CHBCD = '710' THEN NVL(GUNSU,0)                                                                                   
			           ELSE CASE WHEN CHBCD = '720' THEN NVL(GUNSU,0)                                                                                   
			           ELSE CASE WHEN CHBCD = '730' THEN NVL(GUNSU,0)                                                                                   
			           ELSE 0 END END END)                                        AS L1,                                                                   
			       SUM(     CASE WHEN CHBCD = '710' THEN NVL(MAN,0)                                                                                     
			           ELSE CASE WHEN CHBCD = '720' THEN NVL(MAN,0)                                                                                     
			           ELSE CASE WHEN CHBCD = '730' THEN NVL(MAN,0)                                                                                     
			           ELSE 0 END END END)                                        AS L2,
			       SUM(     CASE WHEN CHBCD = '623' THEN NVL(GUNSU,0)                                                                                                                                                                 
			           ELSE 0 END)                                                AS M1,                                                                   
			       SUM(     CASE WHEN CHBCD = '623' THEN NVL(MAN,0)                                                                                                                                                                     
			           ELSE 0 END)                                                AS M2,
			           
				   /* 통보(시정완료):625 추가 - 2017.01.20 yyh*/   
			       SUM(CASE WHEN CHBCD = '625' THEN NVL(GUNSU,0)                                                                                        
			                ELSE 0 END)                                                AS N1,                                                                   
			       SUM(CASE WHEN CHBCD = '625' THEN NVL(AM1,0)                                                                                         
			                ELSE 0 END)                                                AS N2,                                                                   
			       SUM(CASE WHEN CHBCD = '625' THEN NVL(AM2,0) + NVL(AM3,0)                                                                        
			                ELSE 0 END)                                                AS N3  			           
			           
			  FROM (SELECT YYMM,                                                                                                                           
			               KIKGU,                                                                                                                          
			               SOKIK,                                                                                                                          
			               (CASE WHEN CHB_CD < '930' AND CHB_CD NOT IN('390','391','395','396','800','810','820','830','840','850')                      THEN CHB_CD                                      
			                          WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0      THEN '390'                                       
			                          WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0      THEN '395'                                       
			                          WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0      THEN '391'                                       
			                          WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0      THEN '396'                                       
			                     ELSE NULL END) AS CHBCD,                                                                                                          
			               SUM(CASE WHEN CHB_CD IN('110','310','320','390','391','395','396','410','490','495')                                                              
			                          OR CHB_CD IN('320','410','490','495','510','520','530','610','611','630','910','911','912','913','914','915','916','625')  THEN 0
			                   ELSE CHB_SU END) AS MAN,
			                   
			               /* 320 제외 - 2016.02.01 yyh */                                                                                                     
			               SUM(CASE WHEN CHB_CD IN('210','620','621','623','710','720','730', '800','810','820','830','840','850')                               
			                          /* OR CHB_CD IN('320','410','490','495','510','520','530', '610','611','630','910','911','912','913','914','915','916') THEN 0 */
			                          OR CHB_CD IN('410','490','495','510','520','530', '611','910','911','912','913','914','915','916') THEN 0 
			                           
			                   ELSE CAM1  END)  AS AM1,                                                                                                    
			               SUM(CASE WHEN CHB_CD IN('210','620','621','623','710','720','730', '800','810','820','830','840','850')                               
			                          OR CHB_CD IN('320','410','490','495','510','520','530', '611','910','911','912','913','914','915','916') THEN 0
			                   ELSE CAM2  END)  AS AM2,                                                                                                    
			               SUM(CASE WHEN CHB_CD IN('210','620','621','623','710','720','730', '800','810','820','830','840','850')                               
			                          OR CHB_CD IN('320','410','490','495','510','520','530', '611','910','911','912','913','914','915','916') THEN 0
			                   ELSE CAM3  END)  AS AM3,                                                                                                    
			               (NVL(SUM(CASE WHEN CHB_CD < '930' AND CHB_CD NOT IN('390','391','395','396','800','810','820','830','840','850') THEN 1 END), 0)                          
			              + NVL(SUM(CASE WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0 THEN 1 END),0)                                
			              + NVL(SUM(CASE WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0 THEN 1 END),0)                                
			              + NVL(SUM(CASE WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 THEN 1 END),0)
			              + NVL(SUM(CASE WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0 THEN 1 END),0)) AS GUNSU                       
			          FROM (SELECT SUBSTR(DETAIL.ENF_DT, 1, 6)      AS YYMM  ,                                                                         
			                       MASTER.ORG_DVSN_CD               AS KIKGU ,                                                                         
			                       DETAIL.COPT_OFI_CD               AS SOKIK ,                                                                         
			                       MASTER.DSP_RQ_KND_CD             AS CHB_CD,                                                                         
			                       NVL(DETAIL.NOP_CNT, 0)           AS CHB_SU,                                                                         
			                       NVL(DETAIL.PNL_DRIN_PSVT_AM, 0)  AS CAM1 ,                                                                         
			                       NVL(DETAIL.RSR_AM, 0)            AS CAM2 ,                                                                         
			                       NVL(DETAIL.SPLP_AM, 0)           AS CAM3
			                  FROM TBBADEAR001M MASTER,
			                       TBBADEAR002D DETAIL
			                 WHERE MASTER.AUD_YR      = DETAIL.AUD_YR
			                   AND MASTER.AUD_NO      = DETAIL.AUD_NO
			                   AND MASTER.DSP_RQ_SNO  = DETAIL.DSP_RQ_SNO
			                   AND DETAIL.ENF_DT      IS NOT NULL
			                   AND DETAIL.ENF_DT      BETWEEN #strStartFromDt# ||'01' AND #strStartToDt# ||'31'
			                   AND DETAIL.DTM_STA_CD != '0'                                                                                              
			               ) A                                                                                                                             
			         GROUP BY YYMM,                                                                                                                           
			                  KIKGU,                                                                                                                          
			                  SOKIK,                                                                                                             
			                 (CASE WHEN CHB_CD < '930' AND CHB_CD NOT IN('390','391','395','396','800','810','820','830','840','850')                 THEN CHB_CD                                      
			                       WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0      THEN '390'                                       
			                       WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) > 0      THEN '395'                                       
			                       WHEN CHB_CD < '800' AND CHB_CD IN ('390','391') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0      THEN '391'                                       
			                       WHEN CHB_CD < '800' AND CHB_CD IN ('395','396') AND (NVL(CAM1,0) + NVL(CAM2,0) + NVL(CAM3,0)) = 0      THEN '396'                                       
			                  ELSE NULL END)                                                                                                         
			       ) STKIKW_F                                                                                                                              
			 GROUP BY (CASE WHEN SUBSTR(KIKGU, 1, 1) = '1' THEN '1'                                                                                    
			                WHEN SUBSTR(KIKGU, 1, 1) = '2' THEN '2'                                                                                    
			                WHEN SUBSTR(KIKGU, 1, 1) = '3' THEN '3'                                                                                    
			            ELSE '4' END)
             ORDER BY KIKW
        ]]>
	</select>
	<!--##################### 처분요구 및 권고 통보사항/ 기관별 지적사항 끝 #################################-->
	
	<!--##################### 모범사례 및 기대효과 금액 시작 #################################-->
	<select id="BADEAR34QAmtselect2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT 
			    NVL(SUM(HAM1), 0) + NVL(SUM(HAM2), 0) + NVL(SUM(HAM3), 0) + NVL(SUM(HAM4), 0) + NVL(SUM(HAM5), 0) AS C0
			  , NVL(SUM(HAM1), 0) AS C1
			  , NVL(SUM(HAM2), 0) AS C2
			  , NVL(SUM(HAM3), 0) AS C3
			  , NVL(SUM(HAM4), 0) AS C4
			  , NVL(SUM(HAM5), 0) AS C5
			FROM 
			  (
			   SELECT 
			       DETAIL.ENF_BRDV_CD 
			     , NVL(DETAIL.BGT_RDC_AM       , 0) AS HAM1
			     , NVL(DETAIL.INC_ICR_AM       , 0) AS HAM2
			     , NVL(DETAIL.PPL_BDN_RDT_AM   , 0) AS HAM3
			     , NVL(DETAIL.FRTN_INCR_AM     , 0) AS HAM4
			     , NVL(DETAIL.EXPN_RTNL_AM     , 0) AS HAM5
			   FROM  
			       TBBADEAR001M   MASTER
			     , TBBADEAR002D DETAIL
			   WHERE  MASTER.AUD_YR = DETAIL.AUD_YR
			   AND  MASTER.AUD_NO  = DETAIL.AUD_NO
			   AND  MASTER.DSP_RQ_SNO = DETAIL.DSP_RQ_SNO
			   AND  DETAIL.ENF_DT     IS NOT NULL
			   AND  substr(DETAIL.ENF_DT,1,6)     BETWEEN #strStartFromDt#  AND #strStartToDt# 
			   AND  (DETAIL.EPT_EFCT_AM_STA_CD = '1' OR (SUBSTR(DETAIL.ENF_DT, 1, 6) >= '199701' AND DETAIL.DTM_STA_CD != '0'))
			  ) APCHB0_F
        ]]>
	</select>	
	
	<select id="BADEAR34QMobumselect2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
                        WITH  BASE AS
			(
			    SELECT SUBSTR(DETAIL.ENF_DT, 1, 6) AS YYMM ,
			           MASTER.ORG_DVSN_CD          AS KIKGU ,
			           DETAIL.ENF_BRDV_CD          AS DEPT ,
			           MASTER.DSP_RQ_KND_CD        AS CHB_CD,
			           NVL(DETAIL.NOP_CNT, 0)      AS CHB_SU,
			           NVL(DETAIL.ORG_CNT, 0)      AS KWSU,
			           DETAIL.ENF_DT
			      FROM TBBADEAR001M MASTER,
			           TBBADEAR002D DETAIL
			     WHERE MASTER.AUD_YR = DETAIL.AUD_YR
			       AND MASTER.AUD_NO = DETAIL.AUD_NO
			       AND MASTER.DSP_RQ_SNO = DETAIL.DSP_RQ_SNO
			       AND DETAIL.ENF_DT IS NOT NULL
			       AND DETAIL.DTM_STA_CD != '0' 
			       AND MASTER.DSP_RQ_KND_CD IN ('800','810', '820','830','840','850')
			
			)
			
			SELECT A.GUBUN      AS GUBUN ,                                                                                               
			       A.GUBUN2     AS GUBUN2,                                                                                               
			       A.C1         AS C1    ,                                                                                               
			       A.C2         AS C2    ,                                                                                               
			       A.C3         AS C3    ,                                                                                               
			       B.C1         AS C4    ,                                                                                               
			       B.C2         AS C5    ,                                                                                               
			       B.C3         AS C6    ,                                                                                               
			       A.C1 - B.C1  AS C7    ,                                                                                               
			       A.C2 - B.C2  AS C8    ,                                                                                               
			       A.C3 - B.C3  AS C9       
			FROM (
			        SELECT '5' AS C0 ,
			               '모범 사례' AS GUBUN ,
			               'C' AS GUBUN2,
			               NVL(SUM(INGUN), 0) + NVL(SUM(KIKGUN), 0) AS C1 ,
			               0 AS C2 ,
			               NVL(SUM(INSU), 0) AS C3
			         FROM 
			               (
			                SELECT YYMM AS YYMM ,
			                       KIKGU AS KIKGU ,
			                       SUBSTR(DEPT, 1, 2) AS DEPT,
			                       CHB_CD AS CHBCD ,
			                       SUM(CASE WHEN NVL(CHB_SU, 0) > 0 THEN 0
			                           ELSE 1
			                           END) AS KIKGUN,
			                       SUM(CASE WHEN NVL(CHB_SU, 0) > 0 THEN 0
			                                WHEN NVL(CHB_SU, 0) <= 0 AND NVL(KWSU, 0) = 0 THEN 1
			                           ELSE KWSU
			                        END) AS KISU,
			                       SUM(CASE WHEN NVL(CHB_SU, 0) > 0 THEN 1
			                           ELSE 0
			                           END) AS INGUN,
			                       SUM(CASE WHEN NVL(CHB_SU, 0) > 0 THEN NVL(CHB_SU, 0)
			                           ELSE 0
			                           END) AS INSU
			                FROM BASE 
			                WHERE 1=1
			                AND SUBSTR(ENF_DT,1,6) BETWEEN #strStartFromDt# AND #strStartToDt#
			                GROUP BY YYMM,
			                         KIKGU,
			                         SUBSTR(DEPT, 1, 2) ,
			                         CHB_CD 
			                )
			        ) A,
			        
			        (
			         SELECT NVL(SUM(INGUN), 0) + NVL(SUM(KIKGUN), 0) AS C1 ,
			                0 AS C2 ,
			                NVL(SUM(INSU), 0) AS C3
			         FROM 
			               (
			                SELECT YYMM AS YYMM ,
			                       KIKGU AS KIKGU ,
			                       SUBSTR(DEPT, 1, 2) AS DEPT,
			                       CHB_CD AS CHBCD ,
			                       SUM(CASE WHEN NVL(CHB_SU, 0) > 0 THEN 0
			                           ELSE 1
			                           END) AS KIKGUN,
			                       SUM(CASE WHEN NVL(CHB_SU, 0) > 0 THEN 0
			                                WHEN NVL(CHB_SU, 0) <= 0 AND NVL(KWSU, 0) = 0 THEN 1
			                           ELSE KWSU
			                        END) AS KISU,
			                       SUM(CASE WHEN NVL(CHB_SU, 0) > 0 THEN 1
			                           ELSE 0
			                           END) AS INGUN,
			                       SUM(CASE WHEN NVL(CHB_SU, 0) > 0 THEN NVL(CHB_SU, 0)
			                           ELSE 0
			                           END) AS INSU
			                FROM BASE 
			                WHERE 1=1
			                AND SUBSTR(ENF_DT,1,6) BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(#strStartFromDt#||'01') ,-12),'YYYYMM') /*1년전*/
			                                      AND TO_CHAR(ADD_MONTHS(TO_DATE(#strStartToDt#||'01')  , -12),'YYYYMM') /*1년전*/
			                GROUP BY YYMM,
			                         KIKGU,
			                         SUBSTR(DEPT, 1, 2) ,
			                         CHB_CD 
			                )
			         ) B
        ]]>
	</select>
	<!--##################### 모범사례 및 기대효과 금액 끝 #################################-->
	
	<!--##################### 사무별 지적사항 시작 #################################-->
	<select id="BADEAR34Qselect3" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			WITH TMP_TIT_TXT AS 
			(
			        SELECT 'A' AS GUBUN1, '합            계'   AS GUBUN2, '000' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'B' AS GUBUN1, '회 계 사 항 계'       AS GUBUN2, '000' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'C' AS GUBUN1, '세  입  소  계'         AS GUBUN2, 'C01' AS A0 FROM DUAL
			        UNION ALL 
			        SELECT 'D' AS GUBUN1, '세  출  소  계'         AS GUBUN2, 'D01' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'E' AS GUBUN1, '재산관리소계'           AS GUBUN2, 'E01' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'F' AS GUBUN1, '기업 관리 소계'         AS GUBUN2, 'F01' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'G' AS GUBUN1, '계  산  증  명'         AS GUBUN2, 'G01' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'H' AS GUBUN1, '감 찰 사 항 계'         AS GUBUN2, '000' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'I' AS GUBUN1, '기획 · 인사 · 조직'   AS GUBUN2, 'I01' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'I' AS GUBUN1, '문서 · 협조'           AS GUBUN2, 'I02' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'I' AS GUBUN1, '규 제 행 정'            AS GUBUN2, 'I03' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'I' AS GUBUN1, '검 사 검 정'            AS GUBUN2, 'I04' AS A0 FROM DUAL
			        UNION ALL
			        SELECT 'I' AS GUBUN1, '인.허 가 사 무'         AS GUBUN2, 'I05' AS A0 FROM DUAL
			)
			
			SELECT TIT_TXT.GUBUN1      AS GUBUN1, 
			       TIT_TXT.GUBUN2      AS GUBUN2, 
			       TIT_TXT.A0          AS A0    , 
			       NVL(MAIN.B1,0)      AS B1    ,
			       NVL(MAIN.B2,0)      AS B2    ,
			       NVL(MAIN.B3,0)      AS B3    ,
			       NVL(MAIN.B4,0)      AS B4
			  FROM (SELECT (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) IN ('1', '2') THEN 'A'
			                END)           AS GUBUN1,
			               (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) IN ('1', '2') THEN '000'
			                END)           AS A0,
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) THEN 1
			                   ELSE 0 END) AS B1,
			               
			               /* 처분요구종류코드 조건 추가 - 2015.07.30 yyh */
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6)  AND (MASTER.DSP_RQ_KND_CD = '110' OR SUBSTR(MASTER.DSP_RQ_KND_CD,1,1) = '3') THEN ROUND(DETAIL.PNL_DRIN_PSVT_AM/1000,1)
			                   ELSE 0 END) AS B2,
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6)  AND (MASTER.DSP_RQ_KND_CD = '110' OR MASTER.DSP_RQ_KND_CD IN ('310','320','390','391','395','396')) THEN ROUND((NVL(DETAIL.RSR_AM,0)+NVL(DETAIL.SPLP_AM,0))/1000,1)
			                   ELSE 0 END) AS B3,
			                   
			               /* 
			               * 610 제외 - 2015.07.30 yyh 
			               * NOT IN -> IN 으로 변경  - 2016.01.29 yyh
			               */
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) 
			                             /* AND MASTER.DSP_RQ_KND_CD NOT IN ('110','310','320','390','391','410','490','510','520','530', */
			                                                             /*  '610','611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */
			                                                             /* '611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */
			                                AND MASTER.DSP_RQ_KND_CD IN ('210','620','621','710','720','730','623')  THEN DETAIL.NOP_CNT
			                   ELSE 0 END) AS B4
			          FROM TBBADEAR002D DETAIL,
			               TBBADEAR001M   MASTER
			         WHERE DETAIL.AUD_YR = MASTER.AUD_YR
			           AND DETAIL.AUD_NO  = MASTER.AUD_NO
			           AND DETAIL.DSP_RQ_SNO = MASTER.DSP_RQ_SNO
			           AND DETAIL.ENF_DT BETWEEN #strStartFromDt# AND #strStartToDt#
			           AND MASTER.DSP_RQ_KND_CD < '800'
			           AND DETAIL.DTM_STA_CD != '0'
			           AND (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) IN ('1', '2') THEN 'A'
			                END) IS NOT NULL
			         GROUP
			            BY (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) IN ('1', '2') THEN 'A'
			                END),
			               (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) IN ('1', '2') THEN '000'
			                END)
			        UNION ALL
			        SELECT (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) = '1' THEN 'B'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) = '2' THEN 'H'
			                END)       AS GUBUN1,
			               (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) IN ('1', '2') THEN '000'
			                END)       AS A0,
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) THEN 1
			                   ELSE 0 END) AS B1,
			                   
			               /* 처분요구종류코드 조건 추가 - 2015.07.30 yyh */
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) AND (MASTER.DSP_RQ_KND_CD = '110' OR SUBSTR(MASTER.DSP_RQ_KND_CD,1,1) = '3') THEN ROUND(DETAIL.PNL_DRIN_PSVT_AM/1000,1)
			                   ELSE 0 END) AS B2,
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) AND (MASTER.DSP_RQ_KND_CD = '110' OR MASTER.DSP_RQ_KND_CD IN ('310','320','390','391','395','396')) THEN ROUND((NVL(DETAIL.RSR_AM,0)+NVL(DETAIL.SPLP_AM,0))/1000,1)
			                   ELSE 0 END) AS B3,
			                   
			              /* 
			               * 610 제외 - 2015.07.30 yyh 
			               * NOT IN -> IN 으로 변경  - 2016.01.29 yyh
			               */
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) 
			                             /* AND MASTER.DSP_RQ_KND_CD NOT IN ('110','310','320','390','391','410','490','510','520','530', */
			                                                         /*     '610','611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */
			                                                         /*     '611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */
			                               AND MASTER.DSP_RQ_KND_CD IN ('210','620','621','710','720','730','623')  THEN DETAIL.NOP_CNT    
			                   ELSE 0 END) AS B4
			          FROM TBBADEAR002D DETAIL,
			               TBBADEAR001M MASTER
			         WHERE DETAIL.AUD_YR = MASTER.AUD_YR
			           AND DETAIL.AUD_NO  = MASTER.AUD_NO
			           AND DETAIL.DSP_RQ_SNO = MASTER.DSP_RQ_SNO
			           AND DETAIL.ENF_DT BETWEEN #strStartFromDt# AND #strStartToDt#
			           AND MASTER.DSP_RQ_KND_CD < '800'
			           AND DETAIL.DTM_STA_CD != '0'
			           AND (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) = '1' THEN 'B'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) = '2' THEN 'H'
			                END) IS NOT NULL
			         GROUP BY (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) = '1' THEN 'B'
			                        WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) = '2' THEN 'H'
			                   END),
			                  (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD, 1, 1) IN ('1', '2') THEN '000'
			                   END)
			         UNION ALL
			         SELECT (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1' 
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','013','014')                                                 THEN 'C'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('021','022','023','024','025','026','027','028')                         THEN 'D'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('041','031','032','033','042','043','044','045','046')                   THEN 'E'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('081','082','083')                                                       THEN 'G'
			                 END) AS GUBUN1,
			                (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1' 
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','013','014')                                                 THEN 'C01'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('021','022','023','024','025','026','027','028')                         THEN 'D01'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('041','031','032','033','042','043','044','045','046')                   THEN 'E01'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F01'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('081','082','083')                                                       THEN 'G01'
			                 END) AS A0,
			           SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) THEN 1
			               ELSE 0 END)       AS B1,
			               
			           /* 처분요구종류코드 조건 추가 - 2015.07.30 yyh */
			           SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) AND (MASTER.DSP_RQ_KND_CD = '110' OR SUBSTR(MASTER.DSP_RQ_KND_CD,1,1) = '3') THEN ROUND(DETAIL.PNL_DRIN_PSVT_AM/1000,1)
			               ELSE 0 END)       AS B2,
			           SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) AND (MASTER.DSP_RQ_KND_CD = '110' OR MASTER.DSP_RQ_KND_CD IN ('310','320','390','391','395','396')) THEN ROUND((NVL(DETAIL.RSR_AM,0)+NVL(DETAIL.SPLP_AM,0))/1000,1)
			               ELSE 0 END)       AS B3,
			               
			               /* 
			               * 610 제외 - 2015.07.30 yyh 
			               * NOT IN -> IN 으로 변경  - 2016.01.29 yyh
			               */
			           SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) 
			                         /* AND MASTER.DSP_RQ_KND_CD NOT IN ('110','310','320','390','391','410','490','510','520','530', */
			                                                         /* '610','611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */
			                                                         /* '611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */
			                            AND MASTER.DSP_RQ_KND_CD IN ('210','620','621','710','720','730','623')  THEN DETAIL.NOP_CNT   
			               ELSE 0 END)       AS B4
			      FROM TBBADEAR002D   DETAIL,
			           TBBADEAR001M   MASTER
			     WHERE DETAIL.AUD_YR  = MASTER.AUD_YR
			       AND DETAIL.AUD_NO  = MASTER.AUD_NO
			       AND DETAIL.DSP_RQ_SNO = MASTER.DSP_RQ_SNO
			       AND DETAIL.ENF_DT BETWEEN #strStartFromDt# AND #strStartToDt#
			       AND MASTER.DSP_RQ_KND_CD < '800'
			       AND DETAIL.DTM_STA_CD != '0'
			       AND (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1' 
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','013','014')                                                 THEN 'C'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('021','022','023','024','025','026','027','028')                         THEN 'D'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('041','031','032','033','042','043','044','045','046')                   THEN 'E'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('081','082','083')                                                       THEN 'G'
			            END) IS NOT NULL
			       GROUP BY (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1' 
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','013','014')                                                 THEN 'C'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('021','022','023','024','025','026','027','028')                         THEN 'D'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('041','031','032','033','042','043','044','045','046')                   THEN 'E'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('081','082','083')                                                       THEN 'G'
			                  END),
			                (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1' 
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','013','014')                                                 THEN 'C01'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('021','022','023','024','025','026','027','028')                         THEN 'D01'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('041','031','032','033','042','043','044','045','046')                   THEN 'E01'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F01'
			                      WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                       AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('081','082','083')                                                       THEN 'G01'
			                 END)
			        UNION ALL
			        SELECT (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','013','014')                                                  THEN 'C'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('021','022','023','024','025','026','027','028')                          THEN 'D'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('041','031','032','033','042','043','044','045','046')                    THEN 'E'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                           AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2'                                                                         THEN 'I'
			                END)             AS GUBUN1,
			               (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','014','021','022','024')                                      THEN 'I01'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('013','015','023','025')                                                  THEN 'I02'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('016','026')                                                              THEN 'I03'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('017','027')                                                              THEN 'I04'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('018','019','028','029')                                                  THEN 'I05'
			                END ) AS A0 ,
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) THEN 1
			                   ELSE 0 END)                                       AS B1,
			                   
			               /* 처분요구종류코드 조건 추가 - 2015.07.30 yyh */
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) AND (MASTER.DSP_RQ_KND_CD = '110' OR SUBSTR(MASTER.DSP_RQ_KND_CD,1,1) = '3') THEN ROUND(DETAIL.PNL_DRIN_PSVT_AM/1000,1)
			                   ELSE 0 END)                                       AS B2,
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) AND (MASTER.DSP_RQ_KND_CD = '110' OR MASTER.DSP_RQ_KND_CD IN ('310','320','390','391','395','396')) THEN ROUND((NVL(DETAIL.RSR_AM,0)+NVL(DETAIL.SPLP_AM,0))/1000,1)
			                   ELSE 0 END)                                       AS B3,
			                   
			               /* 
			               * 610 제외 - 2015.07.30 yyh 
			               * NOT IN -> IN 으로 변경  - 2016.01.29 yyh
			               */
			               SUM(CASE WHEN SUBSTR(DETAIL.ENF_DT,1,6) BETWEEN SUBSTR(#strStartFromDt#,1,6) AND SUBSTR(#strStartToDt#  ,1,6) 
			                             /* AND MASTER.DSP_RQ_KND_CD NOT IN ('110','310','320','390','391','410','490','510','520','530', */
			                                                             /* '610','611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */
			                                                             /* '611','630','910','911','912','913','914','915','916') THEN DETAIL.NOP_CNT */
			                                AND MASTER.DSP_RQ_KND_CD IN ('210','620','621','710','720','730','623')  THEN DETAIL.NOP_CNT  
			                   ELSE 0 END)                                       AS B4
			          FROM TBBADEAR002D DETAIL,
			               TBBADEAR001M   MASTER
			         WHERE DETAIL.AUD_YR = MASTER.AUD_YR
			           AND DETAIL.AUD_NO  = MASTER.AUD_NO
			           AND DETAIL.DSP_RQ_SNO = MASTER.DSP_RQ_SNO
			           AND DETAIL.ENF_DT BETWEEN #strStartFromDt# AND #strStartToDt#
			           AND MASTER.DSP_RQ_KND_CD < '800'
			           AND DETAIL.DTM_STA_CD != '0'
			           AND (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','013','014')                                                  THEN 'C'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('021','022','023','024','025','026','027','028')                          THEN 'D'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('041','031','032','033','042','043','044','045','046')                    THEN 'E'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                           AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2'                                                                         THEN 'I'
			                END) IS NOT NULL
			         GROUP
			            BY (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','013','014')                                                  THEN 'C'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('021','022','023','024','025','026','027','028')                          THEN 'D'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('041','031','032','033','042','043','044','045','046')                    THEN 'E'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '1'
			                           AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('051','061','062','063','064','065','066','067','072','073','071','068') THEN 'F'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2'                                                                         THEN 'I'
			                END),
			               (CASE WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('011','012','014','021','022','024')                                      THEN 'I01'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('013','015','023','025')                                                  THEN 'I02'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('016','026')                                                              THEN 'I03'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('017','027')                                                              THEN 'I04'
			                     WHEN SUBSTR(DETAIL.WRDO_TYP_CD,1,1) = '2' 
			                      AND SUBSTR(DETAIL.WRDO_TYP_CD,2,3) IN ('018','019','028','029')                                                  THEN 'I05'
			                END)
			       ) MAIN,
			       TMP_TIT_TXT TIT_TXT
			 WHERE MAIN.GUBUN1(+) = TIT_TXT.GUBUN1
			   AND MAIN.A0    (+) = TIT_TXT.A0 
			 ORDER BY TIT_TXT.GUBUN1, TIT_TXT.A0
        ]]>
	</select>	
	<!--##################### 사무별 지적사항 끝 #################################-->
	
	<!--##################### 처분요구 신분상 조치상황 시작 #################################-->
	<!-- 국가기관 해당 쿼리 -->
	<select id="BADEAR34Qselect4-1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT   '3급 이상' AS JIKGUB,  /*구분명칭*/
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '001' THEN AA.C1 ELSE 0 END),0) AS DMS, /*파면*/
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '006' OR AA.HND_RQ_KND_CD = '007' THEN C1 ELSE 0 END),0) AS PRS, /*고발*/
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '002' OR AA.HND_RQ_KND_CD = '003' OR AA.HND_RQ_KND_CD = '013' THEN C1 ELSE 0 END),0) AS PNSH_ASSIGN,  /*징계_지정*/
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '004' THEN AA.C1 ELSE 0 END),0) AS PNSH, /*징계_부지정*/
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '009' THEN AA.C1 ELSE 0 END),0) AS REQ, /*수사요청*/
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '005' THEN AA.C1 ELSE 0 END),0) AS REPORT, /*통보(인사자료)*/
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '015' THEN AA.C1 ELSE 0 END),0) AS CORRUPTION /*통보(비위)*/
			FROM (SELECT B.HND_RQ_KND_CD
			            ,1 AS C1
			       FROM TBBADEAR002D A
			           ,TBBADEAR001M C
			           ,TBBADEAR007M B
			     WHERE (A.ENF_DT >= #strStartFromDt#
			       AND A.ENF_DT <= #strStartToDt#)
			       AND C.DSP_RQ_KND_CD NOT LIKE '8%'
			       AND A.AUD_NO = C.AUD_NO
			       AND A.DSP_RQ_SNO = C.DSP_RQ_SNO 
			       AND A.AUD_YR = C.AUD_YR 
			       AND A.AUD_NO = B.AUD_NO
			       AND A.DSP_RQ_SNO = B.DSP_RQ_SNO 
			       AND A.AUD_YR = B.AUD_YR
			       AND C.ORG_DVSN_CD LIKE '10'
			       AND B.RANK_CD IN ('01', '02', '03', '61', '62')
			       AND A.DTM_STA_CD != '0'
			     ) AA
			UNION ALL
			SELECT  '4급 이하' AS JIKGUB,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '001' THEN BB.C2 ELSE 0 END),0) AS DMS,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '006' OR BB.HND_RQ_KND_CD = '007' THEN BB.C2 ELSE 0 END),0) AS PRS,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '002' OR BB.HND_RQ_KND_CD = '003' OR BB.HND_RQ_KND_CD = '013' THEN BB.C2 ELSE 0 END),0) AS PNSH_ASSIGN,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '004' THEN BB.C2 ELSE 0 END),0) AS PNSH,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '009' THEN BB.C2 ELSE 0 END),0) AS REQ,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '005' THEN BB.C2 ELSE 0 END),0) AS REPORT,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '015' THEN BB.C2 ELSE 0 END),0) AS CORRUPTION
			FROM (SELECT B.HND_RQ_KND_CD
			            ,1 AS C2
			       FROM TBBADEAR002D A
			           ,TBBADEAR001M C
			           ,TBBADEAR007M B
			      WHERE (A.ENF_DT >= #strStartFromDt#
			        AND A.ENF_DT <= #strStartToDt#)
			        AND C.DSP_RQ_KND_CD NOT LIKE '8%'
			        AND A.AUD_NO = C.AUD_NO
			        AND A.DSP_RQ_SNO = C.DSP_RQ_SNO 
			        AND A.AUD_YR = C.AUD_YR 
			        AND A.AUD_NO = B.AUD_NO
			        AND A.DSP_RQ_SNO = B.DSP_RQ_SNO 
			        AND A.AUD_YR = B.AUD_YR
			        AND C.ORG_DVSN_CD LIKE '10'
			        AND (B.RANK_CD NOT IN ('01', '02', '03', '61', '62') OR B.RANK_CD IS NULL) /* null 체크 추가 - 2016.02.01 yyh */
			        AND A.DTM_STA_CD != '0'
			     ) BB
        ]]>
	</select>	
	
	<!-- 자치 단체 해당 쿼리 -->
	<select id="BADEAR34Qselect4-2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT   '4급 이상' AS JIKGUB,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '001' THEN AA.C1 ELSE 0 END),0) AS DMS,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '006' OR AA.HND_RQ_KND_CD = '007' 
			         THEN C1 ELSE 0 END),0) AS PRS,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '002' OR AA.HND_RQ_KND_CD = '003' OR AA.HND_RQ_KND_CD = '013'
			         THEN C1 ELSE 0 END),0) AS PNSH_ASSIGN,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '004' THEN AA.C1 ELSE 0 END),0) AS PNSH,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '009' THEN AA.C1 ELSE 0 END),0) AS REQ,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '005' THEN AA.C1 ELSE 0 END),0) AS REPORT,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '015' THEN AA.C1 ELSE 0 END),0) AS CORRUPTION
			FROM (SELECT B.HND_RQ_KND_CD
			            ,1 AS C1
			        FROM TBBADEAR002D A ,
			             TBBADEAR001M C,
			             TBBADEAR007M B
			        WHERE A.ENF_DT >= #strFromYm# ||'01'
			          AND A.ENF_DT <= #strToYm# ||'31'
			          AND C.DSP_RQ_KND_CD NOT LIKE '8%'
			          AND A.AUD_NO = C.AUD_NO
			          AND A.DSP_RQ_SNO = C.DSP_RQ_SNO 
			          AND A.AUD_YR = C.AUD_YR 
			          AND A.AUD_NO = B.AUD_NO
			          AND A.DSP_RQ_SNO = B.DSP_RQ_SNO 
			          AND A.AUD_YR = B.AUD_YR
			          AND C.ORG_DVSN_CD LIKE '2%'
			          AND B.RANK_CD IN ('01', '02', '03', '04', '61', '62')
			          AND A.DTM_STA_CD != '0'
			     ) AA
			UNION ALL
			SELECT   '5급 이하' AS JIKGUB,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '001' THEN BB.C2 ELSE 0 END),0) AS DMS,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '006' OR BB.HND_RQ_KND_CD = '007' 
			         THEN BB.C2 ELSE 0 END),0) AS PRS,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '002' OR BB.HND_RQ_KND_CD = '003' OR BB.HND_RQ_KND_CD = '013'
			         THEN BB.C2 ELSE 0 END),0) AS PNSH_ASSIGN,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '004' THEN BB.C2 ELSE 0 END),0) AS PNSH,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '009' THEN BB.C2 ELSE 0 END),0) AS REQ,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '005' THEN BB.C2 ELSE 0 END),0) AS REPORT,
			         NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '015' THEN BB.C2 ELSE 0 END),0) AS CORRUPTION
			FROM (SELECT B.HND_RQ_KND_CD
			            ,1 AS C2
			        FROM TBBADEAR002D A,
			             TBBADEAR001M C,
			             TBBADEAR007M B
			       WHERE A.ENF_DT >= #strFromYm# ||'01'
			         AND A.ENF_DT <= #strToYm# ||'31'
			         AND C.DSP_RQ_KND_CD NOT LIKE '8%'
			         AND A.AUD_NO = C.AUD_NO
			         AND A.DSP_RQ_SNO = C.DSP_RQ_SNO 
			         AND A.AUD_YR = C.AUD_YR 
			         AND A.AUD_NO = B.AUD_NO
			         AND A.DSP_RQ_SNO = B.DSP_RQ_SNO 
			         AND A.AUD_YR = B.AUD_YR
			         AND C.ORG_DVSN_CD LIKE '2%'
			         AND (B.RANK_CD NOT IN ('01', '02', '03', '04', '61', '62') OR B.RANK_CD IS NULL) /* null 체크 추가 - 2016.02.01 yyh */
			         AND A.DTM_STA_CD != '0'
			      ) BB
        ]]>
	</select>
	
	<!-- 투자기관 해당쿼리 -->
	<select id="BADEAR34Qselect4-3" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			 SELECT  '2급 이상' AS JIKGUB,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '001' THEN AA.C1 ELSE 0 END),0) AS DMS,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '006' OR AA.HND_RQ_KND_CD = '007' 
			         THEN C1 ELSE 0 END),0) AS PRS,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '002' OR AA.HND_RQ_KND_CD = '003' OR AA.HND_RQ_KND_CD = '013'
			         THEN C1 ELSE 0 END),0) AS PNSH_ASSIGN,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '004' THEN AA.C1 ELSE 0 END),0) AS PNSH,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '009' THEN AA.C1 ELSE 0 END),0) AS REQ,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '005' THEN AA.C1 ELSE 0 END),0) AS REPORT,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '015' THEN AA.C1 ELSE 0 END),0) AS CORRUPTION
			FROM (SELECT B.HND_RQ_KND_CD
			        , 1 AS C1
			        FROM TBBADEAR002D A,
			             TBBADEAR001M C,
			             TBBADEAR007M B
			       WHERE A.ENF_DT >= #strFromYm# ||'01'
			         AND A.ENF_DT <= #strToYm# ||'31'
			         AND C.DSP_RQ_KND_CD NOT LIKE '8%'
			         AND A.AUD_NO = C.AUD_NO
			         AND A.DSP_RQ_SNO = C.DSP_RQ_SNO 
			         AND A.AUD_YR = C.AUD_YR 
			         AND A.AUD_NO = B.AUD_NO
			         AND A.DSP_RQ_SNO = B.DSP_RQ_SNO 
			         AND A.AUD_YR = B.AUD_YR
			         AND C.ORG_DVSN_CD LIKE '30'
			         AND B.RANK_CD IN ('01', '02', '61')
			         AND A.DTM_STA_CD != '0'
			      ) AA
			UNION ALL
			SELECT  '3급 이하' AS JIKGUB,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '001' THEN BB.C2 ELSE 0 END),0) AS DMS,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '006' OR BB.HND_RQ_KND_CD = '007' 
			        THEN BB.C2 ELSE 0 END),0) AS PRS,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '002' OR BB.HND_RQ_KND_CD = '003' OR BB.HND_RQ_KND_CD = '013'
			        THEN BB.C2 ELSE 0 END),0) AS PNSH_ASSIGN,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '004' THEN BB.C2 ELSE 0 END),0) AS PNSH,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '009' THEN BB.C2 ELSE 0 END),0) AS REQ,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '005' THEN BB.C2 ELSE 0 END),0) AS REPORT,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '015' THEN BB.C2 ELSE 0 END),0) AS CORRUPTION
			 FROM (SELECT B.HND_RQ_KND_CD
			              ,1 AS C2
			        FROM TBBADEAR002D A,
			             TBBADEAR001M C,
			             TBBADEAR007M B
			       WHERE A.ENF_DT >= #strFromYm# ||'01'
			         AND A.ENF_DT <= #strToYm# ||'31'
			         AND C.DSP_RQ_KND_CD NOT LIKE '8%'
			         AND A.AUD_NO = C.AUD_NO
			         AND A.DSP_RQ_SNO = C.DSP_RQ_SNO 
			         AND A.AUD_YR = C.AUD_YR 
			         AND A.AUD_NO = B.AUD_NO
			         AND A.DSP_RQ_SNO = B.DSP_RQ_SNO 
			         AND A.AUD_YR = B.AUD_YR
			         AND C.ORG_DVSN_CD LIKE '30'
			         AND (B.RANK_CD NOT IN ('01', '02', '61') OR B.RANK_CD IS NULL) /* null 체크 추가 - 2016.02.01 yyh */
			         AND A.DTM_STA_CD != '0'
			        ) BB
        ]]>
	</select>
	
	<!-- 기타 해당 쿼리 -->
	<select id="BADEAR34Qselect4-4" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT 
			         '2급 이상' AS JIKGUB,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '001' THEN AA.C1 ELSE 0 END),0) AS DMS,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '006' OR AA.HND_RQ_KND_CD = '007' 
			         THEN C1 ELSE 0 END),0) AS PRS,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '002' OR AA.HND_RQ_KND_CD = '003' OR AA.HND_RQ_KND_CD = '013'
			         THEN C1 ELSE 0 END),0) AS PNSH_ASSIGN,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '004' THEN AA.C1 ELSE 0 END),0) AS PNSH,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '009' THEN AA.C1 ELSE 0 END),0) AS REQ,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '005' THEN AA.C1 ELSE 0 END),0) AS REPORT,
			         NVL(SUM(CASE WHEN AA.HND_RQ_KND_CD = '015' THEN AA.C1 ELSE 0 END),0) AS CORRUPTION
			 FROM (SELECT B.HND_RQ_KND_CD
			             ,1 AS C1
			        FROM TBBADEAR002D A,
			             TBBADEAR001M C,
			             TBBADEAR007M B
			       WHERE A.ENF_DT >= #strFromYm# ||'01'
			         AND A.ENF_DT <= #strToYm# ||'31'
			         AND C.DSP_RQ_KND_CD NOT LIKE '8%'
			         AND A.AUD_NO = C.AUD_NO
			         AND A.DSP_RQ_SNO = C.DSP_RQ_SNO 
			         AND A.AUD_YR = C.AUD_YR 
			         AND A.AUD_NO = B.AUD_NO
			         AND A.DSP_RQ_SNO = B.DSP_RQ_SNO 
			         AND A.AUD_YR = B.AUD_YR
			         AND (C.ORG_DVSN_CD NOT IN ('10', '21', '22', '30') OR C.ORG_DVSN_CD IS NULL)
			         AND B.RANK_CD IN ('01', '02', '61')
			         AND A.DTM_STA_CD != '0'
			       ) AA
			UNION ALL
			SELECT  '3급 이하' AS JIKGUB,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '001' THEN BB.C2 ELSE 0 END),0) AS DMS,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '006' OR BB.HND_RQ_KND_CD = '007' 
			        THEN BB.C2 ELSE 0 END),0) AS PRS,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '002' OR BB.HND_RQ_KND_CD = '003' OR BB.HND_RQ_KND_CD = '013'
			        THEN BB.C2 ELSE 0 END),0) AS PNSH_ASSIGN,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '004' THEN BB.C2 ELSE 0 END),0) AS PNSH,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '009' THEN BB.C2 ELSE 0 END),0) AS REQ,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '005' THEN BB.C2 ELSE 0 END),0) AS REPORT,
			        NVL(SUM(CASE WHEN BB.HND_RQ_KND_CD = '015' THEN BB.C2 ELSE 0 END),0) AS CORRUPTION
			 FROM (SELECT B.HND_RQ_KND_CD
			            ,1 AS C2
			        FROM TBBADEAR002D A,
			             TBBADEAR001M C,
			             TBBADEAR007M B
			       WHERE A.ENF_DT >= #strFromYm# ||'01'
			         AND A.ENF_DT <= #strToYm# ||'31'
			         AND C.DSP_RQ_KND_CD NOT LIKE '8%'
			         AND A.AUD_NO = C.AUD_NO
			         AND A.DSP_RQ_SNO = C.DSP_RQ_SNO 
			         AND A.AUD_YR = C.AUD_YR 
			         AND A.AUD_NO = B.AUD_NO
			         AND A.DSP_RQ_SNO = B.DSP_RQ_SNO 
			         AND A.AUD_YR = B.AUD_YR
			         AND (C.ORG_DVSN_CD NOT IN ('10', '21', '22', '30') OR C.ORG_DVSN_CD IS NULL)
			         AND (B.RANK_CD NOT IN ('01', '02', '61') OR B.RANK_CD IS NULL) /* null 체크 추가 - 2016.02.01 yyh */
			         AND A.DTM_STA_CD != '0'
			      ) BB
        ]]>
	</select>
	<!--##################### 처분요구 신분상 조치상황 끝 #################################-->
	
	<!--##################### 집행전말 처리상황 시작 #################################-->
	<!-- 건수 -->
	<select id="BADEAR34Qselect5-1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			WITH BASE AS (
			
			    SELECT SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT < C.FDATE THEN 1
			                    WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT < C.FDATE AND DE04.ENFM_WHLS_DTM_DT >= C.FDATE THEN 1
			               ELSE 0
			               END) AS OVER_YEAR_CNT ,
			           SUM(CASE WHEN DE04.ENF_DT BETWEEN C.FDATE AND C.TDATE THEN 1
			               ELSE 0
			               END) AS NEW_OPER_CNT ,
			           SUM(CASE WHEN DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT BETWEEN C.FDATE AND C.TDATE THEN 1
			               ELSE 0
			               END) AS ENFO_CNT ,
			           SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND MAIN.DSP_RQ_KND_CD IN ('110', '210', '310', '320', '391') AND DE04.HNDL_DDLN_DT <= C.TDATE THEN 1
			                    WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND MAIN.DSP_RQ_KND_CD IN ('110', '210', '310', '320', '391') AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT <= C.TDATE THEN 1
			               ELSE 0
			               END) AS NENFO_INDLINE_CNT ,
			           SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND ((MAIN.DSP_RQ_KND_CD IN ('110', '210','310','320','391')  AND DE04.HNDL_DDLN_DT > C.TDATE)
			                                                                              OR MAIN.DSP_RQ_KND_CD LIKE '5%'
			                                                                              OR MAIN.DSP_RQ_KND_CD LIKE '6%') THEN 1
			                    WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND ((MAIN.DSP_RQ_KND_CD IN ('110','210','310','320','391') AND DE04.HNDL_DDLN_DT > C.TDATE)
			                                                                                                                 OR MAIN.DSP_RQ_KND_CD LIKE '5%'
			                                                                                                                 OR MAIN.DSP_RQ_KND_CD LIKE '6%') THEN 1
			               ELSE 0
			               END) AS NENFO_OUTDLINE_CNT
			      FROM TBBADEAR002D DE04,
			           TBBADEAR001M MAIN,
			           (SELECT  #strYear# || '0101' /*월일 0101고정*/ FDATE
			                   ,TO_CHAR(LAST_DAY(TO_DATE(#strStartFromDt#,'YYYYMM')),'YYYYMMDD') /*해당년월의 마지막일자 산출*/  AS  TDATE  
			            FROM DUAL) C
			     WHERE 1=1
			       AND DE04.AUD_NO = MAIN.AUD_NO
			       AND DE04.DSP_RQ_SNO = MAIN.DSP_RQ_SNO
			       AND DE04.AUD_YR = MAIN.AUD_YR
			       AND (SUBSTRB(MAIN.DSP_RQ_KND_CD, 1, 1) LIKE '5'
			                OR SUBSTRB(MAIN.DSP_RQ_KND_CD, 1, 1) LIKE '6'
			                OR MAIN.DSP_RQ_KND_CD IN ('110', '210', '310', '320', '391'))
			       AND DE04.DTM_STA_CD != '0' 
			)
			
			
			SELECT OVER_YEAR_CNT + NEW_OPER_CNT AS TOT_CNT  /*건수 계*/
			      ,OVER_YEAR_CNT /*건수 전년이월*/
			      ,NEW_OPER_CNT  /*건수 신규발생*/
			      ,ENFO_CNT      /*건수 ****년 **월 집행*/
			      ,NENFO_INDLINE_CNT + NENFO_OUTDLINE_CNT  TOT_NENFO_CNT /*건수 기한도래 + 기한미도래*/
			      ,NENFO_INDLINE_CNT /*건수 기한도래*/
			      ,NENFO_OUTDLINE_CNT /*건수 기한미도래*/
			FROM BASE 
        ]]>
	</select>	
	
	<!-- 금액(추징회수) -->
	<select id="BADEAR34Qselect5-2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			WITH BASE AS (
			
			    SELECT SUM(CASE WHEN DE04.DTM_STA_CD != '2'  AND DE04.ENF_DT < C.FDATE THEN DE04.PNL_DRIN_PSVT_AM
			                    WHEN DE04.DTM_STA_CD = '2'   AND DE04.ENF_DT < C.FDATE AND DE04.ENFM_WHLS_DTM_DT >= C.FDATE THEN DE04.PNL_DRIN_PSVT_AM
			               ELSE 0
			               END) AS OVER_YEAR_AM ,
			           SUM(CASE WHEN DE04.ENF_DT BETWEEN C.FDATE AND C.TDATE THEN DE04.PNL_DRIN_PSVT_AM
			               ELSE 0
			               END) AS NEW_OPER_AM ,
			           SUM(CASE WHEN DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT BETWEEN C.FDATE AND C.TDATE THEN DE04.PNL_DRIN_PSVT_AM
			               ELSE 0
			               END) AS ENFO_AM ,
			           SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.PNL_DRIN_PSVT_AM
			                    WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.PNL_DRIN_PSVT_AM
			               ELSE 0
			               END) AS NENFO_INDLINE_AM ,
			           SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND DE04.HNDL_DDLN_DT > C.TDATE THEN DE04.PNL_DRIN_PSVT_AM
			                    WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT > C.TDATE THEN DE04.PNL_DRIN_PSVT_AM
			               ELSE 0
			               END) AS NENFO_OUTDLINE_AM
			      FROM TBBADEAR002D DE04,
			           TBBADEAR001M MAIN,
			           (SELECT  #strYear# || '0101' /*월일 0101고정*/ FDATE
			                   ,TO_CHAR(LAST_DAY(TO_DATE(#strStartFromDt#,'YYYYMM')),'YYYYMMDD') /*해당년월의 마지막일자 산출*/  AS  TDATE  
			            FROM DUAL) C
			     WHERE 1=1
			       AND DE04.AUD_NO = MAIN.AUD_NO
			       AND DE04.DSP_RQ_SNO = MAIN.DSP_RQ_SNO
			       AND DE04.AUD_YR = MAIN.AUD_YR
			       AND MAIN.DSP_RQ_KND_CD IN ('110', '310', '320', '391')
			       AND DE04.DTM_STA_CD != '0'
			
			)
			
			SELECT OVER_YEAR_AM + NEW_OPER_AM AS TOT_AM /*금액(추징회수) 계*/
			      ,OVER_YEAR_AM /*금액(추징회수) 전년이월*/
			      ,NEW_OPER_AM /*금액(추징회수) 신규발생*/
			      ,ENFO_AM     /*금액(추징회수) ****년 **월 집행*/
			      ,NENFO_INDLINE_AM + NENFO_OUTDLINE_AM NENFO_TOT_AM /*금액(추징회수) 기한도래 + 기한미도래*/
			      ,NENFO_INDLINE_AM /*금액(추징회수) 기한도래 */
			      ,NENFO_OUTDLINE_AM /*금액(추징회수) 기한미도래 */
			FROM BASE
        ]]>
	</select>	
	
	<!-- 금  액(환추급) -->
	<select id="BADEAR34Qselect5-3" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			WITH BASE AS (
			SELECT SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT < C.FDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			                WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT < C.FDATE AND DE04.ENFM_WHLS_DTM_DT >= C.FDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			           ELSE 0
			           END ) AS OVER_YEAR_AM ,
			       SUM(CASE WHEN DE04.ENF_DT BETWEEN C.FDATE AND C.TDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			           ELSE 0
			           END ) AS NEW_OPER_AM ,
			       SUM(CASE WHEN DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT BETWEEN C.FDATE AND C.TDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			           ELSE 0
			           END ) AS ENFO_AM ,
			       SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			                WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			           ELSE 0
			           END ) AS NENFO_INDLINE_AM ,
			       SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND DE04.HNDL_DDLN_DT > C.TDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			                WHEN DE04.DTM_STA_CD = '2' AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT > C.TDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			           ELSE 0
			           END ) AS NENFO_OUTDLINE_AM
			  FROM TBBADEAR002D DE04,
			       TBBADEAR001M MAIN,
			       (SELECT  #strYear# || '0101' /*월일 0101고정*/ FDATE
			                   ,TO_CHAR(LAST_DAY(TO_DATE(#strStartFromDt#,'YYYYMM')),'YYYYMMDD') /*해당년월의 마지막일자 산출*/  AS  TDATE  
			        FROM DUAL) C
			 WHERE 1=1
			   AND DE04.AUD_NO = MAIN.AUD_NO
			   AND DE04.DSP_RQ_SNO = MAIN.DSP_RQ_SNO
			   AND DE04.AUD_YR = MAIN.AUD_YR
			   AND MAIN.DSP_RQ_KND_CD IN ('110', '310', '320', '391')
			   AND DE04.DTM_STA_CD != '0'
			)
			SELECT OVER_YEAR_AM + NEW_OPER_AM           AS TOT_AM2 /*금액(환추급) 계*/
			      ,OVER_YEAR_AM                         AS OVER_YEAR_AM2 /*금액(환추급) 전년이월*/
			      ,NEW_OPER_AM                          AS NEW_OPER_AM2 /*금액(환추급) 신규발생*/
			      ,ENFO_AM                              AS ENFO_AM2   /*금액(환추급) ****년 **월 집행*/
			      ,NENFO_INDLINE_AM + NENFO_OUTDLINE_AM AS NENFO_TOT_AM2 /*금액(환추급) 기한도래 + 기한미도래*/
			      ,NENFO_INDLINE_AM                     AS  NENFO_INDLINE_AM2       /*금액(환추급) 기한도래 */
			      ,NENFO_OUTDLINE_AM                    AS NENFO_OUTDLINE_AM2/*금액(환추급) 기한미도래 */
			FROM BASE
        ]]>
	</select>	
	
	<!-- 인원 -->
	<select id="BADEAR34Qselect5-4" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			WITH BASE AS (
			
			    SELECT SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT < C.FDATE THEN DE04.NOP_CNT
			                    WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT < C.FDATE AND DE04.ENFM_WHLS_DTM_DT >= C.FDATE THEN DE04.NOP_CNT
			               ELSE 0
			               END) AS OVER_YEAR_PSON ,
			           SUM(CASE WHEN DE04.ENF_DT BETWEEN C.FDATE AND C.TDATE THEN DE04.NOP_CNT
			               ELSE 0
			               END) AS NEW_OPER_PSON ,
			           SUM(CASE WHEN DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT BETWEEN C.FDATE AND C.TDATE THEN DE04.NOP_CNT
			               ELSE 0
			               END) AS ENFO_PSON ,
			           SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.NOP_CNT
			                    WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.NOP_CNT
			               ELSE 0
			               END) AS NENFO_INDLINE_PSON ,
			           SUM(CASE WHEN DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND ((MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT > C.TDATE)
			                                                                               OR MAIN.DSP_RQ_KND_CD LIKE '6%') THEN DE04.NOP_CNT
			                    WHEN DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND ((MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT > C.TDATE)
			                                                                                                                 OR MAIN.DSP_RQ_KND_CD LIKE '6%') THEN DE04.NOP_CNT
			               ELSE 0
			               END) AS NENFO_OUTDLINE_PSON
			      FROM TBBADEAR002D DE04,
			           TBBADEAR001M MAIN,
			           (SELECT  #strYear# || '0101' /*월일 0101고정*/ FDATE
			                       ,TO_CHAR(LAST_DAY(TO_DATE(#strStartFromDt#,'YYYYMM')),'YYYYMMDD') /*해당년월의 마지막일자 산출*/  AS  TDATE  
			            FROM DUAL) C
			     WHERE 1=1
			       AND DE04.AUD_NO = MAIN.AUD_NO
			       AND DE04.DSP_RQ_SNO = MAIN.DSP_RQ_SNO
			       AND DE04.AUD_YR = MAIN.AUD_YR
			       AND MAIN.DSP_RQ_KND_CD IN ('210', '620', '621', '623')
			       AND DE04.DTM_STA_CD != '0' 
			)
			
			SELECT OVER_YEAR_PSON + NEW_OPER_PSON AS TOT_PSON /*인원 계*/
			      ,OVER_YEAR_PSON /*인원 전년이월*/
			      ,NEW_OPER_PSON /*인원 신규발생*/
			      ,ENFO_PSON     /*인원 ****년 **월 집행*/
			      ,NENFO_INDLINE_PSON + NENFO_OUTDLINE_PSON AS NENFO_TOT_PSON /*인원 기한도래 + 기한미도래*/
			      ,NENFO_INDLINE_PSON /*인원 기한도래 */
			      ,NENFO_OUTDLINE_PSON /*인원 기한미도래 */
			FROM BASE
        ]]>
	</select>	
	<!--##################### 집행전말 처리상황 끝 #################################-->
	
	<!--##################### 과별 미집행상황 시작 #################################-->
	<select id="BADEAR34Qselect6" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			WITH TMP_DEPT_TIT_TXT AS
			(
			    SELECT DISTINCT
			           DE04.ENFM_MNG_BRDV_CD AS ENFM_DPT_CD
			         , DEPT.DPT_NM AS ENFO_DPT_NM
			        FROM TBBADEAR002D DE04,
			             TBBADEAR001M MAIN,
			             TBDCMACM002M DEPT
			        WHERE 1=1
			        AND DE04.AUD_NO = MAIN.AUD_NO
			        AND DE04.DSP_RQ_SNO = MAIN.DSP_RQ_SNO
			        AND DE04.AUD_YR = MAIN.AUD_YR
			        AND DE04.ENFM_MNG_BRDV_CD = DEPT.DPT_CD
			        AND (SUBSTRB(MAIN.DSP_RQ_KND_CD,1,1) LIKE '5'
			             OR SUBSTRB(MAIN.DSP_RQ_KND_CD,1,1) LIKE '6'
			             OR MAIN.DSP_RQ_KND_CD IN ('110','210','310','320','391'))
			        AND DE04.DTM_STA_CD != '0'
			        
			        /* 
			        2015.07.28 yyh 주석처리
			        AND DE04.ENF_DT >= '20060101' */
			
			) 
			    
			    SELECT
			       DEPT.ENFO_DPT_NM                                           /*구분*/
			     , DEPT.ENFM_DPT_CD   
			     , SUM(ENFO.ENFO_OBJ_CNT) AS ENFO_OBJ_CNT                     /*집행대상 건수*/
			     , SUM(ENFO.ENFO_OBJ_AM) AS ENFO_OBJ_AM                       /*집행대상 금액(추징회수보전)*/   
			     , SUM(ENFO.ENFO_OBJ_AM2) AS ENFO_OBJ_AM2                     /*집행대상 금액(환추급)*/   
			     , SUM(ENFO.ENFO_OBJ_PSON) AS ENFO_OBJ_PSON                   /*집행대상 인원*/   
			     , SUM(ENFO.ENFO_CNT) AS ENFO_CNT                             /* ****년 **월 집행 건수*/   
			     , SUM(ENFO.ENFO_AM) AS ENFO_AM                               /* ****년 **월 집행 금액(금액회수보전)*/   
			     , SUM(ENFO.ENFO_AM2) AS ENFO_AM2                             /* ****년 **월 집행 금액(환추급)*/   
			     , SUM(ENFO.ENFO_PSON) AS ENFO_PSON                           /* ****년 **월 집행 인원*/   
			     , SUM(ENFO.NENFO_OUTDLINE_CNT) AS NENFO_OUTDLINE_CNT         /* 미집행 건수*/   
			     , SUM(ENFO.NENFO_OUTDLINE_AM) AS NENFO_OUTDLINE_AM           /* 미집행 금액(추징회수보전)*/   
			     , SUM(ENFO.NENFO_OUTDLINE_AM2) AS NENFO_OUTDLINE_AM2         /* 미집행 금액(환추급)*/   
			     , SUM(ENFO.NENFO_OUTDLINE_PSON) AS NENFO_OUTDLINE_PSON       /* 미집행 인원*/   
			     , SUM(ENFO.NENFO_INDLINE_CNT) AS NENFO_INDLINE_CNT           /* 미집행 건수*/   
			    FROM TMP_DEPT_TIT_TXT DEPT
			        ,(
			            SELECT DE04.ENFM_MNG_BRDV_CD ,
			            COUNT(*) AS ENFO_OBJ_CNT ,
			            SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110', '310', '320', '391') THEN DE04.PNL_DRIN_PSVT_AM
			                 ELSE 0
			                 END) AS ENFO_OBJ_AM ,
			            SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110', '310', '320', '391') THEN DE04.RSR_AM + DE04.SPLP_AM
			                 ELSE 0
			                 END) AS ENFO_OBJ_AM2 ,
			            SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('210', '620', '621', '623') THEN DE04.NOP_CNT
			                 ELSE 0
			                 END) AS ENFO_OBJ_PSON ,
			           0 AS ENFO_CNT ,
			           0 AS ENFO_AM ,
			           0 AS ENFO_AM2 ,
			           0 AS ENFO_PSON ,
			           SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110', '210', '310', '320', '391') AND DE04.HNDL_DDLN_DT <= C.TDATE THEN 1
			                ELSE 0
			                END) AS NENFO_OUTDLINE_CNT ,
			           SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110', '310', '320', '391') AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.PNL_DRIN_PSVT_AM
			                ELSE 0
			                END) AS NENFO_OUTDLINE_AM ,
			           SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110', '310', '320', '391') AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			                ELSE 0
			                END) AS NENFO_OUTDLINE_AM2 ,
			           SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('210') AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.NOP_CNT
			                ELSE 0
			                END) AS NENFO_OUTDLINE_PSON ,
			           SUM (CASE WHEN (MAIN.DSP_RQ_KND_CD IN ('110', '210', '310', '320', '391') AND DE04.HNDL_DDLN_DT > C.TDATE)
			                           OR MAIN.DSP_RQ_KND_CD LIKE '5%'
			                           OR MAIN.DSP_RQ_KND_CD LIKE '6%' THEN 1
			                ELSE 0
			                END) AS NENFO_INDLINE_CNT
			      FROM TBBADEAR002D DE04
			         , TBBADEAR001M MAIN
			         ,(SELECT #strYear# || '0101' /*월일 0101고정*/ FDATE
			                  ,TO_CHAR(LAST_DAY(TO_DATE(#strStartFromDt#,'YYYYMM')),'YYYYMMDD') /*해당년월의 마지막일자 산출*/  AS  TDATE  
			           FROM DUAL) C
			      WHERE DE04.DTM_STA_CD != '2'
			        AND DE04.ENF_DT <= C.TDATE
			        AND DE04.AUD_NO = MAIN.AUD_NO
			        AND DE04.DSP_RQ_SNO = MAIN.DSP_RQ_SNO
			        AND DE04.AUD_YR = MAIN.AUD_YR
			        AND (SUBSTRB(MAIN.DSP_RQ_KND_CD,1,1) LIKE '5'
			           OR SUBSTRB(MAIN.DSP_RQ_KND_CD,1,1) LIKE '6'
			           OR MAIN.DSP_RQ_KND_CD IN ('110','210','310','320','391'))
			        AND DE04.DTM_STA_CD != '0'
			      GROUP BY DE04.ENFM_MNG_BRDV_CD
			      
			      UNION ALL
			      
			      SELECT   DE04.ENFM_MNG_BRDV_CD ,
			               COUNT(*) AS ENFO_OBJ_CNT ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110','310','320','391') THEN DE04.PNL_DRIN_PSVT_AM
			                    ELSE 0
			                    END) AS ENFO_OBJ_AM ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110','310','320','391') THEN DE04.RSR_AM + DE04.SPLP_AM
			                    ELSE 0
			                    END) AS ENFO_OBJ_AM2 ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('210','620','621','623') THEN DE04.NOP_CNT
			                    ELSE 0
			                    END) AS ENFO_OBJ_PSON ,
			               SUM (CASE WHEN DE04.ENFM_WHLS_DTM_DT <= C.TDATE THEN 1
			                    ELSE 0
			                    END) AS ENFO_CNT ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110','310','320','391') AND DE04.ENFM_WHLS_DTM_DT <= C.TDATE THEN DE04.PNL_DRIN_PSVT_AM
			                    ELSE 0
			                    END) AS ENFO_AM ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110','310','320','391') AND DE04.ENFM_WHLS_DTM_DT <= C.TDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			                    ELSE 0
			                    END) AS ENFO_AM2 ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('210','620','621','623') AND DE04.ENFM_WHLS_DTM_DT <= C.TDATE THEN DE04.NOP_CNT
			                    ELSE 0
			                    END) AS ENFO_PSON ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110','210','310','320','391') AND DE04.HNDL_DDLN_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE THEN 1
			                    ELSE 0
			                    END) AS NENFO_OUTDLINE_CNT ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110','310','320','391')AND DE04.HNDL_DDLN_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE THEN DE04.PNL_DRIN_PSVT_AM
			                    ELSE 0
			                    END) AS NENFO_OUTDLINE_AM ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('110','310','320','391')
			                   AND DE04.HNDL_DDLN_DT <= C.TDATE
			                   AND DE04.ENFM_WHLS_DTM_DT > C.TDATE THEN DE04.RSR_AM + DE04.SPLP_AM
			                                 ELSE 0
			                               END) AS NENFO_OUTDLINE_AM2 ,
			               SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('210') AND DE04.HNDL_DDLN_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE THEN DE04.NOP_CNT
			                    ELSE 0
			                    END) AS NENFO_OUTDLINE_PSON ,
			               SUM (CASE WHEN ((MAIN.DSP_RQ_KND_CD IN ('110','210', '310','320','391') AND DE04.HNDL_DDLN_DT > C.TDATE)
			                                 OR MAIN.DSP_RQ_KND_CD LIKE '5%'
			                                 OR MAIN.DSP_RQ_KND_CD LIKE '6%')
			                                AND DE04.ENFM_WHLS_DTM_DT > C.TDATE THEN 1
			                    ELSE 0
			                    END) AS NENFO_INDLINE_CNT
			          FROM TBBADEAR002D DE04,
			               TBBADEAR001M MAIN,
			               (SELECT  #strYear# || '0101' /*월일 0101고정*/ FDATE
			                        ,TO_CHAR(LAST_DAY(TO_DATE(#strStartFromDt#,'YYYYMM')),'YYYYMMDD') /*해당년월의 마지막일자 산출*/  AS  TDATE  
			                FROM DUAL) C
			      WHERE DE04.DTM_STA_CD = '2'
			      AND DE04.ENF_DT <= C.TDATE
			      AND DE04.ENFM_WHLS_DTM_DT >= C.FDATE
			      AND DE04.AUD_NO = MAIN.AUD_NO
			      AND DE04.DSP_RQ_SNO = MAIN.DSP_RQ_SNO
			      AND DE04.AUD_YR = MAIN.AUD_YR
			      AND (SUBSTRB(MAIN.DSP_RQ_KND_CD,1,1) LIKE '5'
			      OR SUBSTRB(MAIN.DSP_RQ_KND_CD,1,1) LIKE '6'
			      OR MAIN.DSP_RQ_KND_CD IN ('110','210','310','320','391'))
			     GROUP BY DE04.ENFM_MNG_BRDV_CD
			     ) ENFO
			    WHERE ENFO.ENFM_MNG_BRDV_CD(+) = DEPT.ENFM_DPT_CD
			    GROUP BY DEPT.ENFO_DPT_NM
			            ,DEPT.ENFM_DPT_CD
			    ORDER BY DEPT.ENFM_DPT_CD
        ]]>
	</select>	
	<!--##################### 과별 미집행상황 끝 #################################-->
	
	<!--##################### 처분요구 종류별 미집행상황 시작 #################################-->
	<!-- 처분요구 변상, 징계_문책, 시정의 부분 -->
	<select id="BADEAR34Qselect7-1" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
		 SELECT CASE WHEN MAIN.DSP_RQ_KND_CD = '110'                THEN '변상'      /*변상*/ 
		             WHEN MAIN.DSP_RQ_KND_CD LIKE '2%'              THEN '징계_문책'  /*징계_문책*/ 
		             WHEN MAIN.DSP_RQ_KND_CD IN ('310','320','391') THEN '시정'      /*시정*/ 
		         END AS ENFO_REQ_TYPE,
		        
		        CASE WHEN MAIN.DSP_RQ_KND_CD = '110'               THEN 1 
		             WHEN MAIN.DSP_RQ_KND_CD LIKE '2%'             THEN 2 
		             WHEN MAIN.DSP_RQ_KND_CD IN('310','320','391') THEN 3 END SORTER,
		        
		        SUM(CASE WHEN  DE04.DTM_STA_CD != '2' OR  (DE04.DTM_STA_CD = '2'  AND DE04.ENFM_WHLS_DTM_DT > C.TDATE) THEN 1 ELSE 0 END ) AS NENFO_CNT, /*계_건수*/ 
		        SUM(CASE WHEN  DE04.DTM_STA_CD != '2' OR  (DE04.DTM_STA_CD = '2'  AND DE04.ENFM_WHLS_DTM_DT > C.TDATE) THEN DE04.PNL_DRIN_PSVT_AM ELSE 0 END ) AS NENFO_AM,  /*계_금액(추징회수보전)*/ 
		        SUM(CASE WHEN  DE04.DTM_STA_CD != '2' OR  (DE04.DTM_STA_CD = '2'  AND DE04.ENFM_WHLS_DTM_DT > C.TDATE) THEN DE04.RSR_AM + DE04.SPLP_AM ELSE 0 END ) AS NENFO_AM2, /*계_금액(환추급)*/ 
		        SUM(CASE WHEN  MAIN.DSP_RQ_KND_CD IN ('210', '620', '621', '623') AND (DE04.DTM_STA_CD != '2' OR  (DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT > C.TDATE)) THEN DE04.NOP_CNT ELSE 0 END ) AS NENFO_PSON, /*계_인원*/ 
		        SUM(CASE WHEN (DE04.DTM_STA_CD != '2' AND  DE04.HNDL_DDLN_DT <= C.TDATE) OR (DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT <= C.TDATE) THEN 1 ELSE 0 END ) AS NENFO_OUTDLINE_CNT, /*기한도래_건수*/ 
		        SUM(CASE WHEN (DE04.DTM_STA_CD != '2' AND  DE04.HNDL_DDLN_DT <= C.TDATE  AND MAIN.DSP_RQ_KND_CD IN ('110','310','320','391') ) OR (DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT <= C.TDATE AND MAIN.DSP_RQ_KND_CD IN('110', '310', '320', '391') ) THEN DE04.PNL_DRIN_PSVT_AM ELSE 0 END ) AS NENFO_OUTDLINE_AM, /*기한도래_금액(추징회수보전)*/ 
		        SUM(CASE WHEN (DE04.DTM_STA_CD != '2' AND  DE04.HNDL_DDLN_DT <= C.TDATE  AND MAIN.DSP_RQ_KND_CD IN ('110','310','320','391') ) OR (DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT <= C.TDATE AND MAIN.DSP_RQ_KND_CD IN('110', '310', '320', '391') ) THEN DE04.RSR_AM + DE04.SPLP_AM ELSE 0 END ) AS NENFO_OUTDLINE_AM2, /*기한도래_금액(환추급)*/  
                SUM(CASE WHEN MAIN.DSP_RQ_KND_CD IN ('210', '620', '621', '623') AND DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.NOP_CNT
			             WHEN MAIN.DSP_RQ_KND_CD IN ('210', '620', '621', '623') AND DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT <= C.TDATE THEN DE04.NOP_CNT
			             ELSE 0
			         END) AS NENFO_OUTDLINE_PSON ,   /*기한도래_인원*/		        
		        
		        SUM(CASE WHEN (DE04.DTM_STA_CD != '2' AND  DE04.HNDL_DDLN_DT >  C.TDATE) OR (DE04.DTM_STA_CD = '2'  AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT > C.TDATE) THEN 1 ELSE 0 END ) AS NENFO_INDLINE_CNT, /*미도래_건수*/ 
		        SUM(CASE WHEN (DE04.DTM_STA_CD != '2' AND  DE04.HNDL_DDLN_DT >  C.TDATE  AND MAIN.DSP_RQ_KND_CD IN ('110', '310', '320', '391') ) OR (DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT > C.TDATE AND MAIN.DSP_RQ_KND_CD IN('110','310', '320', '391') ) THEN DE04.PNL_DRIN_PSVT_AM ELSE 0 END ) AS NENFO_INDLINE_AM,  /*미도래_금액(추징회수보전)*/ 
		        SUM(CASE WHEN (DE04.DTM_STA_CD != '2' AND  DE04.HNDL_DDLN_DT >  C.TDATE  AND MAIN.DSP_RQ_KND_CD IN ('110', '310', '320', '391') ) OR (DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND DE04.HNDL_DDLN_DT > C.TDATE AND MAIN.DSP_RQ_KND_CD IN('110','310', '320', '391') ) THEN DE04.RSR_AM + DE04.SPLP_AM ELSE 0 END ) AS NENFO_INDLINE_AM2, /*미도래_금액(환추급)*/ 
			    SUM(CASE WHEN MAIN.DSP_RQ_KND_CD IN ('210', '620', '621', '623') AND DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND ((MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT > C.TDATE)
			                                                                               OR MAIN.DSP_RQ_KND_CD LIKE '6%') THEN DE04.NOP_CNT
			             WHEN MAIN.DSP_RQ_KND_CD IN ('210', '620', '621', '623') AND DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND ((MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT > C.TDATE)
			                                                                                                                 OR MAIN.DSP_RQ_KND_CD LIKE '6%') THEN DE04.NOP_CNT
			             ELSE 0
			         END) AS NENFO_INDLINE_PSON    /*미도래_인원*/			        
		        
           FROM TBBADEAR002D DE04,
		        TBBADEAR001M MAIN,
		        (SELECT TO_CHAR(LAST_DAY(TO_DATE(#strStartFromDt#, 'YYYYMM') ) , 'YYYYMMDD') /*해당년월의 마지막일자 산출*/ AS TDATE /*인자값 화면의 년월*/
		           FROM DUAL) C
		  WHERE 1=1
		    AND DE04.ENF_DT        <= C.TDATE
		    AND DE04.AUD_NO         = MAIN.AUD_NO
		    AND DE04.DSP_RQ_SNO     = MAIN.DSP_RQ_SNO
		    AND DE04.AUD_YR         = MAIN.AUD_YR
		    AND MAIN.DSP_RQ_KND_CD IN ('110', '210', '310', '320', '391')
		    AND DE04.DTM_STA_CD    != '0'
		  GROUP BY (CASE WHEN MAIN.DSP_RQ_KND_CD = '110'                  THEN '변상' 
		                 WHEN MAIN.DSP_RQ_KND_CD LIKE '2%'                THEN '징계_문책' 
		                 WHEN MAIN.DSP_RQ_KND_CD IN ('310','320', '391')  THEN '시정' 
		             END ),
		           (CASE WHEN MAIN.DSP_RQ_KND_CD = '110'                  THEN 1 
		                 WHEN MAIN.DSP_RQ_KND_CD LIKE '2%'                THEN 2 
		                 WHEN MAIN.DSP_RQ_KND_CD IN('310','320','391')    THEN 3 
		             END)
		  ORDER BY SORTER
        ]]>
	</select>	
	
	<!-- 개선, 권고, 통보 부분 -->
	<select id="BADEAR34Qselect7-2" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[       
			SELECT CASE  WHEN MAIN.DSP_RQ_KND_CD LIKE '5%'                          THEN '개선' /*개선*/
			             WHEN MAIN.DSP_RQ_KND_CD = '611'                            THEN '권고' /*권고*/
			             WHEN MAIN.DSP_RQ_KND_CD IN ('610','620','621','623','630','625') THEN '통보' /*통보, (통보(시정완료):625 추가 - 2016.11.23 yyh) */
			       END AS ENFO_REQ_TYPE ,
			       SUM (CASE WHEN DE04.DTM_STA_CD != '2' OR (DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT > C.TDATE) THEN 1
			            ELSE 0
			            END) AS ODER_NENFO_CNT ,    /*건수*/
			       SUM (CASE WHEN DE04.DTM_STA_CD != '2' OR (DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT > C.TDATE) THEN DE04.PNL_DRIN_PSVT_AM
			            ELSE 0
			            END) AS ODER_NENFO_AM ,     /*금액(추징회수보전)*/
			       SUM (CASE WHEN DE04.DTM_STA_CD != '2' OR (DE04.DTM_STA_CD = '2' AND DE04.ENFM_WHLS_DTM_DT > C.TDATE) THEN DE04.RSR_AM + DE04.SPLP_AM
			            ELSE 0
			            END) AS ODER_NENFO_AM2 ,    /*금액(환추급)*/
			       SUM (CASE WHEN MAIN.DSP_RQ_KND_CD IN ('210', '620', '621', '623') AND DE04.DTM_STA_CD != '2' AND DE04.ENF_DT <= C.TDATE AND ((MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT > C.TDATE)
			                                                                               OR MAIN.DSP_RQ_KND_CD LIKE '6%') THEN DE04.NOP_CNT
			                 WHEN MAIN.DSP_RQ_KND_CD IN ('210', '620', '621', '623') AND DE04.DTM_STA_CD = '2'  AND DE04.ENF_DT <= C.TDATE AND DE04.ENFM_WHLS_DTM_DT > C.TDATE AND ((MAIN.DSP_RQ_KND_CD = '210' AND DE04.HNDL_DDLN_DT > C.TDATE)
			                                                                                                                 OR MAIN.DSP_RQ_KND_CD LIKE '6%') THEN DE04.NOP_CNT
			                 ELSE 0
			             END) AS ODER_NENFO_PSON /*인원*/
			               			
			  FROM TBBADEAR002D DE04,
			       TBBADEAR001M MAIN,
			       (SELECT  TO_CHAR(LAST_DAY(TO_DATE(#strStartFromDt#,'YYYYMM')),'YYYYMMDD') /*해당년월의 마지막일자 산출*/  AS  TDATE  /*인자값 화면의 년월*/
			        FROM DUAL) C
			 WHERE 1=1
			   AND DE04.ENF_DT <= C.TDATE
			   AND DE04.AUD_NO = MAIN.AUD_NO
			   AND DE04.DSP_RQ_SNO = MAIN.DSP_RQ_SNO
			   AND DE04.AUD_YR = MAIN.AUD_YR
			   AND (SUBSTRB(MAIN.DSP_RQ_KND_CD, 1, 1) LIKE '5'
			            OR MAIN.DSP_RQ_KND_CD LIKE '6%')
			   AND DE04.DTM_STA_CD != '0'
			 GROUP BY (CASE WHEN MAIN.DSP_RQ_KND_CD LIKE '5%'                           THEN '개선'
			                WHEN MAIN.DSP_RQ_KND_CD = '611'                             THEN '권고'
			                WHEN MAIN.DSP_RQ_KND_CD IN ('610','620','621','623','630','625')  THEN '통보'
			           END)
			 ORDER BY ENFO_REQ_TYPE 
        ]]>
	</select>
	<!--##################### 처분요구 종류별 미집행상황 끝 #################################-->	
</sqlMap> 
