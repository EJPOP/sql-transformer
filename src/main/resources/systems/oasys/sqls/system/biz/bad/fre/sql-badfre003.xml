<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="bad/fre/003">
	
	
	<resultMap class="java.util.HashMap" id="mainselect">
		<result property="AUD_SBJ_NM" column="AUD_SBJ_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="AUD_KND_CD" column="AUD_KND_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="AUD_KND_NM" column="AUD_KND_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="AUD_YR" column="AUD_YR" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="AUD_NO" column="AUD_NO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="AUD_GRN_NO" column="AUD_GRN_NO" jdbcType="VARCHAR2" javaType="java.lang.String"/>		
		<result property="DSP_RQ_SNO" column="DSP_RQ_SNO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DSP_RQ_KND_CD" column="DSP_RQ_KND_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DSP_RQ_KND_NM" column="DSP_RQ_KND_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="TOT_DSP_RQ_NO" column="TOT_DSP_RQ_NO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENF_DT" column="ENF_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="TIT_TXT" column="TIT_TXT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="HNDL_DDLN_DT" column="HNDL_DDLN_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="PNL_DRIN_PSVT_AM" column="PNL_DRIN_PSVT_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="RSR_AM" column="RSR_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="SPLP_AM" column="SPLP_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="BGT_RDC_AM" column="BGT_RDC_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="INC_ICR_AM" column="INC_ICR_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="PPL_BDN_RDT_AM" column="PPL_BDN_RDT_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FRTN_INCR_AM" column="FRTN_INCR_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXPN_RTNL_AM" column="EXPN_RTNL_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="IJS_AM" column="IJS_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="SLF_HNDL_RQ_AM" column="SLF_HNDL_RQ_AM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="APV_DOC_NO" column="APV_DOC_NO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="COPT_OFI_CD" column="COPT_OFI_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="COPT_OFI_NM" column="COPT_OFI_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENF_BRDV_CD" column="ENF_BRDV_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENF_BRDV_NM" column="ENF_BRDV_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_MNG_BRDV_CD" column="ENFM_MNG_BRDV_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_MNG_BRDV_NM" column="ENFM_MNG_BRDV_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DSP_RQ_APV_STA_CD" column="DSP_RQ_APV_STA_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DSP_RQ_APV_STA_NM" column="DSP_RQ_APV_STA_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DTM_YN" column="DTM_YN" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DTM_YN_NM" column="DTM_YN_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_WHLS_APV_KND_CD" column="ENFM_WHLS_APV_KND_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_WHLS_APV_KND_NM" column="ENFM_WHLS_APV_KND_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="REP_RLTN_ORG_CD" column="REP_RLTN_ORG_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="REP_RLTN_ORG_NM" column="REP_RLTN_ORG_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="RLTN_ORG_CD" column="RLTN_ORG_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="RLTN_ORG_NM" column="RLTN_ORG_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="TG_ORG_CHGR_NM" column="TG_ORG_CHGR_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="TG_ORG_TNB" column="TG_ORG_TNB" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CPLT_YN" column="CPLT_YN" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CPLT_YN_NM" column="CPLT_YN_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="HND_SBJ_TXT" column="HND_SBJ_TXT" jdbcType="CLOB" javaType="java.lang.String"/>
		<result property="CHGR_NM" column="CHGR_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_CPLT_IPT_DT" column="ENFM_CPLT_IPT_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_CPLT_IPT_PEN_ID" column="ENFM_CPLT_IPT_PEN_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_CPLT_IPT_PEN_NM" column="ENFM_CPLT_IPT_PEN_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CPLT_DT" column="CPLT_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CPLT_PEN_ID" column="CPLT_PEN_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CPLT_PEN_NM" column="CPLT_PEN_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_WHLS_DTM_DT" column="ENFM_WHLS_DTM_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_WHLS_DTM_PEN_ID" column="ENFM_WHLS_DTM_PEN_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_WHLS_DTM_PEN_NM" column="ENFM_WHLS_DTM_PEN_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FNL_APV_DT" column="FNL_APV_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FNL_APV_CNB" column="FNL_APV_CNB" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FNL_APV_NM" column="FNL_APV_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_STA_NM" column="ENFM_STA_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_DSP_RQ_SBT" column="EXAM_RPRT_DSP_RQ_SBT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_UNENFM_RTWR_TXT" column="EXAM_RPRT_UNENFM_RTWR_TXT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_UNENFM_RSN_EXAM_TXT" column="EXAM_RPRT_UNENFM_RSN_EXAM_TXT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="MNG_SNO_MAX" column="MNG_SNO_MAX" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="SPCN_MNG" column="SPCN_MNG" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="PRSU_CNT" column="PRSU_CNT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="JESIM_CNT" column="JESIM_CNT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="GAMSAP_CNT" column="GAMSAP_CNT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="HRK_MNG_ASG_YN" column="HRK_MNG_ASG_YN" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="HRK_MNG_ASG_RSN" column="HRK_MNG_ASG_RSN" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DTM_APV_STA_CD" column="DTM_APV_STA_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DTM_APV_STA_DT" column="DTM_APV_STA_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DTM_APV_DOC_NO" column="DTM_APV_DOC_NO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DTM_RET_RSN_TXT" column="DTM_RET_RSN_TXT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="NOT_CPLT_STA_DVSN_CD" column="NOT_CPLT_STA_DVSN_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CPLT_STA_DVSN_CD" column="CPLT_STA_DVSN_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DTM_FRT_APV_DT" column="DTM_FRT_APV_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DTM_FRT_APV_NM" column="DTM_FRT_APV_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="OD_ENFM_MNG_BRDV_CD" column="OD_ENFM_MNG_BRDV_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/> <!-- 구집행관리국과코드 추가 - 2017.01.31 yyh -->
		<result property="OD_ENFM_MNG_BRDV_NM" column="OD_ENFM_MNG_BRDV_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="MAIN_ENFM_MNG_TG_YN" column="MAIN_ENFM_MNG_TG_YN" jdbcType="VARCHAR2" javaType="java.lang.String"/> <!-- 주요이행관리대상여부 추가 - 2017.01.31 yyh -->
		<result property="MAIN_ENFM_MNG_TG_YN_NM" column="MAIN_ENFM_MNG_TG_YN_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_MNG_ORG_CD" column="ENFM_MNG_ORG_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/> 
		<result property="ENFM_MNG_ORG_NM" column="ENFM_MNG_ORG_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/> 
		<result property="ELCT_AUD_OPEN_DOC_ID" column="ELCT_AUD_OPEN_DOC_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>  <!-- 전자감사 공개문 DOC_ID 추가 - 2017.07.04 EUNOK  -->	
		<result property="DOC_ID" column="DOC_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DOC_TYPE" column="DOC_TYPE" jdbcType="VARCHAR2" javaType="java.lang.String"/>
	</resultMap>
	
	<resultMap class="java.util.HashMap" id="onnaraselect">
		<result property="AUD_YR" column="AUD_YR" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="AUD_NO" column="AUD_NO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DSP_RQ_SNO" column="DSP_RQ_SNO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="RLTN_ORG_CD" column="RLTN_ORG_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PRSU_SNO" column="ENFM_PRSU_SNO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="MAX_ENFM_PRSU_SNO" column="MAX_ENFM_PRSU_SNO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PRSU_HIS" column="ENFM_PRSU_HIS" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PRSU_DT" column="ENFM_PRSU_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PRSU_PEN_ID" column="ENFM_PRSU_PEN_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PRSU_PEN_NM" column="ENFM_PRSU_PEN_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="UN_ENFM_RSN" column="UN_ENFM_RSN" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PLAN_TXT" column="ENFM_PLAN_TXT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PRSU_RSP_DT" column="ENFM_PRSU_RSP_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PRSU_RSPR_ID" column="ENFM_PRSU_RSPR_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PRSU_ACP_DT" column="ENFM_PRSU_ACP_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ENFM_PRSU_RCEP_ID" column="ENFM_PRSU_RCEP_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="PRSU_DVSN_CD" column="PRSU_DVSN_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="SLF_ACP_STA_CD" column="SLF_ACP_STA_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="SLF_ACP_DT" column="SLF_ACP_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="SLF_APV_DT" column="SLF_APV_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ONR_SEN_DT" column="ONR_SEN_DT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ONR_SEN_PEN_ID" column="ONR_SEN_PEN_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DOC_ID" column="DOC_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DOC_TYP_CD" column="DOC_TYP_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="OPM_TXT" column="OPM_TXT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ONR_DOC_MNG_CRD_ID" column="ONR_DOC_MNG_CRD_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CVPT_OPM_APV_HNDL_STA_CD" column="CVPT_OPM_APV_HNDL_STA_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ADMN_INF_HNDL_NO" column="ADMN_INF_HNDL_NO" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ONR_APV_RQS_DH" column="ONR_APV_RQS_DH" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ONR_APV_CMPT_DH" column="ONR_APV_CMPT_DH" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FRT_USR_ID" column="FRT_USR_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FNL_USR_ID" column="FNL_USR_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FNL_DEAL_DPT_CD" column="FNL_DEAL_DPT_CD" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FNL_MNU_ID" column="FNL_MNU_ID" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FRT_REGI_DH" column="FRT_REGI_DH" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FNL_MDF_DH" column="FNL_MDF_DH" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FL_RUT_NM" column="FL_RUT_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="SYS_FL_NM" column="SYS_FL_NM" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="TITLE" column="TITLE" jdbcType="VARCHAR2" javaType="java.lang.String"/>
	</resultMap>
	
	<!--집행전말 상세조회 일반정보 & 관련기관 조회-->
	<select id="BADFRE003EMainselect" parameterClass="paramMap" resultMap="mainselect">
        <![CDATA[
			SELECT T.AUD_SBJ_NM,
			       T.AUD_KND_CD,
			       F_CODE_NM('1000007', T.AUD_KND_CD) AS AUD_KND_NM,
			       T1.AUD_YR,
			       T1.AUD_NO,
			       T.AUD_GRN_NO,
			       T1.DSP_RQ_SNO,
			       T1.DSP_RQ_KND_CD,
			       F_CODE_NM('1000002', T1.DSP_RQ_KND_CD) AS DSP_RQ_KND_NM,
			       F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, T.AUD_KND_CD, '-') ||'-'|| T1.DSP_RQ_SNO AS TOT_DSP_RQ_NO,
			       T2.ENF_DT,
			       T1.TIT_TXT,
			       T2.HNDL_DDLN_DT,
			       (
				       SELECT SUM(S1.PNL_DRIN_PSVT_AM) 
					   FROM TBBADEAR003M S1
					   WHERE 1 = 1
	                   AND S1.AUD_YR = T2.AUD_YR
					   AND S1.AUD_NO = T2.AUD_NO
					   AND S1.DSP_RQ_SNO = T2.DSP_RQ_SNO
			       ) AS PNL_DRIN_PSVT_AM,
			       
				   (
				       SELECT SUM(S1.RSR_AM) 
					   FROM TBBADEAR003M S1
					   WHERE 1 = 1
	                   AND S1.AUD_YR = T2.AUD_YR
					   AND S1.AUD_NO = T2.AUD_NO
					   AND S1.DSP_RQ_SNO = T2.DSP_RQ_SNO
			       ) AS RSR_AM,
			       
				   T2.SPLP_AM,
				   T2.BGT_RDC_AM,
				   T2.INC_ICR_AM,
				   T2.PPL_BDN_RDT_AM,
				   T2.FRTN_INCR_AM,
				   T2.EXPN_RTNL_AM,
				   T2.IJS_AM,
				   T2.SLF_HNDL_RQ_AM,
				   T2.APV_DOC_NO,
				   T2.APV_DOC_GRP_NO,
			       T2.COPT_OFI_CD,
			       (SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T2.COPT_OFI_CD AND ROWNUM = 1) AS COPT_OFI_NM,
			       T2.ENF_BRDV_CD,
			       (SELECT DPT_NM FROM TBDCMACM002M WHERE DPT_CD = T2.ENF_BRDV_CD AND ROWNUM = 1) AS ENF_BRDV_NM,
                   T2.ENFM_MNG_BRDV_CD,
                   (SELECT DPT_NM FROM TBDCMACM002M WHERE DPT_CD = T2.ENFM_MNG_BRDV_CD AND ROWNUM = 1) AS ENFM_MNG_BRDV_NM,
                   T2.DSP_RQ_APV_STA_CD,
                   F_CODE_NM('1000333', T2.DSP_RQ_APV_STA_CD) AS DSP_RQ_APV_STA_NM,
                   T2.DTM_YN,
                   DECODE(T2.DTM_YN,'Y','완결','미결') AS DTM_YN_NM,
                   T2.ENFM_WHLS_APV_KND_CD,
				   F_CODE_NM('1000529', T2.ENFM_WHLS_APV_KND_CD) AS ENFM_WHLS_APV_KND_NM,
                   T2.RLTN_ORG_CD AS REP_RLTN_ORG_CD,
                   (SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T2.RLTN_ORG_CD AND ROWNUM = 1) AS REP_RLTN_ORG_NM,
                   T3.RLTN_ORG_CD,
                   (SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T3.RLTN_ORG_CD AND ROWNUM = 1) AS RLTN_ORG_NM,
                   T4.TG_ORG_CHGR_NM,
                   T4.TG_ORG_TNB,
                   DECODE(T3.CPLT_YN, 'Y', 'Y', 'N') AS CPLT_YN,
                   DECODE(T3.CPLT_YN, 'Y', '완결', '미결') AS CPLT_YN_NM,
                   
                   (SELECT ST1.DSP_RQ_HND_SBJ 
                    FROM TBBADEAR005M ST1
                    WHERE ST1.AUD_YR = T2.AUD_YR
                    AND   ST1.AUD_NO = T2.AUD_NO
                    AND   ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
                   ) AS HND_SBJ_TXT,
                   
                   T2.CHGR_NM,
                   T2.ENFM_CPLT_IPT_DT,
                   T2.ENFM_CPLT_IPT_PEN_ID,
                   (SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = T2.ENFM_CPLT_IPT_PEN_ID AND ROWNUM = 1) AS ENFM_CPLT_IPT_PEN_NM,
                   T2.CPLT_DT,
                   T2.CPLT_PEN_ID,
                   F_USR_INFO(T2.CPLT_PEN_ID, '2') AS CPLT_PEN_NM,
                   T2.ENFM_WHLS_DTM_DT,
                   T2.ENFM_WHLS_DTM_PEN_ID,
                   F_USR_INFO(T2.ENFM_WHLS_DTM_PEN_ID, '2') AS ENFM_WHLS_DTM_PEN_NM,
                   
                   /* T2.APV_DOC_GRP_NO를 사용하는 부분 주석처리 - 2015.04.30 yyh 
                   NVL((
                     SELECT DECODE(APV_STA_CD,3,TO_CHAR(FNL_APV_DH, 'YYYYMMDD'),'') AS FNL_APV_DT
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_GRP_NO
				        AND ROWNUM = 1
                   ),(
                     SELECT DECODE(APV_STA_CD,3,TO_CHAR(FNL_APV_DH, 'YYYYMMDD'),'') AS FNL_APV_DT
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
                   )) AS FNL_APV_DT,
                   
                   NVL((
                     SELECT DECODE(APV_STA_CD,3,FNL_APV_CNB,'') AS FNL_APV_CNB
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_GRP_NO
				        AND ROWNUM = 1
				   ),(
                     SELECT DECODE(APV_STA_CD,3,FNL_APV_CNB,'') AS FNL_APV_CNB
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
				   )) AS FNL_APV_CNB,
				   
				   
                   NVL((
                     SELECT DECODE(APV_STA_CD,3,F_USR_INFO(FNL_APV_CNB,'2'),'') AS FNL_APV_NM
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_GRP_NO
				        AND ROWNUM = 1
				   ),(
                     SELECT DECODE(APV_STA_CD,3,F_USR_INFO(FNL_APV_CNB,'2'),'') AS FNL_APV_NM
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
				   )) AS FNL_APV_NM,
				   */
				   
                   (
                     SELECT DECODE(APV_STA_CD,3,TO_CHAR(FNL_APV_DH, 'YYYYMMDD'),'') AS FNL_APV_DT
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
                   ) AS FNL_APV_DT,
                   
                   (
                     SELECT DECODE(APV_STA_CD,3,FNL_APV_CNB,'') AS FNL_APV_CNB
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
				   ) AS FNL_APV_CNB,
				   
				   (
                     SELECT DECODE(APV_STA_CD,3,F_USR_INFO(FNL_APV_CNB,'2'),'') AS FNL_APV_NM
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
				   ) AS FNL_APV_NM,
				   
				   
				   (
					CASE 
					WHEN T2.DTM_STA_CD = '2' THEN '확정'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
					     AND T2.DSP_RQ_APV_STA_CD = '3'
					THEN '완결(결재완료)'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
						 AND T2.DSP_RQ_APV_STA_CD = '2'
					THEN '미결(결재중)'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
						 AND T2.DSP_RQ_APV_STA_CD = '5'
					THEN '미결(상신취소)'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
					     AND T2.DSP_RQ_APV_STA_CD = '4'
					THEN '미결(반려)'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
					     AND (T2.DSP_RQ_APV_STA_CD = '1' OR T2.DSP_RQ_APV_STA_CD IS NULL)
					THEN '미결(미상신)'
					WHEN T2.DTM_STA_CD = '1' AND (T2.DTM_YN <> 'Y' OR T2.DTM_YN IS NULL)
					THEN '미결'
					ELSE '처분요구 미확정'
					END
				   ) AS ENFM_STA_NM,
				   T2.EXAM_RPRT_DSP_RQ_SBT,
				   T2.EXAM_RPRT_UNENFM_RTWR_TXT,
				   T2.EXAM_RPRT_UNENFM_RSN_EXAM_TXT,
				   (
					   SELECT NVL(MAX(ST1.MNG_SNO), 0) AS MNG_SNO_MAX
					   FROM TBBADFRE011M ST1
					   WHERE ST1.AUD_YR = T2.AUD_YR
					   AND ST1.AUD_NO = T2.AUD_NO
					   AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
					   AND ST1.RLTN_ORG_CD = T2.RLTN_ORG_CD
				   ) AS MNG_SNO_MAX,
				   (
					   SELECT DECODE(NVL(COUNT(1), 0), 0, '', '특수관리') AS SPCN_MNG
					   FROM TBBADFRE011M ST1
					   WHERE ST1.AUD_YR = T2.AUD_YR
					   AND ST1.AUD_NO = T2.AUD_NO
					   AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
				   ) AS SPCN_MNG,
				   (
					   SELECT DECODE(NVL(COUNT(1), 0), 0, '', 
					   		DECODE(T1.DSP_RQ_KND_CD,'610','이행계획제출요구',
					   		                        '611','이행계획제출요구',
					   		                        '620','이행계획제출요구',
					   		                        '621','이행계획제출요구',
					   		                        '623','이행계획제출요구',
					   		                        '630','이행계획제출요구',
					   		                        '510','이행계획제출요구',
					   		                        '520','이행계획제출요구','이행독촉')) AS PRSU_CNT
						 FROM TBBADFRE009M ST1
						WHERE ST1.AUD_YR = T2.AUD_YR
						  AND ST1.AUD_NO = T2.AUD_NO
						  AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
				   ) AS PRSU_CNT,
				   (
					   SELECT DECODE(NVL(COUNT(1), 0), 0, '', '재심의') AS JESIM_CNT
						 FROM TBBADFRE012M ST1
						WHERE ST1.AUD_YR = T2.AUD_YR
						  AND ST1.AUD_NO = T2.AUD_NO
						  AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
				   ) AS JESIM_CNT,
				   (
					   SELECT DECODE(NVL(COUNT(1), 0), 0, '', '감사자보기') AS GAMSAP_CNT
						 FROM TBBADEAR004M ST1
						WHERE ST1.AUD_YR = T2.AUD_YR
						  AND ST1.AUD_NO = T2.AUD_NO
						  AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
				   ) AS GAMSAP_CNT,
				   NVL(T2.HRK_MNG_ASG_YN, 'N') AS HRK_MNG_ASG_YN,
				   T2.HRK_MNG_ASG_RSN
				   
				   /* 확정관련 추가 - 2016.05.17 yyh */
				   ,T2.DTM_APV_STA_CD        /* 확정결재상태코드 */
				   ,T2.DTM_APV_STA_DT        /* 확정결재상태일 */
				   ,T2.DTM_APV_DOC_NO        /* 확정결재문서번호 */
				   ,T2.DTM_RET_RSN_TXT       /* 확정반려사유 */
				   ,T2.NOT_CPLT_STA_DVSN_CD  /* 미결상태구분코드 */
				   ,T2.CPLT_STA_DVSN_CD      /* 완결상태구분코드 */
				   
				   /* 확정검토 결재상신정보 추가 - 2016.05.24 yyh */
                   ,(SELECT TO_CHAR(APV_DH, 'YYYYMMDD')
				       FROM TBDCMACM023L
				      WHERE APV_DOC_NO = T2.DTM_APV_DOC_NO
				        AND APV_SNO = 1
				        AND ROWNUM  = 1)                    AS DTM_FRT_APV_DT
                   ,(SELECT F_USR_INFO(APVR_CNB,'2')
				       FROM TBDCMACM023L
				      WHERE APV_DOC_NO = T2.DTM_APV_DOC_NO
				        AND APV_SNO = 1				      
				        AND ROWNUM  = 1)                    AS DTM_FRT_APV_NM				   

			       ,T2.OD_ENFM_MNG_BRDV_CD                  AS OD_ENFM_MNG_BRDV_CD /* 2017.01.31 yyh */
			       ,F_DPT_INFO(T2.OD_ENFM_MNG_BRDV_CD,'1')  AS OD_ENFM_MNG_BRDV_NM
			       ,NVL(T2.MAIN_ENFM_MNG_TG_YN, 'N')        AS MAIN_ENFM_MNG_TG_YN
			       ,CASE WHEN T2.MAIN_ENFM_MNG_TG_YN = 'Y' THEN '주요이행관리대상'
			             ELSE ''
			         END                                    AS MAIN_ENFM_MNG_TG_YN_NM
			       ,T3.ENFM_MNG_ORG_CD                                                  AS ENFM_MNG_ORG_CD /* 이행관리기관 추가 - 2017.02.15 yyh */
			       ,(SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T3.ENFM_MNG_ORG_CD) AS ENFM_MNG_ORG_NM 
			       
				   ,(SELECT Z2.DOC_ID
						FROM TBBADEAR001M Z1
					    INNER JOIN TBBADDED103M Z2
					    ON Z1.AUD_YR     = Z2.AUD_YR
					    AND Z1.AUD_NO     = Z2.AUD_NO
					    AND TO_CHAR(Z1.AUD_DSP_RQ_SNO) = Z2.REF_ID
					WHERE Z1.AUD_YR        = T1.AUD_YR
						AND Z1.AUD_NO      = T1.AUD_NO
					   	AND Z1.DSP_RQ_SNO  = T1.DSP_RQ_SNO
					   	AND Z2.AUD_STEP_CD = 'A1080'
					   	AND Z2.RPRT_CD     = 'A10800500')   AS ELCT_AUD_OPEN_DOC_ID /* 전자감사 공개문 DOC_ID 추가 - 2017.07.04 EUNOK */	 
			        ,(SELECT DOC_ID
				        FROM TBBADDED103M Z3
				        WHERE 1=1 
				            AND T1.AUD_YR = Z3.AUD_YR
				            AND T1.AUD_NO = Z3.AUD_NO
				            AND T2.DSP_RQ_SNO = Z3.REF_ID
				            AND AUD_STEP_CD = 'A1090'
				            AND RPRT_CD = 'A10900400' 
				            AND FRT_REGI_DH = (
					               SELECT MAX(FRT_REGI_DH)
					                         FROM TBBADDED103M 
					                 WHERE AUD_YR = Z3.AUD_YR
					                   AND AUD_NO = Z3.AUD_NO
					                   AND REF_ID = Z3.REF_ID
					                   AND AUD_STEP_CD = 'A1090'
					                   AND RPRT_CD = 'A10900400'
					               )
	                ) AS DOC_ID   			           
			        ,(SELECT F_OPEN_EDIT(LINK_URL) AS DOC_TYPE
				        FROM TBBADDED103M Z3
				        WHERE 1=1 
				            AND T1.AUD_YR = Z3.AUD_YR
				            AND T1.AUD_NO = Z3.AUD_NO
				            AND T2.DSP_RQ_SNO = Z3.REF_ID
				            AND AUD_STEP_CD = 'A1090'
				            AND RPRT_CD = 'A10900400' 
				            AND FRT_REGI_DH = (
					               SELECT MAX(FRT_REGI_DH)
					                         FROM TBBADDED103M 
					                 WHERE AUD_YR = Z3.AUD_YR
					                   AND AUD_NO = Z3.AUD_NO
					                   AND REF_ID = Z3.REF_ID
					                   AND AUD_STEP_CD = 'A1090'
					                   AND RPRT_CD = 'A10900400'
					               )
	                ) AS DOC_TYPE   			           
			  FROM TBBADDED001M T,
			       TBBADEAR001M T1,
			       TBBADEAR002D T2,
			       TBBADEAR006M T3,
                   TBBADFRE001M T4
			 WHERE 1 = 1
			   AND T.AUD_YR = T1.AUD_YR
			   AND T.AUD_NO = T1.AUD_NO
			   AND T1.AUD_YR = T2.AUD_YR
			   AND T1.AUD_NO = T2.AUD_NO
			   AND T1.DSP_RQ_SNO = T2.DSP_RQ_SNO
			   AND T2.AUD_YR = T3.AUD_YR(+)
			   AND T2.AUD_NO = T3.AUD_NO(+)
			   AND T2.DSP_RQ_SNO = T3.DSP_RQ_SNO(+)
			   AND T3.AUD_YR = T4.AUD_YR(+)
               AND T3.AUD_NO = T4.AUD_NO(+)
               AND T3.DSP_RQ_SNO = T4.DSP_RQ_SNO(+)
               AND T3.RLTN_ORG_CD = T4.RLTN_ORG_CD(+)
			   AND T1.AUD_YR               = #strAudYr#	 	
			   AND T1.AUD_NO               = #strAudNo#	 	   
			   AND T2.DSP_RQ_SNO           = #strDspRqSno#       
			  ORDER BY T2.AUD_YR, T1.AUD_NO, T2.DSP_RQ_SNO, T3.RLTN_ORG_CD
        ]]>
	</select>
	

	<!--집행전말 상세조회 관계자 조회-->
	<select id="BADFRE003EDfntselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT
			    T1.AUD_YR,
				T1.AUD_NO,
				T1.DSP_RQ_SNO,
				T1.RLTN_ORG_CD,
                (SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T1.RLTN_ORG_CD AND ROWNUM = 1) AS RLTN_ORG_NM,				
				T1.DFNT_SNO,
				T1.AD,
				T1.OCP_CD,
				F_CODE_NM('1000057', T1.OCP_CD) AS OCP_NM,
				T1.RANK_CD,
				F_CODE_NM('1000058', T1.RANK_CD) AS RANK_NM,
				T1.DFNT_NAM,
				DECODE(T1.EIN,'','',SUBSTR(T1.EIN,0,6)||'-'||SUBSTR(T1.EIN,7,1)||'*') AS EIN,
				T1.BK_COM_AD,
				T1.CMPY_NM,
				T1.ACNT_NM,
				T1.HND_CD,
				T1.AM,
				DECODE(T1.CPLT_YN, 'Y', 'Y', 'N') AS CPLT_YN,
                DECODE(T1.CPLT_YN, 'Y', '완결', '미결') AS CPLT_YN_NM,
				T1.HND_RQ_KND_CD,
				F_CODE_NM('1000011', T1.HND_RQ_KND_CD) AS HND_RQ_KND_NM,
				T1.CPLT_DT,
				T1.CPLT_PEN_ID,
				T1.SDY_GRT_AM,
				T1.SDY_GRT_RSN
			  FROM TBBADEAR007M T1
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #strAudYr#
			   AND T1.AUD_NO               = #strAudNo#
			   AND T1.DSP_RQ_SNO           = #strDspRqSno#
			   AND T1.RLTN_ORG_CD          = #strRltnOrgCd#       
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.DFNT_SNO 
        ]]>
	</select>	
	

	<!--집행전말 상세조회 관련기관집행전말 조회-->
	<select id="BADFRE003ERltnOrgEnfmselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT
			    T1.AUD_YR,
				T1.AUD_NO,
				T1.DSP_RQ_SNO,
				T1.RLTN_ORG_CD,
				(SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T1.RLTN_ORG_CD AND ROWNUM = 1) AS RLTN_ORG_NM,
				T1.ENFM_SNO,
				(
					SELECT MAX(ST1.ENFM_SNO) + 1
					FROM TBBADFRE006M ST1
					WHERE 1 = 1
					AND ST1.AUD_YR = T1.AUD_YR
					AND ST1.AUD_NO = T1.AUD_NO
					AND ST1.DSP_RQ_SNO = T1.DSP_RQ_SNO
					AND ST1.RLTN_ORG_CD = T1.RLTN_ORG_CD
				) AS MAX_ENFM_SNO,
				T1.ENFM_DT,
				T1.PNL_AM,
				T1.ENFM_SHP_CD,
				F_CODE_NM('1000003', T1.ENFM_SHP_CD) AS ENFM_SHP_NM,
				T1.ENFM_HIS,
				T1.ENFM_NOC,
				T1.FRT_USR_ID,
				T1.FNL_USR_ID,
				T1.FNL_DEAL_DPT_CD,
				T1.FNL_MNU_ID,
				T1.FRT_REGI_DH,
				T1.FNL_MDF_DH
			  FROM TBBADFRE006M T1
			 WHERE 1 = 1	 
			   AND T1.AUD_YR               = #strAudYr#	 	
			   AND T1.AUD_NO               = #strAudNo#	   
			   AND T1.DSP_RQ_SNO           = #strDspRqSno#	 	   
			   AND T1.RLTN_ORG_CD          = #strRltnOrgCd#    
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.ENFM_SNO 
        ]]>
	</select>	
	
	<!--집행전말 상세조회 관계자집행전말 조회-->
	<select id="BADFRE003EDfntEnfmselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT
			    T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.DFNT_SNO
				,T1.ENFM_SNO
				,(
					SELECT MAX(ST1.ENFM_SNO) + 1
					FROM TBBADFRE008M ST1
					WHERE 1 = 1
					AND ST1.AUD_YR = T1.AUD_YR
					AND ST1.AUD_NO = T1.AUD_NO
					AND ST1.DSP_RQ_SNO = T1.DSP_RQ_SNO
					AND ST1.RLTN_ORG_CD = T1.RLTN_ORG_CD
					AND ST1.DFNT_SNO = T1.DFNT_SNO
				) AS MAX_DFNT_ENFM_SNO			
				,T1.ENFM_SHP_CD
				,F_CODE_NM('1000003', T1.ENFM_SHP_CD) AS ENFM_SHP_NM
				,T1.PNL_AM
				,T1.ENFM_DT
				,T1.ENFM_HIS
				,T1.ENFM_NOC
				,(SELECT DFNT_NAM FROM TBBADEAR007M WHERE AUD_YR = T1.AUD_YR
				     AND AUD_NO = T1.AUD_NO
				     AND DSP_RQ_SNO = T1.DSP_RQ_SNO
				     AND RLTN_ORG_CD = T1.RLTN_ORG_CD
				     AND DFNT_SNO = T1.DFNT_SNO
				     AND ROWNUM = 1
				 ) AS DFNT_NAM
				,T1.FRT_USR_ID
				,T1.FNL_USR_ID
				,T1.FNL_DEAL_DPT_CD
				,T1.FNL_MNU_ID
				,T1.FRT_REGI_DH
				,T1.FNL_MDF_DH
			  FROM TBBADFRE008M T1
			 WHERE 1 = 1 
			   AND T1.AUD_YR               = #strAudYr#	
			   AND T1.AUD_NO               = #strAudNo#	   
			   AND T1.DSP_RQ_SNO           = #strDspRqSno#	 	   
			   AND T1.RLTN_ORG_CD          = #strRltnOrgCd#	 	   
			   AND T1.DFNT_SNO          = #strDfntSno#    
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.DFNT_SNO, T1.ENFM_SNO  
        ]]>
	</select>

    <!--집행전말이력 MAX HST_NO 값 조회-->
	<select id="BADFRE003EEnfmHisMaxCntselect" parameterClass="paramMap"
		resultClass="String">
        <![CDATA[
			SELECT
			    MAX(T1.HST_NO) + 1 AS MAX_HST_NO
			FROM TBBADFRE001H T1
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #strAudYr# 	
			   AND T1.AUD_NO               = #strAudNo#	   
			   AND T1.DSP_RQ_SNO           = #strDspRqSno#	 	   
			   AND T1.RLTN_ORG_CD          = #strRltnOrgCd#
        ]]>
	</select>

	<!--집행전말이력 조회-->
	<select id="BADFRE003EEnfmHisselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT
				T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.HST_NO
				,T1.ENF_DT
				,T1.ENFM_DT
				,T1.ENFM_STEP_CD
				,F_CODE_NM('1000016', T1.ENFM_STEP_CD) AS ENFM_STEP_NM
				,T1.ENFM_HIS
				,T1.EXAM_STA_CD
				,F_CODE_NM('1000390', T1.EXAM_STA_CD) AS EXAM_STA_NM
				,T1.EXAM_OPIN_TXT
				,T1.BAI_CHGD_ACP_DT
				,T1.CNTR_ADMN_ORG_ACP_DT
				,T1.SLF_SEN_DT
				,T1.SLF_IPT_YN
				,T1.HST_RMK
				,T1.CHGR_ID
				,F_USR_INFO(T1.CHGR_ID,'2') AS CHGR_NM				
				,T1.ENFM_WHLS_APV_STA_CD
				,DECODE(T1.ENFM_WHLS_APV_STA_CD, '', '상신전',
					F_CODE_NM('1000333', T1.ENFM_WHLS_APV_STA_CD)) AS ENFM_WHLS_APV_STA_NM
				,T1.DOC_ID
				,T1.DOC_TYP_CD	
				,T1.APV_DOC_NO			
				,T1.TG_ORG_APV_DT
				,T1.TG_ORG_APVR_BLT_NM
				,T1.TG_ORG_APVR_RANK_NM
				,T1.TG_ORG_APVR_PST_NM
				,T1.TG_ORG_APVR_NAM
				, #strReportParam# AS REPORT_PARAM
			FROM TBBADFRE001H T1
			 WHERE 1 = 1 
			   AND T1.AUD_YR               = #strAudYr# 	
			   AND T1.AUD_NO               = #strAudNo#	   
			   AND T1.DSP_RQ_SNO           = #strDspRqSno#	 	   
			   AND T1.RLTN_ORG_CD          = #strRltnOrgCd#	 	   
		]]>
		
		<!-- 2015.01.21 추가  -->
		<isNotNull property="strHstNo">
			<isNotEmpty property="strHstNo">
     	       AND T1.HST_NO = #strHstNo#
			</isNotEmpty>
		</isNotNull>
		
        <![CDATA[       
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.HST_NO DESC /* T1.HST_NO에 DESC 추가 - 2017.03.17 yyh */
        ]]>
	</select>
	
	<!--집행전말단계별계획 조회-->
	<select id="BADFRE003EEnfmStepPlanselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT
				T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.HST_NO
				,T1.ENFM_STEP_NO
				,T1.ENFM_STEP_STR_DT
				,T1.ENFM_STEP_END_DT
				,T1.ENFM_STEP_PLN_TXT
				,T1.FRT_USR_ID
				,T1.FNL_USR_ID
				,T1.FNL_DEAL_DPT_CD
				,T1.FNL_MNU_ID
				,T1.FRT_REGI_DH
				,T1.FNL_MDF_DH
			FROM TBBADFRE001L T1
			 WHERE 1 = 1 
			   AND T1.AUD_YR               = #strAudYr# 	
			   AND T1.AUD_NO               = #strAudNo#	   
			   AND T1.DSP_RQ_SNO           = #strDspRqSno#	 	   
			   AND T1.RLTN_ORG_CD          = #strRltnOrgCd#	 	   
			   AND T1.HST_NO               = #strHstNo#     
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.HST_NO
        ]]>
	</select>

	<!--관계기관 완결처리-->
	<update id="BADFRE003ERltnOrgCompleteupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADEAR006M T1 
			   SET T1.CPLT_YN     = #CPLT_YN#, 
			       T1.CPLT_DT     = DECODE(#CPLT_YN#,'N','' ,TO_CHAR(SYSDATE,'YYYYMMDD')), 
			       T1.CPLT_PEN_ID = DECODE(#CPLT_YN#,'N','' ,#S_CNB#),
			       T1.FNL_USR_ID      = #FNL_USR_ID#,
				   T1.FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#,
				   T1.FNL_MNU_ID      = #FNL_MNU_ID#,
				   T1.FNL_MDF_DH      = SYSDATE
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #AUD_YR#
			   AND T1.AUD_NO               = #AUD_NO#
			   AND T1.DSP_RQ_SNO           = #DSP_RQ_SNO#
			   AND T1.RLTN_ORG_CD          = #RLTN_ORG_CD#
		]]>
	</update>
	
	<!-- 
	     현재 특정 기관은 공감시스템에서 회보가 오지 않으므로 담당자가 메일로 받아서 직접입력함
	     이런 경우 집행담당자와 연락처를 입력할 수 없어서 입력받기 위해 신규입력 추가함 
	    2016.03.16 yyh 
	 -->
	<update id="BADFRE003ERltnOrgTgOrgSlfInsert" parameterClass="paramMap">
        <![CDATA[            
			MERGE INTO TBBADFRE001M
			USING DUAL
			   ON (     
			            AUD_YR      = #AUD_YR#
			        AND AUD_NO      = #AUD_NO#
			        AND DSP_RQ_SNO  = #DSP_RQ_SNO# 
			        AND RLTN_ORG_CD = #RLTN_ORG_CD#
			      ) 
			 WHEN MATCHED THEN 
			    UPDATE 
			       SET TG_ORG_CHGR_NM   = #TG_ORG_CHGR_NM#
			         , TG_ORG_TNB       = #TG_ORG_TNB#
			         , FNL_USR_ID       = #FNL_USR_ID#
			         , FNL_DEAL_DPT_CD  = #FNL_DEAL_DPT_CD#
			         , FNL_MNU_ID       = #FNL_MNU_ID#
			         , FNL_MDF_DH       = SYSDATE
			 WHEN NOT MATCHED THEN   
			    INSERT( 
			  	      AUD_YR
				     ,AUD_NO
				     ,DSP_RQ_SNO
				     ,RLTN_ORG_CD
				     ,TG_ORG_CHGR_NM
				     ,TG_ORG_TNB
				     ,FRT_USR_ID
				     ,FNL_USR_ID
				     ,FNL_DEAL_DPT_CD
				     ,FNL_MNU_ID
				     ,FRT_REGI_DH
				     ,FNL_MDF_DH
			    ) VALUES ( 
			  	      #AUD_YR#
				     ,#AUD_NO#
				     ,#DSP_RQ_SNO#
				     ,#RLTN_ORG_CD#
				     ,#TG_ORG_CHGR_NM#
				     ,#TG_ORG_TNB#				
				     ,#FRT_USR_ID#
				     ,#FNL_USR_ID#
				     ,#FNL_DEAL_DPT_CD#
				     ,#FNL_MNU_ID#
				     ,SYSDATE
				     ,SYSDATE
			    ) 
		]]>
	</update>
		 
	<!--관계자 완결처리-->
	<update id="BADFRE003EDfntCompleteupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADEAR007M T1 
			   SET T1.CPLT_YN     = #CPLT_YN#, 
			       T1.CPLT_DT     = DECODE(#CPLT_YN#,'N','' ,TO_CHAR(SYSDATE,'YYYYMMDD')), 
			       T1.CPLT_PEN_ID = DECODE(#CPLT_YN#,'N','' ,#S_CNB#),
			       T1.FNL_USR_ID      = #FNL_USR_ID#,
				   T1.FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#,
				   T1.FNL_MNU_ID      = #FNL_MNU_ID#,
				   T1.FNL_MDF_DH      = SYSDATE
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #AUD_YR#
			   AND T1.AUD_NO               = #AUD_NO#
			   AND T1.DSP_RQ_SNO           = #DSP_RQ_SNO#
			   AND T1.RLTN_ORG_CD          = #RLTN_ORG_CD#
			   AND T1.DFNT_SNO             = #DFNT_SNO#
		]]>
	</update>
	
	<!--관계기관 완결처리 (관련 관계자 완결여부 확인)-->
	<select id="BADFRE003EDfntCompleteselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.DFNT_SNO
			  FROM TBBADEAR007M T1 
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #AUD_YR#
			   AND T1.AUD_NO               = #AUD_NO#
			   AND T1.DSP_RQ_SNO           = #DSP_RQ_SNO#
			   AND T1.RLTN_ORG_CD          = #RLTN_ORG_CD#
			   AND (T1.CPLT_YN <> 'Y' OR T1.CPLT_YN IS NULL)
        ]]>
	</select>
	
	<!--최종 완결처리 (관계자 완결여부 확인)-->
	<select id="BADFRE003EFinalDfntCompleteselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.DFNT_SNO
			  FROM TBBADEAR007M T1 
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #AUD_YR#
			   AND T1.AUD_NO               = #AUD_NO#
			   AND T1.DSP_RQ_SNO           = #DSP_RQ_SNO#
			   AND (T1.CPLT_YN <> 'Y' OR T1.CPLT_YN IS NULL)
        ]]>
	</select>
	
	<!--최종 완결처리 (관련 관계기관 완결여부 확인)-->
	<select id="BADFRE003ERltnOrgCompleteselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD 
			  FROM TBBADEAR006M T1 
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #AUD_YR#
			   AND T1.AUD_NO               = #AUD_NO#
			   AND T1.DSP_RQ_SNO           = #DSP_RQ_SNO#
			   AND (T1.CPLT_YN <> 'Y' OR T1.CPLT_YN IS NULL)
        ]]>
	</select>
	
	<!-- 완료처리 결과 조회 -->
	<select id="BADFRE003ECompleteResultselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
        
			SELECT T2.AUD_YR
			,T2.AUD_NO
			,DSP_RQ_SNO
			,T2.DTM_YN
			,DECODE(T2.DTM_YN,'Y','완결','미결') AS DTM_YN_NM
			,T2.CPLT_DT
			,T2.CPLT_PEN_ID
			,F_USR_INFO(T2.CPLT_PEN_ID, '2') AS CPLT_PEN_NM
			,T2.ENFM_WHLS_APV_KND_CD
			,F_CODE_NM('1000529', T2.ENFM_WHLS_APV_KND_CD) AS ENFM_WHLS_APV_KND_NM
			FROM TBBADEAR002D T2
			WHERE 1 = 1
			AND T2.AUD_YR               = #strAudYr#
			AND T2.AUD_NO               = #strAudNo#
			AND T2.DSP_RQ_SNO           = #strDspRqSno#
        ]]>
	</select>
	
	<!-- 처분요구 회계사항 조회 -->
	<select id="BADFRE003EAccountingselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT T1.AUD_YR
			,T1.AUD_NO
			,T1.DSP_RQ_SNO
			,T1.ACNT_SBJ_SNO
			,T1.DSP_RQ_ACNT_CD
			,F_CODE_NM('1000004', T1.DSP_RQ_ACNT_CD) AS DSP_RQ_ACNT_NM
			,T1.EPT_EFCT_DVSN_CD
			,F_CODE_NM('1000334', T1.EPT_EFCT_DVSN_CD) AS EPT_EFCT_DVSN_NM
			,T1.ACNT_YE
			,T1.PNL_DRIN_PSVT_AM
			,T1.RSR_AM
			,T1.SPLP_AM
			,T1.EPT_EFCT_AM
			,T1.EXPOT_Y_EFCT_AM
			,T1.EXPOT_Y_EFCT_AM_CALC_BAS_TXT
			,T1.FRT_USR_ID
			,T1.FNL_USR_ID
			,T1.FNL_DEAL_DPT_CD
			,T1.FNL_MNU_ID
			,T1.FRT_REGI_DH
			,T1.FNL_MDF_DH
			FROM TBBADEAR003M T1
			WHERE 1 = 1
			AND T1.AUD_YR               = #strAudYr#
			AND T1.AUD_NO               = #strAudNo#
			AND T1.DSP_RQ_SNO           = #strDspRqSno#
        ]]>
	</select>
	
	<insert id="BADFRE003EEnfmReturnHisinsert" parameterClass="paramMap">
        <![CDATA[       
			
	
  INSERT INTO TBBADFRE001H
			  (
			  	 AUD_YR
				,AUD_NO
				,DSP_RQ_SNO
				,RLTN_ORG_CD
				,HST_NO
				,ENF_DT
				,ENFM_DT
				,ENFM_STEP_CD
				,ENFM_HIS
				,HST_RMK
				,TG_ORG_APV_DT
				,TG_ORG_APVR_BLT_NM
				,TG_ORG_APVR_RANK_NM
				,TG_ORG_APVR_PST_NM
				,TG_ORG_APVR_NAM
				,DTM_DVSN_CD
				,EXAM_OPIN_TXT
				,EXAM_STA_CD
				,BAI_CHGD_ACP_DT
				,CNTR_ADMN_ORG_ACP_DT
				,CNTR_ADMN_ORG_RCEP_ID
				,TG_ORG_IPT_DH
				,TG_ORG_IPT_PEN_ID
				,CHGR_IPT_DH
				,CHGR_ID
				,ENFM_WHLS_APV_STA_CD
				,APV_DOC_NO
				,ENFM_WHLS_APV_STA_DT
				,SLF_PRSS_STA_CD
				,SLF_APV_DT
				,SLF_SEN_DT
				,SLF_IPT_YN
				,CON_RTRN_CD
				,RET_RSN_TXT
				,DOC_ID
				,DOC_TYP_CD
				,ENFM_WHLS_CON_NO
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
			  )
			  VALUES
			  (
			  	 #AUD_YR#
				,#AUD_NO#
				,#DSP_RQ_SNO#
				,#RLTN_ORG_CD#
				,#HST_NO#
				,#ENF_DT#
				,#ENFM_DT#
				,#ENFM_STEP_CD#
				,#ENFM_HIS#
				,#HST_RMK#
				,#TG_ORG_APV_DT#
				,#TG_ORG_APVR_BLT_NM#
				,#TG_ORG_APVR_RANK_NM#
				,#TG_ORG_APVR_PST_NM#
				,#TG_ORG_APVR_NAM#
				,#DTM_DVSN_CD#
				,#EXAM_OPIN_TXT#
				,'1'
				,TO_CHAR(SYSDATE, 'YYYYMMDD')
				,#CNTR_ADMN_ORG_ACP_DT#
				,#CNTR_ADMN_ORG_RCEP_ID#
				,#TG_ORG_IPT_DH#
				,#TG_ORG_IPT_PEN_ID#
				,SYSDATE
				,#S_CNB#
				,#ENFM_WHLS_APV_STA_CD#
				,#APV_DOC_NO#
				,#ENFM_WHLS_APV_STA_DT#
				,#SLF_PRSS_STA_CD#
				,#SLF_APV_DT#
				,#SLF_SEN_DT#
				,'Y'
				,#CON_RTRN_CD#
				,#RET_RSN_TXT#
				,#DOC_ID#
				,#DOC_TYP_CD#
				,#ENFM_WHLS_CON_NO#
				,#FRT_USR_ID#
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
				,SYSDATE
				,SYSDATE
			  )
        ]]>
	</insert>

	<update id="BADFRE003EEnfmReturnHisupdate" parameterClass="paramMap">
        <![CDATA[
     UPDATE TBBADFRE001H
     SET
     FNL_MDF_DH=SYSDATE,
     FNL_USR_ID=#FNL_USR_ID#,
     FNL_MNU_ID=#FNL_MNU_ID#,
     FNL_DEAL_DPT_CD=#FNL_DEAL_DPT_CD#,
     CHGR_IPT_DH=SYSDATE,
     CHGR_ID=#S_CNB#
]]>
<isNotNull prepend="," property="ENF_DT">
     ENF_DT=#ENF_DT#
</isNotNull>
<isNotNull prepend="," property="ENFM_DT">
     ENFM_DT=#ENFM_DT#
</isNotNull>
<isNotNull prepend="," property="ENFM_STEP_CD">
     ENFM_STEP_CD=#ENFM_STEP_CD#
</isNotNull>
<isNotNull prepend="," property="ENFM_HIS">
     ENFM_HIS=#ENFM_HIS#
</isNotNull>
<isNotNull prepend="," property="HST_RMK">
     HST_RMK=#HST_RMK#
</isNotNull>
<isNotNull prepend="," property="TG_ORG_APV_DT">
     TG_ORG_APV_DT=#TG_ORG_APV_DT#
</isNotNull>
<isNotNull prepend="," property="TG_ORG_APVR_BLT_NM">
     TG_ORG_APVR_BLT_NM=#TG_ORG_APVR_BLT_NM#
</isNotNull>
<isNotNull prepend="," property="TG_ORG_APVR_RANK_NM">
     TG_ORG_APVR_RANK_NM=#TG_ORG_APVR_RANK_NM#
</isNotNull>
<isNotNull prepend="," property="TG_ORG_APVR_PST_NM">
     TG_ORG_APVR_PST_NM=#TG_ORG_APVR_PST_NM#
</isNotNull>
<isNotNull prepend="," property="TG_ORG_APVR_NAM">
     TG_ORG_APVR_NAM=#TG_ORG_APVR_NAM#
</isNotNull>
<isNotNull prepend="," property="DTM_DVSN_CD">
     DTM_DVSN_CD=#DTM_DVSN_CD#
</isNotNull>
<isNotNull prepend="," property="EXAM_OPIN_TXT">
     EXAM_OPIN_TXT=#EXAM_OPIN_TXT#
</isNotNull>
<isNotNull prepend="," property="EXAM_STA_CD">
     EXAM_STA_CD=#EXAM_STA_CD#
</isNotNull>
<isNotNull prepend="," property="BAI_CHGD_ACP_DT">
     BAI_CHGD_ACP_DT=#BAI_CHGD_ACP_DT#
</isNotNull>
<isNotNull prepend="," property="CNTR_ADMN_ORG_ACP_DT">
     CNTR_ADMN_ORG_ACP_DT=#CNTR_ADMN_ORG_ACP_DT#
</isNotNull>
<isNotNull prepend="," property="CNTR_ADMN_ORG_RCEP_ID">
     CNTR_ADMN_ORG_RCEP_ID=#CNTR_ADMN_ORG_RCEP_ID#
</isNotNull>
<isNotNull prepend="," property="TG_ORG_IPT_DH">
     TG_ORG_IPT_DH=#TG_ORG_IPT_DH#
</isNotNull>
<isNotNull prepend="," property="TG_ORG_IPT_PEN_ID">
     TG_ORG_IPT_PEN_ID=#TG_ORG_IPT_PEN_ID#
</isNotNull>
<isNotNull prepend="," property="ENFM_WHLS_APV_STA_CD">
     ENFM_WHLS_APV_STA_CD=#ENFM_WHLS_APV_STA_CD#
</isNotNull>
<isNotNull prepend="," property="APV_DOC_NO">
     APV_DOC_NO=#APV_DOC_NO#
</isNotNull>
<isNotNull prepend="," property="ENFM_WHLS_APV_STA_DT">
     ENFM_WHLS_APV_STA_DT=#ENFM_WHLS_APV_STA_DT#
</isNotNull>
<isNotNull prepend="," property="SLF_PRSS_STA_CD">
     SLF_PRSS_STA_CD=#SLF_PRSS_STA_CD#
</isNotNull>
<isNotNull prepend="," property="SLF_APV_DT">
     SLF_APV_DT=#SLF_APV_DT#
</isNotNull>
<isNotNull prepend="," property="SLF_SEN_DT">
     SLF_SEN_DT=#SLF_SEN_DT#
</isNotNull>
<isNotNull prepend="," property="SLF_IPT_YN">
     SLF_IPT_YN=#SLF_IPT_YN#
</isNotNull>
<isNotNull prepend="," property="CON_RTRN_CD">
     CON_RTRN_CD=#CON_RTRN_CD#
</isNotNull>
<isNotNull prepend="," property="RET_RSN_TXT">
     RET_RSN_TXT=#RET_RSN_TXT#
</isNotNull>
<isNotNull prepend="," property="DOC_ID">
     DOC_ID=#DOC_ID#
</isNotNull>
<isNotNull prepend="," property="DOC_TYP_CD">
     DOC_TYP_CD=#DOC_TYP_CD#
</isNotNull>
<isNotNull prepend="," property="ENFM_WHLS_CON_NO">
     ENFM_WHLS_CON_NO=#ENFM_WHLS_CON_NO#
</isNotNull>
<isNotNull prepend="," property="FRT_USR_ID">
     FRT_USR_ID=#FRT_USR_ID#
</isNotNull>
<isNotNull prepend="," property="FRT_REGI_DH">
     FRT_REGI_DH=#FRT_REGI_DH#
</isNotNull>
        <![CDATA[
     WHERE 1=1
			   AND AUD_YR       = #AUD_YR#
			   AND AUD_NO       = #AUD_NO#
			   AND DSP_RQ_SNO   = #DSP_RQ_SNO#
			   AND RLTN_ORG_CD  = #RLTN_ORG_CD#
			   AND HST_NO       = #HST_NO# 	
        ]]>
	</update>
	
	<delete id="BADFRE003EEnfmReturnHisdelete" parameterClass="paramMap">
        <![CDATA[
        	  DELETE
        	    FROM TBBADFRE001H
			   WHERE 1 = 1
			   AND AUD_YR       = #AUD_YR#
			   AND AUD_NO       = #AUD_NO#
			   AND DSP_RQ_SNO   = #DSP_RQ_SNO#
			   AND RLTN_ORG_CD  = #RLTN_ORG_CD#
			   AND HST_NO       = #HST_NO#
        ]]>
	</delete>
	
	
	<insert id="BADFRE003ERltnOrgEnfminsert" parameterClass="paramMap">
        <![CDATA[       
			
	
  INSERT INTO TBBADFRE006M
			  (
				AUD_YR
				,AUD_NO
				,DSP_RQ_SNO
				,RLTN_ORG_CD
				,ENFM_SNO
				,ENFM_DT
				,PNL_AM
				,ENFM_SHP_CD
				,ENFM_HIS
				,ENFM_NOC
				,USR_ID
				,IPT_DH
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
			  )
			  VALUES
			  (
				#AUD_YR#
				,#AUD_NO#
				,#DSP_RQ_SNO#
				,#RLTN_ORG_CD#
				,#ENFM_SNO#
				,#ENFM_DT#
				,#PNL_AM#
				,#ENFM_SHP_CD#
				,#ENFM_HIS#
				,#ENFM_NOC#
				,#USR_ID#
				,#IPT_DH#
				,#FRT_USR_ID#
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
				,SYSDATE
				,SYSDATE
			  )
        ]]>
	</insert>

	<update id="BADFRE003ERltnOrgEnfmupdate" parameterClass="paramMap">
<![CDATA[
     UPDATE TBBADFRE006M
     SET
     FNL_MDF_DH=SYSDATE
]]>
<isNotNull prepend="," property="AUD_YR">
     AUD_YR=#AUD_YR#
</isNotNull>
<isNotNull prepend="," property="AUD_NO">
     AUD_NO=#AUD_NO#
</isNotNull>
<isNotNull prepend="," property="DSP_RQ_SNO">
     DSP_RQ_SNO=#DSP_RQ_SNO#
</isNotNull>
<isNotNull prepend="," property="RLTN_ORG_CD">
     RLTN_ORG_CD=#RLTN_ORG_CD#
</isNotNull>
<isNotNull prepend="," property="ENFM_SNO">
     ENFM_SNO=#ENFM_SNO#
</isNotNull>
<isNotNull prepend="," property="ENFM_DT">
     ENFM_DT=#ENFM_DT#
</isNotNull>
<isNotNull prepend="," property="PNL_AM">
     PNL_AM=#PNL_AM#
</isNotNull>
<isNotNull prepend="," property="ENFM_SHP_CD">
     ENFM_SHP_CD=#ENFM_SHP_CD#
</isNotNull>
<isNotNull prepend="," property="ENFM_HIS">
     ENFM_HIS=#ENFM_HIS#
</isNotNull>
<isNotNull prepend="," property="ENFM_NOC">
     ENFM_NOC=#ENFM_NOC#
</isNotNull>
<isNotNull prepend="," property="USR_ID">
     USR_ID=#USR_ID#
</isNotNull>
<isNotNull prepend="," property="IPT_DH">
     IPT_DH=#IPT_DH#
</isNotNull>
<isNotNull prepend="," property="FRT_USR_ID">
     FRT_USR_ID=#FRT_USR_ID#
</isNotNull>
<isNotNull prepend="," property="FNL_USR_ID">
     FNL_USR_ID=#FNL_USR_ID#
</isNotNull>
<isNotNull prepend="," property="FNL_DEAL_DPT_CD">
     FNL_DEAL_DPT_CD=#FNL_DEAL_DPT_CD#
</isNotNull>
<isNotNull prepend="," property="FNL_MNU_ID">
     FNL_MNU_ID=#FNL_MNU_ID#
</isNotNull>
<isNotNull prepend="," property="FRT_REGI_DH">
     FRT_REGI_DH=#FRT_REGI_DH#
</isNotNull>
<![CDATA[
     WHERE 1=1

			   AND AUD_YR       = #AUD_YR#
			   AND AUD_NO       = #AUD_NO#
			   AND DSP_RQ_SNO   = #DSP_RQ_SNO#
			   AND RLTN_ORG_CD  = #RLTN_ORG_CD#
			   AND ENFM_SNO     = #ENFM_SNO# 	
        ]]>
	</update>
	
	<delete id="BADFRE003ERltnOrgEnfmdelete" parameterClass="paramMap">
        <![CDATA[
        	  DELETE
        	    FROM TBBADFRE006M
			   WHERE 1 = 1
			   AND AUD_YR       = #AUD_YR#
			   AND AUD_NO       = #AUD_NO#
			   AND DSP_RQ_SNO   = #DSP_RQ_SNO#
			   AND RLTN_ORG_CD  = #RLTN_ORG_CD#
			   AND ENFM_SNO     = #ENFM_SNO#
        ]]>
	</delete>
	
	<insert id="BADFRE003EDfntEnfminsert" parameterClass="paramMap">
        <![CDATA[
  INSERT INTO TBBADFRE008M
			  (
				AUD_YR          
				,AUD_NO         
				,DSP_RQ_SNO     
				,RLTN_ORG_CD    
				,DFNT_SNO       
				,ENFM_SNO       
				,ENFM_SHP_CD    
				,PNL_AM         
				,ENFM_DT        
				,ENFM_HIS       
				,ENFM_NOC       
				,USR_ID         
				,IPT_DH         
				,FRT_USR_ID     
				,FNL_USR_ID     
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID     
				,FRT_REGI_DH    
				,FNL_MDF_DH     
			  )
			  VALUES
			  (
				#AUD_YR#         
				,#AUD_NO#         
				,#DSP_RQ_SNO#     
				,#RLTN_ORG_CD#    
				,#DFNT_SNO#       
				,#ENFM_SNO#       
				,#ENFM_SHP_CD#    
				,#PNL_AM#         
				,#ENFM_DT#        
				,#ENFM_HIS#       
				,#ENFM_NOC#       
				,#USR_ID#         
				,#IPT_DH#         
				,#FRT_USR_ID#     
				,#FNL_USR_ID#     
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#     
				,SYSDATE    
				,SYSDATE     
			  )
        ]]>
	</insert>

	<update id="BADFRE003EDfntEnfmupdate" parameterClass="paramMap">
<![CDATA[
     UPDATE TBBADFRE008M
     SET FNL_MDF_DH=SYSDATE
]]>
<isNotNull prepend="," property="AUD_YR">
     AUD_YR=#AUD_YR#
</isNotNull>
<isNotNull prepend="," property="AUD_NO">
     AUD_NO=#AUD_NO#
</isNotNull>
<isNotNull prepend="," property="DSP_RQ_SNO">
     DSP_RQ_SNO=#DSP_RQ_SNO#
</isNotNull>
<isNotNull prepend="," property="RLTN_ORG_CD">
     RLTN_ORG_CD=#RLTN_ORG_CD#
</isNotNull>
<isNotNull prepend="," property="DFNT_SNO">
     DFNT_SNO=#DFNT_SNO#
</isNotNull>
<isNotNull prepend="," property="ENFM_SNO">
     ENFM_SNO=#ENFM_SNO#
</isNotNull>
<isNotNull prepend="," property="ENFM_SHP_CD">
     ENFM_SHP_CD=#ENFM_SHP_CD#
</isNotNull>
<isNotNull prepend="," property="PNL_AM">
     PNL_AM=#PNL_AM#
</isNotNull>
<isNotNull prepend="," property="ENFM_DT">
     ENFM_DT=#ENFM_DT#
</isNotNull>
<isNotNull prepend="," property="ENFM_HIS">
     ENFM_HIS=#ENFM_HIS#
</isNotNull>
<isNotNull prepend="," property="ENFM_NOC">
     ENFM_NOC=#ENFM_NOC#
</isNotNull>
<isNotNull prepend="," property="USR_ID">
     USR_ID=#USR_ID#
</isNotNull>
<isNotNull prepend="," property="IPT_DH">
     IPT_DH=#IPT_DH#
</isNotNull>
<isNotNull prepend="," property="FRT_USR_ID">
     FRT_USR_ID=#FRT_USR_ID#
</isNotNull>
<isNotNull prepend="," property="FNL_USR_ID">
     FNL_USR_ID=#FNL_USR_ID#
</isNotNull>
<isNotNull prepend="," property="FNL_DEAL_DPT_CD">
     FNL_DEAL_DPT_CD=#FNL_DEAL_DPT_CD#
</isNotNull>
<isNotNull prepend="," property="FNL_MNU_ID">
     FNL_MNU_ID=#FNL_MNU_ID#
</isNotNull>
<isNotNull prepend="," property="FRT_REGI_DH">
     FRT_REGI_DH=#FRT_REGI_DH#
</isNotNull>
<![CDATA[
     WHERE 1=1

			    AND AUD_YR      = #AUD_YR#
				AND AUD_NO      = #AUD_NO#
				AND DSP_RQ_SNO  = #DSP_RQ_SNO#
				AND RLTN_ORG_CD = #RLTN_ORG_CD#
				AND DFNT_SNO    = #DFNT_SNO#
				AND ENFM_SNO    = #ENFM_SNO# 	
        ]]>
	</update>
	
	<delete id="BADFRE003EDfntEnfmdelete" parameterClass="paramMap">
        <![CDATA[
        	  DELETE
        	    FROM TBBADFRE008M
			   WHERE 1 = 1
				AND AUD_YR      = #AUD_YR#
				AND AUD_NO      = #AUD_NO#
				AND DSP_RQ_SNO  = #DSP_RQ_SNO#
				AND RLTN_ORG_CD = #RLTN_ORG_CD#
				AND DFNT_SNO    = #DFNT_SNO#
				AND ENFM_SNO    = #ENFM_SNO#
        ]]>
	</delete>
		
	<insert id="BADFRE003EAccountingInfoinsert" parameterClass="paramMap">
        <![CDATA[
  INSERT INTO TBBADEAR003M
			  (
				AUD_YR
				,AUD_NO
				,DSP_RQ_SNO
				,ACNT_SBJ_SNO
				,DSP_RQ_ACNT_CD
				,EPT_EFCT_DVSN_CD
				,ACNT_YE
				,PNL_DRIN_PSVT_AM
				,RSR_AM
				,SPLP_AM
				,EPT_EFCT_AM
				,EXPOT_Y_EFCT_AM
				,EXPOT_Y_EFCT_AM_CALC_BAS_TXT
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH     
			  )
			  VALUES
			  (
				#AUD_YR#
				,#AUD_NO#
				,#DSP_RQ_SNO#
				,#ACNT_SBJ_SNO#
				,#DSP_RQ_ACNT_CD#
				,#EPT_EFCT_DVSN_CD#
				,#ACNT_YE#
				,#PNL_DRIN_PSVT_AM#
				,#RSR_AM#
				,#SPLP_AM#
				,#EPT_EFCT_AM#
				,#EXPOT_Y_EFCT_AM#
				,#EXPOT_Y_EFCT_AM_CALC_BAS_TXT#
				,#FRT_USR_ID#
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
				,SYSDATE
				,SYSDATE   
			  )
        ]]>
	</insert>

	<update id="BADFRE003EAccountingInfoupdate" parameterClass="paramMap">
<![CDATA[		
     UPDATE TBBADEAR003M		
     SET FNL_MDF_DH	=	SYSDATE		
]]>		
<isNotNull prepend="," property="	AUD_YR	">
     AUD_YR	=	#AUD_YR#
</isNotNull>		
<isNotNull prepend="," property="	AUD_NO	">
     AUD_NO	=	#AUD_NO#
</isNotNull>		
<isNotNull prepend="," property="	DSP_RQ_SNO	">
     DSP_RQ_SNO	=	#DSP_RQ_SNO#
</isNotNull>		
<isNotNull prepend="," property="	ACNT_SBJ_SNO	">
     ACNT_SBJ_SNO	=	#ACNT_SBJ_SNO#
</isNotNull>		
<isNotNull prepend="," property="	DSP_RQ_ACNT_CD	">
     DSP_RQ_ACNT_CD	=	#DSP_RQ_ACNT_CD#
</isNotNull>		
<isNotNull prepend="," property="	EPT_EFCT_DVSN_CD	">
     EPT_EFCT_DVSN_CD	=	#EPT_EFCT_DVSN_CD#
</isNotNull>		
<isNotNull prepend="," property="	ACNT_YE	">
     ACNT_YE	=	#ACNT_YE#
</isNotNull>		
<isNotNull prepend="," property="	PNL_DRIN_PSVT_AM	">
     PNL_DRIN_PSVT_AM	=	#PNL_DRIN_PSVT_AM#
</isNotNull>		
<isNotNull prepend="," property="	RSR_AM	">
     RSR_AM	=	#RSR_AM#
</isNotNull>		
<isNotNull prepend="," property="	SPLP_AM	">
     SPLP_AM	=	#SPLP_AM#
</isNotNull>		
<isNotNull prepend="," property="	EPT_EFCT_AM	">
     EPT_EFCT_AM	=	#EPT_EFCT_AM#
</isNotNull>		
<isNotNull prepend="," property="	EXPOT_Y_EFCT_AM	">
     EXPOT_Y_EFCT_AM	=	#EXPOT_Y_EFCT_AM#
</isNotNull>		
<isNotNull prepend="," property="	EXPOT_Y_EFCT_AM_CALC_BAS_TXT	">
     EXPOT_Y_EFCT_AM_CALC_BAS_TXT	=	#EXPOT_Y_EFCT_AM_CALC_BAS_TXT#
</isNotNull>		
<isNotNull prepend="," property="	DSP_RQ_BK_ACNT_CD	">
     DSP_RQ_BK_ACNT_CD	=	#DSP_RQ_BK_ACNT_CD#
</isNotNull>		
<isNotNull prepend="," property="	FRT_USR_ID	">
     FRT_USR_ID	=	#FRT_USR_ID#
</isNotNull>		
<isNotNull prepend="," property="	FNL_USR_ID	">
     FNL_USR_ID	=	#FNL_USR_ID#
</isNotNull>		
<isNotNull prepend="," property="	FNL_DEAL_DPT_CD	">
     FNL_DEAL_DPT_CD	=	#FNL_DEAL_DPT_CD#
</isNotNull>		
<isNotNull prepend="," property="	FNL_MNU_ID	">
     FNL_MNU_ID	=	#FNL_MNU_ID#
</isNotNull>		
<isNotNull prepend="," property="	FRT_REGI_DH	">
     FRT_REGI_DH	=	#FRT_REGI_DH#
</isNotNull>	
<![CDATA[	
     WHERE 1=1		

				AND AUD_YR           = #AUD_YR#
				AND AUD_NO           = #AUD_NO#
				AND DSP_RQ_SNO       = #DSP_RQ_SNO#
				AND ACNT_SBJ_SNO     = #ACNT_SBJ_SNO#	
        ]]>
	</update>
	
	<delete id="BADFRE003EAccountingInfodelete" parameterClass="paramMap">
        <![CDATA[
        	  DELETE
        	    FROM TBBADEAR003M
			   WHERE 1 = 1
				AND AUD_YR           = #AUD_YR#
				AND AUD_NO           = #AUD_NO#
				AND DSP_RQ_SNO       = #DSP_RQ_SNO#
				AND ACNT_SBJ_SNO     = #ACNT_SBJ_SNO#
        ]]>
	</delete>
		
	<!-- 최종 완결처리 업데이트 -->
	<update id="BADFRE003ECompleteResultupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADEAR002D
			SET DTM_YN                        = #DTM_YN#
			   ,CPLT_DT                       = DECODE(#DTM_YN#,'Y',#CPLT_DT#,'')
			   ,CPLT_PEN_ID                   = DECODE(#DTM_YN#,'Y',#S_CNB#,'')
			   ,ENFM_CPLT_IPT_DT              = DECODE(#DTM_YN#,'Y',TO_CHAR(SYSDATE,'YYYYMMDD'),'') 
			   ,ENFM_CPLT_IPT_PEN_ID          = DECODE(#DTM_YN#,'Y',#S_CNB#,'')
			   ,ENFM_WHLS_APV_KND_CD          = DECODE(#DTM_YN#,'Y',#ENFM_WHLS_APV_KND_CD#,'')
			   ,EXAM_RPRT_DSP_RQ_SBT          = DECODE(#DTM_YN#,'Y',#EXAM_RPRT_DSP_RQ_SBT#,'')
			   ,EXAM_RPRT_UNENFM_RTWR_TXT     = DECODE(#DTM_YN#,'Y',#EXAM_RPRT_UNENFM_RTWR_TXT#,'')
			   ,EXAM_RPRT_UNENFM_RSN_EXAM_TXT = DECODE(#DTM_YN#,'Y',#EXAM_RPRT_UNENFM_RSN_EXAM_TXT#,'')
			   
			   /* 미결,완결 상태구분코드 추가 - 2016.05.19 yyh */
			   ,NOT_CPLT_STA_DVSN_CD          = #NOT_CPLT_STA_DVSN_CD#
			   ,CPLT_STA_DVSN_CD              = #CPLT_STA_DVSN_CD#
			   
			   ,FNL_USR_ID                    = #FNL_USR_ID#
			   ,FNL_DEAL_DPT_CD               = #FNL_DEAL_DPT_CD#
			   ,FNL_MNU_ID                    = #FNL_MNU_ID#
			   ,FNL_MDF_DH                    = SYSDATE
			WHERE 1 = 1
			AND AUD_YR               = #AUD_YR#
			AND AUD_NO               = #AUD_NO#
			AND DSP_RQ_SNO           = #DSP_RQ_SNO#	
        ]]>
	</update>
	
	<!-- 확정취소 - 2017.03.06 yyh -->
	<update id="BADFRE003EConfirmCancelupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADEAR002D
			   SET 
			      /* 반려 */
			       DSP_RQ_APV_STA_CD    = '4'
			      ,DSP_RQ_APV_STA_DT    = TO_CHAR(SYSDATE,'YYYYMMDD')
			      ,APV_DOC_NO           = ''
			
			      /* 확정취소 */
			      ,DTM_STA_CD           = '1'
			      ,ENFM_WHLS_DTM_DT     = ''
			      ,ENFM_WHLS_DTM_PEN_ID = ''
                  ,DTM_APV_STA_CD       = ''
			      ,DTM_APV_STA_DT       = ''
			      ,DTM_APV_DOC_NO       = ''			   
			      ,FNL_USR_ID           = #FNL_USR_ID#
			      ,FNL_DEAL_DPT_CD      = #FNL_DEAL_DPT_CD#
			      ,FNL_MNU_ID           = #FNL_MNU_ID#
			      ,FNL_MDF_DH           = SYSDATE
			 WHERE 1 = 1
			   AND AUD_YR               = #strAudYr#
			   AND AUD_NO               = #strAudNo#
			   AND DSP_RQ_SNO           = #strDspRqSno#	
        ]]>
	</update>	
	
	<!-- 확정시 결재로직을 한번 더 실행하므로, 확정취소시에만 아래 쿼리를 실행함 - 2016.05.19 yyh -->
	<update id="BADFRE003EConfirmupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADEAR002D
			SET DTM_STA_CD                    = #strDtmStaCd#
			   ,ENFM_WHLS_DTM_DT              = DECODE(#strDtmStaCd#,'2',TO_CHAR(SYSDATE,'YYYYMMDD'),'')
			   ,ENFM_WHLS_DTM_PEN_ID          = DECODE(#strDtmStaCd#,'2',#S_CNB#,'')
               ,DTM_APV_STA_CD                = ''
			   ,DTM_APV_STA_DT                = ''
			   ,DTM_APV_DOC_NO                = ''			   
			   ,FNL_USR_ID                    = #FNL_USR_ID#
			   ,FNL_DEAL_DPT_CD               = #FNL_DEAL_DPT_CD#
			   ,FNL_MNU_ID                    = #FNL_MNU_ID#
			   ,FNL_MDF_DH                    = SYSDATE
			WHERE 1 = 1
			AND AUD_YR               = #strAudYr#
			AND AUD_NO               = #strAudNo#
			AND DSP_RQ_SNO           = #strDspRqSno#	
        ]]>
	</update>
	
	<!-- 처분요구 반려 업데이트(확정시 결산담당관 반려) -->
	<update id="BADFRE003EDspRqRejectupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADEAR002D
			SET DSP_RQ_APV_STA_CD = '4'
			   ,DSP_RQ_APV_STA_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
			   ,APV_DOC_NO        = ''
			   ,DTM_RET_RSN_TXT   = #strDtmRetRsnTxt#    /* 반려사유추가 - 2016.05.18 yyh */
			   ,FNL_USR_ID        = #FNL_USR_ID#
			   ,FNL_DEAL_DPT_CD   = #FNL_DEAL_DPT_CD#
			   ,FNL_MNU_ID        = #FNL_MNU_ID#
			   ,FNL_MDF_DH        = SYSDATE
			WHERE 1 = 1
			   AND AUD_YR       = #strAudYr#
			   AND AUD_NO       = #strAudNo#
			   AND DSP_RQ_SNO   = #strDspRqSno#	
        ]]>
	</update>
	
	<update id="BADFRE003EExamOpinApvupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADFRE001H
			SET ENFM_WHLS_APV_STA_CD = #APV_STA_CD#
			   ,ENFM_WHLS_APV_STA_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
			   ,APV_DOC_NO           = #APV_DOC_NO#
			   ,FNL_USR_ID                    = #FNL_USR_ID#
			   ,FNL_DEAL_DPT_CD               = #FNL_DEAL_DPT_CD#
			   ,FNL_MNU_ID                    = #FNL_MNU_ID#
			   ,FNL_MDF_DH                    = SYSDATE
			WHERE 1 = 1
			   AND AUD_YR       = #AUD_YR#
			   AND AUD_NO       = #AUD_NO#
			   AND DSP_RQ_SNO   = #DSP_RQ_SNO#
			   AND RLTN_ORG_CD  = #RLTN_ORG_CD#
			   AND HST_NO       = #HST_NO#	
        ]]>
	</update>
		
	<!-- APV_DOC_NO(결재문서번호) 로 집행전말회보 업무 PK 조회 -->
	<select id="BADFRE003EEnfmHisKeyselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
        	SELECT T1.AUD_YR
			,T1.AUD_NO
			,T1.DSP_RQ_SNO
			,T1.RLTN_ORG_CD
			,T1.HST_NO
			FROM TBBADFRE001H T1
			WHERE 1 = 1
			AND T1.APV_DOC_NO = #APV_DOC_NO#
        ]]>
	</select>

	<!-- 처분요구대로 되지 아니한 사항 검토보고서 결재 업데이트 -->
	<update id="BADFRE003EReviewReportApvupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADEAR002D
			SET EXAM_RPRT_APV_STA_CD = #APV_STA_CD#
			   ,EXAM_RPRT_APV_STA_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
			   ,EXAM_RPRT_APV_DOC_NO = #APV_DOC_NO#
			   ,FNL_USR_ID                    = #FNL_USR_ID#
			   ,FNL_DEAL_DPT_CD               = #FNL_DEAL_DPT_CD#
			   ,FNL_MNU_ID                    = 'BADFRE003'
			   ,FNL_MDF_DH                    = SYSDATE
			WHERE 1 = 1
			   AND AUD_YR       = #AUD_YR#
			   AND AUD_NO       = #AUD_NO#
			   AND DSP_RQ_SNO   = #DSP_RQ_SNO#	
        ]]>
	</update>
		
	<!-- APV_DOC_NO(결재문서번호) 로 집행전말회보 업무 PK 조회 -->
	<select id="BADFRE003EReviewReportKeyselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
        	SELECT T3.AUD_YR
			,T3.AUD_NO
			,T3.DSP_RQ_SNO
			,T1.AUD_SBJ_NM
			,T2.TIT_TXT
			,T1.AUD_KND_CD
			,F_CODE_NM('1000007', T1.AUD_KND_CD) AS AUD_KND_NM
			,T3.RLTN_ORG_CD AS REP_RLTN_ORG_CD
            ,(SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T3.RLTN_ORG_CD AND ROWNUM = 1) AS REP_RLTN_ORG_NM
            ,T3.ENF_DT
            ,T2.DSP_RQ_KND_CD
			,F_CODE_NM('1000002', T2.DSP_RQ_KND_CD) AS DSP_RQ_KND_NM
            ,T3.EXAM_RPRT_DSP_RQ_SBT
			,T3.EXAM_RPRT_UNENFM_RTWR_TXT
		    ,T3.EXAM_RPRT_UNENFM_RSN_EXAM_TXT
			FROM TBBADDED001M T1,
			     TBBADEAR001M T2,
			     TBBADEAR002D T3
			WHERE 1 = 1
			AND T1.AUD_YR = T2.AUD_YR
			AND T1.AUD_NO = T2.AUD_NO
			AND T2.AUD_YR = T3.AUD_YR
			AND T2.AUD_NO = T3.AUD_NO
			AND T2.DSP_RQ_SNO = T3.DSP_RQ_SNO
			AND T3.EXAM_RPRT_APV_DOC_NO = #APV_DOC_NO#
        ]]>
	</select>
		
	<!-- 집행전말 회보 접수 업데이트, 접수일자 & 회보담당자(PUSH알림 수신자) -->
	<update id="BADFRE003EEnfmHisAcceptupdate" parameterClass="paramMap">
        <![CDATA[
		     UPDATE TBBADFRE001H
			 SET
			 BAI_CHGD_ACP_DT = TO_CHAR(SYSDATE, 'YYYYMMDD'),
			 EXAM_STA_CD = '1',
			 FNL_USR_ID                    = #FNL_USR_ID#,
			 FNL_DEAL_DPT_CD               = #FNL_DEAL_DPT_CD#,
			 FNL_MNU_ID                    = #FNL_MNU_ID#,
			 FNL_MDF_DH                    = SYSDATE
 			 WHERE 1 = 1
			 AND AUD_YR = #AUD_YR#
			 AND AUD_NO = #AUD_NO#
			 AND DSP_RQ_SNO = #DSP_RQ_SNO#
			 AND RLTN_ORG_CD = #RLTN_ORG_CD#
			 AND HST_NO      = #HST_NO#	
        ]]>
	</update>
		
	<!--집행전말 상세조회 집행독촉 조회-->
	<select id="BADFRE003EEnfmPrsuselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT
				T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.ENFM_PRSU_SNO
				,(
					SELECT MAX(ST1.ENFM_PRSU_SNO) + 1
					FROM TBBADFRE009M ST1
					WHERE 1 = 1
					AND ST1.AUD_YR = T1.AUD_YR
					AND ST1.AUD_NO = T1.AUD_NO
					AND ST1.DSP_RQ_SNO = T1.DSP_RQ_SNO
					AND ST1.RLTN_ORG_CD = T1.RLTN_ORG_CD
				) AS MAX_ENFM_PRSU_SNO
				,T1.ENFM_PRSU_HIS
				,T1.ENFM_PRSU_DT
				,T1.ENFM_PRSU_PEN_ID
				,F_USR_INFO(T1.ENFM_PRSU_PEN_ID, '2') AS ENFM_PRSU_PEN_NM
				,T1.UN_ENFM_RSN
				,T1.ENFM_PLAN_TXT
				,T1.ENFM_PRSU_RSP_DT
				,T1.ENFM_PRSU_RSPR_ID
				,T1.ENFM_PRSU_ACP_DT
				,T1.ENFM_PRSU_RCEP_ID
				,T1.PRSU_DVSN_CD
				,T1.SLF_ACP_STA_CD
				,T1.SLF_ACP_DT
				,T1.SLF_APV_DT
				,T1.ONR_SEN_DT
				,T1.ONR_SEN_PEN_ID
				,T1.DOC_ID
				,T1.DOC_TYP_CD
				,T1.OPM_TXT
				,T1.ONR_DOC_MNG_CRD_ID
				,T1.CVPT_OPM_APV_HNDL_STA_CD
				,T1.ADMN_INF_HNDL_NO
				,T1.ONR_APV_RQS_DH
				,T1.ONR_APV_CMPT_DH
				,T1.FRT_USR_ID
				,T1.FNL_USR_ID
				,T1.FNL_DEAL_DPT_CD
				,T1.FNL_MNU_ID
				,T1.FRT_REGI_DH
				,T1.FNL_MDF_DH
			  FROM TBBADFRE009M T1
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #strAudYr# 	
			   AND T1.AUD_NO               = #strAudNo# 	   
			   AND T1.DSP_RQ_SNO           = #strDspRqSno#	 	   
			   AND T1.RLTN_ORG_CD          = #strRltnOrgCd#     
		]]>	   
			<isNotNull prepend="," property="strEnfmPrsuSno">
     		   AND T1.ENFM_PRSU_SNO        = #strEnfmPrsuSno#
			</isNotNull>
		<![CDATA[ 	   
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.ENFM_PRSU_SNO 
        ]]>
	</select>	


	<!--집행전말 상세조회 온나라 집행독촉 조회-->
	<select id="BADFRE003EEnfmPrsuOnnaraselect" parameterClass="paramMap"
		resultMap="onnaraselect">
        <![CDATA[
			SELECT
				T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.ENFM_PRSU_SNO
				,(
					SELECT MAX(ST1.ENFM_PRSU_SNO) + 1
					FROM TBBADFRE009M ST1
					WHERE 1 = 1
					AND ST1.AUD_YR = T1.AUD_YR
					AND ST1.AUD_NO = T1.AUD_NO
					AND ST1.DSP_RQ_SNO = T1.DSP_RQ_SNO
					AND ST1.RLTN_ORG_CD = T1.RLTN_ORG_CD
				) AS MAX_ENFM_PRSU_SNO
				,T1.ENFM_PRSU_HIS
				,T1.ENFM_PRSU_DT
				,T1.ENFM_PRSU_PEN_ID
				,F_USR_INFO(T1.ENFM_PRSU_PEN_ID, '2') AS ENFM_PRSU_PEN_NM
				,T1.UN_ENFM_RSN
				,T1.ENFM_PLAN_TXT
				,T1.ENFM_PRSU_RSP_DT
				,T1.ENFM_PRSU_RSPR_ID
				,T1.ENFM_PRSU_ACP_DT
				,T1.ENFM_PRSU_RCEP_ID
				,T1.PRSU_DVSN_CD
				,T1.SLF_ACP_STA_CD
				,T1.SLF_ACP_DT
				,T1.SLF_APV_DT
				,T1.ONR_SEN_DT
				,T1.ONR_SEN_PEN_ID
				,T1.DOC_ID
				,T1.DOC_TYP_CD
				,T1.OPM_TXT
				,T1.ONR_DOC_MNG_CRD_ID
				,T1.CVPT_OPM_APV_HNDL_STA_CD
				,T1.ADMN_INF_HNDL_NO
				,T1.ONR_APV_RQS_DH
				,T1.ONR_APV_CMPT_DH
				,T1.FRT_USR_ID
				,T1.FNL_USR_ID
				,T1.FNL_DEAL_DPT_CD
				,T1.FNL_MNU_ID
				,T1.FRT_REGI_DH
				,T1.FNL_MDF_DH
				,T2.FL_RUT_NM
				,T2.SYS_FL_NM
				,'감사결과 미회보사항 집행독촉서 발송' AS TITLE
			  FROM TBBADFRE009M T1, TBDCMACM103L T2
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #strAudYr# 	
			   AND T1.AUD_NO               = #strAudNo# 	   
			   AND T1.DSP_RQ_SNO           = #strDspRqSno#	 	   
			   AND T1.RLTN_ORG_CD          = #strRltnOrgCd#
			   AND T1.ONR_DOC_MNG_CRD_ID   = T2.ONR_DOC_MNG_CRD_ID(+)     
		]]>	   
			<isNotNull property="strEnfmPrsuSno">
     		   AND T1.ENFM_PRSU_SNO        = #strEnfmPrsuSno#
			</isNotNull>
		<![CDATA[ 	   
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.ENFM_PRSU_SNO 
        ]]>
	</select>			

		
		
	<insert id="BADFRE003EEnfmPrsuinsert" parameterClass="paramMap">
        <![CDATA[       
			
	
  INSERT INTO TBBADFRE009M
			  (
				AUD_YR             
				,AUD_NO            
				,DSP_RQ_SNO        
				,RLTN_ORG_CD       
				,ENFM_PRSU_SNO     
				,ENFM_PRSU_HIS     
				,ENFM_PRSU_DT      
				,ENFM_PRSU_PEN_ID  
				,UN_ENFM_RSN       
				,ENFM_PLAN_TXT     
				,ENFM_PRSU_RSP_DT  
				,ENFM_PRSU_RSPR_ID 
				,ENFM_PRSU_ACP_DT  
				,ENFM_PRSU_RCEP_ID 
				,PRSU_DVSN_CD      
				,SLF_ACP_STA_CD    
				,SLF_ACP_DT        
				,SLF_APV_DT        
				,ONR_SEN_DT        
				,ONR_SEN_PEN_ID    
				,DOC_ID            
				,DOC_TYP_CD        
				,FRT_USR_ID        
				,FNL_USR_ID        
				,FNL_DEAL_DPT_CD   
				,FNL_MNU_ID        
				,FRT_REGI_DH       
				,FNL_MDF_DH        
			  )
			  VALUES
			  (
				#AUD_YR#
				,#AUD_NO#
				,#DSP_RQ_SNO#
				,#RLTN_ORG_CD#
				,#ENFM_PRSU_SNO#
				,#ENFM_PRSU_HIS#
				,#ENFM_PRSU_DT#
				,#ENFM_PRSU_PEN_ID#
				,#UN_ENFM_RSN#
				,#ENFM_PLAN_TXT#
				,#ENFM_PRSU_RSP_DT#
				,#ENFM_PRSU_RSPR_ID#
				,#ENFM_PRSU_ACP_DT#
				,#ENFM_PRSU_RCEP_ID#
				,#PRSU_DVSN_CD#
				,#SLF_ACP_STA_CD#
				,#SLF_ACP_DT#
				,#SLF_APV_DT#
				,#ONR_SEN_DT#
				,#ONR_SEN_PEN_ID#
				,#DOC_ID#
				,#DOC_TYP_CD#
				,#FRT_USR_ID#
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
				,SYSDATE
				,SYSDATE
			  )
        ]]>
	</insert>

	<update id="BADFRE003EEnfmPrsuupdate" parameterClass="paramMap">
<![CDATA[		
     UPDATE TBBADFRE009M		
     SET
     FNL_MDF_DH=SYSDATE     		
]]>	
<isNotNull prepend="," property="AUD_YR">
     AUD_YR=#AUD_YR#
</isNotNull>
<isNotNull prepend="," property="AUD_NO">
     AUD_NO=#AUD_NO#
</isNotNull>
<isNotNull prepend="," property="DSP_RQ_SNO">
     DSP_RQ_SNO=#DSP_RQ_SNO#
</isNotNull>
<isNotNull prepend="," property="RLTN_ORG_CD">
     RLTN_ORG_CD=#RLTN_ORG_CD#
</isNotNull>
<isNotNull prepend="," property="ENFM_PRSU_SNO">
     ENFM_PRSU_SNO=#ENFM_PRSU_SNO#
</isNotNull>
<isNotNull prepend="," property="ENFM_PRSU_HIS">
     ENFM_PRSU_HIS=#ENFM_PRSU_HIS#
</isNotNull>
<isNotNull prepend="," property="ENFM_PRSU_DT">
     ENFM_PRSU_DT=#ENFM_PRSU_DT#
</isNotNull>
<isNotNull prepend="," property="ENFM_PRSU_PEN_ID">
     ENFM_PRSU_PEN_ID=#ENFM_PRSU_PEN_ID#
</isNotNull>
<isNotNull prepend="," property="UN_ENFM_RSN">
     UN_ENFM_RSN=#UN_ENFM_RSN#
</isNotNull>
<isNotNull prepend="," property="ENFM_PLAN_TXT">
     ENFM_PLAN_TXT=#ENFM_PLAN_TXT#
</isNotNull>
<isNotNull prepend="," property="ENFM_PRSU_RSP_DT">
     ENFM_PRSU_RSP_DT=#ENFM_PRSU_RSP_DT#
</isNotNull>
<isNotNull prepend="," property="ENFM_PRSU_RSPR_ID">
     ENFM_PRSU_RSPR_ID=#ENFM_PRSU_RSPR_ID#
</isNotNull>
<isNotNull prepend="," property="ENFM_PRSU_ACP_DT">
     ENFM_PRSU_ACP_DT=#ENFM_PRSU_ACP_DT#
</isNotNull>
<isNotNull prepend="," property="ENFM_PRSU_RCEP_ID">
     ENFM_PRSU_RCEP_ID=#ENFM_PRSU_RCEP_ID#
</isNotNull>
<isNotNull prepend="," property="PRSU_DVSN_CD">
     PRSU_DVSN_CD=#PRSU_DVSN_CD#
</isNotNull>
<isNotNull prepend="," property="SLF_ACP_STA_CD">
     SLF_ACP_STA_CD=#SLF_ACP_STA_CD#
</isNotNull>
<isNotNull prepend="," property="SLF_ACP_DT">
     SLF_ACP_DT=#SLF_ACP_DT#
</isNotNull>
<isNotNull prepend="," property="SLF_APV_DT">
     SLF_APV_DT=#SLF_APV_DT#
</isNotNull>
<isNotNull prepend="," property="ONR_SEN_DT">
     ONR_SEN_DT=#ONR_SEN_DT#
</isNotNull>
<isNotNull prepend="," property="ONR_SEN_PEN_ID">
     ONR_SEN_PEN_ID=#ONR_SEN_PEN_ID#
</isNotNull>
<isNotNull prepend="," property="DOC_ID">
     DOC_ID=#DOC_ID#
</isNotNull>
<isNotNull prepend="," property="DOC_TYP_CD">
     DOC_TYP_CD=#DOC_TYP_CD#
</isNotNull>
<isNotNull prepend="," property="FRT_USR_ID">
     FRT_USR_ID=#FRT_USR_ID#
</isNotNull>
<isNotNull prepend="," property="FNL_USR_ID">
     FNL_USR_ID=#FNL_USR_ID#
</isNotNull>
<isNotNull prepend="," property="FNL_DEAL_DPT_CD">
     FNL_DEAL_DPT_CD=#FNL_DEAL_DPT_CD#
</isNotNull>
<isNotNull prepend="," property="FNL_MNU_ID">
     FNL_MNU_ID=#FNL_MNU_ID#
</isNotNull>
<isNotNull prepend="," property="FRT_REGI_DH">
     FRT_REGI_DH=#FRT_REGI_DH#
</isNotNull>
<![CDATA[
     WHERE 1=1		
			   AND AUD_YR        = #AUD_YR#
			   AND AUD_NO        = #AUD_NO#
			   AND DSP_RQ_SNO    = #DSP_RQ_SNO#
			   AND RLTN_ORG_CD   = #RLTN_ORG_CD#
			   AND ENFM_PRSU_SNO = #ENFM_PRSU_SNO#
]]>			   
	</update>
	
	<delete id="BADFRE003EEnfmPrsudelete" parameterClass="paramMap">
        <![CDATA[
        	  DELETE
        	    FROM TBBADFRE009M
			   WHERE 1 = 1
			   AND AUD_YR        = #AUD_YR#
			   AND AUD_NO        = #AUD_NO#
			   AND DSP_RQ_SNO    = #DSP_RQ_SNO#
			   AND RLTN_ORG_CD   = #RLTN_ORG_CD#
			   AND ENFM_PRSU_SNO = #ENFM_PRSU_SNO#
        ]]>
	</delete>
		
		
		
	<insert id="BADFRE003EEnfmReturnHisReturninsert" parameterClass="paramMap">
        <![CDATA[       
			
	
  INSERT INTO TBBADFRE021H
			  (
				CON_NO             
				,AUD_YR            
				,AUD_NO        
				,DSP_RQ_SNO       
				,RLTN_ORG_CD     
				,HST_NO        
				,ENFM_DT
				,ENFM_STEP_CD
				,ENFM_HIS
				,HST_RMK
				,SLF_SEN_DT
				,TG_ORG_APVR_BLT_NM
				,TG_ORG_APVR_RANK_NM
				,TG_ORG_APVR_PST_NM
				,TG_ORG_APVR_NAM
				,EXAM_OPIN_TXT
				,EXAM_STA_CD
				,CHGR_ID
				,CHGR_IPT_DH
				,USE_YN
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
			  )
			  VALUES
			  (
				(SELECT NVL(MAX(ST1.CON_NO), 0)+ 1
					  FROM TBBADFRE021H ST1
					 WHERE 1 = 1)
				,#AUD_YR#
				,#AUD_NO#
				,#DSP_RQ_SNO#
				,#RLTN_ORG_CD#
				,#HST_NO#
				,#ENFM_DT#
				,#ENFM_STEP_CD#
				,#ENFM_HIS#
				,#HST_RMK#
				,#SLF_SEN_DT#
				,#TG_ORG_APVR_BLT_NM#
				,#TG_ORG_APVR_RANK_NM#
				,#TG_ORG_APVR_PST_NM#
				,#TG_ORG_APVR_NAM#
				,#EXAM_OPIN_TXT#
				,#EXAM_STA_CD#
				,#CHGR_ID#
				,#CHGR_IPT_DH#
				,'N'
				,#FRT_USR_ID#
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
				,SYSDATE
				,SYSDATE
			  )
        ]]>
	</insert>
		
	<update id="BADFRE003EHRAInfoupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADEAR002D
			SET HRK_MNG_ASG_YN                = #HRK_MNG_ASG_YN#
			   ,HRK_MNG_ASG_RSN               = DECODE(#HRK_MNG_ASG_YN#,'Y',#HRK_MNG_ASG_RSN#,'')
			   ,FNL_USR_ID                    = #FNL_USR_ID#
			   ,FNL_DEAL_DPT_CD               = #FNL_DEAL_DPT_CD#
			   ,FNL_MNU_ID                    = #FNL_MNU_ID#
			   ,FNL_MDF_DH                    = SYSDATE
			WHERE 1 = 1
			AND AUD_YR               = #AUD_YR#
			AND AUD_NO               = #AUD_NO#
			AND DSP_RQ_SNO           = #DSP_RQ_SNO#	
        ]]>
	</update>
	
	<select id="BADFRE003EGccDptInfoselect" parameterClass="paramMap" resultClass="resultMap">
        <![CDATA[
        	SELECT F_DPT_INFO(#strDptCd#,'6')                       AS GCC_DPT_CD
                  ,D2.FRML_DPT_NM			                        AS GCC_DPT_NM
                  ,D1.RANK_NM_2                                     AS POSITION_NM
             FROM TBDCMACM001M D1,
             	  TBDCMACM002M D2
            WHERE D1.DPT_CD = D2.DPT_CD
            AND   D1.CNB = #strScnb#
		]]>
	</select>
			
	<update id="BADFRE003EOnnaraupdate" parameterClass="paramMap">
		UPDATE TBBADFRE009M                                     /* 금융정보제출요구사항기본 */
		   SET ONR_SEN_DT        = TO_CHAR(SYSDATE,'YYYYMMDD')  /* 온나라발송일 */
		      ,ONR_SEN_PEN_ID    = #ONR_SEN_PEN_ID#             /* 온나라발송자ID */
		      ,ONR_DOC_MNG_CRD_ID= #ONR_DOC_MNG_CRD_ID#
		      ,OPM_TXT           = #OPM_TXT#
		 WHERE AUD_YR        = #AUD_YR#                         /* 감사년도 */
		   AND AUD_NO        = #AUD_NO#                         /* 감사번호 */
		   AND DSP_RQ_SNO    = #DSP_RQ_SNO#                     /* 처분요구순번 */
		   AND RLTN_ORG_CD   = #RLTN_ORG_CD#                    /* 관계기관코드 */
		   AND ENFM_PRSU_SNO = #ENFM_PRSU_SNO#                  /* 집행독촉순번 */
	</update>
		
	<insert id="BADFRE003EEnfmDelHisinsert" parameterClass="paramMap">
        <![CDATA[       
			
	
  INSERT INTO TBBADFRE022H
			  (
			    CON_NO
				,AUD_YR            
				,AUD_NO        
				,DSP_RQ_SNO       
				,RLTN_ORG_CD     
				,HST_NO
				,CON_HNDL_CD
				,USE_YN
				,CON_RTRN_CD      
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
			  )
			  VALUES
			  (
			    (SELECT NVL(MAX(ST1.CON_NO), 0)+ 1
					  FROM TBBADFRE022H ST1
					 WHERE 1 = 1)
				,#AUD_YR#
				,#AUD_NO#
				,#DSP_RQ_SNO#
				,#RLTN_ORG_CD#
				,#HST_NO#
				,'D'
				,'N'
				,'900'
				,#FRT_USR_ID#
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
				,SYSDATE
				,SYSDATE
			  )
        ]]>
	</insert>
		
		
	<resultMap class="java.util.HashMap" id="examRprtselect">
		<result property="AUD_YR"                        column="AUD_YR"                        jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="AUD_NO"                        column="AUD_NO"                        jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DSP_RQ_SNO"                    column="DSP_RQ_SNO"                    jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_DSP_RQ_SBT"          column="EXAM_RPRT_DSP_RQ_SBT"          jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_UNENFM_RTWR_TXT"     column="EXAM_RPRT_UNENFM_RTWR_TXT"     jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_UNENFM_RSN_EXAM_TXT" column="EXAM_RPRT_UNENFM_RSN_EXAM_TXT" jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_APV_STA_DT"          column="EXAM_RPRT_APV_STA_DT"          jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_APV_DOC_NO"          column="EXAM_RPRT_APV_DOC_NO"          jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_APV_STA_CD"          column="EXAM_RPRT_APV_STA_CD"          jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_ALL_TXT"             column="EXAM_RPRT_ALL_TXT"             jdbcType="CLOB"     javaType="java.lang.String"/>
	</resultMap>
			
	<!-- 검토보고서 내용조회 -->
	<select id="BADFRE003EExamRprtselect" parameterClass="paramMap" resultMap="examRprtselect">
        <![CDATA[
			SELECT AUD_YR                         /* 감사년도 */
			      ,AUD_NO                         /* 감사번호 */
			      ,DSP_RQ_SNO                     /* 처분요구순번 */
			      ,EXAM_RPRT_DSP_RQ_SBT           /* 검토보고서처분요구요지 */
			      ,EXAM_RPRT_UNENFM_RTWR_TXT      /* 검토보고서미집행경위내용 */
			      ,EXAM_RPRT_UNENFM_RSN_EXAM_TXT  /* 검토보고서미집행사유검토내용 */
			      ,EXAM_RPRT_APV_STA_DT           /* 검토보고서결재상태일 */
			      ,EXAM_RPRT_APV_DOC_NO           /* 검토보고서결재문서번호 */
			      ,EXAM_RPRT_APV_STA_CD           /* 검토보고서결재상태코드 */
			      ,EXAM_RPRT_ALL_TXT              /* 검토보고서전체내용 */
			  FROM TBBADEAR002D 
			 WHERE 1 = 1
			   AND AUD_YR     = #strAudYr#	 	
			   AND AUD_NO     = #strAudNo#	 	   
			   AND DSP_RQ_SNO = #strDspRqSno#       
        ]]>
	</select>

	<!-- 최종 완결처리 업데이트 -->
	<update id="BADFRE003EExamRprtupdate" parameterClass="paramMap">
        <![CDATA[
			UPDATE TBBADEAR002D
			   SET EXAM_RPRT_ALL_TXT = #EXAM_RPRT_ALL_TXT# 
			      ,FNL_USR_ID        = #FNL_USR_ID#
			      ,FNL_DEAL_DPT_CD   = #FNL_DEAL_DPT_CD#
			      ,FNL_MNU_ID        = #FNL_MNU_ID#
			      ,FNL_MDF_DH        = SYSDATE
			 WHERE 1 = 1
			   AND AUD_YR            = #AUD_YR#
			   AND AUD_NO            = #AUD_NO#
			   AND DSP_RQ_SNO        = #DSP_RQ_SNO#	
        ]]>
	</update>
	
	<!-- 결재선 조회 -->
	<select id="BADFRE003EApvLineselect" parameterClass="paramMap" resultClass="resultMap">	
        <![CDATA[
                  SELECT T2.APVR_STA_CD                       AS APVR_STA_CD                    
                        ,T2.APVR_CNB                          AS APVR_CNB
                        ,F_USR_INFO(T2.APVR_CNB ,'2')         AS APVR_NM
                        ,T2.APVR_RANK_CD                      AS APVR_RANK_CD
                        ,F_CODE_NM('1000173',T2.APVR_RANK_CD) AS APVR_RANK_NM
                        ,T2.APVR_PST_CD                       AS APVR_PST_CD
                        ,F_CODE_NM('1000176', T2.APVR_PST_CD) AS APVR_PST_NM
                        ,TO_CHAR(APV_DH,'YYYY.MM.DD')         AS APV_DT
                    FROM TBBADEAR002D T1
                        ,TBDCMACM023L T2
                   WHERE 1=1
                     AND T1.APV_DOC_NO = T2.APV_DOC_NO
                     AND T1.AUD_YR     = #strAudYr#
                     AND T1.AUD_NO     = #strAudNo#
                     AND T1.DSP_RQ_SNO = #strDspRqSno#
                   ORDER BY T2.APV_SNO
        ]]>
	</select>	
</sqlMap> 