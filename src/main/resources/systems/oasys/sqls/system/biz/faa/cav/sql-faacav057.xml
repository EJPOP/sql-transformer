<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/057"> 
	 
	<!--SW자료실 목록 조회-->
	<select id="FAACAV057EMainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/057/FAACAV057EMainselect */ ]]>
		<include refid="include.pageSelct" />		
        <![CDATA[       
			SELECT ROWNUM AS KEY,
				   GRP_NO,
			       RPL_SNO,
			       LVL_CNT,
			       TO_CHAR(TXT) AS TXT,
			       TIT_NM,
			       SRCH_CNT,
			       REGN_NM,
			       BRD_DVSN_CD,
			       RMK,
			       REGN_ID,
			       DOC_ID,
			       REGI_DH,
			       SRNO,
			       TNB,
			       EML_AD,
			       REGI_ORG_NM
			  FROM TWFAACAV065L 
              WHERE 1 = 1
              AND  BRD_DVSN_CD = 'SW'
              ]]>
		<isNotEmpty property="strSrchFrom">
				AND TO_CHAR(REGI_DH,'YYYYMMDD') <![CDATA[ >= ]]> #strSrchFrom#
		</isNotEmpty>
		<isNotEmpty property="strSrchTo">
				AND TO_CHAR(REGI_DH,'YYYYMMDD') <![CDATA[ <= ]]> #strSrchTo#
		</isNotEmpty>
        <isNotEmpty property="strSrno">	 	   
			   AND SRNO     = #strSrno#
		</isNotEmpty>	
		<isNotEmpty property="strSrchNm">
			<isEqual property="strSndCd" compareValue="0">
			   AND  (TIT_NM like '%'||#strSrchNm#||'%' OR TXT like '%'||#strSrchNm#||'%')
			</isEqual>		
			<isEqual property="strSndCd" compareValue="1">
			   AND  TIT_NM like '%'||#strSrchNm#||'%'
			</isEqual>
			<isEqual property="strSndCd" compareValue="2">
			   AND  TXT like '%'||#strSrchNm#||'%'
			</isEqual>			
		</isNotEmpty> 
		<include refid="include.pageOrder" />		
 		ORDER BY KEY DESC
	</select>

	
	<!--SW자료실 INSERT-->
	<insert id="FAACAV057EMaininsert" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/057/FAACAV057EMaininsert */ ]]>
		INSERT INTO TWFAACAV065L
		(
			 BRD_DVSN_CD
			,SRNO
			,GRP_NO
			,RPL_SNO
			,LVL_CNT
			,TIT_NM
			,REGI_DH
			,REGI_ORG_NM
			,REGN_ID
			,REGN_NM
			,SRCH_CNT
			,TXT
			,DOC_ID
			,TNB
			,EML_AD
			,RMK
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID			
		) VALUES (
			 'SW'
			,#SRNO#
			,#GRP_NO#
			,#RPL_SNO#
			,#LVL_CNT#
			,#TIT_NM#
			,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
			,#REGI_ORG_NM#
			,#REGN_ID#
			,#REGN_NM#
			,0
			,#TXT#
			,#DOC_ID#
			,#TNB#
			,#EML_AD#
			,#RMK#
			,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
			,'TEST'
			,TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
			,'TEST'
			,'TEST'
			,'TEST'			
		)
	</insert>	

	<!-- 일련번호 Max값 찾기 -->
	<select id="FAACAV057EMainMaxSnoSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/057/FAACAV057EMainMaxSnoSelect */ ]]>
        <![CDATA[     	
			    SELECT TO_CHAR(NVL(MAX(TO_NUMBER(SRNO)),0)+1) AS MAX_SEQ
				  FROM TWFAACAV065L
				 WHERE BRD_DVSN_CD = 'SW'
		]]>
	</select>

	<!-- 조회수 구하기 -->
	<select id="FAACAV057ESrchCntSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/057/FAACAV057ESrchCntSelect */ ]]>
        <![CDATA[     	
			     SELECT TO_CHAR(NVL(TO_NUMBER(SRCH_CNT),0)+1) AS CNT
				  FROM TWFAACAV065L
				 WHERE BRD_DVSN_CD = 'SW'
				 AND SRNO        = #SRNO# 
		]]>
	</select>
		
	<!--SW delete-->
	<delete id="FAACAV057EMainDelete" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/057/FAACAV057EMainDelete */ ]]>
		   DELETE 
			 FROM 	TWFAACAV065L
			WHERE 1=1
			  AND BRD_DVSN_CD                = 'SW' 
		      AND SRNO                = #SRNO# 
	</delete>	
	
			<!--SW update-->
	<update id="FAACAV057EMainUpdate" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/057/FAACAV057EMainUpdate */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV065L
			   SET TIT_NM                 = #TIT_NM# 
			     , TXT                = #TXT#
			     , DOC_ID         = #DOC_ID# 		
		]]>	    
			  WHERE 1=1
			  AND BRD_DVSN_CD                = 'SW' 
		      AND SRNO                = #SRNO# 
	</update>
	
	<!--조회수 update-->
	<update id="FAACAV057EMainSrchCntUpdate" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/057/FAACAV057EMainSrchCntUpdate */ ]]>
		<![CDATA[ 	
			UPDATE TWFAACAV065L
			   SET SRCH_CNT                 = #SRCH_CNT# 
		]]>	    	
			  WHERE 1=1
			  AND BRD_DVSN_CD                = 'SW' 
		      AND SRNO                = #SRNO# 
	</update>
	
	<!-- SW자료실 게시판 상세 데이터 조회-->
	<select id="FAACAV057EDetailselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/056/FAACAV056EDetailselect */ ]]>
        <![CDATA[       
			SELECT ROWNUM AS KEY,
				   BRD_DVSN_CD,
				   SRNO,
				   GRP_NO,
			       TIT_NM,
			       TO_CHAR(REGI_DH,'YYYYMMDD') AS REGI_DH,
			       REGN_NM,
			       SRCH_CNT,
			       TO_CHAR(TXT) AS TXT,
			       DOC_ID
			  FROM TWFAACAV065L
              WHERE 1 = 1
              AND  BRD_DVSN_CD = #strBrdDvsnCd#
		]]>
        <isNotEmpty property="strSrno">	 	   
			   AND SRNO     = #strSrno#
		</isNotEmpty>		
 			ORDER BY SRNO DESC
	</select>
	
</sqlMap> 
