<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/055">
	
	<select id="FAACAV055EMainSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/055/FAACAV055EMainSelect */ ]]>
		<include refid="include.pageSelct" />	
        <![CDATA[
			SELECT
				ROWNUM AS KEY, 
				CASE   WHEN #strMm# = '01' AND (NVL(TRIM(MSTR.MN_1_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '02' AND (NVL(TRIM(MSTR.MN_2_ACP_DT),'') <> '' OR TRIM(MSTR.MN_2_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '03' AND (NVL(TRIM(MSTR.MN_3_ACP_DT),'') <> '' OR TRIM(MSTR.MN_3_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '04' AND (NVL(TRIM(MSTR.MN_4_ACP_DT),'') <> '' OR TRIM(MSTR.MN_4_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '05' AND (NVL(TRIM(MSTR.MN_5_ACP_DT),'') <> '' OR TRIM(MSTR.MN_5_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '06' AND (NVL(TRIM(MSTR.MN_6_ACP_DT),'') <> '' OR TRIM(MSTR.MN_6_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '07' AND (NVL(TRIM(MSTR.MN_7_ACP_DT),'') <> '' OR TRIM(MSTR.MN_7_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '08' AND (NVL(TRIM(MSTR.MN_8_ACP_DT),'') <> '' OR TRIM(MSTR.MN_8_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '09' AND (NVL(TRIM(MSTR.MN_9_ACP_DT),'') <> '' OR TRIM(MSTR.MN_9_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '10' AND (NVL(TRIM(MSTR.MN_1_0_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_0_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '11' AND (NVL(TRIM(MSTR.MN_1_1_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_1_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '12' AND (NVL(TRIM(MSTR.MN_1_2_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_2_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '13' AND (NVL(TRIM(MSTR.MN_1_3_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_3_ACP_DT) <>  '*') THEN 'Y'
				       ELSE 'N' 
				   END AS CHK,
				   MSTR.COPT_CD||'-'||MSTR.ACNT_CD||'-'||MSTR.BLL_CD||'-'||MSTR.PROF_DRTR_SRNO||'-'||MSTR.DL_XPN_RCDB_PBSVT_SRNO PROF_DRTR_SG,
			       MSTR.PROF_YR,
			       MN.ORG_NM,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_ACP_DT) END M1_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_2_ACP_DT),'') <> '' OR TRIM(MSTR.MN_2_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_2_ACP_DT) END M2_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_3_ACP_DT),'') <> '' OR TRIM(MSTR.MN_3_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_3_ACP_DT) END M3_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_4_ACP_DT),'') <> '' OR TRIM(MSTR.MN_4_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_4_ACP_DT) END M4_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_5_ACP_DT),'') <> '' OR TRIM(MSTR.MN_5_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_5_ACP_DT) END M5_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_6_ACP_DT),'') <> '' OR TRIM(MSTR.MN_6_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_6_ACP_DT) END M6_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_7_ACP_DT),'') <> '' OR TRIM(MSTR.MN_7_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_7_ACP_DT) END M7_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_8_ACP_DT),'') <> '' OR TRIM(MSTR.MN_8_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_8_ACP_DT) END M8_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_9_ACP_DT),'') <> '' OR TRIM(MSTR.MN_9_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_9_ACP_DT) END M9_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_0_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_0_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_0_ACP_DT) END M10_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_1_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_1_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_1_ACP_DT) END M11_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_2_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_2_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_2_ACP_DT) END M12_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_3_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_3_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_3_ACP_DT) END M13_ACP,
			      TRIM(MSTR.MN_1_ACP_DT) M1_ACP_DT, 
			      TRIM(MSTR.MN_2_ACP_DT) M2_ACP_DT, 
			      TRIM(MSTR.MN_3_ACP_DT) M3_ACP_DT, 
			      TRIM(MSTR.MN_4_ACP_DT) M4_ACP_DT,
			      TRIM(MSTR.MN_5_ACP_DT) M5_ACP_DT, 
			      TRIM(MSTR.MN_6_ACP_DT) M6_ACP_DT, 
			      TRIM(MSTR.MN_7_ACP_DT) M7_ACP_DT, 
			      TRIM(MSTR.MN_8_ACP_DT) M8_ACP_DT, 
			      TRIM(MSTR.MN_9_ACP_DT) M9_ACP_DT, 
			      TRIM(MSTR.MN_1_0_ACP_DT) M10_ACP_DT, 
			      TRIM(MSTR.MN_1_1_ACP_DT) M11_ACP_DT,
			      TRIM(MSTR.MN_1_2_ACP_DT) M12_ACP_DT, 
			      TRIM(MSTR.MN_1_3_ACP_DT) M13_ACP_DT,
			      F_AV_ACNT_CD_NM(MSTR.ACNT_CD) ACNT_NM,
			      F_AV_BLL_PERIOD_NM(MSTR.BLL_CD) RMK_NM
			FROM TWFAACAV008M MSTR,TWFAACAV003M MN
			WHERE 1 = 1
			  AND MSTR.COPT_CD = MN.COPT_CD
			  AND MSTR.ACNT_CD = MN.ACNT_CD 
			  AND MSTR.BLL_CD = MN.BLL_CD 
			  AND MSTR.PROF_DRTR_SRNO = MN.PROF_DRTR_SRNO 
			  AND MSTR.DL_XPN_RCDB_PBSVT_SRNO = MN.DL_XPN_RCDB_PBSVT_SRNO			
		]]>	   
		<isNotEmpty property="strYr">	
			   AND MSTR.PROF_YR     = #strYr#
		</isNotEmpty>
		<isNotEmpty property="strCoptCd">	 	   
			   AND MSTR.COPT_CD     = #strCoptCd#
		</isNotEmpty>   	
		<isNotEmpty property="strAcntCd">	 	   
			   AND MSTR.ACNT_CD     = #strAcntCd#
		</isNotEmpty>
				
		<isNotEmpty property="strProfDrtrSrno">
			<isNotEmpty property="strBllCd">
				AND  MSTR.BLL_CD = #strBllCd#
			</isNotEmpty>	 	   
			AND MSTR.PROF_DRTR_SRNO = #strProfDrtrSrno#
		</isNotEmpty> 
		<isEmpty property="strProfDrtrSrno">
			<isEqual property="strBllCd" compareValue="17">	 	   
				AND  MSTR.BLL_CD IN ('17','18')
			</isEqual>
			<isEqual property="strBllCd" compareValue="18">	 	   
				AND  MSTR.BLL_CD IN ('17','18')
			</isEqual>			
			<isEqual property="strBllCd" compareValue="22">	 	   
				AND  MSTR.BLL_CD IN ('22','23','24')
			</isEqual>
			<isEqual property="strBllCd" compareValue="23">	 	   
				AND  MSTR.BLL_CD IN ('22','23','24')
			</isEqual>
			<isEqual property="strBllCd" compareValue="24">	 	   
				AND  MSTR.BLL_CD IN ('22','23','24')
			</isEqual>	
			<isEqual property="strBllCd" compareValue="42">	 	   
				AND  MSTR.BLL_CD IN ('42','43')
			</isEqual>	
			<isEqual property="strBllCd" compareValue="43">	 	   
				AND  MSTR.BLL_CD IN ('42','43')
			</isEqual>
			<isNotEmpty property="strBllCd">
				AND MSTR.BLL_CD = CASE WHEN #strBllCd# IN ('17','18','22','23','24','42','43') THEN MSTR.BLL_CD 
				                    ELSE #strBllCd#
				               END
			</isNotEmpty>
		</isEmpty>   
		
		<isNotEmpty property="strProfDrtrSrno">	 	   
			   AND MSTR.PROF_DRTR_SRNO     = #strProfDrtrSrno#
		</isNotEmpty> 
		<isNotEmpty property="strDlXpnRcdbPbsvtSrno">	 	   
			   AND MSTR.DL_XPN_RCDB_PBSVT_SRNO     = #strDlXpnRcdbPbsvtSrno#
		</isNotEmpty>		

					
		<isNotEmpty property="strRegiYn">
			<isEqual property="strRegiYn" compareValue="Y"> 
				<isEqual property="strMm" compareValue="00">
				   AND  MSTR.MN_1_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND  MSTR.MN_1_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  MSTR.MN_2_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  MSTR.MN_3_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  MSTR.MN_4_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  MSTR.MN_5_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  MSTR.MN_6_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  MSTR.MN_7_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  MSTR.MN_8_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  MSTR.MN_9_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  MSTR.MN_1_0_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  MSTR.MN_1_1_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  MSTR.MN_1_2_ACP_DT IS NOT NULL
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  MSTR.MN_1_3_ACP_DT IS NOT NULL
				</isEqual>
			</isEqual>	
			
			<isEqual property="strRegiYn" compareValue="N">
				<isEqual property="strMm" compareValue="00">
				   AND  MSTR.MN_1_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND  MSTR.MN_1_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  MSTR.MN_2_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  MSTR.MN_3_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  MSTR.MN_4_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  MSTR.MN_5_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  MSTR.MN_6_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  MSTR.MN_7_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  MSTR.MN_8_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  MSTR.MN_9_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  MSTR.MN_1_0_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  MSTR.MN_1_1_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  MSTR.MN_1_2_ACP_DT IS NULL
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  MSTR.MN_1_3_ACP_DT IS NULL
				</isEqual>
			</isEqual>	

																										
		</isNotEmpty> 		
			<include refid="include.pageOrder" />
			 ORDER BY PROF_DRTR_SG, PROF_YR, ORG_NM
	</select> 
	
	<select id="FAACAV055EMainSelect2" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/055/FAACAV055EMainSelect2 */ ]]>
        <![CDATA[
			SELECT	DECODE(A.MN_1_STA_CD, '', 'N', 'Y')  AS M1_ACP
					,DECODE(A.MN_2_STA_CD, '', 'N', 'Y') AS M2_ACP
					,DECODE(A.MN_3_STA_CD, '', 'N', 'Y') AS M3_ACP
					,DECODE(A.MN_4_STA_CD, '', 'N', 'Y') AS M4_ACP
					,DECODE(A.MN_5_STA_CD, '', 'N', 'Y') AS M5_ACP
					,DECODE(A.MN_6_STA_CD, '', 'N', 'Y') AS M6_ACP
					,DECODE(A.MN_7_STA_CD, '', 'N', 'Y') AS M7_ACP
					,DECODE(A.MN_8_STA_CD, '', 'N', 'Y') AS M8_ACP
					,DECODE(A.MN_9_STA_CD, '', 'N', 'Y') AS M9_ACP
					,DECODE(A.MN_1_0_STA_CD, '', 'N', 'Y') AS M10_ACP
					,DECODE(A.MN_1_1_STA_CD, '', 'N', 'Y') AS M11_ACP
					,DECODE(A.MN_1_2_STA_CD, '', 'N', 'Y') AS M12_ACP
					,DECODE(A.MN_1_3_STA_CD, '', 'N', 'Y') AS M13_ACP
					
					,B.MN_1_ACP_DT AS M1_ACP_DT
					,B.MN_2_ACP_DT AS M2_ACP_DT
					,B.MN_3_ACP_DT AS M3_ACP_DT
					,B.MN_4_ACP_DT AS M4_ACP_DT
					,B.MN_5_ACP_DT AS M5_ACP_DT
					,B.MN_6_ACP_DT AS M6_ACP_DT
					,B.MN_7_ACP_DT AS M7_ACP_DT
					,B.MN_8_ACP_DT AS M8_ACP_DT
					,B.MN_9_ACP_DT AS M9_ACP_DT
					,B.MN_1_0_ACP_DT AS M10_ACP_DT
					,B.MN_1_1_ACP_DT AS M11_ACP_DT
					,B.MN_1_2_ACP_DT AS M12_ACP_DT
					,B.MN_1_3_ACP_DT AS M13_ACP_DT
			FROM	TWFAACAV007M A,
					TWFAACAV008M B
			WHERE	1=1
			AND		A.PROF_YR = B.PROF_YR
			AND 	A.COPT_CD = B.COPT_CD
			AND 	A.ACNT_CD = B.ACNT_CD
			AND 	A.BLL_CD = B.BLL_CD
			AND 	A.PROF_DRTR_SRNO = B.PROF_DRTR_SRNO
			AND 	A.DL_XPN_RCDB_PBSVT_SRNO = B.DL_XPN_RCDB_PBSVT_SRNO
			AND 	A.PROF_YR =  #strYr#
			AND 	A.COPT_CD = #strCoptCd#
			AND 	A.ACNT_CD = #strAcntCd#
			AND 	A.BLL_CD  =  #strBllCd#
			AND 	A.PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND 	A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		]]>	 	 
	</select>
	
	<!-- ***************************************************************************** -->
	<!-- MAIN화면 서면계산서 등록시 update -->
	<update id="FAACAV055EPaperMstrMainUpdate1" parameterClass="paramMap"	>
		<![CDATA[  /* faa/cav/055/FAACAV055EPaperMstrMainUpdate1 */ ]]>
        <![CDATA[
			UPDATE TWFAACAV008M 
			   SET 
		]]>	 	 

			<isNotEmpty property="PROF_MM">	
				<isEqual property="PROF_MM" compareValue="01">
				   MN_1_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="02">
				   MN_2_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="03">
				   MN_3_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="04">
				   MN_4_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="05">
				   MN_5_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="06">
				   MN_6_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="07">
				   MN_7_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="08">
				   MN_8_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>		
				<isEqual property="PROF_MM" compareValue="09">
				   MN_9_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="10">
				   MN_1_0_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="11">
				   MN_1_1_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>
				<isEqual property="PROF_MM" compareValue="12">
				   MN_1_2_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>		
				<isEqual property="PROF_MM" compareValue="13">
				   MN_1_3_ACP_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
				</isEqual>											
			</isNotEmpty>				   


		
		<![CDATA[								
			 WHERE	1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YR = #PROF_YR#
		]]>	   

	</update> 

	<!--MAIN화면 서면계산서 취소시 update -->
	<update id="FAACAV055EPaperMstrMainUpdate2" parameterClass="paramMap"	>
		<![CDATA[  /* faa/cav/055/FAACAV055EPaperMstrMainUpdate2 */ ]]>
        <![CDATA[
			UPDATE TWFAACAV008M 
			   SET 
		]]>	 	 

			<isNotEmpty property="PROF_MM">	
				<isEqual property="PROF_MM" compareValue="01">
				   MN_1_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="02">
				   MN_2_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="03">
				   MN_3_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="04">
				   MN_4_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="05">
				   MN_5_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="06">
				   MN_6_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="07">
				   MN_7_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="08">
				   MN_8_ACP_DT = NULL
				</isEqual>		
				<isEqual property="PROF_MM" compareValue="09">
				   MN_9_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="10">
				   MN_1_0_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="11">
				   MN_1_1_ACP_DT = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="12">
				   MN_1_2_ACP_DT = NULL
				</isEqual>		
				<isEqual property="PROF_MM" compareValue="13">
				   MN_1_3_ACP_DT = NULL
				</isEqual>											
			</isNotEmpty>				   


		
		<![CDATA[								
			 WHERE	1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YR = #PROF_YR#
		]]>	   

	</update> 

	<!--MAIN화면 접수마스터 등록시 update -->
	<update id="FAACAV055EAcctMstrMainUpdate1" parameterClass="paramMap"	>
		<![CDATA[  /* faa/cav/055/FAACAV055EAcctMstrMainUpdate1 */ ]]>
        <![CDATA[
			UPDATE TWFAACAV007M 
			   SET 
		]]>	 	 

			<isNotEmpty property="PROF_MM">	
				<isEqual property="PROF_MM" compareValue="01">
				   MN_1_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="02">
				   MN_2_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="03">
				   MN_3_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="04">
				   MN_4_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="05">
				   MN_5_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="06">
				   MN_6_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="07">
				   MN_7_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="08">
				   MN_8_STA_CD = 'P'
				</isEqual>		
				<isEqual property="PROF_MM" compareValue="09">
				   MN_9_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="10">
				   MN_1_0_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="11">
				   MN_1_1_STA_CD = 'P'
				</isEqual>
				<isEqual property="PROF_MM" compareValue="12">
				   MN_1_2_STA_CD = 'P'
				</isEqual>		
				<isEqual property="PROF_MM" compareValue="13">
				   MN_1_3_STA_CD = 'P'
				</isEqual>											
			</isNotEmpty>			   


		
		<![CDATA[								
			 WHERE	1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YR = #PROF_YR#
		]]>	   

	</update> 
	
	<!-- MAIN화면 접수마스터 취소시 update -->
	<update id="FAACAV055EAcctMstrMainUpdate2" parameterClass="paramMap"	>
		<![CDATA[  /* faa/cav/055/FAACAV055EAcctMstrMainUpdate2 */ ]]>
        <![CDATA[
			UPDATE TWFAACAV007M 
			   SET 
		]]>	 	 

			<isNotEmpty property="PROF_MM">	
				<isEqual property="PROF_MM" compareValue="01">
				   MN_1_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="02">
				   MN_2_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="03">
				   MN_3_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="04">
				   MN_4_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="05">
				   MN_5_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="06">
				   MN_6_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="07">
				   MN_7_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="08">
				   MN_8_STA_CD = NULL
				</isEqual>		
				<isEqual property="PROF_MM" compareValue="09">
				   MN_9_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="10">
				   MN_1_0_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="11">
				   MN_1_1_STA_CD = NULL
				</isEqual>
				<isEqual property="PROF_MM" compareValue="12">
				   MN_1_2_STA_CD = NULL
				</isEqual>		
				<isEqual property="PROF_MM" compareValue="13">
				   MN_1_3_STA_CD = NULL
				</isEqual>											
			</isNotEmpty>		   

		
		<![CDATA[								
			 WHERE	1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YR = #PROF_YR#
		]]>	   

	</update>
<!--////////////////////////////////////////////////////////////////////////////////////////////-->		
	
	<!-- 서면계산서 등록시 update -->
	<update id="FAACAV055EPaperMstrUpdate1" parameterClass="paramMap"	>
		<![CDATA[  /* faa/cav/055/FAACAV055EPaperMstrUpdate1 */ ]]>
        <![CDATA[
			UPDATE TWFAACAV008M 
			   SET 
		]]>	 	 
		
		<isEqual property="M1_ACP" compareValue="Y">
		   MN_1_ACP_DT = CASE WHEN MN_1_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_1_ACP_DT END,
		</isEqual>
		<isEqual property="M1_ACP" compareValue="N">
		   MN_1_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M2_ACP" compareValue="Y">
		   MN_2_ACP_DT = CASE WHEN MN_2_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_2_ACP_DT END,
		</isEqual>
		<isEqual property="M2_ACP" compareValue="N">
		   MN_2_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M3_ACP" compareValue="Y">
		   MN_3_ACP_DT = CASE WHEN MN_3_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_3_ACP_DT END,
		</isEqual>
		<isEqual property="M3_ACP" compareValue="N">
		   MN_3_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M4_ACP" compareValue="Y">
		   MN_4_ACP_DT = CASE WHEN MN_4_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_4_ACP_DT END,
		</isEqual>
		<isEqual property="M4_ACP" compareValue="N">
		   MN_4_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M5_ACP" compareValue="Y">
		   MN_5_ACP_DT = CASE WHEN MN_5_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_5_ACP_DT END,
		</isEqual>
		<isEqual property="M5_ACP" compareValue="N">
		   MN_5_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M6_ACP" compareValue="Y">
		   MN_6_ACP_DT = CASE WHEN MN_6_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_6_ACP_DT END,
		</isEqual>
		<isEqual property="M6_ACP" compareValue="N">
		   MN_6_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M7_ACP" compareValue="Y">
		   MN_7_ACP_DT = CASE WHEN MN_7_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_7_ACP_DT END,
		</isEqual>
		<isEqual property="M7_ACP" compareValue="N">
		   MN_7_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M8_ACP" compareValue="Y">
		   MN_8_ACP_DT = CASE WHEN MN_8_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_8_ACP_DT END,
		</isEqual>
		<isEqual property="M8_ACP" compareValue="N">
		   MN_8_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M9_ACP" compareValue="Y">
		   MN_9_ACP_DT = CASE WHEN MN_9_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_9_ACP_DT END,
		</isEqual>
		<isEqual property="M9_ACP" compareValue="N">
		   MN_9_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M10_ACP" compareValue="Y">
		   MN_1_0_ACP_DT = CASE WHEN MN_1_0_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_1_0_ACP_DT END,
		</isEqual>
		<isEqual property="M10_ACP" compareValue="N">
		   MN_1_0_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M11_ACP" compareValue="Y">
		   MN_1_1_ACP_DT = CASE WHEN MN_1_1_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_1_1_ACP_DT END,
		</isEqual>
		<isEqual property="M11_ACP" compareValue="N">
		   MN_1_1_ACP_DT = NULL,
		</isEqual>
		
		<isEqual property="M12_ACP" compareValue="Y">
		   MN_1_2_ACP_DT = CASE WHEN MN_1_2_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_1_2_ACP_DT END,
		</isEqual>	
		<isEqual property="M12_ACP" compareValue="N">
		   MN_1_2_ACP_DT = NULL,
		</isEqual>
			
		<isEqual property="M13_ACP" compareValue="Y">
		   MN_1_3_ACP_DT = CASE WHEN MN_1_3_ACP_DT IS NULL THEN TO_CHAR(SYSDATE, 'YYYYMMDD') ELSE MN_1_3_ACP_DT END
		</isEqual>
		<isEqual property="M13_ACP" compareValue="N">
		   MN_1_3_ACP_DT = NULL
		</isEqual>

		<![CDATA[								
			 WHERE	1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YR = #PROF_YR#
		]]>	   

	</update> 

	
	
	<!-- 접수마스터 등록시 update -->
	<update id="FAACAV055EAcctMstrUpdate1" parameterClass="paramMap"	>
		<![CDATA[  /* faa/cav/055/FAACAV055EAcctMstrUpdate1 */ ]]>
        <![CDATA[
			UPDATE TWFAACAV007M 
			   SET 
		]]>	 	 
		
		<isEqual property="M1_ACP" compareValue="Y">
		   MN_1_STA_CD = 'P',
		</isEqual>
		<isEqual property="M1_ACP" compareValue="N">
		   MN_1_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M2_ACP" compareValue="Y">
		   MN_2_STA_CD = 'P',
		</isEqual>
		<isEqual property="M2_ACP" compareValue="N">
		   MN_2_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M3_ACP" compareValue="Y">
		   MN_3_STA_CD = 'P',
		</isEqual>
		<isEqual property="M3_ACP" compareValue="N">
		   MN_3_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M4_ACP" compareValue="Y">
		   MN_4_STA_CD = 'P',
		</isEqual>
		<isEqual property="M4_ACP" compareValue="N">
		   MN_4_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M5_ACP" compareValue="Y">
		   MN_5_STA_CD = 'P',
		</isEqual>
		<isEqual property="M5_ACP" compareValue="N">
		   MN_5_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M6_ACP" compareValue="Y">
		   MN_6_STA_CD = 'P',
		</isEqual>
		<isEqual property="M6_ACP" compareValue="N">
		   MN_6_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M7_ACP" compareValue="Y">
		   MN_7_STA_CD = 'P',
		</isEqual>
		<isEqual property="M7_ACP" compareValue="N">
		   MN_7_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M8_ACP" compareValue="Y">
		   MN_8_STA_CD = 'P',
		</isEqual>
		<isEqual property="M8_ACP" compareValue="N">
		   MN_8_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M9_ACP" compareValue="Y">
		   MN_9_STA_CD = 'P',
		</isEqual>
		<isEqual property="M9_ACP" compareValue="N">
		   MN_9_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M10_ACP" compareValue="Y">
		   MN_1_0_STA_CD = 'P',
		</isEqual>
		<isEqual property="M10_ACP" compareValue="N">
		   MN_1_0_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M11_ACP" compareValue="Y">
		   MN_1_1_STA_CD = 'P',
		</isEqual>
		<isEqual property="M11_ACP" compareValue="N">
		   MN_1_1_STA_CD = NULL,
		</isEqual>
		
		<isEqual property="M12_ACP" compareValue="Y">
		   MN_1_2_STA_CD = 'P',
		</isEqual>	
		<isEqual property="M12_ACP" compareValue="N">
		   MN_1_2_STA_CD = NULL,
		</isEqual>
			
		<isEqual property="M13_ACP" compareValue="Y">
		   MN_1_3_STA_CD = 'P'
		</isEqual>
		<isEqual property="M13_ACP" compareValue="N">
		   MN_1_3_STA_CD = NULL
		</isEqual>

		
		<![CDATA[								
			 WHERE	1=1
			  AND COPT_CD = #COPT_CD#
			  AND ACNT_CD = #ACNT_CD#
			  AND BLL_CD = #BLL_CD#
			  AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO# 
			  AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
			  AND PROF_YR = #PROF_YR#
		]]>	   

	</update> 

	
	<select id="FAACAV055R_01" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/055/FAACAV055R_01 */ ]]>
		<![CDATA[
			SELECT
				ROWNUM AS KEY, 
				CASE   WHEN #strMm# = '01' AND (NVL(TRIM(MSTR.MN_1_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '02' AND (NVL(TRIM(MSTR.MN_2_ACP_DT),'') <> '' OR TRIM(MSTR.MN_2_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '03' AND (NVL(TRIM(MSTR.MN_3_ACP_DT),'') <> '' OR TRIM(MSTR.MN_3_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '04' AND (NVL(TRIM(MSTR.MN_4_ACP_DT),'') <> '' OR TRIM(MSTR.MN_4_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '05' AND (NVL(TRIM(MSTR.MN_5_ACP_DT),'') <> '' OR TRIM(MSTR.MN_5_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '06' AND (NVL(TRIM(MSTR.MN_6_ACP_DT),'') <> '' OR TRIM(MSTR.MN_6_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '07' AND (NVL(TRIM(MSTR.MN_7_ACP_DT),'') <> '' OR TRIM(MSTR.MN_7_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '08' AND (NVL(TRIM(MSTR.MN_8_ACP_DT),'') <> '' OR TRIM(MSTR.MN_8_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '09' AND (NVL(TRIM(MSTR.MN_9_ACP_DT),'') <> '' OR TRIM(MSTR.MN_9_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '10' AND (NVL(TRIM(MSTR.MN_1_0_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_0_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '11' AND (NVL(TRIM(MSTR.MN_1_1_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_1_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '12' AND (NVL(TRIM(MSTR.MN_1_2_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_2_ACP_DT) <>  '*') THEN 'Y'
					   WHEN #strMm# = '13' AND (NVL(TRIM(MSTR.MN_1_3_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_3_ACP_DT) <>  '*') THEN 'Y'
				       ELSE 'N' 
				   END AS CHK,
				   MSTR.COPT_CD||'-'||MSTR.ACNT_CD||'-'||MSTR.BLL_CD||'-'||MSTR.PROF_DRTR_SRNO||'-'||MSTR.DL_XPN_RCDB_PBSVT_SRNO PROF_DRTR_SG,
			       MSTR.PROF_YR,
			       MN.ORG_NM,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_ACP_DT) END M1_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_2_ACP_DT),'') <> '' OR TRIM(MSTR.MN_2_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_2_ACP_DT) END M2_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_3_ACP_DT),'') <> '' OR TRIM(MSTR.MN_3_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_3_ACP_DT) END M3_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_4_ACP_DT),'') <> '' OR TRIM(MSTR.MN_4_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_4_ACP_DT) END M4_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_5_ACP_DT),'') <> '' OR TRIM(MSTR.MN_5_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_5_ACP_DT) END M5_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_6_ACP_DT),'') <> '' OR TRIM(MSTR.MN_6_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_6_ACP_DT) END M6_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_7_ACP_DT),'') <> '' OR TRIM(MSTR.MN_7_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_7_ACP_DT) END M7_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_8_ACP_DT),'') <> '' OR TRIM(MSTR.MN_8_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_8_ACP_DT) END M8_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_9_ACP_DT),'') <> '' OR TRIM(MSTR.MN_9_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_9_ACP_DT) END M9_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_0_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_0_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_0_ACP_DT) END M10_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_1_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_1_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_1_ACP_DT) END M11_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_2_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_2_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_2_ACP_DT) END M12_ACP,
                   CASE WHEN NVL(TRIM(MSTR.MN_1_3_ACP_DT),'') <> '' OR TRIM(MSTR.MN_1_3_ACP_DT) <>  '*' THEN 'P' ELSE TRIM(MSTR.MN_1_3_ACP_DT) END M13_ACP,
			      TRIM(MSTR.MN_1_ACP_DT) M1_ACP_DT, 
			      TRIM(MSTR.MN_2_ACP_DT) M2_ACP_DT, 
			      TRIM(MSTR.MN_3_ACP_DT) M3_ACP_DT, 
			      TRIM(MSTR.MN_4_ACP_DT) M4_ACP_DT,
			      TRIM(MSTR.MN_5_ACP_DT) M5_ACP_DT, 
			      TRIM(MSTR.MN_6_ACP_DT) M6_ACP_DT, 
			      TRIM(MSTR.MN_7_ACP_DT) M7_ACP_DT, 
			      TRIM(MSTR.MN_8_ACP_DT) M8_ACP_DT, 
			      TRIM(MSTR.MN_9_ACP_DT) M9_ACP_DT, 
			      TRIM(MSTR.MN_1_0_ACP_DT) M10_ACP_DT, 
			      TRIM(MSTR.MN_1_1_ACP_DT) M11_ACP_DT,
			      TRIM(MSTR.MN_1_2_ACP_DT) M12_ACP_DT, 
			      TRIM(MSTR.MN_1_3_ACP_DT) M13_ACP_DT,
			      F_AV_ACNT_CD_NM(MSTR.ACNT_CD) ACNT_NM,
			      F_AV_BLL_PERIOD_NM(MSTR.BLL_CD) RMK_NM,
			      MN.MDF_PEN_NM,
			      NVL(CASE WHEN (MSTR.BLL_CD='17' AND #strRegiYn# = 'Y' ) OR (MSTR.BLL_CD='18' AND #strRegiYn# = 'Y' ) THEN '관서운영경비출납계산서' ELSE  CASE WHEN (MSTR.BLL_CD='22' AND #strRegiYn#= 'Y') OR (MSTR.BLL_CD='23' AND #strRegiYn#= 'Y') OR (MSTR.BLL_CD='24' AND #strRegiYn#= 'Y') THEN '기금관서운영경비출납계산서' ELSE CASE WHEN (MSTR.BLL_CD='19' AND #strRegiYn# = 'Y') THEN '선사용자금관서운영경비출납계산서' ELSE  CD2.ACNT_CD_NM  END END END ,' ') AS CHCK_NM,
			      LTRIM(MN.TNB) AS TNB
			FROM TWFAACAV008M MSTR,TWFAACAV003M MN, TWFAACAV024C CD, TWFAACAV024C CD2
			WHERE 1 = 1
			  AND MSTR.COPT_CD = MN.COPT_CD
			  AND MSTR.ACNT_CD = MN.ACNT_CD 
			  AND MSTR.BLL_CD = MN.BLL_CD 
			  AND MSTR.PROF_DRTR_SRNO = MN.PROF_DRTR_SRNO 
			  AND MSTR.DL_XPN_RCDB_PBSVT_SRNO = MN.DL_XPN_RCDB_PBSVT_SRNO
			  AND MSTR.ACNT_CD = CD.ACNT_CD
			  AND CD.ACNT_DVSN_CD = '01'
			  AND MSTR.BLL_CD = CD2.ACNT_CD
			  AND CD2.ACNT_DVSN_CD = '03'			
		]]>	   
		<isNotEmpty property="strYr">	
			   AND MSTR.PROF_YR     = #strYr#
		</isNotEmpty>
		<isNotEmpty property="strCoptCd">	 	   
			   AND MSTR.COPT_CD     = #strCoptCd#
		</isNotEmpty>   	
		<isNotEmpty property="strAcntCd">	 	   
			   AND MSTR.ACNT_CD     = #strAcntCd#
		</isNotEmpty>
				
		<isEqual property="strBllCd" compareValue="17">
		   AND  MSTR.BLL_CD IN('17','18')
		</isEqual>
		
		<isEqual property="strBllCd" compareValue="18">
		   AND  MSTR.BLL_CD IN('17','18')
		</isEqual>

		<isEqual property="strBllCd" compareValue="22">
		   AND  MSTR.BLL_CD IN('22','23','24')
		</isEqual>

		<isEqual property="strBllCd" compareValue="23">
		   AND  MSTR.BLL_CD IN('22','23','24')
		</isEqual>

		<isEqual property="strBllCd" compareValue="24">
		   AND  MSTR.BLL_CD IN('22','23','24')
		</isEqual>

		<isEqual property="strBllCd" compareValue="42">
		   AND  MSTR.BLL_CD IN('42','43')
		</isEqual>
	
		<isEqual property="strBllCd" compareValue="43">
		   AND  MSTR.BLL_CD IN('42','43')
		</isEqual>
		
		<isNotEqual property="strBllCd" compareValue="17">
			<isNotEqual property="strBllCd" compareValue="18">
				<isNotEqual property="strBllCd" compareValue="22">
					<isNotEqual property="strBllCd" compareValue="23">
						<isNotEqual property="strBllCd" compareValue="24">
							<isNotEqual property="strBllCd" compareValue="42">
								<isNotEqual property="strBllCd" compareValue="43">
									AND  MSTR.BLL_CD =#strBllCd#
								</isNotEqual>
							</isNotEqual>
						</isNotEqual>
					</isNotEqual>
				</isNotEqual>
			</isNotEqual>
		</isNotEqual>
		

		<isNotEmpty property="strProfDrtrSrno">	 	   
			   AND MSTR.PROF_DRTR_SRNO     = #strProfDrtrSrno#
		</isNotEmpty> 
		<isNotEmpty property="strDlXpnRcdbPbsvtSrno">	 	   
			   AND MSTR.DL_XPN_RCDB_PBSVT_SRNO     = #strDlXpnRcdbPbsvtSrno#
		</isNotEmpty>		

					
		<isNotEmpty property="strRegiYn">
			<isEqual property="strRegiYn" compareValue="Y"> 
				<isEqual property="strMm" compareValue="00">
				   AND  MSTR.MN_1_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND  MSTR.MN_1_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  MSTR.MN_2_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  MSTR.MN_3_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  MSTR.MN_4_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  MSTR.MN_5_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  MSTR.MN_6_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  MSTR.MN_7_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  MSTR.MN_8_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  MSTR.MN_9_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  MSTR.MN_1_0_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  MSTR.MN_1_1_ACP_DT IS NOT NULL
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  MSTR.MN_1_2_ACP_DT IS NOT NULL
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  MSTR.MN_1_3_ACP_DT IS NOT NULL
				</isEqual>
			</isEqual>	
			
			<isEqual property="strRegiYn" compareValue="N">
				<isEqual property="strMm" compareValue="00">
				   AND  MSTR.MN_1_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="01">
				   AND  MSTR.MN_1_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="02">
				   AND  MSTR.MN_2_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="03">
				   AND  MSTR.MN_3_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="04">
				   AND  MSTR.MN_4_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="05">
				   AND  MSTR.MN_5_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="06">
				   AND  MSTR.MN_6_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="07">
				   AND  MSTR.MN_7_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="08">
				   AND  MSTR.MN_8_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="09">
				   AND  MSTR.MN_9_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="10">
				   AND  MSTR.MN_1_0_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="11">
				   AND  MSTR.MN_1_1_ACP_DT IS NULL
				</isEqual>
				<isEqual property="strMm" compareValue="12">
				   AND  MSTR.MN_1_2_ACP_DT IS NULL
				</isEqual>	
				<isEqual property="strMm" compareValue="13">
				   AND  MSTR.MN_1_3_ACP_DT IS NULL
				</isEqual>
			</isEqual>	
		</isNotEmpty> 		
			 ORDER BY PROF_DRTR_SG, PROF_YR, ORG_NM
	</select>
</sqlMap> 
