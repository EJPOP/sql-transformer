<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/ear/101">
 	<select id="CSPEAR101EMainSelect" parameterClass="paramMap"  resultClass="resultMap">
		<![CDATA[
			SELECT	 CASE WHEN REQ_DVSN_CD = '3' THEN '공익'
					      WHEN REQ_DVSN_CD = '2' THEN '국민'
					      ELSE '' END AS REQ_DVSN_CD
					,ACP_YR
					,ACP_NO
					,ACP_YR||'-'||F_CODE_NM('1000740',REQ_DVSN_CD)||'-'||ACP_NO AS ACP_NO2
					,TIT
					,REQR_RPST
					,CHR_DPT_NM
					,CHGR_NM
					,ACP_DY
			FROM	TBCSPEAR101M
			WHERE	1=1
			AND		REQ_DVSN_CD = #strREQ_DVSN_CD#
		]]>
		<dynamic>
			<isNotEmpty property="strACP_DHS">
				AND	ACP_DY &gt;= #strACP_DHS#
			</isNotEmpty>
			<isNotEmpty property="strACP_DHE">
				AND	ACP_DY &lt;= #strACP_DHE#
			</isNotEmpty>
			<isNotEmpty property="strTIT_NM">
				AND	TIT LIKE '%'||#strTIT_NM#||'%'
			</isNotEmpty>
			<isNotEmpty property="strACP_YR">
				AND	ACP_YR = #strACP_YR#
			</isNotEmpty>
			<isNotEmpty property="strCVPT_ACP_NO">
				AND	ACP_NO = #strCVPT_ACP_NO#
			</isNotEmpty>
		</dynamic>
		<![CDATA[
			ORDER BY ACP_YR DESC, ACP_NO DESC
		]]>
	</select>
	
		
	<!-- 공익감사청구 -->
	<insert id="CSPEAR101EXCELInsert1" parameterClass="paramMap">
        <![CDATA[
			INSERT INTO TBCSPEAR101M
			(
				 REQ_DVSN_CD
				,ACP_YR
				,ACP_NO
				,ACP_DY
				,TIT
				,CPLT_YN
				,HNDL_STA_NM
				,OGN_CAU_TXT
				,RLTN_ORG
				,ORG_DVSN
				,REQR_RPST
				,REQR_DVSN
				,CHR_DPT_NM
				,CHGR_NM
				,PREI_APV_DY
				,MTRL_CLC_ETC_PCT
				,TRNF_DY
				,AUD_MNDY
				,MTRL_CLC_STR_DY
				,MTRL_CLC_END_DY
				,CSL_CMT_DGE
				,CSL_CMT_OEN_DY
				,CSL_RSLT_TXT
				,AUD_EXEC_DCS_DY
				,EXAM_RSLT_TXT
				,EXAM_RSLT_RPL_DT
				,FLD_AUD_ETC_PCT_NM
				,FLD_AUD_STR_DY
				,FLD_AUD_END_DY
				,RTN_DY
				,RTN_BRUCHF_RPT_DY
				,RTN_DHD_APV_DY
				,RTN_PSD_APV_DY
				,RTN_RPT_DY
				,CHF_CMTR_NM
				,DVCHF_TRTM_APV_DY
				,BRUCHF_TRTM_APV_DY
				,QLT_MNG_CHGR_TRTM_APV_DY
				,QLT_MNG_SSEC_TRTM_APV_DY
				,HQ_SEC_TRTM_APV_DY
				,PSD_TRTM_APV_DY
				,CHF_CMTR_TRTM_APV_DY
				,SBCN_DY
				,DSP_KND_NOC
				,DSP_RQ_ENF_DY
				,AUD_RSLT_RPL_DY
				,FNL_CPLT_DY
				,CPLT_YR
				,FNL_RSLT
				,DMS_RSN
				,UNQ
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
			)
			VALUES
			(
				 #REQ_DVSN_CD#
				,#ACP_YR#
				,SUBSTR(#ACP_NO#, INSTR(#ACP_NO#, '-')+1, LENGTH(#ACP_NO#))
				,REPLACE(#ACP_DY#, '-')
				,#TIT#
				,#CPLT_YN#
				,#HNDL_STA_NM#
				,#OGN_CAU_TXT#
				,#RLTN_ORG#
				,#ORG_DVSN#
				,#REQR_RPST#
				,#REQR_DVSN#
				,#CHR_DPT_NM#
				,#CHGR_NM#
				,#PREI_APV_DY#
				,#MTRL_CLC_ETC_PCT#
				,#TRNF_DY#
				,#AUD_MNDY#
				,#MTRL_CLC_STR_DY#
				,#MTRL_CLC_END_DY#
				,#CSL_CMT_DGE#
				,#CSL_CMT_OEN_DY#
				,#CSL_RSLT_TXT#
				,#AUD_EXEC_DCS_DY#
				,#EXAM_RSLT_TXT#
				,#EXAM_RSLT_RPL_DT#
				,#FLD_AUD_ETC_PCT_NM#
				,#FLD_AUD_STR_DY#
				,#FLD_AUD_END_DY#
				,#RTN_DY#
				,#RTN_BRUCHF_RPT_DY#
				,#RTN_DHD_APV_DY#
				,#RTN_PSD_APV_DY#
				,#RTN_RPT_DY#
				,#CHF_CMTR_NM#
				,#DVCHF_TRTM_APV_DY#
				,#BRUCHF_TRTM_APV_DY#
				,#QLT_MNG_CHGR_TRTM_APV_DY#
				,#QLT_MNG_SSEC_TRTM_APV_DY#
				,#HQ_SEC_TRTM_APV_DY#
				,#PSD_TRTM_APV_DY#
				,#CHF_CMTR_TRTM_APV_DY#
				,#SBCN_DY#
				,#DSP_KND_NOC#
				,#DSP_RQ_ENF_DY#
				,#AUD_RSLT_RPL_DY#
				,#FNL_CPLT_DY#
				,#CPLT_YR#
				,#FNL_RSLT#
				,#DMS_RSN#
				,#UNQ#
				,#FRT_USR_ID#
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
				,SYSDATE
				,SYSDATE
			)
        ]]>
	</insert>
	
	<!-- 국민감사청구 -->
	<insert id="CSPEAR101EXCELInsert2" parameterClass="paramMap">
        <![CDATA[
			INSERT INTO TBCSPEAR101M
			(
				 REQ_DVSN_CD
				,ACP_YR
				,ACP_NO
				,ACP_DY
				,TIT
				,CPLT_YN
				,HNDL_STA_NM
				,OGN_CAU_TXT
				,RLTN_ORG
				,ORG_DVSN
				,REQR_RPST
				,CHR_DPT_NM
				,CHGR_NM
				,MTRL_CLC_ETC_PCT
				,AUD_MNDY
				,MTRL_CLC_STR_DY
				,MTRL_CLC_END_DY
				,JDG_CMT_DGE
				,JDG_CMT_OEN_DY
				,PPL_CMT_DCS_TXT
				,EXAM_RSLT_RPL_DT
				,FLD_AUD_ETC_PCT_NM
				,FLD_AUD_STR_DY
				,FLD_AUD_END_DY
				,RTN_DY
				,RTN_BRUCHF_RPT_DY
				,RTN_DHD_APV_DY
				,RTN_PSD_APV_DY
				,RTN_RPT_DY
				,CHF_CMTR_NM
				,DVCHF_TRTM_APV_DY
				,BRUCHF_TRTM_APV_DY
				,RVW_RM_SEC_TRTM_APV_DY
				,HQ_SEC_TRTM_APV_DY
				,PSD_TRTM_APV_DY
				,CHF_CMTR_TRTM_APV_DY
				,SBCN_DY
				,DSP_KND_NOC
				,DSP_RQ_ENF_DY
				,AUD_RSLT_RPL_DY
				,FNL_CPLT_DY
				,FNL_RSLT
				,CPLT_YR
				,STTC_TXT
				,UNQ
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
				
			)
			VALUES
			(
				 #REQ_DVSN_CD#
				,#ACP_YR#
				,SUBSTR(#ACP_NO#, INSTR(#ACP_NO#, '-')+1, LENGTH(#ACP_NO#))
				,REPLACE(#ACP_DY#, '-')
				,#TIT#
				,#CPLT_YN#
				,#HNDL_STA_NM#
				,#OGN_CAU_TXT#
				,#RLTN_ORG#
				,#ORG_DVSN#
				,#REQR_RPST#
				,#CHR_DPT_NM#
				,#CHGR_NM#
				,#MTRL_CLC_ETC_PCT#
				,#AUD_MNDY#
				,#MTRL_CLC_STR_DY#
				,#MTRL_CLC_END_DY#
				,#JDG_CMT_DGE#
				,#JDG_CMT_OEN_DY#
				,#PPL_CMT_DCS_TXT#
				,#EXAM_RSLT_RPL_DT#
				,#FLD_AUD_ETC_PCT_NM#
				,#FLD_AUD_STR_DY#
				,#FLD_AUD_END_DY#
				,#RTN_DY#
				,#RTN_BRUCHF_RPT_DY#
				,#RTN_DHD_APV_DY#
				,#RTN_PSD_APV_DY#
				,#RTN_RPT_DY#
				,#CHF_CMTR_NM#
				,#DVCHF_TRTM_APV_DY#
				,#BRUCHF_TRTM_APV_DY#
				,#RVW_RM_SEC_TRTM_APV_DY#
				,#HQ_SEC_TRTM_APV_DY#
				,#PSD_TRTM_APV_DY#
				,#CHF_CMTR_TRTM_APV_DY#
				,#SBCN_DY#
				,#DSP_KND_NOC#
				,#DSP_RQ_ENF_DY#
				,#AUD_RSLT_RPL_DY#
				,#FNL_CPLT_DY#
				,#FNL_RSLT#
				,#CPLT_YR#
				,#STTC_TXT#
				,#UNQ#
				,#FRT_USR_ID#
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
				,SYSDATE
				,SYSDATE
			)        	
        ]]>
	</insert>
	
	<!-- 공익감사청구 -->	
	<select id="CSPEAR101ESelectExcelExport1" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT
					 ACP_YR
					,ACP_YR || '-'||F_CODE_NM('1000740',A.REQ_DVSN_CD)||'-' ||ACP_NO AS ACP_NO
					,TO_CHAR(TO_DATE(ACP_DY), 'YYYYMMDD') AS ACP_DY
					,TIT
					,CPLT_YN
					,HNDL_STA_NM
					,OGN_CAU_TXT
					,RLTN_ORG
					,ORG_DVSN
					,REQR_RPST
					,REQR_DVSN
					,CHR_DPT_NM
					,CHGR_NM
					,PREI_APV_DY
					,MTRL_CLC_ETC_PCT
					,TRNF_DY
					,AUD_MNDY
					,MTRL_CLC_STR_DY
					,MTRL_CLC_END_DY
					,CSL_CMT_DGE
					,CSL_CMT_OEN_DY
					,CSL_RSLT_TXT
					,AUD_EXEC_DCS_DY
					,EXAM_RSLT_TXT
					,EXAM_RSLT_RPL_DT
					,FLD_AUD_ETC_PCT_NM
					,FLD_AUD_STR_DY
					,FLD_AUD_END_DY
					,RTN_DY
					,RTN_BRUCHF_RPT_DY
					,RTN_DHD_APV_DY
					,RTN_PSD_APV_DY
					,RTN_RPT_DY
					,CHF_CMTR_NM
					,DVCHF_TRTM_APV_DY
					,BRUCHF_TRTM_APV_DY
					,QLT_MNG_CHGR_TRTM_APV_DY
					,QLT_MNG_SSEC_TRTM_APV_DY
					,HQ_SEC_TRTM_APV_DY
					,PSD_TRTM_APV_DY
					,CHF_CMTR_TRTM_APV_DY
					,SBCN_DY
					,DSP_KND_NOC
					,DSP_RQ_ENF_DY
					,AUD_RSLT_RPL_DY
					,FNL_CPLT_DY
					,CPLT_YR
					,FNL_RSLT
					,DMS_RSN
					,UNQ
					,ACP_DCS_ELP_DCN
					,DCS_NTF_ELP_DCN
					,ACP_NTF_ELP_DCN
			FROM	TBCSPEAR101M
			WHERE	1=1
			AND		REQ_DVSN_CD = #strREQ_DVSN_CD#
		]]>
		<dynamic>
			<isNotEmpty property="strACP_DHS">
				AND	ACP_DY &gt;= #strACP_DHS#
			</isNotEmpty>
			<isNotEmpty property="strACP_DHE">
				AND	ACP_DY &lt;= #strACP_DHE#
			</isNotEmpty>
			<isNotEmpty property="strTIT_NM">
				AND	TIT LIKE '%'||#strTIT_NM#||'%'
			</isNotEmpty>
			<isNotEmpty property="strACP_YR">
				AND	ACP_YR = #strACP_YR#
			</isNotEmpty>
			<isNotEmpty property="strCVPT_ACP_NO">
				AND	ACP_NO = #strCVPT_ACP_NO#
			</isNotEmpty>
		</dynamic>
		<![CDATA[
			ORDER BY ACP_YR DESC, ACP_NO DESC
		]]>
	</select>
	
	<!-- 국민감사청구 -->
	<select id="CSPEAR101ESelectExcelExport2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT
					 ACP_YR
					,ACP_YR || '-'||F_CODE_NM('1000740',A.REQ_DVSN_CD)||'-' ||ACP_NO AS ACP_NO
					,TO_CHAR(TO_DATE(ACP_DY), 'YYYYMMDD') AS ACP_DY
					,TIT
					,CPLT_YN
					,HNDL_STA_NM
					,OGN_CAU_TXT
					,RLTN_ORG
					,ORG_DVSN
					,REQR_RPST
					,CHR_DPT_NM
					,CHGR_NM
					,MTRL_CLC_ETC_PCT
					,AUD_MNDY
					,MTRL_CLC_STR_DY
					,MTRL_CLC_END_DY
					,JDG_CMT_DGE
					,JDG_CMT_OEN_DY
					,PPL_CMT_DCS_TXT
					,EXAM_RSLT_RPL_DT
					,FLD_AUD_ETC_PCT_NM
					,FLD_AUD_STR_DY
					,FLD_AUD_END_DY
					,RTN_DY
					,RTN_BRUCHF_RPT_DY
					,RTN_DHD_APV_DY
					,RTN_PSD_APV_DY
					,RTN_RPT_DY
					,CHF_CMTR_NM
					,DVCHF_TRTM_APV_DY
					,BRUCHF_TRTM_APV_DY
					,RVW_RM_SEC_TRTM_APV_DY
					,HQ_SEC_TRTM_APV_DY
					,PSD_TRTM_APV_DY
					,CHF_CMTR_TRTM_APV_DY
					,SBCN_DY
					,DSP_KND_NOC
					,DSP_RQ_ENF_DY
					,AUD_RSLT_RPL_DY
					,FNL_CPLT_DY
					,FNL_RSLT
					,CPLT_YR
					,ACP_DCS_ELP_DCN
					,DCS_RPL_ELP_DCN
					,ACP_RPL_ELP_DCN
					,STTC_TXT
					,UNQ
			FROM	TBCSPEAR101M
			WHERE	1=1
			AND		REQ_DVSN_CD = #strREQ_DVSN_CD#
		]]>
		<dynamic>
			<isNotEmpty property="strACP_DHS">
				AND	ACP_DY &gt;= #strACP_DHS#
			</isNotEmpty>
			<isNotEmpty property="strACP_DHE">
				AND	ACP_DY &lt;= #strACP_DHE#
			</isNotEmpty>
			<isNotEmpty property="strTIT_NM">
				AND	TIT LIKE '%'||#strTIT_NM#||'%'
			</isNotEmpty>
			<isNotEmpty property="strACP_YR">
				AND	ACP_YR = #strACP_YR#
			</isNotEmpty>
			<isNotEmpty property="strCVPT_ACP_NO">
				AND	ACP_NO = #strCVPT_ACP_NO#
			</isNotEmpty>
		</dynamic>
		<![CDATA[
			ORDER BY ACP_YR DESC, ACP_NO DESC
		]]>
	</select>
	
</sqlMap> 
