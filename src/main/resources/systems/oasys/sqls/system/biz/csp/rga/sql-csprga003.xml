<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/rga/003">

	<select id="CSPRGA003PMainSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
                 SELECT T1.SRNO                               AS SRNO         /* 일련번호 */
                       ,T1.CHR_TSK_CD                         AS CHR_TSK_CD   /* 담당업무코드 */
                       ,F_CODE_NM('1000904', T1.CHR_TSK_CD)   AS CHR_TSK_NM   /* 담당업무코드명 */
                       ,T1.CNB                                AS CNB          /* 등록자 전산번호 */
                       ,T2.USR_NAM                            AS USR_NAM      /* 등록자 성명 */
                       ,F_DPT_INFO(T2.DPT_CD, '1')            AS DPT_NM       /* 등록자 부서명 */
                       ,TO_CHAR(T1.FRT_REGI_DH,'YYYY-MM-DD')  AS REGI_DT      /* 등록일 */
                   FROM TBCSPRGA003M T1
                       ,TBDCMACM001M T2
                  WHERE T1.CNB = T2.CNB
                  ORDER BY T1.CHR_TSK_CD
                          ,T1.CNB
		]]>
	</select>
	
	<insert id="CSPRGA003PMainInsert" parameterClass="paramMap">
				INSERT INTO TBCSPRGA003M
				 (
					   SRNO             /* 일련번호 */
				     , CHR_TSK_CD       /* 담당업무코드 */
				     , CNB              /* 전산번호 */
				     , FRT_USR_ID
				     , FNL_USR_ID
				     , FNL_DEAL_DPT_CD
				     , FNL_MNU_ID
				     , FRT_REGI_DH
				     , FNL_MDF_DH
				 ) VALUES
				 (
				     (SELECT NVL(MAX(SRNO),0) + 1
				        FROM TBCSPRGA003M)
				     , #CHR_TSK_CD#
				     , #CNB#				     		    
				     , #FRT_USR_ID#
				     , #FNL_USR_ID#
				     , #FNL_DEAL_DPT_CD#
				     , #FNL_MNU_ID#
				     , SYSDATE
				     , SYSDATE
				 ) 
	</insert>	
	
	<update id="CSPRGA003PMainDelete" parameterClass="paramMap">
			DELETE 
			  FROM TBCSPRGA003M
			 WHERE SRNO = #SRNO# 
	</update>		
	
</sqlMap> 
