<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/mwf/001">

	<select id="CSPMWF005QMainSelect1" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
		
		SELECT RSTRNT_CD, ORD, MEAL_DVSN_CD, NM,  NM_1,NM_2,NM_3,NM_4,NM_5 FROM (
		 SELECT *
		   FROM (WITH DATA AS ( 
		   						SELECT DDT, ROWNUM+1 AS D, RSTRNT_CD, MEAL_DVSN_CD, RICE_NM, SOUP_NM,D1.SD_NM_1,
		                               D1.SD_NM_2,
		                               D1.SD_NM_3,
		                               D1.SD_NM_4,
		                               D1.SD_NM_5,
		                               D1.SD_NM_6,
		                               D1.SD_NM_7,
		                               D1.SNC_NM,
		                               D1.COO_INF_NM_1,
		                               D1.COO_INF_NM_2,
		                               D1.COO_INF_NM_3,
		                               D1.COO_INF_NM_4,
		                               D1.COO_INF_NM_5
								 FROM (
									  SELECT   B.DDT, 
									           #RSTRNT_CD# AS RSTRNT_CD, 
				                               #MEAL_DVSN_CD# AS MEAL_DVSN_CD,
				                               ROWNUM+1 AS D,
				                               D1.RICE_NM,
				                               D1.SOUP_NM,
				                               D1.SD_NM_1,
				                               D1.SD_NM_2,
				                               D1.SD_NM_3,
				                               D1.SD_NM_4,
				                               D1.SD_NM_5,
				                               D1.SD_NM_6,
				                               D1.SD_NM_7,
				                               D1.SNC_NM,
				                               D1.COO_INF_NM_1,
				                               D1.COO_INF_NM_2,
				                               D1.COO_INF_NM_3,
				                               D1.COO_INF_NM_4,
				                               D1.COO_INF_NM_5
				                          FROM TBCSPMWF002M D1,

									  ( SELECT DDT, DY
                                          FROM ( SELECT DDT, TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
                                                   FROM ( SELECT TO_CHAR( (TO_DATE(#toYmd#, 'YYYYMMDD') - (#currPage# - 1) *7) - LEVEL+1, 'YYYYMMDD') AS DDT
															FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') - (#currPage# - 1) *7 +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B										 
		                         WHERE 1=1
   		                           AND D1.MNU_DT(+) = B.DDT
								   AND D1.RSTRNT_CD(+) = #RSTRNT_CD#							    
		                           AND D1.MEAL_DVSN_CD(+) = #MEAL_DVSN_CD# ORDER BY DDT DESC) D1)
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('1') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             DECODE(D2.RSTRNT_CD,'3','샐러드바','밥') AS NM,
		                             MAX(DECODE(D2.D, 2, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_1,
									 MAX(DECODE(D2.D, 3, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_2,
                             	 	 MAX(DECODE(D2.D, 4, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_3,
                             		 MAX(DECODE(D2.D, 5, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_4,
                             		 MAX(DECODE(D2.D, 6, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('2') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             DECODE(D2.RSTRNT_CD,'3','샐러드바','국') AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SOUP_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SOUP_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SOUP_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SOUP_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SOUP_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('3') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             DECODE(D2.RSTRNT_CD,'3','샐러드바','반찬') AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       WHERE D2.SD_NM_1 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD,
		                             D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('4') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             DECODE(D2.RSTRNT_CD,'3','샐러드바','반찬') AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       WHERE D2.SD_NM_2 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD,
		                             D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('5') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             DECODE(D2.RSTRNT_CD,'3','샐러드바','반찬') AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       WHERE D2.SD_NM_3 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD,
		                             D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('6') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             DECODE(D2.RSTRNT_CD,'3','샐러드바','반찬') AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       WHERE D2.SD_NM_4 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD,
		                             D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('7') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             DECODE(D2.RSTRNT_CD,'3','샐러드바','반찬') AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       WHERE D2.SD_NM_5 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('8') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             DECODE(D2.RSTRNT_CD,'3','샐러드바','반찬') AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_6, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_6, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_6, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_6, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_6, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       WHERE D2.SD_NM_6 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD,D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('9') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             DECODE(D2.RSTRNT_CD,'3','샐러드바','반찬') AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_7, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_7, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_7, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_7, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_7, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       WHERE D2.SD_NM_7 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		]]>
			<dynamic>
				<isEqual property="RSTRNT_CD" compareValue="1" >
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('10') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '간식(16:00~16:30)' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
				</isEqual>
				<isEqual property="RSTRNT_CD" compareValue="3" >
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('10') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '샐러드바' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
				</isEqual>
			</dynamic>
		<![CDATA[	
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('11') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_1 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('12') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_2 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('13') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_3 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('14') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_4 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('15') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_5 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                             )
		  ORDER BY ORD) A
		  WHERE A.NM IS NOT NULL
		]]>
	</select>
	
	
	<!-- 석식조회 시작 -->
	<select id="CSPMWF005QMainSelect2" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
		
		SELECT RSTRNT_CD, ORD, MEAL_DVSN_CD, NM,  NM_1,NM_2,NM_3,NM_4,NM_5 FROM (
		 SELECT *
		   FROM (WITH DATA AS ( 
		   						SELECT DDT, ROWNUM+1 AS D, RSTRNT_CD, MEAL_DVSN_CD, D1.SD_NM_1
		   						,D1.COO_INF_NM_1,D1.COO_INF_NM_2,D1.COO_INF_NM_3,D1.COO_INF_NM_4,D1.COO_INF_NM_5
								 FROM (
									  SELECT   B.DDT, 
									           #RSTRNT_CD# AS RSTRNT_CD, 
				                               #MEAL_DVSN_CD# AS MEAL_DVSN_CD,
				                               ROWNUM+1 AS D,
				                               D1.SD_NM_1,D1.COO_INF_NM_1,D1.COO_INF_NM_2,D1.COO_INF_NM_3,D1.COO_INF_NM_4,D1.COO_INF_NM_5
				                          FROM TBCSPMWF002M D1,

									  ( SELECT DDT, DY
                                          FROM ( SELECT DDT, TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
                                                   FROM ( SELECT TO_CHAR( (TO_DATE(#toYmd#, 'YYYYMMDD') - (#currPage# - 1) *7) - LEVEL+1, 'YYYYMMDD') AS DDT
															FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') - (#currPage# - 1) *7 +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B										 
		                         WHERE 1=1
   		                           AND D1.MNU_DT(+) = B.DDT
								   AND D1.RSTRNT_CD(+) = #RSTRNT_CD#							    
		                           AND D1.MEAL_DVSN_CD(+) = #MEAL_DVSN_CD# ORDER BY DDT DESC) D1)

		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('3') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '주메뉴' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       WHERE D2.SD_NM_1 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD,
		                             D2.MEAL_DVSN_CD
		                       UNION ALL      
		                         SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('4') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_1 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('5') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_2 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('6') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_3 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('7') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_4 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('8') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.COO_INF_NM_5 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD      
		                             )
		  ORDER BY ORD) A
		  WHERE A.NM IS NOT NULL
		]]>
	</select>
	<!-- 석식조회 끝   -->
	
	<select id="CSPMWF005QCountSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
        SELECT COUNT(*) AS TOT_CNT FROM (
        			SELECT DDT, TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
                      FROM ( 
					  		SELECT TO_CHAR (TO_DATE(#toYmd#, 'YYYYMMDD') - LEVEL + 1, 'YYYYMMDD') AS DDT 
					  		  FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#,'YYYYMMDD') - TO_DATE(#fromYmd#,'YYYYMMDD') +1) 
                             WHERE TO_CHAR(TO_DATE(DDT,'YYYYMMDD'),'D') IN    ('2', '3', '4','5', '6') )
		]]>
	</select>
	
	<select id="CSPMWF005QSelectHeaderList" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
 SELECT TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'YYYY-MM-DD(DY)') AS DATENAME
   FROM ( SELECT DDT,
                 TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
            FROM ( SELECT TO_CHAR( (TO_DATE(#toYmd#, 'YYYYMMDD') - (#currPage# - 1) *7) - LEVEL + 1,'YYYYMMDD') AS DDT
                     FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD')  - (#currPage# - 1) *7+1) )
  WHERE DY IN('2', '3', '4', '5', '6')
  ORDER BY DATENAME DESC
		]]>
	</select>		
	
	
	
	<select id="CSPMWF005QSelectCooList" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
			SELECT * FROM TBCSPMWF006M ORDER BY coo_sno 
		]]>
	</select>	
	
	
	<!-- 원산지 등록수정삭제 시작 -->
	<update id="CSPMWF010PUpdate" parameterClass="paramMap">
	<![CDATA[
		UPDATE  TBCSPMWF006M
	       SET  FNL_MDF_DH = SYSDATE  
	]]>			
			<isNotNull prepend="," property="FOOD_NM">
				FOOD_NM = #FOOD_NM#
			</isNotNull>
			<isNotNull prepend="," property="COO_INF_TXT">
				COO_INF_TXT = #COO_INF_TXT#,
			</isNotNull>
	<![CDATA[
				FNL_USR_ID = #FNL_USR_ID#,
				FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#,
				FNL_MNU_ID = #FNL_MNU_ID#
		WHERE  	COO_SNO = #COO_SNO#
	]]>	
	</update>

	<delete id="CSPMWF010PEDelete" parameterClass="paramMap">
			DELETE FROM TBCSPMWF006M WHERE COO_SNO = #COO_SNO#
	</delete>
	
	<insert id="CSPMWF010PInsert" parameterClass="paramMap">
        <![CDATA[       
			INSERT INTO TBCSPMWF006M
			(
				COO_SNO,
				FOOD_NM,
				COO_INF_TXT,
				FRT_USR_ID,
				FNL_USR_ID,
				FNL_DEAL_DPT_CD,
				FNL_MNU_ID,
				FRT_REGI_DH,
				FNL_MDF_DH
			)
			VALUES
			(
				(SELECT NVL(MAX(COO_SNO) + 1, 1) FROM TBCSPMWF006M),
				#FOOD_NM#,
				#COO_INF_TXT#,
				#FRT_USR_ID#,
				#FNL_USR_ID#,
				#FNL_DEAL_DPT_CD#,
				#FNL_MNU_ID#,
				sysdate,
				sysdate
			)
        ]]>
	</insert>
	
	<!-- 원산지 등록수정삭제 종료 -->
	
	<!-- 메뉴등록팝업 시작 -->
	<select id="CSPMWF009PSelectFoodMnuList" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[
SELECT RSTRNT_CD, ORD, MEAL_DVSN_CD, NM,  NM_1,NM_2,NM_3,NM_4,NM_5 FROM (
		 SELECT *
		   FROM (WITH DATA AS ( 
		   						SELECT DDT, ROWNUM+1 AS D, RSTRNT_CD, MEAL_DVSN_CD, RICE_NM, SOUP_NM,D1.SD_NM_1,
		                               D1.SD_NM_2,
		                               D1.SD_NM_3,
		                               D1.SD_NM_4,
		                               D1.SD_NM_5,
		                               D1.SD_NM_6,
		                               D1.SD_NM_7,
		                               D1.SNC_NM,
		                               D1.COO_INF_NM_1,
  		                               D1.COO_INF_NM_2,
  		                               D1.COO_INF_NM_3,
  		                               D1.COO_INF_NM_4,
  		                               D1.COO_INF_NM_5
								 FROM (
									  SELECT   B.DDT, 
									           '1' AS RSTRNT_CD, 
				                               '2' MEAL_DVSN_CD,
				                               ROWNUM+1 AS D,
				                               D1.RICE_NM,
				                               D1.SOUP_NM,
				                               D1.SD_NM_1,
				                               D1.SD_NM_2,
				                               D1.SD_NM_3,
				                               D1.SD_NM_4,
				                               D1.SD_NM_5,
				                               D1.SD_NM_6,
				                               D1.SD_NM_7,
				                               D1.SNC_NM,
				                               D1.COO_INF_NM_1,
		  		                               D1.COO_INF_NM_2,
		  		                               D1.COO_INF_NM_3,
		  		                               D1.COO_INF_NM_4,
		  		                               D1.COO_INF_NM_5
				                          FROM TBCSPMWF002M D1,

									  ( SELECT DDT, DY
                                          FROM ( SELECT DDT, TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
                                                   FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD')  - LEVEL+1, 'YYYYMMDD') AS DDT
															FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B										 
		                         WHERE 1=1
   		                           AND D1.MNU_DT(+) = B.DDT
								   AND D1.RSTRNT_CD(+) = '1'							    
		                           AND D1.MEAL_DVSN_CD(+) = '2' ORDER BY DDT) D1) 
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('1') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '밥' AS NM,
		                             MAX(DECODE(D2.D, 2, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_1,
									 MAX(DECODE(D2.D, 3, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_2,
                             	 	 MAX(DECODE(D2.D, 4, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_3,
                             		 MAX(DECODE(D2.D, 5, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_4,
                             		 MAX(DECODE(D2.D, 6, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('2') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '국' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SOUP_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SOUP_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SOUP_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SOUP_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SOUP_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('3') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('4') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬2' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('5') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬3' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('6') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬4' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('7') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬5' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('8') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬6' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_6, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_6, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_6, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_6, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_6, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD,D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('9') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬7' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_7, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_7, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_7, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_7, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_7, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('10') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '간식(16:00~16:30)' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('11') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('12') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지2' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('13') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지3' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('14') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지4' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('15') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지5' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                             )
		  ORDER BY ORD) A
		  WHERE A.NM IS NOT NULL
UNION ALL
SELECT RSTRNT_CD, ORD, MEAL_DVSN_CD, NM,  NM_1,NM_2,NM_3,NM_4,NM_5 FROM (
		 SELECT *
		   FROM (WITH DATA AS ( 
		   						SELECT DDT, ROWNUM+1 AS D, RSTRNT_CD, MEAL_DVSN_CD, RICE_NM, SOUP_NM,D1.SD_NM_1,
		                               D1.SD_NM_2,
		                               D1.SD_NM_3,
		                               D1.SD_NM_4,
		                               D1.SD_NM_5,
		                               D1.SD_NM_6,
		                               D1.SD_NM_7,
		                               D1.SNC_NM,
		                               D1.COO_INF_NM_1,
  		                               D1.COO_INF_NM_2,
  		                               D1.COO_INF_NM_3,
  		                               D1.COO_INF_NM_4,
  		                               D1.COO_INF_NM_5
								 FROM (
									  SELECT   B.DDT, 
									           '2' AS RSTRNT_CD, 
				                               '2' MEAL_DVSN_CD,
				                               ROWNUM+1 AS D,
				                               D1.RICE_NM,
				                               D1.SOUP_NM,
				                               D1.SD_NM_1,
				                               D1.SD_NM_2,
				                               D1.SD_NM_3,
				                               D1.SD_NM_4,
				                               D1.SD_NM_5,
				                               D1.SD_NM_6,
				                               D1.SD_NM_7,
				                               D1.SNC_NM,
				                               D1.COO_INF_NM_1,
		  		                               D1.COO_INF_NM_2,
		  		                               D1.COO_INF_NM_3,
		  		                               D1.COO_INF_NM_4,
		  		                               D1.COO_INF_NM_5
				                          FROM TBCSPMWF002M D1,

									  ( SELECT DDT, DY
                                          FROM ( SELECT DDT, TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
                                                   FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD')  - LEVEL+1, 'YYYYMMDD') AS DDT
															FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B										 
		                         WHERE 1=1
   		                           AND D1.MNU_DT(+) = B.DDT
								   AND D1.RSTRNT_CD(+) = '2'							    
		                           AND D1.MEAL_DVSN_CD(+) = '2' ORDER BY DDT) D1) 
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('1') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '밥' AS NM,
		                             MAX(DECODE(D2.D, 2, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_1,
									 MAX(DECODE(D2.D, 3, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_2,
                             	 	 MAX(DECODE(D2.D, 4, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_3,
                             		 MAX(DECODE(D2.D, 5, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_4,
                             		 MAX(DECODE(D2.D, 6, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('2') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '국' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SOUP_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SOUP_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SOUP_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SOUP_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SOUP_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('3') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('4') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬2' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('5') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬3' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('6') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬4' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('7') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬5' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('8') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬6' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_6, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_6, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_6, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_6, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_6, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD,D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('9') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬7' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_7, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_7, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_7, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_7, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_7, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('11') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('12') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지2' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('13') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지3' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('14') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지4' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('15') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지5' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                             )
		  ORDER BY ORD) A
		  WHERE A.NM IS NOT NULL		  
UNION ALL
SELECT RSTRNT_CD, ORD, MEAL_DVSN_CD, NM,  NM_1,NM_2,NM_3,NM_4,NM_5 FROM (
		 SELECT *
		   FROM (WITH DATA AS ( 
		   						SELECT DDT, ROWNUM+1 AS D, RSTRNT_CD, MEAL_DVSN_CD, RICE_NM, SOUP_NM,D1.SD_NM_1,
		                               D1.SD_NM_2,
		                               D1.SD_NM_3,
		                               D1.SD_NM_4,
		                               D1.SD_NM_5,
		                               D1.SD_NM_6,
		                               D1.SD_NM_7,
		                               D1.SNC_NM,
		                               D1.COO_INF_NM_1,
  		                               D1.COO_INF_NM_2,
  		                               D1.COO_INF_NM_3,
  		                               D1.COO_INF_NM_4,
  		                               D1.COO_INF_NM_5
								 FROM (
									  SELECT   B.DDT, 
									           '3' AS RSTRNT_CD, 
				                               '2' MEAL_DVSN_CD,
				                               ROWNUM+1 AS D,
				                               D1.RICE_NM,
				                               D1.SOUP_NM,
				                               D1.SD_NM_1,
				                               D1.SD_NM_2,
				                               D1.SD_NM_3,
				                               D1.SD_NM_4,
				                               D1.SD_NM_5,
				                               D1.SD_NM_6,
				                               D1.SD_NM_7,
				                               D1.SNC_NM,
				                               D1.COO_INF_NM_1,
		  		                               D1.COO_INF_NM_2,
		  		                               D1.COO_INF_NM_3,
		  		                               D1.COO_INF_NM_4,
		  		                               D1.COO_INF_NM_5
				                          FROM TBCSPMWF002M D1,

									  ( SELECT DDT, DY
                                          FROM ( SELECT DDT, TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
                                                   FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD')  - LEVEL+1, 'YYYYMMDD') AS DDT
															FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B										 
		                         WHERE 1=1
   		                           AND D1.MNU_DT(+) = B.DDT
								   AND D1.RSTRNT_CD(+) = '3'							    
		                           AND D1.MEAL_DVSN_CD(+) = '2' ORDER BY DDT) D1) 
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('1') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '밥' AS NM,
		                             MAX(DECODE(D2.D, 2, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_1,
									 MAX(DECODE(D2.D, 3, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_2,
                             	 	 MAX(DECODE(D2.D, 4, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_3,
                             		 MAX(DECODE(D2.D, 5, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_4,
                             		 MAX(DECODE(D2.D, 6, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('2') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '국' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SOUP_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SOUP_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SOUP_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SOUP_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SOUP_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('3') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('4') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬2' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('5') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬3' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('6') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬4' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('7') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬5' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('8') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬6' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_6, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_6, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_6, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_6, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_6, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD,D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('9') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '테마' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('11') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('12') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지2' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('13') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지3' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('14') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지4' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('15') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지5' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                             )
		  ORDER BY ORD) A
		  WHERE A.NM IS NOT NULL
		  
UNION ALL
SELECT RSTRNT_CD, ORD, MEAL_DVSN_CD, NM,  NM_1,NM_2,NM_3,NM_4,NM_5 FROM (
		 SELECT *
		   FROM (WITH DATA AS ( 
		   						SELECT DDT, ROWNUM+1 AS D, RSTRNT_CD, MEAL_DVSN_CD, D1.SD_NM_1,
		                                       D1.COO_INF_NM_1, D1.COO_INF_NM_2, D1.COO_INF_NM_3, D1.COO_INF_NM_4, D1.COO_INF_NM_5
								 FROM (
									  SELECT   B.DDT, 
									           '4' AS RSTRNT_CD, 
				                               '3' MEAL_DVSN_CD,
				                               ROWNUM+1 AS D,
				                               D1.SD_NM_1,
		                                       D1.COO_INF_NM_1,
		                                       D1.COO_INF_NM_2,
		                                       D1.COO_INF_NM_3,
		                                       D1.COO_INF_NM_4,
		                                       D1.COO_INF_NM_5
				                          FROM TBCSPMWF002M D1,

									  ( SELECT DDT, DY
                                          FROM ( SELECT DDT, TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
                                                   FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD')  - LEVEL+1, 'YYYYMMDD') AS DDT
															FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B										 
		                         WHERE 1=1
   		                           AND D1.MNU_DT(+) = B.DDT
								   AND D1.RSTRNT_CD(+) = '1'
		                           AND D1.MEAL_DVSN_CD(+) = '3' ORDER BY DDT) D1)
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('1') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('2') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('3') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지2' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('4') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지3' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('5') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지4' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('6') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지5' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       
		                       
		                       
		                             )
		  ORDER BY ORD) A
		  WHERE A.NM IS NOT NULL
UNION ALL
SELECT RSTRNT_CD, ORD, MEAL_DVSN_CD, NM,  NM_1,NM_2,NM_3,NM_4,NM_5 FROM (
		 SELECT *
		   FROM (WITH DATA AS ( 
		   						SELECT DDT, ROWNUM+1 AS D, RSTRNT_CD, MEAL_DVSN_CD, D1.SD_NM_1,
                                       D1.COO_INF_NM_1, D1.COO_INF_NM_2, D1.COO_INF_NM_3,D1.COO_INF_NM_4, D1.COO_INF_NM_5
								 FROM (
									  SELECT   B.DDT, 
									           '5' AS RSTRNT_CD, 
				                               '4' MEAL_DVSN_CD,
				                               ROWNUM+1 AS D,
				                               D1.SD_NM_1,
		                                       D1.COO_INF_NM_1,
		                                       D1.COO_INF_NM_2,
		                                       D1.COO_INF_NM_3,
		                                       D1.COO_INF_NM_4,
		                                       D1.COO_INF_NM_5
				                          FROM TBCSPMWF002M D1,

									  ( SELECT DDT, DY
                                          FROM ( SELECT DDT, TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
                                                   FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD')  - LEVEL+1, 'YYYYMMDD') AS DDT
															FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B										 
		                         WHERE 1=1
   		                           AND D1.MNU_DT(+) = B.DDT
								   AND D1.RSTRNT_CD(+) = '1'
		                           AND D1.MEAL_DVSN_CD(+) = '4' ORDER BY DDT) D1)
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('1') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('2') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지1' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('3') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지2' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('4') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지3' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('5') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지4' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('6') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지5' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                             )
		  ORDER BY ORD) A
		  WHERE A.NM IS NOT NULL
		  
		]]>
	</select>
	
	<delete id="CSPMWF009PMainDelete" parameterClass="paramMap">
			DELETE FROM TBCSPMWF002M WHERE MNU_DT = #COL1#
	</delete>
	
	<insert id="CSPMWF009PMainInsert1" parameterClass="paramMap">
        <![CDATA[
        	INSERT INTO TBCSPMWF002M
			(
				RSTRNT_CD,
				MNU_DT,
				MEAL_DVSN_CD,
				RICE_NM,
				SOUP_NM, SD_NM_1,
				SD_NM_2, SD_NM_3,
				SD_NM_4, SD_NM_5,
				SD_NM_6, SD_NM_7,
				SNC_NM, COO_INF_NM_1,
				COO_INF_NM_2, COO_INF_NM_3,
				COO_INF_NM_4, COO_INF_NM_5,
				FRT_USR_ID, FNL_USR_ID,
				FNL_DEAL_DPT_CD, FNL_MNU_ID,
				FRT_REGI_DH, FNL_MDF_DH
			)
			VALUES
			(
				'1',
				#COL1#,
				'2',
				#COL2#, #COL3#,
				#COL4#, #COL5#,
				#COL6#, #COL7#,
				#COL8#, #COL9#,
				#COL10#, #COL11#,
				#COL12#, #COL13#,
				#COL14#, #COL15#,
				#COL16#,
				#FRT_USR_ID#, #FNL_USR_ID#,
				#FNL_DEAL_DPT_CD#, #FNL_MNU_ID#,
				SYSDATE, SYSDATE
			)
			
        ]]>
	</insert>
	<insert id="CSPMWF009PMainInsert2" parameterClass="paramMap">
        <![CDATA[
			INSERT INTO TBCSPMWF002M
			(
				RSTRNT_CD,
				MNU_DT,
				MEAL_DVSN_CD,
				RICE_NM,
				SOUP_NM, SD_NM_1,
				SD_NM_2, SD_NM_3,
				SD_NM_4, SD_NM_5,
				SD_NM_6, SD_NM_7,
				COO_INF_NM_1,
				COO_INF_NM_2, COO_INF_NM_3,
				COO_INF_NM_4, COO_INF_NM_5,
				FRT_USR_ID, FNL_USR_ID,
				FNL_DEAL_DPT_CD, FNL_MNU_ID,
				FRT_REGI_DH, FNL_MDF_DH
			)
			VALUES
			(
				'2',
				#COL1#,
				'2',
				#COL31#, #COL32#,
				#COL33#, #COL34#,
				#COL35#, #COL36#,
				#COL37#, #COL38#,
				#COL39#, #COL40#,
				#COL41#, #COL42#,
				#COL43#, #COL44#,
				#FRT_USR_ID#, #FNL_USR_ID#,
				#FNL_DEAL_DPT_CD#, #FNL_MNU_ID#,
				SYSDATE, SYSDATE
			)
		]]>
	</insert>
	<insert id="CSPMWF009PMainInsert3" parameterClass="paramMap">
        <![CDATA[
			INSERT INTO TBCSPMWF002M
			(
				RSTRNT_CD,
				MNU_DT,
				MEAL_DVSN_CD,
				RICE_NM,
				SOUP_NM, SD_NM_1,
				SD_NM_2, SD_NM_3,
				SD_NM_4, SD_NM_5,
				SD_NM_6, SNC_NM,
				COO_INF_NM_1,
				COO_INF_NM_2, COO_INF_NM_3,
				COO_INF_NM_4, COO_INF_NM_5,
				FRT_USR_ID, FNL_USR_ID,
				FNL_DEAL_DPT_CD, FNL_MNU_ID,
				FRT_REGI_DH, FNL_MDF_DH
			)
			VALUES
			(
				'3',
				#COL1#,
				'2',
				#COL17#, #COL18#,
				#COL19#, #COL20#,
				#COL21#, #COL22#,
				#COL23#, #COL24#,
				#COL25#, #COL26#,
				#COL27#, #COL28#,
				#COL29#, #COL30#,
				
				#FRT_USR_ID#, #FNL_USR_ID#,
				#FNL_DEAL_DPT_CD#, #FNL_MNU_ID#,
				SYSDATE, SYSDATE
			)
		]]>
	</insert>
	
	<insert id="CSPMWF009PMainInsert4" parameterClass="paramMap">
        <![CDATA[
			INSERT INTO TBCSPMWF002M
			(
				RSTRNT_CD,
				MNU_DT,
				MEAL_DVSN_CD,
				SD_NM_1,COO_INF_NM_1,
				COO_INF_NM_2, COO_INF_NM_3,
				COO_INF_NM_4, COO_INF_NM_5,
				FRT_USR_ID, FNL_USR_ID,
				FNL_DEAL_DPT_CD, FNL_MNU_ID,
				FRT_REGI_DH, FNL_MDF_DH
			)
			VALUES
			(
				'1',
				#COL1#,
				'3',
				#COL45#,#COL46#,#COL47#,#COL48#,#COL49#,#COL50#,
				#FRT_USR_ID#, #FNL_USR_ID#,
				#FNL_DEAL_DPT_CD#, #FNL_MNU_ID#,
				SYSDATE, SYSDATE
			)
		]]>
	</insert>
	
	<insert id="CSPMWF009PMainInsert5" parameterClass="paramMap">
        <![CDATA[
			INSERT INTO TBCSPMWF002M
			(
				RSTRNT_CD,
				MNU_DT,
				MEAL_DVSN_CD,
				SD_NM_1,COO_INF_NM_1,
				COO_INF_NM_2, COO_INF_NM_3,
				COO_INF_NM_4, COO_INF_NM_5,
				FRT_USR_ID, FNL_USR_ID,
				FNL_DEAL_DPT_CD, FNL_MNU_ID,
				FRT_REGI_DH, FNL_MDF_DH
			)
			VALUES
			(
				'1',
				#COL1#,
				'4',
				#COL51#,#COL52#,#COL53#,#COL54#,#COL55#,#COL56#,				
				#FRT_USR_ID#, #FNL_USR_ID#,
				#FNL_DEAL_DPT_CD#, #FNL_MNU_ID#,
				SYSDATE, SYSDATE
			)
		]]>
	</insert>
	
	<select id="CSPMWF009PSelectFoodMnuList2" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
				SELECT * FROM TBCSPMWF002M 
				 WHERE 1=1
				 AND MNU_DT >= #fromYmd# 
				 AND MNU_DT <= #toYmd#
				ORDER BY RSTRNT_CD
		]]>
	</select>
	
	<select id="CSPMWF009PSelectHeaderList" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
				 SELECT TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'YYYY-MM-DD(DY)') AS DATENAME
				   FROM ( SELECT DDT,
				                 TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
				            FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD') - LEVEL + 1,'YYYYMMDD') AS DDT
				                     FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1 
				                  )
				        )
				  WHERE DY IN('2', '3', '4', '5', '6')
				  ORDER BY DATENAME
		]]>
	</select>	
	
	<update id="CSPMWF0090PUpdate" parameterClass="paramMap">
		UPDATE 	TBCSPMWF002M
		   SET 	
				RICE_NM=#RICE_NM#,
				SOUP_NM=#SOUP_NM#,
				SD_NM_1=#SD_NM_1#,
				SD_NM_2=#SD_NM_2#,
				SD_NM_3=#SD_NM_3#,
				SD_NM_4=#SD_NM_4#,
				SD_NM_5=#SD_NM_5#,
				SD_NM_6=#SD_NM_6#,
				SD_NM_7=#SD_NM_7#,
			<isNotNull property="SNC_NM">
				SNC_NM=#SNC_NM#,
			</isNotNull>
				COO_INF_NM_1=#COO_INF_NM_1#,
				COO_INF_NM_2=#COO_INF_NM_2#,
				COO_INF_NM_3=#COO_INF_NM_3#,
				COO_INF_NM_4=#COO_INF_NM_4#,
				COO_INF_NM_5=#COO_INF_NM_5#,
				FNL_USR_ID=#FNL_USR_ID#,
				FNL_DEAL_DPT_CD=#FNL_DEAL_DPT_CD#,
				FNL_MNU_ID=#FNL_MNU_ID#,
				FNL_MDF_DH=SYSDATE
		WHERE	1=1
		  AND	RSTRNT_CD = #RSTRNT_CD#
		  AND	MNU_DT = #MNU_DT#
		  AND	MEAL_DVSN_CD = #MEAL_DVSN_CD#

	</update>
	
	<select id="CSPMWF009PSelectInitList" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
			SELECT TO_CHAR(TRUNC(SYSDATE, 'IW'), 'YYYYMMDD') AS MON,
				   TO_CHAR(TRUNC(TO_DATE(SYSDATE) , 'IW')+4, 'YYYYMMDD') AS FRI
			  FROM DUAL
		]]>
	</select>
	<!-- 메뉴등록팝업 종료 -->	
	
	<!-- 주간메뉴 팝업 -->
	<!-- <select id="CSPMWF001PMainSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
	SELECT RSTRNT_CD, ORD, MEAL_DVSN_CD, NM,  NM_1,NM_2,NM_3,NM_4,NM_5 FROM (
		 SELECT *
		   FROM (WITH DATA AS ( 
		   						SELECT DDT, ROWNUM+1 AS D, RSTRNT_CD, MEAL_DVSN_CD, RICE_NM, SOUP_NM,D1.SD_NM_1,
		                               D1.SD_NM_2,
		                               D1.SD_NM_3,
		                               D1.SD_NM_4,
		                               D1.SD_NM_5,
		                               D1.SD_NM_6,
		                               D1.SD_NM_7,
		                               D1.SNC_NM,
		                               D1.COO_INF_NM
								 FROM (
									  SELECT   B.DDT, 
									           #RSTRNT_CD# AS RSTRNT_CD, 
				                               '2' MEAL_DVSN_CD,
				                               ROWNUM+1 AS D,
				                               D1.RICE_NM,
				                               D1.SOUP_NM,
				                               D1.SD_NM_1,
				                               D1.SD_NM_2,
				                               D1.SD_NM_3,
				                               D1.SD_NM_4,
				                               D1.SD_NM_5,
				                               D1.SD_NM_6,
				                               D1.SD_NM_7,
				                               D1.SNC_NM,
				                               D1.COO_INF_NM
				                          FROM TBCSPMWF002M D1,

									  ( SELECT DDT, DY
                                          FROM ( SELECT DDT, TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
                                                   FROM ( SELECT TO_CHAR(TO_DATE(#toYmd#, 'YYYYMMDD')  - LEVEL+1, 'YYYYMMDD') AS DDT
															FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD') +1) ) WHERE DY IN('2', '3', '4', '5', '6') ) B										 
		                         WHERE 1=1
   		                           AND D1.MNU_DT(+) = B.DDT
								   AND D1.RSTRNT_CD(+) = #RSTRNT_CD#							    
		                           AND D1.MEAL_DVSN_CD(+) = '2' ORDER BY DDT) D1) 
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('1') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '밥' AS NM,
		                             MAX(DECODE(D2.D, 2, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_1,
									 MAX(DECODE(D2.D, 3, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_2,
                             	 	 MAX(DECODE(D2.D, 4, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_3,
                             		 MAX(DECODE(D2.D, 5, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_4,
                             		 MAX(DECODE(D2.D, 6, DECODE(D2.RICE_NM,NULL, NVL((SELECT HLDY_NM FROM TBBADDED013B Z WHERE D2.DDT=Z.YE||Z.MD),' ') ,D2.RICE_NM),NULL )) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('2') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '국' AS NM, 
		                             MAX(DECODE(D2.D, 2, D2.SOUP_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SOUP_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SOUP_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SOUP_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SOUP_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('3') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_1, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_1, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_1, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_1, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_1, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.SD_NM_1 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('4') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_2, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_2, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_2, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_2, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_2, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.SD_NM_2 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('5') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_3, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_3, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_3, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_3, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_3, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.SD_NM_3 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('6') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_4, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_4, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_4, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_4, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_4, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.SD_NM_4 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('7') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_5, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_5, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_5, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_5, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_5, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.SD_NM_5 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('8') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_6, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_6, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_6, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_6, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_6, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.SD_NM_6 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD,D2.MEAL_DVSN_CD
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('9') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '반찬' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SD_NM_7, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SD_NM_7, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SD_NM_7, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SD_NM_7, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SD_NM_7, NULL ) ) AS NM_5
		                        FROM DATA D2
		                        WHERE D2.SD_NM_7 IS NOT NULL
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
		]]>
			<dynamic>
				<isEqual property="RSTRNT_CD" compareValue="1" >
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('10') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '간식' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
				</isEqual>
				<isEqual property="RSTRNT_CD" compareValue="3" >
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('10') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '테마' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.SNC_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.SNC_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.SNC_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.SNC_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.SNC_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                       UNION ALL
				</isEqual>
			</dynamic>
		<![CDATA[
		                       UNION ALL
		                      SELECT D2.RSTRNT_CD,
		                             TO_NUMBER('11') AS ORD,
		                             D2.MEAL_DVSN_CD,
		                             '원산지' AS NM,
		                             MAX(DECODE(D2.D, 2, D2.COO_INF_NM, NULL ) ) AS NM_1,
		                             MAX(DECODE(D2.D, 3, D2.COO_INF_NM, NULL ) ) AS NM_2,
		                             MAX(DECODE(D2.D, 4, D2.COO_INF_NM, NULL ) ) AS NM_3,
		                             MAX(DECODE(D2.D, 5, D2.COO_INF_NM, NULL ) ) AS NM_4,
		                             MAX(DECODE(D2.D, 6, D2.COO_INF_NM, NULL ) ) AS NM_5
		                        FROM DATA D2
		                       GROUP BY D2.RSTRNT_CD, D2.MEAL_DVSN_CD
		                             )
		  ORDER BY ORD) A
		  WHERE A.NM IS NOT NULL
		]]>
	</select> -->
	
	<select id="CSPMWF001PSelectHeaderList" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
 SELECT TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'YYYY-MM-DD(DY)') AS DATENAME
   FROM ( SELECT DDT,
                 TO_CHAR(TO_DATE(DDT, 'YYYYMMDD'), 'D') DY
            FROM ( SELECT TO_CHAR( (TO_DATE(#toYmd#, 'YYYYMMDD') - (1 - 1) *7) - LEVEL + 1,'YYYYMMDD') AS DDT
                     FROM DUAL CONNECT BY LEVEL <= TO_DATE(#toYmd#, 'YYYYMMDD') - TO_DATE(#fromYmd#, 'YYYYMMDD')  - (1 - 1) *7+1) )
  WHERE DY IN('2', '3', '4', '5', '6')
  ORDER BY DATENAME
		]]>
	</select>
	
	<select id="CSPMWF001IExtvListSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
			SELECT CNB FROM TBCSPMWF005M WHERE CNB = #S_CNB#
		]]>
	</select>
</sqlMap> 
