<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">
<!-- 

- 인자값 가져오기
컬럼명 = #파라미터명#

- SQLMAP.xml 기본 골격
<sqlMap namespace="">
	<select id="" parameterClass="" resultClass="">
	</select>
	<insert id="" parameterClass="">
	</insert>
	<update id="" parameterClass="">
	</update>
	<delete id="" parameterClass="">
	</delete>
</sqlMap>

- SQLMAP.xml 세부 골격
<isNotNull property="속성명" prepend="AND, OR">
</isNotNull>
<isNotEmpty property="" prepend="" removeFirstPrepend="">
</isNotEmpty>
<isNull property="">
	<isEqual property="" compareValue="">
   	</isEqual>
</isNull>
-->
<sqlMap namespace="AEPGKM010P">
	<insert id="AEPGKM010P.INSERT" parameterClass="java.util.Map">
		INSERT INTO TBAEPGKM001M (
			KNB, 
			KLD_NM, KLD_SMM_TXT, 
			KYWD_NM_1, KYWD_NM_2, KYWD_NM_3, 
			REGI_RQS_DT, PRSV_WAY_CD, PRSV_DDLN_DH, 
			KLD_CAT_CD, KLD_TXT, TG_ORG_CD, 
			AUD_YR, AUD_NO, DSP_RQ_SNO, 
			FUNC_SPH_CD, CAT_SPH_CD, ATT_FNB, 
			REGN_OPEN_YN, KLD_STA_CD, REGN_CNB, REGN_DPT_CD, REGN_DPT_NM, 
			FRT_USR_ID, FNL_USR_ID, FNL_DEAL_DPT_CD, FNL_MNU_ID, FRT_REGI_DH, FNL_MDF_DH, BOARD_ID, POST_SEQ
		)
		VALUES (
			#KNB#, 
			#KLD_NM#, #KLD_SMM_TXT#, 
			#KYWD_NM_1#, #KYWD_NM_2#, #KYWD_NM_3#, 
			to_char(SYSDATE, 'yyyyMMdd'), #PRSV_WAY_CD#, #PRSV_DDLN_DH#, 
			#KLD_CAT_CD#, #KLD_TXT#, #TG_ORG_CD#, 
			#AUD_YR#, #AUD_NO#, #DSP_RQ_SNO#, 
			#FUNC_SPH_CD#, #CAT_SPH_CD#, #ATT_FNB#, 
			#REGN_OPEN_YN#, #KLD_STA_CD#, #CNB#, #DPT_CD#, #DPT_NM#,
			#USR_ID#, #USR_ID#, #DPT_CD#, #FNL_MNU_ID#, SYSDATE, SYSDATE, #BOARD_ID#, #POST_SEQ#
		)
	</insert>
	
	<update id="AEPGKM010P.UPDATE" parameterClass="java.util.Map">
		UPDATE	TBAEPGKM001M
		SET		KLD_NM			= #KLD_NM#,
				KLD_SMM_TXT		= #KLD_SMM_TXT#,
				KYWD_NM_1		= #KYWD_NM_1#,
				KYWD_NM_2		= #KYWD_NM_2#,
				KYWD_NM_3		= #KYWD_NM_3#,
				PRSV_WAY_CD		= #PRSV_WAY_CD#,
				PRSV_DDLN_DH	= #PRSV_DDLN_DH#,
				KLD_TXT			= #KLD_TXT#,
				TG_ORG_CD		= #TG_ORG_CD#,
				AUD_YR			= #AUD_YR#,
				AUD_NO			= #AUD_NO#,
				DSP_RQ_SNO		= #DSP_RQ_SNO#,
				FUNC_SPH_CD		= #FUNC_SPH_CD#,
				CAT_SPH_CD		= #CAT_SPH_CD#,
				ATT_FNB			= #ATT_FNB#,
				REGN_OPEN_YN	= #REGN_OPEN_YN#,
				FNL_USR_ID		= #USR_ID#,
				FNL_DEAL_DPT_CD	= #DPT_CD#,
				FNL_MNU_ID		= #MNU_ID#,
				FNL_MDF_DH		= SYSDATE
		WHERE	BOARD_ID		= #BOARD_ID#
		AND		POST_SEQ		= #POST_SEQ#
	</update>
	
	<delete id="AEPGKM010P.DELETE" parameterClass="java.util.Map">
		DELETE FROM TBAEPGKM001M
		WHERE	BOARD_ID = #BOARD_ID#
		AND		POST_SEQ = #POST_SEQ#
	</delete>
	
	<select id="AEPGKM010P.GET_MAX" resultClass="java.math.BigDecimal">
	SELECT NVL(MAX(KNB)+1, 1) MAX FROM TBAEPGKM001M
	</select>
	
	<select id="AEPGKM010P.SELECT" parameterClass="java.util.Map" resultClass="java.util.HashMap">
	SELECT	KNB,
			KLD_NM,
			KLD_SMM_TXT,
			KYWD_NM_1,
			KYWD_NM_2,
			KYWD_NM_3,
			REPLACE(SUBSTR(TO_DATE(REGI_RQS_DT, 'YYYY-MM-DD'), 0, 10), '/', '-') AS REGI_RQS_DT,
			PRSV_WAY_CD, 
			TO_CHAR(PRSV_DDLN_DH, 'YYYY-MM-DD') AS PRSV_DDLN_DH, 
			KLD_CAT_CD,
			KLD_TXT, 
  			TG_ORG_CD,
  			AUD_YR, 
  			AUD_NO,
  			DSP_RQ_SNO, 
  			FUNC_SPH_CD,
  			CAT_SPH_CD,
  			ATT_FNB, 
  			REGN_OPEN_YN, 
  			KLD_STA_CD,
  			TEAM_DRIN, 
  			EXPR_DH, 
  			ABRG_DH, 
  			RSTR_DH, 
  			ABRG_RSN, 
  			REGN_CNB, 
  			REGN_DPT_CD, 
  			REGN_DPT_NM, 
  			FRT_USR_ID, 
  			FNL_USR_ID, 
  			FNL_DEAL_DPT_CD, 
  			FNL_MNU_ID, 
  			FRT_REGI_DH, 
  			FNL_MDF_DH, 
  			BOARD_ID, 
  			POST_SEQ
	FROM	TBAEPGKM001M
	WHERE	1 = 1
  	<isNotNull property="KNB" prepend="AND">
  	KNB = #KNB#
  	</isNotNull>
  	<isNotNull property="BOARD_ID" prepend="AND">
  	BOARD_ID = #BOARD_ID#
  	</isNotNull>
  	<isNotNull property="POST_SEQ" prepend="AND">
  	POST_SEQ = #POST_SEQ#
  	</isNotNull>
	</select>
	
	<select id="AEPGKM010P.GET_KLD_CAT_NM" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	TG_CAT_NM AS KLD_CAT_NM
		FROM	TBAEPGKM017M
		WHERE	TG_CAT_ID = #KLD_CAT_CD#
	</select>
	
	<select id="AEPGKM010P.GET_TG_ORG_NM" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	ORG_NM AS TG_ORG_NM
		FROM	TBDCMACM015M
		WHERE	ORG_CD = #TG_ORG_CD#
	</select>
	
	<select id="AEPGKM010P.GET_AUD_SBJ_NM" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	AUD_SBJ_NM
		FROM	TBBADDED001M
		WHERE	AUD_YR = #AUD_YR# AND AUD_NO = #AUD_NO#
	</select>
	
	<select id="AEPGKM010P.GET_DSP_TIT_TXT" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	TIT_TXT
		FROM	TBBADEAR001M
		WHERE	AUD_YR = #AUD_YR#
		AND		AUD_NO = #AUD_NO#
		AND		DSP_RQ_SNO = #DSP_RQ_SNO#
	</select>
	
	<select id="AEPGKM010P.GET_KLD_STA_NM" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	CD, CD_NM AS KLD_STA_NM
		FROM	TBDCMACM013C
		WHERE	CMM_CD_DVSN_CD = '1000351'
		AND		CD = #KLD_STA_CD#
	</select>
	
	<select id="AEPGKM010P.GET_USER_INFO" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	USR_NAM AS USR_NM, EML_AD
		FROM	TBDCMACM001M
		WHERE	CNB = #CNB#
</select>
	
	<select id="AEPGKM010P.GET_CAT_SPH_CD" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	CD,
				CD_NM
		FROM	TBDCMACM013C
		WHERE	CMM_CD_DVSN_CD = '1000466'
		AND		CD != '000000000'
		<isNotEmpty property="CAT_SPH_CD" prepend="AND">
				CD = #CAT_CPH_CD#
		</isNotEmpty>
	</select>
	
	<select id="AEPGKM010P.GET_FUNC_SPH_CD" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		SELECT	CD,
				CD_NM
		FROM TBDCMACM013C
		WHERE CMM_CD_DVSN_CD = '1000467'
		AND		CD != '000000000'
		<isNotEmpty property="FUNC_SPH_CD" prepend="AND">
				CD = #FUNC_CPH_CD#
		</isNotEmpty>
	</select>
</sqlMap>