<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/044">

	<select id="FAACAV044ERselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/044/FAACAV044ERselect */ ]]>
		SELECT B.ACNT_CD AS 소관부호
			   ,B.ACNT_CD_NM AS 소관명
			   ,(CASE SUBSTRING(A.CHIF_CD,1,1)
				 WHEN '2' THEN '방 위 비'
				 WHEN '1' THEN '일반행정'
				 WHEN '3' THEN '사회개발'
				 WHEN '4' THEN '경제개발'
				 WHEN '5' THEN '지방재정교부금'
				 WHEN '6' THEN '채무상환기타'
			     ELSE ''
			     END) AS 기능
			   ,SUM(A.TOT_CLSG_AMT_2) AS 차감누계액
		  FROM TWFAACAV061L A, TWFAACAV024C B
		 WHERE A.ACNT_YR=#strYr#
		   AND A.CLSG_DVSN_CD='A'
		   AND A.ACNT_CD='011'
		   AND A.SUM_DVSN_ID NOT IN ('49', '51')
		   <![CDATA[
		   AND SUBSTRING(A.CHIF_CD,1,1) <> '0'
		   ]]>
		   AND A.COPT_CD = B.ACNT_CD
		   AND B.ACNT_DVSN_CD= '02'
	  GROUP BY B.ACNT_CD, B.ACNT_CD_NM, SUBSTRING(A.CHIF_CD,1,1)
	</select>		
	
	<select id="FAACAV044ER2select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/044/FAACAV044ER2select */ ]]>
		SELECT D1.ORG_NM AS 증명기관명
		 	   ,D5.COPT_CD||'-'||D5.ACNT_CD||'-'||D5.BLL_CD||'-'||D5.PROF_DRTR_SRNO||'-'||D5.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
		 	   ,D4.EAN||'-'||D4.ACCT_SUBJ_CD AS 계좌번호
		 	   ,NVL(D5.TOT_CLSG_AMT_2,0) AS 차감누계액
			   ,NVL(D6.CMP_AMT_2,0) AS 월계금액
			   ,NVL(D5.TOT_CLSG_AMT_2,0)-NVL(D6.CMP_AMT_2,0) AS 차액
		  FROM TWFAACAV003M D1, TWFAACAV024C D2, TWFAACAV024C D3, TWFAACAV062L D4
			   , TWFAACAV061L D5, TWFAACAV010L D6
		 WHERE D5.ACNT_YR = #strYr#
		   AND D5.CLSG_DVSN_CD = 'A'
		   AND D5.COPT_CD IN (
		   		SELECT DISTINCT NVL(D1.COPT_CD,'') AS OFFC_CD
			      FROM TWFAACAV061L D1, TWFAACAV024C D2, TWFAACAV024C D3
			     WHERE D1.ACNT_YR = #strYr# 
			       AND D1.CLSG_DVSN_CD = 'A'
			       AND D1.SUM_DVSN_ID = '49'
			       AND D1.COPT_CD = D2.ACNT_CD
			       AND D2.ACNT_DVSN_CD = '02'
			       AND D1.ACNT_CD = D3.ACNT_CD
			       AND D3.ACNT_DVSN_CD = '01'
			  GROUP BY D1.COPT_CD, D1.ACNT_CD
		   )
		   AND D5.ACNT_CD IN(
		   		SELECT DISTINCT NVL(D1.ACNT_CD,'') AS FSCL_CD
			      FROM TWFAACAV061L D1, TWFAACAV024C D2, TWFAACAV024C D3
			     WHERE D1.ACNT_YR = #strYr# 
			       AND D1.CLSG_DVSN_CD = 'A'
			       AND D1.SUM_DVSN_ID = '49'
			       AND D1.COPT_CD = D2.ACNT_CD
			       AND D2.ACNT_DVSN_CD = '02'
			       AND D1.ACNT_CD = D3.ACNT_CD
			       AND D3.ACNT_DVSN_CD = '01'
			  GROUP BY D1.COPT_CD, D1.ACNT_CD
		   )
		   AND D5.SUM_DVSN_ID = '49'
		   AND D5.ACNT_YR = D4.ACNT_YR
		   AND D5.COPT_CD = D4.COPT_CD
		   AND D5.ACNT_CD = D4.ACNT_CD 
		   AND D5.BLL_CD = D4.BLL_CD 
		   AND D5.PROF_DRTR_SRNO = D4.PROF_DRTR_SRNO 
		   AND D5.DL_XPN_RCDB_PBSVT_SRNO = D4.DL_XPN_RCDB_PBSVT_SRNO
		   AND D5.COPT_CD = D3.ACNT_CD
		   AND D3.ACNT_DVSN_CD = '02'
		   AND D5.ACNT_CD = D2.ACNT_CD
		   AND D2.ACNT_DVSN_CD = '01'
		   AND D5.COPT_CD = D1.COPT_CD
		   AND D5.ACNT_CD = D1.ACNT_CD
		   AND D5.BLL_CD = D1.BLL_CD
		   AND D5.PROF_DRTR_SRNO = D1.PROF_DRTR_SRNO
		   AND D5.DL_XPN_RCDB_PBSVT_SRNO = D1.DL_XPN_RCDB_PBSVT_SRNO
		   AND D6.EAN = D4.EAN
		   AND D6.ACCT_SUBJ_CD = D4.ACCT_SUBJ_CD
		   AND D6.MNSUM_DVSN_CD = '02'	
		   AND SUBSTRING(D6.MNSUM_YM,5,2) = '13'
	</select>
	
	<select id="FAACAV044ER3select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/044/FAACAV044ER3select */ ]]>
		SELECT D1.ORG_NM AS 증명기관명
		 	   ,D5.COPT_CD||'-'||D5.ACNT_CD||'-'||D5.BLL_CD||'-'||D5.PROF_DRTR_SRNO||'-'||D5.DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
		 	   ,D4.EAN||'-'||D4.ACCT_SUBJ_CD AS 계좌번호
		 	   ,NVL(D5.TOT_CLSG_AMT_2,0) AS 차감누계액
			   ,NVL(D6.CMP_AMT_2,0) AS 월계금액
			   ,NVL(D5.TOT_CLSG_AMT_2,0)-NVL(D6.CMP_AMT_2,0) AS 차액
		  FROM TWFAACAV003M D1, TWFAACAV024C D2, TWFAACAV024C D3, TWFAACAV062L D4
			   , TWFAACAV061L D5, TWFAACAV010L D6
		 WHERE D5.ACNT_YR = #strYr#
		   AND D5.CLSG_DVSN_CD = 'A'
		   AND D5.COPT_CD IN (
		   		SELECT DISTINCT NVL(D1.COPT_CD,'') AS OFFC_CD
			      FROM TWFAACAV061L D1, TWFAACAV024C D2, TWFAACAV024C D3
			     WHERE D1.ACNT_YR = #strYr# 
			       AND D1.CLSG_DVSN_CD = 'B'
			       AND D1.SUM_DVSN_ID = '49'
			       AND D1.COPT_CD = D2.ACNT_CD
			       AND D2.ACNT_DVSN_CD = '02'
			       AND D1.ACNT_CD = D3.ACNT_CD
			       AND D3.ACNT_DVSN_CD = '01'
			  GROUP BY D1.COPT_CD, D1.ACNT_CD
		   )
		   AND D5.ACNT_CD IN(
		   		SELECT DISTINCT NVL(D1.ACNT_CD,'') AS FSCL_CD
			      FROM TWFAACAV061L D1, TWFAACAV024C D2, TWFAACAV024C D3
			     WHERE D1.ACNT_YR = #strYr# 
			       AND D1.CLSG_DVSN_CD = 'A'
			       AND D1.SUM_DVSN_ID = '49'
			       AND D1.COPT_CD = D2.ACNT_CD
			       AND D2.ACNT_DVSN_CD = '02'
			       AND D1.ACNT_CD = D3.ACNT_CD
			       AND D3.ACNT_DVSN_CD = '01'
			  GROUP BY D1.COPT_CD, D1.ACNT_CD
		   )
		   AND D5.SUM_DVSN_ID = '49'
		   AND D5.ACNT_YR = D4.ACNT_YR
		   AND D5.COPT_CD = D4.COPT_CD
		   AND D5.ACNT_CD = D4.ACNT_CD 
		   AND D5.BLL_CD = D4.BLL_CD 
		   AND D5.PROF_DRTR_SRNO = D4.PROF_DRTR_SRNO 
		   AND D5.DL_XPN_RCDB_PBSVT_SRNO = D4.DL_XPN_RCDB_PBSVT_SRNO
		   AND D5.COPT_CD = D3.ACNT_CD
		   AND D3.ACNT_DVSN_CD = '02'
		   AND D5.ACNT_CD = D2.ACNT_CD
		   AND D2.ACNT_DVSN_CD = '01'
		   AND D5.COPT_CD = D1.COPT_CD
		   AND D5.ACNT_CD = D1.ACNT_CD
		   AND D5.BLL_CD = D1.BLL_CD
		   AND D5.PROF_DRTR_SRNO = D1.PROF_DRTR_SRNO
		   AND D5.DL_XPN_RCDB_PBSVT_SRNO = D1.DL_XPN_RCDB_PBSVT_SRNO
		   AND D6.EAN = D4.EAN
		   AND D6.ACCT_SUBJ_CD = D4.ACCT_SUBJ_CD
		   AND D6.MNSUM_DVSN_CD = '01'	
		   AND SUBSTRING(D6.MNSUM_YM,5,2) = '13'
	</select>
	
	<select id="FAACAV044ER2_1select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/044/FAACAV044ER2_1select */ ]]>
		SELECT B.ACNT_CD_NM AS 소관명
			   ,C.ACNT_CD_NM AS 회계명
		  FROM TWFAACAV061L A, TWFAACAV024C B, TWFAACAV024C C
		 WHERE A.ACNT_YR = #strYr# 
		   AND A.CLSG_DVSN_CD = 'A'
		   AND A.SUM_DVSN_ID = '49'
		   AND A.COPT_CD = B.ACNT_CD
		   AND B.ACNT_DVSN_CD = '02'
		   AND A.ACNT_CD = C.ACNT_CD
		   AND C.ACNT_DVSN_CD = '01'
 	  GROUP BY A.COPT_CD, A.ACNT_CD, B.ACNT_CD_NM, C.ACNT_CD_NM
	</select>
	
	<select id="FAACAV044ER3_1select" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/044/FAACAV044ER3_1select */ ]]>
		SELECT B.ACNT_CD_NM AS 소관명
			   ,C.ACNT_CD_NM AS 회계명
		  FROM TWFAACAV061L A, TWFAACAV024C B, TWFAACAV024C C
		 WHERE A.ACNT_YR = #strYr# 
		   AND A.CLSG_DVSN_CD = 'B'
		   AND A.SUM_DVSN_ID = '49'
		   AND A.COPT_CD = B.ACNT_CD
		   AND B.ACNT_DVSN_CD = '02'
		   AND A.ACNT_CD = C.ACNT_CD
		   AND C.ACNT_DVSN_CD = '01'
 	  GROUP BY A.COPT_CD, A.ACNT_CD, B.ACNT_CD_NM, C.ACNT_CD_NM
	</select>
</sqlMap> 
