<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/mwf/003">

	<select id="CSPMWF022ENopSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
			SELECT	WRIT_DT
					,NVL(NOP_CNT_1,0) AS NOP_CNT_1
					,NVL(NOP_CNT_2,0) AS NOP_CNT_2
					,NVL(NOP_CNT_3,0) AS NOP_CNT_3
					,NVL(NOP_CNT_4,0) AS NOP_CNT_4
					,NVL(NOP_CNT_5,0) AS NOP_CNT_5
					,NVL(NOP_CNT_6,0) AS NOP_CNT_6
					,NVL(NOP_CNT_7,0) AS NOP_CNT_7
					,NVL(NOP_CNT_8,0) AS NOP_CNT_8
					,NVL(MOP_STF_CNT_1,0) AS MOP_STF_CNT_1
					,NVL(MOP_STF_CNT_2,0) AS MOP_STF_CNT_2
					,NVL(MOP_STF_CNT_3,0) AS MOP_STF_CNT_3
					,NVL(MOP_STF_CNT_4,0) AS MOP_STF_CNT_4
					,NVL(MOP_STF_CNT_5,0) AS MOP_STF_CNT_5
					,NVL(MOP_STF_CNT_6,0) AS MOP_STF_CNT_6
					,NVL(MOP_STF_CNT_7,0) AS MOP_STF_CNT_7
					,NVL(MOP_STF_CNT_8,0) AS MOP_STF_CNT_8
					,NVL(NOMOP_TMPTR_STF_CNT_1,0) AS NOMOP_TMPTR_STF_CNT_1
					,NVL(NOMOP_TMPTR_STF_CNT_2,0) AS NOMOP_TMPTR_STF_CNT_2
					,NVL(NOMOP_TMPTR_STF_CNT_3,0) AS NOMOP_TMPTR_STF_CNT_3
					,NVL(NOMOP_TMPTR_STF_CNT_4,0) AS NOMOP_TMPTR_STF_CNT_4
					,NVL(NOMOP_TMPTR_STF_CNT_5,0) AS NOMOP_TMPTR_STF_CNT_5
					,NVL(NOMOP_TMPTR_STF_CNT_6,0) AS NOMOP_TMPTR_STF_CNT_6
					,NVL(NOMOP_TMPTR_STF_CNT_7,0) AS NOMOP_TMPTR_STF_CNT_7
					,NVL(NOMOP_TMPTR_STF_CNT_8,0) AS NOMOP_TMPTR_STF_CNT_8
					,NVL(OW_ATC_ASO_CNT_1,0) AS OW_ATC_ASO_CNT_1
					,NVL(OW_ATC_ASO_CNT_2,0) AS OW_ATC_ASO_CNT_2
					,NVL(OW_ATC_ASO_CNT_3,0) AS OW_ATC_ASO_CNT_3
					,NVL(OW_ATC_ASO_CNT_4,0) AS OW_ATC_ASO_CNT_4
					,NVL(OW_ATC_ASO_CNT_5,0) AS OW_ATC_ASO_CNT_5
					,NVL(OW_ATC_ASO_CNT_6,0) AS OW_ATC_ASO_CNT_6
					,NVL(OW_ATC_ASO_CNT_7,0) AS OW_ATC_ASO_CNT_7
					,NVL(OW_ATC_ASO_CNT_8,0) AS OW_ATC_ASO_CNT_8
					,NOP_MDF_DH
					,FNL_MDF_DH
					,(SELECT COUNT(1) FROM (
						    select DISTINCT T1.CNB from PTL_LOG T1, TBDCMACM001M T2, TBDCMACM002M T3
						        where LOGIN_DATE 
						    BETWEEN #writDt#||'000000' AND #writDt#||'235959'
						    AND T1.CNB = T2.CNB
						    AND T2.DPT_CD = T3.DPT_CD
						    AND T3.LOC_DVSN_CD = 'I'
						    and USER_IP like '10.22%'
						)) AS LOGIN_CNT
			  FROM	TBCSPMWF001M
			 WHERE	1=1
			   AND	WRIT_DT = #writDt#
		]]>
	</select>
	
	<select id="CSPMWF024ENopSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
			SELECT	A.WRIT_DT AS WRIT_DT_1,
					(A.MOP_STF_CNT_1_1 + A.NOMOP_TMPTR_STF_CNT_1_1 + A.OW_ATC_ASO_CNT_1_1) AS NOP_CNT_1_1,
					(A.MOP_STF_CNT_2_1 + A.NOMOP_TMPTR_STF_CNT_2_1 + A.OW_ATC_ASO_CNT_2_1) AS NOP_CNT_2_1,
					(A.MOP_STF_CNT_3_1 + A.NOMOP_TMPTR_STF_CNT_3_1 + A.OW_ATC_ASO_CNT_3_1) AS NOP_CNT_3_1,
					((A.MOP_STF_CNT_5_1 + A.MOP_STF_CNT_6_1 + A.MOP_STF_CNT_7_1) + 
					  A.NOMOP_TMPTR_STF_CNT_4_1 + OW_ATC_ASO_CNT_5_1+OW_ATC_ASO_CNT_6_1+OW_ATC_ASO_CNT_7_1) AS NOP_CNT_4_1,
					(A.MOP_STF_CNT_5_1 + A.NOMOP_TMPTR_STF_CNT_5_1 + A.OW_ATC_ASO_CNT_5_1) AS NOP_CNT_5_1,
					(A.MOP_STF_CNT_6_1 + A.NOMOP_TMPTR_STF_CNT_6_1 + A.OW_ATC_ASO_CNT_6_1) AS NOP_CNT_6_1,
					(A.MOP_STF_CNT_7_1 + A.NOMOP_TMPTR_STF_CNT_7_1 + A.OW_ATC_ASO_CNT_7_1) AS NOP_CNT_7_1,
					
					((A.MOP_STF_CNT_1_1 - (A.MOP_STF_CNT_2_1 + A.MOP_STF_CNT_3_1 + A.MOP_STF_CNT_5_1 + A.MOP_STF_CNT_6_1 + A.MOP_STF_CNT_7_1)) + 
					 (A.NOMOP_TMPTR_STF_CNT_1_1 - (A.NOMOP_TMPTR_STF_CNT_2_1 + A.NOMOP_TMPTR_STF_CNT_3_1 + A.NOMOP_TMPTR_STF_CNT_4_1)) + 
					 (A.OW_ATC_ASO_CNT_1_1 - (A.OW_ATC_ASO_CNT_2_1+OW_ATC_ASO_CNT_5_1+OW_ATC_ASO_CNT_6_1+OW_ATC_ASO_CNT_7_1))) AS NOP_CNT_8_1,	
					
					A.MOP_STF_CNT_1_1, A.MOP_STF_CNT_2_1, A.MOP_STF_CNT_3_1, 
			      	(A.MOP_STF_CNT_5_1 + A.MOP_STF_CNT_6_1 + A.MOP_STF_CNT_7_1) AS MOP_STF_CNT_4_1,
			      	A.MOP_STF_CNT_5_1, A.MOP_STF_CNT_6_1, A.MOP_STF_CNT_7_1,
			      	(A.MOP_STF_CNT_1_1 - (A.MOP_STF_CNT_2_1+A.MOP_STF_CNT_3_1+A.MOP_STF_CNT_5_1+A.MOP_STF_CNT_6_1+A.MOP_STF_CNT_7_1)) AS MOP_STF_CNT_8_1,
			       
			      	A.NOMOP_TMPTR_STF_CNT_1_1, A.NOMOP_TMPTR_STF_CNT_2_1, A.NOMOP_TMPTR_STF_CNT_3_1, A.NOMOP_TMPTR_STF_CNT_4_1,
			      	A.NOMOP_TMPTR_STF_CNT_5_1, A.NOMOP_TMPTR_STF_CNT_6_1, A.NOMOP_TMPTR_STF_CNT_7_1, 
			      	(A.NOMOP_TMPTR_STF_CNT_1_1 - (A.NOMOP_TMPTR_STF_CNT_2_1+A.NOMOP_TMPTR_STF_CNT_3_1+ A.NOMOP_TMPTR_STF_CNT_4_1)) AS NOMOP_TMPTR_STF_CNT_8_1,
			       
			      	A.OW_ATC_ASO_CNT_1_1, A.OW_ATC_ASO_CNT_2_1, A.OW_ATC_ASO_CNT_3_1, (OW_ATC_ASO_CNT_5_1+OW_ATC_ASO_CNT_6_1+OW_ATC_ASO_CNT_7_1) AS OW_ATC_ASO_CNT_4_1,
			      	A.OW_ATC_ASO_CNT_5_1, A.OW_ATC_ASO_CNT_6_1, A.OW_ATC_ASO_CNT_7_1, 
			      	(A.OW_ATC_ASO_CNT_1_1 - (A.OW_ATC_ASO_CNT_2_1 +OW_ATC_ASO_CNT_5_1+OW_ATC_ASO_CNT_6_1+OW_ATC_ASO_CNT_7_1)) AS OW_ATC_ASO_CNT_8_1,
			      	
					B.WRIT_DT AS WRIT_DT
					,NVL(B.NOP_CNT_1,0) AS NOP_CNT_1
					,NVL(B.NOP_CNT_2,0) AS NOP_CNT_2
					,NVL(B.NOP_CNT_3,0) AS NOP_CNT_3
					,NVL(B.NOP_CNT_4,0) AS NOP_CNT_4
					,NVL(B.NOP_CNT_5,0) AS NOP_CNT_5
					,NVL(B.NOP_CNT_6,0) AS NOP_CNT_6
					,NVL(B.NOP_CNT_7,0) AS NOP_CNT_7
					,NVL(B.NOP_CNT_8,0) AS NOP_CNT_8
					,NVL(B.MOP_STF_CNT_1,0) AS MOP_STF_CNT_1
					,NVL(B.MOP_STF_CNT_2,0) AS MOP_STF_CNT_2
					,NVL(B.MOP_STF_CNT_3,0) AS MOP_STF_CNT_3
					,NVL(B.MOP_STF_CNT_4,0) AS MOP_STF_CNT_4
					,NVL(B.MOP_STF_CNT_5,0) AS MOP_STF_CNT_5
					,NVL(B.MOP_STF_CNT_6,0) AS MOP_STF_CNT_6
					,NVL(B.MOP_STF_CNT_7,0) AS MOP_STF_CNT_7
					,NVL(B.MOP_STF_CNT_8,0) AS MOP_STF_CNT_8
					,NVL(B.NOMOP_TMPTR_STF_CNT_1,0) AS NOMOP_TMPTR_STF_CNT_1
					,NVL(B.NOMOP_TMPTR_STF_CNT_2,0) AS NOMOP_TMPTR_STF_CNT_2
					,NVL(B.NOMOP_TMPTR_STF_CNT_3,0) AS NOMOP_TMPTR_STF_CNT_3
					,NVL(B.NOMOP_TMPTR_STF_CNT_4,0) AS NOMOP_TMPTR_STF_CNT_4
					,NVL(B.NOMOP_TMPTR_STF_CNT_5,0) AS NOMOP_TMPTR_STF_CNT_5
					,NVL(B.NOMOP_TMPTR_STF_CNT_6,0) AS NOMOP_TMPTR_STF_CNT_6
					,NVL(B.NOMOP_TMPTR_STF_CNT_7,0) AS NOMOP_TMPTR_STF_CNT_7
					,NVL(B.NOMOP_TMPTR_STF_CNT_8,0) AS NOMOP_TMPTR_STF_CNT_8
					,NVL(B.OW_ATC_ASO_CNT_1,0) AS OW_ATC_ASO_CNT_1
					,NVL(B.OW_ATC_ASO_CNT_2,0) AS OW_ATC_ASO_CNT_2
					,NVL(B.OW_ATC_ASO_CNT_3,0) AS OW_ATC_ASO_CNT_3
					,NVL(B.OW_ATC_ASO_CNT_4,0) AS OW_ATC_ASO_CNT_4
					,NVL(B.OW_ATC_ASO_CNT_5,0) AS OW_ATC_ASO_CNT_5
					,NVL(B.OW_ATC_ASO_CNT_6,0) AS OW_ATC_ASO_CNT_6
					,NVL(B.OW_ATC_ASO_CNT_7,0) AS OW_ATC_ASO_CNT_7
					,NVL(B.OW_ATC_ASO_CNT_8,0) AS OW_ATC_ASO_CNT_8
					,B.NOP_MDF_DH AS NOP_MDF_DH
			  FROM (
			       SELECT
			  		(SELECT #writDt# AS WRIT_DT FROM DUAL ) AS WRIT_DT ,
					(/*  당원직원 총원  */
					SELECT COUNT(*) 
					  FROM TBDCMACM001M T1
					  		,TBDCMACM002M T2 
					 WHERE 1=1
					   AND T1.DPT_CD <> '880880'
					   AND T1.DPT_CD = T2.DPT_CD
					   AND T2.LOC_DVSN_CD = 'I'
					   AND T1.CRNT_DPT_APM_DT IS NOT NULL
					   AND T1.USR_ID NOT LIKE 'test%'
					   AND T1.WOK_DVSN_CD LIKE 'A%'
					   AND T1.RQS_STA_CD = '3'
					   AND T1.USR_DVSN_CD = '1'
					) AS MOP_STF_CNT_1_1,
					
					(/* 당원직원 감사출장  */
					SELECT COUNT(1) FROM (
					SELECT DISTINCT B.PCT_CNB
					  FROM TBBADDED002M A, TBBADDED011L B, TBDCMACM002M C, TBDCMACM001M D
					 WHERE 1=1
					   AND A.BZT_YR = B.BZT_YR
					   AND A.BZT_SNO = B.BZT_SNO
					   AND B.BZT_STR_DT <= #writDt#
					   AND B.BZT_END_DT >= #writDt# 
					   AND A.BZT_DVSN_CD = '1'
					   AND B.PCT_CNB = D.CNB
					   AND D.DPT_CD = C.DPT_CD
					   AND LOC_DVSN_CD = 'I'
					   AND DPT_TP_CD_2 = 'A'
					   AND D.USR_DVSN_CD ='1' )
					) AS MOP_STF_CNT_2_1,
					   
					(/* 당원직원 일반출장  */
					SELECT COUNT(1) FROM (
					SELECT DISTINCT B.PCT_CNB
					  FROM TBBADDED002M A, TBBADDED011L B, TBDCMACM002M C, TBDCMACM001M D
					 WHERE 1=1
					   AND A.BZT_YR = B.BZT_YR
					   AND A.BZT_SNO = B.BZT_SNO
					   AND B.BZT_STR_DT <= #writDt#
					   AND B.BZT_END_DT >= #writDt# 
					   AND A.BZT_DVSN_CD = '2'
					   AND B.PCT_CNB = D.CNB
					   AND D.DPT_CD = C.DPT_CD
					   AND LOC_DVSN_CD = 'I'
					   AND DPT_TP_CD_2 = 'A'
					   AND D.USR_DVSN_CD ='1' )
					) AS MOP_STF_CNT_3_1,
					   
					(/* 파견  */
					SELECT COUNT(*)
					  FROM TBDCMACM001M T1, TBDCMACM002M T2
					 WHERE WOK_DVSN_CD LIKE 'AAB'
                     AND T1.DPT_CD = T2.DPT_CD 
                     AND T1.RQS_STA_CD = '3'
                     AND T2.LOC_DVSN_CD = 'I'
                     AND USR_DVSN_CD ='1'
                     ) AS MOP_STF_CNT_5_1,
					   
					(/* 휴가자 */
					SELECT COUNT(1)
					  FROM TBDCMACM001M T1, TBDCMACM002M T2
					 WHERE VAC_YN = 'Y'
                     AND T1.DPT_CD = T2.DPT_CD
                     AND T1.RQS_STA_CD = '3' 
                     AND T2.LOC_DVSN_CD = 'I'
                     AND USR_DVSN_CD ='1'
                     ) AS MOP_STF_CNT_6_1,
					
					(/* 휴직자 */
					SELECT COUNT(*)
					  FROM TBDCMACM001M T1 , TBDCMACM002M T2
					 WHERE WOK_DVSN_CD LIKE 'AB%'
                     AND T1.DPT_CD = T2.DPT_CD
                      AND T1.RQS_STA_CD = '3' 
                     AND T2.LOC_DVSN_CD = 'I'
                     AND T1.USR_DVSN_CD ='1'
                     ) AS MOP_STF_CNT_7_1,
					
					(/* 수견  */   
					SELECT COUNT(1)
					  FROM TBDCMACM001M T1 , TBDCMACM002M T2
					 WHERE T1.DPT_CD = T2.DPT_CD
					   AND RQS_STA_CD = '3'
					   AND     USR_DVSN_CD = '2'
					  AND T2.LOC_DVSN_CD = 'I'
					 ) AS NOMOP_TMPTR_STF_CNT_1_1,
					   
					(/* 수견 감사출장  */   
					SELECT COUNT(1) FROM (
					SELECT DISTINCT B.PCT_CNB
					  FROM TBBADDED002M A, TBBADDED011L B, TBDCMACM002M C, TBDCMACM001M D
					 WHERE 1=1
					   AND A.BZT_YR = B.BZT_YR
					   AND A.BZT_SNO = B.BZT_SNO
					   AND B.BZT_STR_DT <= #writDt#
					   AND B.BZT_END_DT >= #writDt# 
					   AND A.BZT_DVSN_CD = '1'
					   AND B.PCT_CNB = D.CNB
					   AND D.DPT_CD = C.DPT_CD
					   AND LOC_DVSN_CD = 'I'
					   AND DPT_TP_CD_2 = 'A'
					   AND D.USR_DVSN_CD ='2' )) AS NOMOP_TMPTR_STF_CNT_2_1,
					   
					(/* 수견 일반출장  */   
					SELECT COUNT(1) FROM (
					SELECT DISTINCT B.PCT_CNB
					  FROM TBBADDED002M A, TBBADDED011L B, TBDCMACM002M C, TBDCMACM001M D
					 WHERE 1=1
					   AND A.BZT_YR = B.BZT_YR
					   AND A.BZT_SNO = B.BZT_SNO
					   AND B.BZT_STR_DT <= #writDt#
					   AND B.BZT_END_DT >= #writDt# 
					   AND A.BZT_DVSN_CD = '2'
					   AND B.PCT_CNB = D.CNB
					   AND D.DPT_CD = C.DPT_CD
					   AND LOC_DVSN_CD = 'I'
					   AND DPT_TP_CD_2 = 'A'
					   AND D.USR_DVSN_CD ='2' )
					) AS NOMOP_TMPTR_STF_CNT_3_1,
					0 AS NOMOP_TMPTR_STF_CNT_4_1,
					0 AS NOMOP_TMPTR_STF_CNT_5_1,
					0 AS NOMOP_TMPTR_STF_CNT_6_1,
					0 AS NOMOP_TMPTR_STF_CNT_7_1,
					(/* 사무 보조원 등(차출)  */
					SELECT COUNT(1) 
					  FROM TBDCMACM001M T1, TBDCMACM002M T2
					 WHERE T1.DPT_CD = T2.DPT_CD AND T1.USR_DVSN_CD IN ('3','4')
					   AND RQS_STA_CD = '3'
					   AND UPPER(USR_ID) NOT LIKE 'TEST%'
                        AND T2.LOC_DVSN_CD = 'I'
					) AS OW_ATC_ASO_CNT_1_1,
					
					0 AS OW_ATC_ASO_CNT_2_1,
					0 AS OW_ATC_ASO_CNT_3_1,
					0 AS OW_ATC_ASO_CNT_4_1,
					(SELECT COUNT(*) 
                FROM    TBDCMACM909O
                WHERE   WOK_DVSN_CD LIKE 'AAB%') AS OW_ATC_ASO_CNT_5_1,
					0 AS OW_ATC_ASO_CNT_6_1,
					(SELECT COUNT(*)
                FROM TBDCMACM909O
                WHERE   WOK_DVSN_CD LIKE 'AB%') AS OW_ATC_ASO_CNT_7_1
					FROM DUAL
			) A, TBCSPMWF001M B
			WHERE A.WRIT_DT = B.WRIT_DT(+)
			AND B.WRIT_DT(+) = #writDt#
		]]>
	</select>
	
	<insert id="CSPMWF024ENopInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPMWF001M
			(
				WRIT_DT
				,NOP_CNT_1
				,NOP_CNT_2
				,NOP_CNT_3
				,NOP_CNT_4
				,NOP_CNT_5
				,NOP_CNT_6
				,NOP_CNT_7
				,NOP_CNT_8
				,MOP_STF_CNT_1
				,MOP_STF_CNT_2
				,MOP_STF_CNT_3
				,MOP_STF_CNT_4
				,MOP_STF_CNT_5
				,MOP_STF_CNT_6
				,MOP_STF_CNT_7
				,MOP_STF_CNT_8
				,NOMOP_TMPTR_STF_CNT_1
				,NOMOP_TMPTR_STF_CNT_2
				,NOMOP_TMPTR_STF_CNT_3
				,NOMOP_TMPTR_STF_CNT_4
				,NOMOP_TMPTR_STF_CNT_5
				,NOMOP_TMPTR_STF_CNT_6
				,NOMOP_TMPTR_STF_CNT_7
				,NOMOP_TMPTR_STF_CNT_8
				,OW_ATC_ASO_CNT_1
				,OW_ATC_ASO_CNT_2
				,OW_ATC_ASO_CNT_3
				,OW_ATC_ASO_CNT_4
				,OW_ATC_ASO_CNT_5
				,OW_ATC_ASO_CNT_6
				,OW_ATC_ASO_CNT_7
				,OW_ATC_ASO_CNT_8
				,NOP_MDF_DH
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
			)
			VALUES
			(
				#WRIT_DT_1#
				,#NOP_CNT_1_1#
				,#NOP_CNT_2_1#
				,#NOP_CNT_3_1#
				,#NOP_CNT_4_1#
				,#NOP_CNT_5_1#
				,#NOP_CNT_6_1#
				,#NOP_CNT_7_1#
				,#NOP_CNT_8_1#
				,#MOP_STF_CNT_1_1#
				,#MOP_STF_CNT_2_1#
				,#MOP_STF_CNT_3_1#
				,#MOP_STF_CNT_4_1#
				,#MOP_STF_CNT_5_1#
				,#MOP_STF_CNT_6_1#
				,#MOP_STF_CNT_7_1#
				,#MOP_STF_CNT_8_1#
				,#NOMOP_TMPTR_STF_CNT_1_1#
				,#NOMOP_TMPTR_STF_CNT_2_1#
				,#NOMOP_TMPTR_STF_CNT_3_1#
				,#NOMOP_TMPTR_STF_CNT_4_1#
				,#NOMOP_TMPTR_STF_CNT_5_1#
				,#NOMOP_TMPTR_STF_CNT_6_1#
				,#NOMOP_TMPTR_STF_CNT_7_1#
				,#NOMOP_TMPTR_STF_CNT_8_1#
				,#OW_ATC_ASO_CNT_1_1#
				,#OW_ATC_ASO_CNT_2_1#
				,#OW_ATC_ASO_CNT_3_1#
				,#OW_ATC_ASO_CNT_4_1#
				,#OW_ATC_ASO_CNT_5_1#
				,#OW_ATC_ASO_CNT_6_1#
				,#OW_ATC_ASO_CNT_7_1#
				,#OW_ATC_ASO_CNT_8_1#
				,TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI')
				,#FRT_USR_ID#
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
				,SYSDATE
				,SYSDATE
			)
		]]>
	</insert>
	
	<update id="CSPMWF024ENopUpdate" parameterClass="paramMap" >
		<![CDATA[
			UPDATE TBCSPMWF001M
			   SET FNL_USR_ID = #FNL_USR_ID#
				,NOP_CNT_1 = #NOP_CNT_1_1#
				,NOP_CNT_2 = #NOP_CNT_2_1#
				,NOP_CNT_3 = #NOP_CNT_3_1#
				,NOP_CNT_4 = #NOP_CNT_4_1#
				,NOP_CNT_5 = #NOP_CNT_5_1#
				,NOP_CNT_6 = #NOP_CNT_6_1#
				,NOP_CNT_7 = #NOP_CNT_7_1#
				,NOP_CNT_8 = #NOP_CNT_8_1#
				,MOP_STF_CNT_1 = #MOP_STF_CNT_1_1#
				,MOP_STF_CNT_2 = #MOP_STF_CNT_2_1#
				,MOP_STF_CNT_3 = #MOP_STF_CNT_3_1#
				,MOP_STF_CNT_4 = #MOP_STF_CNT_4_1#
				,MOP_STF_CNT_5 = #MOP_STF_CNT_5_1#
				,MOP_STF_CNT_6 = #MOP_STF_CNT_6_1#
				,MOP_STF_CNT_7 = #MOP_STF_CNT_7_1#
				,MOP_STF_CNT_8 = #MOP_STF_CNT_8_1#
				,NOMOP_TMPTR_STF_CNT_1 = #NOMOP_TMPTR_STF_CNT_1_1#
				,NOMOP_TMPTR_STF_CNT_2 = #NOMOP_TMPTR_STF_CNT_2_1#
				,NOMOP_TMPTR_STF_CNT_3 = #NOMOP_TMPTR_STF_CNT_3_1#
				,NOMOP_TMPTR_STF_CNT_4 = #NOMOP_TMPTR_STF_CNT_4_1#
				,NOMOP_TMPTR_STF_CNT_5 = #NOMOP_TMPTR_STF_CNT_5_1#
				,NOMOP_TMPTR_STF_CNT_6 = #NOMOP_TMPTR_STF_CNT_6_1#
				,NOMOP_TMPTR_STF_CNT_7 = #NOMOP_TMPTR_STF_CNT_7_1#
				,NOMOP_TMPTR_STF_CNT_8 = #NOMOP_TMPTR_STF_CNT_8_1#
				,OW_ATC_ASO_CNT_1 = #OW_ATC_ASO_CNT_1_1#
				,OW_ATC_ASO_CNT_2 = #OW_ATC_ASO_CNT_2_1#
				,OW_ATC_ASO_CNT_3 = #OW_ATC_ASO_CNT_3_1#
				,OW_ATC_ASO_CNT_4 = #OW_ATC_ASO_CNT_4_1#
				,OW_ATC_ASO_CNT_5 = #OW_ATC_ASO_CNT_5_1#
				,OW_ATC_ASO_CNT_6 = #OW_ATC_ASO_CNT_6_1#
				,OW_ATC_ASO_CNT_7 = #OW_ATC_ASO_CNT_7_1#
				,OW_ATC_ASO_CNT_8 = #OW_ATC_ASO_CNT_8_1#
				,NOP_MDF_DH = TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI')
				,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID = #FNL_MNU_ID#
				,FNL_MDF_DH = SYSDATE
			 WHERE WRIT_DT = #WRIT_DT_1#
		]]>
	</update>
	
	<select id="CSPMWF022ESelectExcelDown" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
			SELECT 	WRIT_DT, NOP_CNT_8 
			FROM	TBCSPMWF001M
			WHERE 	1=1
			AND 	WRIT_DT > TO_CHAR(TO_DATE(#writDt#) - 31, 'YYYYMMDD')
			ORDER BY WRIT_DT DESC
		]]>
	</select>
	
</sqlMap>