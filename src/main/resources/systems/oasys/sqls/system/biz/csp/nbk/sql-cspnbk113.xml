<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="csp/nbk/113">
	
	<select id="CSPNBK113EMnstCluListSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		SELECT	/* CSPNBK113EMnstCluListSelect */
				SUBSTR(D1.MNST_CLU_CD, 1, 1) AS MNST_CLU_CD_1
				, SUBSTR(D1.MNST_CLU_CD, 2, 1) AS MNST_CLU_CD_2
				, SUBSTR(D1.MNST_CLU_CD, 3, 2) AS MNST_CLU_CD_3
				, SUBSTR(D1.MNST_CLU_CD, 5, 2) AS MNST_CLU_CD_4
				, D1.TAX_SITM_CD
				, D1.ACCT_NM
				, D1.SMB_YN
		FROM	TBCSPNBK501M D1
	]]>
		<dynamic prepend="WHERE">
			<isNotEmpty property="mnstCluCd" prepend="AND">
				D1.MNST_CLU_CD = #mnstCluCd#
			</isNotEmpty>
			<isNotEmpty property="taxSitmCd" prepend="AND">
				D1.TAX_SITM_CD = #taxSitmCd#
			</isNotEmpty>
			<isNotEmpty property="acctNm" prepend="AND">
				D1.ACCT_NM LIKE '%' || #acctNm# || '%'
			</isNotEmpty>
		</dynamic>
	<![CDATA[
		ORDER BY D1.MNST_CLU_CD, D1.TAX_SITM_CD
	]]>
	</select>
	
	<insert id="CSPNBK113EMnstCluInsert" parameterClass="paramMap">
	<![CDATA[
		INSERT INTO /* CSPNBK113EMnstCluInsert */ TBCSPNBK501M
		(
			MNST_CLU_CD
			, TAX_SITM_CD
			, ACCT_NM
			, SMB_YN
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			, FNL_MDF_DH
		)
		VALUES
		(
			#MNST_CLU_CD_1# || #MNST_CLU_CD_2# || #MNST_CLU_CD_3# || #MNST_CLU_CD_4#
			, #TAX_SITM_CD#
			, #ACCT_NM#
			, #SMB_YN#
			, #FRT_USR_ID#
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
			, SYSDATE
			, SYSDATE
		)
	]]>
	</insert>
	
	<update id="CSPNBK113EMnstCluUpdate" parameterClass="paramMap">
	<![CDATA[
		UPDATE	/* CSPNBK113EMnstCluUpdate */ TBCSPNBK501M
		SET		ACCT_NM = #ACCT_NM#
				, SMB_YN = #SMB_YN#
				, FNL_USR_ID = #FNL_USR_ID#
				, FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				, FNL_MNU_ID = #FNL_MNU_ID#
				, FNL_MDF_DH = SYSDATE
		WHERE	MNST_CLU_CD = #MNST_CLU_CD_1# || #MNST_CLU_CD_2# || #MNST_CLU_CD_3# || #MNST_CLU_CD_4#
		AND		TAX_SITM_CD = #TAX_SITM_CD#
	]]>
	</update>
	
	<delete id="CSPNBK113EMnstCluDelete" parameterClass="paramMap">
	<![CDATA[
		DELETE	/* CSPNBK113EMnstCluDelete */
		FROM	TBCSPNBK501M
		WHERE	MNST_CLU_CD = #MNST_CLU_CD_1# || #MNST_CLU_CD_2# || #MNST_CLU_CD_3# || #MNST_CLU_CD_4#
		AND		TAX_SITM_CD = #TAX_SITM_CD#
	]]>
	</delete>
	
	<select id="CSPNBK113EMnstCluCdCheckSelect" parameterClass="paramMap" resultClass="int">
	<![CDATA[
		SELECT	/* CSPNBK113EMnstCluCdCheckSelect */
				COUNT(D1.MNST_CLU_CD) AS CNT
		FROM	TBCSPNBK501M D1
		WHERE	D1.MNST_CLU_CD = #MNST_CLU_CD_1# || #MNST_CLU_CD_2# || #MNST_CLU_CD_3# || #MNST_CLU_CD_4#
		AND		D1.TAX_SITM_CD = #TAX_SITM_CD#
	]]>
	</select>
	
	<select id="CSPNBK113EMnstCluCheckSelect" parameterClass="paramMap" resultClass="int">
	<![CDATA[
		SELECT	/* CSPNBK113EMnstCluCheckSelect */
				SUM(CNT) AS CNT
		FROM	(
					SELECT	COUNT(D1.MNST_CLU_CD) AS CNT
					FROM	TBCSPNBK502M D1
					WHERE	D1.MNST_CLU_CD = #MNST_CLU_CD_1# || #MNST_CLU_CD_2# || #MNST_CLU_CD_3# || #MNST_CLU_CD_4#
					AND		D1.TAX_SITM_CD = #TAX_SITM_CD#
					
					UNION ALL
					
					SELECT	COUNT(D1.CRDT_MNST_CLU_CD) AS CNT
					FROM	TBCSPNBK301M D1
					WHERE	(	( D1.CRDT_MNST_CLU_CD = #MNST_CLU_CD_1# || #MNST_CLU_CD_2# || #MNST_CLU_CD_3# || #MNST_CLU_CD_4#
									AND D1.CRDT_TAX_SITM_CD = #TAX_SITM_CD# )
								OR ( D1.DS_MNST_CLU_CD = #MNST_CLU_CD_1# || #MNST_CLU_CD_2# || #MNST_CLU_CD_3# || #MNST_CLU_CD_4#
									AND D1.DS_TAX_SITM_CD = #TAX_SITM_CD# )
							)
					
					UNION ALL
					
					SELECT	COUNT(D1.CRDT_MNST_CLU_CD) AS CNT
					FROM	TBCSPNBK302L D1
					WHERE	(	( D1.CRDT_MNST_CLU_CD = #MNST_CLU_CD_1# || #MNST_CLU_CD_2# || #MNST_CLU_CD_3# || #MNST_CLU_CD_4#
									AND D1.CRDT_TAX_SITM_CD = #TAX_SITM_CD# )
								OR ( D1.DS_MNST_CLU_CD = #MNST_CLU_CD_1# || #MNST_CLU_CD_2# || #MNST_CLU_CD_3# || #MNST_CLU_CD_4#
									AND D1.DS_TAX_SITM_CD = #TAX_SITM_CD# )
							)
				)
	]]>
	</select>
</sqlMap>