<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/bii/412">
	<!-- 기타감찰자료 상세조회 맵 -->
	<resultMap class="java.util.HashMap" id="CSPBII412EMainSelectMap">
		<result property="MTRL_NO"						column="MTRL_NO" 					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ACP_DT"						column="ACP_DT" 					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="REL_ORG_CD"					column="REL_ORG_CD" 				jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="REL_ORG_NM"					column="REL_ORG_NM"					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ETC_INSP_MTRL_CLC_DVSN_CD"	column="ETC_INSP_MTRL_CLC_DVSN_CD"	jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CLC_RUT_NM"					column="CLC_RUT_NM"					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="REGI_USR"						column="REGI_USR"					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="TIT_NM"						column="TIT_NM" 					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="ETC_INSP_MTRL_TXT"			column="ETC_INSP_MTRL_TXT"			jdbcType="CLOB"		javaType="java.lang.String"/>
		<result property="YE"							column="YE"							jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="SRNO"							column="SRNO"						jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="DOC_ID"						column="DOC_ID"						jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="REGI_CNB"						column="REGI_CNB"					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="INSP_INFO_STAT_CD"			column="INSP_INFO_STAT_CD"			jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CHAR_DEPT_CD"					column="CHAR_DEPT_CD"				jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="CHAR_CNB"						column="CHAR_CNB"					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="HST_DT"						column="HST_DT"						jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="HST_SMM_TXT"					column="HST_SMM_TXT"				jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="FRT_USR_ID"					column="FRT_USR_ID"					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="INF_TYP"						column="INF_TYP"					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="HNDL_DIRC"					column="HNDL_DIRC"					jdbcType="VARCHAR2" javaType="java.lang.String"/>
		<result property="HNDL_RSLT"					column="HNDL_RSLT"					jdbcType="VARCHAR2" javaType="java.lang.String"/>
	</resultMap>
	
	<!-- 기타감찰자료 상세조회 -->   
	<select id="CSPBII412EMainSelect" parameterClass="paramMap" resultMap="CSPBII412EMainSelectMap">
		<![CDATA[       
			SELECT A.YE || '-' || LPAD(A.SRNO, 5, '0')         AS MTRL_NO		 
			     , A.ACP_DT
			     , A.REL_ORG_CD
			     , (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.REL_ORG_CD)           AS REL_ORG_NM 
			     , A.ETC_INSP_MTRL_CLC_DVSN_CD
			     , A.CLC_RUT_NM
			     , (SELECT B.USR_NAM || '(' || B.CNB || ')'
			          FROM TBDCMACM001M B
			         WHERE B.USR_ID = A.FRT_USR_ID)            AS REGI_USR
			     , A.TIT_NM
			     , A.ETC_INSP_MTRL_TXT
			     , A.YE
			     , A.SRNO    
			     ,(SELECT DOC_ID FROM TBCSPBII403L Z 
			 		WHERE Z.YE = A.YE 
			 		AND	Z.SRNO = A.SRNO) AS DOC_ID
			 	,(SELECT  B.CNB
			          FROM TBDCMACM001M B
			         WHERE B.USR_ID = A.FRT_USR_ID)            AS REGI_CNB
			    , A.INSP_INFO_STAT_CD
			    , A.CHAR_DEPT_CD
			    , A.CHAR_CNB
			    , A.HST_DT
			    , A.HST_SMM_TXT
			    , A.INF_TYP 
			    , A.HNDL_DIRC 
			    , A.HNDL_RSLT
			    , A.FRT_USR_ID
			  FROM TBCSPBII400L A  /* 기타감찰자료정보내역 */
			 WHERE 1=1
		]]>
		<isNotEmpty property="strYe">
		AND A.YE   = #strYe#
		</isNotEmpty>
		<isNotEmpty property="strSrno">
		AND A.SRNO   = #strSrno#
		</isNotEmpty>
		
		<!-- 연도/일련번호 리스트(직무역량 출력 팝업화면에서 사용)-->
		<isNotEmpty property="strYeList">
			AND (A.YE, A.SRNO) IN (SELECT REGEXP_SUBSTR(#strYeList#, '[^||]+', 1, LEVEL)
                                        , REGEXP_SUBSTR(#strSrnoList#, '[^||]+', 1, LEVEL)
                                     FROM DUAL
                                   CONNECT BY LEVEL &lt;= REGEXP_COUNT(#strYeList#, '[^|]+'))
		</isNotEmpty>
	
		
	</select>
	
	<select id="CSPBII412ESubSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[       
			SELECT A.REL_PEN_NM
			     , A.EIN
			     , A.BLT_ORG_CD
			     , (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.BLT_ORG_CD) AS BLT_ORG_NM
			     , A.PST_NM
			     , A.RANK_NM
			     , A.YE
			     , A.SRNO
			     , A.REL_PEN_SNO    
			  FROM TBCSPBII401L A  /* 기타감찰자료정보내역 */
			 WHERE A.YE   = #strYe#
			   AND A.SRNO = #strSrno#
			ORDER BY A.REL_PEN_SNO
		]]>
	</select>
	
	<!-- 기타감찰자료내역 키 생성 -->
	<select id="CSPBII412EMainKeyValueSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[       
			SELECT TO_CHAR(SYSDATE, 'YYYY')               AS YE
			     , (SELECT NVL(MAX(SRNO), 0) + 1
		              FROM TBCSPBII400L
		             WHERE YE = TO_CHAR(SYSDATE, 'YYYY')) AS SRNO 
		      FROM DUAL
		]]>
	</select>
		
	<!-- 기타감찰자료내역 등록  -->
	<insert id="CSPBII412EinsertMain" parameterClass="paramMap">
		INSERT INTO TBCSPBII400L (
		                          YE              /* 암호화주민등록번호 */
		                        , SRNO            /* 생년월일 */
		                        , ACP_DT          /* 성명 */
		                        , REL_ORG_CD      /* 한자성명 */
		                        , ETC_INSP_MTRL_CLC_DVSN_CD      /* 소속기관코드 */
		                        , CLC_RUT_NM      /* 계급코드 */
		                        , TIT_NM          /* 직무등급코드 */
		                        , ETC_INSP_MTRL_TXT 
		                        , FRT_USR_ID      /* 최초사용자ID */
		                        , FNL_USR_ID      /* 최종사용자ID */
		                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
		                        , FNL_MNU_ID      /* 최종메뉴ID */
		                        , FRT_REGI_DH     /* 최초등록일시 */
		                        , FNL_MDF_DH      /* 최종수정일시 */
		                        , INSP_INFO_STAT_CD  /* 상태코드값 */
		     					, CHAR_DEPT_CD       /* 담당부서 */
		     					, CHAR_CNB           /* 담당자 */
		     					, INF_TYP
		     					, HNDL_DIRC
		     					, HNDL_RSLT
		                         ) 
		                  VALUES (
		                          #YE#
		                        , #SRNO#
		                        , #ACP_DT#
		                        , #REL_ORG_CD#
		                        , #ETC_INSP_MTRL_CLC_DVSN_CD#
		                        , #CLC_RUT_NM#
		                        , #TIT_NM#
		                        , #ETC_INSP_MTRL_TXT#
		                        , #FRT_USR_ID#
		                        , #FNL_USR_ID#
		                        , #FNL_DEAL_DPT_CD#
		                        , #FNL_MNU_ID#
		                        , SYSDATE
		                        , SYSDATE
		                        , #INSP_INFO_STAT_CD#
		                        , #CHAR_DEPT_CD#
		                        , #CHAR_CNB#
		                        , #INF_TYP#
		                        , #HNDL_DIRC#
		                        , #HNDL_RSLT#
				                 )
	</insert>
	
	<!-- 기타감찰자료내역 수정 -->
	<update id="CSPBII412EupdateMain" parameterClass="paramMap">
		UPDATE TBCSPBII400L                       
		   SET REL_ORG_CD                = #REL_ORG_CD#               /* 암호화주민등록번호 */
		     , ETC_INSP_MTRL_CLC_DVSN_CD = #ETC_INSP_MTRL_CLC_DVSN_CD# /* 생년월일 */
		     , CLC_RUT_NM                = #CLC_RUT_NM#               /* 성명 */
		     , TIT_NM                    = #TIT_NM#           /* 한자성명 */		     	
		     , ETC_INSP_MTRL_TXT         = #ETC_INSP_MTRL_TXT#	    
		     , FNL_USR_ID                = #FNL_USR_ID#        /* 최종사용자ID */
		     , FNL_DEAL_DPT_CD           = #FNL_DEAL_DPT_CD#   /* 최종거래부서코드 */
		     , FNL_MNU_ID                = #FNL_MNU_ID#        /* 최종메뉴ID */
		     , FNL_MDF_DH                = SYSDATE             /* 최종수정일시 */
		     , INSP_INFO_STAT_CD         = #INSP_INFO_STAT_CD# /* 상태코드값 */
		     , CHAR_DEPT_CD              = #CHAR_DEPT_CD#      /* 담당부서 */
		     , CHAR_CNB                  = #CHAR_CNB#          /* 담당자 */
		     , HST_DT                    = #HST_DT#            /* 이력일 */
		     , HST_SMM_TXT               = #HST_SMM_TXT#       /* 이력요약 */
		     , INF_TYP                   = #INF_TYP#           /* 정보유형 */
		     , HNDL_DIRC                 = #HNDL_DIRC#         /* 처리지시 */
		     , HNDL_RSLT                 = #HNDL_RSLT#         /* 처리결과 */
		     , ACP_DT                    = #ACP_DT#            /* 입력일자 */
		 WHERE YE = #YE#
		   AND SRNO = #SRNO#
	</update>
	
	<!-- 기타감찰자료내역 삭제 -->
	<delete id="CSPBII412EdeleteMain" parameterClass="paramMap">
		DELETE TBCSPBII400L
		 WHERE YE   = #YE#
		   AND SRNO = #SRNO#		   
	</delete>
	
	<!-- 기타감찰자료관련자내역 등록  -->
	<insert id="CSPBII412EinsertSub" parameterClass="paramMap">
		INSERT INTO TBCSPBII401L (
		                          YE             /* 암호화주민등록번호 */
		                        , SRNO            /* 생년월일 */
		                        , REL_PEN_SNO             /* 성명 */
		                        , EIN         /* 한자성명 */
		                        , REL_PEN_NM /* */
		                        , BLT_ORG_CD      /* 소속기관코드 */
		                        , RANK_NM         /* 계급코드 */
		                        , PST_NM       /* 직무등급코드 */               
		                        , FRT_USR_ID      /* 최초사용자ID */
		                        , FNL_USR_ID      /* 최종사용자ID */
		                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
		                        , FNL_MNU_ID      /* 최종메뉴ID */
		                        , FRT_REGI_DH     /* 최초등록일시 */
		                        , FNL_MDF_DH      /* 최종수정일시 */
		                         ) 
		                  VALUES (
		                          #YE#
		                        , #SRNO#
		                        , (SELECT NVL(MAX(REL_PEN_SNO), 0) + 1
		                             FROM TBCSPBII401L
		                            WHERE YE   = #YE#
		                              AND SRNO = #SRNO#)
		                        , #EIN#
		                        , #REL_PEN_NM#
		                        , #BLT_ORG_CD#
		                        , #RANK_NM#
		                        , #PST_NM#	                        		                      
		                        , #FRT_USR_ID#
		                        , #FNL_USR_ID#
		                        , #FNL_DEAL_DPT_CD#
		                        , #FNL_MNU_ID#
		                        , SYSDATE
		                        , SYSDATE
				                 )
	</insert>
	
	<!-- 기본정보 수정 -->
	<update id="CSPBII412EupdateSub" parameterClass="paramMap">
		UPDATE TBCSPBII401L                       
		   SET EIN             = #EIN#               /* 암호화주민등록번호 */
		     , REL_PEN_NM      = #REL_PEN_NM#        /* 관련자명 */
		     , BLT_ORG_CD      = #BLT_ORG_CD#        /* 소속기관코드 */
		     , RANK_NM         = #RANK_NM#           /* 직급명 */		     		    
		     , PST_NM          = #PST_NM#            /* 직위명 */
		     , FNL_USR_ID      = #FNL_USR_ID#        /* 최종사용자ID */
		     , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#   /* 최종거래부서코드 */
		     , FNL_MNU_ID      = #FNL_MNU_ID#        /* 최종메뉴ID */
		     , FNL_MDF_DH      = SYSDATE             /* 최종수정일시 */
		 WHERE YE          = #YE#
		   AND SRNO        = #SRNO#
		   AND REL_PEN_SNO = #REL_PEN_SNO#
	</update>
	
	<!-- 기본정보 삭제 -->
	<delete id="CSPBII412EdeleteSub" parameterClass="paramMap">
		DELETE TBCSPBII401L
		 WHERE YE          = #YE#
		   AND SRNO        = #SRNO#	
		   AND REL_PEN_SNO = #REL_PEN_SNO#	   
	</delete>
	
	
	<insert id="CSPBII412ERqsFileInsert" parameterClass="paramMap">
        <![CDATA[
        	INSERT INTO TBCSPBII403L
        	(
        			YE,
        			SRNO,
        			DOC_ID,
        			FRT_USR_ID,
        			FNL_USR_ID,
        			FNL_DEAL_DPT_CD,
        			FNL_MNU_ID,
        			FRT_REGI_DH,
        			FNL_MDF_DH
        	) VALUES (
        			#YE#,
	        		#SRNO#,
	        		#DOC_ID#,
	        		#FRT_USR_ID#,
	        		#FNL_USR_ID#,
	        		#FNL_DEAL_DPT_CD#,
	        		#FNL_MNU_ID#,
	        		SYSDATE,
	        		SYSDATE
        	)
        ]]>
	</insert>
	
	
	<delete id="CSPBII412EFileDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE	
			FROM	TBCSPBII403L
			WHERE	YE = #YE#
			AND		SRNO = #SRNO#
		]]>
	</delete>
	
	
	
	<!-- 기타감찰자료이력 상세조회 -->   
	<select id="CSPBII412EMainHstSelect" parameterClass="paramMap" resultMap="CSPBII412EMainSelectMap">
		<![CDATA[       
			SELECT A.YE || '-' || LPAD(A.SRNO, 5, '0')         AS MTRL_NO		 
			     , A.ACP_DT
			     , A.REL_ORG_CD
			     , (SELECT B.ORG_NM
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.REL_ORG_CD)           AS REL_ORG_NM 
			     , A.ETC_INSP_MTRL_CLC_DVSN_CD
			     , A.CLC_RUT_NM
			     , (SELECT B.USR_NAM || '(' || B.CNB || ')'
			          FROM TBDCMACM001M B
			         WHERE B.USR_ID = A.FRT_USR_ID)            AS REGI_USR
			     , A.TIT_NM
			     , A.ETC_INSP_MTRL_TXT
			     , A.YE
			     , A.SRNO    
			     ,(SELECT DOC_ID FROM TBCSPBII403H Z 
			 		WHERE Z.YE = A.YE 
			 		AND	Z.SRNO = A.SRNO
			 		AND	Z.HST_DT = #strHstDt#) AS DOC_ID
			 	,(SELECT  B.CNB
			          FROM TBDCMACM001M B
			         WHERE B.USR_ID = A.FRT_USR_ID)            AS REGI_CNB
			    , A.INSP_INFO_STAT_CD
			    , A.CHAR_DEPT_CD
			    , A.CHAR_CNB
			    , A.HST_DT
			    , A.HST_SMM_TXT
			    , A.INF_TYP
		     	, A.HNDL_DIRC
		     	, A.HNDL_RSLT
		     	, A.FRT_USR_ID
			  FROM TBCSPBII400H A  /* 기타감찰자료정보내역 */
			 WHERE A.YE   = #strYe#
			   AND A.SRNO = #strSrno#
			   AND A.HST_DT = #strHstDt#
		]]>
	</select>
	
	
	
	<select id="CSPBII412EHstSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[       
			SELECT A.HST_DT AS CD 
			     , A.HST_DT AS CD_NM 
			  FROM TBCSPBII400H A  /* 기타감찰자료정보내역 */
			 WHERE A.YE   = #strYe#
			   AND A.SRNO = #strSrno#
			   ORDER BY A.HST_DT
		]]>
	</select>
	
	<!-- 기타감찰자료이력내역 등록  -->
	<insert id="CSPBII412EHstinsertMain" parameterClass="paramMap">
		INSERT INTO TBCSPBII400H (
		                          YE              /* 암호화주민등록번호 */
		                        , SRNO            /* 생년월일 */
		                        , ACP_DT          /* 성명 */
		                        , REL_ORG_CD      /* 한자성명 */
		                        , ETC_INSP_MTRL_CLC_DVSN_CD      /* 소속기관코드 */
		                        , CLC_RUT_NM      /* 계급코드 */
		                        , TIT_NM          /* 직무등급코드 */
		                        , ETC_INSP_MTRL_TXT 
		                        , FRT_USR_ID      /* 최초사용자ID */
		                        , FNL_USR_ID      /* 최종사용자ID */
		                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
		                        , FNL_MNU_ID      /* 최종메뉴ID */
		                        , FRT_REGI_DH     /* 최초등록일시 */
		                        , FNL_MDF_DH      /* 최종수정일시 */
		                        , INSP_INFO_STAT_CD  /* 상태코드값 */
		     					, CHAR_DEPT_CD       /* 담당부서 */
		     					, CHAR_CNB           /* 담당자 */
		     					, HST_DT
		     					, HST_SMM_TXT
							    , INF_TYP
						     	, HNDL_DIRC
						     	, HNDL_RSLT
		                         ) 
		 					SELECT 
		 						YE              /* 암호화주민등록번호 */
		                        , SRNO            /* 생년월일 */
		                        , ACP_DT          /* 성명 */
		                        , REL_ORG_CD      /* 한자성명 */
		                        , ETC_INSP_MTRL_CLC_DVSN_CD      /* 소속기관코드 */
		                        , CLC_RUT_NM      /* 계급코드 */
		                        , TIT_NM          /* 직무등급코드 */
		                        , ETC_INSP_MTRL_TXT 
		                        , FRT_USR_ID      /* 최초사용자ID */
		                        , FNL_USR_ID      /* 최종사용자ID */
		                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
		                        , FNL_MNU_ID      /* 최종메뉴ID */
		                        , FRT_REGI_DH     /* 최초등록일시 */
		                        , FNL_MDF_DH      /* 최종수정일시 */
		                        , INSP_INFO_STAT_CD  /* 상태코드값 */
		     					, CHAR_DEPT_CD       /* 담당부서 */
		     					, CHAR_CNB           /* 담당자 */
		     					, #HST_DT#
		     					, #HST_SMM_TXT#
							    , INF_TYP
						     	, HNDL_DIRC
						     	, HNDL_RSLT
						 FROM TBCSPBII400L 
						 WHERE   YE   = #YE#
		    				 AND SRNO = #SRNO# 
	</insert>
	
	<insert id="CSPBII412EHstinsertSub" parameterClass="paramMap">
		INSERT INTO TBCSPBII401H (
		                          YE             /* 암호화주민등록번호 */
		                        , SRNO           
		                        , HST_DT
		                        , REL_PEN_SNO            
		                        , EIN        
		                        , REL_PEN_NM 
		                        , BLT_ORG_CD      /* 소속기관코드 */
		                        , RANK_NM         /* 계급코드 */
		                        , PST_NM          /* 직무등급코드 */               
		                        , FRT_USR_ID      /* 최초사용자ID */
		                        , FNL_USR_ID      /* 최종사용자ID */
		                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
		                        , FNL_MNU_ID      /* 최종메뉴ID */
		                        , FRT_REGI_DH     /* 최초등록일시 */
		                        , FNL_MDF_DH      /* 최종수정일시 */
		                         ) 
		                         
						SELECT    YE            
		                        , SRNO   
		                        , (SELECT HST_DT FROM TBCSPBII400L WHERE YE = #YE#   AND SRNO = #SRNO# )      
		                        , REL_PEN_SNO 
		                        , EIN    
		                        , REL_PEN_NM
		                        , BLT_ORG_CD      /* 소속기관코드 */
		                        , RANK_NM         /* 계급코드 */
		                        , PST_NM       /* 직무등급코드 */               
		                        , FRT_USR_ID      /* 최초사용자ID */
		                        , FNL_USR_ID      /* 최종사용자ID */
		                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
		                        , FNL_MNU_ID      /* 최종메뉴ID */
		                        , FRT_REGI_DH     /* 최초등록일시 */
		                        , FNL_MDF_DH      /* 최종수정일시 */
		FROM 	TBCSPBII401L
		WHERE   YE   = #YE#
		    AND SRNO = #SRNO# 
	</insert>
	
	<insert id="CSPBII412ERqsHstFileInsert" parameterClass="paramMap">
        <![CDATA[
        	INSERT INTO TBCSPBII403H
        	(
        			YE,
        			SRNO,
        			HST_DT,
        			DOC_ID,
        			FRT_USR_ID,
        			FNL_USR_ID,
        			FNL_DEAL_DPT_CD,
        			FNL_MNU_ID,
        			FRT_REGI_DH,
        			FNL_MDF_DH
        	)
        	SELECT  YE,
        			SRNO,
        			#HST_DT#,
        			DOC_ID,
        			FRT_USR_ID,
        			FNL_USR_ID,
        			FNL_DEAL_DPT_CD,
        			FNL_MNU_ID,
        			FRT_REGI_DH,
        			FNL_MDF_DH
        	FROM TBCSPBII403L
        	 WHERE YE = #YE#
         	 AND SRNO = #SRNO#
        ]]>
	</insert>
	
	
	
	<!-- 기본정보 수정 -->
	<update id="CSPBII412EHstupdateSub" parameterClass="paramMap">
		UPDATE TBCSPBII401H                       
		   SET EIN             = #EIN#               /* 암호화주민등록번호 */
		     , REL_PEN_NM      = #REL_PEN_NM#        /* 관련자명 */
		     , HST_DT          = #HST_DT#            /* 관련자명 */
		     , BLT_ORG_CD      = #BLT_ORG_CD#        /* 소속기관코드 */
		     , RANK_NM         = #RANK_NM#           /* 직급명 */		     		    
		     , PST_NM          = #PST_NM#            /* 직위명 */
		     , FNL_USR_ID      = #FNL_USR_ID#        /* 최종사용자ID */
		     , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#   /* 최종거래부서코드 */
		     , FNL_MNU_ID      = #FNL_MNU_ID#        /* 최종메뉴ID */
		     , FNL_MDF_DH      = SYSDATE             /* 최종수정일시 */
		 WHERE YE          = #YE#
		   AND SRNO        = #SRNO#
		   AND HST_DT      = #HST_DT#
		   AND REL_PEN_SNO = #REL_PEN_SNO#
	</update>
	
	
	<!-- 기타감찰자료이력 상세카운트 -->   
	<select id="CSPBII412EMainHstSelectCnt" parameterClass="paramMap" resultClass="Integer">
		<![CDATA[       
			SELECT COUNT(YE)
			  FROM TBCSPBII400H A  /* 기타감찰자료정보내역 */
			 WHERE A.YE     = #YE#
			   AND A.SRNO   = #SRNO#
			   AND A.HST_DT = #HST_DT#
		]]>
	</select>
	
	<!-- 기타감찰자료이력첨부파일카운트 -->   
	<select id="CSPBII412EMainHstFileSelectCnt" parameterClass="paramMap" resultClass="Integer">
		<![CDATA[       
			SELECT COUNT(YE)
			  FROM TBCSPBII403H A  /* 기타감찰자료정보첨부파일 이력내역 */
			 WHERE A.YE   = #YE#
			   AND A.SRNO = #SRNO#
			   AND A.HST_DT = #HST_DT#
		]]>
	</select>
	
	<!-- 기타감찰자료이력첨부파일카운트 -->   
	<select id="CSPBII412EMainHstSubCnt" parameterClass="paramMap" resultClass="Integer">
		<![CDATA[       
			SELECT COUNT(YE)
			  FROM TBCSPBII401H A  /* 기타감찰자료정보첨부파일 이력내역 */
			 WHERE A.YE   = #YE#
			   AND A.SRNO = #SRNO#
			   AND A.HST_DT = #HST_DT#
		]]>
	</select>
	<!-- 기타감찰자료이력내역 등록  -->
	<update id="CSPBII412EHstupdateMain"  parameterClass="paramMap">
		UPDATE TBCSPBII400H                       
		   SET  (
		                          YE              /* 암호화주민등록번호 */
		                        , SRNO            /* 생년월일 */
		                        , ACP_DT          /* 성명 */
		                        , REL_ORG_CD      /* 한자성명 */
		                        , ETC_INSP_MTRL_CLC_DVSN_CD      /* 소속기관코드 */
		                        , CLC_RUT_NM      /* 계급코드 */
		                        , TIT_NM          /* 직무등급코드 */
		                        , ETC_INSP_MTRL_TXT 
		                        , FRT_USR_ID      /* 최초사용자ID */
		                        , FNL_USR_ID      /* 최종사용자ID */
		                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
		                        , FNL_MNU_ID      /* 최종메뉴ID */
		                        , FRT_REGI_DH     /* 최초등록일시 */
		                        , FNL_MDF_DH      /* 최종수정일시 */
		                        , INSP_INFO_STAT_CD  /* 상태코드값 */
		     					, CHAR_DEPT_CD       /* 담당부서 */
		     					, CHAR_CNB           /* 담당자 */
		     					, HST_DT
		     					, HST_SMM_TXT
							    , INF_TYP
						     	, HNDL_DIRC
						     	, HNDL_RSLT)  
		                    = (
		 					SELECT 
		 						YE              /* 암호화주민등록번호 */
		                        , SRNO            /* 생년월일 */
		                        , ACP_DT          /* 성명 */
		                        , REL_ORG_CD      /* 한자성명 */
		                        , ETC_INSP_MTRL_CLC_DVSN_CD      /* 소속기관코드 */
		                        , CLC_RUT_NM      /* 계급코드 */
		                        , TIT_NM          /* 직무등급코드 */
		                        , ETC_INSP_MTRL_TXT 
		                        , FRT_USR_ID      /* 최초사용자ID */
		                        , FNL_USR_ID      /* 최종사용자ID */
		                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
		                        , FNL_MNU_ID      /* 최종메뉴ID */
		                        , FRT_REGI_DH     /* 최초등록일시 */
		                        , FNL_MDF_DH      /* 최종수정일시 */
		                        , INSP_INFO_STAT_CD  /* 상태코드값 */
		     					, CHAR_DEPT_CD       /* 담당부서 */
		     					, CHAR_CNB           /* 담당자 */
		     					, HST_DT
		     					, HST_SMM_TXT
							    , INF_TYP
						     	, HNDL_DIRC
						     	, HNDL_RSLT
		     				FROM TBCSPBII400L
		     				WHERE   YE   = #YE#
		    				    AND SRNO = #SRNO#
		     				)
						 WHERE    YE     = #YE#
		    				 AND  SRNO   = #SRNO#
		    				 AND  HST_DT = #HST_DT#
	</update>
	
	<update id="CSPBII412EHstupdateFile"  parameterClass="paramMap">
		UPDATE TBCSPBII403H                       
		   SET  (
		   		YE,
           		SRNO,
        		HST_DT,
        		DOC_ID,
        		FRT_USR_ID,
        		FNL_USR_ID,
        		FNL_DEAL_DPT_CD,
        		FNL_MNU_ID,
        		FRT_REGI_DH,
        		FNL_MDF_DH )  
		   = (
		 	SELECT 
		 		YE,
				SRNO,
				HST_DT,
				DOC_ID,
				FRT_USR_ID,
				FNL_USR_ID,
				FNL_DEAL_DPT_CD,
				FNL_MNU_ID,
				FRT_REGI_DH,
				FNL_MDF_DH
		    FROM TBCSPBII403L
		    WHERE   YE   = #YE#
		        AND SRNO = #SRNO#
		    )
		WHERE    YE     = #YE#
		    AND  SRNO   = #SRNO#
		    AND  HST_DT = #HST_DT#
	</update>
	<!-- 기본정보 삭제 -->
	<delete id="CSPBII412EdeleteHstSub" parameterClass="paramMap">
		DELETE TBCSPBII401H
		 WHERE YE          = #YE#
		   AND SRNO        = #SRNO#	
		   AND REL_PEN_SNO = #REL_PEN_SNO#	
		   AND HST_DT = #HST_DT#	   
	</delete>
	
</sqlMap> 
