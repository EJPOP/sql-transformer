<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/oep/020">

	<select id="CSPOEP020EMainSelect" parameterClass="paramMap"	resultClass="resultMap">
		/* csp.oep.service.impl.CSPOEP020EServiceImpl.CSPOEP020EMainSelect */
		<![CDATA[       
		SELECT * FROM (	
			SELECT  ROWNUM AS NUM
			      , MSG_DVSN_CD /* 메시지 구분코드 */
			      , SNO /* 순번 */
			      , DPT_NM /* 부서 */
			      , PST_NM /* 직위 */
			      , RANK_NM /* 직급 */
			      , NAM /* 성명 */
			      , HOM_TNB /* 자택전화번호 */
			      , TNB /* 전화번호 */
			      , RMK_TXT /* 비고 */
			  FROM  TBCSPOEP008M
			 WHERE  1=1
		]]>
		<dynamic>
			<isNotEmpty property="strMsgDvsnCd">
			   AND MSG_DVSN_CD = #strMsgDvsnCd#
			</isNotEmpty>
			<isNotEmpty property="strTgNam">
			   AND NAM = #strTgNam#
			</isNotEmpty>			
			<isNotEmpty property="strNam">
			   AND NAM LIKE '%'||#strNam#||'%'
			</isNotEmpty>
			<isNotEmpty property="strTnb">
			   AND replace(TNB,'-','') LIKE '%'||replace(#strTnb#,'-','')||'%'
			</isNotEmpty>
		</dynamic>
		<![CDATA[
			 ORDER BY SNO ASC
		) AA
		]]>
	</select>
	
	<delete id="CSPOEP020EMainDelete" parameterClass="paramMap">
			DELETE FROM TBCSPOEP008M
			 WHERE MSG_DVSN_CD = #strMsgDvsnCd#
	</delete>	
	
	<insert id="CSPOEP020EMainInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPOEP008M
				  (
			  		 MSG_DVSN_CD
				   , SNO
				   , DPT_NM
				   , PST_NM
				   , RANK_NM
				   , NAM
				   , HOM_TNB
				   , TNB
	        	   , RMK_TXT
				   , FRT_USR_ID
				   , FNL_USR_ID
				   , FNL_DEAL_DPT_CD
				   , FNL_MNU_ID
				   , FRT_REGI_DH
				   , FNL_MDF_DH
				  )
			VALUES
				  (
			  	     #MSG_DVSN_CD#
			  	   , #SNO#
			  	   , nvl(#DPT_NM#,'')
			  	   , nvl(#PST_NM#,'')
			  	   , nvl(#RANK_NM#,'')
			  	   , #NAM#
			  	   , replace(nvl(#HOM_TNB#,''),' ','')
			  	   , replace(#TNB#,' ','')
			  	   , #RMK_TXT#
				   , #FNL_USR_ID#
				   , #FNL_USR_ID#
				   , #FNL_DEAL_DPT_CD#
				   , #FNL_MNU_ID#
				   , SYSDATE
				   , SYSDATE
			      );
			
		]]>
	</insert>
	
</sqlMap> 
