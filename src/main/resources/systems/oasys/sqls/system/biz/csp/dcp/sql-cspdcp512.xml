<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/dcp/512">
 	
 	<resultMap class="java.util.HashMap" id="mainMap">
	
	<result property="CVPT_KND_CD" column="CVPT_KND_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CVPT_KND_NM" column="CVPT_KND_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_YR" column="ACP_YR" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_YR_NO" column="ACP_YR_NO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CVPT_ACP_NO" column="CVPT_ACP_NO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REQ_DVSN_CD" column="REQ_DVSN_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_DPT_CD" column="ACP_DPT_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_DPT_USR_NAM" column="ACP_DPT_USR_NAM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_DH" column="ACP_DH" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_RUT_CD" column="ACP_RUT_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_RUT_NM" column="ACP_RUT_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REQR_KND_NM" column="REQR_KND_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CVPTR_NM" column="CVPTR_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="OPEN_YN" column="OPEN_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TIT_NM" column="TIT_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	
	<result property="MNG_TYP_NM" column="MNG_TYP_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="AD" column="AD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TNB" column="TNB" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="HPN" column="HPN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="OPEN_YN" column="OPEN_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	
     <result property="RSLT_NTF_WAY_NM" column="RSLT_NTF_WAY_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
     <result property="CLM_NM" column="CLM_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
     <result property="WRK_PLAC_NM" column="WRK_PLAC_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
     <result property="SUBAD" column="SUBAD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
     <result property="SUBTNB" column="SUBTNB" jdbcType="VARCHAR2"	javaType="java.lang.String" />
     <result property="CVPT_HNDL_STA_CD" column="CVPT_HNDL_STA_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
     <result property="DOC_ID" column="DOC_ID" jdbcType="VARCHAR2"	javaType="java.lang.String" />
    <!-- <result property="AUD_TG_ORG_CD" column="AUD_TG_ORG_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" /> --> 
     <result property="CVPT_HNDL_DVSN_CD" column="CVPT_HNDL_DVSN_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
     <result property="CVPT_HNDL_DVSN_NM" column="CVPT_HNDL_DVSN_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
     <result property="SMG_CHECK" column="SMG_CHECK" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CVPT_TXT" column="CVPT_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="ATCH_YN" column="ATCH_YN"      jdbcType="VARCHAR2"  javaType="java.lang.String" />		
    </resultMap>
 	
 	
 	<select id="CSPDCP512EMainSelect" parameterClass="paramMap"
		resultMap="mainMap">
		<![CDATA[
			SELECT D1.CVPT_KND_CD 
			      ,F_CODE_NM('1000047', D1.CVPT_KND_CD) AS CVPT_KND_NM
			      ,D1.ACP_YR||'-민원-'||D1.RM_CVPT_ACP_NO AS ACP_YR_NO
			      ,D1.ACP_YR
			      ,D1.CVPT_ACP_NO
			      ,D1.REQ_DVSN_CD
			      ,D1.ACP_DPT_CD
			      ,F_DPT_INFO(D1.ACP_DPT_CD,'1')||' / '||F_USR_INFO_BY_ID(D1.RCEP_ID,'2') AS ACP_DPT_USR_NAM
			      ,TO_CHAR(D1.ACP_DH, 'YYYY-MM-DD HH:MM') AS ACP_DH
			      ,D1.ACP_RUT_CD
			      ,F_CODE_NM('1000056', D1.ACP_RUT_CD) AS ACP_RUT_NM
			      ,F_CODE_NM('1000358', D1.REQR_KND_CD) AS REQR_KND_NM
			      ,D1.CVPTR_NM
			      ,D1.OPEN_YN
			      ,F_CODE_NM('1000598', D1.MNG_TYP_CD) AS MNG_TYP_NM
			      ,D1.AD
			      ,D1.TNB
			      ,D1.HPN
			      ,F_CODE_NM('1000089',D1.RSLT_NTF_WAY_CD) AS RSLT_NTF_WAY_NM
			      ,D3.CLM_NM
			      ,D3.WRK_PLAC_NM
			      ,D3.TNB AS SUBTNB
			      ,D3.AD AS SUBAD
			      ,D1.CVPT_HNDL_STA_CD
			      ,D1.DOC_ID
			      /*,D6.AUD_TG_ORG_CD*/
			      ,D5.CVPT_HNDL_DVSN_CD
			      ,F_CODE_NM('1000754', D5.CVPT_HNDL_DVSN_CD) AS CVPT_HNDL_DVSN_NM 
			      ,D4.CVPT_TXT 
			      ,D1.TIT_NM
			      ,(CASE WHEN D1.SMG_CVPT_APL_NO IS NULL THEN 'N' ELSE 'Y' END) AS SMG_CHECK
			      ,CASE WHEN	(	SELECT	COUNT(FILE_ID)
  			 						FROM	ECM_FILE_LIST_VIEW2 X
   									WHERE	D1.DOC_ID = X.DOC_ID
			   					) > 0 THEN '첨부파일 있음' 
			   		ELSE '첨부파일 없음' END AS ATCH_YN
			  FROM TBCSPDCP101M D1
			      ,TBCSPDCP103M D3
			      ,TBCSPDCP102M D4
			      ,TBCSPDCP205L D5
			 WHERE 1=1 
			   AND D1.REQ_DVSN_CD = #strREQ_DVSN_CD#
			   AND D1.ACP_YR      = #strACP_YR#
			   AND D1.CVPT_ACP_NO = #strCVPT_ACP_NO#
			   AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
			   AND D1.ACP_YR      = D3.ACP_YR(+)
			   AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
			   AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD
			   AND D1.ACP_YR      = D4.ACP_YR
			   AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO
			   AND D1.REQ_DVSN_CD = D5.REQ_DVSN_CD
			   AND D1.ACP_YR      = D5.ACP_YR
			   AND D1.CVPT_ACP_NO = D5.CVPT_ACP_NO
			   AND D5.SRNO = #strSRNO#
			]]>
	</select>
	
	<select id="CSPDCP512ESubSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			  SELECT D1.REQ_DVSN_CD
			         ,D1.CVPT_ACP_NO
			         ,D1.ACP_YR
			         ,D2.CVPT_HNDL_DVSN_CD
			         ,F_CODE_NM('1000754', D2.CVPT_HNDL_DVSN_CD) AS CVPT_HNDL_DVSN_NM
			         ,NVL(MAX(D3.DGE),1) AS MAX_DGE
			         ,NVL(MIN(D3.DGE),1) AS MIN_DGE
			     FROM TBCSPDCP101M D1
			         ,TBCSPDCP205L D2
			         ,TBCSPDCP401H D3
			         ,TBCSPDCP402L D4
			    WHERE 1=1
			      AND D1.REQ_DVSN_CD = #strREQ_DVSN_CD#
			      AND D1.ACP_YR      = #strACP_YR#
			      AND D1.CVPT_ACP_NO = #strCVPT_ACP_NO#
			      AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD
			      AND D1.ACP_YR      = D2.ACP_YR
			      AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO
			      AND D2.SRNO = #strSRNO#
			      AND D1.REQ_DVSN_CD = D3.REQ_DVSN_CD(+)
			      AND D1.ACP_YR      = D3.ACP_YR(+)
			      AND D1.CVPT_ACP_NO = D3.CVPT_ACP_NO(+)
			      AND D1.REQ_DVSN_CD = D4.REQ_DVSN_CD(+)
			      AND D1.ACP_YR      = D4.ACP_YR(+)
			      AND D1.CVPT_ACP_NO = D4.CVPT_ACP_NO(+)
			    GROUP BY D1.REQ_DVSN_CD
			            ,D1.CVPT_ACP_NO
			            ,D1.ACP_YR
			            ,D2.CVPT_HNDL_DVSN_CD
			            ]]>
	</select>
	
	
	<resultMap class="java.util.HashMap" id="CSPDCP512Map">
	<result property="RSLT_RPRT_HNDL_RSLT_CD" column="RSLT_RPRT_HNDL_RSLT_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="HNDL_DPT_NM" column="HNDL_DPT_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="HNDL_DPT_CD" column="HNDL_DPT_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="HNDL_PEN_ID" column="HNDL_PEN_ID" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="USR_NAM" column="USR_NAM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="FRT_REGI_DH" column="FRT_REGI_DH" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="INSPC_RSLT_UNQ_TXT" column="INSPC_RSLT_UNQ_TXT" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="DOC_ID" column="DOC_ID" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REQ_DVSN_CD" column="REQ_DVSN_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_YR" column="ACP_YR" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CVPT_ACP_NO" column="CVPT_ACP_NO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="DGE" column="DGE" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="SMG_CVPT_HNDL_DVSN_CD" column="SMG_CVPT_HNDL_DVSN_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="OPM_NTF_DVSN_CD" column="OPM_NTF_DVSN_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ANS_TXT" column="ANS_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	<result property="ANS_DOC_ID" column="ANS_DOC_ID" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="DOC_NM" column="DOC_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REPORT_YN" column="REPORT_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ANS_YN" column="ANS_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="HNDL_RSLT_NTF_YN" column="HNDL_RSLT_NTF_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACP_RUT_CD" column="ACP_RUT_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="RSLT_NTF_WAY_CD" column="RSLT_NTF_WAY_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="EML_ID" column="EML_ID" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CVPT_OPM_SRNO" column="CVPT_OPM_SRNO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CVPT_OPM_APV_HNDL_STA_CD" column="CVPT_OPM_APV_HNDL_STA_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ONR_DOC_MNG_CRD_ID" column="ONR_DOC_MNG_CRD_ID" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REPORT_RESULT_YN" column="REPORT_RESULT_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REPORT_ONR_APV_RQS_DH" column="REPORT_ONR_APV_RQS_DH" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REPORT_ONR_APV_CMPT_DH" column="REPORT_ONR_APV_CMPT_DH" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CD1" column="CD1" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CD2" column="CD2" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ONR_APV_CMPT_DH" column="ONR_APV_CMPT_DH" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	
	</resultMap>
	<select id="CSPDCP512ESubResultSelect" parameterClass="paramMap"
		resultMap="CSPDCP512Map">
		<![CDATA[
		SELECT D2.RSLT_RPRT_HNDL_RSLT_CD
		      ,F_DPT_INFO(D1.HNDL_DPT_CD, '1') AS HNDL_DPT_NM
		      ,D1.HNDL_DPT_CD
		      ,D1.HNDL_PEN_ID
		      ,F_USR_INFO_BY_ID(D1.HNDL_PEN_ID,'2') AS USR_NAM
		      ,D1.FRT_REGI_DH
		      ,D1.INSPC_RSLT_UNQ_TXT
		      ,D1.DOC_ID
		      ,D1.REQ_DVSN_CD 
		      ,D1.ACP_YR      
		      ,D1.CVPT_ACP_NO 
		      ,D1.DGE
		      ,D1.SMG_CVPT_HNDL_DVSN_CD
              ,NVL(D1.OPM_NTF_DVSN_CD,'N') AS OPM_NTF_DVSN_CD
              , CASE WHEN D1.ANS_TXT IS NULL THEN (SELECT  Z.CVPT_DOC_TXT
														FROM 	TBCSPDCP203M Z 
														WHERE 	D1.REQ_DVSN_CD = Z.REQ_DVSN_CD
														AND		D1.ACP_YR = Z.ACP_YR
														AND		D1.CVPT_ACP_NO = Z.CVPT_ACP_NO
														AND		D1.DGE = Z.DGE
														AND		Z.CVPT_DOC_DVSN_CD = 'B4')
						ELSE D1.ANS_TXT END AS ANS_TXT
              ,D1.ANS_DOC_ID
		      ,'첨부파일' AS DOC_NM
		      ,CASE WHEN D6.ONR_DOC_MNG_CRD_ID IS NOT NULL THEN 'Y' ELSE 'N' END  AS REPORT_YN
		       ,CASE WHEN D1.OPM_NTF_DVSN_CD ='Y' AND D6.CVPT_OPM_APV_HNDL_STA_CD = '30' THEN 'Y'
		       		WHEN D1.OPM_NTF_DVSN_CD = 'N' THEN 'Y'
		       		ELSE 'N' END AS ANS_YN
				,D1.HNDL_RSLT_NTF_YN
				,D4.ACP_RUT_CD
				,D4.RSLT_NTF_WAY_CD
				,D4.EML_ID
				,D5.CVPT_OPM_SRNO
				,D5.CVPT_OPM_APV_HNDL_STA_CD
				,D5.ONR_DOC_MNG_CRD_ID
				,CASE WHEN D6.CVPT_OPM_APV_HNDL_STA_CD = '30' THEN 'Y'
						ELSE 'N' END AS REPORT_RESULT_YN
				,TO_CHAR(D6.ONR_APV_RQS_DH,'YYYY-MM-DD HH24:MI') AS REPORT_ONR_APV_RQS_DH
				,TO_CHAR(D6.ONR_APV_CMPT_DH,'YYYY-MM-DD HH24:MI') AS REPORT_ONR_APV_CMPT_DH
				,CASE WHEN D2.RSLT_RPRT_HNDL_RSLT_CD IN ('81','82','83') THEN '80'
						ELSE RSLT_RPRT_HNDL_RSLT_CD END AS CD1
				, RSLT_RPRT_HNDL_RSLT_CD AS CD2
				, TO_CHAR(D5.ONR_APV_CMPT_DH,'YYYY-MM-DD HH24:MI') AS ONR_APV_CMPT_DH
		  FROM TBCSPDCP401H D1
		      ,TBCSPDCP402L D2
		      ,TBCSPDCP101M D4
		      ,TBCSPDCP301M D5
		      ,TBCSPDCP301M D6
		 WHERE 1=1
		   AND D4.REQ_DVSN_CD = #strREQ_DVSN_CD#
		   AND D4.ACP_YR      = #strACP_YR#
		   AND D4.CVPT_ACP_NO = #strCVPT_ACP_NO#
		   AND D4.REQ_DVSN_CD = D1.REQ_DVSN_CD
		   AND D4.ACP_YR = D1.ACP_YR
		   AND D4.CVPT_ACP_NO = D1.CVPT_ACP_NO
		   AND D1.REQ_DVSN_CD = D2.REQ_DVSN_CD
		   AND D1.ACP_YR      = D2.ACP_YR
		   AND D1.CVPT_ACP_NO = D2.CVPT_ACP_NO
		   AND D1.DGE         = D2.DGE
		   AND D1.REQ_DVSN_CD = D5.REQ_DVSN_CD(+)
		   AND D1.ACP_YR      = D5.ACP_YR(+)
		   AND D1.CVPT_ACP_NO = D5.CVPT_ACP_NO(+)
		   AND D1.DGE         = D5.DGE(+)
		   AND D5.CVPT_IFM_DVSN_CD(+) = 'B'
		   AND D1.REQ_DVSN_CD = D6.REQ_DVSN_CD(+)
		   AND D1.ACP_YR      = D6.ACP_YR(+)
		   AND D1.CVPT_ACP_NO = D6.CVPT_ACP_NO(+)
		   AND D1.DGE         = D6.DGE(+)
		   AND D6.CVPT_IFM_DVSN_CD(+) = 'D'
		   ORDER BY D1.DGE
	]]>
	</select>
	
	
	<select id="CSPDCP512ESubResultDetailSelect" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT T1.REQ_DVSN_CD
			      ,T1.ACP_YR
			      ,T1.CVPT_ACP_NO
			      ,T1.DGE
			      ,D1.AUD_YR
			      ,D1.AUD_NO
			      ,D1.DSP_RQ_SNO
			      ,D1.AUD_YR||'-'||D1.AUD_NO||'-'||D1.DSP_RQ_SNO AS DSPRQSNO_AUDYRNO
			      ,D1.TIT_TXT
			      ,(SELECT ORG_NM
					  FROM TBDCMACM015M
					 WHERE ORG_CD = D3.RLTN_ORG_CD) AS ORG_NM
			      ,D2.ENF_BRDV_CD
			      ,F_DPT_INFO(D2.ENF_BRDV_CD,'1') AS ENF_BRDV_NM
			      ,(SELECT CD_NM
					  FROM TBDCMACM013C
					 WHERE CMM_CD_DVSN_CD = '1000002'
					   AND CD = D1.DSP_RQ_KND_CD) AS DSP_RQ_KND_NM
			  FROM TBCSPDCP403L T1
			      ,TBBADEAR001M D1
			      ,TBBADEAR002D D2
			      ,TBBADEAR006M D3
			 WHERE 1=1
			   AND T1.AUD_YR     = D1.AUD_YR
			   AND T1.AUD_NO     = D1.AUD_NO
			   AND T1.DSP_RQ_SNO = D1.DSP_RQ_SNO
			   AND T1.AUD_YR     = D2.AUD_YR
			   AND T1.AUD_NO     = D2.AUD_NO
			   AND T1.DSP_RQ_SNO = D2.DSP_RQ_SNO
			   AND T1.AUD_YR     = D3.AUD_YR
			   AND T1.AUD_NO     = D3.AUD_NO
			   AND T1.DSP_RQ_SNO = D3.DSP_RQ_SNO
			   AND T1.REQ_DVSN_CD= #REQ_DVSN_CD#
			   AND T1.ACP_YR     = #ACP_YR#
			   AND T1.CVPT_ACP_NO= #CVPT_ACP_NO#
			   AND T1.DGE        = #DGE#
	]]>
	</select>
	
	<insert id="CSPDCP512E403SubResultDetailInsert" parameterClass="paramMap">
	<![CDATA[
			INSERT /*CSPDCP512ESubResultDetailInsert*/ INTO TBCSPDCP403L(
			            REQ_DVSN_CD
			           ,ACP_YR
			           ,CVPT_ACP_NO
			           ,DGE
			           ,AUD_YR
			           ,AUD_NO
			           ,DSP_RQ_SNO
			           ,FRT_USR_ID
			           ,FNL_USR_ID
			           ,FNL_DEAL_DPT_CD
			           ,FNL_MNU_ID
			           ,FRT_REGI_DH
			           ,FNL_MDF_DH
			           )
			           VALUES(
			           #REQ_DVSN_CD#
			           ,#ACP_YR#
			           ,#CVPT_ACP_NO#
			           ,#DGE#
			           ,#AUD_YR#
			           ,#AUD_NO#
			           ,#DSP_RQ_SNO#
			           ,#FRT_USR_ID#
			           ,#FNL_USR_ID#
			           ,#FNL_DEAL_DPT_CD#
			           ,#FNL_MNU_ID#
			           ,SYSDATE
			           ,SYSDATE
			           )
			]]>
	</insert>
	
	
	<delete id="CSPDCP512ESubResultDetailDelete" parameterClass="paramMap">
	<![CDATA[
			DELETE 
			  FROM TBCSPDCP403L
			 WHERE REQ_DVSN_CD = #REQ_DVSN_CD#
			   AND ACP_YR      = #ACP_YR#
			   AND CVPT_ACP_NO = #CVPT_ACP_NO#
			   AND DGE         = #DGE#
			   AND AUD_YR      = #AUD_YR#
			   AND AUD_NO      = #AUD_NO#
			   AND DSP_RQ_SNO  = #DSP_RQ_SNO#
	]]>
	</delete>
	
	
	
	
	
	<!-- 관련법령조회 -->
	<select id="CSPDCP512ESelectLawList" parameterClass="paramMap"
		resultClass="resultMap">
		<![CDATA[
			SELECT /*CSPDCP512ESelectLawList*/ D1.REQ_DVSN_CD
			      ,D1.ACP_YR
			      ,D1.CVPT_ACP_NO
			      ,D1.DGE
			      ,D1.LAW_HIS_SRNO
			      ,D1.LAW_LNK_ID
			      ,D1.LAW_DTL_TXT
			      , (	SELECT	Z.LAW_NM
						FROM	TBBADCMR013M Z
						WHERE	D1.LAW_LNK_ID = Z.LAW_LNK_ID) AS LAW_NM
			 FROM TBCSPDCP204L D1
			WHERE 1=1
			  AND D1.REQ_DVSN_CD = #REQ_DVSN_CD#
			  AND D1.ACP_YR      = #ACP_YR#
			  AND D1.CVPT_ACP_NO = #CVPT_ACP_NO#
			  AND D1.DGE         = #DGE#
			  ]]>
		</select>
	
	
	<insert id="CSPDCP512EInsertTBCSPDCP401H" parameterClass="paramMap">
	<![CDATA[
		INSERT INTO TBCSPDCP401H
		           (REQ_DVSN_CD
		           ,ACP_YR
		           ,CVPT_ACP_NO
		           ,DGE
		           ,HNDL_DPT_CD
		           ,HNDL_PEN_ID
		           ,INSPC_RSLT_UNQ_TXT
		           ,DOC_ID
		           ,FRT_USR_ID
		           ,FNL_USR_ID
		           ,FNL_DEAL_DPT_CD
		           ,FNL_MNU_ID
		           ,FRT_REGI_DH
		           ,FNL_MDF_DH
		           )
		           VALUES (
		           #REQ_DVSN_CD#
		           ,#ACP_YR#
		           ,#CVPT_ACP_NO#
		           ,#DGE#
		           ,#HNDL_DPT_CD#
		           ,#HNDL_PEN_ID#
		           ,#INSPC_RSLT_UNQ_TXT#
		           ,#DOC_ID#
		           ,#FRT_USR_ID#
		           ,#FNL_USR_ID#
		           ,#FNL_DEAL_DPT_CD#
		           ,#FNL_MNU_ID#
		           ,SYSDATE
		           ,SYSDATE
		           )
		           ]]>
	</insert>
	
	<!-- 조사결과 저장 시 합건 자료도 저장 -->
	<insert id="CSPDCP512ESucInsertTBCSPDCP401H" parameterClass="paramMap">
	<![CDATA[
		INSERT INTO TBCSPDCP401H
		           (REQ_DVSN_CD
		           ,ACP_YR
		           ,CVPT_ACP_NO
		           ,DGE
		           ,HNDL_DPT_CD
		           ,HNDL_PEN_ID
		           ,INSPC_RSLT_UNQ_TXT
		           ,DOC_ID
		           ,FRT_USR_ID
		           ,FNL_USR_ID
		           ,FNL_DEAL_DPT_CD
		           ,FNL_MNU_ID
		           ,FRT_REGI_DH
		           ,FNL_MDF_DH
		           )
			SELECT	SUC_REQ_DVSN_CD
					,SUC_ACP_YR
					,SUC_CVPT_ACP_NO
					,#DGE#
					,#HNDL_DPT_CD#
					,#HNDL_PEN_ID#
					,#INSPC_RSLT_UNQ_TXT#
					,#DOC_ID#
		           	,#FRT_USR_ID#
		           	,#FNL_USR_ID#
		           	,#FNL_DEAL_DPT_CD#
		           	,#FNL_MNU_ID#
		           	,SYSDATE
		           	,SYSDATE
			FROM	TBCSPDCP105L
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
		           ]]>
	</insert>
	
	<insert id="CSPDCP512EInsertTBCSPDCP402L" parameterClass="paramMap">
	<![CDATA[
					INSERT INTO TBCSPDCP402L
				        (REQ_DVSN_CD
				        ,ACP_YR
				        ,CVPT_ACP_NO
				        ,DGE
				        ,RSLT_RPRT_HNDL_RSLT_CD   
				        ,FRT_USR_ID
				        ,FNL_USR_ID
				        ,FNL_DEAL_DPT_CD
				        ,FNL_MNU_ID
				        ,FRT_REGI_DH
				        ,FNL_MDF_DH 
				        )
				        VALUES (
				        #REQ_DVSN_CD#
				        ,#ACP_YR#
				        ,#CVPT_ACP_NO#
				        ,#DGE#
				        ,#RSLT_RPRT_HNDL_RSLT_CD#
				        ,#FRT_USR_ID#
				        ,#FNL_USR_ID#
				        ,#FNL_DEAL_DPT_CD#
				        ,#FNL_MNU_ID#
				        ,SYSDATE
				        ,SYSDATE
				        )
				        ]]>
	
	</insert>
	
	<!-- 합건된 자료도 같이 저장 -->
	<insert id="CSPDCP512ESucInsertTBCSPDCP402L" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPDCP402L
		        (REQ_DVSN_CD
		        ,ACP_YR
		        ,CVPT_ACP_NO
		        ,DGE
		        ,RSLT_RPRT_HNDL_RSLT_CD   
		        ,FRT_USR_ID
		        ,FNL_USR_ID
		        ,FNL_DEAL_DPT_CD
		        ,FNL_MNU_ID
		        ,FRT_REGI_DH
		        ,FNL_MDF_DH 
		        )
			SELECT	SUC_REQ_DVSN_CD
					,SUC_ACP_YR
					,SUC_CVPT_ACP_NO
					,#DGE#
					,#RSLT_RPRT_HNDL_RSLT_CD#
					,#FRT_USR_ID#
			        ,#FNL_USR_ID#
			        ,#FNL_DEAL_DPT_CD#
			        ,#FNL_MNU_ID#
			        ,SYSDATE
			        ,SYSDATE
			FROM	TBCSPDCP105L S1
			WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		S1.ACP_YR = #ACP_YR#
			AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#	

		]]>
	
	</insert>
	
	<update id="CSPDCP512EUpdateTBCSPDCP401H" parameterClass="paramMap">
	<![CDATA[
		UPDATE TBCSPDCP401H
		 SET INSPC_RSLT_UNQ_TXT = #INSPC_RSLT_UNQ_TXT#
		 ]]>
		 <isNotEmpty prepend="," property="DOC_ID">
		     DOC_ID = #DOC_ID#
		 </isNotEmpty>
		 <isNotEmpty prepend="," property="ANS_DOC_ID">
		     ANS_DOC_ID = #ANS_DOC_ID#
		 </isNotEmpty>
		 <isNotEmpty prepend="," property="SMG_CVPT_HNDL_DVSN_CD">
		     SMG_CVPT_HNDL_DVSN_CD = #SMG_CVPT_HNDL_DVSN_CD#
		 </isNotEmpty>
		 <isNotEmpty prepend="," property="OPM_NTF_DVSN_CD">
		     OPM_NTF_DVSN_CD = #OPM_NTF_DVSN_CD#
		 </isNotEmpty>
		 <isNotEmpty prepend="," property="ANS_TXT">
		     ANS_TXT = #ANS_TXT#
		 </isNotEmpty>
		    ,FNL_USR_ID         = #FNL_USR_ID#
		    ,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
		    ,FNL_MNU_ID         = #FNL_MNU_ID#
		    ,FNL_MDF_DH         = SYSDATE
		WHERE 1=1
		  AND REQ_DVSN_CD = #REQ_DVSN_CD#
		  AND ACP_YR      = #ACP_YR#
		  AND CVPT_ACP_NO = #CVPT_ACP_NO#
		  AND DGE         = #DGE#
	</update>
	
	<!-- 합건되자료도 같이 저장 -->
	<update id="CSPDCP512ESucUpdateTBCSPDCP401H" parameterClass="paramMap">
	<![CDATA[
		UPDATE TBCSPDCP401H
		 SET INSPC_RSLT_UNQ_TXT = #INSPC_RSLT_UNQ_TXT#
		 ]]>
		 <isNotEmpty prepend="," property="DOC_ID">
		     DOC_ID = #DOC_ID#
		 </isNotEmpty>
		 <isNotEmpty prepend="," property="ANS_DOC_ID">
		     ANS_DOC_ID = #ANS_DOC_ID#
		 </isNotEmpty>
		 <isNotEmpty prepend="," property="SMG_CVPT_HNDL_DVSN_CD">
		     SMG_CVPT_HNDL_DVSN_CD = #SMG_CVPT_HNDL_DVSN_CD#
		 </isNotEmpty>
		 <isNotEmpty prepend="," property="OPM_NTF_DVSN_CD">
		     OPM_NTF_DVSN_CD = #OPM_NTF_DVSN_CD#
		 </isNotEmpty>
		 <isNotEmpty prepend="," property="ANS_TXT">
		     ANS_TXT = #ANS_TXT#
		 </isNotEmpty>
		    ,FNL_USR_ID         = #FNL_USR_ID#
		    ,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
		    ,FNL_MNU_ID         = #FNL_MNU_ID#
		    ,FNL_MDF_DH         = SYSDATE
		WHERE 1=1
		  AND (REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
		  											FROM	TBCSPDCP105L S1
		  											WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
		  											AND		S1.ACP_YR = #ACP_YR#
		  											AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
		  AND DGE         = #DGE#
	</update>
	
	<update id="CSPDCP512EUpdateTBCSPDCP402L" parameterClass="paramMap">
		<![CDATA[
		UPDATE TBCSPDCP402L
	    SET RSLT_RPRT_HNDL_RSLT_CD = #RSLT_RPRT_HNDL_RSLT_CD#
	       ,FNL_USR_ID         = #FNL_USR_ID#
	       ,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
	       ,FNL_MNU_ID         = #FNL_MNU_ID#
	       ,FNL_MDF_DH         = SYSDATE
		 WHERE 1=1
		   AND REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND ACP_YR      = #ACP_YR#
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND DGE         = #DGE#
		   ]]>
	</update>
	
	<!-- 합건자료도 같이 저장 -->
	<update id="CSPDCP512ESucUpdateTBCSPDCP402L" parameterClass="paramMap">
		<![CDATA[
		UPDATE TBCSPDCP402L
	    SET RSLT_RPRT_HNDL_RSLT_CD = #RSLT_RPRT_HNDL_RSLT_CD#
	       ,FNL_USR_ID         = #FNL_USR_ID#
	       ,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
	       ,FNL_MNU_ID         = #FNL_MNU_ID#
	       ,FNL_MDF_DH         = SYSDATE
		 WHERE 1=1
		  AND (REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
		  											FROM	TBCSPDCP105L S1
		  											WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
		  											AND		S1.ACP_YR = #ACP_YR#
		  											AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)
		   AND DGE         = #DGE#
		   ]]>
	</update>
	
	<select id="CSPDCP512EMaxDge" parameterClass="paramMap"
		resultClass="java.lang.String">
		<![CDATA[
		SELECT NVL(MAX(DGE), 0)+1 AS MAX_DGE
		  FROM TBCSPDCP401H
		 WHERE 1=1
		   AND REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND ACP_YR      = #ACP_YR#
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		]]>
		</select>
		
		<insert id="CSPDCP512EInsertLaw" parameterClass="paramMap">
		<![CDATA[
			  INSERT INTO TBCSPDCP204L /*CSPDCP512EInsertLaw*/
			             (REQ_DVSN_CD
			             ,ACP_YR
			             ,CVPT_ACP_NO
			             ,LAW_HIS_SRNO
			             ,LAW_LNK_ID
			             ,DGE
			             ,LAW_DTL_TXT
			             ,FRT_USR_ID
				         ,FNL_USR_ID
				         ,FNL_DEAL_DPT_CD
				         ,FNL_MNU_ID
				         ,FRT_REGI_DH
				         ,FNL_MDF_DH 
			             )
			             VALUES(
			              #REQ_DVSN_CD#
			             ,#ACP_YR#
			             ,#CVPT_ACP_NO#
			             ,(	SELECT 	NVL(MAX(LAW_HIS_SRNO),0)+1
							FROM	TBCSPDCP204L 
							WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
							AND		ACP_YR = #ACP_YR#
							AND		CVPT_ACP_NO = #CVPT_ACP_NO#
						  )
			             ,#LAW_LNK_ID#
			             ,#DGE#
			             ,#LAW_DTL_TXT#
			             ,#FRT_USR_ID#
				         ,#FNL_USR_ID#
				         ,#FNL_DEAL_DPT_CD#
				         ,#FNL_MNU_ID#
				         ,SYSDATE
				         ,SYSDATE
				        )
				        ]]>
		</insert>
		
		<!-- 법령 인서트 -->
		<insert id="CSPDCP512ESucInsertLaw" parameterClass="paramMap">
		<![CDATA[
			  INSERT INTO TBCSPDCP204L /*CSPDCP512EInsertLaw*/
			             (REQ_DVSN_CD
			             ,ACP_YR
			             ,CVPT_ACP_NO
			             ,LAW_HIS_SRNO
			             ,LAW_LNK_ID
			             ,DGE
			             ,LAW_DTL_TXT
			             ,FRT_USR_ID
				         ,FNL_USR_ID
				         ,FNL_DEAL_DPT_CD
				         ,FNL_MNU_ID
				         ,FRT_REGI_DH
				         ,FNL_MDF_DH 
			             )
				SELECT	SUC_REQ_DVSN_CD
						,SUC_ACP_YR
						,SUC_CVPT_ACP_NO
						,(	SELECT 	NVL(MAX(LAW_HIS_SRNO),0)+1
							FROM	TBCSPDCP204L 
							WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
							AND		ACP_YR = #ACP_YR#
							AND		CVPT_ACP_NO = #CVPT_ACP_NO#
						  )
						,#LAW_LNK_ID#
		             	,#DGE#
			            ,#LAW_DTL_TXT#
			            ,#FRT_USR_ID#
				        ,#FNL_USR_ID#
				        ,#FNL_DEAL_DPT_CD#
				        ,#FNL_MNU_ID#
				        ,SYSDATE
				        ,SYSDATE
				FROM	TBCSPDCP105L S1
				WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
				AND		S1.ACP_YR = #ACP_YR#
				AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#		
	        ]]>
		</insert>
		
		<update id="CSPDCP512EUpdateLaw" parameterClass="paramMap">
		<![CDATA[
				UPDATE /*CSPDCP512EUpdateLaw*/ TBCSPDCP204L
				   SET LAW_DTL_TXT = #LAW_DTL_TXT#
				   	   ,FNL_USR_ID         = #FNL_USR_ID#
				       ,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
				       ,FNL_MNU_ID         = #FNL_MNU_ID#
				       ,FNL_MDF_DH         = SYSDATE
				 WHERE REQ_DVSN_CD = #REQ_DVSN_CD#
				   AND ACP_YR      = #ACP_YR#
				   AND CVPT_ACP_NO = #CVPT_ACP_NO#
				   AND DGE         = #DGE#    
				   AND LAW_HIS_SRNO = #LAW_HIS_SRNO#
		           AND LAW_LNK_ID  = #LAW_LNK_ID#
			]]>
		</update>
		
		<update id="CSPDCP512ESucUpdateLaw" parameterClass="paramMap">
		<![CDATA[
				UPDATE /*CSPDCP512EUpdateLaw*/ TBCSPDCP204L
				   SET LAW_DTL_TXT = #LAW_DTL_TXT#
				   	   ,FNL_USR_ID         = #FNL_USR_ID#
				       ,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
				       ,FNL_MNU_ID         = #FNL_MNU_ID#
				       ,FNL_MDF_DH         = SYSDATE
				 WHERE (REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
				 										FROM	TBCSPDCP105L S1
														WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
														AND		S1.ACP_YR = #ACP_YR#
														AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
				   AND DGE         = #DGE#    
				   AND LAW_HIS_SRNO = #LAW_HIS_SRNO#
		           AND LAW_LNK_ID  = #LAW_LNK_ID#
			]]>
		</update>
		
		<delete id="CSPDCP512EDeleteLaw" parameterClass="paramMap">
		<![CDATA[
		DELETE 
		  FROM TBCSPDCP204L
		 WHERE REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND ACP_YR      = #ACP_YR#
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND LAW_HIS_SRNO = #LAW_HIS_SRNO#    
           AND LAW_LNK_ID  = #LAW_LNK_ID#	
           ]]>		             
		</delete>
		
		<!-- 합건자료 법령 삭제 -->
		<delete id="CSPDCP512ESucDeleteLaw" parameterClass="paramMap">
		<![CDATA[
		DELETE 
		  FROM TBCSPDCP204L
		 WHERE (REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
		 												FROM	TBCSPDCP105L S1
														WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
														AND		S1.ACP_YR = #ACP_YR#
														AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
		   AND LAW_HIS_SRNO = #LAW_HIS_SRNO#    
           AND LAW_LNK_ID  = #LAW_LNK_ID#	
           ]]>		             
		</delete>
		
		<update id="CSPDCP512EUpdateStatus" parameterClass="paramMap">
		<![CDATA[
			UPDATE TBCSPDCP101M
			   SET CVPT_HNDL_STA_CD = #CVPT_HNDL_STA_CD#
			   	   ,FNL_USR_ID         = #FNL_USR_ID#
			       ,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
			       ,FNL_MNU_ID         = #FNL_MNU_ID#
			       ,FNL_MDF_DH         = SYSDATE
			 WHERE REQ_DVSN_CD = 1
		       AND ACP_YR      = #strACP_YR#
		       AND CVPT_ACP_NO = #strCVPT_ACP_NO#
		]]>
		</update>
		
		<!-- 합건자료도 확정 -->
		<update id="CSPDCP512ESucUpdateStatus" parameterClass="paramMap">
		<![CDATA[
			UPDATE TBCSPDCP101M
			   SET CVPT_HNDL_STA_CD = #CVPT_HNDL_STA_CD#
			   	   ,FNL_USR_ID         = #FNL_USR_ID#
			       ,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
			       ,FNL_MNU_ID         = #FNL_MNU_ID#
			       ,FNL_MDF_DH         = SYSDATE
			 WHERE (REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN ( SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
			 											FROM	TBCSPDCP105L S1
														WHERE	S1.REQ_DVSN_CD = '1'
														AND		S1.ACP_YR = #strACP_YR#
														AND		S1.CVPT_ACP_NO = #strCVPT_ACP_NO#)	
		]]>
		</update>
		
		<update id="CSPDCP512E201Update" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP201M
			SET		FNL_HNDL_DH = DECODE(#CVPT_HNDL_STA_CD#,'50',NULL,SYSDATE)
					,FNL_USR_ID         = #FNL_USR_ID#
					,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
					,FNL_MNU_ID         = #FNL_MNU_ID#
					,FNL_MDF_DH         = SYSDATE
			WHERE	REQ_DVSN_CD ='1'
			AND		ACP_YR = #strACP_YR#
			AND		CVPT_ACP_NO = #strCVPT_ACP_NO#
		]]>
		</update>
		
		<insert id="CSPDCP512E202Insert" parameterClass="paramMap">
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#strREQ_DVSN_CD#
							,#strACP_YR#
							,#strCVPT_ACP_NO#
							,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
								  FROM TBCSPDCP202H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #strREQ_DVSN_CD#
							       AND ACP_YR = #strACP_YR#
							       AND CVPT_ACP_NO = #strCVPT_ACP_NO#
							 )
							,#FNL_DEAL_DPT_CD#
							,#FNL_USR_ID#
							,#CVPT_HNDL_STA_CD#
							,#FNL_USR_ID#
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
		</insert>
		
		<insert id="CSPDCP512E202SucInsert" parameterClass="paramMap">
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
			SELECT	SUC_REQ_DVSN_CD
					,SUC_ACP_YR
					,SUC_CVPT_ACP_NO
					,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
						  FROM TBCSPDCP202H
						 WHERE 1=1
					       AND REQ_DVSN_CD = SUC_REQ_DVSN_CD
					       AND ACP_YR = SUC_ACP_YR
					       AND CVPT_ACP_NO = SUC_CVPT_ACP_NO
					 )
					 ,#FNL_DEAL_DPT_CD#
					,#FNL_USR_ID#
					,#CVPT_HNDL_STA_CD#
					,#FNL_USR_ID#
					,#FNL_USR_ID#
					,#FNL_DEAL_DPT_CD#
					,#FNL_MNU_ID#
					,SYSDATE
					,SYSDATE
			FROM	TBCSPDCP105L S1
			WHERE	S1.REQ_DVSN_CD = #strREQ_DVSN_CD#
			AND		S1.ACP_YR = #strACP_YR#
			AND		S1.CVPT_ACP_NO = #strCVPT_ACP_NO#
		</insert>
		
		
		<select id="CSPDCP512ECommitCheck" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[		
		SELECT 
			(SELECT COUNT(1)
			  FROM TBCSPDCP203M
			 WHERE 1=1
			   AND REQ_DVSN_CD = 1
			   AND ACP_YR      = #strACP_YR#
			   AND CVPT_ACP_NO = #strCVPT_ACP_NO#
			   AND DGE IS NOT NULL) AS DETAILCNT
			   ,
			 (
			 SELECT COUNT(1)
			   FROM TBCSPDCP401H
			  WHERE 1=1
			    AND REQ_DVSN_CD = 1
			    AND ACP_YR      = #strACP_YR#
			    AND CVPT_ACP_NO = #strCVPT_ACP_NO#) AS MAINCNT
			    ,
			 (
			 SELECT COUNT(1)
			   FROM TBCSPDCP301M
			  WHERE 1=1
			    AND REQ_DVSN_CD = 1
			    AND ACP_YR      = #strACP_YR#
			    AND CVPT_ACP_NO = #strCVPT_ACP_NO#
			    AND CVPT_IFM_DVSN_CD = 'D'
			    AND CVPT_OPM_APV_HNDL_STA_CD = '30') AS RESULTCNT
			FROM DUAL
		]]>
		</select>
		
	<!-- 처리결과 통보시  민원이메일 기본 테이블 insert-->
	<insert id="CSPDCP512E303NtfInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO	TBCSPDCP303M
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,DGE
        					,CVPT_EML_HIS_SRNO
        					,SEN_DH
        					,EML_TXT
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#REQ_DVSN_CD#
							,#ACP_YR#
							,#CVPT_ACP_NO#
							,#DGE#
							,(	SELECT NVL(MAX(CVPT_EML_HIS_SRNO),0)+1
								  FROM TBCSPDCP303M
								 WHERE 1=1
							       AND REQ_DVSN_CD = #REQ_DVSN_CD#
							       AND ACP_YR = #ACP_YR#
							       AND CVPT_ACP_NO = #CVPT_ACP_NO#
							 )
							,SYSDATE
							,#ANS_TXT#
							,F_USR_INFO(#S_CNB#,'1')
							,#FNL_USR_ID#
							,#FNL_DEAL_DPT_CD#
							,#FNL_MNU_ID#
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>
		
	
	<delete id="CSPDCP512EDeleteDgeAll401H" parameterClass="paramMap">
		DELETE 
   		  FROM TBCSPDCP401H
   		 WHERE REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND ACP_YR      = #ACP_YR#
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND DGE         = #DGE#
	
	</delete>
	
	<!-- 조사결과 합건 삭제 -->
	<delete id="CSPDCP512EDeleteDgeSucAll401H" parameterClass="paramMap">
		DELETE 
		FROM 	TBCSPDCP401H
		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
														FROM	TBCSPDCP105L S1
														WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
														AND		S1.ACP_YR = #ACP_YR#
														AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
   		  
		AND		DGE = #DGE#
	</delete>
	
	<delete id="CSPDCP512EDeleteDgeAll402L" parameterClass="paramMap">
	DELETE 
   		  FROM TBCSPDCP402L
   		 WHERE REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND ACP_YR      = #ACP_YR#
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND DGE         = #DGE#
	</delete>
	
	<!-- 합건 자료 삭제 -->
	<delete id="CSPDCP512EDeleteDgeSucAll402L" parameterClass="paramMap">
		DELETE 
		FROM 	TBCSPDCP402L
		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
														FROM	TBCSPDCP105L S1
														WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
														AND		S1.ACP_YR = #ACP_YR#
														AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
   		  
		AND		DGE = #DGE#
	</delete>
	
	<delete id="CSPDCP512EDeleteDgeAll204L" parameterClass="paramMap">
	DELETE 
   		  FROM TBCSPDCP204L
   		 WHERE REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND ACP_YR      = #ACP_YR#
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND DGE         = #DGE#
	</delete>
	
	<!-- 합건된 자료 삭제 -->
	<delete id="CSPDCP512EDeleteDgeSucAll204L" parameterClass="paramMap">
		DELETE 
		FROM	TBCSPDCP204L
		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
														FROM	TBCSPDCP105L S1
														WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
														AND		S1.ACP_YR = #ACP_YR#
														AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
   		  
		AND		DGE = #DGE#
	</delete>
	<delete id="CSPDCP512EDeleteDgeAll303M" parameterClass="paramMap">
	DELETE 
   		  FROM TBCSPDCP303M
   		 WHERE REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND ACP_YR      = #ACP_YR#
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND DGE         = #DGE#
	</delete>
	<!-- 합건된 자료 삭제 -->
	<delete id="CSPDCP512EDeleteDgeSucAll303M" parameterClass="paramMap">
		DELETE 
		FROM	TBCSPDCP303M
		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
														FROM	TBCSPDCP105L S1
														WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
														AND		S1.ACP_YR = #ACP_YR#
														AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
   		  
		AND		DGE = #DGE#
	</delete>
	<delete id="CSPDCP512EDeleteDgeAll403L" parameterClass="paramMap">
	DELETE 
   		  FROM TBCSPDCP403L
   		 WHERE REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND ACP_YR      = #ACP_YR#
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND DGE         = #DGE#
	</delete>
	
	<!-- 합건자료 삭제 -->
	<delete id="CSPDCP512EDeleteDgeSucAll403L" parameterClass="paramMap">
		DELETE 
		FROM 	TBCSPDCP403L
		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
														FROM	TBCSPDCP105L S1
														WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
														AND		S1.ACP_YR = #ACP_YR#
														AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
   		  
		AND		DGE = #DGE#
	</delete>
	
	<delete id="CSPDCP512EDeleteDgeAll203M" parameterClass="paramMap">
		DELETE 
   		  FROM TBCSPDCP203M
   		 WHERE REQ_DVSN_CD = #REQ_DVSN_CD#
		   AND ACP_YR      = #ACP_YR#
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND DGE         = #DGE#
	</delete>
	
	<!-- 조사결과 보고서 합건 자료 삭제 -->
	<delete id="CSPDCP512EDeleteDgeSucAll203M" parameterClass="paramMap">
		DELETE 
		FROM	TBCSPDCP203M
		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
														FROM	TBCSPDCP105L S1
														WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
														AND		S1.ACP_YR = #ACP_YR#
														AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
   		  
		AND		DGE = #DGE#
	</delete>
	
	<insert id="CSPDCP512EInsertInterFace" parameterClass="paramMap">
	<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_CONTENTS		/*민원 처리결과 내용*/
							,PCD_REG_DATE		/*처리일자*/
							,PCD_CONTENTS_ATTACH_YN	/*민원처리결과첨부여부*/
							,PCD_GUBUN			/*신문고민원 처리구분코드*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,DECODE(SMG_FRT_HNDL_STA_CD, '161','181', '163','183')
							,'N'
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'6')
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'7')
							,F_USR_INFO(#S_CNB#,'2')
							,''
							,'02-2011-2191'
							,#ANS_TXT#
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'N'
							,#SMG_CVPT_HNDL_DVSN_CD#
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M
				WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
				AND		ACP_YR = #ACP_YR#
				AND		CVPT_ACP_NO = #CVPT_ACP_NO#
	]]>
	</insert>
	
	
	<insert id="CSPDCP512ESucInsertInterFace" parameterClass="paramMap">
	<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_CONTENTS		/*민원 처리결과 내용*/
							,PCD_REG_DATE		/*처리일자*/
							,PCD_CONTENTS_ATTACH_YN	/*민원처리결과첨부여부*/
							,PCD_GUBUN			/*신문고민원 처리구분코드*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,DECODE(SMG_FRT_HNDL_STA_CD, '161','181', '163','183')
							,'N'
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'6')
							,F_DPT_INFO(#FNL_DEAL_DPT_CD#,'7')
							,F_USR_INFO(#S_CNB#,'2')
							,''
							,'02-2011-2191'
							,#ANS_TXT#
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'N'
							,#SMG_CVPT_HNDL_DVSN_CD#
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M
				WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
																FROM	TBCSPDCP105L S1
																WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
																AND		S1.ACP_YR = #ACP_YR#
																AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
	]]>
	</insert>
	
	<select id="CSPDCP512ECountChuBun" parameterClass="paramMap" resultClass="java.lang.String">
		<![CDATA[
		SELECT CASE WHEN COUNT(1) = 0 THEN 'Y' ELSE 'N' END  AS CHUBUN_INSERTYN
		  FROM TBCSPDCP403L
		 WHERE 1=1
		   AND ACP_YR      = #ACP_YR# 
		   AND REQ_DVSN_CD = #REQ_DVSN_CD#  
		   AND CVPT_ACP_NO = #CVPT_ACP_NO#
		   AND DGE         = #DGE# 
		   AND AUD_YR      = #AUD_YR# 
		   AND AUD_NO      = #AUD_NO# 
		   AND DSP_RQ_SNO  = #DSP_RQ_SNO#
		
		]]>
	</select>
	
	<update id="CSPDCP512E401NtfUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP401H
			SET		HNDL_RSLT_NTF_YN = 'Y'
					,FRT_USR_ID = #FRT_USR_ID#
					,FNL_USR_ID = #FNL_USR_ID#
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
					,FNL_MNU_ID = #FNL_MNU_ID#
					,FRT_REGI_DH = SYSDATE
					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
			AND		ACP_YR = #ACP_YR#
			AND		CVPT_ACP_NO = #CVPT_ACP_NO#
			AND		DGE = #DGE#
		]]>
	</update>
	
	<!-- 합건자료 -->
	<update id="CSPDCP512E401SucNtfUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPDCP401H
			SET		HNDL_RSLT_NTF_YN = 'Y'
					,FRT_USR_ID = #FRT_USR_ID#
					,FNL_USR_ID = #FNL_USR_ID#
					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
					,FNL_MNU_ID = #FNL_MNU_ID#
					,FRT_REGI_DH = SYSDATE
					,FNL_MDF_DH = SYSDATE
			WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L S1
															WHERE	S1.REQ_DVSN_CD = #REQ_DVSN_CD#
															AND		S1.ACP_YR = #ACP_YR#
															AND		S1.CVPT_ACP_NO = #CVPT_ACP_NO#)	
			AND		DGE = #DGE#
		]]>
	</update>
</sqlMap> 
