<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/dcp/517">
	
	
	<resultMap class="java.util.HashMap" id="CSPDCP517">
 		<result property="REQ_DVSN_CD" column="REQ_DVSN_CD"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
		<result property="ACP_YR" column="ACP_YR"                             jdbcType="VARCHAR2"  javaType="java.lang.String" /> 
		<result property="CVPT_ACP_NO" column="CVPT_ACP_NO"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_NO" column="ACP_NO"                             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ACP_DT" column="ACP_DT"                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPTR_NM" column="CVPTR_NM"             jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="REQR_KND_NM" column="REQR_KND_NM"                         jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="AD" column="AD"                                   jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="TNB" column="TNB"                           jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="TIT_NM" column="TIT_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_DVSN_CD" column="CVPT_DOC_DVSN_CD"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_DVSN_CD2" column="CVPT_DOC_DVSN_CD2"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_DVSN_CD3" column="CVPT_DOC_DVSN_CD3"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_DVSN_CD4" column="CVPT_DOC_DVSN_CD4"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="ORG_NM" column="ORG_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="COPT_SG_NM" column="COPT_SG_NM"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="DGE" column="DGE"                                 jdbcType="VARCHAR2"  javaType="java.lang.String" />
		<result property="CVPT_DOC_TXT" column="CVPT_DOC_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_DOC_TXT2" column="CVPT_DOC_TXT2"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_DOC_TXT3" column="CVPT_DOC_TXT3"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_DOC_TXT4" column="CVPT_DOC_TXT4"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_OPM_APV_HNDL_STA_CD" column="CVPT_OPM_APV_HNDL_STA_CD"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="OPM_TXT" column="OPM_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="CVPT_OPM_SRNO" column="CVPT_OPM_SRNO"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="FL_RUT_NM" column="FL_RUT_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="SYS_FL_NM" column="SYS_FL_NM"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="TITLE" column="TITLE"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
		<result property="RSLT_RPRT_HNDL_RSLT_CD" column="RSLT_RPRT_HNDL_RSLT_CD"                         jdbcType="VARCHAR2"      javaType="java.lang.String" />
 	</resultMap>
 	
	<select id="CSPDCP517PMainSelect" parameterClass="paramMap"
		resultMap="CSPDCP517">
        <![CDATA[     	
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, A.ACP_YR||'-민원-'||C.RM_CVPT_ACP_NO AS ACP_NO
					, TO_CHAR(C.ACP_DH,'YYYY-MM-DD') AS ACP_DT
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) AS CVPTR_NM
					, DECODE(C.REQR_KND_CD,'2','(기업)','') AS REQR_KND_NM
					, DECODE(C.ZCD,NULL,'','(우)'||C.ZCD||' '||C.AD||' '||C.DTL_AD) AS AD
   					, DECODE(C.TNB,NULL,C.HPN,C.TNB) AS TNB
   					, C.TIT_NM
   					, 'B1' AS CVPT_DOC_DVSN_CD
   					, 'B2' AS CVPT_DOC_DVSN_CD2
   					, 'B3' AS CVPT_DOC_DVSN_CD3
   					, 'B4' AS CVPT_DOC_DVSN_CD4
   					, Z.ORG_NM
   					, Z.COPT_SG_NM
   					, #strDGE# AS DGE
   					, CASE WHEN ( 	SELECT 	COUNT(1)
   									FROM	TBCSPDCP203M S1
   									WHERE	1=1
   									AND 	S1.CVPT_DOC_DVSN_CD = 'B1'
				                    AND 	S1.ACP_YR = A.ACP_YR
				                    AND 	S1.REQ_DVSN_CD = A.REQ_DVSN_CD
				                    AND		S1.DGE = #strDGE#
				                    AND		S1.CVPT_ACP_NO = A.CVPT_ACP_NO ) = 0
						THEN	( SELECT S2.CVPT_DOC_TXT
                                    FROM TBCSPDCP203M S2
                                   WHERE 1=1
                                     AND S2.CVPT_DOC_DVSN_CD = 'A1'
                                     AND S2.ACP_YR = A.ACP_YR
                                     AND S2.REQ_DVSN_CD = A.REQ_DVSN_CD
                                     AND S2.CVPT_ACP_NO = A.CVPT_ACP_NO) 
						ELSE	(	SELECT 	D1.CVPT_DOC_TXT
			   						FROM	TBCSPDCP203M D1
			   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
									AND		A.ACP_YR = D1.ACP_YR
									AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO 
									AND		D1.CVPT_DOC_DVSN_CD = 'B1'
									AND		D1.DGE = #strDGE#) END AS CVPT_DOC_TXT
					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO 
						AND		D1.CVPT_DOC_DVSN_CD = 'B2'
						AND		D1.DGE = #strDGE#) AS CVPT_DOC_TXT2
					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO 
						AND		D1.CVPT_DOC_DVSN_CD = 'B3'
						AND		D1.DGE = #strDGE#) AS CVPT_DOC_TXT3
					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO 
						AND		D1.CVPT_DOC_DVSN_CD = 'B4'
						AND		D1.DGE = #strDGE#) AS CVPT_DOC_TXT4
					, D.CVPT_OPM_APV_HNDL_STA_CD
					, E.OPM_TXT
					, D.CVPT_OPM_SRNO
					, F.FL_RUT_NM
					, F.SYS_FL_NM
					, F_CODE_NM('1000370','E')||' (제'||C.ACP_YR||'-민원-'||C.RM_CVPT_ACP_NO||'호) 보고' AS TITLE
					,H.RSLT_RPRT_HNDL_RSLT_CD
			FROM	TBCSPDCP201M A
					, TBCSPDCP101M C
					,(	SELECT	Z.REQ_DVSN_CD, Z.ACP_YR, Z.CVPT_ACP_NO
								,CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(ORG_CD,'1') 
								ELSE Z.ORG_NM END AS ORG_NM
								, CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_HRK_NM(COPT_SG_CD)
								ELSE NULL END AS COPT_SG_NM
   						FROM	TBCSPDCP206L Z
   						WHERE	Z.REQ_DVSN_CD = #strREQ_DVSN_CD#
   						AND		Z.ACP_YR = #strACP_YR#
   						AND		Z.CVPT_ACP_NO = #strCVPT_ACP_NO#
   						AND		Z.ORG_HIS_DVSN_CD ='1'
   						AND		Z.HNDL_ORG_SRNO = (SELECT	MIN(S1.HNDL_ORG_SRNO)
   													FROM	TBCSPDCP206L S1
   													WHERE	S1.REQ_DVSN_CD = #strREQ_DVSN_CD#
							   						AND		S1.ACP_YR = #strACP_YR#
							   						AND		S1.CVPT_ACP_NO = #strCVPT_ACP_NO#
							   						AND		S1.ORG_HIS_DVSN_CD ='1'
							   						)
   					) Z
   					, TBCSPDCP301M D
   					, TBCSPDCP302M E
   					, TBDCMACM103L F
   					, TBCSPDCP401H G
   					, TBCSPDCP402L H
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #strREQ_DVSN_CD#
			AND		A.ACP_YR = #strACP_YR#
			AND		A.CVPT_ACP_NO = #strCVPT_ACP_NO#
			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
			AND		A.ACP_YR = C.ACP_YR
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = Z.REQ_DVSN_CD(+)
			AND		A.ACP_YR = Z.ACP_YR(+)
			AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO(+)
			AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
			AND		A.ACP_YR = D.ACP_YR(+)
			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
			AND		D.REQ_DVSN_CD = E.REQ_DVSN_CD(+)
			AND		D.ACP_YR = E.ACP_YR(+)
			AND		D.CVPT_ACP_NO = E.CVPT_ACP_NO(+)
			AND		D.CVPT_OPM_SRNO = E.CVPT_OPM_SRNO(+)
			AND		D.CVPT_IFM_DVSN_CD(+) = 'E'
			AND		D.DGE(+) = #strDGE#
			AND		D.ONR_DOC_MNG_CRD_ID = F.ONR_DOC_MNG_CRD_ID(+)
			AND	A.REQ_DVSN_CD = G.REQ_DVSN_CD
		   AND	A.ACP_YR = G.ACP_YR
		   AND	A.CVPT_ACP_NO = G.CVPT_ACP_NO
		   AND	G.REQ_DVSN_CD = H.REQ_DVSN_CD
		   AND	G.ACP_YR = H.ACP_YR
		   AND	G.CVPT_ACP_NO = H.CVPT_ACP_NO
		   AND G.DGE = H.DGE
		]]>
	</select>
	
	
	<insert id="CSPDCP517P203Merge" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO /*CSPDCP517P203Merge*/	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_DOC_DVSN_CD# AS CVPT_DOC_DVSN_CD
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        				AND A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #CVPT_DOC_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,#CVPT_DOC_DVSN_CD#
		        					,#CVPT_DOC_TXT#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP517P203Merge2" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO /*CSPDCP517P203Merge2*/	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_DOC_DVSN_CD# AS CVPT_DOC_DVSN_CD
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        				AND A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #CVPT_DOC_TXT2#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,#CVPT_DOC_DVSN_CD#
		        					,#CVPT_DOC_TXT2#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP517P203Merge3" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO /*CSPDCP517P203Merge3*/	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_DOC_DVSN_CD# AS CVPT_DOC_DVSN_CD
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        				AND A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #CVPT_DOC_TXT3#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,#CVPT_DOC_DVSN_CD#
		        					,#CVPT_DOC_TXT3#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<insert id="CSPDCP517P203Merge4" parameterClass="paramMap">
        <![CDATA[
        	MERGE INTO /*CSPDCP517P203Merge4*/	TBCSPDCP203M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_DOC_DVSN_CD# AS CVPT_DOC_DVSN_CD
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        				AND A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_DOC_TXT = #CVPT_DOC_TXT4#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#REQ_DVSN_CD#
									,#ACP_YR#
									,#CVPT_ACP_NO#
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #REQ_DVSN_CD#
										AND		ACP_YR = #ACP_YR#
										AND		CVPT_ACP_NO = #CVPT_ACP_NO#
									)
		        					,#CVPT_DOC_DVSN_CD#
		        					,#CVPT_DOC_TXT4#
		        					,#DGE#
									,#FRT_USR_ID#
									,#FNL_USR_ID#
									,#FNL_DEAL_DPT_CD#
									,#FNL_MNU_ID#
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	
	<!-- 처리전 온나라 결재시 시행문 테이블 Merge -->
	<insert id="CSPDCP517POnr301Merge" parameterClass="paramMap">
		<![CDATA[
			MERGE INTO /*CSPDCP517POnr301Merge*/	TBCSPDCP301M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_OPM_SRNO# AS CVPT_OPM_SRNO
        						,#DGE# AS DGE
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        				AND	A.DGE = B.DGE
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		CVPT_OPM_APV_HNDL_STA_CD = '20'
        					,ADMN_INF_HNDL_NO = #ADMN_INF_HNDL_NO#
        					,ONR_DOC_MNG_CRD_ID = #ONR_DOC_MNG_CRD_ID#
        					,ONR_APV_RQS_DH = SYSDATE
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
				INSERT 	(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_OPM_SRNO
							,DGE
							,CVPT_IFM_DVSN_CD
	       					,CVPT_OPM_APV_HNDL_STA_CD
	       					,ADMN_INF_HNDL_NO
	       					,ONR_DOC_MNG_CRD_ID
	       					,ONR_APV_RQS_DH
	       					,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
	       		VALUES	(	#REQ_DVSN_CD#
							,#ACP_YR#
							,#CVPT_ACP_NO#
							,#CVPT_OPM_SRNO#
							,#DGE#
							,'E'
	       					,'20'
	       					,#ADMN_INF_HNDL_NO#
	       					,#ONR_DOC_MNG_CRD_ID#
	       					,SYSDATE
	       					,#FRT_USR_ID#
	       					,#FNL_USR_ID#
	       					,#FNL_DEAL_DPT_CD#
	       					,#FNL_MNU_ID#
	       					,SYSDATE
	       					,SYSDATE
	       				)
		]]>
	</insert>
	
	<insert id="CSPDCP517POnr302Merge" parameterClass="paramMap">
		<![CDATA[
			MERGE INTO 	TBCSPDCP302M A
        	USING 	(	SELECT 	#REQ_DVSN_CD# AS REQ_DVSN_CD 
        						,#ACP_YR# AS ACP_YR
        						,#CVPT_ACP_NO# AS CVPT_ACP_NO
        						,#CVPT_OPM_SRNO# AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE	
        			SET		OPM_TXT = #OPM_TXT#
        					,FNL_USR_ID = #FNL_USR_ID#
        					,FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
        					,FNL_MNU_ID = #FNL_MNU_ID#
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
				INSERT 	(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_OPM_SRNO
	       					,OPM_TXT
	       					,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
		       				)
		       		VALUES	(	#REQ_DVSN_CD#
								,#ACP_YR#
								,#CVPT_ACP_NO#
								,#CVPT_OPM_SRNO#
								,#OPM_TXT#
		       					,#FRT_USR_ID#
		       					,#FNL_USR_ID#
		       					,#FNL_DEAL_DPT_CD#
		       					,#FNL_MNU_ID#
		       					,SYSDATE
		       					,SYSDATE
		       				)
		]]>
	</insert>
</sqlMap> 
