<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/dcp/417">
 	
 	<resultMap class="java.util.HashMap" id="cspdcp417Map">
 		<result property="ANS_DVSN_CD" column="ANS_DVSN_CD"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
 		<result property="SRNO" column="SRNO"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
 		<result property="TIT_NM" column="TIT_NM"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
 		<result property="ANS_TXT" column="ANS_TXT"                   jdbcType="CLOB" javaType="java.lang.String" />
 		<result property="USR_NAM" column="USR_NAM"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
 		<result property="USR_ID" column="USR_ID"                   jdbcType="VARCHAR2" javaType="java.lang.String" />
 	</resultMap>
 	
 	<select id="CSPDCP417QMainSelect" parameterClass="paramMap"
		resultMap="cspdcp417Map">
		<![CDATA[
		   SELECT D1.ANS_DVSN_CD
		         ,D1.SRNO
		         ,D1.TIT_NM
		         ,D1.ANS_TXT
		         ,D2.USR_NAM
		         ,D2.USR_ID
		     FROM TBCSPDCP001M D1
		         ,TBDCMACM001M D2
		    WHERE 1=1
		      AND D1.FRT_USR_ID = D2.USR_ID(+)
		      AND D1.ANS_DVSN_CD = #ANS_DVSN_CD#
		]]>		
		      <isNotEmpty property="TIT_NM">
		      AND D1.TIT_NM LIKE '%'||#TIT_NM#||'%'
		      </isNotEmpty>
		      ORDER BY D1.SRNO
		
		
	</select>
	
	<select id="CSPDCP417QMaxSrno" parameterClass="paramMap"
		resultClass="java.lang.String"> 
		
		SELECT NVL(MAX(SRNO), 0)+1  AS MAX_SRNO
          FROM TBCSPDCP001M
         WHERE 1=1
           AND ANS_DVSN_CD = #ANS_DVSN_CD#
		
	</select>
	
	<insert id="CSPDCP417QInsert" parameterClass="paramMap">
	<![CDATA[
	INSERT INTO TBCSPDCP001M(
                  ANS_DVSN_CD
                 ,SRNO
                 ,TIT_NM
                 ,ANS_TXT
                 ,FRT_USR_ID
                 ,FNL_USR_ID
                 ,FNL_DEAL_DPT_CD
                 ,FNL_MNU_ID
                 ,FRT_REGI_DH
                 ,FNL_MDF_DH
                 )
             VALUES(
                  #ANS_DVSN_CD#
                 ,#SRNO#
                 ,#TIT_NM#
                 ,#ANS_TXT#
                 ,#FRT_USR_ID#
                 ,#FNL_USR_ID#
                 ,#FNL_DEAL_DPT_CD#
                 ,#FNL_MNU_ID#
                 ,SYSDATE
                 ,SYSDATE
                 )
	]]>
	</insert>
	
	<update id="CSPDCP417QUpdate" parameterClass="paramMap">
	<![CDATA[
	UPDATE TBCSPDCP001M
       SET FNL_USR_ID         = #FNL_USR_ID#
    	  ,FNL_DEAL_DPT_CD    = #FNL_DEAL_DPT_CD#
    	  ,FNL_MNU_ID         = #FNL_MNU_ID#
          ,FNL_MDF_DH         = SYSDATE
          ,TIT_NM = #TIT_NM#
          ,ANS_TXT= #ANS_TXT#
     WHERE ANS_DVSN_CD = #ANS_DVSN_CD#
       AND SRNO        = #SRNO#
	]]>
	</update>
	
	<delete id="CSPDCP417QDelete" parameterClass="paramMap">
	<![CDATA[
	
		      DELETE 
                FROM TBCSPDCP001M
               WHERE 1=1
                 AND ANS_DVSN_CD = #ANS_DVSN_CD#
                 AND SRNO        = #SRNO#
	
	]]>
	</delete>
</sqlMap> 
