<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/012"> 
	<sql id="selBllCd" >
			<isEqual property="strAcntCd" compareValue="17">	   
			     AND BLL_CD   IN ('17','18')
			     AND DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="18">	   
			     AND BLL_CD   IN ('17','18')
			     AND DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="19">	   
			     AND BLL_CD   = '19'
			     AND DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="25">	   
			     AND BLL_CD   = '19'
			     AND DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			</isEqual>	
			<isEqual property="strAcntCd" compareValue="22">	   
			     AND BLL_CD   IN ('22','23','24')
			     AND DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>	
			<isEqual property="strAcntCd" compareValue="23">	   
			     AND BLL_CD   IN ('22','23','24')
			     AND DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="41">	   
			     AND BLL_CD   = '41'
			</isEqual>	
			<isEqual property="strAcntCd" compareValue="42">	   
			     AND BLL_CD   IN ('42','43')
			</isEqual>			
			<isEqual property="strEtcCd" compareValue="99">	   
			     AND BLL_CD  = #strAcntCd#
			</isEqual>
			AND EXISTS (SELECT 1
			              FROM TWFAACAV003M A
			             WHERE COPT_CD = A.COPT_CD 					       		   
			               AND ACNT_CD = A.ACNT_CD
			               AND BLL_CD = A.BLL_CD
			               AND PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
			               AND DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
			               AND A.MDF_DVSN_CD NOT IN 'D')
	</sql>
 
	<select id="FAACAV012EAcntCdselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/012/FAACAV012EAcntCdselect */ ]]>
        <![CDATA[    
			SELECT	RMK_1 AS TERM,
					ACNT_CD
			FROM	TWFAACAV024C
			WHERE	ACNT_DVSN_CD = '31'
			AND		ACNT_CD = #strAcntCd#      
		]]> 	
	</select>
	
	<!--연간접수현황통계조회-->
	<select id="FAACAV012EMainselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/012/FAACAV012EMainselect */ ]]>
		<include refid="include.pageSelct" />		
    	<isEqual property="strTerm" compareValue="01">
		/*증명책임자수(월)*/
		WITH M AS (
			SELECT SUM(CASE WHEN #strYr#||'01' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'01' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'01' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'02' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'02' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'02' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'03' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'03' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'03' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'04' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'04' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'04' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'05' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'05' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'05' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'06' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'06' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'06' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'07' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'07' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'07' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'08' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'08' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'08' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'09' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'09' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'09' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'10' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'10' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'10' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'11' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'11' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'11' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'12' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'12' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'12' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'13' &gt;= NVL(CRE_DT,'000000') AND (#strYr#||'13' &lt;= NVL(ABLT_DT,'999999') OR ABLT_DT IN #strYr#||'12') THEN 1 ELSE 0 END) AS MCNT ,'13' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" />
																			
		),
		/*접수*/
		 R AS(
		       SELECT SUM(CASE WHEN  NVL(MN_1_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_1_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'01' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_2_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_2_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'02' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_3_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_3_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'03' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_4_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_4_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'04' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_5_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_5_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'05' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_6_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_6_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'06' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_7_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_7_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'07' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_8_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_8_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'08' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_9_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_9_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'09' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_1_0_STA_CD,'') &lt;&gt; '*' OR NVL(MN_1_0_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'10' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_1_1_STA_CD,'') &lt;&gt; '*' OR NVL(MN_1_1_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'11' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_1_2_STA_CD,'') &lt;&gt; '*' OR NVL(MN_1_2_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'12' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" /> UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_1_3_STA_CD,'') &lt;&gt; '*' OR NVL(MN_1_3_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'13' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr# <include refid="selBllCd" />
		       
		)

			SELECT ROWNUM AS KEY, M.MM AS MM,TO_CHAR(NVL(M.MCNT,0),'999,999,999') MCNT ,TO_CHAR(NVL(R.RCNT,0),'999,999,999') RCNT ,TO_CHAR(NVL(MCNT-RCNT,0),'999,999,999') NCNT ,NVL(ROUND((R.RCNT / M.MCNT * 100),2),0) RTO,M.MCNT AS TMCNT FROM M,R
			WHERE M.MM = R.MM
		</isEqual>

    	<isEqual property="strTerm" compareValue="03">
		/*증명책임자수(분기)*/
		WITH M AS (
			SELECT SUM(CASE WHEN #strYr#||'03' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'01' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'01' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'06' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'04' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'02' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'09' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'07' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'03' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> UNION ALL
			SELECT SUM(CASE WHEN #strYr#||'12' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'10' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'04' MM FROM TWFAACAV003M  WHERE 1 = 1 AND MDF_DVSN_CD NOT IN 'D' <include refid="selBllCd" /> 
		      
								       			
		),
		/*접수*/
		 R AS(
		       SELECT SUM(CASE WHEN  NVL(MN_1_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_1_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'01' MM FROM TWFAACAV007M WHERE 1 = 1 <include refid="selBllCd" /> AND PROF_YR=#strYr# UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_2_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_2_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'02' MM FROM TWFAACAV007M WHERE 1 = 1 <include refid="selBllCd" /> AND PROF_YR=#strYr# UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_3_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_3_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'03' MM FROM TWFAACAV007M WHERE 1 = 1 <include refid="selBllCd" /> AND PROF_YR=#strYr# UNION ALL
		       SELECT SUM(CASE WHEN  NVL(MN_4_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_4_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'04' MM FROM TWFAACAV007M WHERE 1 = 1 <include refid="selBllCd" /> AND PROF_YR=#strYr#
		       		        

		)

			SELECT ROWNUM AS KEY, M.MM AS MM,TO_CHAR(NVL(M.MCNT,0),'999,999,999') MCNT ,TO_CHAR(NVL(R.RCNT,0),'999,999,999') RCNT ,TO_CHAR(NVL(MCNT-RCNT,0),'999,999,999') NCNT ,NVL(ROUND((R.RCNT / M.MCNT * 100),2),0) RTO,M.MCNT AS TMCNT FROM M,R
			WHERE M.MM = R.MM
		</isEqual>	
		
    	<isEqual property="strTerm" compareValue="05">
		/*증명책임자수(년)*/
		WITH M AS (
			SELECT SUM(CASE WHEN #strYr#||'12' &gt;= NVL(CRE_DT,'000000') AND #strYr#||'01' &lt;= NVL(ABLT_DT,'999999') THEN 1 ELSE 0 END) AS MCNT ,'00' MM FROM TWFAACAV003M
		       WHERE 1 = 1 
			<isEqual property="strAcntCd" compareValue="17">	   
			     AND BLL_CD   IN ('17','18')
			     AND DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="18">	   
			     AND BLL_CD   IN ('17','18')
			     AND DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="19">	   
			     AND BLL_CD   = '19'
			     AND DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="25">	   
			     AND BLL_CD   = '19'
			     AND DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			</isEqual>	
			<isEqual property="strAcntCd" compareValue="22">	   
			     AND BLL_CD   IN ('22','23','24')
			     AND DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>	
			<isEqual property="strAcntCd" compareValue="23">	   
			     AND BLL_CD   IN ('22','23','24')
			     AND DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="41">	   
			     AND BLL_CD   = '41'
			</isEqual>	
			<isEqual property="strAcntCd" compareValue="42">	   
			     AND BLL_CD   IN ('42','43')
			</isEqual>
			<isEqual property="strAcntCd" compareValue="28">	   
			     AND BLL_CD   = '28'
			     AND MDF_DVSN_CD NOT IN 'D'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="30">	   
			     AND BLL_CD   = '30'
			     AND MDF_DVSN_CD NOT IN 'D'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="32">	   
			     AND BLL_CD   = '32'
			     AND MDF_DVSN_CD NOT IN 'D'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="35">	   
			     AND BLL_CD   = '35'
			     AND MDF_DVSN_CD NOT IN 'D'
			</isEqual>			
			<isEqual property="strEtcCd" compareValue="99">	   
			     AND BLL_CD  = #strAcntCd#
			</isEqual>							       			
		),
		/*접수*/
		 R AS(
		       SELECT SUM(CASE WHEN  NVL(MN_1_STA_CD,'') &lt;&gt; '*'  OR NVL(MN_1_STA_CD,'') &lt;&gt; '' THEN 1 ELSE 0 END) RCNT ,'00' MM FROM TWFAACAV007M WHERE PROF_YR=#strYr#

			<isEqual property="strAcntCd" compareValue="17">	   
			     AND BLL_CD   IN ('17','18')
			     AND DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="18">	   
			     AND BLL_CD   IN ('17','18')
			     AND DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="19">	   
			     AND BLL_CD   = '19'
			     AND DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="25">	   
			     AND BLL_CD   = '19'
			     AND DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			</isEqual>	
			<isEqual property="strAcntCd" compareValue="22">	   
			     AND BLL_CD   IN ('22','23','24')
			     AND DL_XPN_RCDB_PBSVT_SRNO = '000'
			</isEqual>	
			<isEqual property="strAcntCd" compareValue="23">	   
			     AND BLL_CD   IN ('22','23','24')
			     AND DL_XPN_RCDB_PBSVT_SRNO &lt;&gt; '000'
			</isEqual>
			<isEqual property="strAcntCd" compareValue="41">	   
			     AND BLL_CD   = '41'
			</isEqual>	
			<isEqual property="strAcntCd" compareValue="42">	   
			     AND BLL_CD   IN ('42','43')
			</isEqual>
			<isEqual property="strAcntCd" compareValue="28">	   
			     AND BLL_CD   = '28'
                 AND EXISTS (SELECT 1
                 			 FROM TWFAACAV003M A
                 			 WHERE COPT_CD = A.COPT_CD
                               AND ACNT_CD = A.ACNT_CD
                               AND BLL_CD = A.BLL_CD
                               AND PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
                               AND DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
                               AND A.MDF_DVSN_CD NOT IN 'D')
			</isEqual>
			<isEqual property="strAcntCd" compareValue="30">	   
			     AND BLL_CD   = '30'
                 AND EXISTS (SELECT 1
                 			 FROM TWFAACAV003M A
                 			 WHERE COPT_CD = A.COPT_CD
                               AND ACNT_CD = A.ACNT_CD
                               AND BLL_CD = A.BLL_CD
                               AND PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
                               AND DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
                               AND A.MDF_DVSN_CD NOT IN 'D')
			</isEqual>
			<isEqual property="strAcntCd" compareValue="32">	   
			     AND BLL_CD   = '32'
                 AND EXISTS (SELECT 1
                 			 FROM TWFAACAV003M A
                 			 WHERE COPT_CD = A.COPT_CD
                               AND ACNT_CD = A.ACNT_CD
                               AND BLL_CD = A.BLL_CD
                               AND PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
                               AND DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
                               AND A.MDF_DVSN_CD NOT IN 'D')
			</isEqual>
			<isEqual property="strAcntCd" compareValue="35">	   
			     AND BLL_CD   = '35'
                 AND EXISTS (SELECT 1
                 			 FROM TWFAACAV003M A
                 			 WHERE COPT_CD = A.COPT_CD
                               AND ACNT_CD = A.ACNT_CD
                               AND BLL_CD = A.BLL_CD
                               AND PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
                               AND DL_XPN_RCDB_PBSVT_SRNO = A.DL_XPN_RCDB_PBSVT_SRNO
                               AND A.MDF_DVSN_CD NOT IN 'D')
            </isEqual>
			<isEqual property="strEtcCd" compareValue="99">	   
			     AND BLL_CD  = #strAcntCd#
			</isEqual>					       		        
		)

			SELECT ROWNUM AS KEY, M.MM AS MM,TO_CHAR(NVL(M.MCNT,0),'999,999,999') MCNT ,TO_CHAR(NVL(R.RCNT,0),'999,999,999') RCNT ,TO_CHAR(NVL(MCNT-RCNT,0),'999,999,999') NCNT ,NVL(ROUND((R.RCNT / M.MCNT * 100),2),0) RTO ,NVL(M.MCNT,0) AS TMCNT FROM M,R
			WHERE M.MM = R.MM
		</isEqual>			
		<include refid="include.pageOrder" />
		ORDER BY KEY, MM
	</select>
	
	<!-- 주기, 증명책임자관직명조회 -->
	<select id="FAACAV012ETermNmselect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/012/FAACAV012ETermNmselect */ ]]>
        <![CDATA[    
			SELECT	DECODE(RMK_1,'01','월','03','분기','05','연간') AS TERMNM,
					RMK_2 AS PSTNM
			FROM	TWFAACAV024C
			WHERE	ACNT_DVSN_CD = '31'
			AND		ACNT_CD = #strAcntCd#  
		]]> 	
	</select>

	
</sqlMap> 
