<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/bii/431">
	<!-- 업무테이블 목록 조회 -->   
	<insert id="CSPBII431ETmpinsert" parameterClass="paramMap" >
		<!-- 업무코드가 [1:감사정보]일 경우 -->
		<isEqual property="strTskCd" compareValue="1">
		INSERT INTO TBCSPBII410L (
			                          YE              /* 연도 */
			                        , SRNO            /* 일련번호 */
			                        , REL_PEN_SNO     /* 관련자순번 */
			                        , BLT_ORG_CD      /* 소속기관코드 */
			                        , REL_ORG_CD      /* 관련기관코드 */
			                        , OCP_CD          /* 직종코드 */
			                        , RANK_NM         /* 직급명 */
			                        , PST_NM          /* 직위명 */
			                        , RRN             /* 주민등록번호 */
			                        , NAM             /* 성명 */
			                        , CHG_RRN         /* 변경주민등록번호 */
			                        , EIN             /* 암호화주민등록번호 */
			                        , FRT_USR_ID      /* 최초사용자ID */
			                        , FNL_USR_ID      /* 최종사용자ID */
			                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
			                        , FNL_MNU_ID      /* 최종메뉴ID */
			                        , FRT_REGI_DH     /* 최초등록일시 */
			                        , FNL_MDF_DH      /* 최종수정일시 */
			                         ) 
			SELECT A.YE          /* 연도 */
			     , A.SRNO        /* 일련번호 */
			     , A.REL_PEN_SNO /* 관련자순번 */
			     , A.BLT_ORG_CD  /* 소속기관코드 */
			     , B.REL_ORG_CD  /* 관련기관코드 */
			     , A.OCP_CD      /* 직종코드 */
			     , A.RANK_NM     /* 직급명 */
			     , A.PST_NM      /* 직위명 */
			     ,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN)
			     , A.NAM         /* 성명 */
			     , NULL
			     , A.EIN         /* 암호화주민등록번호 */
			     , #FRT_USR_ID#
			                        , #FNL_USR_ID#
			                        , #FNL_DEAL_DPT_CD#
			                        , #FNL_MNU_ID#
			                        , SYSDATE
			                        , SYSDATE
			  FROM TBCSPBII130L A /* 감사정보관련자내역 */
			     , TBCSPBII100M B /* 감사정보기본 */			  
			 WHERE A.YE   = B.YE
			   AND A.SRNO = B.SRNO
			   AND A.YE BETWEEN #strStrYe# AND #strEndYe#    
		</isEqual>
		<!-- 업무코드가 [2:처분요구]일 경우 -->
		<isEqual property="strTskCd" compareValue="2">
		INSERT INTO TBCSPBII420L (
			                          AUD_YR          /* 감사년도 */
			                        , AUD_NO          /* 감사번호 */
			                        , DSP_RQ_SNO      /* 처분요구순번 */
			                        , RLTN_ORG_CD     /* 관계기관코드 */
			                        , DFNT_SNO        /* 관계자순번 */
			                        , AD              /* 주소 */
			                        , OCP_CD          /* 직종코드 */
			                        , RANK_CD         /* 직급코드 */
			                        , CMPY_NM         /* 회사명 */
			                        , RRN             /* 성명 */
			                        , DFNT_NAM        /* 관계자성명 */
			                        , CHG_RRN         /* 변경주민등록번호 */
			                        , EIN             /* 암호화주민등록번호 */
			                        , FRT_USR_ID      /* 최초사용자ID */
			                        , FNL_USR_ID      /* 최종사용자ID */
			                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
			                        , FNL_MNU_ID      /* 최종메뉴ID */
			                        , FRT_REGI_DH     /* 최초등록일시 */
			                        , FNL_MDF_DH      /* 최종수정일시 */
			                         ) 
			SELECT A.AUD_YR      /* 감사년도 */
			     , A.AUD_NO      /* 감사번호 */
			     , A.DSP_RQ_SNO  /* 처분요구순번 */
			     , A.RLTN_ORG_CD /* 관계기관코드 */
			     , A.DFNT_SNO    /* 관계자순번 */
			     , A.AD          /* 주소 */
			     , A.OCP_CD      /* 직종코드 */
			     , A.RANK_CD     /* 직급코드 */
			     , A.CMPY_NM     /* 회사명 */
			     ,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN)
			     , A.DFNT_NAM    /* 관계자성명 */
			     ,NULL
			     , A.EIN         /* 암호화주민등록번호 */
			     , #FRT_USR_ID#
			                        , #FNL_USR_ID#
			                        , #FNL_DEAL_DPT_CD#
			                        , #FNL_MNU_ID#
			                        , SYSDATE
			                        , SYSDATE
			  FROM TBBADEAR007M A /* 관계자기본 */
			     , TBBADEAR002D B /* 처분요구사항상세 */			  
			 WHERE A.AUD_YR     = B.AUD_YR
			   AND A.AUD_NO     = B.AUD_NO
			   AND A.DSP_RQ_SNO = B.DSP_RQ_SNO
			   AND B.ENF_DT BETWEEN #strStrYe# || '0101' AND #strEndYe# || '1231'
		</isEqual>
		<!-- 업무코드가 [3:통보사항]일 경우 -->
		<isEqual property="strTskCd" compareValue="3">
		INSERT INTO TBCSPBII430L (
			                          ORG_CD          /* 기관코드 */
			                        , NTF_DVSN_CD     /* 통보구분코드 */
			                        , NNB             /* 통보번호 */
			                        , SRNO            /* 일련번호 */
			                        , PRST_BLT_ORG_CD /* 현재소속기관코드 */
			                        , REL_PEN_OCP_CD  /* 관련자직종코드 */
			                        , REL_PEN_RANK_CD /* 관련자직급코드 */
			                        , PST_NOO         /* 직위직명 */
			                        , PRST_DPT_NM     /* 현재부서명 */
			                        , RRN             /* 주민등록번호 */
			                        , DFNT_NM         /* 관계자명 */
			                        , CHG_RRN         /* 변경주민등록번호 */
			                        , EIN             /* 암호화주민등록번호 */
			                        , FRT_USR_ID      /* 최초사용자ID */
			                        , FNL_USR_ID      /* 최종사용자ID */
			                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
			                        , FNL_MNU_ID      /* 최종메뉴ID */
			                        , FRT_REGI_DH     /* 최초등록일시 */
			                        , FNL_MDF_DH      /* 최종수정일시 */
			                         ) 
			SELECT A.ORG_CD          /* 기관코드 */
			     , A.NTF_DVSN_CD     /* 통보구분코드 */
			     , A.NNB             /* 통보번호 */
			     , A.SRNO            /* 일련번호 */
			     , A.PRST_BLT_ORG_CD /* 현재소속기관코드 */
			     , A.REL_PEN_OCP_CD  /* 관련자직종코드 */
			     , A.REL_PEN_RANK_CD /* 관련자직급코드 */
			     , A.PST_NOO         /* 직위직명 */
			     , A.PRST_DPT_NM     /* 현재부서명 */
			     ,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN)
			     , A.DFNT_NM
			     ,NULL
			     , A.EIN             /* 암호화주민등록번호 */
			     , #FRT_USR_ID#
			                        , #FNL_USR_ID#
			                        , #FNL_DEAL_DPT_CD#
			                        , #FNL_MNU_ID#
			                        , SYSDATE
			                        , SYSDATE
			  FROM TBBADGDA001L A /* 통보사항관계자내역 */
			     , TBBADGDA001M B /* 통보사항기본 */			  
			 WHERE A.ORG_CD      = B.ORG_CD
			   AND A.NTF_DVSN_CD = B.NTF_DVSN_CD
			   AND A.NNB         = B.NNB
			   AND B.REGI_DT BETWEEN #strStrYe# || '0101' AND #strEndYe# || '1231'
		</isEqual>
		<!-- 업무코드가 [4:자체감사]일 경우 -->
		<isEqual property="strTskCd" compareValue="4">
		INSERT INTO TBCSPBII440L (
			                          ORG_CD          /* 기관코드 */
			                        , AUD_YR          /* 감사년도 */
			                        , AUD_SRNO        /* 감사일련번호 */
			                        , EXPOT_MNG_SRNO  /* 사후관리일련번호 */
			                        , SRNO            /* 일련번호 */
			                        , REL_ORG_CD      /* 관련기관코드 */			     
			                        , REL_DPT_NM      /* 관련부서명 */
			                        , RANK_NM         /* 직급명 */			                        
			                        , RRN             /* 주민등록번호 */			                        
			                        , REL_PEN_NM      /* 관련자명 */
			                        , CHG_RRN         /* 변경주민등록번호 */
			                        , EIN             /* 암호화주민등록번호 */
			                        , FRT_USR_ID      /* 최초사용자ID */
			                        , FNL_USR_ID      /* 최종사용자ID */
			                        , FNL_DEAL_DPT_CD /* 최종거래부서코드 */
			                        , FNL_MNU_ID      /* 최종메뉴ID */
			                        , FRT_REGI_DH     /* 최초등록일시 */
			                        , FNL_MDF_DH      /* 최종수정일시 */
			                         ) 
			SELECT A.ORG_CD         /* 기관코드 */
			     , A.AUD_YR         /* 감사년도 */
			     , A.AUD_SRNO       /* 감사일련번호 */
			     , A.EXPOT_MNG_SRNO /* 사후관리일련번호 */
			     , A.SRNO           /* 일련번호 */
			     , A.REL_ORG_CD     /* 관련기관코드 */			     
			     , A.REL_DPT_NM     /* 관련부서명 */
			     , A.RANK_NM        /* 직급명 */
			     ,DGUARD.DECRYPT('TB_ENC','EIN',B.EIN)
			     , A.REL_PEN_NM     /* 관련자명 */
			     ,NULL
			     , B.EIN            /* 암호화주민등록번호 */
			     , #FRT_USR_ID#
			                        , #FNL_USR_ID#
			                        , #FNL_DEAL_DPT_CD#
			                        , #FNL_MNU_ID#
			                        , SYSDATE
			                        , SYSDATE
			  FROM TBFAAAEA021M A /* 처분요구 */
			     , TBFAAAEA032M B /* 주민등록번호정보 */
			 WHERE A.ORG_CD         = B.ORG_CD
			   AND A.AUD_YR         = B.AUD_YR
			   AND A.AUD_SRNO       = B.AUD_SRNO
			   AND A.EXPOT_MNG_SRNO = B.EXPOT_MNG_SRNO
			   AND A.SRNO           = B.SRNO
			   AND A.DSP_RQ_DT BETWEEN #strStrYe# || '0101' AND #strEndYe# || '1231'
		</isEqual>
	</insert>
	
	<!-- 임시테이블 삭제 -->
	<delete id="CSPBII431ETmpdelete" parameterClass="paramMap">
		<!-- 업무코드가 [1:감사정보]일 경우 -->
		<isEqual property="strTskCd" compareValue="1">
			DELETE FROM TBCSPBII410L			 
		</isEqual>
		<!-- 업무코드가 [2:처분요구]일 경우 -->
		<isEqual property="strTskCd" compareValue="2">
			DELETE FROM TBCSPBII420L			 
		</isEqual>
		<!-- 업무코드가 [3:통보사항]일 경우 -->
		<isEqual property="strTskCd" compareValue="3">
			DELETE FROM TBCSPBII430L			 
		</isEqual>
		<!-- 업무코드가 [4:자체감사]일 경우 -->
		<isEqual property="strTskCd" compareValue="4">
			DELETE FROM TBCSPBII440L			 
		</isEqual>
	</delete>
	
	
	<select id="CSPBII431ETmpSelectTotalCount" parameterClass="paramMap" resultClass="Integer">
		<!-- 업무코드가 [1:감사정보]일 경우 -->
		<isEqual property="strTskCd" compareValue="1">
			SELECT COUNT(*) FROM TBCSPBII410L 
		</isEqual>
		<!-- 업무코드가 [2:처분요구]일 경우 -->
		<isEqual property="strTskCd" compareValue="2">
		SELECT COUNT(*) FROM TBCSPBII420L 
		</isEqual>
		<!-- 업무코드가 [3:통보사항]일 경우 -->
		<isEqual property="strTskCd" compareValue="3">
			SELECT COUNT(*) FROM TBCSPBII430L  
		</isEqual>
		<!-- 업무코드가 [4:자체감사]일 경우 -->
		<isEqual property="strTskCd" compareValue="4">
		SELECT COUNT(*) FROM TBCSPBII440L
		</isEqual>
	</select>
	
	<select id="CSPBII431ETmpSelectDecCount" parameterClass="paramMap" resultClass="Integer">
		<!-- 업무코드가 [1:감사정보]일 경우 -->
		<isEqual property="strTskCd" compareValue="1">
			SELECT COUNT(*) FROM TBCSPBII410L WHERE LENGTH(RRN) = 13
		</isEqual>
		<!-- 업무코드가 [2:처분요구]일 경우 -->
		<isEqual property="strTskCd" compareValue="2">
		SELECT COUNT(*) FROM TBCSPBII420L WHERE LENGTH(RRN) = 13
		</isEqual>
		<!-- 업무코드가 [3:통보사항]일 경우 -->
		<isEqual property="strTskCd" compareValue="3">
			SELECT COUNT(*) FROM TBCSPBII430L WHERE LENGTH(RRN) = 13 
		</isEqual>
		<!-- 업무코드가 [4:자체감사]일 경우 -->
		<isEqual property="strTskCd" compareValue="4">
		SELECT COUNT(*) FROM TBCSPBII440L WHERE LENGTH(RRN) = 13 
		</isEqual>
	</select>
	
	
	<!-- 임시테이블 목록 조회 -->   
	<select id="CSPBII431ETmpselect" parameterClass="paramMap" resultClass="resultMap" remapResults="true">
		<!-- 업무코드가 [1:감사정보]일 경우 -->
		<isEqual property="strTskCd" compareValue="1">
			SELECT A.YE          /* 연도 */
			     , A.SRNO        /* 일련번호 */
			     , A.REL_PEN_SNO /* 관련자순번 */
			     , A.CHG_RRN     /* 변경주민등록번호 */
			  FROM TBCSPBII410L A /* 감사정보관련자임시내역 */
			 WHERE A.CHG_RRN IS NOT NULL
		</isEqual>
		<!-- 업무코드가 [2:처분요구]일 경우 -->
		<isEqual property="strTskCd" compareValue="2">
			SELECT A.AUD_YR      /* 감사년도 */
			     , A.AUD_NO      /* 감사번호 */
			     , A.DSP_RQ_SNO  /* 처분요구순번 */
			     , A.RLTN_ORG_CD /* 관계기관코드 */
			     , A.DFNT_SNO    /* 관계자순번 */
			     , A.CHG_RRN     /* 변경주민등록번호 */
			  FROM TBCSPBII420L A /* 관계자기본임시내역 */
			 WHERE A.CHG_RRN IS NOT NULL 
		</isEqual>
		<!-- 업무코드가 [3:통보사항]일 경우 -->
		<isEqual property="strTskCd" compareValue="3">
			SELECT A.ORG_CD       /* 기관코드 */
			     , A.NTF_DVSN_CD /* 통보구분코드 */
			     , A.NNB         /* 통보번호 */
			     , A.SRNO        /* 일련번호 */
			     , A.CHG_RRN     /* 변경주민등록번호 */
			  FROM TBCSPBII430L A /* 통보사항관계자임시내역 */
			 WHERE A.CHG_RRN IS NOT NULL
		</isEqual>
		<!-- 업무코드가 [4:자체감사]일 경우 -->
		<isEqual property="strTskCd" compareValue="4">
			SELECT A.ORG_CD         /* 기관코드 */
			     , A.AUD_YR         /* 감사년도 */
			     , A.AUD_SRNO       /* 감사일련번호 */
			     , A.EXPOT_MNG_SRNO /* 사후관리일련번호 */
			     , A.SRNO           /* 일련번호 */
			     , A.CHG_RRN        /* 변경주민등록번호 */
			  FROM TBCSPBII440L A /* 자체감사처분요구임시내역 */
			 WHERE A.CHG_RRN IS NOT NULL
		</isEqual>
	</select>
	
	<!-- 업무테이블 수정 -->
	<update id="CSPBII431ERalupdate" parameterClass="paramMap">
		<!-- 업무코드가 [1:감사정보]일 경우 -->
		<isEqual property="strTskCd" compareValue="1">
			UPDATE TBCSPBII130L                       
			   SET EIN             = #CHG_RRN#           /* 암호화주민등록번호 */
			     , FNL_USR_ID      = #FNL_USR_ID#        /* 최종사용자ID */
			     , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#   /* 최종거래부서코드 */
			     , FNL_MNU_ID      = #FNL_MNU_ID#        /* 최종메뉴ID */
			     , FNL_MDF_DH      = SYSDATE             /* 최종수정일시 */
			 WHERE YE          = #YE#
			   AND SRNO        = #SRNO#
			   AND REL_PEN_SNO = #REL_PEN_SNO#
		</isEqual>
		<!-- 업무코드가 [2:처분요구]일 경우 -->
		<isEqual property="strTskCd" compareValue="2">
			UPDATE TBBADEAR007M                       
			   SET EIN             = #CHG_RRN#           /* 암호화주민등록번호 */
			     , FNL_USR_ID      = #FNL_USR_ID#        /* 최종사용자ID */
			     , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#   /* 최종거래부서코드 */
			     , FNL_MNU_ID      = #FNL_MNU_ID#        /* 최종메뉴ID */
			     , FNL_MDF_DH      = SYSDATE             /* 최종수정일시 */
			 WHERE AUD_YR      = #AUD_YR#
			   AND AUD_NO      = #AUD_NO#
			   AND DSP_RQ_SNO  = #DSP_RQ_SNO#
			   AND RLTN_ORG_CD = #RLTN_ORG_CD#
			   AND DFNT_SNO    = #DFNT_SNO#
		</isEqual>
		<!-- 업무코드가 [3:통보사항]일 경우 -->
		<isEqual property="strTskCd" compareValue="3">
			UPDATE TBBADGDA001L                       
			   SET EIN             = #CHG_RRN#           /* 암호화주민등록번호 */
			     , FNL_USR_ID      = #FNL_USR_ID#        /* 최종사용자ID */
			     , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#   /* 최종거래부서코드 */
			     , FNL_MNU_ID      = #FNL_MNU_ID#        /* 최종메뉴ID */
			     , FNL_MDF_DH      = SYSDATE             /* 최종수정일시 */
			 WHERE ORG_CD      = #ORG_CD#
			   AND NTF_DVSN_CD = #NTF_DVSN_CD#
			   AND NNB         = #NNB#
			   AND SRNO        = #SRNO#
		</isEqual>
		<!-- 업무코드가 [4:자체감사]일 경우 -->
		<isEqual property="strTskCd" compareValue="4">
			UPDATE TBFAAAEA032M                       
			   SET EIN             = #CHG_RRN#           /* 암호화주민등록번호 */
			     , FNL_USR_ID      = #FNL_USR_ID#        /* 최종사용자ID */
			     , FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#   /* 최종거래부서코드 */
			     , FNL_MNU_ID      = #FNL_MNU_ID#        /* 최종메뉴ID */
			     , FNL_MDF_DH      = SYSDATE             /* 최종수정일시 */
			 WHERE ORG_CD         = #ORG_CD#
			   AND AUD_YR         = #AUD_YR#
			   AND AUD_SRNO       = #AUD_SRNO#
			   AND EXPOT_MNG_SRNO = #EXPOT_MNG_SRNO#
			   AND SRNO           = #SRNO#
		</isEqual>		   
	</update>	
	
	<!-- 임시테이블을 삭제하다. -->
	<delete id="CSPBII431E300TDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPBII300T		
		]]>
		
	</delete>
	
	<!-- 임시기본사항 Insert -->
	<insert id="CSPBII431E300TInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPBII300T
					(RRN
					,NAM
					,OCP_CD
					,RANK_CD
					,RANK_NM
					,DTY_RK_CD
					,PST_NM
					,STND_ORG_CD
					,BLT_DPT_NM
					,DICE_DVSN_CD
					,RSG_DT
					,EIN
					)
			VALUES	(#RRN#
					,#NAM#
					,#OCP_CD#
					,#RANK_CD#
					,#RANK_NM#
					,#DTY_RK_CD#
					,#PST_NM#
					,#STND_ORG_CD#
					,#BLT_DPT_NM#
					,#DICE_DVSN_CD#
					,#RSG_DT#
					,DGUARD.ENCRYPT('TB_ENC','EIN',#RRN#)
					)
		]]>
	</insert>
	
	<delete id="CSPBII431E301TDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPBII301T
		]]>
	</delete>
	
	<insert id="CSPBII431E301TInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPBII301T
					(RRN
					,EIN
					)
			VALUES	(#RRN#
					,DGUARD.ENCRYPT('TB_ENC','EIN',#RRN#)
					)
		]]>
	</insert>
	
	<select id="CSPBII431E342LExcelExportSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	A.EIN
					,A.SRNO
					,A.WRK_STR_DT
					,A.WRK_END_DT
					,A.WRK_PLAC_NM
					,A.PST_NM
					,A.CHR_OW_NM
					,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN) AS RRN
			FROM	TBCSPBII342L A, TBCSPBII300T B
			WHERE   A.EIN = B.EIN	
		]]>
	</select>	
	
	<select id="CSPBII431E322LExcelExportSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	A.EIN
					,A.SRNO
					,A.ISPCT_STR_DT
					,A.ISPCT_END_DT
					,A.TNG_ISPCT_ORG_NM
					,A.ISPCT_STUD_SPH_NM
					,A.NAT_NM
					,A.ENF_ORG_NM
					,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN) AS RRN
			FROM	TBCSPBII322L A, TBCSPBII300T B
			WHERE   A.EIN = B.EIN	
		]]>
	</select>
	
	<!-- 면허자격 엑셀다운로드 -->
	<select id="CSPBII431E330LExcelExportSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	A.EIN
					,A.SRNO
					,A.ACQ_DT
					,A.QLF_NM
					,A.ENF_ORG_NM
					,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN) AS RRN
			FROM	TBCSPBII330L A, TBCSPBII300T B
			WHERE   A.EIN = B.EIN	
		]]>
	</select>
	
	<!-- 국내훈련 엑셀다운로드 -->
	<select id="CSPBII431E321LExcelExportSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	A.EIN
					,A.SRNO
					,A.TRN_STR_DT
					,A.TRN_END_DT
					,A.TRN_DVSN_CD
					,A.TRN_CRS_NM
					,A.TRN_ORG_NM
					,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN) AS RRN
			FROM	TBCSPBII321L A, TBCSPBII300T B
			WHERE   A.EIN = B.EIN	
		]]>
	</select>
	
	<!-- 학력 엑셀다운로드 -->
	<select id="CSPBII431E320LExcelExportSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	A.EIN
					,A.SRNO
					,A.ENT_DT
					,A.GRD_DT
					,A.DEG_CD
					,A.SCHL_NM
					,A.MJR_TXT
					,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN) AS RRN
			FROM	TBCSPBII320L A, TBCSPBII300T B
			WHERE   A.EIN = B.EIN	
		]]>
	</select>
	
	<!-- 포상상훈 엑셀다운로드 -->
	<select id="CSPBII431E350LExcelExportSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	A.EIN
					,A.SRNO
					,A.ACQ_DT
					,A.RWD_KND_NM
					,A.PRZE_NO
					,A.ENF_ORG_NM
					,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN) AS RRN
			FROM	TBCSPBII350L A, TBCSPBII300T B
			WHERE   A.EIN = B.EIN	
		]]>
	</select>
	
	<!-- 임용발령 엑셀다운로드 -->
	<select id="CSPBII431E341LExcelExportSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	A.EIN
					,A.SRNO
					,A.OFOD_DT
					,A.APM_DVSN_NM
					,A.PST_NM
					,A.RANK_NM
					,A.APM_DPT_NM
					,A.OFOD_OFI_NM
					,DGUARD.DECRYPT('TB_ENC','EIN',A.EIN) AS RRN
			FROM	TBCSPBII341L A, TBCSPBII300T B
			WHERE   A.EIN = B.EIN	
		]]>
	</select>
	
	<!-- 전력(근무내역) 테이블 삭제 -->
	<delete id="CSPBII431E342LDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPBII342L
			WHERE	EIN IN (SELECT EIN FROM TBCSPBII300T)
		]]>
	</delete>
	
	<insert id="CSPBII431E342LInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPBII342L
					(EIN
					,SRNO
					,WRK_STR_DT
					,WRK_END_DT
					,WRK_PLAC_NM
					,PST_NM
					,CHR_OW_NM
					,FRT_USR_ID
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,FRT_REGI_DH
					,FNL_MDF_DH
					)
			SELECT DGUARD.ENCRYPT('TB_ENC','EIN',#RRN#)
					,#SRNO#
					,#WRK_STR_DT#
					,#WRK_END_DT#
					,#WRK_PLAC_NM#
					,#PST_NM#
					,#CHR_OW_NM#
					,#FRT_USR_ID#
					,#FNL_USR_ID#
					,#FNL_DEAL_DPT_CD#
					,#FNL_MNU_ID#
					,SYSDATE
					,SYSDATE
			FROM DUAL
					WHERE #RRN# IN (SELECT RRN FROM  TBCSPBII300T)
		]]>
	</insert>
	
	<!-- 국외훈련 테이블 삭제 -->
	<delete id="CSPBII431E322LDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPBII322L
			WHERE	EIN IN (SELECT EIN FROM TBCSPBII300T)
		]]>
	</delete>
	
	<!-- 국외훈련 INSERT -->
	<insert id="CSPBII431E322LInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPBII322L
					(EIN
					,SRNO
					,ISPCT_STR_DT
					,ISPCT_END_DT
					,TNG_ISPCT_ORG_NM
					,ISPCT_STUD_SPH_NM
					,NAT_NM
					,ENF_ORG_NM
					,FRT_USR_ID
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,FRT_REGI_DH
					,FNL_MDF_DH
					)
			SELECT DGUARD.ENCRYPT('TB_ENC','EIN',#RRN#)
					,#SRNO#
					,#ISPCT_STR_DT#
					,#ISPCT_END_DT#
					,#TNG_ISPCT_ORG_NM#
					,#ISPCT_STUD_SPH_NM#
					,#NAT_NM#
					,#ENF_ORG_NM#
					,#FRT_USR_ID#
					,#FNL_USR_ID#
					,#FNL_DEAL_DPT_CD#
					,#FNL_MNU_ID#
					,SYSDATE
					,SYSDATE
			FROM DUAL
					WHERE #RRN# IN (SELECT RRN FROM  TBCSPBII300T)
		]]>
	</insert>
	
	<!-- 면허자격 테이블 삭제 -->
	<delete id="CSPBII431E330LDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPBII330L
			WHERE	EIN IN (SELECT EIN FROM TBCSPBII300T)
		]]>
	</delete>
	
	<!-- 면허자격 INSERT -->
	<insert id="CSPBII431E330LInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPBII330L
					(EIN
					,SRNO
					,ACQ_DT
					,QLF_NM
					,ENF_ORG_NM
					,FRT_USR_ID
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,FRT_REGI_DH
					,FNL_MDF_DH
					)
			SELECT DGUARD.ENCRYPT('TB_ENC','EIN',#RRN#)
					,#SRNO#
					,#ACQ_DT#
					,#QLF_NM#
					,#ENF_ORG_NM#
					,#FRT_USR_ID#
					,#FNL_USR_ID#
					,#FNL_DEAL_DPT_CD#
					,#FNL_MNU_ID#
					,SYSDATE
					,SYSDATE
			FROM DUAL
			WHERE #RRN# IN (SELECT RRN FROM  TBCSPBII300T)
		]]>
	</insert>
	
	
	<!-- 국내훈련 테이블 삭제 -->
	<delete id="CSPBII431E321LDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPBII321L
			WHERE	EIN IN (SELECT EIN FROM TBCSPBII300T)
		]]>
	</delete>
	
	<!-- 국내훈련 INSERT -->
	<insert id="CSPBII431E321LInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPBII321L
					(EIN
					,SRNO
					,TRN_STR_DT
					,TRN_END_DT
					,TRN_DVSN_CD
					,TRN_CRS_NM
					,TRN_ORG_NM
					,FRT_USR_ID
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,FRT_REGI_DH
					,FNL_MDF_DH
					)
			SELECT DGUARD.ENCRYPT('TB_ENC','EIN',#RRN#)
					,#SRNO#
					,#TRN_STR_DT#
					,#TRN_END_DT#
					,#TRN_DVSN_CD#
					,#TRN_CRS_NM#
					,#TRN_ORG_NM#
					,#FRT_USR_ID#
					,#FNL_USR_ID#
					,#FNL_DEAL_DPT_CD#
					,#FNL_MNU_ID#
					,SYSDATE
					,SYSDATE
					FROM DUAL
					WHERE #RRN# IN (SELECT RRN FROM  TBCSPBII300T)
		]]>
	</insert>
	
	<!-- 학력 테이블 삭제 -->
	<delete id="CSPBII431E320LDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPBII320L
			WHERE	EIN IN (SELECT EIN FROM TBCSPBII300T)
		]]>
	</delete>
	
	<!-- 학력 INSERT -->
	<insert id="CSPBII431E320LInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPBII320L
					(EIN
					,SRNO
					,ENT_DT
					,GRD_DT
					,DEG_CD
					,SCHL_NM
					,MJR_TXT
					,FRT_USR_ID
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,FRT_REGI_DH
					,FNL_MDF_DH
					)
			SELECT DGUARD.ENCRYPT('TB_ENC','EIN',#RRN#)
					,#SRNO#
					,#ENT_DT#
					,#GRD_DT#
					,#DEG_CD#
					,#SCHL_NM#
					,#MJR_TXT#
					,#FRT_USR_ID#
					,#FNL_USR_ID#
					,#FNL_DEAL_DPT_CD#
					,#FNL_MNU_ID#
					,SYSDATE
					,SYSDATE
					FROM DUAL
					WHERE #RRN# IN (SELECT RRN FROM  TBCSPBII300T)
		]]>
	</insert>
	
	<!-- 포상상훈 테이블 삭제 -->
	<delete id="CSPBII431E350LDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPBII350L
			WHERE	EIN IN (SELECT EIN FROM TBCSPBII300T)
		]]>
	</delete>
	
	<!-- 포상상훈 INSERT -->
	<insert id="CSPBII431E350LInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPBII350L
					(EIN
					,SRNO
					,ACQ_DT
					,RWD_KND_NM
					,PRZE_NO
					,ENF_ORG_NM
					,FRT_USR_ID
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,FRT_REGI_DH
					,FNL_MDF_DH
					)
			SELECT DGUARD.ENCRYPT('TB_ENC','EIN',#RRN#)
					,#SRNO#
					,#ACQ_DT#
					,#RWD_KND_NM#
					,#PRZE_NO#
					,#ENF_ORG_NM#
					,#FRT_USR_ID#
					,#FNL_USR_ID#
					,#FNL_DEAL_DPT_CD#
					,#FNL_MNU_ID#
					,SYSDATE
					,SYSDATE
			FROM DUAL
					WHERE #RRN# IN (SELECT RRN FROM  TBCSPBII300T)
		]]>
	</insert>
	
	<!-- 임용발령 테이블 삭제 -->
	<delete id="CSPBII431E341LDelete" parameterClass="paramMap">
		<![CDATA[
			DELETE
			FROM	TBCSPBII341L
			WHERE	EIN IN (SELECT EIN FROM TBCSPBII300T)
		]]>
	</delete>
	
	<!-- 임용발령 INSERT -->
	<insert id="CSPBII431E341LInsert" parameterClass="paramMap">
		<![CDATA[
			INSERT INTO TBCSPBII341L
					(EIN
					,SRNO
					,OFOD_DT
					,APM_DVSN_NM
					,PST_NM
					,RANK_NM
					,APM_DPT_NM
					,OFOD_OFI_NM
					,FRT_USR_ID
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,FRT_REGI_DH
					,FNL_MDF_DH
					)
			SELECT	DGUARD.ENCRYPT('TB_ENC','EIN',#RRN#)
					,#SRNO#
					,#OFOD_DT#
					,#APM_DVSN_NM#
					,#PST_NM#
					,#RANK_NM#
					,#APM_DPT_NM#
					,#OFOD_OFI_NM#
					,#FRT_USR_ID#
					,#FNL_USR_ID#
					,#FNL_DEAL_DPT_CD#
					,#FNL_MNU_ID#
					,SYSDATE
					,SYSDATE
			FROM DUAL
					WHERE #RRN# IN (SELECT RRN FROM  TBCSPBII300T)
		]]>
	</insert>
</sqlMap> 
