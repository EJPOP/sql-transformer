<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/024">
	<select id="FAACAV024ECmbBllCdList" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ECmbBllCdList */ ]]>
		SELECT D.*, 
		CD_NM  || ' ' || ' - ' || NVL(DAY_DIV2,'월') || '분' AS DAY_CON
			FROM (
					SELECT 
						CD , 
						CD ||'.' ||' '|| CD_NM AS CD_NM,
						SUBSTR(RMK_2,0,2) AS DAY_DIV,
						REPLACE(SUBSTR(RMK_2,4,5),' ', '') AS DAY_DIV2
					FROM 
			 		 ( 
			 		 	SELECT ACNT_CD AS CD,
							 ACNT_CD_NM AS CD_NM,
							 RMK_2 AS RMK_2
							 FROM TWFAACAV024C 
							WHERE ACNT_DVSN_CD = '03'
							AND ACNT_CD NOT IN ('18','23','24','25','37','38','39','43') 
					) 
		)D
	</select>
	
	<select id="FAACAV024ECmbAcpDvsnCdList" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ECmbAcpDvsnCdList */ ]]>
		SELECT 
		    CD
		   ,CD_NM 
		FROM TBDCMACM013C
		WHERE CMM_CD_DVSN_CD = '1000713'
		AND CD NOT IN ('000000000')	
	</select>
	
	<select id="FAACAV024EMainSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EMainSelect */ ]]>
		<include refid="include.pageSelct" />	
        <![CDATA[
			SELECT 
				ROWNUM AS KEY, 
				COPT_CD||'-'||A.ACNT_CD||'-'||A.BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS ACCMN_ID
				,A.COPT_CD
				,A.ACNT_CD
				,A.BLL_CD
				,A.PROF_DRTR_SRNO
				,A.DL_XPN_RCDB_PBSVT_SRNO
				,ORG_NM
				,F_AV_BLL_COPT_CD_NM(COPT_CD) AS COPT_NM
				,F_AV_ACNT_CD_NM(A.ACNT_CD) AS ACNT_NM
				,CASE 
			        WHEN (A.BLL_CD ='17' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
			        THEN '관서운영경비출납계산서'
			     WHEN (A.BLL_CD='22' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
			        THEN '기금관서운영경비' ELSE ACNT_CD_NM
			     END BLL_NM
				,SUBSTR(CRE_DT,0,4)||'.'||SUBSTR(CRE_DT,5,2) AS CRE_DT
				,SUBSTR(CRE_DT,1,4) AS CRE_DT1
				,SUBSTR(CRE_DT,5,2) AS CRE_DT2
				,SUBSTR(CRE_DT,7,2) AS CRE_DT3
				,CASE WHEN ABLT_DT = '999999' THEN '' ELSE SUBSTR(ABLT_DT,0,4)||'.'||SUBSTR(ABLT_DT,5,2) END AS ABLT_DT
				,SUBSTR(ABLT_DT,1,4) AS ABLT_DT1
				,SUBSTR(ABLT_DT,5,2) AS ABLT_DT2
				,SUBSTR(ABLT_DT,7,2) AS ABLT_DT3
				,RPAD(BR_CD,3,'0') AS BR_CD
				,RPAD(DIV_CD,3,'0') AS DIV_CD
				,C.DPT_NM
				,MDF_DT
				,SUBSTR(MDF_DT,1,4) AS MDF_DT1
				,SUBSTR(MDF_DT,5,2) AS MDF_DT2
				,SUBSTR(MDF_DT,7,2) AS MDF_DT3
			    ,ORG_CD
			    ,SUBSTR(ORG_CD,1,3) AS ORG_CD1
			    ,SUBSTR(ORG_CD,4,3) AS ORG_CD2
			    ,SUBSTR(ORG_CD,7,3) AS ORG_CD3
			    ,SUBSTR(ORG_CD,10,3) AS ORG_CD4
			    ,ORGCHF_NM
			    ,PST_NM    
			    ,MDF_DVSN_CD
			    ,DOC_ENF_NO
			    ,DOC_ENF_DT
			    ,SUBSTR(DOC_ENF_DT,1,4) AS DOC_ENF_DT1
			    ,SUBSTR(DOC_ENF_DT,5,2) AS DOC_ENF_DT2
			    ,SUBSTR(DOC_ENF_DT,7,2) AS DOC_ENF_DT3
			    ,FNCR_EIN AS FNCR_RRN
			    ,FNCR_NM
			    ,EXPN_SSEC_EIN AS EXPN_SSEC_RRN
			    ,EXPN_SSEC_NM
			    ,MDF_PEN_EIN AS MDF_PEN_RRN
			    ,MDF_PEN_NM
			    ,A.TNB
			    ,A.ZCD 
			    ,SUBSTR(A.ZCD,1,3) AS ZCD1
			    ,SUBSTR(A.ZCD,4,3) AS ZCD2
			    ,A.AD
			    ,BZN
			    ,ACP_DVSN_CD
			    ,PROF_DRTR_RMK AS RMK
			    ,APV_LIN_CHGR_NM
			    ,APV_EXAM_PEN_NM
			    ,APVR_NM
			    ,PRSS_STA_CD
			FROM   TWFAACAV003M A, TWFAACAV024C B, TBDCMACM002M C
			WHERE A.BLL_CD = B.ACNT_CD
			AND RPAD(A.BR_CD,3,'0')||RPAD(DIV_CD,3,'0') = C.DPT_CD(+)
			AND ACNT_DVSN_CD = '03'
		]]>
		<isEqual property="rdbPassStaCd" compareValue="2">
			AND PRSS_STA_CD = '02'
		</isEqual>
		<isEqual property="rdbPassStaCd" compareValue="1">
			AND PRSS_STA_CD = '01' 
		</isEqual>
		<isNotEmpty property="strAccMnId1">
			AND A.COPT_CD = #strAccMnId1#
		</isNotEmpty>	   
		<isNotEmpty property="strAccMnId2">
			AND A.ACNT_CD = #strAccMnId2#
		</isNotEmpty>	   
		<isNotEmpty property="strAccMnId3">
			<isEqual property="strAccMnId3" compareValue="17">
				AND A.BLL_CD IN ('17', '18')
			</isEqual>
			<isEqual property="strAccMnId3" compareValue="22">
				AND A.BLL_CD IN ('22', '23')
			</isEqual>
				AND A.BLL_CD = #strAccMnId3#
		</isNotEmpty>	   
		<isNotEmpty property="strAccMnId4">
			AND A.PROF_DRTR_SRNO = #strAccMnId4#
		</isNotEmpty>	   		
		<isNotEmpty property="strAccMnId5">
			AND A.DL_XPN_RCDB_PBSVT_SRNO = #strAccMnId5#
		</isNotEmpty>	   		
		<isNotEmpty property="strCreSdt1">
			<isNotEmpty property="strCreSdt2">
				<isNotEmpty property="strCreSdt3">
					AND A.CRE_DT >= #strCreSdt1#||#strCreSdt2#||#strCreSdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strCreSdt2">
				<isEmpty property="strCreSdt3">
					AND A.CRE_DT >= #strCreSdt1#||#strCreSdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strCreSdt2">
				<isEmpty property="strCreSdt3">
					AND A.CRE_DT >= #strCreSdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   		
		<isNotEmpty property="strCreEdt1">
			<isNotEmpty property="strCreEdt2">
				<isNotEmpty property="strCreEdt3">
					AND A.CRE_DT &lt;= #strCreEdt1#||#strCreEdt2#||#strCreEdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strCreEdt2">
				<isEmpty property="strCreEdt3">
					AND A.CRE_DT &lt;= #strCreEdt1#||#strCreEdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strCreEdt2">
				<isEmpty property="strCreEdt3">
					AND A.CRE_DT &lt;= #strCreEdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   		
		<isNotEmpty property="strAbltSdt1">
			<isNotEmpty property="strAbltSdt2">
				<isNotEmpty property="strAbltSdt3">
					AND A.ABLT_DT >= #strAbltSdt1#||#strAbltSdt2#||#strAbltSdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strAbltSdt2">
				<isEmpty property="strAbltSdt3">
					AND A.ABLT_DT >= #strAbltSdt1#||#strAbltSdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strAbltSdt2">
				<isEmpty property="strAbltSdt3">
					AND A.ABLT_DT >= #strAbltSdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   		
		<isNotEmpty property="strAbltEdt1">
			<isNotEmpty property="strAbltEdt2">
				<isNotEmpty property="strAblEtdt3">
					AND A.ABLT_DT &lt;= #strAbltEdt1#||#strAbltEdt2#||#strAblEtdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strAbltEdt2">
				<isEmpty property="strAblEtdt3">
					AND A.ABLT_DT &lt;= #strAbltEdt1#||#strAbltEdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strAbltEdt2">
				<isEmpty property="strAblEtdt3">
					AND A.ABLT_DT &lt;= #strAbltEdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   	
		<isNotEmpty property="strBrCd">
			AND A.BR_CD = RPAD(#strBrCd#,3,0)
		</isNotEmpty>
		<isNotEmpty property="strDivCd">
			AND A.DIV_CD = RPAD(#strDivCd#,3,0)
		</isNotEmpty>
		<isNotEmpty property="strMdfSdt1">
			<isNotEmpty property="strMdfSdt2">
				<isNotEmpty property="strMdfSdt3">
					AND A.MDF_DT >= #strMdfSdt1#||#strMdfSdt2#||#strMdfSdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strMdfSdt2">
				<isEmpty property="strMdfSdt3">
					AND A.MDF_DT >= #strMdfSdt1#||#strMdfSdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strMdfSdt2">
				<isEmpty property="strMdfSdt3">
					AND A.MDF_DT >= #strMdfSdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="strOrgNm">
			AND A.ORG_NM = #strOrgNm#
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isNotEmpty property="strOrgCd4">
					AND A.ORG_CD = #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
					</isNotEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
					AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'000' AND #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'999' 
					</isEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
					AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||'000000' AND #strOrgCd1#||#strOrgCd2#||'999999' 
					</isEmpty>
				</isEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
					AND A.ORG_CD BETWEEN #strOrgCd1#||'000000000' AND #strOrgCd1#||'999999999' 
					</isEmpty>
				</isEmpty>
			</isEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="rdbMdfDvsnCd">
			AND A.MDF_DVSN_CD = ''
		</isNotEmpty>
		<include refid="include.pageOrder" />
		ORDER BY KEY, ACCMN_ID
	</select>
	
	<!-- 증명책임자부호 Insert 전 부호 있는지 체크 -->	 
	<select id="FAACAV024ECheckAccmnId" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ECheckAccmnId */ ]]>
		SELECT	COUNT(COPT_CD) AS COUNT
		FROM	TWFAACAV003M
		WHERE	COPT_CD = #ACCNO1#
		AND		ACNT_CD = #ACCNO2#
		AND		BLL_CD  = #ACCNO3#
		AND		PROF_DRTR_SRNO = #ACCNO4#
		AND		DL_XPN_RCDB_PBSVT_SRNO  = #ACCNO5#
	</select>
	
	<!--증명책임자부호 insert-->
	<insert id="FAACAV024EInsertNewAccmnId" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertNewAccmnId */ ]]>
		INSERT INTO TWFAACAV003M (
			COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,CRE_DT
			,ORG_CD
			,ORG_NM
			,ORGCHF_NM
			,PST_NM
			,ABLT_DT
			,BR_CD
			,DIV_CD
			,MDF_DT
			,MDF_DVSN_CD
			,DOC_ENF_NO
			,DOC_ENF_DT
			,FNCR_EIN
			,FNCR_NM
			,EXPN_SSEC_EIN
			,EXPN_SSEC_NM
			,MDF_PEN_EIN
			,MDF_PEN_NM
			,TNB
			,ZCD
			,AD
			,BZN
			,ACP_DVSN_CD
			,ENS_USE_YN
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
		) VALUES (
			#strCoptCd#
			,#strAcntCd#
			,#strBllCd#
			,#strProfDrtrSrno#
			,#strDlXpnRcdbPbsvtSrno#
			,REPLACE(#strCreDt1#||#strCreDt2#||#strCreDt3#,'-','')
			,REPLACE(#strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#,'-','')
			,#strOrgNm#
			,#strOrgchfNm#
			,#strPstNm#
			,NVL(DECODE(#strAbltDt1#,'','999999', #strAbltDt1#||#strAbltDt2#||#strAbltDt3#),'999999')
			,RPAD(#strBrCd#,3,'0')
			,RPAD(#strDivCd#,3,'0')
			,REPLACE(#strMdfDt1#||#strMdfDt2#||#strMdfDt3#,'-','')
			,'C'
			<!--,REPLACE(#strDocEnfNo#,'-','')-->
			,#strDocEnfNo#
			,REPLACE(#strDocDt1#||#strDocDt2#||#strDocDt3#,'-','')
			,REPLACE(#strFncrRrn#,'-','')
			,#strFncrNm#
			,REPLACE(#strExpnSsecRrn#,'-','')
			,#strExpnSsecNm#
			,REPLACE(#strMdfPenRrn#,'-','')
			,#strMnfPenNm#
			,REPLACE(#strTnb#,'-','')
			,#strZcd1#||#strZcd2#
			,#strAd#
			,#strBzn#
			,#strAcpDvsnCd#
			,#strEnsUseYn#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FRT_USR_ID#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FNL_USR_ID#
			,#FNL_DEAL_DPT_CD#
			,#FNL_MNU_ID#
		)
	</insert>
	
	<!-- 접수구분 체크해서 가지고있다가 서면이면 다른 TB Insert 사용 -->	 
	<select id="FAACAV024ECheckAcpDvsnCd" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ECheckAcpDvsnCd */ ]]>
		SELECT	ACP_DVSN_CD
		FROM	TWFAACAV003M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</select>
	
	<!-- 계산서 번호가 22,23 공무원번호가 000 이 아닐때 회계코드 테이블에서 계산서 가져오기 -->	 
	<select id="FAACAV024EcheckPtype" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EcheckPtype */ ]]>
        SELECT  CASE RMK_2 WHEN '월'   THEN '01'
                			WHEN '분기' THEN '03'
                			WHEN '연'   THEN '05'
                END AS MON
        FROM    TWFAACAV024C
        WHERE   ACNT_DVSN_CD = '30'
        AND     ACNT_CD = #strBllCd#|| CASE WHEN #strDlXpnRcdbPbsvtSrno# = '000' THEN '000' WHEN #strDlXpnRcdbPbsvtSrno# != '000' THEN 'XXX' END
	</select>
	
	<!--접수마스터 insert-->
	<insert id="FAACAV024EInsertAcpMstr" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertAcpMstr */ ]]>
		INSERT INTO TWFAACAV007M (
				COPT_CD
				,ACNT_CD
				,BLL_CD
				,PROF_DRTR_SRNO
				,DL_XPN_RCDB_PBSVT_SRNO
				,PROF_YR
				,MN_1_STA_CD
				,MN_2_STA_CD
				,MN_3_STA_CD
				,MN_4_STA_CD
				,MN_5_STA_CD
				,MN_6_STA_CD
				,MN_7_STA_CD
				,MN_8_STA_CD
				,MN_9_STA_CD
				,MN_1_0_STA_CD
				,MN_1_1_STA_CD
				,MN_1_2_STA_CD
				,MN_1_3_STA_CD
				,FRT_REGI_DH
				,FRT_USR_ID
				,FNL_MDF_DH
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
		) VALUES (
				#strCoptCd#
				,#strAcntCd#
				,#strBllCd#
				,#strProfDrtrSrno#
				,#strDlXpnRcdbPbsvtSrno#
				,#strCreDt1#
				,#mon1#
				,#mon2#
				,#mon3#
				,#mon4#
				,#mon5#
				,#mon6#
				,#mon7#
				,#mon8#
				,#mon9#
				,#mon10#
				,#mon11#
				,#mon12#
				,#mon13#
				,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,#FRT_USR_ID#
				,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
		)
	</insert>
	
	<!--서류접수마스터 insert-->
	<insert id="FAACAV024EInsertDocMstr" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertDocMstr */ ]]>
		INSERT INTO TWFAACAV008M (
			COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,PROF_YR
			,MN_1_ACP_DT
			,MN_2_ACP_DT
			,MN_3_ACP_DT
			,MN_4_ACP_DT
			,MN_5_ACP_DT
			,MN_6_ACP_DT
			,MN_7_ACP_DT
			,MN_8_ACP_DT
			,MN_9_ACP_DT
			,MN_1_0_ACP_DT
			,MN_1_1_ACP_DT
			,MN_1_2_ACP_DT
			,MN_1_3_ACP_DT
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
		) VALUES (
			#strCoptCd#
			,#strAcntCd#
			,#strBllCd#
			,#strProfDrtrSrno#
			,#strDlXpnRcdbPbsvtSrno#
			,#strCreDt1#
			,#mon1#
			,#mon2#
			,#mon3#
			,#mon4#
			,#mon5#
			,#mon6#
			,#mon7#
			,#mon8#
			,#mon9#
			,#mon10#
			,#mon11#
			,#mon12#
			,#mon13#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FRT_USR_ID#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FNL_USR_ID#
			,#FNL_DEAL_DPT_CD#
			,#FNL_MNU_ID#
		)
	</insert>
		
	<!--접수마스터 insert (접수년도 + 1 <= 현재년도)-->
	<insert id="FAACAV024EInsertAcpMstrNull" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertAcpMstrNull */ ]]>
		INSERT INTO TWFAACAV007M (
			COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,PROF_YR
			,MN_1_STA_CD
			,MN_2_STA_CD
			,MN_3_STA_CD
			,MN_4_STA_CD
			,MN_5_STA_CD
			,MN_6_STA_CD
			,MN_7_STA_CD
			,MN_8_STA_CD
			,MN_9_STA_CD
			,MN_1_0_STA_CD
			,MN_1_1_STA_CD
			,MN_1_2_STA_CD
			,MN_1_3_STA_CD
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
		) VALUES (
			#strCoptCd#
			,#strAcntCd#
			,#strBllCd#
			,#strProfDrtrSrno#
			,#strDlXpnRcdbPbsvtSrno#
			,#strCreDt1#
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FRT_USR_ID#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FNL_USR_ID#
			,#FNL_DEAL_DPT_CD#
			,#FNL_MNU_ID#
		)
	</insert>	
	
	<!--서류접수마스터 insert (접수년도 + 1 <= 현재년도)-->
	<insert id="FAACAV024EInsertDocMstrNull" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertDocMstrNull */ ]]>
		INSERT INTO TWFAACAV008M (
			COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,PROF_YR
			,MN_1_ACP_DT
			,MN_2_ACP_DT
			,MN_3_ACP_DT
			,MN_4_ACP_DT
			,MN_5_ACP_DT
			,MN_6_ACP_DT
			,MN_7_ACP_DT
			,MN_8_ACP_DT
			,MN_9_ACP_DT
			,MN_1_0_ACP_DT
			,MN_1_1_ACP_DT
			,MN_1_2_ACP_DT
			,MN_1_3_ACP_DT
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
		) VALUES (
			#strCoptCd#
			,#strAcntCd#
			,#strBllCd#
			,#strProfDrtrSrno#
			,#strDlXpnRcdbPbsvtSrno#
			,#strCreDt1#
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,''
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FRT_USR_ID#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FNL_USR_ID#
			,#FNL_DEAL_DPT_CD#
			,#FNL_MNU_ID#
		)
	</insert>

	<!--접수마스터 insert (접수년도 + 1 <= 현재년도)-->
	<insert id="FAACAV024EInsertAcpMstrNull2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertAcpMstrNull2 */ ]]>
		INSERT INTO TWFAACAV007M (
			COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,PROF_YR
			,MN_1_STA_CD
			,MN_2_STA_CD
			,MN_3_STA_CD
			,MN_4_STA_CD
			,MN_5_STA_CD
			,MN_6_STA_CD
			,MN_7_STA_CD
			,MN_8_STA_CD
			,MN_9_STA_CD
			,MN_1_0_STA_CD
			,MN_1_1_STA_CD
			,MN_1_2_STA_CD
			,MN_1_3_STA_CD
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
		) VALUES (
			#strCoptCd#
			,#strAcntCd#
			,#strBllCd#
			,#strProfDrtrSrno#
			,#strDlXpnRcdbPbsvtSrno#
			,#strCreDt1#
			,''
			,''
			,''
			,''
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FRT_USR_ID#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FNL_USR_ID#
			,#FNL_DEAL_DPT_CD#
			,#FNL_MNU_ID#
		)
	</insert>	
	
	<!--서류접수마스터 insert (접수년도 + 1 <= 현재년도)-->
	<insert id="FAACAV024EInsertDocMstrNull2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertDocMstrNull2 */ ]]>
		INSERT INTO TWFAACAV008M (
			COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,PROF_YR
			,MN_1_ACP_DT
			,MN_2_ACP_DT
			,MN_3_ACP_DT
			,MN_4_ACP_DT
			,MN_5_ACP_DT
			,MN_6_ACP_DT
			,MN_7_ACP_DT
			,MN_8_ACP_DT
			,MN_9_ACP_DT
			,MN_1_0_ACP_DT
			,MN_1_1_ACP_DT
			,MN_1_2_ACP_DT
			,MN_1_3_ACP_DT
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
		) VALUES (
			#strCoptCd#
			,#strAcntCd#
			,#strBllCd#
			,#strProfDrtrSrno#
			,#strDlXpnRcdbPbsvtSrno#
			,#strCreDt1#
			,''
			,''
			,''
			,''
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FRT_USR_ID#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FNL_USR_ID#
			,#FNL_DEAL_DPT_CD#
			,#FNL_MNU_ID#
		)
	</insert>	
	
	<!--접수마스터 insert (접수년도 + 1 <= 현재년도)-->
	<insert id="FAACAV024EInsertAcpMstrNull3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertAcpMstrNull3 */ ]]>
		INSERT INTO TWFAACAV007M (
			COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,PROF_YR
			,MN_1_STA_CD
			,MN_2_STA_CD
			,MN_3_STA_CD
			,MN_4_STA_CD
			,MN_5_STA_CD
			,MN_6_STA_CD
			,MN_7_STA_CD
			,MN_8_STA_CD
			,MN_9_STA_CD
			,MN_1_0_STA_CD
			,MN_1_1_STA_CD
			,MN_1_2_STA_CD
			,MN_1_3_STA_CD
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
		) VALUES (
			#strCoptCd#
			,#strAcntCd#
			,#strBllCd#
			,#strProfDrtrSrno#
			,#strDlXpnRcdbPbsvtSrno#
			,#strCreDt1#
			,''
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FRT_USR_ID#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FNL_USR_ID#
			,#FNL_DEAL_DPT_CD#
			,#FNL_MNU_ID#
		)
	</insert>	
	
	<!--서류접수마스터 insert (접수년도 + 1 <= 현재년도)-->
	<insert id="FAACAV024EInsertDocMstrNull3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertDocMstrNull3 */ ]]>
		INSERT INTO TWFAACAV008M (
			COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,PROF_YR
			,MN_1_ACP_DT
			,MN_2_ACP_DT
			,MN_3_ACP_DT
			,MN_4_ACP_DT
			,MN_5_ACP_DT
			,MN_6_ACP_DT
			,MN_7_ACP_DT
			,MN_8_ACP_DT
			,MN_9_ACP_DT
			,MN_1_0_ACP_DT
			,MN_1_1_ACP_DT
			,MN_1_2_ACP_DT
			,MN_1_3_ACP_DT
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
		) VALUES (
			#strCoptCd#
			,#strAcntCd#
			,#strBllCd#
			,#strProfDrtrSrno#
			,#strDlXpnRcdbPbsvtSrno#
			,#strCreDt1#
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,'*'
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FRT_USR_ID#
			,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			,#FNL_USR_ID#
			,#FNL_DEAL_DPT_CD#
			,#FNL_MNU_ID#
		)
	</insert>
	
	<!--증명책임자부호 update-->
	<update id="FAACAV024EMainUpdate" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EMainUpdate */ ]]>
		UPDATE	TWFAACAV003M
		SET		ORG_CD                   = #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
				,ORG_NM                   = #strOrgNm#
				,ORGCHF_NM                = #strOrgchfNm#
				,PST_NM                   = #strPstNm#
				,BR_CD                    = #strBrCd#
				,DIV_CD                   = #strDivCd#
				,MDF_DT                   = #strMdfDt1#||#strMdfDt2#||#strMdfDt3#
				<isNotEmpty property="strMdfDvsnCd">
				,MDF_DVSN_CD              = #strMdfDvsnCd#
				</isNotEmpty>
				,DOC_ENF_NO               = #strDocEnfNo#
				,DOC_ENF_DT               = #strDocDt1#||#strDocDt2#||#strDocDt3#
				,FNCR_EIN                 = REPLACE(#strFncrRrn#,'-','')
				,FNCR_NM                  = #strFncrNm#
				,EXPN_SSEC_EIN            = REPLACE(#strExpnSsecRrn#,'-','')
				,EXPN_SSEC_NM             = #strExpnSsecNm#
				,MDF_PEN_EIN              = REPLACE(#strMdfPenRrn#,'-','')
				,MDF_PEN_NM               = #strMnfPenNm#
				,TNB                      = REPLACE(#strTnb#,'-','')
				,ZCD                      = #strZcd1#||#strZcd2#
				,AD                       = #strAd#
				,BZN                      = #strBzn#
				,ACP_DVSN_CD              = #strAcpDvsnCd#
				,ENS_USE_YN				  = #strEnsUseYn#
				,FNL_MDF_DH               = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,FNL_USR_ID               = #FNL_USR_ID#
				,FNL_DEAL_DPT_CD          = #FNL_DEAL_DPT_CD#
				,FNL_MNU_ID               = #FNL_MNU_ID#
		WHERE	COPT_CD                   = #strCoptCd#
		AND		ACNT_CD                  = #strAcntCd#
		AND		BLL_CD                   = #strBllCd#
		AND		PROF_DRTR_SRNO           = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO   = #strDlXpnRcdbPbsvtSrno#
	</update>

    <!-- ============================================신설일자 수정 시작=======================================================  -->	
	<!-- 계산서이력테이블 조회 -->	 
	<select id="FAACAV024ESelectProfYm" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectProfYm */ ]]>
		SELECT	PROF_YM
		FROM	TWFAACAV002H
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YM &lt; ( CASE WHEN #pType# = '01' 
									THEN CASE 	WHEN #strCreDt2# = '01' THEN #strCreDt1#-1||'13' 
												ELSE #strCreDt1#||#strCreDt2#
								         END    					     
							    	WHEN #pType# = '03' 
							        THEN CASE	WHEN #strCreDt2# > '09' THEN #strCreDt1#||'04' 						    	
											 	WHEN #strCreDt2# > '06' THEN #strCreDt1#||'03'						
											 	WHEN #strCreDt2# > '03' THEN #strCreDt1#||'02'
											 	ELSE #strCreDt1#||'01' 
										 END 					
							    ELSE #strCreDt1#||'00' 
								END )
		AND RCPT_STA_CD = 'A'
	</select>		
	
	<!--증명책임자부호  테이블 신설일자 및 DOC 수정-->
	<update id="FAACAV024EUpdateData" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EUpdateData */ ]]>
		UPDATE	TWFAACAV003M
		SET		CRE_DT = #strCreDt1#||#strCreDt2#||#strCreDt3#,
				DOC_ENF_NO = #strDocEnfNo#,
				DOC_ENF_DT = #strDocDt1#||#strDocDt2#||#strDocDt3#,
				MDF_DT = #strMdfDt1#||#strMdfDt2#||#strMdfDt3#,
				MDF_DVSN_CD  = 'U',
				ENS_USE_YN = #strEnsUseYn#
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</update>
	
	<!-- 신설일 및 폐지일 가져오기 -->	 
	<select id="FAACAV024EcheckDate" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EcheckDate */ ]]>
		SELECT	CRE_DT, ABLT_DT 
		FROM	TWFAACAV003M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</select>
			
	<!-- 신설일 수정시 접수마스터 데이터 있는지 확인 -->	 
	<select id="FAACAV024ESelectMst" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectMst */ ]]>
		SELECT	NVL(PROF_YR,0) AS PROF_YR 
		FROM	TWFAACAV007M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR = #startYear#
	</select>		
	
	<!--접수마스터 테이블 INSERT-->
	<insert id="FAACAV024EInsertMst" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertMst */ ]]>
		INSERT INTO TWFAACAV007M 
		(
			COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YR
			, FRT_REGI_DH
			, FRT_USR_ID
			, FNL_MDF_DH
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
		) VALUES(
			#strCoptCd#
			, #strAcntCd#
			, #strBllCd#
			, #strProfDrtrSrno#
			, #strDlXpnRcdbPbsvtSrno#
			, #startYear#
			, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, #FRT_USR_ID#
			, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
		)
	</insert>
		
	<!-- 신설일 수정시 서류접수마스터 데이터 있는지 확인 -->	 
	<select id="FAACAV024ESelectAcctPaperMst" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectAcctPaperMst */ ]]>
		SELECT	NVL(PROF_YR,0) AS PROF_YR
		FROM	TWFAACAV008M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR = #startYear#
	</select>		
	
	<!--서류접수마스터 테이블 INSERT-->
	<insert id="FAACAV024EInsertAcctPaperMst" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EInsertAcctPaperMst */ ]]>
		INSERT INTO TWFAACAV008M 
		(
			COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YR
			, FRT_REGI_DH
			, FRT_USR_ID
			, FNL_MDF_DH
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
		) VALUES(
			#strCoptCd#
			, #strAcntCd#
			, #strBllCd#
			, #strProfDrtrSrno#
			, #strDlXpnRcdbPbsvtSrno#
			, #startYear#
			, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, #FRT_USR_ID#
			, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
		)
	</insert>
	
	<!--접수마스터 테이블 update-->
	<update id="FAACAV024EUpdateAcctMster" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EUpdateAcctMster */ ]]>
		UPDATE	TWFAACAV007M
		SET		MN_1_STA_CD  = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '01') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '01')  THEN '*' ELSE CASE WHEN NVL(MN_1_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_STA_CD ELSE NULL END END ,
				MN_2_STA_CD  = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '02') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '02')  THEN '*' ELSE CASE WHEN NVL(MN_2_STA_CD,' ') NOT IN('*', ' ')   THEN MN_2_STA_CD ELSE NULL END END ,
				MN_3_STA_CD  = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '03') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '03')  THEN '*' ELSE CASE WHEN NVL(MN_3_STA_CD,' ') NOT IN('*', ' ')   THEN MN_3_STA_CD ELSE NULL END END ,
				MN_4_STA_CD  = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '04') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '04')  THEN '*' ELSE CASE WHEN NVL(MN_4_STA_CD,' ') NOT IN('*', ' ')   THEN MN_4_STA_CD ELSE NULL END END ,
				MN_5_STA_CD  = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '05') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '05')  THEN '*' ELSE CASE WHEN NVL(MN_5_STA_CD,' ') NOT IN('*', ' ')   THEN MN_5_STA_CD ELSE NULL END END ,
				MN_6_STA_CD  = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '06') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '06')  THEN '*' ELSE CASE WHEN NVL(MN_6_STA_CD,' ') NOT IN('*', ' ')   THEN MN_6_STA_CD ELSE NULL END END ,
				MN_7_STA_CD  = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '07') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '07')  THEN '*' ELSE CASE WHEN NVL(MN_7_STA_CD,' ') NOT IN('*', ' ')   THEN MN_7_STA_CD ELSE NULL END END ,
				MN_8_STA_CD  = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '08') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '08')  THEN '*' ELSE CASE WHEN NVL(MN_8_STA_CD,' ') NOT IN('*', ' ')   THEN MN_8_STA_CD ELSE NULL END END ,
				MN_9_STA_CD  = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '09') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '09')  THEN '*' ELSE CASE WHEN NVL(MN_9_STA_CD,' ') NOT IN('*', ' ')   THEN MN_9_STA_CD ELSE NULL END END ,
				MN_1_0_STA_CD   = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '10') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '10')  THEN '*' ELSE CASE WHEN NVL(MN_1_0_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_0_STA_CD ELSE NULL END END ,
				MN_1_1_STA_CD   = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '11') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '11')  THEN '*' ELSE CASE WHEN NVL(MN_1_1_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_1_STA_CD ELSE NULL END END ,
				MN_1_2_STA_CD   = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '12') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '12')  THEN '*' ELSE CASE WHEN NVL(MN_1_2_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_2_STA_CD ELSE NULL END END ,
				MN_1_3_STA_CD   = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '12') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '12')  THEN '*' ELSE CASE WHEN NVL(MN_1_3_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_3_STA_CD ELSE NULL END END 
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR = #startYear#
	</update>
		
	<!--서류접수마스터 update -->
	<update id="FAACAV024EUpdateAcctPaperMst" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EUpdateAcctPaperMst */ ]]>
		UPDATE	TWFAACAV008M
		SET		MN_1_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '01') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '01')  THEN '*' ELSE CASE WHEN NVL(MN_1_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_ACP_DT ELSE NULL END END ,  
				MN_2_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '02') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '02')  THEN '*' ELSE CASE WHEN NVL(MN_2_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_2_ACP_DT ELSE NULL END END ,  
				MN_3_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '03') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '03')  THEN '*' ELSE CASE WHEN NVL(MN_3_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_3_ACP_DT ELSE NULL END END ,  
				MN_4_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '04') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '04')  THEN '*' ELSE CASE WHEN NVL(MN_4_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_4_ACP_DT ELSE NULL END END ,  
				MN_5_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '05') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '05')  THEN '*' ELSE CASE WHEN NVL(MN_5_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_5_ACP_DT ELSE NULL END END ,  
				MN_6_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '06') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '06')  THEN '*' ELSE CASE WHEN NVL(MN_6_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_6_ACP_DT ELSE NULL END END ,  
				MN_7_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '07') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '07')  THEN '*' ELSE CASE WHEN NVL(MN_7_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_7_ACP_DT ELSE NULL END END ,  
				MN_8_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '08') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '08')  THEN '*' ELSE CASE WHEN NVL(MN_8_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_8_ACP_DT ELSE NULL END END ,  
				MN_9_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '09') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '09')  THEN '*' ELSE CASE WHEN NVL(MN_9_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_9_ACP_DT ELSE NULL END END ,  
				MN_1_0_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '10') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '10') THEN '*' ELSE CASE WHEN NVL(MN_1_0_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_0_ACP_DT ELSE NULL END END ,
				MN_1_1_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '11') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '11') THEN '*' ELSE CASE WHEN NVL(MN_1_1_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_1_ACP_DT ELSE NULL END END ,
				MN_1_2_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '12') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '12') THEN '*' ELSE CASE WHEN NVL(MN_1_2_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_2_ACP_DT ELSE NULL END END ,
				MN_1_3_ACP_DT = CASE WHEN  (SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,1,4) = #startYear# AND SUBSTR(#strCreDt1#||#strCreDt2#||#strCreDt3#,5,2) > '12') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '12') THEN '*' ELSE CASE WHEN NVL(MN_1_3_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_3_ACP_DT ELSE NULL END END
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</update>
	
	<!--접수마스터 테이블 update-->
	<update id="FAACAV024EUpdateAcctMster2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EUpdateAcctMster2 */ ]]>
		UPDATE	TWFAACAV007M
		SET		<![CDATA[
				MN_1_STA_CD  = CASE WHEN  #strCreDt1#||#strCreDt2# >= #startYear#||'03' OR #delDate# < #startYear#||'01' THEN '*' ELSE CASE WHEN MN_1_STA_CD NOT IN ('*') THEN MN_1_STA_CD ELSE NULL END END ,
				MN_2_STA_CD  = CASE WHEN  #strCreDt1#||#strCreDt2# >= #startYear#||'06' OR #delDate# < #startYear#||'04' THEN '*' ELSE CASE WHEN MN_2_STA_CD NOT IN ('*') THEN MN_2_STA_CD ELSE NULL END END ,
				MN_3_STA_CD  = CASE WHEN  #strCreDt1#||#strCreDt2# >= #startYear#||'09' OR #delDate# < #startYear#||'07' THEN '*' ELSE CASE WHEN MN_3_STA_CD NOT IN ('*') THEN MN_3_STA_CD ELSE NULL END END ,
				MN_4_STA_CD  = CASE WHEN  #strCreDt1#||#strCreDt2# >= #startYear#||'13' OR #delDate# < #startYear#||'10' THEN '*' ELSE CASE WHEN MN_4_STA_CD NOT IN ('*') THEN MN_4_STA_CD ELSE NULL END END ,
				]]>
				MN_5_STA_CD  = '*', 
				MN_6_STA_CD  = '*',
				MN_7_STA_CD  = '*',
				MN_8_STA_CD  = '*',
				MN_9_STA_CD  = '*',
				MN_1_0_STA_CD = '*',
				MN_1_1_STA_CD = '*',
				MN_1_2_STA_CD = '*',
				MN_1_3_STA_CD = '*'
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR = #startYear#
	</update>
	
	<!--서류접수마스터 update -->
	<update id="FAACAV024EUpdateAcctPaperMst2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EUpdateAcctPaperMst2 */ ]]>
		UPDATE	TWFAACAV008M
		SET		<![CDATA[
				MN_1_ACP_CD  = CASE WHEN  #strCreDt1#||#strCreDt2# >= #startYear#||'03' OR #delDate# < #startYear#||'01' THEN '*' ELSE CASE WHEN MN_1_ACP_CD NOT IN ('*') THEN MN_1_ACP_CD ELSE NULL END END ,
				MN_2_ACP_CD  = CASE WHEN  #strCreDt1#||#strCreDt2# >= #startYear#||'06' OR #delDate# < #startYear#||'04' THEN '*' ELSE CASE WHEN MN_2_ACP_CD NOT IN ('*') THEN MN_2_ACP_CD ELSE NULL END END ,
				MN_3_ACP_CD  = CASE WHEN  #strCreDt1#||#strCreDt2# >= #startYear#||'09' OR #delDate# < #startYear#||'07' THEN '*' ELSE CASE WHEN MN_3_ACP_CD NOT IN ('*') THEN MN_3_ACP_CD ELSE NULL END END ,
				MN_4_ACP_CD  = CASE WHEN  #strCreDt1#||#strCreDt2# >= #startYear#||'13' OR #delDate# < #startYear#||'10' THEN '*' ELSE CASE WHEN MN_4_ACP_CD NOT IN ('*') THEN MN_4_ACP_CD ELSE NULL END END ,
				]]>  
				MN_5_ACP_DT = '*',
				MN_6_ACP_DT = '*',
				MN_7_ACP_DT = '*',
				MN_8_ACP_DT = '*',
				MN_9_ACP_DT = '*',
				MN_1_0_ACP_DT = '*',
				MN_1_1_ACP_DT = '*',
				MN_1_2_ACP_DT = '*',
				MN_1_3_ACP_DT = '*'
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR = #startYear#
	</update>
	
	<!--접수마스터 테이블 update-->
	<update id="FAACAV024EUpdateAcctMster3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EUpdateAcctMster3 */ ]]>
		UPDATE	TWFAACAV007M
		SET		MN_1_STA_CD  = NULL,
				MN_2_STA_CD  = '*',
				MN_3_STA_CD  = '*',
				MN_4_STA_CD  = '*',
				MN_5_STA_CD  = '*',
				MN_6_STA_CD  = '*',
				MN_7_STA_CD  = '*',
				MN_8_STA_CD  = '*',
				MN_9_STA_CD  = '*',
				MN_1_0_STA_CD   = '*',
				MN_1_1_STA_CD   = '*',
				MN_1_2_STA_CD   = '*',
				MN_1_3_STA_CD   = '*' 
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR = #startYear#
	</update>
	
	<!--서류 접수마스터 테이블 update-->
	<update id="FAACAV024EUpdateAcctPaperMst3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EUpdateAcctPaperMst3 */ ]]>
		UPDATE	TWFAACAV008M
		SET		MN_1_STA_CD  = NULL,
				MN_2_STA_CD  = '*',
				MN_3_STA_CD  = '*',
				MN_4_STA_CD  = '*',
				MN_5_STA_CD  = '*',
				MN_6_STA_CD  = '*',
				MN_7_STA_CD  = '*',
				MN_8_STA_CD  = '*',
				MN_9_STA_CD  = '*',
				MN_1_0_STA_CD   = '*',
				MN_1_1_STA_CD   = '*',
				MN_1_2_STA_CD   = '*',
				MN_1_3_STA_CD   = '*' 
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR = #startYear#
	</update>
	
	<!--접수마스터 테이블 연간폐지-->
	<update id="FAACAV024EnDeleteAcctMster" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EnDeleteAcctMster */ ]]>
		UPDATE	TWFAACAV007M
		SET		MN_1_STA_CD  = '*'
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR = #startYear#
	</update>
	
	<!--서류 접수마스터 테이블 연간폐지 update-->
	<update id="FAACAV024EnDeleteAcctPaperMst" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EnDeleteAcctPaperMst */ ]]>
		UPDATE	TWFAACAV008M
		SET		MN_1_STA_CD  = '*'
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR = #startYear#
	</update>
	
	<!-- 신설일 수정시 접수마스터 데이터 있는지 확인 -->	 
	<select id="FAACAV024ESelectMst2" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectMst2 */ ]]>
		SELECT	NVL(PROF_YR,0) AS PROF_YR
		FROM	TWFAACAV007M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR &lt; #strCreDt1#
	</select>		
	
	<!--접수마스터 삭제 -->
	<update id="FAACAV024EDeleteAcctMst" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EDeleteAcctMst */ ]]>
		DELETE	TWFAACAV007M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR &lt; #strCreDt1#
	</update>
	
	<!-- 신설일 수정시 서류접수마스터 데이터 있는지 확인 -->	 
	<select id="FAACAV024ESelectAcctPaperMst2" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectAcctPaperMst2 */ ]]>
		SELECT	NVL(PROF_YR,0) AS PROF_YR
		FROM	TWFAACAV008M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR &lt; #strCreDt1#
	</select>
					
	<!-- 신설일 수정시 서류접수마스터 서류접수마스터 삭제-->	 
	<delete id="FAACAV024EDeleteAcctPaperMst" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EDeleteAcctPaperMst */ ]]>
		DELETE	TWFAACAV008M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR &lt; #strCreDt1#
	</delete>
	<!-- ============================================신설일자 수정 끝=======================================================  -->
	
	
    <!-- ============================================폐지일자 수정 시작=======================================================  -->	
	<!-- 계산서이력테이블 조회 -->	 
	<select id="FAACAV024ESelectProfYmAblt" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectProfYmAblt */ ]]>
		SELECT  NVL(PROF_YM,0) AS PROF_YM
		FROM    TWFAACAV002H
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND     PROF_YM > (CASE WHEN #pType# = '01' THEN
		                            CASE    WHEN SUBSTR(#strAbltDt1#||#strAbltDt2#,5,2)='12' THEN SUBSTR(#strAbltDt1#||#strAbltDt2#,1,4)||'13'
		                                    ELSE #strAbltDt1#||#strAbltDt2#
		                            END
		                        WHEN #pType# = '03' THEN
		                            CASE    WHEN SUBSTR(#strAbltDt1#||#strAbltDt2#,5,2) > '09' THEN SUBSTR(#strAbltDt1#||#strAbltDt2#,1,4)||'04' 
		                                    WHEN SUBSTR(#strAbltDt1#||#strAbltDt2#,5,2) > '06' THEN SUBSTR(#strAbltDt1#||#strAbltDt2#,1,4)||'03'
		                                    WHEN SUBSTR(#strAbltDt1#||#strAbltDt2#,5,2) > '03' THEN SUBSTR(#strAbltDt1#||#strAbltDt2#,1,4)||'02' 
		                                    ELSE SUBSTR(#strAbltDt1#||#strAbltDt2#,1,4)||'01' 
		                            END
		                        WHEN #pType# = '05' THEN #strAbltDt1#||'13'
		                    END)
		AND     RCPT_STA_CD='A'
	</select>		
	
	<!--증명책임자부호  폐지-->
	<update id="FAACAV024EUpdateDataAbltDel" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EUpdateDataAbltDel */ ]]>
		UPDATE	TWFAACAV003M
		SET		ABLT_DT = #strAbltDt1#||#strAbltDt2#||#strAbltDt3#,
				DOC_ENF_NO = #strDocEnfNo#,
				DOC_ENF_DT = #strDocDt1#||#strDocDt2#||#strDocDt3#,
				MDF_DT = #strMdfDt1#||#strMdfDt2#||#strMdfDt3#,
				MDF_DVSN_CD  = 'N'
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</update>
	
	
	<!--증명책임자부호  테이블 신설일자 및 DOC 수정-->
	<update id="FAACAV024EUpdateDataAblt" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EUpdateDataAblt */ ]]>
		UPDATE	TWFAACAV003M
		SET		ABLT_DT = #strAbltDt1#||#strAbltDt2#||#strAbltDt3#,
				DOC_ENF_NO = #strDocEnfNo#,
				DOC_ENF_DT = #strAbltDt1#||#strAbltDt2#||#strAbltDt3#,
				MDF_DT = #strMdfDt1#||#strMdfDt2#||#strMdfDt3#,
				MDF_DVSN_CD  = 'U'
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</update>

	<!-- 신설일 수정시 접수마스터 데이터 있는지 확인 -->	 
	<select id="FAACAV024ESelectMst2Ablt" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectMst2Ablt */ ]]>
		SELECT	NVL(PROF_YR,0) AS PROF_YR
		FROM	TWFAACAV007M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR > #strAbltDt1#
	</select>		
	
	<!--접수마스터 삭제 -->
	<update id="FAACAV024EDeleteAcctMstAblt" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EDeleteAcctMstAblt */ ]]>
		DELETE	TWFAACAV007M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR > #strAbltDt1#
	</update>
	
	<!-- 신설일 수정시 서류접수마스터 데이터 있는지 확인 -->	 
	<select id="FAACAV024ESelectAcctPaperMst2Ablt" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectAcctPaperMst2Ablt */ ]]>
		SELECT	NVL(PROF_YR,0) AS PROF_YR
		FROM	TWFAACAV008M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR > #strAbltDt1#
	</select>
					
	<!-- 신설일 수정시 서류접수마스터 서류접수마스터 삭제-->	 
	<delete id="FAACAV024EDeleteAcctPaperMstAblt" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EDeleteAcctPaperMstAblt */ ]]>
		DELETE	TWFAACAV008M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		AND		PROF_YR > #strAbltDt1# 
	</delete>
	
	<delete id="FAACAV024EAcctPaperDelete" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EAcctPaperDelete */ ]]>
		DELETE	TWFAACAV008M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</delete>
	
	<!-- 삭제 - 접수마스터 삭제-->	 
	<delete id="FAACAV024EAcctMstDelete" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EAcctMstDelete */ ]]>
		DELETE	TWFAACAV007M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</delete>
	
	<!-- 삭제 - 증명책임자부호 삭제-->	 
	<delete id="FAACAV024EAccmnDelete" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EAccmnDelete */ ]]>
		DELETE	TWFAACAV003M
		WHERE	COPT_CD = #strCoptCd#
		AND		ACNT_CD = #strAcntCd#
		AND		BLL_CD  = #strBllCd#
		AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</delete>

	<!-- 증명책임자부호목록 -->
	<select id="FAACAV024ESelectReport1" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectReport1 */ ]]>
		<![CDATA[
			SELECT	COPT_CD||'-'||A.ACNT_CD||'-'||A.BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호,
	                ORG_NM AS 기관명,
	                F_AV_BLL_COPT_CD_NM(COPT_CD) AS 소관명,
	                F_AV_ACNT_CD_NM(A.ACNT_CD) AS 회계명,
	                CASE 
				        WHEN (A.BLL_CD ='17' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
				        THEN '관서운영경비출납계산서'
				     WHEN (A.BLL_CD='22' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
				        THEN '기금관서운영경비' ELSE ACNT_CD_NM
				     END 계산서명,
	                SUBSTR(CRE_DT,1,4)||'.'||SUBSTR(CRE_DT,5,2)||'.'||SUBSTR(CRE_DT,7,2) AS 신설일,
	                SUBSTR(ABLT_DT,1,4)||'.'||SUBSTR(ABLT_DT,5,2)||'.'||SUBSTR(ABLT_DT,7,2) AS 폐지일
			FROM	TWFAACAV003M A, TWFAACAV024C B, TBDCMACM002M C
			WHERE	A.BLL_CD = B.ACNT_CD
			AND		RPAD(A.BR_CD,3,'0')||RPAD(DIV_CD,3,'0') = C.DPT_CD(+)
			AND		ACNT_DVSN_CD = '03'
			AND		MDF_DVSN_CD != 'D'
		]]>
		<isEqual property="rdbPassStaCd" compareValue="2">
			AND 	PRSS_STA_CD = '02'
		</isEqual>
		<isEqual property="rdbPassStaCd" compareValue="1">
			AND 	PRSS_STA_CD = '01' 
		</isEqual>
		<isNotEmpty property="strAccMnId1">
			AND 	A.COPT_CD = #strAccMnId1#
		</isNotEmpty>	   
		<isNotEmpty property="strAccMnId2">
			AND 	A.ACNT_CD = #strAccMnId2#
		</isNotEmpty>	   
		<isNotEmpty property="strAccMnId3">
			<isEqual property="strAccMnId3" compareValue="17">
				AND A.BLL_CD IN ('17', '18')
			</isEqual>
			<isEqual property="strAccMnId3" compareValue="22">
				AND A.BLL_CD IN ('22', '23')
			</isEqual>
				AND A.BLL_CD = #strAccMnId3#
		</isNotEmpty>	   
		<isNotEmpty property="strAccMnId4">
			AND A.PROF_DRTR_SRNO = #strAccMnId4#
		</isNotEmpty>	   		
		<isNotEmpty property="strAccMnId5">
			AND A.DL_XPN_RCDB_PBSVT_SRNO = #strAccMnId5#
		</isNotEmpty>	   		
		<isNotEmpty property="strCreSdt1">
			<isNotEmpty property="strCreSdt2">
				<isNotEmpty property="strCreSdt3">
					AND A.CRE_DT >= #strCreSdt1#||#strCreSdt2#||#strCreSdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strCreSdt2">
				<isEmpty property="strCreSdt3">
					AND A.CRE_DT >= #strCreSdt1#||#strCreSdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strCreSdt2">
				<isEmpty property="strCreSdt3">
					AND A.CRE_DT >= #strCreSdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   		
		<isNotEmpty property="strCreEdt1">
			<isNotEmpty property="strCreEdt2">
				<isNotEmpty property="strCreEdt3">
					AND A.CRE_DT &lt;= #strCreEdt1#||#strCreEdt2#||#strCreEdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strCreEdt2">
				<isEmpty property="strCreEdt3">
					AND A.CRE_DT &lt;= #strCreEdt1#||#strCreEdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strCreEdt2">
				<isEmpty property="strCreEdt3">
					AND A.CRE_DT &lt;= #strCreEdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   		
		<isNotEmpty property="strAbltSdt1">
			<isNotEmpty property="strAbltSdt2">
				<isNotEmpty property="strAbltSdt3">
					AND A.ABLT_DT >= #strAbltSdt1#||#strAbltSdt2#||#strAbltSdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strAbltSdt2">
				<isEmpty property="strAbltSdt3">
					AND A.ABLT_DT >= #strAbltSdt1#||#strAbltSdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strAbltSdt2">
				<isEmpty property="strAbltSdt3">
					AND A.ABLT_DT >= #strAbltSdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   		
		<isNotEmpty property="strAbltEdt1">
			<isNotEmpty property="strAbltEdt2">
				<isNotEmpty property="strAblEtdt3">
					AND A.ABLT_DT &lt;= #strAbltEdt1#||#strAbltEdt2#||#strAblEtdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strAbltEdt2">
				<isEmpty property="strAblEtdt3">
					AND A.ABLT_DT &lt;= #strAbltEdt1#||#strAbltEdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strAbltEdt2">
				<isEmpty property="strAblEtdt3">
					AND A.ABLT_DT &lt;= #strAbltEdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   	
		<isNotEmpty property="strBrCd">
			AND A.BR_CD = #strBrCd#
		</isNotEmpty>
		<isNotEmpty property="strDivCd">
			AND A.DIV_CD = #strDivCd#
		</isNotEmpty>
		<isNotEmpty property="strMdfSdt1">
			<isNotEmpty property="strMdfSdt2">
				<isNotEmpty property="strMdfSdt3">
					AND A.MDF_DT >= #strMdfSdt1#||#strMdfSdt2#||#strMdfSdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strMdfSdt2">
				<isEmpty property="strMdfSdt3">
					AND A.MDF_DT >= #strMdfSdt1#||#strMdfSdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strMdfSdt2">
				<isEmpty property="strMdfSdt3">
					AND A.MDF_DT >= #strMdfSdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="strOrgNm">
			AND A.ORG_NM = #strOrgNm#
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isNotEmpty property="strOrgCd4">
					AND A.ORG_CD = #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
					</isNotEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
					AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'000' AND #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'999' 
					</isEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
					AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||'000000' AND #strOrgCd1#||#strOrgCd2#||'999999' 
					</isEmpty>
				</isEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
					AND A.ORG_CD BETWEEN #strOrgCd1#||'000000000' AND #strOrgCd1#||'999999999' 
					</isEmpty>
				</isEmpty>
			</isEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="rdbMdfDvsnCd">
			AND A.MDF_DVSN_CD = ''
		</isNotEmpty>
       ORDER BY 증명책임자부호
	</select>		
	
	<!-- 증명책임자부호목록(신규,전체,폐지) -->
	<select id="FAACAV024ESelectReport2" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectReport2 */ ]]>
		<![CDATA[
			SELECT 
                COPT_CD||'-'||A.ACNT_CD||'-'||A.BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
                ,ORG_NM AS 기관명
                ,F_AV_BLL_COPT_CD_NM(COPT_CD) AS 소관명
                ,F_AV_ACNT_CD_NM(A.ACNT_CD) AS 회계명
                ,CASE 
			        WHEN (A.BLL_CD ='17' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
			        THEN '관서운영경비출납계산서'
			     WHEN (A.BLL_CD='22' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
			        THEN '기금관서운영경비' ELSE ACNT_CD_NM
			     END 계산서명
                ,SUBSTR(CRE_DT,1,4)||'.'||SUBSTR(CRE_DT,5,2)||'.'||SUBSTR(CRE_DT,7,2) AS 신설일자
                ,SUBSTR(ABLT_DT,1,4)||'.'||SUBSTR(ABLT_DT,5,2)||'.'||SUBSTR(ABLT_DT,7,2) AS 폐지일자
			FROM   TWFAACAV003M A, TWFAACAV024C B, TBDCMACM002M C
			WHERE A.BLL_CD = B.ACNT_CD
			AND RPAD(A.BR_CD,3,'0')||RPAD(DIV_CD,3,'0') = C.DPT_CD(+)
			AND ACNT_DVSN_CD = '03'
			AND MDF_DVSN_CD != 'D'
		]]>
		<isEqual property="rdbPassStaCd" compareValue="2">
			AND PRSS_STA_CD = '02'
		</isEqual>
		<isEqual property="rdbPassStaCd" compareValue="1">
			AND PRSS_STA_CD = '01' 
		</isEqual>
		<isNotEmpty property="strAccMnId1">
			AND A.COPT_CD = #strAccMnId1#
		</isNotEmpty>	   
		<isNotEmpty property="strAccMnId2">
			AND A.ACNT_CD = #strAccMnId2#
		</isNotEmpty>	   
		<isNotEmpty property="strAccMnId3">
			<isEqual property="strAccMnId3" compareValue="17">
				AND A.BLL_CD IN ('17', '18')
			</isEqual>
			<isEqual property="strAccMnId3" compareValue="22">
				AND A.BLL_CD IN ('22', '23')
			</isEqual>
				AND A.BLL_CD = #strAccMnId3#
		</isNotEmpty>	   
		<isNotEmpty property="strAccMnId4">
			AND A.PROF_DRTR_SRNO = #strAccMnId4#
		</isNotEmpty>	   		
		<isNotEmpty property="strAccMnId5">
			AND A.DL_XPN_RCDB_PBSVT_SRNO = #strAccMnId5#
		</isNotEmpty>	   		
		<isNotEmpty property="strCreSdt1">
			<isNotEmpty property="strCreSdt2">
				<isNotEmpty property="strCreSdt3">
					AND A.CRE_DT >= #strCreSdt1#||#strCreSdt2#||#strCreSdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strCreSdt2">
				<isEmpty property="strCreSdt3">
					AND A.CRE_DT >= #strCreSdt1#||#strCreSdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strCreSdt2">
				<isEmpty property="strCreSdt3">
					AND A.CRE_DT >= #strCreSdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   		
		<isNotEmpty property="strCreEdt1">
			<isNotEmpty property="strCreEdt2">
				<isNotEmpty property="strCreEdt3">
					AND A.CRE_DT &lt;= #strCreEdt1#||#strCreEdt2#||#strCreEdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strCreEdt2">
				<isEmpty property="strCreEdt3">
					AND A.CRE_DT &lt;= #strCreEdt1#||#strCreEdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strCreEdt2">
				<isEmpty property="strCreEdt3">
					AND A.CRE_DT &lt;= #strCreEdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   		
		<isNotEmpty property="strAbltSdt1">
			<isNotEmpty property="strAbltSdt2">
				<isNotEmpty property="strAbltSdt3">
					AND A.ABLT_DT >= #strAbltSdt1#||#strAbltSdt2#||#strAbltSdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strAbltSdt2">
				<isEmpty property="strAbltSdt3">
					AND A.ABLT_DT >= #strAbltSdt1#||#strAbltSdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strAbltSdt2">
				<isEmpty property="strAbltSdt3">
					AND A.ABLT_DT >= #strAbltSdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   		
		<isNotEmpty property="strAbltEdt1">
			<isNotEmpty property="strAbltEdt2">
				<isNotEmpty property="strAblEtdt3">
					AND A.ABLT_DT &lt;= #strAbltEdt1#||#strAbltEdt2#||#strAblEtdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strAbltEdt2">
				<isEmpty property="strAblEtdt3">
					AND A.ABLT_DT &lt;= #strAbltEdt1#||#strAbltEdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strAbltEdt2">
				<isEmpty property="strAblEtdt3">
					AND A.ABLT_DT &lt;= #strAbltEdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>	   	
		<isNotEmpty property="strBrCd">
			AND A.BR_CD = #strBrCd#
		</isNotEmpty>
		<isNotEmpty property="strDivCd">
			AND A.DIV_CD = #strDivCd#
		</isNotEmpty>
		<isNotEmpty property="strMdfSdt1">
			<isNotEmpty property="strMdfSdt2">
				<isNotEmpty property="strMdfSdt3">
					AND A.MDF_DT >= #strMdfSdt1#||#strMdfSdt2#||#strMdfSdt3#
				</isNotEmpty>
			</isNotEmpty>
			<isNotEmpty property="strMdfSdt2">
				<isEmpty property="strMdfSdt3">
					AND A.MDF_DT >= #strMdfSdt1#||#strMdfSdt2#||'01'
				</isEmpty>
			</isNotEmpty>
			<isEmpty property="strMdfSdt2">
				<isEmpty property="strMdfSdt3">
					AND A.MDF_DT >= #strMdfSdt1#||'0101'
				</isEmpty>
			</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="strOrgNm">
			AND A.ORG_NM = #strOrgNm#
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isNotEmpty property="strOrgCd4">
					AND A.ORG_CD = #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
					</isNotEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isNotEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
					AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'000' AND #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||'999' 
					</isEmpty>
				</isNotEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isNotEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
					AND A.ORG_CD BETWEEN #strOrgCd1#||#strOrgCd2#||'000000' AND #strOrgCd1#||#strOrgCd2#||'999999' 
					</isEmpty>
				</isEmpty>
			</isNotEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="strOrgCd1">
			<isEmpty property="strOrgCd2">
				<isEmpty property="strOrgCd3">
					<isEmpty property="strOrgCd4">
					AND A.ORG_CD BETWEEN #strOrgCd1#||'000000000' AND #strOrgCd1#||'999999999' 
					</isEmpty>
				</isEmpty>
			</isEmpty>
		</isNotEmpty>			  	
		<isNotEmpty property="rdbMdfDvsnCd">
			AND A.MDF_DVSN_CD = ''
		</isNotEmpty>
		   ORDER BY 증명책임자부호
	</select>		
	
	<!-- 상세 리포트  -->
	<select id="FAACAV024ESelectReport7" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectReport7 */ ]]>
		<![CDATA[
            SELECT	ORG_NM AS 기관명
	                ,COPT_CD||'-'||A.ACNT_CD||'-'||A.BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명책임자부호
	                ,F_AV_BLL_COPT_CD_NM(COPT_CD) AS 소관명
	                ,F_AV_ACNT_CD_NM(A.ACNT_CD) AS 회계명
	                ,CASE 
	                    WHEN (A.BLL_CD ='17' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
	                    THEN '관서운영경비출납계산서'
	                 WHEN (A.BLL_CD='22' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
	                    THEN '기금관서운영경비' ELSE ACNT_CD_NM
	                 END AS 계산서명
	                ,PST_NM AS 회계직명
	                ,SUBSTR(CRE_DT,1,4)||'.'||SUBSTR(CRE_DT,5,2)||'.'||SUBSTR(CRE_DT,7,2) AS 신설일
	                ,SUBSTR(ABLT_DT,1,4)||'.'||SUBSTR(ABLT_DT,5,2)||'.'||SUBSTR(ABLT_DT,7,2) AS 폐지일
	                ,SUBSTR(ORG_CD,1,3)||'-'||SUBSTR(ORG_CD,4,3)||'-'||SUBSTR(ORG_CD,7,3)||'-'||SUBSTR(ORG_CD,10,3) AS 기관부호
	                ,F_DPT_INFO (RPAD(BR_CD,3,'0')||RPAD(DIV_CD,3,'0'), '1') AS 담당국과
	                ,ORGCHF_NM AS 기관장명
	                ,BZN AS 사업자등록번호
	                ,DOC_ENF_NO AS 문서번호
	                ,SUBSTR(DOC_ENF_DT,1,4)||'.'||SUBSTR(DOC_ENF_DT,5,2)||'.'||SUBSTR(DOC_ENF_DT,7,2) AS 문서시행일
	                ,EXPN_SSEC_NM AS 담당공무원명
	                ,EXPN_SSEC_EIN AS 주민번호1
	                ,MDF_PEN_NM AS 작성자명
	                ,MDF_PEN_EIN AS 주민번호2
	                ,A.TNB AS 전화번호
	                ,SUBSTR(A.ZCD,1,3)||'-'||SUBSTR(A.ZCD,4,3) AS 우편번호
	                ,A.AD AS 주소
            FROM	TWFAACAV003M A, TWFAACAV024C B, TBDCMACM002M C
            WHERE	A.BLL_CD = B.ACNT_CD
            AND		RPAD(A.BR_CD,3,'0')||RPAD(DIV_CD,3,'0') = C.DPT_CD(+)
            AND		ACNT_DVSN_CD = '03'
        ]]>
        	AND		A.COPT_CD = #strCoptCd#
			AND		A.ACNT_CD = #strAcntCd#
			AND		A.BLL_CD  = #strBllCd#
			AND		A.PROF_DRTR_SRNO = #strProfDrtrSrno#
			AND		A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</select>	
	
	<!-- 소관별 증명책임자부호 명세서에 쓰일 소관명 회계명 가져오기  -->
	<select id="FAACAV024ESelectReport3_1" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectReport3_1 */ ]]>
		SELECT F_AV_BLL_COPT_CD_NM(#strCoptCd#) AS 소관
		       ,F_AV_ACNT_CD_NM(#strAcntCd#) AS 회계
		  FROM DUAL
	</select>
	
	<!-- 소관별 증명책임자부호 명세서  -->
	<select id="FAACAV024ESelectReport3_2" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectReport3_2 */ ]]>
		<![CDATA[
           	 SELECT ORG_NM AS 증명기관명
					,CASE 
						WHEN (A.BLL_CD ='17' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='18' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '관서운영경비출납계산서'
						WHEN (A.BLL_CD='22' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='23' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD='24' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
							THEN '기금관서운영경비' ELSE ACNT_CD_NM
					END 계산증명서종류
                    ,PST_NM AS 직위명
					,CASE WHEN SUBSTR(CRE_DT,1,4) = '0000' THEN '' ELSE SUBSTR(CRE_DT,1,4) || '.' || SUBSTR(CRE_DT,5,2) || '.' || SUBSTR(CRE_DT,7,2) END AS 신설년월
         			,CASE WHEN SUBSTR(ABLT_DT,1,4) = '9999' THEN '' ELSE SUBSTR(ABLT_DT,1,4) || '.' || SUBSTR(ABLT_DT,5,2) || '.' || SUBSTR(ABLT_DT,7,2) END AS 폐지년월
					,F_DPT_INFO (RPAD(BR_CD,3,'0')||RPAD(DIV_CD,3,'0'), '1') AS 국과
					,COPT_CD||'-'||A.ACNT_CD||'-'||A.BLL_CD||'-'||PROF_DRTR_SRNO||'-'||DL_XPN_RCDB_PBSVT_SRNO AS 증명자부호
			   FROM TWFAACAV003M A, TWFAACAV024C B, TBDCMACM002M C
			  WHERE A.BLL_CD = B.ACNT_CD
				AND RPAD(A.BR_CD,3,'0')||RPAD(DIV_CD,3,'0') = C.DPT_CD(+)
				AND ACNT_DVSN_CD = '03'
        ]]>
        	<isNotEmpty property="strCoptCd">
				AND COPT_CD = #strCoptCd#
        	</isNotEmpty>
        	<isNotEmpty property="strAcntCd">
				AND A.ACNT_CD = #strAcntCd#
        	</isNotEmpty>
	</select>		

	<!-- 기관부호의 소관별 산하기관 목록  -->
	<select id="FAACAV024ESelectReport4" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectReport4 */ ]]>
		<![CDATA[
           	 SELECT DISTINCT A.ORG_CD AS ORG_CD 
					,A.ORG_NM AS 기관명
					,B.ACNT_CD AS ACNT_CD
					,B.ACNT_CD_NM AS 소관명
			   FROM TWFAACAV003M A, TWFAACAV024C B
			  WHERE ((A.CRE_DT >= #strSY#||#strSM#||'01' AND A.CRE_DT <= #strEY#||#strEM#||'01')
			     OR (A.ABLT_DT >= #strSY#||#strSM#||'31' AND A.ABLT_DT <= #strEY#||#strEM#||'31')
				 OR (A.CRE_DT <= #strSY#||#strSM#||'01' AND A.ABLT_DT >= #strEY#||#strEM#||'31'))
				AND SUBSTRING(A.ORG_CD,1,3) = B.ACNT_CD
				AND B.ACNT_DVSN_CD = '02'
		   ORDER BY ORG_CD
        ]]>
	</select>		
		
	<select id="FAACAV024EDetailSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EDetailSelect */ ]]>
	     SELECT COPT_CD || '-' || A.ACNT_CD || '-' || A.BLL_CD || '-' || PROF_DRTR_SRNO || '-' || DL_XPN_RCDB_PBSVT_SRNO AS ACCMN_ID,
		        ORG_NM,
		        F_AV_BLL_COPT_CD_NM (COPT_CD) AS COPT_NM,
		        F_AV_ACNT_CD_NM (A.ACNT_CD) AS ACNT_NM,
		        CASE 
		        	WHEN (A.BLL_CD = '17' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD= '18' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
		        		THEN '관서운영경비출납계산서' 
		        	WHEN (A.BLL_CD= '22' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD= '23' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') OR (A.BLL_CD= '24' AND DL_XPN_RCDB_PBSVT_SRNO!= '000') 
		        		THEN '기금관서운영경비' 
		        	ELSE ACNT_CD_NM 
		        END BLL_NM,
				A.CRE_DT AS CRE_DT,
       			A.ABLT_DT AS ABLT_DT,
		        RPAD(BR_CD,3,'0') AS BR_CD,
		        RPAD(DIV_CD,3,'0') AS DIV_CD,
		        C.DPT_NM,
		        MDF_DT,
		        ORG_CD,
		        ORGCHF_NM,
		        PST_NM,
		        MDF_DVSN_CD,
		        DOC_ENF_NO,
		        DOC_ENF_DT,
		        FNCR_EIN AS FNCR_RRN,
		        FNCR_NM,                  
		        EXPN_SSEC_EIN  AS EXPN_SSEC_RRN,
		        EXPN_SSEC_NM,
		        MDF_PEN_EIN  AS MDF_PEN_RRN,
		        MDF_PEN_NM,
		        A.TNB,
		        A.ZCD,
		        A.AD,
		        BZN,
		        ACP_DVSN_CD,
		        PROF_DRTR_RMK AS RMK,
		        APV_LIN_CHGR_NM,
		        APV_EXAM_PEN_NM,
		        APVR_NM,
		        PRSS_STA_CD,
		        ENS_USE_YN,
		        A.COPT_CD,
				A.ACNT_CD,
				A.BLL_CD,
				A.PROF_DRTR_SRNO,
				A.DL_XPN_RCDB_PBSVT_SRNO,
		        SUBSTR(CRE_DT,1,4) AS CRE_DT1,
        		SUBSTR(CRE_DT,5,2) AS CRE_DT2,
        		SUBSTR(CRE_DT,7,2) AS CRE_DT3,
        		CASE WHEN SUBSTR(ABLT_DT,1,4) = '9999' THEN '' ELSE SUBSTR(ABLT_DT,1,4) END AS ABLT_DT1,
        		CASE WHEN SUBSTR(ABLT_DT,5,2) = '99' THEN '' ELSE SUBSTR(ABLT_DT,5,2) END AS ABLT_DT2,
        		CASE WHEN SUBSTR(ABLT_DT,7,2) = '99' THEN '' ELSE SUBSTR(ABLT_DT,7,2) END AS ABLT_DT3,
				SUBSTR(MDF_DT,1,4) AS MDF_DT1,
				SUBSTR(MDF_DT,5,2) AS MDF_DT2,
				SUBSTR(MDF_DT,7,2) AS MDF_DT3,
				SUBSTR(ORG_CD,1,3) AS ORG_CD1,
			    SUBSTR(ORG_CD,4,3) AS ORG_CD2,
			    SUBSTR(ORG_CD,7,3) AS ORG_CD3,
			    SUBSTR(ORG_CD,10,3) AS ORG_CD4,
			    SUBSTR(DOC_ENF_DT,1,4) AS DOC_ENF_DT1,
			    SUBSTR(DOC_ENF_DT,5,2) AS DOC_ENF_DT2,
			    SUBSTR(DOC_ENF_DT,7,2) AS DOC_ENF_DT3,
			    SUBSTR(A.ZCD,1,3) AS ZCD1,
			    SUBSTR(A.ZCD,4,3) AS ZCD2
		<isNotEmpty property="strCoptCd">
		<isNotEmpty property="strAcntCd">
		<isNotEmpty property="strBllCd">
		<isNotEmpty property="strProfDrtrSrno">
		<isNotEmpty property="strDlXpnRcdbPbsvtSrno">
			    ,(SELECT EAN_TEXT 
			        FROM (
					      SELECT ROWNUM KEY, 
					             EAN_TEXT 
					        FROM (
					              	SELECT	EAN ||'-'||ACCT_SUBJ_CD AS EAN_TEXT
					              	FROM	TWFAACAV062L
					                WHERE	COPT_CD = #strCoptCd#
									AND		ACNT_CD = #strAcntCd#
									AND		BLL_CD  = #strBllCd#
									AND		PROF_DRTR_SRNO = #strProfDrtrSrno#
									AND		DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
					                ORDER BY ACNT_YR DESC
					              ) 
					      ) 
				    WHERE KEY = 1
				  ) AS EAN_CD
		</isNotEmpty> 
		</isNotEmpty> 
		</isNotEmpty> 
		</isNotEmpty> 
		</isNotEmpty>
		   FROM TWFAACAV003M A,
		        TWFAACAV024C B,
		        TBDCMACM002M C
		  WHERE A.BLL_CD = B.ACNT_CD
		    AND RPAD(A.BR_CD,3,'0') || RPAD(DIV_CD,3,'0') = C.DPT_CD (+ )
		    AND ACNT_DVSN_CD = '03'
		<isNotEmpty property="strCoptCd" prepend="AND">
		        COPT_CD = #strCoptCd#
		</isNotEmpty>	
		<isNotEmpty property="strAcntCd" prepend="AND">
			    A.ACNT_CD = #strAcntCd#
		</isNotEmpty>	
		<isNotEmpty property="strBllCd" prepend="AND">
     			A.BLL_CD = #strBllCd#
		</isNotEmpty>	
		<isNotEmpty property="strProfDrtrSrno" prepend="AND">
				PROF_DRTR_SRNO = #strProfDrtrSrno#
		</isNotEmpty>	
		<isNotEmpty property="strDlXpnRcdbPbsvtSrno" prepend="AND">
				DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		</isNotEmpty>	
	</select>	
	
	<select id="FAACAV024ESearchCoptNmSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESearchCoptNmSelect */ ]]>
		SELECT F_AV_BLL_COPT_CD_NM(#strCoptCd#) AS COPT_NM 
		  FROM DUAL
	</select>	

	<select id="FAACAV024ESearchAcntNmSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESearchAcntNmSelect */ ]]>
		SELECT F_AV_ACNT_CD_NM (#strAcntCd#) AS ACNT_NM 
		  FROM DUAL
	</select>	

	<select id="FAACAV024ESearchBllNmSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESearchBllNmSelect */ ]]>
		SELECT DISTINCT
		       CASE
		         WHEN (A.BLL_CD IN('17','18') AND DL_XPN_RCDB_PBSVT_SRNO != '000') THEN '관서운영경비출납계산서'
		         WHEN (A.BLL_CD IN('22','23','24') AND DL_XPN_RCDB_PBSVT_SRNO != '000') THEN '기금관서운영경비'
		       ELSE ACNT_CD_NM
		        END AS BLL_NM
		  FROM TWFAACAV003M A,
		       TWFAACAV024C B,
		       TBDCMACM002M C
		 WHERE A.BLL_CD = B.ACNT_CD
		   AND RPAD(A.BR_CD,3,'0') || RPAD(DIV_CD,3,'0') = C.DPT_CD (+ )
		   AND ACNT_DVSN_CD = '03'
		   AND A.BLL_CD = #strBllCd#
		   <isEqual property="strBllCd" compareValue="17">
				AND A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		   </isEqual>
		   <isEqual property="strBllCd" compareValue="18">
				AND A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		   </isEqual>
		   <isEqual property="strBllCd" compareValue="22">
				AND A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		   </isEqual>
		   <isEqual property="strBllCd" compareValue="23">
				AND A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		   </isEqual>
		   <isEqual property="strBllCd" compareValue="24">
				AND A.DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
		   </isEqual>
	</select>	

	<select id="FAACAV024ESearchOrgChfNmSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESearchOrgChfNmSelect */ ]]>
		 SELECT MAX(NAM) AS ORG_CHF_NM
		   FROM TBFAAAEA015M
		  WHERE ORG_CD = #strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
		    AND DEL_YN = 'N'
		    AND BAJ_DVSN_YN = 1
	</select>	
	
	<!-- 공무원자동생성 마지막 2개 가져옴  -->
	<select id="FAACAV024ESelectAccmnId1" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectAccmnId1 */ ]]>
		<isEqual property="strChkAccmId" compareValue="Y">
			SELECT  MIN(A.PROF_DRTR_SRNO) AS DATA1,
			        '000' AS DATA2
			FROM    (SELECT DISTINCT PROF_DRTR_SRNO
			        FROM    TWFAACAV003M) A
			WHERE   NOT EXISTS (SELECT  1
			                    FROM    TWFAACAV003M B
			                    WHERE   B.PROF_DRTR_SRNO = A.PROF_DRTR_SRNO
			                    AND     B.COPT_CD = #strCoptCd#
			                    AND     B.ACNT_CD = #strAcntCd#
			                    AND     B.BLL_CD  = #strBllCd#)
		</isEqual>
		<isNotEqual property="strChkAccmId" compareValue="Y">
			SELECT	LPAD(NVL(MAX(PROF_DRTR_SRNO),0) + 1,3,'0') AS DATA1,
					'000' AS DATA2
			FROM	TWFAACAV003M
			WHERE	COPT_CD = #strCoptCd#
			AND		ACNT_CD = #strAcntCd#
			AND		BLL_CD  = #strBllCd#
		</isNotEqual>
		
		
	</select>
	
	<!-- 일상번호 자동생성 마지막 1개 가져옴 -->
	<select id="FAACAV024ESelectAccmnId2" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectAccmnId2 */ ]]>
		SELECT 
		    LPAD(NVL(MAX(DL_XPN_RCDB_PBSVT_SRNO),0) + 1,3,'0') AS DATA2
		FROM TWFAACAV003M
		WHERE COPT_CD = #strCoptCd#
		AND ACNT_CD = #strAcntCd#
		AND BLL_CD = #strBllCd#
		AND PROF_DRTR_SRNO = #strProfDrtrSrno#
	</select>		
	
	<select id="FAACAV024ESelectCheck" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectCheck */ ]]>
		 SELECT ( SELECT COUNT(1)
		            FROM TWFAACAV003M
		           WHERE COPT_CD = #strCoptCd#
		             AND ACNT_CD = #strAcntCd#
		             AND BLL_CD = #strBllCd#
		             AND PROF_DRTR_SRNO = #strProfDrtrSrno#
		             AND DL_XPN_RCDB_PBSVT_SRNO = '000') AS COUNT1,
		        ( SELECT COUNT(1)
		            FROM TWFAACAV003M
		           WHERE COPT_CD = #strCoptCd#
		             AND ACNT_CD = #strAcntCd#
		             AND BLL_CD = #strBllCd#
		             AND PROF_DRTR_SRNO = #strProfDrtrSrno#
		             AND DL_XPN_RCDB_PBSVT_SRNO = '000'
		             AND MDF_DVSN_CD IN('N','U') ) AS COUNT2,
		        ( SELECT COUNT(1)
		            FROM TWFAACAV003M
		           WHERE COPT_CD = #strCoptCd#
		             AND ACNT_CD = #strAcntCd#
		             AND BLL_CD = #strBllCd#
		             AND PROF_DRTR_SRNO = #strProfDrtrSrno#
		             ) AS COUNT3
		   FROM DUAL
	</select>		
	<select id="FAACAV024ESelectAccNo" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ESelectAccNo */ ]]>
		 SELECT ACNT_YR,
		        COPT_CD,
		        ACNT_CD,
		        BLL_CD,
		        PROF_DRTR_SRNO,
		        DL_XPN_RCDB_PBSVT_SRNO,
		        EAN,
		        ACCT_SUBJ_CD,
		        BNK_CD,
		        CRE_DT,
		        ABLT_DT
		   FROM TWFAACAV062L
		  WHERE ACNT_YR = #strYy# 
		    AND COPT_CD = #strCoptCd#
		    AND ACNT_CD = #strAcntCd# 
		    AND BLL_CD = #strBllCd#
		    AND PROF_DRTR_SRNO = #strProfDrtrSrno#
		    AND DL_XPN_RCDB_PBSVT_SRNO = #strDlXpnRcdbPbsvtSrno#
	</select>
	<delete id="FAACAV024EAccDelete" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EAccDelete */ ]]>
		DELETE 
		  FROM TWFAACAV062L
		 WHERE ACNT_YR = #ACNT_YR# 
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD# 
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
		    AND EAN = #EAN#
		    AND ACCT_SUBJ_CD = #ACCT_SUBJ_CD#
		    AND BNK_CD = #BNK_CD#
	</delete>
	<update id="FAACAV024EAccUpdate" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EAccUpdate */ ]]>
		UPDATE TWFAACAV062L 
		   SET EAN = #EAN#,
		       ACCT_SUBJ_CD = #ACCT_SUBJ_CD#,
		       BNK_CD = #BNK_CD#
		 WHERE ACNT_YR = #ACNT_YR# 
		    AND COPT_CD = #COPT_CD#
		    AND ACNT_CD = #ACNT_CD# 
		    AND BLL_CD = #BLL_CD#
		    AND PROF_DRTR_SRNO = #PROF_DRTR_SRNO#
		    AND DL_XPN_RCDB_PBSVT_SRNO = #DL_XPN_RCDB_PBSVT_SRNO#
	</update>
	
	<insert id="FAACAV024EAccInsert"  parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EAccInsert */ ]]>
		INSERT INTO TWFAACAV062L
		            (
		            ACNT_YR
				    ,COPT_CD 
				    ,ACNT_CD
				    ,BLL_CD
				    ,PROF_DRTR_SRNO
				    ,DL_XPN_RCDB_PBSVT_SRNO
				    ,EAN
				    ,ACCT_SUBJ_CD
				    ,BNK_CD
				    ,FRT_REGI_DH
				    ,FRT_USR_ID
				    ,FNL_MDF_DH
				    ,FNL_USR_ID
				    ,FNL_DEAL_DPT_CD
				    ,FNL_MNU_ID
		            ) 
		     VALUES (
			    #ACNT_YR#
			    ,#COPT_CD#
			    ,#ACNT_CD#
			    ,#BLL_CD#
			    ,#PROF_DRTR_SRNO#
			    ,#DL_XPN_RCDB_PBSVT_SRNO#
			    ,#EAN#
			    ,#ACCT_SUBJ_CD#
			    ,#BNK_CD#
			    ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,#FRT_USR_ID#
				,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				,#FNL_USR_ID#
				,#FNL_DEAL_DPT_CD#
				,#FNL_MNU_ID#
		    )
	</insert>
	
	
	<!--증명책임자부호 insert-->
	<insert id="FAACAV024E_EN_ENAIS_TWFAACAV003M_Insert" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024E_EN_ENAIS_TWFAACAV003M_Insert */ ]]>
		INSERT INTO EN_ENAIS_TWFAACAV003M (
			IF_SEQ
            ,COPT_CD
			,ACNT_CD
			,BLL_CD
			,PROF_DRTR_SRNO
			,DL_XPN_RCDB_PBSVT_SRNO
			,CRE_DT
			,ORG_CD
			,ORG_NM
			,ORGCHF_NM
			,PST_NM
			,ABLT_DT
			,BR_CD
			,DIV_CD
			,MDF_DT
			,MDF_DVSN_CD
			,DOC_ENF_NO
			,DOC_ENF_DT
			,FNCR_EIN
			,FNCR_NM
			,EXPN_SSEC_EIN
			,EXPN_SSEC_NM
			,MDF_PEN_EIN
			,MDF_PEN_NM
			,TNB
			,ZCD
			,AD
			,BZN
			,ACP_DVSN_CD
			,FRT_REGI_DH
			,FRT_USR_ID
			,FNL_MDF_DH
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
            ,FLAG
            ,IF_STATUS
            ,IF_TRY
            ,IF_RAISE_DT
            ,IF_DEAL_DT
            ,IF_MESSG
            ,IF_SIID
            ,ENS_USE_YN
		) VALUES (
            #IF_SEQ#
			,#ACCMN_ID1#
            ,#ACCMN_ID2#
            ,#ACCMN_ID3#
            ,#ACCMN_ID4#
            ,#ACCMN_ID5#
            ,REPLACE(#CRE_DT#,'-','')
            ,#ORG_CD#
            ,#ORG_NM#
            ,#ORGCHF_NM#
            ,#PST_NM#
            ,NVL(DECODE(#ABLT_DT#, '', '999999', #ABLT_DT#), '999999')
            ,RPAD(#BR_CD#,3,'0')
            ,RPAD(#DIV_CD#,3,'0')
            ,REPLACE(#MDF_DT#,'-','')
            ,'C'
            ,#DOC_ENF_NO#
            ,REPLACE(#DOC_ENF_DT#,'-','')
            ,REPLACE(#FNCR_RRN#,'-','')
            ,#FNCR_NM#
            ,REPLACE(#EXPN_SSEC_RRN#,'-','')
            ,#EXPN_SSEC_NM#
            ,REPLACE(#MDF_PEN_RRN#,'-','')
            ,#MDF_PEN_NM#
            ,REPLACE(#TNB#,'-','')
            ,#ZCD#
            ,#AD#
            ,#BZN#
            ,#ACP_DVSN_CD#
            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            ,#FRT_USR_ID#
            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            ,#FNL_USR_ID#
            ,#FNL_DEAL_DPT_CD#
            ,#FNL_MNU_ID#
            ,'I'
            ,'SS'
            ,'0'
            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            ,''
            ,''
            ,#ENS_USE_YN#
		)
	</insert>
	
	<insert id="FAACAV024E_EN_ENAIS_TWFAACAV003M_UpdateDelete" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024E_EN_ENAIS_TWFAACAV003M_UpdateDelete */ ]]>
		INSERT INTO EN_ENAIS_TWFAACAV003M (
						IF_SEQ
			            ,COPT_CD
						,ACNT_CD
						,BLL_CD
						,PROF_DRTR_SRNO
						,DL_XPN_RCDB_PBSVT_SRNO
						,CRE_DT
						,ORG_CD
						,ORG_NM
						,ORGCHF_NM
						,PST_NM
						,ABLT_DT
						,BR_CD
						,DIV_CD
						,MDF_DT
						,MDF_DVSN_CD
						,DOC_ENF_NO
						,DOC_ENF_DT
						,FNCR_EIN
						,FNCR_NM
						,EXPN_SSEC_EIN
						,EXPN_SSEC_NM
						,MDF_PEN_EIN
						,MDF_PEN_NM
						,TNB
						,ZCD
						,AD
						,BZN
						,ACP_DVSN_CD
						,ENS_USE_YN
						,FRT_REGI_DH
						,FRT_USR_ID
						,FNL_MDF_DH
						,FNL_USR_ID
						,FNL_DEAL_DPT_CD
						,FNL_MNU_ID
			            ,FLAG
			            ,IF_STATUS
			            ,IF_TRY
			            ,IF_RAISE_DT
			            ,IF_DEAL_DT
			            ,IF_MESSG
			            ,IF_SIID
					) VALUES (
			            #IF_SEQ#
						,#strCoptCd#
			            ,#strAcntCd#
			            ,#strBllCd#
			            ,#strProfDrtrSrno#
			            ,#strDlXpnRcdbPbsvtSrno#
			            ,REPLACE(#strCreDt1#||#strCreDt2#||#strCreDt3#,'-','')
			            ,#strOrgCd1#||#strOrgCd2#||#strOrgCd3#||#strOrgCd4#
			            ,#strOrgNm#
			            ,#strOrgchfNm#
			            ,#strPstNm#
			            ,NVL(DECODE(#strAbltDt1#||#strAbltDt2#||#strAbltDt3#, '', '999999', #strAbltDt1#||#strAbltDt2#||#strAbltDt3#), '999999')
			            ,RPAD(#strBrCd#,3,'0')
			            ,RPAD(#strDivCd#,3,'0')
			            ,REPLACE(#strMdfDt1#||#strMdfDt2#||#strMdfDt3#,'-','')
		  				,#MDF_DVSN_CD#
			            ,#strDocEnfNo#
			            ,REPLACE(#strDocDt1#||#strDocDt2#||#strDocDt3#,'-','')
			            ,REPLACE(#strFncrRrn#,'-','')
			            ,#strFncrNm#
			            ,REPLACE(#strExpnSsecRrn#,'-','')
			            ,#strExpnSsecNm#
			            ,REPLACE(#strMdfPenRrn#,'-','')
			            ,#strMnfPenNm#
			            ,REPLACE(#strTnb#,'-','')
			            ,#strZcd1#||#strZcd2#
			            ,#strAd#
			            ,#strBzn#
			            ,#strAcpDvsnCd#
			            ,#strEnsUseYn#
			            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			            ,#FRT_USR_ID#
			            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			            ,#FNL_USR_ID#
			            ,#FNL_DEAL_DPT_CD#
			            ,#FNL_MNU_ID#
			            ,#FLAG#
			            ,'SS'
			            ,'0'
			            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			            ,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			            ,''
			            ,''
					)
	</insert>
	
	<insert id="FAACAV024EAccmnIdInsert" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024EAccmnIdInsert */ ]]>
		<![CDATA[
			INSERT INTO TWFAACAV003M (
						COPT_CD
						,ACNT_CD
						,BLL_CD
						,PROF_DRTR_SRNO
						,DL_XPN_RCDB_PBSVT_SRNO
						,CRE_DT
						,ORG_CD
						,ORG_NM
						,ORGCHF_NM
						,PST_NM
						,ABLT_DT
						,BR_CD
						,DIV_CD
						,MDF_DT
						,MDF_DVSN_CD
						,DOC_ENF_NO
						,DOC_ENF_DT
						,FNCR_EIN
						,FNCR_NM
						,EXPN_SSEC_EIN
						,EXPN_SSEC_NM
						,MDF_PEN_EIN
						,MDF_PEN_NM
						,TNB
						,ZCD
						,AD
						,BZN
						,ACP_DVSN_CD
						,ENS_USE_YN
						,FRT_REGI_DH
						,FRT_USR_ID
						,FNL_MDF_DH
						,FNL_USR_ID
						,FNL_DEAL_DPT_CD
						,FNL_MNU_ID
					) VALUES (
						#ACCMN_ID1#
						,#ACCMN_ID2#
						,#ACCMN_ID3#
						,#ACCMN_ID4#
						,#ACCMN_ID5#
						,REPLACE(#CRE_DT#,'-','')
						,#ORG_CD#
						,#ORG_NM#
						,#ORGCHF_NM#
						,#PST_NM#
						,NVL(DECODE(#ABLT_DT#, '', '999999', #ABLT_DT#), '999999')
						,RPAD(#BR_CD#,3,'0')
						,RPAD(#DIV_CD#,3,'0')
						,REPLACE(#MDF_DT#,'-','')
						,'C'
						,#DOC_ENF_NO#
						,REPLACE(#DOC_ENF_DT#,'-','')
						,REPLACE(#FNCR_RRN#,'-','')
						,#FNCR_NM#
						,REPLACE(#EXPN_SSEC_RRN#,'-','')
						,#EXPN_SSEC_NM#
						,REPLACE(#MDF_PEN_RRN#,'-','')
						,#MDF_PEN_NM#
						,REPLACE(#TNB#,'-','')
						,#ZCD#
						,#AD#
						,#BZN#
						,#ACP_DVSN_CD#
						,#ENS_USE_YN#
						,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
						,#FRT_USR_ID#
						,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
						,#FNL_USR_ID#
						,#FNL_DEAL_DPT_CD#
						,#FNL_MNU_ID#
					)
		]]>
	</insert>
	
	
	<select id="FAACAV024ENewcheckPtype" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewcheckPtype */ ]]>
		<![CDATA[
			SELECT SUBSTR(RMK_2,1,2) AS MON FROM TWFAACAV024C
			WHERE ACNT_DVSN_CD = '03'
			AND ACNT_CD = #ACCMN_ID3#
		]]>
	</select>
	
	
	<insert id="FAACAV024ENewInsertMst" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewInsertMst */ ]]>
		<![CDATA[
			INSERT INTO TWFAACAV007M 
			(
				COPT_CD
				, ACNT_CD
				, BLL_CD
				, PROF_DRTR_SRNO
				, DL_XPN_RCDB_PBSVT_SRNO
				, PROF_YR
				, FRT_REGI_DH
				, FRT_USR_ID
				, FNL_MDF_DH
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MNU_ID
			) VALUES(
				#ACCMN_ID1#
				,#ACCMN_ID2#
				,#ACCMN_ID3#
				,#ACCMN_ID4#
				,#ACCMN_ID5#
				, #startYear#
				, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				, #FRT_USR_ID#
				, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, #FNL_MNU_ID#
			)
		]]>
	</insert>
	
	<insert id="FAACAV024ENewInsertAcctPaperMst" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewInsertAcctPaperMst */ ]]>
		INSERT INTO TWFAACAV008M 
		(
			COPT_CD
			, ACNT_CD
			, BLL_CD
			, PROF_DRTR_SRNO
			, DL_XPN_RCDB_PBSVT_SRNO
			, PROF_YR
			, FRT_REGI_DH
			, FRT_USR_ID
			, FNL_MDF_DH
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
		) VALUES(
			#ACCMN_ID1#
			,#ACCMN_ID2#
			,#ACCMN_ID3#
			,#ACCMN_ID4#
			,#ACCMN_ID5#
			, #startYear#
			, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, #FRT_USR_ID#
			, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
		)
	</insert>
	
	<update id="FAACAV024ENewUpdateAcctMster" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewUpdateAcctMster */ ]]>
		UPDATE	TWFAACAV007M
		SET		MN_1_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '01') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '01')  THEN '*' ELSE CASE WHEN NVL(MN_1_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_STA_CD ELSE NULL END END ,
				MN_2_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '02') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '02')  THEN '*' ELSE CASE WHEN NVL(MN_2_STA_CD,' ') NOT IN('*', ' ')   THEN MN_2_STA_CD ELSE NULL END END ,
				MN_3_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '03') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '03')  THEN '*' ELSE CASE WHEN NVL(MN_3_STA_CD,' ') NOT IN('*', ' ')   THEN MN_3_STA_CD ELSE NULL END END ,
				MN_4_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '04') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '04')  THEN '*' ELSE CASE WHEN NVL(MN_4_STA_CD,' ') NOT IN('*', ' ')   THEN MN_4_STA_CD ELSE NULL END END ,
				MN_5_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '05') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '05')  THEN '*' ELSE CASE WHEN NVL(MN_5_STA_CD,' ') NOT IN('*', ' ')   THEN MN_5_STA_CD ELSE NULL END END ,
				MN_6_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '06') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '06')  THEN '*' ELSE CASE WHEN NVL(MN_6_STA_CD,' ') NOT IN('*', ' ')   THEN MN_6_STA_CD ELSE NULL END END ,
				MN_7_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '07') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '07')  THEN '*' ELSE CASE WHEN NVL(MN_7_STA_CD,' ') NOT IN('*', ' ')   THEN MN_7_STA_CD ELSE NULL END END ,
				MN_8_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '08') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '08')  THEN '*' ELSE CASE WHEN NVL(MN_8_STA_CD,' ') NOT IN('*', ' ')   THEN MN_8_STA_CD ELSE NULL END END ,
				MN_9_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '09') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '09')  THEN '*' ELSE CASE WHEN NVL(MN_9_STA_CD,' ') NOT IN('*', ' ')   THEN MN_9_STA_CD ELSE NULL END END ,
				MN_1_0_STA_CD   = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '10') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '10')  THEN '*' ELSE CASE WHEN NVL(MN_1_0_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_0_STA_CD ELSE NULL END END ,
				MN_1_1_STA_CD   = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '11') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '11')  THEN '*' ELSE CASE WHEN NVL(MN_1_1_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_1_STA_CD ELSE NULL END END ,
				MN_1_2_STA_CD   = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '12') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '12')  THEN '*' ELSE CASE WHEN NVL(MN_1_2_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_2_STA_CD ELSE NULL END END ,
				MN_1_3_STA_CD   = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '12') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '12')  THEN '*' ELSE CASE WHEN NVL(MN_1_3_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_3_STA_CD ELSE NULL END END 
		WHERE	COPT_CD = #ACCMN_ID1#
		AND		ACNT_CD = #ACCMN_ID2#
		AND		BLL_CD  = #ACCMN_ID3#
		AND		PROF_DRTR_SRNO = #ACCMN_ID4#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #ACCMN_ID5#
		AND		PROF_YR = #startYear#
	</update>
	
	<update id="FAACAV024ENewUpdateAcctPaperMst" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewUpdateAcctPaperMst */ ]]>
		UPDATE	TWFAACAV008M
		SET		MN_1_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '01') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '01')  THEN '*' ELSE CASE WHEN NVL(MN_1_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_ACP_DT ELSE NULL END END ,  
				MN_2_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '02') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '02')  THEN '*' ELSE CASE WHEN NVL(MN_2_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_2_ACP_DT ELSE NULL END END ,  
				MN_3_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '03') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '03')  THEN '*' ELSE CASE WHEN NVL(MN_3_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_3_ACP_DT ELSE NULL END END ,  
				MN_4_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '04') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '04')  THEN '*' ELSE CASE WHEN NVL(MN_4_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_4_ACP_DT ELSE NULL END END ,  
				MN_5_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '05') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '05')  THEN '*' ELSE CASE WHEN NVL(MN_5_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_5_ACP_DT ELSE NULL END END ,  
				MN_6_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '06') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '06')  THEN '*' ELSE CASE WHEN NVL(MN_6_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_6_ACP_DT ELSE NULL END END ,  
				MN_7_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '07') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '07')  THEN '*' ELSE CASE WHEN NVL(MN_7_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_7_ACP_DT ELSE NULL END END ,  
				MN_8_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '08') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '08')  THEN '*' ELSE CASE WHEN NVL(MN_8_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_8_ACP_DT ELSE NULL END END ,  
				MN_9_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '09') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '09')  THEN '*' ELSE CASE WHEN NVL(MN_9_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_9_ACP_DT ELSE NULL END END ,  
				MN_1_0_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '10') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '10') THEN '*' ELSE CASE WHEN NVL(MN_1_0_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_0_ACP_DT ELSE NULL END END ,
				MN_1_1_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '11') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '11') THEN '*' ELSE CASE WHEN NVL(MN_1_1_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_1_ACP_DT ELSE NULL END END ,
				MN_1_2_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '12') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '12') THEN '*' ELSE CASE WHEN NVL(MN_1_2_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_2_ACP_DT ELSE NULL END END ,
				MN_1_3_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '12') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '12') THEN '*' ELSE CASE WHEN NVL(MN_1_3_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_3_ACP_DT ELSE NULL END END  
		WHERE	COPT_CD = #ACCMN_ID1#
		AND		ACNT_CD = #ACCMN_ID2#
		AND		BLL_CD  = #ACCMN_ID3#
		AND		PROF_DRTR_SRNO = #ACCMN_ID4#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #ACCMN_ID5#
	</update>
	
	<update id="FAACAV024ENewUpdateAcctMster2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewUpdateAcctMster2 */ ]]>
		UPDATE	TWFAACAV007M
		SET		MN_1_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '03') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '01')  THEN '*' ELSE CASE WHEN NVL(MN_1_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_STA_CD ELSE NULL END END ,
				MN_2_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '06') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '04')  THEN '*' ELSE CASE WHEN NVL(MN_2_STA_CD,' ') NOT IN('*', ' ')   THEN MN_2_STA_CD ELSE NULL END END ,
				MN_3_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '09') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '07')  THEN '*' ELSE CASE WHEN NVL(MN_3_STA_CD,' ') NOT IN('*', ' ')   THEN MN_3_STA_CD ELSE NULL END END ,
				MN_4_STA_CD  = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '13') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '10')  THEN '*' ELSE CASE WHEN NVL(MN_4_STA_CD,' ') NOT IN('*', ' ')   THEN MN_4_STA_CD ELSE NULL END END ,
				MN_5_STA_CD  = '*', 
				MN_6_STA_CD  = '*',
				MN_7_STA_CD  = '*',
				MN_8_STA_CD  = '*',
				MN_9_STA_CD  = '*',
				MN_1_0_STA_CD = '*',
				MN_1_1_STA_CD = '*',
				MN_1_2_STA_CD = '*',
				MN_1_3_STA_CD = '*'
		WHERE	COPT_CD = #ACCMN_ID1#
		AND		ACNT_CD = #ACCMN_ID2#
		AND		BLL_CD  = #ACCMN_ID3#
		AND		PROF_DRTR_SRNO = #ACCMN_ID4#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #ACCMN_ID5#
		AND		PROF_YR = #startYear#
	</update>
	
	<update id="FAACAV024ENewUpdateAcctPaperMst2" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewUpdateAcctPaperMst2 */ ]]>
		UPDATE	TWFAACAV008M
		SET		MN_1_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '03') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '01')  THEN '*' ELSE CASE WHEN NVL(MN_1_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_ACP_DT ELSE NULL END END ,  
				MN_2_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '06') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '04')  THEN '*' ELSE CASE WHEN NVL(MN_2_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_2_ACP_DT ELSE NULL END END ,  
				MN_3_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '09') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '07')  THEN '*' ELSE CASE WHEN NVL(MN_3_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_3_ACP_DT ELSE NULL END END ,  
				MN_4_ACP_DT = CASE WHEN  (SUBSTR(#CRE_DT#,1,4) = #startYear# AND SUBSTR(#CRE_DT#,5,2) > '13') OR  (SUBSTR(#delDate#,1,4) = #startYear# AND SUBSTR(#delDate#,5,2) &lt; '10')  THEN '*' ELSE CASE WHEN NVL(MN_4_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_4_ACP_DT ELSE NULL END END ,  
				MN_5_ACP_DT = '*',
				MN_6_ACP_DT = '*',
				MN_7_ACP_DT = '*',
				MN_8_ACP_DT = '*',
				MN_9_ACP_DT = '*',
				MN_1_0_ACP_DT = '*',
				MN_1_1_ACP_DT = '*',
				MN_1_2_ACP_DT = '*',
				MN_1_3_ACP_DT = '*'
		WHERE	COPT_CD = #ACCMN_ID1#
		AND		ACNT_CD = #ACCMN_ID2#
		AND		BLL_CD  = #ACCMN_ID3#
		AND		PROF_DRTR_SRNO = #ACCMN_ID4#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #ACCMN_ID5#
		AND		PROF_YR = #startYear#
	</update>
	
	<update id="FAACAV024ENewUpdateAcctMster3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewUpdateAcctMster3 */ ]]>
		UPDATE	TWFAACAV007M
		SET		MN_1_STA_CD = CASE WHEN  #CRE_DT# > #startYear#||'13' OR #delDate# &lt; #startYear#||'01'  THEN '*' ELSE CASE WHEN NVL(MN_1_STA_CD,' ') NOT IN('*', ' ')   THEN MN_1_STA_CD ELSE NULL END END ,
				MN_2_STA_CD = '*',
				MN_3_STA_CD = '*',
				MN_4_STA_CD = '*',  
				MN_5_STA_CD = '*',
				MN_6_STA_CD = '*',
				MN_7_STA_CD = '*',
				MN_8_STA_CD = '*',
				MN_9_STA_CD = '*',
				MN_1_0_STA_CD = '*',
				MN_1_1_STA_CD = '*',
				MN_1_2_STA_CD = '*',
				MN_1_3_STA_CD = '*'
		WHERE	COPT_CD = #ACCMN_ID1#
		AND		ACNT_CD = #ACCMN_ID2#
		AND		BLL_CD  = #ACCMN_ID3#
		AND		PROF_DRTR_SRNO = #ACCMN_ID4#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #ACCMN_ID5#
		AND		PROF_YR = #startYear#
	</update>
	
	<update id="FAACAV024ENewUpdateAcctPaperMst3" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewUpdateAcctPaperMst3 */ ]]>
		UPDATE	TWFAACAV008M
		SET		MN_1_ACP_DT = CASE WHEN  #CRE_DT# > #startYear#||'13' OR #delDate# &lt; #startYear#||'01'  THEN '*' ELSE CASE WHEN NVL(MN_1_ACP_DT,' ') NOT IN('*', ' ')   THEN MN_1_ACP_DT ELSE NULL END END ,
				MN_2_ACP_DT = '*',
				MN_3_ACP_DT = '*',
				MN_4_ACP_DT = '*',  
				MN_5_ACP_DT = '*',
				MN_6_ACP_DT = '*',
				MN_7_ACP_DT = '*',
				MN_8_ACP_DT = '*',
				MN_9_ACP_DT = '*',
				MN_1_0_ACP_DT = '*',
				MN_1_1_ACP_DT = '*',
				MN_1_2_ACP_DT = '*',
				MN_1_3_ACP_DT = '*'
		WHERE	COPT_CD = #ACCMN_ID1#
		AND		ACNT_CD = #ACCMN_ID2#
		AND		BLL_CD  = #ACCMN_ID3#
		AND		PROF_DRTR_SRNO = #ACCMN_ID4#
		AND		DL_XPN_RCDB_PBSVT_SRNO = #ACCMN_ID5#
		AND		PROF_YR = #startYear#
	</update>
	
	<update id="FAACAV024ENewMainUpdate" parameterClass="paramMap">
		<![CDATA[  /* faa/cav/024/FAACAV024ENewMainUpdate */ ]]>
		UPDATE TWFAACAV003M
				SET ORG_CD                    = #ORG_CD#
		  			,ORG_NM                   = #ORG_NM#
		  			,ORGCHF_NM                = #ORGCHF_NM#
		  			,PST_NM                   = #PST_NM#
		  			,BR_CD                    = RPAD(#BR_CD#,3,'0')
		  			,DIV_CD                   = RPAD(#DIV_CD#,3,'0')
		  			,MDF_DT                   = REPLACE(#MDF_DT#,'-','')
		  			<isNotEmpty property="strMdfDvsnCd">
		  			,MDF_DVSN_CD              = #MDF_DVSN_CD#
		  			</isNotEmpty>
		  			,DOC_ENF_NO               = #DOC_ENF_NO#
		  			,DOC_ENF_DT               = REPLACE(#DOC_ENF_DT#,'-','')
		  			,FNCR_EIN                 = REPLACE(#FNCR_RRN#,'-','')
		  			,FNCR_NM                  = #FNCR_NM#
		  			,EXPN_SSEC_EIN            = REPLACE(#EXPN_SSEC_RRN#,'-','')
		  			,EXPN_SSEC_NM             = #EXPN_SSEC_NM#
		  			,MDF_PEN_EIN              = REPLACE(#MDF_PEN_RRN#,'-','')
		  			,MDF_PEN_NM               = #MDF_PEN_NM#
		  			,TNB                      = REPLACE(#TNB#,'-','')
		  			,ZCD                      = #ZCD#
		  			,AD                       = #AD#
		  			,BZN                      = #BZN#
		  			,ACP_DVSN_CD              = #ACP_DVSN_CD#
		  			,ENS_USE_YN				  = #ENS_USE_YN#
		  			,FNL_MDF_DH               = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		  			,FNL_USR_ID               = #FNL_USR_ID#
		  			,FNL_DEAL_DPT_CD          = #FNL_DEAL_DPT_CD#
		  			,FNL_MNU_ID               = #FNL_MNU_ID#
		  		WHERE COPT_CD                 = #ACCMN_ID1#
		  			AND ACNT_CD               = #ACCMN_ID2#
		  			AND BLL_CD                = #ACCMN_ID3#
		  			AND PROF_DRTR_SRNO        = #ACCMN_ID4#
		  			AND DL_XPN_RCDB_PBSVT_SRNO= #ACCMN_ID5#
	</update>
	
	
</sqlMap> 
