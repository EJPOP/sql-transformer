<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="csp/bii/191">

	<!-- 감사정보 연도 목록 조회 -->
	<select id="CSPBII191QAudInfYeSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT /* csp.bii.service.impl.CSPBII111QServiceImpl.CSPBII111QMlgInfSelect */
			       DISTINCT A.YE	            /* 연도 */
			  FROM TBCSPBII100M A
			  
			UNION
			
			SELECT /* csp.bii.service.impl.CSPBII111QServiceImpl.CSPBII111QMlgInfSelect */
			       DISTINCT A.YE	            /* 연도 */
			  FROM TBCSPBII170M A

			ORDER BY YE 			
		]]>			 
	</select>
	
	<select id="CSPBII191QselectReportList1" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT to_char(to_date(#strStrDt#),'yyyy-mm-dd')|| '~' ||to_char(to_date(#strEndDt#),'yyyy-mm-dd')  AS YE,
				   SUM(CASE WHEN  AUD_INF_PRSS_STA_CD >= '10' THEN 1 ELSE 0 END ) AS CNT0,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '6' THEN 1
                         ELSE 0
                       END) AS CNT1 /* 감사대상정보-즉시확인 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '3' THEN 1
                         ELSE 0
                       END) AS CNT2 /* 감사대상정보-감사대상 */,
        SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '4' THEN 1
                         ELSE 0
                       END) AS CNT3 /* 감사대상정보- 이첩대상 */,
        SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '6' THEN 1
                         ELSE 0
                       END) AS CNT4 /* 감찰정보-즉시확인 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '3' THEN 1
                         ELSE 0
                       END) AS CNT5 /* 감찰정보-감사대상 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT6 /* 감찰정보-참고자료 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '2' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT7 /* 동향정보 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '3' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT8 /* 전산자료 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND HNDL_ORD_CD = '7' THEN 1
                         ELSE 0
                       END) AS CNT9 /* 폐기 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND ((HNDL_ORD_CD NOT IN ('3','4','6','7') AND INF_DVSN_CD = '1') OR (HNDL_ORD_CD NOT IN ('3','5','6','7') AND INF_DVSN_CD = '4') OR (HNDL_ORD_CD NOT IN ('5','7') AND INF_DVSN_CD = '2') OR (HNDL_ORD_CD NOT IN ('5','7') AND INF_DVSN_CD = '3') OR (INF_DVSN_CD NOT IN ('1','2','3','4') AND HNDL_ORD_CD  IS NOT NULL)) THEN 1
                         ELSE 0
                       END) AS CNT10 /* 기타 */,
       SUM(            CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND HNDL_ORD_CD IS NULL THEN 1
                         ELSE 0
                       END) AS CNT11 /* 미분류 */
			  FROM TBCSPBII100M
			 WHERE SMT_DT BETWEEN #strStrDt# AND #strEndDt# 
		]]>
					
	</select>
	
	<select id="CSPBII191QselectReportList1_2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT to_char(to_date(#strStrDt#),'yyyy-mm-dd')|| '~' ||to_char(to_date(#strEndDt#),'yyyy-mm-dd')  AS YE,
				   SUM(CASE WHEN  AUD_INF_PRSS_STA_CD >= '10' THEN 1 ELSE 0 END ) AS CNT0,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '6' THEN 1
                         ELSE 0
                       END) AS CNT1 /* 감사대상정보-즉시확인 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '3' THEN 1
                         ELSE 0
                       END) AS CNT2 /* 감사대상정보-감사대상 */,
        SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '4' THEN 1
                         ELSE 0
                       END) AS CNT3 /* 감사대상정보- 이첩대상 */,
        SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '6' THEN 1
                         ELSE 0
                       END) AS CNT4 /* 감찰정보-즉시확인 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '3' THEN 1
                         ELSE 0
                       END) AS CNT5 /* 감찰정보-감사대상 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT6 /* 감찰정보-참고자료 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '2' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT7 /* 동향정보 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '3' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT8 /* 전산자료 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND HNDL_ORD_CD = '7' THEN 1
                         ELSE 0
                       END) AS CNT9 /* 폐기 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND ((HNDL_ORD_CD NOT IN ('3','4','6','7') AND INF_DVSN_CD = '1') OR (HNDL_ORD_CD NOT IN ('3','5','6','7') AND INF_DVSN_CD = '4') OR (HNDL_ORD_CD NOT IN ('5','7') AND INF_DVSN_CD = '2') OR (HNDL_ORD_CD NOT IN ('5','7') AND INF_DVSN_CD = '3') OR (INF_DVSN_CD NOT IN ('1','2','3','4') AND HNDL_ORD_CD  IS NOT NULL)) THEN 1
                         ELSE 0
                       END) AS CNT10 /* 기타 */,
       SUM(            CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND HNDL_ORD_CD IS NULL THEN 1
                         ELSE 0
                       END) AS CNT11 /* 미분류 */
			  FROM TBCSPBII100M
			 WHERE SMT_DT BETWEEN #strStrDt# AND #strEndDt# 
		]]>
					
	</select>	
	
	<select id="CSPBII191QselectReportList2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT to_char(add_months(to_date(#strStrDt#),-12),'yyyy-mm-dd')||'~'||to_char(add_months(to_date(#strEndDt#),-12),'yyyy-mm-dd') AS YE,
				    SUM(CASE WHEN  AUD_INF_PRSS_STA_CD >= '10' THEN 1 ELSE 0 END ) AS CNT0,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '6' THEN 1
                         ELSE 0
                       END) AS CNT1 /* 감사대상정보-즉시확인 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '3' THEN 1
                         ELSE 0
                       END) AS CNT2 /* 감사대상정보-감사대상 */,
        SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '4' THEN 1
                         ELSE 0
                       END) AS CNT3 /* 감사대상정보- 이첩대상 */,
        SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '6' THEN 1
                         ELSE 0
                       END) AS CNT4 /* 감찰정보-즉시확인 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '3' THEN 1
                         ELSE 0
                       END) AS CNT5 /* 감찰정보-감사대상 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT6 /* 감찰정보-참고자료 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '2' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT7 /* 동향정보 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '3' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT8 /* 전산자료 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND HNDL_ORD_CD = '7' THEN 1
                         ELSE 0
                       END) AS CNT9 /* 폐기 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND ((HNDL_ORD_CD NOT IN ('3','4','6','7') AND INF_DVSN_CD = '1') OR (HNDL_ORD_CD NOT IN ('3','5','6','7') AND INF_DVSN_CD = '4') OR (HNDL_ORD_CD NOT IN ('5','7') AND INF_DVSN_CD = '2') OR (HNDL_ORD_CD NOT IN ('5','7') AND INF_DVSN_CD = '3') OR (INF_DVSN_CD NOT IN ('1','2','3','4') AND HNDL_ORD_CD  IS NOT NULL)) THEN 1
                         ELSE 0
                       END) AS CNT10 /* 기타 */,
       SUM(            CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND HNDL_ORD_CD IS NULL THEN 1
                         ELSE 0
                       END) AS CNT11 /* 미분류 */
			  FROM TBCSPBII100M
			 WHERE SMT_DT BETWEEN to_char(add_months(to_date(#strStrDt#),-12),'yyyymmdd') AND to_char(add_months(to_date(#strEndDt#),-12) ,'yyyymmdd')
		]]>
	</select>
	
	<select id="CSPBII191QselectReportList2_2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT to_char(add_months(to_date(#strStrDt#),-12),'yyyy-mm-dd')||'~'||to_char(add_months(to_date(#strEndDt#),-12),'yyyy-mm-dd') AS YE,
				    SUM(CASE WHEN  AUD_INF_PRSS_STA_CD >= '10' THEN 1 ELSE 0 END ) AS CNT0,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '6' THEN 1
                         ELSE 0
                       END) AS CNT1 /* 감사대상정보-즉시확인 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '3' THEN 1
                         ELSE 0
                       END) AS CNT2 /* 감사대상정보-감사대상 */,
        SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '1' AND HNDL_ORD_CD = '4' THEN 1
                         ELSE 0
                       END) AS CNT3 /* 감사대상정보- 이첩대상 */,
        SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '6' THEN 1
                         ELSE 0
                       END) AS CNT4 /* 감찰정보-즉시확인 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '3' THEN 1
                         ELSE 0
                       END) AS CNT5 /* 감찰정보-감사대상 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '4' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT6 /* 감찰정보-참고자료 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '2' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT7 /* 동향정보 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND INF_DVSN_CD = '3' AND HNDL_ORD_CD = '5' THEN 1
                         ELSE 0
                       END) AS CNT8 /* 전산자료 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND HNDL_ORD_CD = '7' THEN 1
                         ELSE 0
                       END) AS CNT9 /* 폐기 */,
       SUM(
                       CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND ((HNDL_ORD_CD NOT IN ('3','4','6','7') AND INF_DVSN_CD = '1') OR (HNDL_ORD_CD NOT IN ('3','5','6','7') AND INF_DVSN_CD = '4') OR (HNDL_ORD_CD NOT IN ('5','7') AND INF_DVSN_CD = '2') OR (HNDL_ORD_CD NOT IN ('5','7') AND INF_DVSN_CD = '3') OR (INF_DVSN_CD NOT IN ('1','2','3','4') AND HNDL_ORD_CD  IS NOT NULL)) THEN 1
                         ELSE 0
                       END) AS CNT10 /* 기타 */,
       SUM(            CASE
                         WHEN AUD_INF_PRSS_STA_CD >= '10' AND HNDL_ORD_CD IS NULL THEN 1
                         ELSE 0
                       END) AS CNT11 /* 미분류 */
			  FROM TBCSPBII100M
			 WHERE SMT_DT BETWEEN to_char(add_months(to_date(#strStrDt#),-12),'yyyymmdd') AND to_char(add_months(to_date(#strEndDt#),-12) ,'yyyymmdd')
		]]>
	</select>	
	
	<select id="CSPBII191QselectReportList3" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	#yyyy#||'년 '||DECODE(#PRD_DVSN_CD#,'1','1사분기','2','2사분기','3','3사분기','4','4사분기','전체') AS YE
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'01' THEN 1 ELSE 0 END) AS MM01
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'02' THEN 1 ELSE 0 END) AS MM02
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'03' THEN 1 ELSE 0 END) AS MM03
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'04' THEN 1 ELSE 0 END) AS MM04
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'05' THEN 1 ELSE 0 END) AS MM05
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'06' THEN 1 ELSE 0 END) AS MM06
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'07' THEN 1 ELSE 0 END) AS MM07
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'08' THEN 1 ELSE 0 END) AS MM08
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'09' THEN 1 ELSE 0 END) AS MM09
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'10' THEN 1 ELSE 0 END) AS MM10
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'11' THEN 1 ELSE 0 END) AS MM11
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'12' THEN 1 ELSE 0 END) AS MM12
			  FROM	TBCSPBII100M
			 WHERE	1=1
			   AND	SMT_DT LIKE #yyyy# || '%'
			UNION ALL
			SELECT	TO_CHAR(#yyyy# -1)||'년 '||DECODE(#PRD_DVSN_CD#,'1','1사분기','2','2사분기','3','3사분기','4','4사분기','전체') AS YE
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'01' THEN 1 ELSE 0 END) AS MM01
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'02' THEN 1 ELSE 0 END) AS MM02
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'03' THEN 1 ELSE 0 END) AS MM03
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'04' THEN 1 ELSE 0 END) AS MM04
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'05' THEN 1 ELSE 0 END) AS MM05
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'06' THEN 1 ELSE 0 END) AS MM06
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'07' THEN 1 ELSE 0 END) AS MM07
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'08' THEN 1 ELSE 0 END) AS MM08
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'09' THEN 1 ELSE 0 END) AS MM09
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'10' THEN 1 ELSE 0 END) AS MM10
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'11' THEN 1 ELSE 0 END) AS MM11
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'12' THEN 1 ELSE 0 END) AS MM12
			  FROM	TBCSPBII100M
			 WHERE	1=1
			   AND	SMT_DT LIKE #yyyy# -1|| '%'
		]]>			 
	</select>
	
	<select id="CSPBII191QselectReportList3_2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	#yyyy#||'년 '||DECODE(#PRD_DVSN_CD#,'1','1사분기','2','2사분기','3','3사분기','4','4사분기','전체') AS YE
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'01' THEN 1 ELSE 0 END) AS MM01
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'02' THEN 1 ELSE 0 END) AS MM02
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'03' THEN 1 ELSE 0 END) AS MM03
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'04' THEN 1 ELSE 0 END) AS MM04
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'05' THEN 1 ELSE 0 END) AS MM05
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'06' THEN 1 ELSE 0 END) AS MM06
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'07' THEN 1 ELSE 0 END) AS MM07
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'08' THEN 1 ELSE 0 END) AS MM08
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'09' THEN 1 ELSE 0 END) AS MM09
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'10' THEN 1 ELSE 0 END) AS MM10
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'11' THEN 1 ELSE 0 END) AS MM11
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#||'12' THEN 1 ELSE 0 END) AS MM12
			  FROM	TBCSPBII100M
			 WHERE	1=1
			   AND	SMT_DT LIKE #yyyy# || '%'
			UNION ALL
			SELECT	TO_CHAR(#yyyy# -1)||'년 '||DECODE(#PRD_DVSN_CD#,'1','1사분기','2','2사분기','3','3사분기','4','4사분기','전체') AS YE
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'01' THEN 1 ELSE 0 END) AS MM01
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'02' THEN 1 ELSE 0 END) AS MM02
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'03' THEN 1 ELSE 0 END) AS MM03
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'04' THEN 1 ELSE 0 END) AS MM04
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'05' THEN 1 ELSE 0 END) AS MM05
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'06' THEN 1 ELSE 0 END) AS MM06
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'07' THEN 1 ELSE 0 END) AS MM07
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'08' THEN 1 ELSE 0 END) AS MM08
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'09' THEN 1 ELSE 0 END) AS MM09
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'10' THEN 1 ELSE 0 END) AS MM10
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'11' THEN 1 ELSE 0 END) AS MM11
					,SUM(CASE WHEN SUBSTR(SMT_DT,0,6) = #yyyy#-1||'12' THEN 1 ELSE 0 END) AS MM12
			  FROM	TBCSPBII100M
			 WHERE	1=1
			   AND	SMT_DT LIKE #yyyy# -1|| '%'
		]]>			 
	</select>	
	
	<select id="CSPBII191QselectReportList4" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		SELECT * FROM (
			SELECT 	NVL2(CD,CD,'총계') AS CD
       				,NVL2(DPT_CD,MAX(DPT_NM),NVL2(CD,'국별소계','총계')) AS DPT_NM, SUM(SUM1) AS SUM1 , SUM(T1) AS T1, SUM(T2) AS T2, SUM(SUM2) AS SUM2, SUM(C1) AS C1, SUM(C2) AS C2, SUM(C3) AS C3, SUM(C4) AS C4, SUM(C5) AS C5, SUM(C6) AS C6, SUM(TOTAL) AS TOTAL 
					FROM (
						SELECT	SUBSTR(A.DPT_CD, 0, 3) AS CD
							 	,A.DPT_CD 
							 	,A.ABR_DPT_NM_1 AS DPT_NM 
								,NVL(A1.SUM1, 0) AS SUM1
								,NVL(A1.T1, 0) AS T1
								,NVL(A1.T2, 0) AS T2
								,NVL(B1.SUM2, 0) AS SUM2
								,NVL(B1.C1, 0) AS C1
								,NVL(B1.C2, 0) AS C2
								,NVL(B1.C3, 0) AS C3
								,NVL(B1.C4, 0) AS C4
								,NVL(B1.C5, 0) AS C5
								,NVL(B1.C6, 0) AS C6
								,NVL(C1.TOTAL, 0) AS TOTAL
						  FROM	TBDCMACM002M A,
								(SELECT	A.HNDL_DPT_CD
									 	,(A.T1+A.T2) AS SUM1
									 	, A.T1
									 	, A.T2
								  FROM	(
										SELECT	HNDL_DPT_CD
												,SUM(CASE WHEN (TRNF_DT BETWEEN #strStrDt# AND #strEndDt# AND HNDL_ORD_CD NOT IN ('5') ) OR (HNDL_ORD_CD = '5' AND TRNF_DT BETWEEN #strStrDt# AND #strEndDt# AND CMPT_DT BETWEEN #strStrDt# AND #strEndDt# AND HNDL_RSLT_CD  IN ('31','32','34')) THEN 1 ELSE 0 END) AS T1 /* 처리대상_당해년도이송 */
												,SUM(CASE WHEN (TRNF_DT < #strStrDt# AND (CMPT_DT IS NULL OR CMPT_DT = '' OR CMPT_DT >= #strStrDt#) AND HNDL_ORD_CD NOT IN ('5')) OR (HNDL_ORD_CD ='5' AND TRNF_DT < #strStrDt# AND CMPT_DT BETWEEN #strStrDt# AND #strEndDt# AND HNDL_RSLT_CD  IN ('31','32','34')) THEN 1 ELSE 0 END) AS T2 /* 처리대상_이전년도이월 */
										  FROM	TBCSPBII100M
										 WHERE	1=1
										   AND	TRNF_DT IS NOT NULL
										   AND	HNDL_ORD_CD  NOT IN ('7')
										 GROUP	BY HNDL_DPT_CD
										 ) A
								) A1,
								(SELECT	 B.HNDL_DPT_CD, (B.C1+B.C2+B.C3+B.C4+B.C5+B.C6) AS SUM2, B.C1, B.C2, B.C3, B.C4, B.C5, B.C6
								  FROM	(
										SELECT	HNDL_DPT_CD
												,SUM(CASE WHEN HNDL_RSLT_CD = '31' THEN 1 ELSE 0 END) AS C1 /* 처리완료_처분  */
												,SUM(CASE WHEN HNDL_RSLT_CD = '32' THEN 1 ELSE 0 END) AS C2 /* 처리완료_면책  */
												,SUM(CASE WHEN HNDL_RSLT_CD = '34' THEN 1 ELSE 0 END) AS C3 /* 처리완료_이첩  */
												,SUM(CASE WHEN HNDL_RSLT_CD = '35' AND HNDL_ORD_CD NOT IN ('5') THEN 1 ELSE 0 END) AS C4 /* 처리완료_활용  */
												,SUM(CASE WHEN HNDL_RSLT_CD = '36' AND HNDL_ORD_CD NOT IN ('5') THEN 1 ELSE 0 END) AS C5 /* 처리완료_활용  */
												,SUM(CASE WHEN HNDL_RSLT_CD NOT IN ('31','32','34','35','36')  AND HNDL_ORD_CD NOT IN ('5') THEN 1 ELSE 0 END) AS C6 /* 처리완료_불문폐기  */
										  FROM	TBCSPBII100M
										 WHERE  CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
										   AND  HNDL_ORD_CD NOT IN ('7')
										 GROUP 	BY HNDL_DPT_CD
										)B
								)B1,
								(
								SELECT	HNDL_DPT_CD
										,COUNT(*) AS TOTAL /* 미처리(처리중) */
								  FROM	TBCSPBII100M
								 WHERE	TRNF_DT <= #strEndDt#
								   AND	(CMPT_DT IS NULL OR CMPT_DT = '' OR CMPT_DT > #strEndDt#)
								   AND	HNDL_ORD_CD NOT IN ('5','7')
								 GROUP	BY HNDL_DPT_CD
								) C1
						 WHERE 1=1 
						   AND A.DPT_CD = A1.HNDL_DPT_CD(+)
						   AND A.DPT_CD = B1.HNDL_DPT_CD(+)
						   AND A.DPT_CD = C1.HNDL_DPT_CD(+)
						   /*AND SUBSTR(A.DPT_CD, 4, 6) != '000'*/  
						 ORDER BY CD, DPT_CD ASC 
					) 
			GROUP BY ROLLUP( CD, DPT_CD)  
			ORDER BY DECODE(CD,'총계','000',CD),
			DECODE(DPT_NM,'국별소계','000',DPT_CD) ASC
			)  WHERE SUM1 <> 0 OR SUM2 <> 0 OR TOTAL <> 0
		]]>			 
	</select>
	
	<select id="CSPBII191QselectReportList4_2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		SELECT * FROM (
			SELECT 	NVL2(CD,CD,'총계') AS CD
       				,NVL2(DPT_CD,MAX(DPT_NM),NVL2(CD,'국별소계','총계')) AS DPT_NM, SUM(SUM1) AS SUM1 , SUM(T1) AS T1, SUM(T2) AS T2, SUM(SUM2) AS SUM2, SUM(C1) AS C1, SUM(C2) AS C2, SUM(C3) AS C3, SUM(C4) AS C4, SUM(C5) AS C5, SUM(C6) AS C6, SUM(TOTAL) AS TOTAL 
					FROM (
						SELECT	SUBSTR(A.DPT_CD, 0, 3) AS CD
							 	,A.DPT_CD 
							 	,A.ABR_DPT_NM_1 AS DPT_NM 
								,NVL(A1.SUM1, 0) AS SUM1
								,NVL(A1.T1, 0) AS T1
								,NVL(A1.T2, 0) AS T2
								,NVL(B1.SUM2, 0) AS SUM2
								,NVL(B1.C1, 0) AS C1
								,NVL(B1.C2, 0) AS C2
								,NVL(B1.C3, 0) AS C3
								,NVL(B1.C4, 0) AS C4
								,NVL(B1.C5, 0) AS C5
								,NVL(B1.C6, 0) AS C6
								,NVL(C1.TOTAL, 0) AS TOTAL
						  FROM	TBDCMACM002M A,
								(SELECT	A.HNDL_DPT_CD
									 	,(A.T1+A.T2) AS SUM1
									 	, A.T1
									 	, A.T2
								  FROM	(
										SELECT	HNDL_DPT_CD
												,SUM(CASE WHEN (TRNF_DT BETWEEN #strStrDt# AND #strEndDt# AND HNDL_ORD_CD NOT IN ('5') ) OR (HNDL_ORD_CD = '5' AND TRNF_DT BETWEEN #strStrDt# AND #strEndDt# AND CMPT_DT BETWEEN #strStrDt# AND #strEndDt# AND HNDL_RSLT_CD  IN ('31','32','34')) THEN 1 ELSE 0 END) AS T1 /* 처리대상_당해년도이송 */
												,SUM(CASE WHEN (TRNF_DT < #strStrDt# AND (CMPT_DT IS NULL OR CMPT_DT = '' OR CMPT_DT >= #strStrDt#) AND HNDL_ORD_CD NOT IN ('5')) OR (HNDL_ORD_CD ='5' AND TRNF_DT < #strStrDt# AND CMPT_DT BETWEEN #strStrDt# AND #strEndDt# AND HNDL_RSLT_CD  IN ('31','32','34')) THEN 1 ELSE 0 END) AS T2 /* 처리대상_이전년도이월 */
										  FROM	TBCSPBII100M
										 WHERE	1=1
										   AND	TRNF_DT IS NOT NULL
										   AND	HNDL_ORD_CD  NOT IN ('7')
										 GROUP	BY HNDL_DPT_CD
										 ) A
								) A1,
								(SELECT	 B.HNDL_DPT_CD, (B.C1+B.C2+B.C3+B.C4+B.C5+B.C6) AS SUM2, B.C1, B.C2, B.C3, B.C4, B.C5, B.C6
								  FROM	(
										SELECT	HNDL_DPT_CD
												,SUM(CASE WHEN HNDL_RSLT_CD = '31' THEN 1 ELSE 0 END) AS C1 /* 처리완료_처분  */
												,SUM(CASE WHEN HNDL_RSLT_CD = '32' THEN 1 ELSE 0 END) AS C2 /* 처리완료_면책  */
												,SUM(CASE WHEN HNDL_RSLT_CD = '34' THEN 1 ELSE 0 END) AS C3 /* 처리완료_이첩  */
												,SUM(CASE WHEN HNDL_RSLT_CD = '35' AND HNDL_ORD_CD NOT IN ('5') THEN 1 ELSE 0 END) AS C4 /* 처리완료_활용  */
												,SUM(CASE WHEN HNDL_RSLT_CD = '36' AND HNDL_ORD_CD NOT IN ('5') THEN 1 ELSE 0 END) AS C5 /* 처리완료_활용  */
												,SUM(CASE WHEN HNDL_RSLT_CD NOT IN ('31','32','34','35','36')  AND HNDL_ORD_CD NOT IN ('5') THEN 1 ELSE 0 END) AS C6 /* 처리완료_불문폐기  */
										  FROM	TBCSPBII100M
										 WHERE  CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
										   AND  HNDL_ORD_CD NOT IN ('7')
										 GROUP 	BY HNDL_DPT_CD
										)B
								)B1,
								(
								SELECT	HNDL_DPT_CD
										,COUNT(*) AS TOTAL /* 미처리(처리중) */
								  FROM	TBCSPBII100M
								 WHERE	TRNF_DT <= #strEndDt#
								   AND	(CMPT_DT IS NULL OR CMPT_DT = '' OR CMPT_DT > #strEndDt#)
								   AND	HNDL_ORD_CD NOT IN ('5','7')
								 GROUP	BY HNDL_DPT_CD
								) C1
						 WHERE 1=1 
						   AND A.DPT_CD = A1.HNDL_DPT_CD(+)
						   AND A.DPT_CD = B1.HNDL_DPT_CD(+)
						   AND A.DPT_CD = C1.HNDL_DPT_CD(+)
						   /*AND SUBSTR(A.DPT_CD, 4, 6) != '000'*/  
						 ORDER BY CD, DPT_CD ASC 
					) 
			GROUP BY ROLLUP( CD, DPT_CD)  
			ORDER BY DECODE(CD,'총계','000',CD),
			DECODE(DPT_NM,'국별소계','000',DPT_CD) ASC
			)  WHERE SUM1 <> 0 OR SUM2 <> 0 OR TOTAL <> 0
		]]>			 
	</select>	
	
	<select id="CSPBII191QselectReportList5" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		SELECT * FROM (
			SELECT  NVL2(CD,CD,'총계') AS CD
	       				,NVL2(DPT_CD,MAX(DPT_NM),NVL2(CD,'국별소계','총계')) AS DPT_NM
	                    , SUM(CNT) AS CNT 
	                    , SUM(C0) AS C0
	                    , SUM(P0) AS P0
						, SUM(A0) AS A0
	                    , SUM(C1) AS C1
	                    , SUM(P1) AS P1
						, SUM(A1) AS A1
	                    , SUM(C2) AS C2
	                    , SUM(P2) AS P2
	                    , SUM(C3) AS C3
	                    , SUM(P3) AS P3
						, SUM(A3) AS A3
	                    , SUM(C4) AS C4
	                    , SUM(P4) AS P4
	                    , SUM(C5) AS C5
	                    , SUM(P5) AS P5
	                    , SUM(C6) AS C6
	                    , SUM(P6) AS P6
						, SUM(A6) AS A6
	                    , SUM(C7) AS C7
	                    , SUM(P7) AS P7
	                    , SUM(C8) AS C8
	                    , SUM(C9) AS C9
			FROM    (
				SELECT 
					 SUBSTR(E.DPT_CD, 0, 3) AS CD 
					,E.DPT_CD 
					,E.ABR_DPT_NM_1 AS DPT_NM	 
					,NVL(A.CNT, 0) AS CNT 
					,NVL((B.C1 + B.C2 + B.C3 + B.C4 + B.C5 + B.C6 + B.C7), 0) as C0
	       			,NVL((B.P1 + B.P2 + B.P3 + B.P4 + B.P5 + B.P6 + B.P7), 0) as P0
					,NVL((B.A1 + B.A3 + B.A6), 0) as A0 
					,NVL(B.C1, 0) AS C1 
					,NVL(B.A1, 0) AS A1
					,NVL(B.P1, 0) AS P1
					,NVL(B.C2, 0) AS C2
					,NVL(B.P2, 0) AS P2
					,NVL(B.C3, 0) AS C3
					,NVL(B.A3, 0) AS A3
					,NVL(B.P3, 0) AS P3
					,NVL(B.C4, 0) AS C4
					,NVL(B.P4, 0) AS P4
					,NVL(B.C5, 0) AS C5
					,NVL(B.P5, 0) AS P5
					,NVL(B.C6, 0) AS C6
					,NVL(B.A6, 0) AS A6
					,NVL(B.P6, 0) AS P6
					,NVL(B.C7, 0) AS C7
					,NVL(B.P7, 0) AS P7
					,NVL(C.C8, 0) AS C8
					,NVL(D.C9, 0) AS C9
				FROM 
					( 
					SELECT 
						 A.HNDL_DPT_CD 
						,COUNT(*) AS CNT 
					FROM 
						(	 
						SELECT
							 A.YE
							,A.SRNO 
							,A.HNDL_DPT_CD 
						FROM TBCSPBII100M A  
						WHERE HNDL_RSLT_CD = '31'
						AND A.CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
						) A 
					WHERE 1=1 
					GROUP BY HNDL_DPT_CD 
					) A, 
					(	 
					SELECT 
						 A.HNDL_DPT_CD 
						,SUM(A.C1) AS C1 
						,SUM(A.A1) AS A1 
						,SUM(A.P1) AS P1
						,SUM(A.C2) AS C2 
						,SUM(A.P2) AS P2 		
						,SUM(A.C3) AS C3 
						,SUM(A.A3) AS A3 
						,SUM(A.P3) AS P3		
						,SUM(A.C4) AS C4 
						,SUM(A.P4) AS P4 	
						,SUM(A.C5) AS C5 
						,SUM(A.P5) AS P5 			
						,SUM(A.C6) AS C6 
						,SUM(A.A6) AS A6
						,SUM(A.P6) AS P6 
						,SUM(A.C7) AS C7 
						,SUM(A.P7) AS P7 
					FROM 
						( 
							SELECT	 
								 A.YE 
								,A.SRNO 
								,A.HNDL_DPT_CD 
								,B.AUD_YR
								,B.AUD_NO
								,B.DSP_RQ_SNO 
								,C.DSP_RQ_KND_CD 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '1' THEN 1 ELSE 0 END AS C1 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '2' THEN 1 ELSE 0 END AS C2 
								,CASE WHEN C.DSP_RQ_KND_CD IN ('310','320')  THEN 1 ELSE 0 END AS C3 
								,CASE WHEN C.DSP_RQ_KND_CD = '410'           THEN 1 ELSE 0 END AS C4 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) IN ( '5','6','8')  THEN 1 ELSE 0 END AS C5 
								,CASE WHEN C.DSP_RQ_KND_CD  IN ('390','391','395','396','490','495')  THEN 1 ELSE 0 END AS C6
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '7' THEN 1 ELSE 0 END AS C7 
			 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD ,0,1) = '1' 
								      THEN NVL(D.PNL_DRIN_PSVT_AM,0) + NVL(D.RSR_AM,0) + NVL(D.SPLP_AM,0) + NVL(D.BGT_RDC_AM,0) + NVL(D.INC_ICR_AM,0) + NVL(D.PPL_BDN_RDT_AM,0) + NVL(D.IJS_AM,0) + NVL(D.SLF_HNDL_RQ_AM,0) 
								      ELSE 0 END AS A1
								,CASE WHEN C.DSP_RQ_KND_CD IN ('310','320')
								      THEN NVL(D.PNL_DRIN_PSVT_AM,0) + NVL(D.RSR_AM,0) + NVL(D.SPLP_AM,0) + NVL(D.BGT_RDC_AM,0) + NVL(D.INC_ICR_AM,0) + NVL(D.PPL_BDN_RDT_AM,0) + NVL(D.IJS_AM,0) + NVL(D.SLF_HNDL_RQ_AM,0) 
								      ELSE 0 END AS A3 
								,CASE WHEN C.DSP_RQ_KND_CD IN ('390','391','395','396','490','495')
								      THEN NVL(D.PNL_DRIN_PSVT_AM,0) + NVL(D.RSR_AM,0) + NVL(D.SPLP_AM,0) + NVL(D.BGT_RDC_AM,0) + NVL(D.INC_ICR_AM,0) + NVL(D.PPL_BDN_RDT_AM,0) + NVL(D.IJS_AM,0) + NVL(D.SLF_HNDL_RQ_AM,0) 
								      ELSE 0 END AS A6 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '1' THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0)  ELSE 0 END AS P1 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '2' THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0)  ELSE 0 END AS P2 
								,CASE WHEN C.DSP_RQ_KND_CD IN ('310','320')           THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P3
								,CASE WHEN C.DSP_RQ_KND_CD = '410'           THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P4
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) IN('5','6','8') THEN NVL((SELECT COUNT(*) 
								                                                                   FROM TBBADEAR007M E 
								                                                                  WHERE B.AUD_YR = E.AUD_YR
								                                                                    AND B.AUD_NO = E.AUD_NO
							                                                                        AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P5 
								,CASE WHEN C.DSP_RQ_KND_CD IN ('390','391','395','396','490','495')           THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P6
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '7' THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P7 
							FROM TBCSPBII100M A, TBCSPBII120L B, TBBADEAR001M C, TBBADEAR002D D 
							WHERE 1=1 
							AND A.CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
							AND A.YE = B.YE 
							AND A.SRNO = B.SRNO 
							AND B.AUD_YR = C.AUD_YR
							AND B.AUD_NO = C.AUD_NO
							AND B.DSP_RQ_SNO = C.DSP_RQ_SNO 
							AND B.AUD_YR = D.AUD_YR
							AND B.AUD_NO = D.AUD_NO
							AND B.DSP_RQ_SNO = D.DSP_RQ_SNO 
							AND A.HNDL_RSLT_CD IN ('31') 
						) A  
						WHERE 1=1 
					GROUP BY HNDL_DPT_CD 
					) B , 
				  ( 
					SELECT 
						 A.HNDL_DPT_CD 
						,COUNT(*) AS C8 
					FROM 
						(	 
						SELECT 
							 A.YE 
							,A.SRNO 
							,A.HNDL_DPT_CD 
						FROM TBCSPBII100M A  
						WHERE HNDL_RSLT_CD = '34'
						AND A.CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
						) A 
					WHERE 1=1 
					GROUP BY HNDL_DPT_CD 
					) C ,
				  ( 
					SELECT 
						 A.HNDL_DPT_CD 
						,COUNT(*) AS C9 
					FROM 
						(	 
						SELECT 
							 A.YE 
							,A.SRNO 
							,A.HNDL_DPT_CD 
						FROM TBCSPBII100M A  
						WHERE HNDL_RSLT_CD = '32'
						AND A.CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
						) A 
					WHERE 1=1 
					GROUP BY HNDL_DPT_CD 
					) D, TBDCMACM002M E 
					WHERE 1=1 
				AND E.DPT_CD = A.HNDL_DPT_CD(+)
				AND E.DPT_CD = B.HNDL_DPT_CD(+)
				AND E.DPT_CD = C.HNDL_DPT_CD(+)
				AND E.DPT_CD = D.HNDL_DPT_CD(+)
				/*AND SUBSTR(E.DPT_CD, 4, 6) != '000'  */
				ORDER BY CD, DPT_CD ASC
			)
			GROUP BY ROLLUP( CD, DPT_CD)  
			ORDER BY DECODE(CD,'총계','000',CD),
			DECODE(DPT_NM,'국별소계','000',DPT_CD) ASC
			) WHERE CNT <> 0 OR C0 <> 0 OR P0 <> 0 OR A0 <> 0 OR C8 <> 0 OR C9 <> 0
		]]>			 
	</select>
	
	<select id="CSPBII191QselectReportList5_2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		SELECT * FROM (
			SELECT  NVL2(CD,CD,'총계') AS CD
	       				,NVL2(DPT_CD,MAX(DPT_NM),NVL2(CD,'국별소계','총계')) AS DPT_NM
	                    , SUM(CNT) AS CNT 
	                    , SUM(C0) AS C0
	                    , SUM(P0) AS P0
						, SUM(A0) AS A0
	                    , SUM(C1) AS C1
	                    , SUM(P1) AS P1
						, SUM(A1) AS A1
	                    , SUM(C2) AS C2
	                    , SUM(P2) AS P2
	                    , SUM(C3) AS C3
	                    , SUM(P3) AS P3
						, SUM(A3) AS A3
	                    , SUM(C4) AS C4
	                    , SUM(P4) AS P4
	                    , SUM(C5) AS C5
	                    , SUM(P5) AS P5
	                    , SUM(C6) AS C6
	                    , SUM(P6) AS P6
						, SUM(A6) AS A6
	                    , SUM(C7) AS C7
	                    , SUM(P7) AS P7
	                    , SUM(C8) AS C8
	                    , SUM(C9) AS C9
			FROM    (
				SELECT 
					 SUBSTR(E.DPT_CD, 0, 3) AS CD 
					,E.DPT_CD 
					,E.ABR_DPT_NM_1 AS DPT_NM	 
					,NVL(A.CNT, 0) AS CNT 
					,NVL((B.C1 + B.C2 + B.C3 + B.C4 + B.C5 + B.C6 + B.C7), 0) as C0
	       			,NVL((B.P1 + B.P2 + B.P3 + B.P4 + B.P5 + B.P6 + B.P7), 0) as P0
					,NVL((B.A1 + B.A3 + B.A6), 0) as A0 
					,NVL(B.C1, 0) AS C1 
					,NVL(B.A1, 0) AS A1
					,NVL(B.P1, 0) AS P1
					,NVL(B.C2, 0) AS C2
					,NVL(B.P2, 0) AS P2
					,NVL(B.C3, 0) AS C3
					,NVL(B.A3, 0) AS A3
					,NVL(B.P3, 0) AS P3
					,NVL(B.C4, 0) AS C4
					,NVL(B.P4, 0) AS P4
					,NVL(B.C5, 0) AS C5
					,NVL(B.P5, 0) AS P5
					,NVL(B.C6, 0) AS C6
					,NVL(B.A6, 0) AS A6
					,NVL(B.P6, 0) AS P6
					,NVL(B.C7, 0) AS C7
					,NVL(B.P7, 0) AS P7
					,NVL(C.C8, 0) AS C8
					,NVL(D.C9, 0) AS C9
				FROM 
					( 
					SELECT 
						 A.HNDL_DPT_CD 
						,COUNT(*) AS CNT 
					FROM 
						(	 
						SELECT
							 A.YE
							,A.SRNO 
							,A.HNDL_DPT_CD 
						FROM TBCSPBII100M A  
						WHERE HNDL_RSLT_CD = '31'
						AND A.CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
						) A 
					WHERE 1=1 
					GROUP BY HNDL_DPT_CD 
					) A, 
					(	 
					SELECT 
						 A.HNDL_DPT_CD 
						,SUM(A.C1) AS C1 
						,SUM(A.A1) AS A1 
						,SUM(A.P1) AS P1
						,SUM(A.C2) AS C2 
						,SUM(A.P2) AS P2 		
						,SUM(A.C3) AS C3 
						,SUM(A.A3) AS A3 
						,SUM(A.P3) AS P3		
						,SUM(A.C4) AS C4 
						,SUM(A.P4) AS P4 	
						,SUM(A.C5) AS C5 
						,SUM(A.P5) AS P5 			
						,SUM(A.C6) AS C6 
						,SUM(A.A6) AS A6
						,SUM(A.P6) AS P6 
						,SUM(A.C7) AS C7 
						,SUM(A.P7) AS P7 
					FROM 
						( 
							SELECT	 
								 A.YE 
								,A.SRNO 
								,A.HNDL_DPT_CD 
								,B.AUD_YR
								,B.AUD_NO
								,B.DSP_RQ_SNO 
								,C.DSP_RQ_KND_CD 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '1' THEN 1 ELSE 0 END AS C1 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '2' THEN 1 ELSE 0 END AS C2 
								,CASE WHEN C.DSP_RQ_KND_CD IN ('310','320')  THEN 1 ELSE 0 END AS C3 
								,CASE WHEN C.DSP_RQ_KND_CD = '410'           THEN 1 ELSE 0 END AS C4 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) IN ( '5','6','8')  THEN 1 ELSE 0 END AS C5 
								,CASE WHEN C.DSP_RQ_KND_CD  IN ('390','391','395','396','490','495')  THEN 1 ELSE 0 END AS C6
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '7' THEN 1 ELSE 0 END AS C7 
			 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD ,0,1) = '1' 
								      THEN NVL(D.PNL_DRIN_PSVT_AM,0) + NVL(D.RSR_AM,0) + NVL(D.SPLP_AM,0) + NVL(D.BGT_RDC_AM,0) + NVL(D.INC_ICR_AM,0) + NVL(D.PPL_BDN_RDT_AM,0) + NVL(D.IJS_AM,0) + NVL(D.SLF_HNDL_RQ_AM,0) 
								      ELSE 0 END AS A1
								,CASE WHEN C.DSP_RQ_KND_CD IN ('310','320')
								      THEN NVL(D.PNL_DRIN_PSVT_AM,0) + NVL(D.RSR_AM,0) + NVL(D.SPLP_AM,0) + NVL(D.BGT_RDC_AM,0) + NVL(D.INC_ICR_AM,0) + NVL(D.PPL_BDN_RDT_AM,0) + NVL(D.IJS_AM,0) + NVL(D.SLF_HNDL_RQ_AM,0) 
								      ELSE 0 END AS A3 
								,CASE WHEN C.DSP_RQ_KND_CD IN ('390','391','395','396','490','495')
								      THEN NVL(D.PNL_DRIN_PSVT_AM,0) + NVL(D.RSR_AM,0) + NVL(D.SPLP_AM,0) + NVL(D.BGT_RDC_AM,0) + NVL(D.INC_ICR_AM,0) + NVL(D.PPL_BDN_RDT_AM,0) + NVL(D.IJS_AM,0) + NVL(D.SLF_HNDL_RQ_AM,0) 
								      ELSE 0 END AS A6 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '1' THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0)  ELSE 0 END AS P1 
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '2' THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0)  ELSE 0 END AS P2 
								,CASE WHEN C.DSP_RQ_KND_CD IN ('310','320')           THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P3
								,CASE WHEN C.DSP_RQ_KND_CD = '410'           THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P4
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) IN('5','6','8') THEN NVL((SELECT COUNT(*) 
								                                                                   FROM TBBADEAR007M E 
								                                                                  WHERE B.AUD_YR = E.AUD_YR
								                                                                    AND B.AUD_NO = E.AUD_NO
							                                                                        AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P5 
								,CASE WHEN C.DSP_RQ_KND_CD IN ('390','391','395','396','490','495')           THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P6
								,CASE WHEN SUBSTR(C.DSP_RQ_KND_CD,0,1) = '7' THEN NVL((SELECT COUNT(*) 
								                                                         FROM TBBADEAR007M E 
								                                                        WHERE B.AUD_YR = E.AUD_YR
								                                                          AND B.AUD_NO = E.AUD_NO
							                                                              AND B.DSP_RQ_SNO = E.DSP_RQ_SNO),0) ELSE 0 END AS P7 
							FROM TBCSPBII100M A, TBCSPBII120L B, TBBADEAR001M C, TBBADEAR002D D 
							WHERE 1=1 
							AND A.CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
							AND A.YE = B.YE 
							AND A.SRNO = B.SRNO 
							AND B.AUD_YR = C.AUD_YR
							AND B.AUD_NO = C.AUD_NO
							AND B.DSP_RQ_SNO = C.DSP_RQ_SNO 
							AND B.AUD_YR = D.AUD_YR
							AND B.AUD_NO = D.AUD_NO
							AND B.DSP_RQ_SNO = D.DSP_RQ_SNO 
							AND A.HNDL_RSLT_CD IN ('31') 
						) A  
						WHERE 1=1 
					GROUP BY HNDL_DPT_CD 
					) B , 
				  ( 
					SELECT 
						 A.HNDL_DPT_CD 
						,COUNT(*) AS C8 
					FROM 
						(	 
						SELECT 
							 A.YE 
							,A.SRNO 
							,A.HNDL_DPT_CD 
						FROM TBCSPBII100M A  
						WHERE HNDL_RSLT_CD = '34'
						AND A.CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
						) A 
					WHERE 1=1 
					GROUP BY HNDL_DPT_CD 
					) C ,
				  ( 
					SELECT 
						 A.HNDL_DPT_CD 
						,COUNT(*) AS C9 
					FROM 
						(	 
						SELECT 
							 A.YE 
							,A.SRNO 
							,A.HNDL_DPT_CD 
						FROM TBCSPBII100M A  
						WHERE HNDL_RSLT_CD = '32'
						AND A.CMPT_DT BETWEEN #strStrDt# AND #strEndDt#
						) A 
					WHERE 1=1 
					GROUP BY HNDL_DPT_CD 
					) D, TBDCMACM002M E 
					WHERE 1=1 
				AND E.DPT_CD = A.HNDL_DPT_CD(+)
				AND E.DPT_CD = B.HNDL_DPT_CD(+)
				AND E.DPT_CD = C.HNDL_DPT_CD(+)
				AND E.DPT_CD = D.HNDL_DPT_CD(+)
				/*AND SUBSTR(E.DPT_CD, 4, 6) != '000'  */
				ORDER BY CD, DPT_CD ASC
			)
			GROUP BY ROLLUP( CD, DPT_CD)  
			ORDER BY DECODE(CD,'총계','000',CD),
			DECODE(DPT_NM,'국별소계','000',DPT_CD) ASC
			) WHERE CNT <> 0 OR C0 <> 0 OR P0 <> 0 OR A0 <> 0 OR C8 <> 0 OR C9 <> 0
		]]>			 
	</select>	
	
	
	<select id="CSPBII191QselectReportList6" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			Select AA.YE||'-'||AA.SRNO INF_SNO /*정보번호*/,
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = AA.PRSR_DPT_CD) DPT_NM /*제출소속*/,
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = (Select DPT_CD from TBDCMACM001M Where CNB = AA.PRSR_CNB)) DPT_NM2 /*현재소속*/,
       substr(AA.SMT_DT,1,4)||'-'||substr(AA.SMT_DT,5,2)||'-'||substr(AA.SMT_DT,7,2) SMT_DT /*정보제출일*/, 
       AA.PRSR_CNB,  /*제출자 전산번호*/
       F_CODE_NM('1000173', AA.PRSR_RANK_CD) AS PRSR_RANK_NM /*제출자직급*/,
       F_USR_INFO(AA.PRSR_CNB,'2') AS USR_NAM /*제출자*/,
       AA.TIT_TXT /*정보 제목*/,
       AA.REL_ORG_CD /*정보기관*/, 
       (Select ORG_NM from TBDCMACM015M Where ORG_CD = AA.REL_ORG_CD) AS ORG_NM /*정보관련기관*/,
       AA.HNDL_DPT_CD /*소관과*/, 
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = AA.HNDL_DPT_CD) AS HNDL_DPT_NM /*소관부서*/,
       AA.HNDL_ORD_CD /*지시*/, 
       F_CODE_NM('1000039',AA.HNDL_ORD_CD) AS HNDL_ORD_NM /*처리지시*/,
       AA.CMPT_DT /*"정보완결일*/, 
       EE.AUD_YR||'-'||HH.CD_NM||'-'||EE.AUD_GRN_NO||'-'||BB.DSP_RQ_SNO  AS AUD_DSP_SNO /*처분번호*/,
       GG.AUD_SBJ_NM /*감사사항명*/,
       GG.SPV_BRDV_CD /*감사과*/, 
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = GG.SPV_BRDV_CD) AS SPV_BRDV_NM /*감사부서*/,
       DD.ENF_BRDV_CD /*시행과*/, 
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = DD.ENF_BRDV_CD) AS ENF_BRDV_NM /*시행부서*/,
       substr(FF.AUD_STR_DT,1,4)||'-'||substr(FF.AUD_STR_DT,5,2)||'-'||substr(FF.AUD_STR_DT,7,2) AS AUD_STR_DT /*감사시작일*/,
       substr(FF.AUD_END_DT,1,4)||'-'||substr(FF.AUD_END_DT,5,2)||'-'||substr(FF.AUD_END_DT,7,2) AS AUD_END_DT /*감사종료일*/,
       substr(DD.ENF_DT,1,4)||'-'||substr(DD.ENF_DT,5,2)||'-'||substr(DD.ENF_DT,7,2) AS ENF_DT /*시행일자*/,
       F_CODE_NM('1000002',CC.DSP_RQ_KND_CD) AS DSP_RQ_KND_NM /*처분종류*/,
       DD.NOP_CNT /*인원*/, 
       DD.PNL_DRIN_PSVT_AM /*금액*/,
       CC.TIT_TXT AS AUD_TIT_TXT/*처분요구 제목*/, 
       DD.RLTN_ORG_CD /*처분기관*/, 
       (Select ORG_NM from TBDCMACM015M Where ORG_CD = DD.RLTN_ORG_CD) RLTN_ORG_NM /*처분관련기관*/,
       AA.YE||'-'||AA.SRNO||'-'||EE.AUD_YR||'-'||HH.CD_NM||'-'||EE.AUD_GRN_NO||'-'||BB.DSP_RQ_SNO  AS DSP_RQ_SNO_NUM /*연결번호*/,
       '' AS ETC1_1 /*감사소속1*/, '' AS ETC1_2 /*적출소속1*/, '' AS ETC1_3/*현소속1*/, '' AS ETC1_4/*직급1*/, '' AS ETC1_5/*번호1*/, '' AS ETC1_6/*성명1*/, '' AS ETC1_7/*비율1*/, 
       '' AS ETC2_1 /*감사소속2*/, '' AS ETC2_2 /*적출소속2*/, '' AS ETC2_3/*현소속2*/, '' AS ETC2_4/*직급2*/, '' AS ETC2_5/*번호2*/, '' AS ETC2_6/*성명2*/, '' AS ETC2_7/*비율2*/, 
       '' AS ETC3_1 /*감사소속3*/, '' AS ETC3_2 /*적출소속3*/, '' AS ETC3_3/*현소속3*/, '' AS ETC3_4/*직급3*/, '' AS ETC3_5/*번호3*/, '' AS ETC3_6/*성명3*/, '' AS ETC3_7/*비율3*/, 
       '' AS ETC4_1 /*감사소속4*/, '' AS ETC4_2 /*적출소속4*/, '' AS ETC4_3/*현소속4*/, '' AS ETC4_4/*직급4*/, '' AS ETC4_5/*번호4*/, '' AS ETC4_6/*성명4*/, '' AS ETC4_7/*비율2*/, 
       '' AS ETC5_1 /*감사소속5*/, '' AS ETC5_2 /*적출소속4*/, '' AS ETC5_3/*현소속4*/, '' AS ETC5_4/*직급4*/, '' AS ETC5_5/*번호4*/, '' AS ETC5_6/*성명4*/, '' AS ETC5_7/*비율2*/
  from TBCSPBII100M AA, TBCSPBII120L BB, TBBADEAR001M CC, TBBADEAR002D DD, TBBADDED001M EE,
       (Select REL_AUD_YR AUD_YR, REL_AUD_NO AUD_NO, min(AUD_STR_DT) AUD_STR_DT, max(AUD_END_DT) AUD_END_DT from TBBADDED002M Where BZT_YR >= '2005' Group By REL_AUD_YR, REL_AUD_NO) FF,
       TBBADDED001M GG, TBDCMACM013C HH
 Where AA.CMPT_DT BETWEEN #strStrDt# AND #strEndDt# 
   and AA.HNDL_RSLT_CD in ('31','32','33')
   and AA.YE = BB.YE and AA.SRNO = BB.SRNO
   and BB.AUD_YR = CC.AUD_YR and BB.AUD_NO = CC.AUD_NO and BB.DSP_RQ_SNO = CC.DSP_RQ_SNO
   and BB.AUD_YR = DD.AUD_YR and BB.AUD_NO = DD.AUD_NO and BB.DSP_RQ_SNO = DD.DSP_RQ_SNO
   and FF.AUD_YR(+) = BB.AUD_YR and FF.AUD_NO(+) = BB.AUD_NO
   and GG.AUD_YR(+) = BB.AUD_YR and GG.AUD_NO(+) = BB.AUD_NO
   and EE.AUD_YR = BB.AUD_YR and EE.AUD_NO = BB.AUD_NO
   and HH.CMM_CD_DVSN_CD = '1000739' and HH.CD = EE.AUD_KND_CD
			
		]]>
	</select>
	
	<select id="CSPBII191QselectReportList6_2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			Select AA.YE||'-'||AA.SRNO INF_SNO /*정보번호*/,
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = AA.PRSR_DPT_CD) DPT_NM /*제출소속*/,
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = (Select DPT_CD from TBDCMACM001M Where CNB = AA.PRSR_CNB)) DPT_NM2 /*현재소속*/,
       substr(AA.SMT_DT,1,4)||'-'||substr(AA.SMT_DT,5,2)||'-'||substr(AA.SMT_DT,7,2) SMT_DT /*정보제출일*/, 
       AA.PRSR_CNB,  /*제출자 전산번호*/
       F_CODE_NM('1000173', AA.PRSR_RANK_CD) AS PRSR_RANK_NM /*제출자직급*/,
       F_USR_INFO(AA.PRSR_CNB,'2') AS USR_NAM /*제출자*/,
       AA.TIT_TXT /*정보 제목*/,
       AA.REL_ORG_CD /*정보기관*/, 
       (Select ORG_NM from TBDCMACM015M Where ORG_CD = AA.REL_ORG_CD) AS ORG_NM /*정보관련기관*/,
       AA.HNDL_DPT_CD /*소관과*/, 
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = AA.HNDL_DPT_CD) AS HNDL_DPT_NM /*소관부서*/,
       AA.HNDL_ORD_CD /*지시*/, 
       F_CODE_NM('1000039',AA.HNDL_ORD_CD) AS HNDL_ORD_NM /*처리지시*/,
       AA.CMPT_DT /*"정보완결일*/, 
       EE.AUD_YR||'-'||HH.CD_NM||'-'||EE.AUD_GRN_NO||'-'||BB.DSP_RQ_SNO  AS AUD_DSP_SNO /*처분번호*/,
       GG.AUD_SBJ_NM /*감사사항명*/,
       GG.SPV_BRDV_CD /*감사과*/, 
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = GG.SPV_BRDV_CD) AS SPV_BRDV_NM /*감사부서*/,
       DD.ENF_BRDV_CD /*시행과*/, 
       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = DD.ENF_BRDV_CD) AS ENF_BRDV_NM /*시행부서*/,
       substr(FF.AUD_STR_DT,1,4)||'-'||substr(FF.AUD_STR_DT,5,2)||'-'||substr(FF.AUD_STR_DT,7,2) AS AUD_STR_DT /*감사시작일*/,
       substr(FF.AUD_END_DT,1,4)||'-'||substr(FF.AUD_END_DT,5,2)||'-'||substr(FF.AUD_END_DT,7,2) AS AUD_END_DT /*감사종료일*/,
       substr(DD.ENF_DT,1,4)||'-'||substr(DD.ENF_DT,5,2)||'-'||substr(DD.ENF_DT,7,2) AS ENF_DT /*시행일자*/,
       F_CODE_NM('1000002',CC.DSP_RQ_KND_CD) AS DSP_RQ_KND_NM /*처분종류*/,
       DD.NOP_CNT /*인원*/, 
       DD.PNL_DRIN_PSVT_AM /*금액*/,
       CC.TIT_TXT AS AUD_TIT_TXT/*처분요구 제목*/, 
       DD.RLTN_ORG_CD /*처분기관*/, 
       (Select ORG_NM from TBDCMACM015M Where ORG_CD = DD.RLTN_ORG_CD) RLTN_ORG_NM /*처분관련기관*/,
       AA.YE||'-'||AA.SRNO||'-'||EE.AUD_YR||'-'||HH.CD_NM||'-'||EE.AUD_GRN_NO||'-'||BB.DSP_RQ_SNO  AS DSP_RQ_SNO_NUM /*연결번호*/,
       '' AS ETC1_1 /*감사소속1*/, '' AS ETC1_2 /*적출소속1*/, '' AS ETC1_3/*현소속1*/, '' AS ETC1_4/*직급1*/, '' AS ETC1_5/*번호1*/, '' AS ETC1_6/*성명1*/, '' AS ETC1_7/*비율1*/, 
       '' AS ETC2_1 /*감사소속2*/, '' AS ETC2_2 /*적출소속2*/, '' AS ETC2_3/*현소속2*/, '' AS ETC2_4/*직급2*/, '' AS ETC2_5/*번호2*/, '' AS ETC2_6/*성명2*/, '' AS ETC2_7/*비율2*/, 
       '' AS ETC3_1 /*감사소속3*/, '' AS ETC3_2 /*적출소속3*/, '' AS ETC3_3/*현소속3*/, '' AS ETC3_4/*직급3*/, '' AS ETC3_5/*번호3*/, '' AS ETC3_6/*성명3*/, '' AS ETC3_7/*비율3*/, 
       '' AS ETC4_1 /*감사소속4*/, '' AS ETC4_2 /*적출소속4*/, '' AS ETC4_3/*현소속4*/, '' AS ETC4_4/*직급4*/, '' AS ETC4_5/*번호4*/, '' AS ETC4_6/*성명4*/, '' AS ETC4_7/*비율2*/, 
       '' AS ETC5_1 /*감사소속5*/, '' AS ETC5_2 /*적출소속4*/, '' AS ETC5_3/*현소속4*/, '' AS ETC5_4/*직급4*/, '' AS ETC5_5/*번호4*/, '' AS ETC5_6/*성명4*/, '' AS ETC5_7/*비율2*/
  from TBCSPBII100M AA, TBCSPBII120L BB, TBBADEAR001M CC, TBBADEAR002D DD, TBBADDED001M EE,
       (Select REL_AUD_YR AUD_YR, REL_AUD_NO AUD_NO, min(AUD_STR_DT) AUD_STR_DT, max(AUD_END_DT) AUD_END_DT from TBBADDED002M Where BZT_YR >= '2005' Group By REL_AUD_YR, REL_AUD_NO) FF,
       TBBADDED001M GG, TBDCMACM013C HH
 Where AA.CMPT_DT BETWEEN #strStrDt# AND #strEndDt# 
   and AA.HNDL_RSLT_CD in ('31','32','33')
   and AA.YE = BB.YE and AA.SRNO = BB.SRNO
   and BB.AUD_YR = CC.AUD_YR and BB.AUD_NO = CC.AUD_NO and BB.DSP_RQ_SNO = CC.DSP_RQ_SNO
   and BB.AUD_YR = DD.AUD_YR and BB.AUD_NO = DD.AUD_NO and BB.DSP_RQ_SNO = DD.DSP_RQ_SNO
   and FF.AUD_YR(+) = BB.AUD_YR and FF.AUD_NO(+) = BB.AUD_NO
   and GG.AUD_YR(+) = BB.AUD_YR and GG.AUD_NO(+) = BB.AUD_NO
   and EE.AUD_YR = BB.AUD_YR and EE.AUD_NO = BB.AUD_NO
   and HH.CMM_CD_DVSN_CD = '1000739' and HH.CD = EE.AUD_KND_CD
			
		]]>
	</select>	
	
	<select id="CSPBII191QselectReportList7" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		
			Select /*CSPBII191QselectReportList7*/
					AA.YE||'-'||AA.SRNO||'-'||FF.AUD_YR||'-'||HH.CD_NM||'-'||FF.AUD_GRN_NO||'-'||BB.DSP_RQ_SNO AS COL1 /*연결번호*/,
		       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = FFF.BLT_BRDV_CD) AS COL2 /*감사소속*/,
		       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = EE.ETR_PEN_BLT_CD) AS COL3 /*적출소속*/,
		       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = (Select DPT_CD from TBDCMACM001M Where CNB = EE.ETR_PEN_ID)) AS COL4 /*현재소속*/, 
		       (Select CD_NM from TBDCMACM013C Where CD = EE.ETR_PEN_RANK_CD and CMM_CD_DVSN_CD = '1000173') AS COL5 /*직급*/,
		       EE.ETR_PEN_ID AS COL6 /*번호*/, EE.ETR_PEN_NAM AS COL7 /*성명*/, EE.CTB_RTE||'%' AS COL8 /*비율*/ 
		  from TBCSPBII100M AA, TBCSPBII120L BB, TBBADEAR004M EE, TBBADDED001M FF,
		       (Select BB.AUD_YR, BB.AUD_NO, GG.PCT_CNB, Min(GG.BLT_BRDV_CD) BLT_BRDV_CD
		          From TBCSPBII100M AA, TBCSPBII120L BB, TBBADDED002M FF, TBBADDED005L GG
		         Where AA.CMPT_DT BETWEEN #strStrDt# AND #strEndDt# 
		           and AA.HNDL_RSLT_CD in ('31','32','33')
		           and AA.YE = BB.YE and AA.SRNO = BB.SRNO
		           and BB.AUD_YR = FF.REL_AUD_YR and BB.AUD_NO = FF.REL_AUD_NO
		           and GG.BZT_YR = FF.BZT_YR and GG.BZT_SNO = FF.BZT_SNO
		         Group by BB.AUD_YR, BB.AUD_NO, GG.PCT_CNB) FFF, TBDCMACM013C HH
		 Where AA.CMPT_DT BETWEEN #strStrDt# AND #strEndDt# 
		   and AA.HNDL_RSLT_CD in ('31','32','33')
		   and AA.YE = BB.YE and AA.SRNO = BB.SRNO
		   and BB.AUD_YR = EE.AUD_YR and BB.AUD_NO = EE.AUD_NO and BB.DSP_RQ_SNO = EE.DSP_RQ_SNO
		   and FF.AUD_YR = BB.AUD_YR and FF.AUD_NO = BB.AUD_NO
		   and EE.AUD_YR = FFF.AUD_YR(+) and EE.AUD_NO = FFF.AUD_NO(+) and EE.ETR_PEN_ID = FFF.PCT_CNB(+)
		   and HH.CMM_CD_DVSN_CD = '1000739' and HH.CD = FF.AUD_KND_CD
		 Order By AA.YE, AA.SRNO, BB.AUD_YR, BB.AUD_NO, BB.DSP_RQ_SNO
		]]>
	</select>
	
	<select id="CSPBII191QselectReportList7_2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		
			Select /*CSPBII191QselectReportList7*/
					AA.YE||'-'||AA.SRNO||'-'||FF.AUD_YR||'-'||HH.CD_NM||'-'||FF.AUD_GRN_NO||'-'||BB.DSP_RQ_SNO AS COL1 /*연결번호*/,
		       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = FFF.BLT_BRDV_CD) AS COL2 /*감사소속*/,
		       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = EE.ETR_PEN_BLT_CD) AS COL3 /*적출소속*/,
		       (Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = (Select DPT_CD from TBDCMACM001M Where CNB = EE.ETR_PEN_ID)) AS COL4 /*현재소속*/, 
		       (Select CD_NM from TBDCMACM013C Where CD = EE.ETR_PEN_RANK_CD and CMM_CD_DVSN_CD = '1000173') AS COL5 /*직급*/,
		       EE.ETR_PEN_ID AS COL6 /*번호*/, EE.ETR_PEN_NAM AS COL7 /*성명*/, EE.CTB_RTE||'%' AS COL8 /*비율*/ 
		  from TBCSPBII100M AA, TBCSPBII120L BB, TBBADEAR004M EE, TBBADDED001M FF,
		       (Select BB.AUD_YR, BB.AUD_NO, GG.PCT_CNB, Min(GG.BLT_BRDV_CD) BLT_BRDV_CD
		          From TBCSPBII100M AA, TBCSPBII120L BB, TBBADDED002M FF, TBBADDED005L GG
		         Where AA.CMPT_DT BETWEEN #strStrDt# AND #strEndDt# 
		           and AA.HNDL_RSLT_CD in ('31','32','33')
		           and AA.YE = BB.YE and AA.SRNO = BB.SRNO
		           and BB.AUD_YR = FF.REL_AUD_YR and BB.AUD_NO = FF.REL_AUD_NO
		           and GG.BZT_YR = FF.BZT_YR and GG.BZT_SNO = FF.BZT_SNO
		         Group by BB.AUD_YR, BB.AUD_NO, GG.PCT_CNB) FFF, TBDCMACM013C HH
		 Where AA.CMPT_DT BETWEEN #strStrDt# AND #strEndDt# 
		   and AA.HNDL_RSLT_CD in ('31','32','33')
		   and AA.YE = BB.YE and AA.SRNO = BB.SRNO
		   and BB.AUD_YR = EE.AUD_YR and BB.AUD_NO = EE.AUD_NO and BB.DSP_RQ_SNO = EE.DSP_RQ_SNO
		   and FF.AUD_YR = BB.AUD_YR and FF.AUD_NO = BB.AUD_NO
		   and EE.AUD_YR = FFF.AUD_YR(+) and EE.AUD_NO = FFF.AUD_NO(+) and EE.ETR_PEN_ID = FFF.PCT_CNB(+)
		   and HH.CMM_CD_DVSN_CD = '1000739' and HH.CD = FF.AUD_KND_CD
		 Order By AA.YE, AA.SRNO, BB.AUD_YR, BB.AUD_NO, BB.DSP_RQ_SNO
		]]>
	</select>	
	
	<select id="CSPBII191QselectReportList8" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT T1.YE||'-'||T1.SRNO AS COL1 /*정보번호*/
                ,F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, '', '-') ||'-'|| T2.DSP_RQ_SNO AS COL2 /*처분번호*/
                ,(Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = T1.BLT_BRDV_CD) AS COL3 /*감사소속*/
                ,(Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = T4.ETR_PEN_BLT_CD)  AS COL4  /*적출소속*/
                ,(Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = T5.DPT_CD) AS COL5 /*현재소속*/
                ,T5.RANK_SRT_SEQ_NM AS COL6 /*직급*/
                ,T5.CNB AS COL7 /*전산번호*/
                ,T5.USR_NAM AS COL8 /*성명*/
                ,substr(T3.ENF_DT,1,4)||'-'||substr(T3.ENF_DT,5,2)||'-'||substr(T3.ENF_DT,7,2) AS COL9 /*시행일자*/
                ,'' AS COL10 /*제출부서*/ ,'' AS COL11 /*시행부서*/ ,'' AS COL12 /*처분종류*/ 
                ,'' AS COL13 /*인원*/ ,'' AS COL14 /*금액*/ ,'' AS COL15 /*처분요구제목*/
                , (Select USR_NAM from TBDCMACM001M Where CNB = T6.PRSR_CNB) AS COL16 /*제출자*/
                , '' AS COL17 /*제출소속*/ ,'' AS COL18 /*현재소속*/
                , (Select CD_NM from TBDCMACM013C Where CD = T4.ETR_PEN_RANK_CD and CMM_CD_DVSN_CD = '1000173') AS COL19 /*직급*/
                , T4.ETR_PEN_NAM AS COL20 /*적출자*/, T4.CTB_RTE||'%' AS COL21 /*비율*/
           FROM 
         (
			    Select AA.YE,AA.SRNO,BB.AUD_YR, BB.AUD_NO, GG.PCT_CNB,Min(GG.BLT_BRDV_CD) BLT_BRDV_CD
			          From TBCSPBII100M AA, TBCSPBII120L BB, TBBADDED002M FF, TBBADDED005L GG
			         Where AA.CMPT_DT BETWEEN #strStrDt# AND #strEndDt# 
			           and AA.HNDL_RSLT_CD in ('31','32','33')
			           and AA.YE = BB.YE and AA.SRNO = BB.SRNO
			           and BB.AUD_YR = FF.REL_AUD_YR and BB.AUD_NO = FF.REL_AUD_NO
			           and GG.BZT_YR = FF.BZT_YR and GG.BZT_SNO = FF.BZT_SNO
			         Group by AA.YE,AA.SRNO,BB.AUD_YR, BB.AUD_NO, GG.PCT_CNB
			         ) T1 , TBBADEAR001M T2, TBBADEAR002D T3, TBBADEAR004M T4, TBDCMACM001M T5, TBCSPBII100M T6
	         WHERE T1.AUD_YR = T2.AUD_YR
	         AND T1.AUD_NO = T2.AUD_NO
	         AND T2.AUD_YR = T3.AUD_yR 
	         AND T2.AUD_NO = T3.AUD_NO
	         AND T2.DSP_RQ_SNO = T3.DSP_RQ_SNO
	         AND T2.AUD_YR = T4.AUD_yR 
	         AND T2.AUD_NO = T4.AUD_NO
	         AND T2.DSP_RQ_SNO = T4.DSP_RQ_SNO
	         AND T1.PCT_CNB = T4.ETR_PEN_ID
	         AND T1.PCT_CNB = T5.CNB
	         AND T1.YE = T6.YE
	         AND T1.SRNO = T6.SRNO
	         ORDER BY T1.YE, T1.SRNO
		]]>
	</select>
	
	<select id="CSPBII191QselectReportList8_2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT T1.YE||'-'||T1.SRNO AS COL1 /*정보번호*/
                ,F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, '', '-') ||'-'|| T2.DSP_RQ_SNO AS COL2 /*처분번호*/
                ,(Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = T1.BLT_BRDV_CD) AS COL3 /*감사소속*/
                ,(Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = T4.ETR_PEN_BLT_CD)  AS COL4  /*적출소속*/
                ,(Select ABR_DPT_NM_1 from TBDCMACM002M Where DPT_CD = T5.DPT_CD) AS COL5 /*현재소속*/
                ,T5.RANK_SRT_SEQ_NM AS COL6 /*직급*/
                ,T5.CNB AS COL7 /*전산번호*/
                ,T5.USR_NAM AS COL8 /*성명*/
                ,substr(T3.ENF_DT,1,4)||'-'||substr(T3.ENF_DT,5,2)||'-'||substr(T3.ENF_DT,7,2) AS COL9 /*시행일자*/
                ,'' AS COL10 /*제출부서*/ ,'' AS COL11 /*시행부서*/ ,'' AS COL12 /*처분종류*/ 
                ,'' AS COL13 /*인원*/ ,'' AS COL14 /*금액*/ ,'' AS COL15 /*처분요구제목*/
                , (Select USR_NAM from TBDCMACM001M Where CNB = T6.PRSR_CNB) AS COL16 /*제출자*/
                , '' AS COL17 /*제출소속*/ ,'' AS COL18 /*현재소속*/
                , (Select CD_NM from TBDCMACM013C Where CD = T4.ETR_PEN_RANK_CD and CMM_CD_DVSN_CD = '1000173') AS COL19 /*직급*/
                , T4.ETR_PEN_NAM AS COL20 /*적출자*/, T4.CTB_RTE||'%' AS COL21 /*비율*/
           FROM 
         (
			    Select AA.YE,AA.SRNO,BB.AUD_YR, BB.AUD_NO, GG.PCT_CNB,Min(GG.BLT_BRDV_CD) BLT_BRDV_CD
			          From TBCSPBII100M AA, TBCSPBII120L BB, TBBADDED002M FF, TBBADDED005L GG
			         Where AA.CMPT_DT BETWEEN #strStrDt# AND #strEndDt# 
			           and AA.HNDL_RSLT_CD in ('31','32','33')
			           and AA.YE = BB.YE and AA.SRNO = BB.SRNO
			           and BB.AUD_YR = FF.REL_AUD_YR and BB.AUD_NO = FF.REL_AUD_NO
			           and GG.BZT_YR = FF.BZT_YR and GG.BZT_SNO = FF.BZT_SNO
			         Group by AA.YE,AA.SRNO,BB.AUD_YR, BB.AUD_NO, GG.PCT_CNB
			         ) T1 , TBBADEAR001M T2, TBBADEAR002D T3, TBBADEAR004M T4, TBDCMACM001M T5, TBCSPBII100M T6
	         WHERE T1.AUD_YR = T2.AUD_YR
	         AND T1.AUD_NO = T2.AUD_NO
	         AND T2.AUD_YR = T3.AUD_yR 
	         AND T2.AUD_NO = T3.AUD_NO
	         AND T2.DSP_RQ_SNO = T3.DSP_RQ_SNO
	         AND T2.AUD_YR = T4.AUD_yR 
	         AND T2.AUD_NO = T4.AUD_NO
	         AND T2.DSP_RQ_SNO = T4.DSP_RQ_SNO
	         AND T1.PCT_CNB = T4.ETR_PEN_ID
	         AND T1.PCT_CNB = T5.CNB
	         AND T1.YE = T6.YE
	         AND T1.SRNO = T6.SRNO
	         ORDER BY T1.YE, T1.SRNO
		]]>
	</select>	
	
	<!-- 출장상황 목록 조회 -->   
	<select id="CSPBII191PBztSituSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[       
			SELECT ROW_NUMBER() OVER(PARTITION BY A.YE, A.SRNO ORDER BY A.BZT_STR_DT, A.BZT_END_DT) AS BZT_SITU_NO  
				 , TO_CHAR(TO_DATE(A.BZT_STR_DT, 'YYYYMMDD'), 'MM.DD') || '~' || TO_CHAR(TO_DATE(A.BZT_END_DT, 'YYYYMMDD'), 'MM.DD') || '/'				
				|| A.TIT_TXT || '/'
				|| (SELECT B.ORG_NM
				      FROM TBDCMACM015M B
				     WHERE B.ORG_CD = A.ORG_CD) || CASE WHEN A.ORG_CNT = 0 THEN NULL
				                                        ELSE ' 외 ' || A.ORG_CNT 
				                                   END AS BZT_SITU			                                   
				 , A.YE
				 , A.SRNO
			  FROM (SELECT C.YE
			             , C.SRNO   
			             , A.BZT_STR_DT
			             , A.BZT_END_DT
			             , B.TIT_TXT
			             , (SELECT MIN(D.ORG_CD)
			                  FROM TBBADDED008L D
			                 WHERE D.BZT_YR   = A.BZT_YR
			                   AND D.BZT_SNO  = A.BZT_SNO
			                   AND D.TEAM_SNO = A.TEAM_SNO) AS ORG_CD
			             , (SELECT COUNT(*) - 1
			                  FROM TBBADDED008L D
			                 WHERE D.BZT_YR   = A.BZT_YR
			                   AND D.BZT_SNO  = A.BZT_SNO
			                   AND D.TEAM_SNO = A.TEAM_SNO) AS ORG_CNT
			          FROM TBBADDED005L A
			             , TBBADDED002M B
			             , TBCSPBII100M C
			         WHERE A.BZT_YR  = B.BZT_YR
			           AND A.BZT_SNO = B.BZT_SNO
			           AND A.PCT_CNB = C.PRSR_CNB
			           AND A.BZT_STR_DT >= TO_CHAR(ADD_MONTHS(TO_DATE(C.SMT_DT, 'YYYYMMDD'), -3), 'YYYYMMDD')
			           AND A.BZT_END_DT <= C.SMT_DT
			]]>		
			<isEqual property="strDVSN_CD" compareValue="1">
			           AND C.ACP_DT BETWEEN #strStrAcpDt# AND #strEndAcpDt#
			           AND C.ACP_DH BETWEEN #strStrAcpDh# AND #strEndAcpDh#
			</isEqual>
			<isEqual property="strDVSN_CD" compareValue="2">
			           AND C.DTB_DT BETWEEN #strStrAcpDt# AND #strEndAcpDt#
			</isEqual>
			<isNotEmpty property="strYeList">	
			AND (c.YE, c.SRNO) IN (SELECT REGEXP_SUBSTR(#strYeList#, '[^||]+', 1, LEVEL)
                                        , REGEXP_SUBSTR(#strSrnoList#, '[^||]+', 1, LEVEL)
                                     FROM DUAL
                                   CONNECT BY LEVEL &lt;= REGEXP_COUNT(#strYeList#, '[^|]+'))
			</isNotEmpty>
			<isNotEmpty property="strBLE_CHGR_CNB">
				AND C.BLE_CHGR_CNB = #strBLE_CHGR_CNB#
			</isNotEmpty>
			<isNotEmpty property="strYe">
				AND C.YE =  #strYe#
			</isNotEmpty>
			
			<!-- 일련번호 -->
			<isNotEmpty property="strSrno">
				AND C.SRNO =  #strSrno#
			</isNotEmpty>
			           ) A
			ORDER BY BZT_SITU_NO			           		
		
	</select>	
</sqlMap>