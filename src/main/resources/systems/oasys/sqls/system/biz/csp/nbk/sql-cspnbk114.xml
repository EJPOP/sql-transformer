<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="csp/nbk/114">
	
	<select id="CSPNBK114EOpMtrlMngListSelect" parameterClass="paramMap" resultClass="resultMap">
	<![CDATA[
		SELECT	/* CSPNBK114EOpMtrlMngListSelect */
				D1.OP_MTRL_MNG_CD
				, D1.MNG_CLU_NM
				, D1.SET_TXT
				, D1.USE_YN
		FROM	TBCSPNBK003M D1
	]]>
		<dynamic prepend="WHERE">
			<isNotEmpty property="mngCluNm" prepend="AND">
				D1.MNG_CLU_NM LIKE '%' || #mngCluNm# || '%'
			</isNotEmpty>
			<isNotEmpty property="opMtrlMngCd" prepend="AND">
				D1.OP_MTRL_MNG_CD IN
				<iterate open="(" close=")" property="opMtrlMngCd" conjunction=",">
                     #opMtrlMngCd[]#
               </iterate>
			</isNotEmpty>
		</dynamic>
	<![CDATA[
		ORDER BY TO_NUMBER(OP_MTRL_MNG_CD)
	]]>
	</select>
	
	<select id="CSPNBK114ENewOpMtrlMngCdSelect" parameterClass="paramMap" resultClass="String">
	<![CDATA[
		SELECT	/* CSPNBK114ENewOpMtrlMngCdSelect */
				NVL(MAX(TO_NUMBER(D1.OP_MTRL_MNG_CD)), 0) + 1 AS OP_MTRL_MNG_CD
		FROM	TBCSPNBK003M D1
	]]>
	</select>
	
	<insert id="CSPNBK114EOpMtrlMngInsert" parameterClass="paramMap">
	<![CDATA[
		INSERT INTO /* CSPNBK114EOpMtrlMngInsert */ TBCSPNBK003M
		(
			OP_MTRL_MNG_CD
			, MNG_CLU_NM
			, SET_TXT
			, USE_YN
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			, FNL_MDF_DH
		)
		VALUES
		(
			#OP_MTRL_MNG_CD#
			, #MNG_CLU_NM#
			, #SET_TXT#
			, 'Y'
			, #FRT_USR_ID#
			, #FNL_USR_ID#
			, #FNL_DEAL_DPT_CD#
			, #FNL_MNU_ID#
			, SYSDATE
			, SYSDATE
		)
	]]>
	</insert>
	
	<update id="CSPNBK114EOpMtrlMngUpdate" parameterClass="paramMap">
	<![CDATA[
		UPDATE	/* CSPNBK114EOpMtrlMngUpdate */ TBCSPNBK003M
		SET		MNG_CLU_NM = #MNG_CLU_NM#
				, SET_TXT = #SET_TXT#
				, USE_YN = #USE_YN#
				, FNL_USR_ID = #FNL_USR_ID#
				, FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
				, FNL_MNU_ID = #FNL_MNU_ID#
				, FNL_MDF_DH = SYSDATE
		WHERE	OP_MTRL_MNG_CD = #OP_MTRL_MNG_CD#
	]]>
	</update>	
</sqlMap>