<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="faa/cav/032">
	
	<select id="FAACAV032ERSelect" parameterClass="paramMap" 	resultClass="resultMap">
		<![CDATA[  /* faa/cav/032/FAACAV032ERSelect */ ]]>
		SELECT ( SELECT COUNT(DISTINCT A.ORG_CD) ORG_TYPE_CDSUM              
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                   
				  WHERE B.ORG_CAT_CD BETWEEN 'A' AND 'H'                      
					AND  A.ORG_CD = B.ORG_CD                                      
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                           
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
					AND  C.FRT_ACP_DT >= #strYrFrom#||#strMmFrom# ||'00'  
		<![CDATA[	AND  C.FNL_ACP_DT <= #strYrTo#||#strMmTo#||'99'   ]]> 
				) AS 기관수합계
				,(
				 SELECT COUNT(C.FRT_ACP_DT) GYESAN_SUM                              
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                               
				  WHERE B.ORG_CAT_CD BETWEEN 'A' AND 'H'                                  
					AND  A.ORG_CD = B.ORG_CD                                     
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                        
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
				) AS 책수합계
				,(
				 SELECT COUNT(DISTINCT A.ORG_CD) ORG_TYPE_CD10              
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                  
				  WHERE B.ORG_CAT_CD IN ('A', 'B')                           
		<![CDATA[	AND  (A.ORG_CD LIKE '0%' OR A.ORG_CD LIKE '1%')   ]]>
					AND  A.ORG_CD = B.ORG_CD                                   
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                           
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
					AND  C.FRT_ACP_DT >= #strYrFrom#||#strMmFrom#||'00'  
		<![CDATA[	AND  C.FNL_ACP_DT <= #strYrTo#||#strMmTo#||'99'   ]]>
				) AS 국가기관기관수
				,(
				 SELECT COUNT(C.FRT_ACP_DT) GYESAN10                   
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                  
				  WHERE B.ORG_CAT_CD IN ('A','B')                            
		<![CDATA[	AND  (A.ORG_CD LIKE '0%' OR A.ORG_CD LIKE '1%')   ]]>                      
					AND  A.ORG_CD = B.ORG_CD                                   
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                        
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
				) AS 국가기관책수
				,(
				 SELECT COUNT(DISTINCT A.ORG_CD) ORG_TYPE_CD2122           
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                 
				  WHERE B.ORG_CAT_CD IN ('C', 'D','E','F')                  
					AND  A.ORG_CD = B.ORG_CD                                  
					AND  A.ORG_CD LIKE '2%'                        
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                           
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
					AND  C.FRT_ACP_DT >= #strYrFrom#||#strMmFrom# || '00'  
		<![CDATA[	AND  C.FNL_ACP_DT <= #strYrTo#||#strMmTo#||'99'   ]]>
				) AS 지방자치단체기관수
				,(
				 SELECT COUNT(C.FRT_ACP_DT) GYESAN2122                   
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                    
				  WHERE B.ORG_CAT_CD IN ( 'C','D','E','F')                     
					AND  A.ORG_CD = B.ORG_CD                                     
					AND  A.ORG_CD LIKE '2%'                        
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                        
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
				) AS 지방자치단체책수
				,(
				 SELECT COUNT(DISTINCT A.ORG_CD) ORG_TYPE_CD30                 
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                     
				  WHERE B.ORG_CAT_CD = 'G'                                      
					AND  A.ORG_CD = B.ORG_CD                                      
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                           
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
					AND  C.FRT_ACP_DT >= #strYrFrom#||#strMmFrom# ||'00'  
		<![CDATA[	AND  C.FNL_ACP_DT <= #strYrTo#||#strMmTo#||'99'   ]]>
				) AS 정부투자기관기관수
				,(
				 SELECT COUNT(C.FRT_ACP_DT) GYESAN30                     
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                    
				  WHERE B.ORG_CAT_CD = 'G'                                     
					AND  A.ORG_CD = B.ORG_CD                                     
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                        
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
				) AS 정부투자기관책수
				,(
				 SELECT COUNT(DISTINCT A.ORG_CD) ORG_TYPE_CDOTHER               
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                      
				  WHERE B.ORG_CAT_CD = 'H'                                       
					AND  A.ORG_CD = B.ORG_CD                                      
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                           
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
					AND  C.FRT_ACP_DT >= #strYrFrom#||#strMmFrom#||'00'  
		<![CDATA[	AND  C.FNL_ACP_DT <= #strYrTo#||#strMmTo#||'99'   ]]>
				) AS 기타단체기관수
				,(
				 SELECT COUNT(C.FRT_ACP_DT) GYESAN_OTHER                
				   FROM TWFAACAV003M A, TBDCMACM015M B, TWFAACAV004L C                    
				  WHERE B.ORG_CAT_CD = 'H'                                    
					AND  A.ORG_CD = B.ORG_CD                                     
					AND  A.COPT_CD =  C.COPT_CD                                
					AND  A.ACNT_CD = C.ACNT_CD                                 
					AND  A.BLL_CD = C.BLL_CD                                 
					AND  A.PROF_DRTR_SRNO = C.PROF_DRTR_SRNO                             
					AND  A.DL_XPN_RCDB_PBSVT_SRNO = C.DL_XPN_RCDB_PBSVT_SRNO                        
					AND  C.PROF_YM LIKE #strYrFrom#||'%'
				) AS 기타단체책수
		   FROM DUAL
	</select>
	
	
	<select id="FAACAV032ERSelect_1" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/032/FAACAV032ERSelect_1 */ ]]>
		WITH DETAIL_SQL AS (
			SELECT B.* ,
			       C.ACNT_CD_NM ,
			       B.COL11 + B.COL12 + B.COL13 + B.COL14 + B.COL15 + B.COL16+ B.COL17 + B.COL18 + B.COL19 + B.COL20 + B.COL19_1+ B.COL21 + B.COL22 + B.COL23 + B.COL28+ B.COL29+ B.COL30 + B.COL31 + B.COL32 + B.COL33+ B.COL34+ B.COL35 + B.COL41 + B.COL42 + B.COL51+ B.COL52+ B.COL53 + B.COL54 + B.COL56 + B.COL57+ B.COL55 TOTAL,
			       B.CO11 + B.CO12 + B.CO13 + B.CO14 + B.CO15 + B.CO16+ B.CO17 + B.CO18 + B.CO19 + B.CO20 + B.CO19_1+ B.CO21 + B.CO22 + B.CO23 + B.CO28+ B.CO29+ B.CO30 + B.CO31 + B.CO32 + B.CO33+ B.CO34+ B.CO35 + B.CO41 + B.CO42 + B.CO51+ B.CO52+ B.CO53 + B.CO54 + B.CO56 + B.CO57+ B.CO55 TOTAL1
			  FROM (SELECT A.COPT_CD AS ACNT_CD,
			  			   NVL(A.ACNT_CD_NM, '특별') AS GUBUN,
			               SUM(COL11) COL11,
			               SUM(COL12) COL12 ,
			               SUM(COL13) COL13 ,
			               SUM(COL14) COL14 ,
			               SUM(COL15) COL15,
			               SUM(COL16) COL16,
			               SUM(COL17) COL17 ,
			               SUM(COL18) COL18 ,
			               SUM(COL19) COL19 ,
			               SUM(COL20) COL20,
			               SUM(COL19_1) COL19_1,
			               SUM(COL21) COL21 ,
			               SUM(COL22) COL22 ,
			               SUM(COL23) COL23 ,
			               SUM(COL28) COL28,
			               SUM(COL29) COL29,
			               SUM(COL30) COL30 ,
			               SUM(COL31) COL31 ,
			               SUM(COL32) COL32 ,
			               SUM(COL33) COL33,
			               SUM(COL34) COL34,
			               SUM(COL35) COL35 ,
			               SUM(COL41) COL41 ,
			               SUM(COL42) COL42 ,
			               SUM(COL51) COL51,
			               SUM(COL52) COL52,
			               SUM(COL53) COL53 ,
			               SUM(COL54) COL54 ,
			               SUM(COL56) COL56 ,
			               SUM(COL57) COL57,
			               SUM(COL55) COL55,
			               SUM(CO11) CO11,
			               SUM(CO12) CO12 ,
			               SUM(CO13) CO13 ,
			               SUM(CO14) CO14 ,
			               SUM(CO15) CO15,
			               SUM(CO16) CO16,
			               SUM(CO17) CO17 ,
			               SUM(CO18) CO18 ,
			               SUM(CO19) CO19 ,
			               SUM(CO20) CO20,
			               SUM(CO19_1) CO19_1,
			               SUM(CO21) CO21 ,
			               SUM(CO22) CO22 ,
			               SUM(CO23) CO23 ,
			               SUM(CO28) CO28,
			               SUM(CO29) CO29,
			               SUM(CO30) CO30 ,
			               SUM(CO31) CO31 ,
			               SUM(CO32) CO32 ,
			               SUM(CO33) CO33,
			               SUM(CO34) CO34,
			               SUM(CO35) CO35 ,
			               SUM(CO41) CO41 ,
			               SUM(CO42) CO42 ,
			               SUM(CO51) CO51,
			               SUM(CO52) CO52,
			               SUM(CO53) CO53 ,
			               SUM(CO54) CO54 ,
			               SUM(CO56) CO56 ,
			               SUM(CO57) CO57,
			               SUM(CO55) CO55
			          FROM (SELECT ACC.COPT_CD,
			          			   M.ACNT_CD_NM,
			                       SUM(CASE WHEN ACC.BLL_CD = '11' THEN 1 ELSE 0 END) AS COL11,
			                       SUM(CASE WHEN ACC.BLL_CD = '12' THEN 1 ELSE 0 END) AS COL12,
			                       SUM(CASE WHEN ACC.BLL_CD = '13' THEN 1 ELSE 0 END) AS COL13,
			                       SUM(CASE WHEN ACC.BLL_CD = '14' THEN 1 ELSE 0 END) AS COL14,
			                       SUM(CASE WHEN ACC.BLL_CD = '15' THEN 1 ELSE 0 END) AS COL15,
			                       SUM( CASE WHEN ACC.BLL_CD = '16' THEN 1 ELSE 0 END) AS COL16,
			                       SUM( CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18')
			                           AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL17,
			                       SUM( CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18')
			                           AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL18,
			                       SUM( CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL19,
			                       SUM( CASE WHEN ACC.BLL_CD = '20' THEN 1 ELSE 0 END) AS COL20,
			                       SUM( CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL19_1 ,
			                       SUM( CASE WHEN ACC.BLL_CD = '21' THEN 1 ELSE 0 END) AS COL21,
			                       SUM( CASE WHEN (ACC.BLL_CD = '22' OR ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' )
			                           AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL22,
			                       SUM( CASE WHEN (ACC.BLL_CD = '22' OR ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' )
			                           AND ACC.DL_XPN_RCDB_PBSVT_SRNO != '000' THEN 1 ELSE 0 END) AS COL23,
			                       SUM( CASE WHEN ACC.BLL_CD = '28' THEN 1 ELSE 0 END) AS COL28,
			                       SUM( CASE WHEN ACC.BLL_CD = '29' THEN 1 ELSE 0 END) AS COL29,
			                       SUM( CASE WHEN ACC.BLL_CD = '30' THEN 1 ELSE 0 END) AS COL30,
			                       SUM( CASE WHEN ACC.BLL_CD = '31' THEN 1 ELSE 0 END) AS COL31,
			                       SUM( CASE WHEN ACC.BLL_CD = '32' THEN 1 ELSE 0 END) AS COL32,
			                       SUM( CASE WHEN ACC.BLL_CD = '33' THEN 1 ELSE 0 END) AS COL33,
			                       SUM( CASE WHEN ACC.BLL_CD = '34' THEN 1 ELSE 0 END) AS COL34,
			                       SUM( CASE WHEN ACC.BLL_CD = '35' THEN 1 ELSE 0 END) AS COL35,
			                       SUM( CASE WHEN ACC.BLL_CD = '41' THEN 1 ELSE 0 END) AS COL41,
			                       SUM( CASE WHEN ACC.BLL_CD = '42' OR ACC.BLL_CD = '43' THEN 1 ELSE 0 END) AS COL42,
			                       SUM( CASE WHEN ACC.BLL_CD = '51' THEN 1 ELSE 0 END) AS COL51,
			                       SUM( CASE WHEN ACC.BLL_CD = '52' THEN 1 ELSE 0 END) AS COL52,
			                       SUM( CASE WHEN ACC.BLL_CD = '53' THEN 1 ELSE 0 END) AS COL53,
			                       SUM( CASE WHEN ACC.BLL_CD = '54' THEN 1 ELSE 0 END) AS COL54,
			                       SUM( CASE WHEN ACC.BLL_CD = '56' THEN 1 ELSE 0 END) AS COL56,
			                       SUM( CASE WHEN ACC.BLL_CD = '57' THEN 1 ELSE 0 END) AS COL57,
			                       SUM( CASE WHEN ACC.BLL_CD = '55' THEN 1 ELSE 0 END) AS COL55,
			                       SUM( CASE WHEN CONT.BLL_CD = '11' THEN 1 ELSE 0 END) AS CO11,
			                       SUM( CASE WHEN CONT.BLL_CD = '12' THEN 1 ELSE 0 END) AS CO12,
			                       SUM( CASE WHEN CONT.BLL_CD = '13' THEN 1 ELSE 0 END) AS CO13,
			                       SUM( CASE WHEN CONT.BLL_CD = '14' THEN 1 ELSE 0 END) AS CO14,
			                       SUM( CASE WHEN CONT.BLL_CD = '15' THEN 1 ELSE 0 END) AS CO15,
			                       SUM( CASE WHEN CONT.BLL_CD = '16' THEN 1 ELSE 0 END) AS CO16,
			                       SUM( CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18')
			                           AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO17,
			                       SUM( CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18')
			                           AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO18,
			                       SUM( CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO = '000' THEN 1 ELSE 0 END) AS CO19,
			                       SUM( CASE WHEN CONT.BLL_CD = '20' THEN 1 ELSE 0 END) AS CO20,
			                       SUM( CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]>'000' THEN 1 ELSE 0 END) AS CO19_1,
			                       SUM( CASE WHEN CONT.BLL_CD = '21' THEN 1 ELSE 0 END) AS CO21,
			                       SUM( CASE  WHEN (CONT.BLL_CD = '22' OR CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' )
			                           AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO22,
			                       SUM( CASE WHEN (CONT.BLL_CD = '22' OR CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' )
			                           AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO23,
			                       SUM( CASE WHEN CONT.BLL_CD = '28' THEN 1 ELSE 0 END) AS CO28,
			                       SUM( CASE WHEN CONT.BLL_CD = '29' THEN 1 ELSE 0  END) AS CO29,
			                       SUM( CASE WHEN CONT.BLL_CD = '30' THEN 1 ELSE 0 END) AS CO30,
			                       SUM( CASE WHEN CONT.BLL_CD = '31' THEN 1 ELSE 0 END) AS CO31,
			                       SUM( CASE WHEN CONT.BLL_CD = '32' THEN 1 ELSE 0 END) AS CO32,
			                       SUM( CASE WHEN CONT.BLL_CD = '33' THEN 1 ELSE 0 END) AS CO33,
			                       SUM( CASE WHEN CONT.BLL_CD = '34' THEN 1 ELSE 0 END) AS CO34,
			                       SUM( CASE WHEN CONT.BLL_CD = '35' THEN 1 ELSE 0 END) AS CO35,
			                       SUM( CASE WHEN CONT.BLL_CD = '41' THEN 1 ELSE 0 END) AS CO41,
			                       SUM( CASE WHEN CONT.BLL_CD = '42' OR CONT.BLL_CD = '43' THEN 1 ELSE 0 END) AS CO42,
			                       SUM( CASE WHEN CONT.BLL_CD = '51' THEN 1 ELSE 0 END) AS CO51,
			                       SUM( CASE WHEN CONT.BLL_CD = '52' THEN 1  ELSE 0 END) AS CO52,
			                       SUM( CASE WHEN CONT.BLL_CD = '53' THEN 1 ELSE 0 END) AS CO53,
			                       SUM( CASE WHEN CONT.BLL_CD = '54' THEN 1 ELSE 0 END) AS CO54,
			                       SUM( CASE WHEN CONT.BLL_CD = '56' THEN 1 ELSE 0 END) AS CO56,
			                       SUM( CASE WHEN CONT.BLL_CD = '57' THEN 1 ELSE 0 END) AS CO57,
			                       SUM( CASE WHEN CONT.BLL_CD = '55' THEN 1 ELSE 0 END) AS CO55
			                  FROM TWFAACAV003M ACC ,
			                       TWFAACAV004L CONT,
			                       (SELECT '일반' ACNT_CD_NM, '011' AS ACNT_CD FROM DUAL
								    UNION ALL
								    SELECT '특별' ACNT_CD_NM, '' AS ACNT_CD FROM DUAL) M
			WHERE ((ACC.CRE_DT <![CDATA[ <= ]]> #strYrFrom#||#strMmFrom#) AND (ACC.ABLT_DT >= #strYrFrom#||#strMmFrom#))  
			  AND CONT.PROF_YM = #strYrFrom#||#strMmFrom#
			  AND ACC.ACNT_CD = M.ACNT_CD(+)
			   AND ACC.BLL_CD  IN ('17', '18', '19', '25', '26', '27', '51', '52', '53') 
			   AND ACC.COPT_CD = CONT.COPT_CD(+)
			   AND ACC.ACNT_CD = CONT.ACNT_CD(+)
			   AND ACC.BLL_CD = CONT.BLL_CD(+)
			   AND ACC.PROF_DRTR_SRNO = CONT.PROF_DRTR_SRNO(+)
			   AND ACC.DL_XPN_RCDB_PBSVT_SRNO = CONT.DL_XPN_RCDB_PBSVT_SRNO(+)
			 GROUP BY M.ACNT_CD_NM, ACC.COPT_CD 
			<isEqual property="strMmFrom" compareValue="01">
			  UNION  ALL         
			 SELECT  ACC.COPT_CD, M.ACNT_CD_NM,
			 SUM(CASE WHEN ACC.BLL_CD = '11' THEN 1 ELSE 0 END) AS COL11, 
			 SUM(CASE WHEN ACC.BLL_CD = '12' THEN 1 ELSE 0 END) AS COL12,
			 SUM(CASE WHEN ACC.BLL_CD = '13' THEN 1 ELSE 0 END) AS COL13, 
			 SUM(CASE WHEN ACC.BLL_CD = '14' THEN 1 ELSE 0 END) AS COL14, 
			 SUM(CASE WHEN ACC.BLL_CD = '15' THEN 1 ELSE 0 END) AS COL15,
			 SUM(CASE WHEN ACC.BLL_CD = '16' THEN 1 ELSE 0 END) AS COL16,
			 SUM(CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18') AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL17,
			 SUM(CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18') AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL18,
			SUM(CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL19,
			 SUM(CASE WHEN ACC.BLL_CD = '20' THEN 1 ELSE 0 END) AS COL20,
			 SUM(CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL19_1, 
			 SUM(CASE WHEN ACC.BLL_CD = '21' THEN 1 ELSE 0 END) AS COL21,
			 SUM(CASE WHEN (ACC.BLL_CD = '22'  OR  ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' ) AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL22, 
			 SUM(CASE WHEN (ACC.BLL_CD = '22'  OR  ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' ) AND ACC.DL_XPN_RCDB_PBSVT_SRNO != '000' THEN 1 ELSE 0 END) AS COL23, 
			 SUM(CASE WHEN ACC.BLL_CD = '28' THEN 1 ELSE 0 END) AS COL28,
			 SUM(CASE WHEN ACC.BLL_CD = '29' THEN 1 ELSE 0 END) AS COL29,
			 SUM(CASE WHEN ACC.BLL_CD = '30' THEN 1 ELSE 0 END) AS COL30,
			 SUM(CASE WHEN ACC.BLL_CD = '31' THEN 1 ELSE 0 END) AS COL31,
			 SUM(CASE WHEN ACC.BLL_CD = '32' THEN 1 ELSE 0 END) AS COL32,
			 SUM(CASE WHEN ACC.BLL_CD = '33' THEN 1 ELSE 0 END) AS COL33,
			 SUM(CASE WHEN ACC.BLL_CD = '34' THEN 1 ELSE 0 END) AS COL34,
			 SUM(CASE WHEN ACC.BLL_CD = '35' THEN 1 ELSE 0 END) AS COL35,
			 SUM(CASE WHEN ACC.BLL_CD = '41' THEN 1 ELSE 0 END) AS COL41,
			 SUM(CASE WHEN ACC.BLL_CD = '42' OR ACC.BLL_CD = '43' THEN 1 ELSE 0 END) AS COL42,
			 SUM(CASE WHEN ACC.BLL_CD = '51' THEN 1 ELSE 0 END) AS COL51,
			 SUM(CASE WHEN ACC.BLL_CD = '52' THEN 1 ELSE 0 END) AS COL52,
			 SUM(CASE WHEN ACC.BLL_CD = '53' THEN 1 ELSE 0 END) AS COL53,
			 SUM(CASE WHEN ACC.BLL_CD = '54' THEN 1 ELSE 0 END) AS COL54,
			 SUM(CASE WHEN ACC.BLL_CD = '56' THEN 1 ELSE 0 END) AS COL56,
			 SUM(CASE WHEN ACC.BLL_CD = '57' THEN 1 ELSE 0 END) AS COL57,
			 SUM(CASE WHEN ACC.BLL_CD = '55' THEN 1 ELSE 0 END) AS COL55
			,SUM(CASE WHEN CONT.BLL_CD = '11' THEN 1 ELSE 0 END) AS CO11, 
			 SUM(CASE WHEN CONT.BLL_CD = '12' THEN 1 ELSE 0 END) AS CO12, 
			 SUM(CASE WHEN CONT.BLL_CD = '13' THEN 1 ELSE 0 END) AS CO13,
			 SUM(CASE WHEN CONT.BLL_CD = '14' THEN 1 ELSE 0 END) AS CO14,
			 SUM(CASE WHEN CONT.BLL_CD = '15' THEN 1 ELSE 0 END) AS CO15,
			 SUM(CASE WHEN CONT.BLL_CD = '16' THEN 1 ELSE 0 END) AS CO16,
			 SUM(CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18')  AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO17,
			 SUM(CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18') AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO18,
			 SUM(CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO19,
			 SUM(CASE WHEN CONT.BLL_CD = '20' THEN 1 ELSE 0 END) AS CO20,
			 SUM(CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO19_1,
			 SUM(CASE WHEN CONT.BLL_CD = '21' THEN 1 ELSE 0 END) AS CO21,
			 SUM(CASE WHEN (CONT.BLL_CD = '22'  OR  CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' ) AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO22,
			SUM(CASE WHEN (CONT.BLL_CD = '22'  OR  CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' ) AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO23,
			 SUM(CASE WHEN CONT.BLL_CD = '28' THEN 1 ELSE 0 END) AS CO28,
			 SUM(CASE WHEN CONT.BLL_CD = '29' THEN 1 ELSE 0 END) AS CO29,
			 SUM(CASE WHEN CONT.BLL_CD = '30' THEN 1 ELSE 0 END) AS CO30,
			 SUM(CASE WHEN CONT.BLL_CD = '31' THEN 1 ELSE 0 END) AS CO31,
			 SUM(CASE WHEN CONT.BLL_CD = '32' THEN 1 ELSE 0 END) AS CO32,
			 SUM(CASE WHEN CONT.BLL_CD = '33' THEN 1 ELSE 0 END) AS CO33,
			 SUM(CASE WHEN CONT.BLL_CD = '34' THEN 1 ELSE 0 END) AS CO34,
			 SUM(CASE WHEN CONT.BLL_CD = '35' THEN 1 ELSE 0 END) AS CO35,
			 SUM(CASE WHEN CONT.BLL_CD = '41' THEN 1 ELSE 0 END) AS CO41,
			 SUM(CASE WHEN CONT.BLL_CD = '42' OR CONT.BLL_CD = '43' THEN 1 ELSE 0 END) AS CO42,
			 SUM(CASE WHEN CONT.BLL_CD = '51' THEN 1 ELSE 0 END) AS CO51,
			 SUM(CASE WHEN CONT.BLL_CD = '52' THEN 1 ELSE 0 END) AS CO52,
			 SUM(CASE WHEN CONT.BLL_CD = '53' THEN 1 ELSE 0 END) AS CO53,
			 SUM(CASE WHEN CONT.BLL_CD = '54' THEN 1 ELSE 0 END) AS CO54,
			 SUM(CASE WHEN CONT.BLL_CD = '56' THEN 1 ELSE 0 END) AS CO56,
			 SUM(CASE WHEN CONT.BLL_CD = '57' THEN 1 ELSE 0 END) AS CO57,
			 SUM(CASE WHEN CONT.BLL_CD = '55' THEN 1 ELSE 0 END) AS CO55
			 FROM TWFAACAV003M ACC
			 	  , TWFAACAV004L CONT
			 	  , (SELECT '일반' ACNT_CD_NM, '011' AS ACNT_CD FROM DUAL
				    UNION ALL
				    SELECT '특별' ACNT_CD_NM, '' AS ACNT_CD FROM DUAL) M
			WHERE ((ACC.CRE_DT <![CDATA[ <= ]]> #strYrFrom#||#strMmFrom# ) AND (ACC.ABLT_DT >= #strYrFrom#||#strMmFrom#))  
			AND ACC.ACNT_CD = M.ACNT_CD(+)
			AND ACC.BLL_CD IN ('14','28','30','31','32','33','34','35','55') 
			AND CONT.PROF_YM = #strYrFrom# || '00'
			AND ACC.COPT_CD = CONT.COPT_CD(+)
			AND ACC.ACNT_CD = CONT.ACNT_CD(+)
			AND ACC.BLL_CD = CONT.BLL_CD(+)
			AND ACC.PROF_DRTR_SRNO = CONT.PROF_DRTR_SRNO(+)
			AND ACC.DL_XPN_RCDB_PBSVT_SRNO = CONT.DL_XPN_RCDB_PBSVT_SRNO(+)
			GROUP BY  M.ACNT_CD_NM, ACC.COPT_CD  
			</isEqual>
			
			<isEqual property="strMmFrom" compareValue="03">
			<isEqual property="strMmFrom" compareValue="06">
			<isEqual property="strMmFrom" compareValue="09">
			<isEqual property="strMmFrom" compareValue="12">
			  UNION  ALL         
			 SELECT  ACC.COPT_CD, M.ACNT_CD_NM, 
			 SUM(CASE WHEN ACC.BLL_CD = '11' THEN 1 ELSE 0 END) AS COL11, 
			 SUM(CASE WHEN ACC.BLL_CD = '12' THEN 1 ELSE 0 END) AS COL12,    
			 SUM(CASE WHEN ACC.BLL_CD = '13' THEN 1 ELSE 0 END) AS COL13,    
			 SUM(CASE WHEN ACC.BLL_CD = '14' THEN 1 ELSE 0 END) AS COL14,
			 SUM(CASE WHEN ACC.BLL_CD = '15' THEN 1 ELSE 0 END) AS COL15,   
			 SUM(CASE WHEN ACC.BLL_CD = '16' THEN 1 ELSE 0 END) AS COL16, 
			 SUM(CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18') AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL17,
			 SUM(CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18') AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL18,    
			SUM(CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL19,
			 SUM(CASE WHEN ACC.BLL_CD = '20' THEN 1 ELSE 0 END) AS COL20,
			 SUM(CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL19_1,
			 SUM(CASE WHEN ACC.BLL_CD = '21' THEN 1 ELSE 0 END) AS COL21,    
			 SUM(CASE WHEN (ACC.BLL_CD = '22'  OR  ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' ) AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL22, 
			 SUM(CASE WHEN (ACC.BLL_CD = '22'  OR  ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' ) AND ACC.DL_XPN_RCDB_PBSVT_SRNO != '000' THEN 1 ELSE 0 END) AS COL23, 
			 SUM(CASE WHEN ACC.BLL_CD = '28' THEN 1 ELSE 0 END) AS COL28,
			 SUM(CASE WHEN ACC.BLL_CD = '29' THEN 1 ELSE 0 END) AS COL29,
			 SUM(CASE WHEN ACC.BLL_CD = '30' THEN 1 ELSE 0 END) AS COL30,    
			 SUM(CASE WHEN ACC.BLL_CD = '31' THEN 1 ELSE 0 END) AS COL31,
			 SUM(CASE WHEN ACC.BLL_CD = '32' THEN 1 ELSE 0 END) AS COL32,
			 SUM(CASE WHEN ACC.BLL_CD = '33' THEN 1 ELSE 0 END) AS COL33,    
			 SUM(CASE WHEN ACC.BLL_CD = '34' THEN 1 ELSE 0 END) AS COL34,
			 SUM(CASE WHEN ACC.BLL_CD = '35' THEN 1 ELSE 0 END) AS COL35,
			 SUM(CASE WHEN ACC.BLL_CD = '41' THEN 1 ELSE 0 END) AS COL41,
			 SUM(CASE WHEN ACC.BLL_CD = '42' OR ACC.BLL_CD = '43' THEN 1 ELSE 0 END) AS COL42,
			 SUM(CASE WHEN ACC.BLL_CD = '51' THEN 1 ELSE 0 END) AS COL51,
			 SUM(CASE WHEN ACC.BLL_CD = '52' THEN 1 ELSE 0 END) AS COL52,
			 SUM(CASE WHEN ACC.BLL_CD = '53' THEN 1 ELSE 0 END) AS COL53,    
			 SUM(CASE WHEN ACC.BLL_CD = '54' THEN 1 ELSE 0 END) AS COL54,
			 SUM(CASE WHEN ACC.BLL_CD = '56' THEN 1 ELSE 0 END) AS COL56,    
			 SUM(CASE WHEN ACC.BLL_CD = '57' THEN 1 ELSE 0 END) AS COL57,
			 SUM(CASE WHEN ACC.BLL_CD = '55' THEN 1 ELSE 0 END) AS COL55
			 ,SUM(CASE WHEN CONT.BLL_CD = '11' THEN 1 ELSE 0 END) AS CO11,    
			 SUM(CASE WHEN CONT.BLL_CD = '12' THEN 1 ELSE 0 END) AS CO12,
			 SUM(CASE WHEN CONT.BLL_CD = '13' THEN 1 ELSE 0 END) AS CO13,
			 SUM(CASE WHEN CONT.BLL_CD = '14' THEN 1 ELSE 0 END) AS CO14,
			 SUM(CASE WHEN CONT.BLL_CD = '15' THEN 1 ELSE 0 END) AS CO15,
			 SUM(CASE WHEN CONT.BLL_CD = '16' THEN 1 ELSE 0 END) AS CO16,
			 SUM(CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18')  AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO17,
			 SUM(CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18') AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO18,
			 SUM(CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO19,    
			 SUM(CASE WHEN CONT.BLL_CD = '20' THEN 1 ELSE 0 END) AS CO20,   
			 SUM(CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO19_1,  
			 SUM(CASE WHEN CONT.BLL_CD = '21' THEN 1 ELSE 0 END) AS CO21,  
			 SUM(CASE WHEN (CONT.BLL_CD = '22'  OR  CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' ) AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO22,  
			SUM(CASE WHEN (CONT.BLL_CD = '22'  OR  CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' ) AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO23,
			 SUM(CASE WHEN CONT.BLL_CD = '28' THEN 1 ELSE 0 END) AS CO28,
			 SUM(CASE WHEN CONT.BLL_CD = '29' THEN 1 ELSE 0 END) AS CO29,
			 SUM(CASE WHEN CONT.BLL_CD = '30' THEN 1 ELSE 0 END) AS CO30,    
			 SUM(CASE WHEN CONT.BLL_CD = '31' THEN 1 ELSE 0 END) AS CO31,    
			 SUM(CASE WHEN CONT.BLL_CD = '32' THEN 1 ELSE 0 END) AS CO32,
			 SUM(CASE WHEN CONT.BLL_CD = '33' THEN 1 ELSE 0 END) AS CO33,
			 SUM(CASE WHEN CONT.BLL_CD = '34' THEN 1 ELSE 0 END) AS CO34,    
			 SUM(CASE WHEN CONT.BLL_CD = '35' THEN 1 ELSE 0 END) AS CO35,    
			 SUM(CASE WHEN CONT.BLL_CD = '41' THEN 1 ELSE 0 END) AS CO41,    
			 SUM(CASE WHEN CONT.BLL_CD = '42' OR CONT.BLL_CD = '43' THEN 1 ELSE 0 END) AS CO42,    
			 SUM(CASE WHEN CONT.BLL_CD = '51' THEN 1 ELSE 0 END) AS CO51,    
			 SUM(CASE WHEN CONT.BLL_CD = '52' THEN 1 ELSE 0 END) AS CO52,    
			 SUM(CASE WHEN CONT.BLL_CD = '53' THEN 1 ELSE 0 END) AS CO53,    
			 SUM(CASE WHEN CONT.BLL_CD = '54' THEN 1 ELSE 0 END) AS CO54,    
			 SUM(CASE WHEN CONT.BLL_CD = '56' THEN 1 ELSE 0 END) AS CO56,    
			 SUM(CASE WHEN CONT.BLL_CD = '57' THEN 1 ELSE 0 END) AS CO57,    
			 SUM(CASE WHEN CONT.BLL_CD = '55' THEN 1 ELSE 0 END) AS CO55    
			 FROM TWFAACAV003M ACC
			 	  , TWFAACAV004L CONT
			 	  , (SELECT '일반' ACNT_CD_NM, '011' AS ACNT_CD FROM DUAL
				    UNION ALL
				    SELECT '특별' ACNT_CD_NM, '' AS ACNT_CD FROM DUAL) M   
			 WHERE ((ACC.CRE_DT <![CDATA[ <= ]]> #strYrFrom#||#strMmFrom# ) AND (ACC.ABLT_DT >= #strYrFrom#||#strMmFrom#))
			  AND ACC.ACNT_CD = M.ACNT_CD(+)
			<isEqual property="strMmFrom" compareValue="03">
			 AND ACC.BLL_CD IN('11','12','13','15','16','20','21','29','41','42','43','54','56','57')
			  AND CONT.PROF_YM = #strYrFrom# || '01'
			</isEqual>
			<isEqual property="strMmFrom" compareValue="06">
			 AND ACC.BLL_CD IN('11','12','13','15','16','20','21','29','41','42','43','54','56','57')
			  AND CONT.PROF_YM = #strYrFrom# || '02'
			</isEqual>
			<isEqual property="strMmFrom" compareValue="09">
			 AND ACC.BLL_CD IN('11','12','13','15','16','20','21','29','41','42','43','54','56','57')
			  AND CONT.PROF_YM = #strYrFrom# || '03'
			</isEqual>
			<isEqual property="strMmFrom" compareValue="12">
			 AND ACC.BLL_CD IN('11','12','13','15','16','20','21','29','41','42','43','54','56','57')
			  AND CONT.PROF_YM = #strYrFrom# || '04'
			</isEqual>
			 AND ACC.COPT_CD = CONT.COPT_CD(+)    
			 AND ACC.ACNT_CD = CONT.ACNT_CD(+) 
			 AND ACC.BLL_CD = CONT.BLL_CD(+)
			 AND ACC.PROF_DRTR_SRNO = CONT.PROF_DRTR_SRNO(+)
			 AND ACC.DL_XPN_RCDB_PBSVT_SRNO = CONT.DL_XPN_RCDB_PBSVT_SRNO(+)
			  GROUP BY M.ACNT_CD_NM, ACC.COPT_CD  
			</isEqual>
			</isEqual>
			</isEqual>
			</isEqual>
			                 UNION ALL
			    SELECT ACC.COPT_CD , M.ACNT_CD_NM,
			           SUM( CASE WHEN ACC.BLL_CD = '11' THEN 1 ELSE 0 END) AS COL11,
			           SUM( CASE WHEN ACC.BLL_CD = '12' THEN 1 ELSE 0 END) AS COL12,
			           SUM( CASE WHEN ACC.BLL_CD = '13' THEN 1 ELSE 0 END) AS COL13,
			           SUM( CASE WHEN ACC.BLL_CD = '14' THEN 1 ELSE 0 END) AS COL14,
			           SUM( CASE WHEN ACC.BLL_CD = '15' THEN 1 ELSE 0 END) AS COL15,
			           SUM( CASE WHEN ACC.BLL_CD = '16' THEN 1 ELSE 0 END) AS COL16,
			           SUM( CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18')
			               AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL17,
			           SUM( CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18')
			               AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL18,
			           SUM( CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL19,
			           SUM( CASE WHEN ACC.BLL_CD = '20' THEN 1 ELSE 0 END) AS COL20,
			           SUM( CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL19_1,
			           SUM( CASE WHEN ACC.BLL_CD = '21' THEN 1 ELSE 0 END) AS COL21,
			           SUM( CASE WHEN (ACC.BLL_CD = '22' OR ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' )
			               AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL22,
			           SUM( CASE WHEN (ACC.BLL_CD = '22' OR ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' )
			               AND ACC.DL_XPN_RCDB_PBSVT_SRNO != '000' THEN 1 ELSE 0 END) AS COL23,
			           SUM( CASE WHEN ACC.BLL_CD = '28' THEN 1 ELSE 0 END) AS COL28,
			           SUM( CASE WHEN ACC.BLL_CD = '29' THEN 1 ELSE 0 END) AS COL29,
			           SUM( CASE WHEN ACC.BLL_CD = '30' THEN 1 ELSE 0 END) AS COL30,
			           SUM( CASE WHEN ACC.BLL_CD = '31' THEN 1 ELSE 0 END) AS COL31,
			           SUM( CASE WHEN ACC.BLL_CD = '32' THEN 1 ELSE 0 END) AS COL32,
			           SUM( CASE WHEN ACC.BLL_CD = '33' THEN 1 ELSE 0 END) AS COL33,
			           SUM( CASE WHEN ACC.BLL_CD = '34' THEN 1 ELSE 0 END) AS COL34,
			           SUM( CASE WHEN ACC.BLL_CD = '35' THEN 1 ELSE 0 END) AS COL35,
			           SUM( CASE WHEN ACC.BLL_CD = '41' THEN 1 ELSE 0 END) AS COL41,
			           SUM( CASE WHEN ACC.BLL_CD = '42' OR ACC.BLL_CD = '43' THEN 1 ELSE 0 END) AS COL42,
			           SUM( CASE WHEN ACC.BLL_CD = '51' THEN 1 ELSE 0 END) AS COL51,
			           SUM( CASE WHEN ACC.BLL_CD = '52' THEN 1 ELSE 0 END) AS COL52,
			           SUM( CASE WHEN ACC.BLL_CD = '53' THEN 1 ELSE 0 END) AS COL53,
			           SUM( CASE WHEN ACC.BLL_CD = '54' THEN 1 ELSE 0 END) AS COL54,
			           SUM( CASE WHEN ACC.BLL_CD = '56' THEN 1 ELSE 0 END) AS COL56,
			           SUM( CASE WHEN ACC.BLL_CD = '57' THEN 1 ELSE 0 END) AS COL57,
			           SUM( CASE WHEN ACC.BLL_CD = '55' THEN 1 ELSE 0 END) AS COL55,
			           SUM( CASE WHEN CONT.BLL_CD = '11' THEN 1 ELSE 0 END) AS CO11,
			           SUM( CASE WHEN CONT.BLL_CD = '12' THEN 1 ELSE 0 END) AS CO12,
			           SUM( CASE WHEN CONT.BLL_CD = '13' THEN 1 ELSE 0 END) AS CO13,
			           SUM( CASE WHEN CONT.BLL_CD = '14' THEN 1 ELSE 0 END) AS CO14,
			           SUM( CASE WHEN CONT.BLL_CD = '15' THEN 1 ELSE 0 END) AS CO15,
			           SUM( CASE WHEN CONT.BLL_CD = '16' THEN 1 ELSE 0 END) AS CO16,
			           SUM( CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18')
			               AND CONT.DL_XPN_RCDB_PBSVT_SRNO = '000' THEN 1 ELSE 0 END) AS CO17,
			           SUM( CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18')
			               AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO18,
			           SUM( CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO = '000' THEN 1 ELSE 0 END) AS CO19,
			           SUM( CASE WHEN CONT.BLL_CD = '20' THEN 1 ELSE 0 END) AS CO20,
			           SUM( CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO19_1,
			           SUM( CASE WHEN CONT.BLL_CD = '21' THEN 1 ELSE 0 END) AS CO21,
			           SUM( CASE WHEN (CONT.BLL_CD = '22' OR CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' ) AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO22,
			           SUM( CASE WHEN (CONT.BLL_CD = '22' OR CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' )
			               AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO23,
			           SUM( CASE WHEN CONT.BLL_CD = '28' THEN 1 ELSE 0 END) AS CO28,
			           SUM( CASE WHEN CONT.BLL_CD = '29' THEN 1 ELSE 0 END) AS CO29,
			           SUM( CASE WHEN CONT.BLL_CD = '30' THEN 1 ELSE 0 END) AS CO30,
			           SUM( CASE WHEN CONT.BLL_CD = '31' THEN 1 ELSE 0 END) AS CO31,
			           SUM( CASE WHEN CONT.BLL_CD = '32' THEN 1 ELSE 0 END) AS CO32,
			           SUM( CASE WHEN CONT.BLL_CD = '33' THEN 1 ELSE 0 END) AS CO33,
			           SUM( CASE WHEN CONT.BLL_CD = '34' THEN 1 ELSE 0 END) AS CO34,
			           SUM( CASE WHEN CONT.BLL_CD = '35' THEN 1 ELSE 0 END) AS CO35,
			           SUM( CASE WHEN CONT.BLL_CD = '41' THEN 1 ELSE 0 END) AS CO41,
			           SUM( CASE WHEN CONT.BLL_CD = '42' OR CONT.BLL_CD = '43' THEN 1 ELSE 0 END) AS CO42,
			           SUM( CASE WHEN CONT.BLL_CD = '51' THEN 1 ELSE 0 END) AS CO51,
			           SUM( CASE WHEN CONT.BLL_CD = '52' THEN 1 ELSE 0 END) AS CO52,
			           SUM( CASE WHEN CONT.BLL_CD = '53' THEN 1 ELSE 0 END) AS CO53,
			           SUM( CASE WHEN CONT.BLL_CD = '54' THEN 1 ELSE 0 END) AS CO54,
			           SUM( CASE WHEN CONT.BLL_CD = '56' THEN 1 ELSE 0 END) AS CO56,
			           SUM( CASE WHEN CONT.BLL_CD = '57' THEN 1 ELSE 0 END) AS CO57,
			           SUM( CASE WHEN CONT.BLL_CD = '55' THEN 1 ELSE 0 END) AS CO55
			      FROM TWFAACAV003M ACC ,
			           TWFAACAV004L CONT, 
			           (SELECT '일반' ACNT_CD_NM, '011' AS ACNT_CD FROM DUAL
					    UNION ALL
					    SELECT '특별' ACNT_CD_NM, '' AS ACNT_CD FROM DUAL) M
			WHERE ((ACC.CRE_DT <![CDATA[ <= ]]> #strYrFrom#||#strMmFrom# ) AND (ACC.ABLT_DT >= #strYrFrom#||#strMmFrom#))  
			AND CONT.PROF_YM = #strYrFrom#||#strMmFrom#
			AND ACC.ACNT_CD = M.ACNT_CD(+)
			   AND ACC.BLL_CD IN('22', '23', '24')
			   AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000'
			   AND ACC.COPT_CD = CONT.COPT_CD(+)
			   AND ACC.ACNT_CD = CONT.ACNT_CD(+)
			   AND ACC.BLL_CD = CONT.BLL_CD(+)
			   AND ACC.PROF_DRTR_SRNO = CONT.PROF_DRTR_SRNO(+)
			   AND ACC.DL_XPN_RCDB_PBSVT_SRNO = CONT.DL_XPN_RCDB_PBSVT_SRNO(+)
			 GROUP BY M.ACNT_CD_NM, ACC.COPT_CD
			<isEqual property="strMmFrom" compareValue="03">
			<isEqual property="strMmFrom" compareValue="06">
			<isEqual property="strMmFrom" compareValue="09">
			<isEqual property="strMmFrom" compareValue="12">
			  UNION   ALL 
			SELECT  ACC.COPT_CD,  M.ACNT_CD_NM,
			 SUM(CASE WHEN ACC.BLL_CD = '11' THEN 1 ELSE 0 END) AS COL11,
			 SUM(CASE WHEN ACC.BLL_CD = '12' THEN 1 ELSE 0 END) AS COL12,
			 SUM(CASE WHEN ACC.BLL_CD = '13' THEN 1 ELSE 0 END) AS COL13,
			 SUM(CASE WHEN ACC.BLL_CD = '14' THEN 1 ELSE 0 END) AS COL14,
			 SUM(CASE WHEN ACC.BLL_CD = '15' THEN 1 ELSE 0 END) AS COL15,
			 SUM(CASE WHEN ACC.BLL_CD = '16' THEN 1 ELSE 0 END) AS COL16,
			 SUM(CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18') AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL17,    
			 SUM(CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18') AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL18,    
			SUM(CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL19,   
			 SUM(CASE WHEN ACC.BLL_CD = '20' THEN 1 ELSE 0 END) AS COL20,
			 SUM(CASE WHEN ACC.BLL_CD = '19' AND ACC.DL_XPN_RCDB_PBSVT_SRNO !='000' THEN 1 ELSE 0 END) AS COL19_1 ,
			 SUM(CASE WHEN ACC.BLL_CD = '21' THEN 1 ELSE 0 END) AS COL21,    
			 SUM(CASE WHEN (ACC.BLL_CD = '22'  OR  ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' ) AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL22, 
			 SUM(CASE WHEN (ACC.BLL_CD = '22'  OR  ACC.BLL_CD = '23' OR ACC.BLL_CD = '24' ) AND ACC.DL_XPN_RCDB_PBSVT_SRNO != '000' THEN 1 ELSE 0 END) AS COL23, 
			 SUM(CASE WHEN ACC.BLL_CD = '28' THEN 1 ELSE 0 END) AS COL28,    
			 SUM(CASE WHEN ACC.BLL_CD = '29' THEN 1 ELSE 0 END) AS COL29,
			 SUM(CASE WHEN ACC.BLL_CD = '30' THEN 1 ELSE 0 END) AS COL30,
			 SUM(CASE WHEN ACC.BLL_CD = '31' THEN 1 ELSE 0 END) AS COL31,    
			 SUM(CASE WHEN ACC.BLL_CD = '32' THEN 1 ELSE 0 END) AS COL32,    
			 SUM(CASE WHEN ACC.BLL_CD = '33' THEN 1 ELSE 0 END) AS COL33,    
			 SUM(CASE WHEN ACC.BLL_CD = '34' THEN 1 ELSE 0 END) AS COL34,    
			 SUM(CASE WHEN ACC.BLL_CD = '35' THEN 1 ELSE 0 END) AS COL35,    
			 SUM(CASE WHEN ACC.BLL_CD = '41' THEN 1 ELSE 0 END) AS COL41,    
			 SUM(CASE WHEN ACC.BLL_CD = '42' OR ACC.BLL_CD = '43' THEN 1 ELSE 0 END) AS COL42,    
			 SUM(CASE WHEN ACC.BLL_CD = '51' THEN 1 ELSE 0 END) AS COL51,    
			 SUM(CASE WHEN ACC.BLL_CD = '52' THEN 1 ELSE 0 END) AS COL52,    
			 SUM(CASE WHEN ACC.BLL_CD = '53' THEN 1 ELSE 0 END) AS COL53,    
			 SUM(CASE WHEN ACC.BLL_CD = '54' THEN 1 ELSE 0 END) AS COL54,    
			 SUM(CASE WHEN ACC.BLL_CD = '56' THEN 1 ELSE 0 END) AS COL56,    
			 SUM(CASE WHEN ACC.BLL_CD = '57' THEN 1 ELSE 0 END) AS COL57,    
			 SUM(CASE WHEN ACC.BLL_CD = '55' THEN 1 ELSE 0 END) AS COL55    
			 ,SUM(CASE WHEN CONT.BLL_CD = '11' THEN 1 ELSE 0 END) AS CO11,    
			 SUM(CASE WHEN CONT.BLL_CD = '12' THEN 1 ELSE 0 END) AS CO12,    
			 SUM(CASE WHEN CONT.BLL_CD = '13' THEN 1 ELSE 0 END) AS CO13,    
			 SUM(CASE WHEN CONT.BLL_CD = '14' THEN 1 ELSE 0 END) AS CO14,    
			 SUM(CASE WHEN CONT.BLL_CD = '15' THEN 1 ELSE 0 END) AS CO15,    
			 SUM(CASE WHEN CONT.BLL_CD = '16' THEN 1 ELSE 0 END) AS CO16,    
			 SUM(CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18')  AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO17,    
			 SUM(CASE WHEN (CONT.BLL_CD = '17' OR CONT.BLL_CD = '18') AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO18,    
			 SUM(CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO19,    
			 SUM(CASE WHEN CONT.BLL_CD = '20' THEN 1 ELSE 0 END) AS CO20,   
			 SUM(CASE WHEN CONT.BLL_CD = '19' AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO19_1,  
			 SUM(CASE WHEN CONT.BLL_CD = '21' THEN 1 ELSE 0 END) AS CO21,  
			 SUM(CASE WHEN (CONT.BLL_CD = '22'  OR  CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' ) AND CONT.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS CO22,  
			SUM(CASE WHEN (CONT.BLL_CD = '22'  OR  CONT.BLL_CD = '23' OR CONT.BLL_CD = '24' ) AND CONT.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS CO23,
			 SUM(CASE WHEN CONT.BLL_CD = '28' THEN 1 ELSE 0 END) AS CO28,    
			 SUM(CASE WHEN CONT.BLL_CD = '29' THEN 1 ELSE 0 END) AS CO29,    
			 SUM(CASE WHEN CONT.BLL_CD = '30' THEN 1 ELSE 0 END) AS CO30,    
			 SUM(CASE WHEN CONT.BLL_CD = '31' THEN 1 ELSE 0 END) AS CO31,    
			 SUM(CASE WHEN CONT.BLL_CD = '32' THEN 1 ELSE 0 END) AS CO32,    
			 SUM(CASE WHEN CONT.BLL_CD = '33' THEN 1 ELSE 0 END) AS CO33,    
			 SUM(CASE WHEN CONT.BLL_CD = '34' THEN 1 ELSE 0 END) AS CO34,    
			 SUM(CASE WHEN CONT.BLL_CD = '35' THEN 1 ELSE 0 END) AS CO35,    
			 SUM(CASE WHEN CONT.BLL_CD = '41' THEN 1 ELSE 0 END) AS CO41,    
			 SUM(CASE WHEN CONT.BLL_CD = '42' OR CONT.BLL_CD = '43' THEN 1 ELSE 0 END) AS CO42,    
			 SUM(CASE WHEN CONT.BLL_CD = '51' THEN 1 ELSE 0 END) AS CO51,    
			 SUM(CASE WHEN CONT.BLL_CD = '52' THEN 1 ELSE 0 END) AS CO52,    
			 SUM(CASE WHEN CONT.BLL_CD = '53' THEN 1 ELSE 0 END) AS CO53,    
			 SUM(CASE WHEN CONT.BLL_CD = '54' THEN 1 ELSE 0 END) AS CO54,    
			 SUM(CASE WHEN CONT.BLL_CD = '56' THEN 1 ELSE 0 END) AS CO56,    
			 SUM(CASE WHEN CONT.BLL_CD = '57' THEN 1 ELSE 0 END) AS CO57,    
			 SUM(CASE WHEN CONT.BLL_CD = '55' THEN 1 ELSE 0 END) AS CO55    
			 FROM TWFAACAV003M ACC,
			 		TWFAACAV004L CONT,
					 (SELECT '일반' ACNT_CD_NM, '011' AS ACNT_CD FROM DUAL
					    UNION ALL
					    SELECT '특별' ACNT_CD_NM, '' AS ACNT_CD FROM DUAL) M   
			 WHERE ((ACC.CRE_DT <![CDATA[ <= ]]> #strYrFrom#||#strMmFrom#) AND (ACC.ABLT_DT >= #strYrFrom#||#strMmFrom#))
			  AND ACC.ACNT_CD = M.ACNT_CD(+)
			<isEqual property="strMmFrom" compareValue="03">
			 AND ACC.BLL_CD IN ('22','23','24')  AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000'
			  AND CONT.PROF_YM = #strYrFrom# || '01'
			</isEqual>
			<isEqual property="strMmFrom" compareValue="06">
			 AND ACC.BLL_CD IN('22','23','24')  AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000'
			  AND CONT.PROF_YM = #strYrFrom# || '02'
			</isEqual>
			<isEqual property="strMmFrom" compareValue="09">
			 AND ACC.BLL_CD IN('22','23','24')  AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000'
			  AND CONT.PROF_YM = #strYrFrom# || '03'
			</isEqual>
			<isEqual property="strMmFrom" compareValue="12">
			 AND ACC.BLL_CD IN('22','23','24')  AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000'
			  AND CONT.PROF_YM = #strYrFrom# || '04'
			</isEqual>
			 AND ACC.COPT_CD = CONT.COPT_CD(+)
			 AND ACC.ACNT_CD = CONT.ACNT_CD(+) 
			 AND ACC.BLL_CD = CONT.BLL_CD(+)
			 AND ACC.PROF_DRTR_SRNO = CONT.PROF_DRTR_SRNO(+)
			 AND ACC.DL_XPN_RCDB_PBSVT_SRNO = CONT.DL_XPN_RCDB_PBSVT_SRNO(+)
			  GROUP BY  M.ACNT_CD_NM, ACC.COPT_CD  
			</isEqual>
			</isEqual>
			</isEqual>
			</isEqual>
			                       )A
			         GROUP BY A.ACNT_CD_NM, A.COPT_CD )B ,
			       (SELECT ACNT_CD,
			               ACNT_CD_NM
			          FROM TWFAACAV024C
			         WHERE ACNT_DVSN_CD='02' ) C
			 WHERE B.ACNT_CD = C.ACNT_CD(+)
		 )
		 
		 SELECT 
		    CASE GUBUN WHEN '일반' THEN '111'
		    ELSE '222' END || ACNT_CD AS ACNT_CD 
		    , ACNT_CD_NM
		    , GUBUN
		    , COL11
		    , COL12
		    , COL13
		    , COL14
		    , COL15
		    , COL16
		    , COL17
		    , COL18
		    , COL19
		    , COL20
		    , COL19_1
		    , COL21
		    , COL22
		    , COL23
		    , COL28
		    , COL29
		    , COL30
		    , COL31
		    , COL32
		    , COL33
		    , COL34
		    , COL35
		    , COL41
		    , COL42
		    , COL51
		    , COL52
		    , COL53
		    , COL54
		    , COL56
		    , COL57
		    , COL55
		    , CO11
		    , CO12
		    , CO13
		    , CO14
		    , CO15
		    , CO16
		    , CO17
		    , CO18
		    , CO19
		    , CO20
		    , CO19_1
		    , CO21
		    , CO22
		    , CO23
		    , CO28
		    , CO29
		    , CO30
		    , CO31
		    , CO32
		    , CO33
		    , CO34
		    , CO35
		    , CO41
		    , CO42
		    , CO51
		    , CO52
		    , CO53
		    , CO54
		    , CO56
		    , CO57
		    , CO55
		    , TOTAL
		    , TOTAL1
		 FROM DETAIL_SQL
		 UNION ALL
		 SELECT
		    CASE WHEN GUBUN = '일반' THEN '111'
		    ELSE '222' END || '998' AS ACNT_CD
		    , '회계별'||'합계' AS ACNT_CD_NM
		    , GUBUN
		    , SUM(COL11)
		    , SUM(COL12)
		    , SUM(COL13)
		    , SUM(COL14)
		    , SUM(COL15)
		    , SUM(COL16)
		    , SUM(COL17)
		    , SUM(COL18)
		    , SUM(COL19)
		    , SUM(COL20)
		    , SUM(COL19_1)
		    , SUM(COL21)
		    , SUM(COL22)
		    , SUM(COL23)
		    , SUM(COL28)
		    , SUM(COL29)
		    , SUM(COL30)
		    , SUM(COL31)
		    , SUM(COL32)
		    , SUM(COL33)
		    , SUM(COL34)
		    , SUM(COL35)
		    , SUM(COL41)
		    , SUM(COL42)
		    , SUM(COL51)
		    , SUM(COL52)
		    , SUM(COL53)
		    , SUM(COL54)
		    , SUM(COL56)
		    , SUM(COL57)
		    , SUM(COL55)
		    , SUM(CO11)
		    , SUM(CO12)
		    , SUM(CO13)
		    , SUM(CO14)
		    , SUM(CO15)
		    , SUM(CO16)
		    , SUM(CO17)
		    , SUM(CO18)
		    , SUM(CO19)
		    , SUM(CO20)
		    , SUM(CO19_1)
		    , SUM(CO21)
		    , SUM(CO22)
		    , SUM(CO23)
		    , SUM(CO28)
		    , SUM(CO29)
		    , SUM(CO30)
		    , SUM(CO31)
		    , SUM(CO32)
		    , SUM(CO33)
		    , SUM(CO34)
		    , SUM(CO35)
		    , SUM(CO41)
		    , SUM(CO42)
		    , SUM(CO51)
		    , SUM(CO52)
		    , SUM(CO53)
		    , SUM(CO54)
		    , SUM(CO56)
		    , SUM(CO57)
		    , SUM(CO55)
		    , SUM(TOTAL)
		    , SUM(TOTAL1)
		 FROM DETAIL_SQL
		 GROUP BY GUBUN
		 UNION ALL
		 SELECT
		    '999' || '000' AS ACNT_CD
		    , '총 합 계' AS ACNT_CD_NM
		    , '특별'
		    , SUM(COL11)
		    , SUM(COL12)
		    , SUM(COL13)
		    , SUM(COL14)
		    , SUM(COL15)
		    , SUM(COL16)
		    , SUM(COL17)
		    , SUM(COL18)
		    , SUM(COL19)
		    , SUM(COL20)
		    , SUM(COL19_1)
		    , SUM(COL21)
		    , SUM(COL22)
		    , SUM(COL23)
		    , SUM(COL28)
		    , SUM(COL29)
		    , SUM(COL30)
		    , SUM(COL31)
		    , SUM(COL32)
		    , SUM(COL33)
		    , SUM(COL34)
		    , SUM(COL35)
		    , SUM(COL41)
		    , SUM(COL42)
		    , SUM(COL51)
		    , SUM(COL52)
		    , SUM(COL53)
		    , SUM(COL54)
		    , SUM(COL56)
		    , SUM(COL57)
		    , SUM(COL55)
		    , SUM(CO11)
		    , SUM(CO12)
		    , SUM(CO13)
		    , SUM(CO14)
		    , SUM(CO15)
		    , SUM(CO16)
		    , SUM(CO17)
		    , SUM(CO18)
		    , SUM(CO19)
		    , SUM(CO20)
		    , SUM(CO19_1)
		    , SUM(CO21)
		    , SUM(CO22)
		    , SUM(CO23)
		    , SUM(CO28)
		    , SUM(CO29)
		    , SUM(CO30)
		    , SUM(CO31)
		    , SUM(CO32)
		    , SUM(CO33)
		    , SUM(CO34)
		    , SUM(CO35)
		    , SUM(CO41)
		    , SUM(CO42)
		    , SUM(CO51)
		    , SUM(CO52)
		    , SUM(CO53)
		    , SUM(CO54)
		    , SUM(CO56)
		    , SUM(CO57)
		    , SUM(CO55)
		    , SUM(TOTAL)
		    , SUM(TOTAL1)
		 FROM DETAIL_SQL A
		 ORDER BY ACNT_CD
	</select>
	
	<select id="FAACAV032ERSelect_2" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/032/FAACAV032ERSelect_2 */ ]]>
	WITH DETAIL_SQL AS (
		SELECT A.*,
			A.COL11+A.COL12+A.COL13+A.COL14+A.COL15+A.COL16+A.COL17+A.COL18+A.COL19+A.COL20+A.COL21+A.COL22+A.COL24+A.COL28+A.COL29+A.COL30+A.COL31+A.COL32+A.COL33+A.COL34+A.COL35+A.COL41+A.COL42+A.COL51+A.COL52+A.COL53+A.COL54+A.COL55+A.COL56+A.COL57 TOTAL
		 FROM (
		    SELECT LPAD(ACC.BR_CD,3,'0')||LPAD(ACC.DIV_CD,3,'0')||DECODE(M.ACNT_CD,'일반','011','111') AS GUBUN, ACC.BR_CD, ACC.DIV_CD, M.ACNT_CD, CD.ACNT_CD_NM AS SOCK_NM,    
		    SUM(CASE WHEN ACC.BLL_CD = '11' THEN 1 ELSE 0 END) AS COL11,
		    SUM(CASE WHEN ACC.BLL_CD = '12' THEN 1 ELSE 0 END) AS COL12,
		    SUM(CASE WHEN ACC.BLL_CD = '13' THEN 1 ELSE 0 END) AS COL13,
		    SUM(CASE WHEN ACC.BLL_CD = '14' THEN 1 ELSE 0 END) AS COL14,
		    SUM(CASE WHEN ACC.BLL_CD = '15' THEN 1 ELSE 0 END) AS COL15,
		    SUM(CASE WHEN ACC.BLL_CD = '16' THEN 1 ELSE 0 END) AS COL16,
		    SUM(CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18') AND ACC.DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL17,
		    SUM(CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18') AND ACC.DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS COL18,
		    SUM(CASE WHEN ACC.BLL_CD = '19' THEN 1 ELSE 0 END) AS COL19,
		    SUM(CASE WHEN ACC.BLL_CD = '20' THEN 1 ELSE 0 END) AS COL20,
		    SUM(CASE WHEN ACC.BLL_CD = '21' THEN 1 ELSE 0 END) AS COL21,
		    SUM(CASE WHEN ACC.BLL_CD = '22' OR ACC.BLL_CD = '23' THEN 1 ELSE 0 END) AS COL22,
		    SUM(CASE WHEN ACC.BLL_CD = '24' THEN 1 ELSE 0 END) AS COL24,
		    SUM(CASE WHEN ACC.BLL_CD = '28' THEN 1 ELSE 0 END) AS COL28,
		    SUM(CASE WHEN ACC.BLL_CD = '29' THEN 1 ELSE 0 END) AS COL29,
		    SUM(CASE WHEN ACC.BLL_CD = '30' THEN 1 ELSE 0 END) AS COL30,
		    SUM(CASE WHEN ACC.BLL_CD = '31' THEN 1 ELSE 0 END) AS COL31,
		    SUM(CASE WHEN ACC.BLL_CD = '32' THEN 1 ELSE 0 END) AS COL32,
		    SUM(CASE WHEN ACC.BLL_CD = '33' THEN 1 ELSE 0 END) AS COL33,
		    SUM(CASE WHEN ACC.BLL_CD = '34' THEN 1 ELSE 0 END) AS COL34,
		    SUM(CASE WHEN ACC.BLL_CD = '35' THEN 1 ELSE 0 END) AS COL35,
		    SUM(CASE WHEN ACC.BLL_CD = '41' THEN 1 ELSE 0 END) AS COL41,
		    SUM(CASE WHEN ACC.BLL_CD = '42' OR ACC.BLL_CD = '43' THEN 1 ELSE 0 END) AS COL42,
		    SUM(CASE WHEN ACC.BLL_CD = '51' THEN 1 ELSE 0 END) AS COL51,
		    SUM(CASE WHEN ACC.BLL_CD = '52' THEN 1 ELSE 0 END) AS COL52,
		    SUM(CASE WHEN ACC.BLL_CD = '53' THEN 1 ELSE 0 END) AS COL53,
		    SUM(CASE WHEN ACC.BLL_CD = '54' THEN 1 ELSE 0 END) AS COL54,
		    SUM(CASE WHEN ACC.BLL_CD = '55' THEN 1 ELSE 0 END) AS COL55,
		    SUM(CASE WHEN ACC.BLL_CD = '56' THEN 1 ELSE 0 END) AS COL56,
		    SUM(CASE WHEN ACC.BLL_CD = '57' THEN 1 ELSE 0 END) AS COL57
		    FROM TWFAACAV003M ACC
		         , TWFAACAV024C CD 
		         , (SELECT DISTINCT BR_CD AS BR_CD
		                    , DIV_CD AS DIV_CD
		                    , (CASE WHEN 
		                        ACNT_CD = '011' THEN '일반'
		                       ELSE '특별' 
		                       END) AS ACNT_CD
		                FROM TWFAACAV003M
		                WHERE ((CRE_DT BETWEEN #strYrFrom#||#strMmFrom# AND #strYrTo#||#strMmTo#) 
		                      OR(ABLT_DT BETWEEN #strYrFrom#||#strMmFrom# AND #strYrTo#||#strMmTo#) 
		                      OR(CRE_DT <![CDATA[ < ]]> #strYrFrom#||#strMmFrom#  AND ABLT_DT > #strYrTo#||#strMmTo#))) M
		    WHERE ACC.BR_CD= M.BR_CD
		    AND ACC.DIV_CD= M.DIV_CD
		    AND ((ACC.CRE_DT BETWEEN #strYrFrom#||#strMmFrom# AND #strYrTo#||#strMmTo#)
		     OR (ACC.ABLT_DT BETWEEN #strYrFrom#||#strMmFrom# AND #strYrTo#||#strMmTo#) 
		     OR (ACC.CRE_DT <![CDATA[ < ]]> #strYrFrom#||#strMmFrom#  AND ACC.ABLT_DT > #strYrTo#||#strMmTo#))
		    AND (CASE WHEN ACC.ACNT_CD = '011' THEN '일반' 
		                   ELSE '특별'
		            END) = M.ACNT_CD
		    AND ACC.COPT_CD = CD.ACNT_CD
		    AND CD.ACNT_DVSN_CD='02'
		    GROUP BY ACC.BR_CD, ACC.DIV_CD, M.ACNT_CD, CD.ACNT_CD_NM
		) A
	)	
	
	SELECT
	    GUBUN
	    , BR_CD
	    , DIV_CD
	    , ACNT_CD
	    , '111' AS SUM_ID
	    , SOCK_NM
	    , COL11
	    , COL12
	    , COL13
	    , COL14
	    , COL15
	    , COL16
	    , COL17
	    , COL18
	    , COL19
	    , COL20
	    , COL21
	    , COL22
	    , COL24
	    , COL28
	    , COL29
	    , COL30
	    , COL31
	    , COL32
	    , COL33
	    , COL34
	    , COL35
	    , COL41
	    , COL42
	    , COL51
	    , COL52
	    , COL53
	    , COL54
	    , COL55
	    , COL56
	    , COL57
	    , TOTAL
	  FROM DETAIL_SQL
	UNION ALL
	SELECT
	    GUBUN AS GUBUN
	    , BR_CD
	    , DIV_CD
	    , ACNT_CD
	    , '222' AS SUM_ID
	    , '관계 합계' AS SOCK_NM
	    , SUM(COL11)
	    , SUM(COL12)
	    , SUM(COL13)
	    , SUM(COL14)
	    , SUM(COL15)
	    , SUM(COL16)
	    , SUM(COL17)
	    , SUM(COL18)
	    , SUM(COL19)
	    , SUM(COL20)
	    , SUM(COL21)
	    , SUM(COL22)
	    , SUM(COL24)
	    , SUM(COL28)
	    , SUM(COL29)
	    , SUM(COL30)
	    , SUM(COL31)
	    , SUM(COL32)
	    , SUM(COL33)
	    , SUM(COL34)
	    , SUM(COL35)
	    , SUM(COL41)
	    , SUM(COL42)
	    , SUM(COL51)
	    , SUM(COL52)
	    , SUM(COL53)
	    , SUM(COL54)
	    , SUM(COL55)
	    , SUM(COL56)
	    , SUM(COL57)
	    , SUM(TOTAL)
	  FROM DETAIL_SQL
	  GROUP BY GUBUN, BR_CD, DIV_CD, ACNT_CD
	UNION ALL
	SELECT
	    '999999999' AS GUBUN
	    , '' AS BR_CD
	    , '' AS DIV_CD
	    , ACNT_CD AS ACNT_CD
	    , DECODE(ACNT_CD,'일반','333','444') AS SUM_ID
	    , DECODE(ACNT_CD,'일반','일반회계합계','특별회계합계') AS SOCK_NM
	    , SUM(COL11)
	    , SUM(COL12)
	    , SUM(COL13)
	    , SUM(COL14)
	    , SUM(COL15)
	    , SUM(COL16)
	    , SUM(COL17)
	    , SUM(COL18)
	    , SUM(COL19)
	    , SUM(COL20)
	    , SUM(COL21)
	    , SUM(COL22)
	    , SUM(COL24)
	    , SUM(COL28)
	    , SUM(COL29)
	    , SUM(COL30)
	    , SUM(COL31)
	    , SUM(COL32)
	    , SUM(COL33)
	    , SUM(COL34)
	    , SUM(COL35)
	    , SUM(COL41)
	    , SUM(COL42)
	    , SUM(COL51)
	    , SUM(COL52)
	    , SUM(COL53)
	    , SUM(COL54)
	    , SUM(COL55)
	    , SUM(COL56)
	    , SUM(COL57)
	    , SUM(TOTAL)
	  FROM DETAIL_SQL
	  GROUP BY ACNT_CD
	  UNION ALL
	  SELECT
	   '999999999' AS GUBUN
	    , '' AS BR_CD
	    , '' AS DIV_CD
	    , '' AS ACNT_CD
	    , '555' AS SUM_ID
	    , '총합계' AS SOCK_NM
	    , SUM(COL11)
	    , SUM(COL12)
	    , SUM(COL13)
	    , SUM(COL14)
	    , SUM(COL15)
	    , SUM(COL16)
	    , SUM(COL17)
	    , SUM(COL18)
	    , SUM(COL19)
	    , SUM(COL20)
	    , SUM(COL21)
	    , SUM(COL22)
	    , SUM(COL24)
	    , SUM(COL28)
	    , SUM(COL29)
	    , SUM(COL30)
	    , SUM(COL31)
	    , SUM(COL32)
	    , SUM(COL33)
	    , SUM(COL34)
	    , SUM(COL35)
	    , SUM(COL41)
	    , SUM(COL42)
	    , SUM(COL51)
	    , SUM(COL52)
	    , SUM(COL53)
	    , SUM(COL54)
	    , SUM(COL55)
	    , SUM(COL56)
	    , SUM(COL57)
	    , SUM(TOTAL)
	  FROM DETAIL_SQL
	  ORDER BY GUBUN, SUM_ID, SOCK_NM
	</select>
	
	<select id="FAACAV032ERSelect_3" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[  /* faa/cav/032/FAACAV032ERSelect_3 */ ]]>
		WITH DETAIL_SQL AS (
			SELECT A.*,
				A.COL11+A.COL12+A.COL13+A.COL14+A.COL15+A.COL16+A.COL17+A.COL18+A.COL19+A.COL19_1+A.COL20+A.COL21+A.COL22+A.COL24+A.COL28+A.COL29+A.COL30+A.COL31+A.COL32+A.COL33+A.COL34+A.COL35+A.COL41+A.COL42+A.COL51+A.COL52+A.COL53+A.COL54+A.COL55+A.COL56+A.COL57 TOTAL
			 FROM (
			SELECT DECODE(M.ACNT_CD, '일반', '111', '222') AS GUBUN,
			CD.ACNT_CD_NM ACNT_CD_NM, 
			CD.ACNT_CD ACNT_CD,
			SUM(CASE WHEN ACC.BLL_CD = '11' THEN 1 ELSE 0 END) AS COL11,
			SUM(CASE WHEN ACC.BLL_CD = '12' THEN 1 ELSE 0 END) AS COL12,
			SUM(CASE WHEN ACC.BLL_CD = '13' THEN 1 ELSE 0 END) AS COL13,
			SUM(CASE WHEN ACC.BLL_CD = '14' THEN 1 ELSE 0 END) AS COL14,
			SUM(CASE WHEN ACC.BLL_CD = '15' THEN 1 ELSE 0 END) AS COL15,
			SUM(CASE WHEN ACC.BLL_CD = '16' THEN 1 ELSE 0 END) AS COL16,
			SUM(CASE WHEN (ACC.BLL_CD = '17' OR ACC.BLL_CD = '18') AND DL_XPN_RCDB_PBSVT_SRNO ='000' THEN 1 ELSE 0 END) AS COL17,
			SUM(CASE WHEN (ACC.BLL_CD = '17' OR  ACC.BLL_CD = '18')  AND DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000' THEN 1 ELSE 0 END) AS COL18,
			SUM(CASE WHEN ACC.BLL_CD = '19'  AND DL_XPN_RCDB_PBSVT_SRNO = '000' THEN 1 ELSE 0 END) AS COL19,
			SUM(CASE WHEN ACC.BLL_CD = '19'  AND DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000'  THEN 1 ELSE 0 END) AS COL19_1,
			SUM(CASE WHEN ACC.BLL_CD = '20' THEN 1 ELSE 0 END) AS COL20,
			SUM(CASE WHEN ACC.BLL_CD = '21' THEN 1 ELSE 0 END) AS COL21,
			SUM(CASE WHEN (ACC.BLL_CD = '22' OR ACC.BLL_CD = '23' OR ACC.BLL_CD = '24') AND  DL_XPN_RCDB_PBSVT_SRNO = '000'  THEN 1 ELSE 0 END) AS COL22,
			SUM(CASE WHEN (ACC.BLL_CD = '22' OR ACC.BLL_CD = '23' OR ACC.BLL_CD = '24')  AND DL_XPN_RCDB_PBSVT_SRNO <![CDATA[ <> ]]> '000'  THEN 1 ELSE 0 END) AS COL24,
			SUM(CASE WHEN ACC.BLL_CD = '28' THEN 1 ELSE 0 END) AS COL28,
			SUM(CASE WHEN ACC.BLL_CD = '29' THEN 1 ELSE 0 END) AS COL29,
			SUM(CASE WHEN ACC.BLL_CD = '30' THEN 1 ELSE 0 END) AS COL30,
			SUM(CASE WHEN ACC.BLL_CD = '31' THEN 1 ELSE 0 END) AS COL31,
			SUM(CASE WHEN ACC.BLL_CD = '32' THEN 1 ELSE 0 END) AS COL32,
			SUM(CASE WHEN ACC.BLL_CD = '33' THEN 1 ELSE 0 END) AS COL33,
			SUM(CASE WHEN ACC.BLL_CD = '34' THEN 1 ELSE 0 END) AS COL34,
			SUM(CASE WHEN ACC.BLL_CD = '35' THEN 1 ELSE 0 END) AS COL35,
			SUM(CASE WHEN ACC.BLL_CD = '41' THEN 1 ELSE 0 END) AS COL41,
			SUM(CASE WHEN ACC.BLL_CD = '42' OR ACC.BLL_CD = '43' THEN 1 ELSE 0 END) AS COL42,
			SUM(CASE WHEN ACC.BLL_CD = '51' THEN 1 ELSE 0 END) AS COL51,
			SUM(CASE WHEN ACC.BLL_CD = '52' THEN 1 ELSE 0 END) AS COL52,
			SUM(CASE WHEN ACC.BLL_CD = '53' THEN 1 ELSE 0 END) AS COL53,
			SUM(CASE WHEN ACC.BLL_CD = '54' THEN 1 ELSE 0 END) AS COL54,
			SUM(CASE WHEN ACC.BLL_CD = '55' THEN 1 ELSE 0 END) AS COL55,
			SUM(CASE WHEN ACC.BLL_CD = '56' THEN 1 ELSE 0 END) AS COL56,
			SUM(CASE WHEN ACC.BLL_CD = '57' THEN 1 ELSE 0 END) AS COL57
			FROM TWFAACAV003M ACC, TWFAACAV024C CD, (SELECT '일반' AS ACNT_CD FROM DUAL UNION ALL SELECT '특별' AS ACNT_CD FROM  DUAL) M
			WHERE  ((CRE_DT BETWEEN #strYrFrom#||#strMmFrom# AND #strYrTo#||#strMmTo#) 
			      OR(ABLT_DT BETWEEN #strYrFrom#||#strMmFrom# AND #strYrTo#||#strMmTo#) 
			      OR(CRE_DT <![CDATA[ < ]]> #strYrFrom#||#strMmFrom# AND ABLT_DT > #strYrTo#||#strMmTo#))
			AND (CASE WHEN ACC.ACNT_CD = '011' THEN '일반' 
			               ELSE '특별'
			        END) = M.ACNT_CD
			AND ACC.COPT_CD = CD.ACNT_CD
			AND CD.ACNT_DVSN_CD='02'
			GROUP BY M.ACNT_CD, CD.ACNT_CD_NM, CD.ACNT_CD
			) A
			ORDER BY GUBUN, ACNT_CD
		)
		
		SELECT
		    GUBUN AS GUBUN
		    , '111' AS SUM_ID
		    , ACNT_CD_NM
		    , ACNT_CD
		    , COL11
		    , COL12
		    , COL13
		    , COL14
		    , COL15
		    , COL16
		    , COL17
		    , COL18
		    , COL19
		    , COL19_1
		    , COL20
		    , COL21
		    , COL22
		    , COL24
		    , COL28
		    , COL29
		    , COL30
		    , COL31
		    , COL32
		    , COL33
		    , COL34
		    , COL35
		    , COL41
		    , COL42
		    , COL51
		    , COL52
		    , COL53
		    , COL54
		    , COL55
		    , COL56
		    , COL57
		    , TOTAL
		FROM DETAIL_SQL
		UNION ALL
		SELECT
		    GUBUN AS GUBUN
		    , '222' AS SUM_ID
		    , DECODE(GUBUN,'111','일반','특별') || '회계합계'
		    , ''
		    , SUM(COL11)
		    , SUM(COL12)
		    , SUM(COL13)
		    , SUM(COL14)
		    , SUM(COL15)
		    , SUM(COL16)
		    , SUM(COL17)
		    , SUM(COL18)
		    , SUM(COL19)
		    , SUM(COL19_1)
		    , SUM(COL20)
		    , SUM(COL21)
		    , SUM(COL22)
		    , SUM(COL24)
		    , SUM(COL28)
		    , SUM(COL29)
		    , SUM(COL30)
		    , SUM(COL31)
		    , SUM(COL32)
		    , SUM(COL33)
		    , SUM(COL34)
		    , SUM(COL35)
		    , SUM(COL41)
		    , SUM(COL42)
		    , SUM(COL51)
		    , SUM(COL52)
		    , SUM(COL53)
		    , SUM(COL54)
		    , SUM(COL55)
		    , SUM(COL56)
		    , SUM(COL57)
		    , SUM(TOTAL)
		FROM DETAIL_SQL
		GROUP BY GUBUN
		UNION ALL
		SELECT
		    MAX(GUBUN) AS GUBUN
		    , '222' AS SUM_ID
		    , '총합계'
		    , ''
		    , SUM(COL11)
		    , SUM(COL12)
		    , SUM(COL13)
		    , SUM(COL14)
		    , SUM(COL15)
		    , SUM(COL16)
		    , SUM(COL17)
		    , SUM(COL18)
		    , SUM(COL19)
		    , SUM(COL19_1)
		    , SUM(COL20)
		    , SUM(COL21)
		    , SUM(COL22)
		    , SUM(COL24)
		    , SUM(COL28)
		    , SUM(COL29)
		    , SUM(COL30)
		    , SUM(COL31)
		    , SUM(COL32)
		    , SUM(COL33)
		    , SUM(COL34)
		    , SUM(COL35)
		    , SUM(COL41)
		    , SUM(COL42)
		    , SUM(COL51)
		    , SUM(COL52)
		    , SUM(COL53)
		    , SUM(COL54)
		    , SUM(COL55)
		    , SUM(COL56)
		    , SUM(COL57)
		    , SUM(TOTAL)
		FROM DETAIL_SQL
		ORDER BY GUBUN, ACNT_CD
	</select>
</sqlMap> 
