<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/rga/001">

	<select id="CSPRGA001QMainSelect" parameterClass="paramMap"	resultClass="resultMap">
    	<include refid="include.pageSelct" />
		<![CDATA[       
                  SELECT T1.PBC_YR                            AS PBC_YR      /* 발간년도 */
                        ,T1.PBC_NO                            AS PBC_NO      /* 발간번호 */
                        ,T1.PBC_YR || '-' || T1.PBC_NO        AS PBC_YR_NO   /* 발간연번호 */
                        ,T1.PBC_KND_CD                        AS PBC_KND_CD  /* 발간종류코드 */
                        ,F_CODE_NM('1000903', T1.PBC_KND_CD)  AS PBC_KND_NM  /* 발간종류명 */
                        ,T1.PBC_TIT_TXT                       AS PBC_TIT_TXT /* 발간제목내용 */
                        ,T1.ACP_DT                            AS ACP_DT      /* 접수일 */
                        ,T1.PBC_DT                            AS PBC_DT      /* 발간일 */
                        ,(SELECT COUNT(1)
                            FROM TBCSPRGA002L
                           WHERE PBC_YR = T1.PBC_YR
                             AND PBC_NO = T1.PBC_NO)          AS PBC_RQR_CNT /* 발간요구건수  */
                        ,T1.RQR_DPT_CD                        AS RQR_DPT_CD  /* 요청부서코드  */
                        ,F_DPT_INFO(T1.RQR_DPT_CD, '1')       AS RQR_DPT_NM  /* 요청부서명  */
                        ,T1.RQR_CNB                           AS RQR_CNB     /* 요청전산번호  */
                        ,F_USR_INFO(T1.RQR_CNB, '2')          AS RQR_NM      /* 요청자명 */
                        ,T1.HNDL_STA_CD                       AS HNDL_STA_CD /* 처리상태코드 */
                        ,F_CODE_NM('1000907', T1.HNDL_STA_CD) AS HNDL_STA_NM /* 처리상태명 */
                        ,T1.APV_STA_CD                        AS APV_STA_CD  /* 결재상태코드 */
                        ,F_CODE_NM('1000333', T1.APV_STA_CD)  AS APV_STA_NM  /* 결재상태명 */
                        ,T1.APV_DOC_NO                        AS APV_DOC_NO  /* 결재문서번호 */
                        ,T1.DOC_ID                            AS DOC_ID      /* 문서ID */                        
                    FROM TBCSPRGA001M T1
                   WHERE 1=1
                     AND T1.ACP_DT BETWEEN #strAcpDtStr# AND #strAcpDtEnd#
		]]>
		
		<!-- 요청자 -->
		<isNotEmpty property="strRqrCnb">		           
		             AND T1.RQR_CNB = #strRqrCnb#
		</isNotEmpty>
		
		<!-- 발간종류 -->
		<isNotEmpty property="strPbcKndCd">	
		             AND T1.PBC_KND_CD = #strPbcKndCd# 
		</isNotEmpty>		
		
		<!-- 제목(요청) -->
		<isNotEmpty property="strPbcTitTxt">		
		             AND T1.PBC_TIT_TXT LIKE '%' || #strPbcTitTxt# || '%'  
		</isNotEmpty>
		
    	<include refid="include.pageOrder" />
	</select>
	
	<select id="CSPRGA001QChrTskSelect" parameterClass="paramMap"	resultClass="resultMap">
		<![CDATA[       
                 SELECT T1.SRNO             AS SRNO         /* 일련번호 */
                       ,T1.CHR_TSK_CD       AS CHR_TSK_CD   /* 담당업무코드 */
                       ,T1.CNB              AS CNB          /* 등록자 전산번호 */
                   FROM TBCSPRGA003M T1
                  ORDER BY T1.CHR_TSK_CD
                          ,T1.CNB
		]]>
	</select>
		
</sqlMap> 
