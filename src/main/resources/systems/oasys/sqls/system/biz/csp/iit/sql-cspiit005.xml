<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/iit/005">

	<select id="CSPIIT005QMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
           SELECT REGI_CHG_RQS_SNO 
                , RQR_NM 
                , ORG_NM
                , RQS_ORG_NM 
                , RQS_DT     
                , HNDL_DT   
                , RQS_DVSN_CD 
                , F_CODE_NM('1000304', RQS_DVSN_CD) AS RQS_DVSN_NM
                , HNDL_DVSN_CD
             FROM TBCSPIIT003M
             WHERE 1=1
                    
            ]]>
		<isNotEmpty property="strFrom">
			AND RQS_DT BETWEEN #strFrom# AND
			#strTo#
		</isNotEmpty>
		<isNotEmpty property="strHndlDvsnCd">
			AND HNDL_DVSN_CD = #strHndlDvsnCd#
		</isNotEmpty>
		<isNotEmpty property="strRqNm">
			AND (ORG_NM LIKE '%'||#strRqNm#||'%' OR
			RQR_NM LIKE '%'||#strRqNm#||'%')
		</isNotEmpty>
		
		   <![CDATA[
		   
		   ORDER BY REGI_CHG_RQS_SNO DESC
		       ]]>
	</select>


	<select id="CSPIIT006EMainSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
            SELECT REGI_CHG_RQS_SNO
                 , ORG_CD
                 , ORG_NM
                 , RGN_CD
                 , F_CODE_NM('1000001',RGN_CD) AS RGN_NM
                 , ORG_DVSN_CD
                 , COPT_SG_CD
                 , COPT_SG_2_CD
                 , TNB
                 , ZCD
                 , AD
                 , DTL_AD
                 , ROAD_NM_AD
                 , ROAD_NM_DTL_AD
                 , REGI_RQS_RMK
                 , ENFM_DPT_CD
                 , F_DPT_INFO(ENFM_DPT_CD, '1') AS ENFM_DPT_NM
                 , ORG_CAT_CD
                 , RQR_NM
                 , RQS_ORG_NM
                 , RQS_TNB
                 , RQS_DT
                 , HNDL_DT
                 , HNDL_DVSN_CD
                 , RQS_DVSN_CD
                 , PASA_USE_YN_CD
                 , RQR_EML_AD
                 , PUB_DVSN_CD
                 , RQR_ID
                 , CHGR_RMK
                 , ORG_DGE_CD
                 , SNCL_ORG_CD
                 , (SELECT ORG_NM FROM TBDCMACM015M Z WHERE D1.SNCL_ORG_CD = Z.ORG_CD ) AS SNCL_ORG_NM
                 , NVL(ADMN_ORG_DVSN_CD,'N') AS ADMN_ORG_DVSN_CD
                 , NVL(SCH_YN,'N') AS SCH_YN
              FROM TBCSPIIT003M D1
             WHERE 1=1
              AND REGI_CHG_RQS_SNO = #strRegiGhcRqsSno#
            ]]>

	</select>




	<update id="CSPIIT006EUpdate" parameterClass="paramMap">

		UPDATE TBCSPIIT003M
		SET REGI_CHG_RQS_SNO = #REGI_CHG_RQS_SNO#		/*등록변경요청순번*/
		, ORG_CD =		#ORG_CD#						/*기관코드*/
		, ORG_NM = #ORG_NM#								/*기관명*/
		, RGN_CD = #RGN_CD#								/*지역코드*/
		, ORG_DVSN_CD =		#ORG_DVSN_CD#				/*기관구분코드*/
		, ORG_DGE_CD = #ORG_DGE_CD#						/*기관차수코드*/
		, COPT_SG_CD = SUBSTR(#COPT_SG_2_CD#,0,3)					/*소관부호코드*/
		,COPT_SG_2_CD =  #COPT_SG_2_CD#
		, TNB = #TNB#									/*전화번호*/
		, ZCD = #ZCD#									/*우편번호*/
		, AD= #AD#										/*주소*/
		, DTL_AD = #DTL_AD#								/*상세주소*/
		, ROAD_NM_AD = #ROAD_NM_AD#						/*도로명주소*/
		, ROAD_NM_DTL_AD =		#ROAD_NM_DTL_AD#		/*도로명상세주소*/
		, USE_DVSN_NO =	#USE_DVSN_NO#					/*사용구분번호*/
		, REGI_RQS_RMK = #REGI_RQS_RMK#					/*등록요청비고*/
		, ENFM_DPT_CD =	#ENFM_DPT_CD#					/*집행부서코드*/
		, ORG_CAT_CD = #ORG_CAT_CD#						/*기관분류코드*/
		, RQR_NM = #RQR_NM#								/*요청자명*/
		, RQS_ORG_NM = #RQS_ORG_NM#						/*요청기관명*/
		, RQS_TNB = #RQS_TNB#							/*요청전화번호*/
		, RQS_DVSN_CD = #RQS_DVSN_CD#					/*요청구분코드*/
		, HNDL_DVSN_CD = #HNDL_DVSN_CD#					/*처리구분코드*/
		, CHGR_RMK=#CHGR_RMK#							/*담당자비고*/
		, RQR_EML_AD = #RQR_EML_AD#						/*요청자이메일주소*/
		, PUB_DVSN_CD = #PUB_DVSN_CD#					/*공공기관구분코드*/
		, PASA_USE_YN_CD =#PASA_USE_YN_CD#				/*공감법사용여부코드*/
		, SNCL_ORG_CD = #SNCL_ORG_CD#
		, FNL_MDF_DH =	SYSDATE
		, FNL_USR_ID = #FNL_USR_ID#
		, FNL_DEAL_DPT_CD =	#FNL_DEAL_DPT_CD#
		, FNL_MNU_ID = #FNL_MNU_ID#
		, HNDL_DT = DECODE(#HNDL_DVSN_CD#,'Y',TO_CHAR(SYSDATE,'yyyymmdd'),NULL)	
		, ADMN_ORG_DVSN_CD = #ADMN_ORG_DVSN_CD#
		, SCH_YN = #SCH_YN#
		WHERE 1=1
		AND REGI_CHG_RQS_SNO = #REGI_CHG_RQS_SNO#

	</update>

	<insert id="CSPIIT006EInsert" parameterClass="paramMap">
		INSERT INTO TBCSPIIT003M
			( 	REGI_CHG_RQS_SNO		/*등록변경요청순번*/
				, ORG_CD				/*기관코드*/
				, ORG_NM				/*기관명*/
				, RGN_CD				/*지역코드*/
				, ORG_DVSN_CD			/*기관구분코드*/
				, ORG_DGE_CD			/*기관차수코드*/
				, COPT_SG_CD			/*소관부호코드*/
				, COPT_SG_2_CD
				, TNB					/*전화번호*/
				, ZCD
				, AD					/*주소*/
				, USE_DVSN_NO			/*사용구분번호*/
				, CRE_DT				/*생성일*/
				, REGI_RQS_RMK			/*등록요청비고*/
				, ENFM_DPT_CD			/*집행부서코드*/
				, ORG_CAT_CD			/*기관분류코드*/
				, RQR_NM				/*요청자명*/
				, RQS_ORG_NM			/*요청기관명*/
				, RQS_TNB				/*요청전화번호*/
				, RQS_DT				/*요청일*/
				, HNDL_DVSN_CD			/*처리구분코드*/
				, RQS_DVSN_CD			/*요청구분코드*/
				, RQR_ID				/*요청자ID*/
				, CHGR_RMK				/*담당자비고*/
				, RQR_EML_AD			/*요청자이메일주소*/
				, PUB_DVSN_CD			/*공공기관구분코드*/
				, PASA_USE_YN_CD		/*공감법사용여부코드*/
				, SNCL_ORG_CD
				, FRT_USR_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MNU_ID
				, FRT_REGI_DH
				, FNL_MDF_DH
				, ADMN_ORG_DVSN_CD
				, SCH_YN
			)
		VALUES
			( 	#REGI_CHG_RQS_SNO#
				, #ORG_CD#
				, #ORG_NM#
				, #RGN_CD#
				, #ORG_DVSN_CD#
				, #ORG_DGE_CD#
				, SUBSTR(#COPT_SG_2_CD#,0,3)
				, #COPT_SG_2_CD#
				, #TNB#
				, #ZCD#
				, #AD#
				, #USE_DVSN_NO#
				, ''
				, #REGI_RQS_RMK#
				, #ENFM_DPT_CD#
				, #ORG_CAT_CD#
				, #RQR_NM#
				, #RQS_ORG_NM#
				, #RQS_TNB#
				, TO_CHAR(SYSDATE,'yyyymmdd')
				, #HNDL_DVSN_CD#
				, #RQS_DVSN_CD#
				, #RQR_ID#
				, #CHGR_RMK#
				, #RQR_EML_AD#
				, #PUB_DVSN_CD#
				, #PASA_USE_YN_CD#
				, #SNCL_ORG_CD#
				, #FRT_USR_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, #FNL_MNU_ID#
				, SYSDATE
				, SYSDATE
				, #ADMN_ORG_DVSN_CD#
				, #SCH_YN#
			)
	</insert>



	<select id="CSPIIT006ERqsSnoMaxSelect" parameterClass="paramMap"
		resultClass="java.lang.String">
        <![CDATA[
            SELECT NVL(MAX(TO_NUMBER(REGI_CHG_RQS_SNO)),0)+1 AS REGI_CHG_RQS_SNO  
              FROM TBCSPIIT003M
          ]]>

	</select>

	<update id="CSPIIT006EDelete" parameterClass="paramMap">
		DELETE
		FROM
		TBCSPIIT003M
		WHERE 1=1
		AND REGI_CHG_RQS_SNO = #REGI_CHG_RQS_SNO#

	</update>
	
	<update id="CSPIIT007EDelete" parameterClass="paramMap">
		DELETE
		FROM
		TBCSPIIT004L
		WHERE 1=1
		AND LG_SNO = #LG_SNO#

	</update>



	<select id="CSPIIT007ESubSelect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
          SELECT LG_SNO
               , ORG_CD
               , ORG_NM
               , RGN_CD
               , ORG_DVSN_CD
               , COPT_SG_CD
               , COPT_SG_2_CD
               , TNB
               , ZCD
               , AD
               , DTL_AD
               , ROAD_NM_AD
               , ROAD_NM_DTL_AD
               , USE_DVSN_NO
               , LG_RMK
               , ENFM_DPT_CD
               , F_DPT_INFO(ENFM_DPT_CD, '1') AS ENFM_DPT_NM
               , ORG_CAT_CD
               , ORG_DGE_CD
               , F_CODE_NM(1000001,RGN_CD) AS RGN_NM
               ,  PUB_DVSN_CD
               , PASA_USE_YN_CD
               , NVL(ADMN_ORG_DVSN_CD,'N') AS ADMN_ORG_DVSN_CD
              FROM TBCSPIIT004L D1
             WHERE 1=1
              AND REGI_CHG_RQS_SNO = #strRegiGhcRqsSno#
            ]]>

	</select>
	
	
	<insert id="CSPIIT007EInsert" parameterClass="paramMap">
		INSERT INTO
		TBCSPIIT004L
		( LG_SNO
         , ORG_CD
         , ORG_NM
         , RGN_CD
         , ORG_DVSN_CD
         , COPT_SG_CD
         , COPT_SG_2_CD
         , TNB
         , ZCD
         , AD
         , DTL_AD
         , ROAD_NM_AD
         , ROAD_NM_DTL_AD
         , USE_DVSN_NO
         , LG_RMK
         , ENFM_DPT_CD
       
         , ORG_CAT_CD
         , ORG_DGE_CD
         , REGI_CHG_RQS_SNO
		, PASA_USE_YN_CD
		,PUB_DVSN_CD
		, FRT_USR_ID
		, FNL_USR_ID
		, FNL_DEAL_DPT_CD
		, FNL_MNU_ID
		, FRT_REGI_DH
		, FNL_MDF_DH
		, ADMN_ORG_DVSN_CD
		)
		VALUES
		( #LG_SNO#
        , #ORG_CD#
        , #ORG_NM#
        , #RGN_CD#
        , #ORG_DVSN_CD#
        , SUBSTR(#COPT_SG_2_CD#,0,3)
        , #COPT_SG_2_CD#
        , #TNB#
        , #ZCD#
        , #AD#
        , #DTL_AD#
        , #ROAD_NM_AD#
        , #ROAD_NM_DTL_AD#
        , #USE_DVSN_NO#
        , #LG_RMK#
        , #ENFM_DPT_CD#
       
        , #ORG_CAT_CD#
        , #ORG_DGE_CD#
        
        , #REGI_CHG_RQS_SNO#
		, #PASA_USE_YN_CD#
		,#PUB_DVSN_CD#
		, #FRT_USR_ID#
		, #FNL_USR_ID#
		, #FNL_DEAL_DPT_CD#
		,
		#FNL_MNU_ID#
		, SYSDATE
		,
		SYSDATE
		, #ADMN_ORG_DVSN_CD#
		)
	</insert>
		<select id="CSPIIT007ELgSnoMaxSelect" parameterClass="paramMap"
		resultClass="java.lang.String">
        <![CDATA[
            SELECT NVL(MAX(TO_NUMBER(LG_SNO)),0)+1 AS LG_SNO  
              FROM TBCSPIIT004L
          ]]>

	</select>
	
		<select id="CSPIIT006EOrgChkSelect" parameterClass="paramMap"
		resultClass="java.lang.String">
        <![CDATA[
            SELECT COUNT(*) AS CNT 
              FROM TBDCMACM015M
              WHERE 1=1
                AND ORG_CD = #strOrgCd#
          ]]>

	</select>


	<insert id="CSPIIT006EIIT012HInsert" parameterClass="paramMap">
		INSERT INTO	TBCSPIIT012H
				(	  CON_NO
					, REGI_CHG_RQS_SNO
					, HNDL_DT
					, PAIS_SRNO
					, USE_YN
					, FRT_USR_ID
					, FNL_USR_ID
					, FNL_DEAL_DPT_CD
					, FNL_MNU_ID
					, FRT_REGI_DH
					, FNL_MDF_DH
				)
		VALUES	(	  (	SELECT	NVL(MAX(TO_NUMBER(CON_NO)),0)+1
						FROM	TBCSPIIT012H
					  )
					, #REGI_CHG_RQS_SNO#
					, TO_CHAR(SYSDATE,'YYYYMMDD')
					, (	SELECT	PAIS_SRNO
						FROM	TBCSPIIT003M
						WHERE	REGI_CHG_RQS_SNO = #REGI_CHG_RQS_SNO# )
					, 'N'
					, F_USR_INFO(#S_CNB#,'1')
					, #FNL_USR_ID#
					, #FNL_DEAL_DPT_CD#
					, #FNL_MNU_ID#
					, SYSDATE
					, SYSDATE
				)
	</insert>
	
	<!-- 기관코드관리 조회 -->
	<select id="CSPIIT007EOrgSelect" parameterClass="paramMap"
		resultClass="resultMap">
	<![CDATA[
       SELECT ORG_CD
            , ORG_NM
            , RGN_CD
			, F_CODE_NM('1000001',RGN_CD) AS RGN_NM
            , ORG_DVSN_CD
            , ORG_DGE_CD
            , COPT_SG_CD
            , COPT_SG_2_CD
            , TNB
            , ZCD
            , AD
            , DTL_AD
            , ROAD_NM_AD
            , ROAD_NM_DTL_AD
            , USE_DVSN_NO
            , ENFM_DPT_CD
            , F_DPT_INFO(ENFM_DPT_CD, '1') AS ENFM_DPT_NM
            , ORG_CAT_CD
            , SUBSTR(ZCD,1,3) 										AS ZCD1	
          	, SUBSTR(ZCD,4,3) 										AS ZCD2
          	, PUB_DVSN_CD
          	, PASA_USE_YN_CD
          	, PUB_DVSN_CD
          	, NVL(ADMN_ORG_DVSN_CD,'N') AS ADMN_ORG_DVSN_CD
         FROM TBDCMACM015M D1 
        WHERE 1=1
	]]>
	<dynamic>
		<isNotEmpty property="strOrgCd">
			AND ORG_CD = #strOrgCd#
		</isNotEmpty>
	</dynamic>
	</select>
	
	<!-- 기관코드관리신규 -->
	<insert id="CSPIIT006DCMACM015Insert" parameterClass="paramMap">
	
		DECLARE
			BEGIN
				INSERT INTO
				TBDCMACM015M
				(
				ORG_CD
				, ORG_NM
				, RGN_CD
				, ORG_DVSN_CD
				, ORG_DGE_CD
				, COPT_SG_CD
				,COPT_SG_2_CD
				, TNB
				, ZCD
				, AD
				, DTL_AD
				, ROAD_NM_AD
				, ROAD_NM_DTL_AD
				, USE_DVSN_NO
				, CRE_DT
				, RMK
				, ENFM_DPT_CD
				, ORG_CAT_CD
				, CVPT_TON_ORG_YN
				, CHG_DT
				, BZN
				, ABLT_DT
				, PUB_DVSN_CD
				, PASA_USE_YN_CD
				, FRT_USR_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MNU_ID
				, FRT_REGI_DH
				, FNL_MDF_DH
				, ADMN_ORG_DVSN_CD
				)
				VALUES
				(
				#ORG_CD#
				, #ORG_NM#
				, #RGN_CD#
				, #ORG_DVSN_CD#
				, #ORG_DGE_CD#
				, SUBSTR(#COPT_SG_2_CD#,0,3)
				, #COPT_SG_2_CD#
				, #TNB#
				, #ZCD#
				, #AD#
				, #DTL_AD#
				, #ROAD_NM_AD#
				, #ROAD_NM_DTL_AD#
				, #USE_DVSN_NO#
				,TO_CHAR(SYSDATE,'yyyymmdd')
				, #RMK#
				, #ENFM_DPT_CD#
				, #ORG_CAT_CD#
				, #CVPT_TON_ORG_YN#
				, TO_CHAR(SYSDATE,'yyyymmdd')
				, #BZN#
				, #ABLT_DT#
				, #PUB_DVSN_CD#
				, #PASA_USE_YN_CD#
				, #FRT_USR_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, #FNL_MNU_ID#
				, SYSDATE
				, SYSDATE
				, #ADMN_ORG_DVSN_CD#
				);
				
				INSERT
				INTO
				TBDCMACM035H
				(
				  ORG_CD
				, CON_NO 
				, CON_HNDL_DVSN_CD
				, USE_YN
				
				, FRT_USR_ID		
				, FRT_REGI_DH
				, FNL_MNU_ID
				, FNL_USR_ID
				, FNL_DEAL_DPT_CD
				, FNL_MDF_DH
				) VALUES
				(
				  #ORG_CD#
				, (	SELECT NVL(MAX(CON_NO),0)+1  AS CON_NO
					  FROM TBDCMACM035H
			       ) 
			    , 'C'
				, 'N'
				
				, #FRT_USR_ID#			
				, SYSDATE
				, #FNL_MNU_ID#
				, #FNL_USR_ID#
				, #FNL_DEAL_DPT_CD#
				, SYSDATE
				);
		END;
				
	</insert>
	
	<update id="CSPIIT007DCMACM015Update" parameterClass="paramMap">
	
	DECLARE
		BEGIN
			UPDATE TBDCMACM015M
			SET ORG_CD = ORG_CD
			, FNL_MDF_DH = SYSDATE
			,
			FNL_USR_ID = #FNL_USR_ID#
			, FNL_DEAL_DPT_CD = #FNL_DEAL_DPT_CD#
			,
			FNL_MNU_ID = #FNL_MNU_ID#
			,COPT_SG_2_CD = #COPT_SG_2_CD#
			,COPT_SG_CD = SUBSTR(#COPT_SG_2_CD#,0,3)
			,ADMN_ORG_DVSN_CD = #ADMN_ORG_DVSN_CD#
			<isNotNull prepend="," property="ORG_NM">
				ORG_NM = #ORG_NM#
			</isNotNull>
			<isNotNull prepend="," property="RGN_CD">
				RGN_CD = #RGN_CD#
			</isNotNull>
			<isNotNull prepend="," property="ORG_DVSN_CD">
				ORG_DVSN_CD = #ORG_DVSN_CD#
			</isNotNull>
			<isNotNull prepend="," property="ORG_DGE_CD">
				ORG_DGE_CD = #ORG_DGE_CD#
			</isNotNull>
			<isNotNull prepend="," property="TNB">
				TNB = #TNB#
			</isNotNull>
			
			<isNotNull prepend="," property="ZCD">
				ZCD = #ZCD#
			</isNotNull>
			<isNotNull prepend="," property="AD">
				AD =#AD#
			</isNotNull>
			<isNotNull prepend="," property="DTL_AD">
				DTL_AD = #DTL_AD#
			</isNotNull>
			<isNotNull prepend="," property="ROAD_NM_AD">
				ROAD_NM_AD = #ROAD_NM_AD#
			</isNotNull>
			<isNotNull prepend="," property="ROAD_NM_DTL_AD">
				ROAD_NM_DTL_AD =
				#ROAD_NM_DTL_AD#
			</isNotNull>
			<isNotNull prepend="," property="USE_DVSN_NO">
				USE_DVSN_NO = #USE_DVSN_NO#
			</isNotNull>
			<isNotNull prepend="," property="ENFM_DPT_CD">
				ENFM_DPT_CD = #ENFM_DPT_CD#
			</isNotNull>
			<isNotNull prepend="," property="PASA_USE_YN_CD">
				PASA_USE_YN_CD = #PASA_USE_YN_CD#
			</isNotNull>
			<isNotNull prepend="," property="PUB_DVSN_CD">
				PUB_DVSN_CD = #PUB_DVSN_CD#
			</isNotNull>
	
			WHERE 1 = 1
			AND ORG_CD = #ORG_CD#;
			
			INSERT INTO 
			TBDCMACM034H(
			   CON_NO
			 , CON_USE_YN
			 , ORG_CD
			 , ORG_NM
			 , RGN_CD       /* 지역코드 추가 - 2017.03.13 yyh*/
			 , ORG_DVSN_CD
			 , ORG_DGE_CD
			 , COPT_SG_CD
			 , COPT_SG_2_CD
			 , TNB
			 , ZCD
			 , AD
			 , DTL_AD
			 , ROAD_NM_AD
			 , ROAD_NM_DTL_AD
			 , USE_DVSN_NO
			 , CRE_DT
			 , RMK
			 , ENFM_DPT_CD
			 , ORG_CAT_CD
			 , CVPT_TON_ORG_YN
			 , CHG_DT
			 , BZN
			 , ABLT_DT
			 , PUB_DVSN_CD
			 , SRCH_CNT
			 , PASA_USE_YN_CD
			 , FRT_USR_ID
			 , FNL_USR_ID
			 , FNL_DEAL_DPT_CD
			 , FNL_MNU_ID
			 , FRT_REGI_DH
			 , FNL_MDF_DH
			 , ADMN_ORG_DVSN_CD
			) 
			SELECT (SELECT NVL(MAX(CON_NO),'0')+1 FROM TBDCMACM034H) AS CON_NO
			     , 'N' AS CON_USE_YN
				 , ORG_CD
				 , ORG_NM
				 , RGN_CD 
				 , ORG_DVSN_CD
				 , ORG_DGE_CD
				 , COPT_SG_CD
				 , COPT_SG_2_CD
				 , TNB
				 , ZCD
				 , AD
				 , DTL_AD
				 , ROAD_NM_AD
				 , ROAD_NM_DTL_AD
				 , USE_DVSN_NO
				 , CRE_DT
				 , RMK
				 , ENFM_DPT_CD
				 , ORG_CAT_CD
				 , CVPT_TON_ORG_YN
				 , CHG_DT
				 , BZN
				 , ABLT_DT
				 , PUB_DVSN_CD
				 , NULL SRCH_CNT
				 , PASA_USE_YN_CD
				 , #FNL_USR_ID# AS FRT_USR_ID
				 , #FNL_USR_ID# AS FNL_USR_ID
				 , #FNL_DEAL_DPT_CD# AS FNL_DEAL_DPT_CD
				 , #FNL_MNU_ID# AS FNL_MNU_ID
				 , SYSDATE AS FRT_REGI_DH
				 , SYSDATE AS FNL_MDF_DH
				 , ADMN_ORG_DVSN_CD
			 FROM TBDCMACM015M 
			 WHERE ORG_CD = #ORG_CD#;
			 
		END;

	</update>
	
	<select id="CSPIIT006ESelectAddress" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	F_GET_ADDRESS(#strGrnCd#) AS address
			FROM	DUAL
		]]>
	</select>
	
	<select id="CSPIIT006ESelectNewOrgCd" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	F_GET_NEW_ORG_CD2(#strSNCL_ORG_CD#,NVL(#SCH_YN#,'N')) AS ORG_CD
			FROM	DUAL
		]]>
	</select>
	
	<update id="CSPIIT005EUpdate" parameterClass="paramMap">
		<![CDATA[
			UPDATE	TBCSPIIT003M
			SET		HNDL_DVSN_CD = 'Y'
					, HNDL_DT = TO_CHAR(SYSDATE,'yyyymmdd')
					, USE_DVSN_NO = #USE_DVSN_NO#
					, FNL_MDF_DH =	SYSDATE
					, FNL_USR_ID = #FNL_USR_ID#
					, FNL_DEAL_DPT_CD =	#FNL_DEAL_DPT_CD#
					, FNL_MNU_ID = #FNL_MNU_ID#
			WHERE	REGI_CHG_RQS_SNO = #REGI_CHG_RQS_SNO#
		]]>
	</update>
	
	
	<select id="CSPIIT005EMainSelectForUpdate" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
            SELECT REGI_CHG_RQS_SNO
                 , ORG_CD
                 , ORG_NM
                 , RGN_CD
                 , F_CODE_NM('1000001',RGN_CD) AS RGN_NM
                 , ORG_DVSN_CD
                 , COPT_SG_CD
                 , COPT_SG_2_CD
                 , TNB
                 , ZCD
                 , AD
                 , DTL_AD
                 , ROAD_NM_AD
                 , ROAD_NM_DTL_AD
                 , REGI_RQS_RMK
                 , USE_DVSN_NO
                 , ENFM_DPT_CD
                 , F_DPT_INFO(ENFM_DPT_CD, '1') AS ENFM_DPT_NM
                 , ORG_CAT_CD
                 , RQR_NM
                 , RQS_ORG_NM
                 , RQS_TNB
                 , RQS_DT
                 , HNDL_DT
                 , HNDL_DVSN_CD
                 , RQS_DVSN_CD
                 , PASA_USE_YN_CD
                 , RQR_EML_AD
                 , PUB_DVSN_CD
                 , RQR_ID
                 , CHGR_RMK
                 , ORG_DGE_CD
                 , SNCL_ORG_CD
                 , (SELECT ORG_NM FROM TBDCMACM015M Z WHERE D1.SNCL_ORG_CD = Z.ORG_CD ) AS SNCL_ORG_NM
                 , #FNL_USR_ID# as FNL_USR_ID
                 ,#FNL_DEAL_DPT_CD# as FNL_DEAL_DPT_CD
                 , #FNL_MNU_ID# as FNL_MNU_ID 
                 , #FRT_USR_ID# as FRT_USR_ID
                 , ADMN_ORG_DVSN_CD
              FROM TBCSPIIT003M D1
             WHERE 1=1
              AND REGI_CHG_RQS_SNO = #REGI_CHG_RQS_SNO#
            ]]>

	</select>
</sqlMap> 
