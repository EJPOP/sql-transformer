<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/dcp/616">

 	<resultMap class="java.util.HashMap" id="hwpDoc_Map">
	
	<result property="CV_PET_CATE_CD" column="CV_PET_CATE_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="YEAR" column="YEAR" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACCT_NO" column="ACCT_NO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="JUBSOONO" column="JUBSOONO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACCT_DATE" column="ACCT_DATE" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PETER_NM" column="CV_PETER_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PETER_ADDR" column="CV_PETER_ADDR" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="SUP_ORG_NM" column="SUP_ORG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REL_ORG_NM" column="REL_ORG_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TELNO" column="TELNO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="TITLE" column="TITLE" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="SINGOHAISU" column="SINGOHAISU" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	
	<result property="CV_PET_SUMM" column="CV_PET_SUMM" jdbcType="CLOB"	javaType="java.lang.String" />
	
	
	<result property="CV_PET_HNDL_DIRC_CD" column="CV_PET_HNDL_DIRC_CD" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="HNDL_DEPT_NM" column="HNDL_DEPT_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="ACCT_ROUTE_NM" column="ACCT_ROUTE_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	
	
	<result property="GWANNO" column="GWANNO" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PET_ORIGIN_NM" column="CV_PET_ORIGIN_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="CV_PET_CAUSE_NM" column="CV_PET_CAUSE_NM" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="REGULATORY_REFORM_ITEM_YN" column="REGULATORY_REFORM_ITEM_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="FREQUENT_OCCUR_YN" column="FREQUENT_OCCUR_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />
	<result property="BUDGET_WASTE_YN" column="BUDGET_WASTE_YN" jdbcType="VARCHAR2"	javaType="java.lang.String" />


    </resultMap>
    
 	<select id="CSPDCP616PMainSelect" parameterClass="paramMap"
		resultMap="hwpDoc_Map">
		<![CDATA[
		SELECT D1.CV_PET_CATE_CD
		      ,D1.YEAR
		      ,D1.ACCT_NO
		      ,D1.YEAR||'-'||D1.CV_PET_CATE_CD||'-'||D1.ACCT_NO AS JUBSOONO
		      ,D1.ACCT_DATE
		      ,D1.CV_PETER_NM
		      ,F_ORG_INFO(D1.SUP_ORG_CD, '1') AS SUP_ORG_NM
		      ,F_ORG_INFO(D1.REL_ORG_CD, '1') AS REL_ORG_NM
		      ,D1.CV_PETER_ADDR
		      ,NVL(D1.CV_PETER_TEL, D1.CV_PETER_TEL2) AS TELNO
		      ,D1.TITLE
		      ,D1.CV_PET_SUMM
		      ,D1.CV_PET_HNDL_DIRC_CD
		      ,F_DPT_INFO(D1.HNDL_DEPT_CD, '1') AS HNDL_DEPT_NM
		      ,(SELECT S1.CD_NM
		          FROM CM_ETCCD S1
		         WHERE 1=1
		           AND S1.CD_TYPE = 'AS18'
		           AND S1.CD = D1.ACCT_ROUTE_CD) AS ACCT_ROUTE_NM
		      ,D1.RE_YN
		      ,D1.PUBLIC_YN
		      ,D1.REPEAT_CNT AS SINGOHAISU
		      ,D1.LAST_REPEAT_YEAR||NVL2(D1.LAST_REPEAT_YEAR, '-', '')||D1.LAST_REPEAT_ACCT_NO AS GWANNO
		      ,(SELECT S2.CD_NM
		          FROM CM_ETCCD S2
		         WHERE 1=1 
		           AND S2.CD_TYPE = 'AS11'
		           AND S2.CD      = D1.CV_PET_ORIGIN_CD) AS CV_PET_ORIGIN_NM
		      ,(SELECT S3.CD_NM
		          FROM CM_ETCCD S3
		         WHERE S3.CD_TYPE = 'AS12'
		           AND S3.CD = D1.CV_PET_CAUSE_CD)  AS CV_PET_CAUSE_NM
		      ,D1.REGULATORY_REFORM_ITEM_YN
		      ,D1.FREQUENT_OCCUR_YN
		      ,D1.BUDGET_WASTE_YN
		  FROM AM_CV_PET_HNDL_DOC D1
		 WHERE 1=1
		   AND D1.CV_PET_CATE_CD = #CV_PET_CATE_CD#
		   AND D1.YEAR           = #YEAR#
		   AND D1.ACCT_NO        = #ACCT_NO#
		]]>
		
	</select>

</sqlMap> 
