<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="csp/lfi/241">
	
	<select id="CSPLFI241EMainSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT 
			       ROWNUM AS SNO, 
			       CD,
		]]>
		<dynamic>
			<isEqual property="rdb1" compareValue="3">
				USR_DFN_TXT_3 AS CD_NM,
			</isEqual>
		</dynamic>
		<![CDATA[
				CD_NM  AS CD_NM,
				'' as radio
			  FROM TBDCMACM013C 
			 WHERE CMM_CD_DVSN_CD = '1000145'
			   AND CD! = '000000000'
	 	]]>
		<dynamic>
			<isEqual property="rdb1" compareValue="1">
				   AND USR_DFN_TXT_1 = '1'
			</isEqual>
		</dynamic>
		<![CDATA[
			ORDER BY OTPT_SEQ
		]]>
	 </select>
	 
	<select id="CSPLFI241ERdbSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT '1' AS CD, '개인별' AS CD_NM FROM DUAL
			UNION ALL
			SELECT '2' AS CD, '실국별' AS CD_NM FROM DUAL
	 	]]>
	 	<dynamic>
	 		<isEqual property="rdb1" compareValue="1">
				UNION ALL
				SELECT '3' AS CD, '실과별' AS CD_NM FROM DUAL
				UNION ALL
				SELECT '4' AS CD, '월별' AS CD_NM FROM DUAL
	 			UNION ALL
	 			SELECT '5' AS CD, '직위/직급별' AS CD_NM FROM DUAL
	 		</isEqual>
	 		<isEqual property="rdb1" compareValue="2">
	 			UNION ALL
	 			SELECT '5' AS CD, '직위/직급별' AS CD_NM FROM DUAL
	 		</isEqual>
	 	</dynamic>
	 	<![CDATA[
			
	 	]]>
	 </select>
	 
	 
<!-- 보고서 쿼리	-->
	<!-- 수당 개인별 지급목록 (월정직책급, 모니터링활동비) -->
	<select id="CSPLFI2411RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT 	NVL(E.ABR_DPT_NM_2,'') AS DPT_NM, /* 20181104 EUNOK D.CD_NM -> E.ABR_DPT_NM_2 */
					B.USR_NAM || '(' || A.CNB || ')' AS NAME,
			        A.AMT1,
			        #toYm# as TOYM
			 FROM (
				  SELECT CNB, DPT_CD, 
				         NVL(MAX(CASE WHEN B.ALW_DVSN_CD = #AlwDvsnCd# THEN B.PMT_AM END),0) AS AMT1 
				    FROM TBCSPLFI104L B 
				    WHERE PMT_YM = #toYm#
				    GROUP BY CNB ,DPT_CD
			 		) A, 
			       TBDCMACM001M B, 
			       TBDCMACM013C C,
			       TBDCMACM013C D,
			       TBDCMACM002M E
			WHERE A.CNB = B.CNB
			  AND A.DPT_CD = D.CD 
			  AND C.CMM_CD_DVSN_CD = '1000173' 
			  AND C.CD = B.RANK_CD
			  AND D.CMM_CD_DVSN_CD = '1000144' 
			  AND D.CD = A.DPT_CD 
			  AND A.DPT_CD = E.DPT_CD
			  AND B.USR_NAM LIKE #name# || '%'
			  AND A.DPT_CD LIKE '%' || #dptCd# || '%'
			  AND AMT1 != 0  
			  ORDER BY  E.DPT_SNO ASC, E.SRT_SNO ASC, A.DPT_CD ASC, B.INN_RANK_CD ASC, C.USR_DFN_TXT_3 ASC, B.CRNT_RANK_APM_DT ASC 
	 	]]>
	 </select>
	 
	<!-- 수당 개인별 지급목록 (기타) -->
	<select id="CSPLFI2413RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT 	NVL(E.ABR_DPT_NM_2,'') AS DPT_NM,  /* 20181104 EUNOK D.CD_NM -> E.ABR_DPT_NM_2 */
					B.USR_NAM || '(' || A.CNB || ')' AS NAME,
			        A.AMT1, A.AMT2, A.AMT3, A.AMT4, 
			        NVL(A.AMT1 + A.AMT2 + A.AMT3 + A.AMT4, 0) AS TOTAMT,
			        #toYm# as TOYM
			 FROM (
				  SELECT CNB, DPT_CD, 
				         NVL(MAX(CASE WHEN B.ALW_DVSN_CD = '9992' THEN B.PMT_AM END),0) AS AMT1,
				         NVL(MAX(CASE WHEN B.ALW_DVSN_CD = '9993' THEN B.PMT_AM END),0) AS AMT2,
				         NVL(MAX(CASE WHEN B.ALW_DVSN_CD = '9994' THEN B.PMT_AM END),0) AS AMT3,
				         NVL(MAX(CASE WHEN B.ALW_DVSN_CD = '9995' THEN B.PMT_AM END),0) AS AMT4
				    FROM TBCSPLFI104L B 
				    WHERE PMT_YM = #toYm#
				    GROUP BY CNB ,DPT_CD
			 		) A, 
			       TBDCMACM001M B, 
			       TBDCMACM013C C,
			       TBDCMACM013C D,
			       TBDCMACM002M E
			WHERE A.CNB = B.CNB
			  AND A.DPT_CD = D.CD 
			  AND C.CMM_CD_DVSN_CD = '1000173' 
			  AND C.CD = B.RANK_CD
			  AND D.CMM_CD_DVSN_CD = '1000144' 
			  AND D.CD = A.DPT_CD 
			  AND A.DPT_CD = E.DPT_CD
			  AND B.USR_NAM LIKE '%' || #name# || '%'
			  AND A.DPT_CD LIKE '%' || #dptCd# || '%'
			  ORDER BY  E.DPT_SNO, E.SRT_SNO, A.DPT_CD ASC, B.INN_RANK_CD ASC, C.USR_DFN_TXT_3 ASC, B.CRNT_RANK_APM_DT ASC 
	 	]]>
	 </select>
	 
	<!-- 수당 실국별 지급목록 (월정직책급, 모니터링 활동비) -->
	<select id="CSPLFI2414RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT A.CD_NM, 
			       NVL(C.CNT,0) AS CNT1,
			       NVL(c.TOTAL,0) AS TOTAL1
			       ,#toYm# as TOYM
			  FROM ( 
					SELECT SUBSTRING(A.CD,1,3) AS CD
						 , B.ABR_DPT_NM_2 AS CD_NM /* 20181104 EUNOK CD_NM -> B.ABR_DPT_NM_2 */ 
					     , B.DPT_SNO
               			 , B.SRT_SNO
					  FROM TBDCMACM013C A,TBDCMACM002M B
					 WHERE A.CMM_CD_DVSN_CD = '1000144' 
					   AND (A.CD LIKE '___000' OR  A.CD ='770770') 
					   AND A.USE_YN !='N'
                       AND A.CD = B.DPT_CD
				   )A, 
				    ( 
			          SELECT SUBSTRING(B.DPT_CD,1,3) AS DPT_CD, 
			                 SUM(CNT) AS CNT,
			                 SUM(TOTAL) AS TOTAL 
			            FROM( 
				             SELECT	SUBSTRING(A.DPT_CD,1,3) AS DPT_CD, 
				                    COUNT(A.CNB) AS CNT,
				                    SUM(A.PMT_AM) AS TOTAL 
				               FROM TBCSPLFI104L A,
				                    TBDCMACM001M B 
				              WHERE A.CNB = B.CNB 
				                AND PMT_YM = #toYm#
				                AND A.ALW_DVSN_CD = #AlwDvsnCd#
				                AND A.PMT_AM != 0 
				              GROUP BY SUBSTRING(A.DPT_CD,1,3) 
			                )B 
					       GROUP BY SUBSTRING(B.DPT_CD,1,3) 
			        )C 
			 WHERE A.CD= C.DPT_CD(+)
			 ORDER BY A.DPT_SNO ASC, A.SRT_SNO ASC, A.CD ASC 
	 	]]>
	 </select>
	 
	<!-- 수당 실국별 지급목록 (기타) -->
	<select id="CSPLFI2416RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT 	A.CD_NM, 
			       	NVL(B.CNT1,0) AS CNT1,
			       	NVL(B.TOTAL1,0) AS TOTAL1,
			       	NVL(B.CNT2,0) AS CNT2,
			       	NVL(B.TOTAL2,0) AS TOTAL2,
			       	NVL(B.CNT3,0) AS CNT3,
			       	NVL(B.TOTAL3,0) AS TOTAL3,
			       	NVL(B.CNT4,0) AS CNT4,
			       	NVL(B.TOTAL4,0) AS TOTAL4,
			       	NVL(B.CNT1 + B.CNT2 + B.CNT3 + B.CNT4, 0) AS CNT5,
			       	NVL(B.TOTAL1 + B.TOTAL2 + B.TOTAL3 + B.TOTAL4, 0) AS TOTAL5
			       	,#toYm# as TOYM
			  FROM	(
					SELECT SUBSTRING(A.CD,1,3) AS CD
					     , B.ABR_DPT_NM_2 AS CD_NM /* 20181104 EUNOK CD_NM -> B.ABR_DPT_NM_2 */ 
					     , B.DPT_SNO
               			 , B.SRT_SNO
					  FROM TBDCMACM013C A,TBDCMACM002M B
					 WHERE A.CMM_CD_DVSN_CD = '1000144' 
					   AND (A.CD LIKE '___000' OR  A.CD ='770770') 
					   AND A.USE_YN !='N'
                       AND A.CD = B.DPT_CD
					) A,
					(
						SELECT SUBSTRING(B.DPT_CD,1,3) AS DPT_CD, 
						     SUM(CNT1) AS CNT1,
						     SUM(TOTAL1) AS TOTAL1,
						     SUM(CNT2) AS CNT2,
						     SUM(TOTAL2) AS TOTAL2,
						     SUM(CNT3) AS CNT3,
						     SUM(TOTAL3) AS TOTAL3,
						     SUM(CNT4) AS CNT4,
						     SUM(TOTAL4) AS TOTAL4
						FROM( 
						     SELECT	SUBSTRING(A.DPT_CD,1,3) AS DPT_CD, 
						            COUNT(CASE WHEN A.ALW_DVSN_CD = '9992' THEN A.CNB END) AS CNT1,
						            SUM(CASE WHEN A.ALW_DVSN_CD = '9992' THEN A.PMT_AM ELSE 0 END) AS TOTAL1,
						            COUNT(CASE WHEN A.ALW_DVSN_CD = '9993' THEN A.CNB END) AS CNT2,
						            SUM(CASE WHEN A.ALW_DVSN_CD = '9993' THEN A.PMT_AM ELSE 0 END) AS TOTAL2,
						            COUNT(CASE WHEN A.ALW_DVSN_CD = '9994' THEN A.CNB END) AS CNT3,
						            SUM(CASE WHEN A.ALW_DVSN_CD = '9994' THEN A.PMT_AM ELSE 0 END) AS TOTAL3,
						            COUNT(CASE WHEN A.ALW_DVSN_CD = '9995' THEN A.CNB END) AS CNT4,
						            SUM(CASE WHEN A.ALW_DVSN_CD = '9995' THEN A.PMT_AM ELSE 0 END) AS TOTAL4
						       FROM TBCSPLFI104L A,
						            TBDCMACM001M B 
						      WHERE A.CNB = B.CNB 
						        AND PMT_YM = #toYm#
						        AND A.ALW_DVSN_CD IN ('9992', '9993', '9994', '9995')
						        AND A.PMT_AM != 0 
						      GROUP BY SUBSTRING(A.DPT_CD,1,3), A.CNB
						    )B 
						   GROUP BY SUBSTRING(B.DPT_CD,1,3) 
					) B
			 WHERE A.CD= B.DPT_CD(+)
			 ORDER BY A.DPT_SNO ASC, A.SRT_SNO ASC, A.CD ASC
	 	]]>
	 </select>
	 
	<!-- 수당 실과별 지급목록 (월정직책급, 모니터링 활동비) -->
	<select id="CSPLFI2417RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT A.CD_NM, 
			       NVL(C.CNT,0) AS CNT1,
			       NVL(C.TOTAL,0) AS TOTAL1 
			       ,#toYm# as TOYM
			  FROM ( 
					SELECT A.CD
					     , B.ABR_DPT_NM_2 AS CD_NM /* 20181104 EUNOK CD_NM -> B.ABR_DPT_NM_2 */ 
					     , B.DPT_SNO
               			 , B.SRT_SNO
					  FROM TBDCMACM013C A,TBDCMACM002M B
					 WHERE A.CMM_CD_DVSN_CD = '1000144' 
					   AND A.CD <> '000000000'
					   AND A.USE_YN != 'N'
                       AND A.CD = B.DPT_CD
				   )A, 
				    ( 
			          SELECT	D3.DPT_CD
								, SUM(D3.CNT) AS CNT
								, SUM(D3.TOTAL) AS TOTAL
						FROM	(
									SELECT	SUBSTR(D1.DPT_CD, 1, 3) || '000' AS DPT_CD
											, 1 AS CNT
											, D1.PMT_AM AS TOTAL
									FROM	TBCSPLFI104L D1
											, TBDCMACM001M D2
									WHERE	D1.CNB = D2.CNB
									AND		D1.PMT_YM = #toYm#
									AND 	D1.ALW_DVSN_CD = #AlwDvsnCd#
								) D3
						GROUP BY D3.DPT_CD
						UNION ALL
						SELECT	A.DPT_CD, 
						        COUNT(A.CNB) AS CNT,
						        SUM(A.PMT_AM) AS TOTAL 
						   FROM TBCSPLFI104L A,
						        TBDCMACM001M B 
						  WHERE A.CNB = B.CNB 
						    AND PMT_YM = #toYm#
						    AND A.ALW_DVSN_CD = #AlwDvsnCd#
						  GROUP BY A.DPT_CD
			        )C 
			 WHERE A.CD= C.DPT_CD (+)
			   AND A.CD_NM LIKE '%' || NULL ||'%'
			 ORDER BY A.DPT_SNO ASC, A.SRT_SNO ASC, A.CD ASC
	 	]]>
	 </select>
	 
	<!-- 수당 실과별 지급목록 (기타) -->
	<select id="CSPLFI2419RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT 	A.CD_NM, 
					NVL(C.CNT1,0) AS CNT1,
			       	NVL(C.TOTAL1,0) AS TOTAL1,
			       	NVL(C.CNT2,0) AS CNT2,
			       	NVL(C.TOTAL2,0) AS TOTAL2,
			       	NVL(C.CNT3,0) AS CNT3,
			       	NVL(C.TOTAL3,0) AS TOTAL3,
			       	NVL(C.CNT4,0) AS CNT4,
			       	NVL(C.TOTAL4,0) AS TOTAL4,
			       	NVL(C.CNT1 + C.CNT2 + C.CNT3 + C.CNT4, 0) AS CNT5,
			       	NVL(C.TOTAL1 + C.TOTAL2 + C.TOTAL3 + C.TOTAL4, 0) AS TOTAL5
			       	,#toYm# as TOYM
			  FROM ( 
					SELECT A.CD
					     , B.ABR_DPT_NM_2 AS CD_NM /* 20181104 EUNOK CD_NM -> B.ABR_DPT_NM_2 */ 
					     , B.DPT_SNO
               		     , B.SRT_SNO
					  FROM TBDCMACM013C A,TBDCMACM002M B
					 WHERE A.CMM_CD_DVSN_CD = '1000144' 
					   AND A.CD <> '000000000'
					   AND A.USE_YN != 'N'
                       AND A.CD = B.DPT_CD
				   )A, 
				    ( 
						SELECT	D3.DPT_CD,
								COUNT(CASE WHEN D3.ALW_DVSN_CD = '9992' THEN D3.CNB END) AS CNT1,
					            SUM(CASE WHEN D3.ALW_DVSN_CD = '9992' THEN D3.PMT_AM ELSE 0 END) AS TOTAL1,
					            COUNT(CASE WHEN D3.ALW_DVSN_CD = '9993' THEN D3.CNB END) AS CNT2,
					            SUM(CASE WHEN D3.ALW_DVSN_CD = '9993' THEN D3.PMT_AM ELSE 0 END) AS TOTAL2,
					            COUNT(CASE WHEN D3.ALW_DVSN_CD = '9994' THEN D3.CNB END) AS CNT3,
					            SUM(CASE WHEN D3.ALW_DVSN_CD = '9994' THEN D3.PMT_AM ELSE 0 END) AS TOTAL3,
					            COUNT(CASE WHEN D3.ALW_DVSN_CD = '9995' THEN D3.CNB END) AS CNT4,
					            SUM(CASE WHEN D3.ALW_DVSN_CD = '9995' THEN D3.PMT_AM ELSE 0 END) AS TOTAL4
						FROM	(
									SELECT	SUBSTR(D1.DPT_CD, 1, 3) || '000' AS DPT_CD
											, 1 AS CNT
											, D1.PMT_AM AS TOTAL
											, D1.ALW_DVSN_CD
											, D1.CNB
											, D1.PMT_AM
									FROM	TBCSPLFI104L D1
											, TBDCMACM001M D2
									WHERE	D1.CNB = D2.CNB
									AND		D1.PMT_YM = #toYm#
									AND 	D1.ALW_DVSN_CD IN ('9992', '9993', '9994', '9995')
								) D3
						GROUP BY D3.DPT_CD
						UNION ALL
			          SELECT B.DPT_CD, 
						     SUM(CNT1) AS CNT1,
						     SUM(TOTAL1) AS TOTAL1,
						     SUM(CNT2) AS CNT2,
						     SUM(TOTAL2) AS TOTAL2,
						     SUM(CNT3) AS CNT3,
						     SUM(TOTAL3) AS TOTAL3,
						     SUM(CNT4) AS CNT4,
						     SUM(TOTAL4) AS TOTAL4
			            FROM( 
				             SELECT	A.DPT_CD, 
						            COUNT(CASE WHEN A.ALW_DVSN_CD = '9992' THEN A.CNB END) AS CNT1,
						            SUM(CASE WHEN A.ALW_DVSN_CD = '9992' THEN A.PMT_AM ELSE 0 END) AS TOTAL1,
						            COUNT(CASE WHEN A.ALW_DVSN_CD = '9993' THEN A.CNB END) AS CNT2,
						            SUM(CASE WHEN A.ALW_DVSN_CD = '9993' THEN A.PMT_AM ELSE 0 END) AS TOTAL2,
						            COUNT(CASE WHEN A.ALW_DVSN_CD = '9994' THEN A.CNB END) AS CNT3,
						            SUM(CASE WHEN A.ALW_DVSN_CD = '9994' THEN A.PMT_AM ELSE 0 END) AS TOTAL3,
						            COUNT(CASE WHEN A.ALW_DVSN_CD = '9995' THEN A.CNB END) AS CNT4,
						            SUM(CASE WHEN A.ALW_DVSN_CD = '9995' THEN A.PMT_AM ELSE 0 END) AS TOTAL4
				               FROM TBCSPLFI104L A,
				                    TBDCMACM001M B 
				              WHERE A.CNB = B.CNB 
				                AND PMT_YM = #toYm#
				                AND A.ALW_DVSN_CD IN ('9992', '9993', '9994', '9995')
				              GROUP BY A.DPT_CD
			                )B 
					       GROUP BY B.DPT_CD
			        )C 
			 WHERE A.CD= C.DPT_CD (+)
			   AND A.CD_NM LIKE '%' || #dptNm# ||'%'
			 ORDER BY A.DPT_SNO ASC, A.SRT_SNO ASC, A.CD ASC
	 	]]>
	 </select>
	 
	<!-- 수당 월별 지급목록 (월정직책급) -->
	<select id="CSPLFI2420RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT PMT_YM, 
			       COUNT(B.CNB) AS CNT1, 
			       NVL(SUM(A.PMT_AM),0) AS TOTAL1,
				  #fromYm# as FROMYM,
				  #toYm# as TOYM
			  FROM TBCSPLFI104L A, TBDCMACM001M B
			 WHERE A.CNB = B.CNB
			   AND PMT_YM BETWEEN #fromYm# AND #toYm#
			   AND A.ALW_DVSN_CD = #AlwDvsnCd#
			 GROUP BY PMT_YM
			 ORDER BY PMT_YM
	 	]]>
	 </select>
	 
	<!-- 수당 월별 지급목록 (모니터링활동비) -->
	<select id="CSPLFI2421RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT PMT_YM, 
			       COUNT(B.CNB) AS CNT1, 
			       NVL(SUM(A.PMT_AM), 0) AS TOTAL1,
				  #fromYm# as FROMYM,
				  #toYm# as TOYM
			  FROM TBCSPLFI104L A, TBDCMACM001M B
			 WHERE A.CNB = B.CNB
			   AND PMT_YM BETWEEN #fromYm# AND #toYm#
			   AND A.ALW_DVSN_CD = #AlwDvsnCd#
			 GROUP BY PMT_YM
			 ORDER BY PMT_YM
	 	]]>
	 </select>
	 
	<!-- 수당 월별 지급목록 (기타) -->
	<select id="CSPLFI2422RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT	A.PMT_YM,
					A.CNT2,
					A.TOTAL2,
					A.CNT3,
					A.TOTAL3,
					A.CNT4,
					A.TOTAL4,
					A.CNT5,
					A.TOTAL5,
					NVL(A.CNT2+A.CNT3+A.CNT4+A.CNT5, 0) AS CNT6,
					NVL(A.TOTAL2+A.TOTAL3+A.TOTAL4+A.TOTAL5, 0) AS TOTAL6,
					  #fromYm# as FROMYM,
					  #toYm# as TOYM
			  FROM (
					SELECT PMT_YM, 
					       COUNT(CASE WHEN A.ALW_DVSN_CD = '9992' THEN B.CNB END) AS CNT2,
					       NVL(SUM(CASE WHEN A.ALW_DVSN_CD = '9992' THEN PMT_AM END),0) AS TOTAL2,
					       
					       COUNT(CASE WHEN A.ALW_DVSN_CD = '9993' THEN B.CNB END) AS CNT3,
					       NVL(SUM(CASE WHEN A.ALW_DVSN_CD = '9993' THEN PMT_AM END),0) AS TOTAL3,
					       
					       COUNT(CASE WHEN A.ALW_DVSN_CD = '9994' THEN B.CNB END) AS CNT4,
					       NVL(SUM(CASE WHEN A.ALW_DVSN_CD = '9994' THEN PMT_AM END),0) AS TOTAL4,
					       
					       COUNT(CASE WHEN A.ALW_DVSN_CD = '9995' THEN B.CNB END) AS CNT5,
					       NVL(SUM(CASE WHEN A.ALW_DVSN_CD = '9995' THEN PMT_AM END),0) AS TOTAL5
					  FROM TBCSPLFI104L A, TBDCMACM001M B
					 WHERE A.CNB = B.CNB
					   AND PMT_YM BETWEEN #fromYm# AND #toYm#
					   AND A.ALW_DVSN_CD IN ('9992','9993','9994','9995')
					 GROUP BY PMT_YM
					 ORDER BY PMT_YM
			 		) A
	 	]]>
	 </select>
	 
	<!-- 수당 직급/직위별 지급목록(월정직책급) -->
	<select id="CSPLFI2423RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			 SELECT RANK_NM,
			        CNT,
			        TOTAL
			        ,#toYm# as TOYM
			   FROM ( SELECT NVL2(RANK_NM, RANK_NM,'합계') AS RANK_NM,
			                 SUM(CNT) CNT,
			                 SUM(TOTAL) TOTAL,
			                 MAX(ALW_RANK_CD) ALW_RANK_CD,
			                 MAX(A.ALW_PST_CD) ALW_PST_CD
			            FROM ( SELECT C.CD_NM ||DECODE(F_CODE_NM ('1000176', A.ALW_PST_CD), NULL, '','-') || F_CODE_NM ('1000176', A.ALW_PST_CD) AS RANK_NM,
			                          A.ALW_RANK_CD,
			                          A.ALW_PST_CD,
			                          CASE WHEN ALW_DVSN_CD = '9991' THEN 1 ELSE 0 END AS CNT,
			                          CASE WHEN ALW_DVSN_CD = '9991' THEN PMT_AM ELSE 0 END AS TOTAL
			                     FROM TBCSPLFI104L A,
			                          TBDCMACM001M B,
			                          TBDCMACM013C C
			                    WHERE 1=1
			                      AND A.PMT_YM =  #toYm#
			                      AND A.CNB = B.CNB
			                      AND A.ALW_RANK_CD IS NOT NULL
			                      AND C.CMM_CD_DVSN_CD = '1000173'
			                      AND A.ALW_RANK_CD = C.CD) A
			           GROUP BY ROLLUP (RANK_NM) ) A
			  ORDER BY DECODE(RANK_NM, '합계', '9999999999', A.ALW_RANK_CD) ASC,  A.ALW_PST_CD DESC
	 	]]>
	 </select>
	 
	<!-- 수당 직급/직위별 지급목록(모니터링활동비) -->
	<select id="CSPLFI2424RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			 SELECT RANK_NM,
			        CNT,
			        TOTAL
			        ,#toYm# as TOYM
			   FROM ( SELECT NVL2(RANK_NM, RANK_NM,'합계') AS RANK_NM,
			                 SUM(CNT) CNT,
			                 SUM(TOTAL) TOTAL,
			                 MAX(ALW_RANK_CD) ALW_RANK_CD,
			                 MAX(A.ALW_PST_CD) ALW_PST_CD
			            FROM ( SELECT C.CD_NM ||DECODE(F_CODE_NM ('1000176', A.ALW_PST_CD), NULL, '','-') || F_CODE_NM ('1000176', A.ALW_PST_CD) AS RANK_NM,
			                          A.ALW_RANK_CD,
			                          A.ALW_PST_CD,
			                          CASE WHEN ALW_DVSN_CD = '9992' THEN 1 ELSE 0 END AS CNT,
			                          CASE WHEN ALW_DVSN_CD = '9992' THEN PMT_AM ELSE 0 END AS TOTAL
			                     FROM TBCSPLFI104L A,
			                          TBDCMACM001M B,
			                          TBDCMACM013C C
			                    WHERE 1=1
			                      AND A.PMT_YM =  #toYm#
			                      AND A.CNB = B.CNB
			                      AND A.ALW_RANK_CD IS NOT NULL
			                      AND C.CMM_CD_DVSN_CD = '1000173'
			                      AND A.ALW_RANK_CD = C.CD) A
			           GROUP BY ROLLUP (RANK_NM) ) A
			  ORDER BY DECODE(RANK_NM, '합계', '9999999999', A.ALW_RANK_CD) ASC,  A.ALW_PST_CD DESC
	 	]]>
	 </select>
	 
	<!-- 수당 직급/직위별 지급목록(기타) -->
	<select id="CSPLFI2425RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			 SELECT RANK_NM,
			        CNT,
			        TOTAL,
			        CNT2,
			        TOTAL2,
			        CNT3,
			        TOTAL3,
			        CNT4,
			        TOTAL4,
			        CNT+CNT2+CNT3+CNT4 AS CNT5,
			        TOTAL+TOTAL2+TOTAL3+TOTAL4 AS TOTAL5
			        ,#toYm# as TOYM
			   FROM ( SELECT NVL2(RANK_NM, RANK_NM,'합계') AS RANK_NM,
			                 SUM(CNT) CNT,
			                 SUM(TOTAL) TOTAL,
			                 SUM(CNT2) CNT2,
			                 SUM(TOTAL2) TOTAL2,    
			                 SUM(CNT3) CNT3,
			                 SUM(TOTAL3) TOTAL3,
			                 SUM(CNT4) CNT4,
			                 SUM(TOTAL4) TOTAL4,             
			                 MAX(ALW_RANK_CD) ALW_RANK_CD,
			                 MAX(A.ALW_PST_CD) ALW_PST_CD
			            FROM ( SELECT C.CD_NM ||DECODE(F_CODE_NM ('1000176', A.ALW_PST_CD), NULL, '','-') || F_CODE_NM ('1000176', A.ALW_PST_CD) AS RANK_NM,
			                          A.ALW_RANK_CD,
			                          A.ALW_PST_CD,
			                          CASE WHEN ALW_DVSN_CD = '9992' THEN 1 ELSE 0 END AS CNT,
			                          CASE WHEN ALW_DVSN_CD = '9992' THEN PMT_AM ELSE 0 END AS TOTAL,
			                          CASE WHEN ALW_DVSN_CD = '9993' THEN 1 ELSE 0 END AS CNT2,
			                          CASE WHEN ALW_DVSN_CD = '9993' THEN PMT_AM ELSE 0 END AS TOTAL2,
			                          CASE WHEN ALW_DVSN_CD = '9994' THEN 1 ELSE 0 END AS CNT3,
			                          CASE WHEN ALW_DVSN_CD = '9994' THEN PMT_AM ELSE 0 END AS TOTAL3,
			                          CASE WHEN ALW_DVSN_CD = '9995' THEN 1 ELSE 0 END AS CNT4,
			                          CASE WHEN ALW_DVSN_CD = '9995' THEN PMT_AM ELSE 0 END AS TOTAL4
			                     FROM TBCSPLFI104L A,
			                          TBDCMACM001M B,
			                          TBDCMACM013C C
			                    WHERE 1=1
			                      AND A.PMT_YM = #toYm#
			                      AND A.CNB = B.CNB
			                      AND A.ALW_RANK_CD IS NOT NULL
			                      AND C.CMM_CD_DVSN_CD = '1000173'
			                      AND A.ALW_RANK_CD = C.CD) A
			           GROUP BY ROLLUP (RANK_NM) ) A
			  ORDER BY DECODE(RANK_NM, '합계', '9999999999', A.ALW_RANK_CD) ASC,  A.ALW_PST_CD DESC
	 	]]>
	 </select>
	 
	<!-- ~~년 월정직책급수당 지급내역 -->
	<select id="CSPLFI2426RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT E.ABR_DPT_NM_2 AS DPT, /* 20181104 EUNOK C.CD_NM -> E.ABR_DPT_NM_2 */ 
				 A.CNB,
			     B.USR_NAM,
			     B.USR_NAM || '(' || A.CNB || ')' AS NM,
			     MONTH1,MONTH2,MONTH3,MONTH4,MONTH5,MONTH6, 
			     MONTH7,MONTH8,MONTH9,MONTH10,MONTH11,MONTH12, 
			     (MONTH1+MONTH2+MONTH3+MONTH4+MONTH5+MONTH6+ 
			     MONTH7+MONTH8+MONTH9+MONTH10+MONTH11+MONTH12) AS TOTAL
			     ,#yyyy# as YYYY
			FROM (
				  SELECT CNB, 
				         DPT_CD,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'01' THEN PMT_AM END),0) AS MONTH1,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'02' THEN PMT_AM END),0) AS MONTH2,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'03' THEN PMT_AM END),0) AS MONTH3,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'04' THEN PMT_AM END),0) AS MONTH4,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'05' THEN PMT_AM END),0) AS MONTH5,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'06' THEN PMT_AM END),0) AS MONTH6,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'07' THEN PMT_AM END),0) AS MONTH7,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'08' THEN PMT_AM END),0) AS MONTH8,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'09' THEN PMT_AM END),0) AS MONTH9,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'10' THEN PMT_AM END),0) AS MONTH10,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'11' THEN PMT_AM END),0) AS MONTH11,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'12' THEN PMT_AM END),0) AS MONTH12
				    FROM TBCSPLFI104L 
				   WHERE ALW_DVSN_CD = #AlwDvsnCd#
				   GROUP BY CNB ,DPT_CD
					) A,
			    TBDCMACM001M B, 
			    TBDCMACM013C C,
			    TBDCMACM002M E
			WHERE A.CNB = B.CNB 
			AND B.USR_NAM LIKE  '%' || #name# ||'%'
			AND CMM_CD_DVSN_CD = '1000144' 
			AND A.DPT_CD = C.CD 
			AND A.DPT_CD = E.DPT_CD 
			ORDER BY E.DPT_SNO ASC, E.SRT_SNO ASC, A.DPT_CD ASC, B.INN_RANK_CD ASC, B. CRNT_RANK_APM_DT ASC
	 	]]>
	</select>
	 
	<!-- 년도별 개인 모니터링활동비 지급내역 -->
	<select id="CSPLFI2427RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT E.ABR_DPT_NM_2 AS DPT, /* 20181104 EUNOK C.CD_NM -> E.ABR_DPT_NM_2 */ 
				 A.CNB,
			     B.USR_NAM,
			     B.USR_NAM || '(' || A.CNB || ')' AS NM,
			     MONTH1,MONTH2,MONTH3,MONTH4,MONTH5,MONTH6, 
			     MONTH7,MONTH8,MONTH9,MONTH10,MONTH11,MONTH12, 
			     (MONTH1+MONTH2+MONTH3+MONTH4+MONTH5+MONTH6+ 
			     MONTH7+MONTH8+MONTH9+MONTH10+MONTH11+MONTH12) AS TOTAL
			     ,#yyyy# as YYYY 
			FROM (
				  SELECT CNB, 
				         DPT_CD,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'01' THEN PMT_AM END),0) AS MONTH1,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'02' THEN PMT_AM END),0) AS MONTH2,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'03' THEN PMT_AM END),0) AS MONTH3,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'04' THEN PMT_AM END),0) AS MONTH4,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'05' THEN PMT_AM END),0) AS MONTH5,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'06' THEN PMT_AM END),0) AS MONTH6,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'07' THEN PMT_AM END),0) AS MONTH7,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'08' THEN PMT_AM END),0) AS MONTH8,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'09' THEN PMT_AM END),0) AS MONTH9,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'10' THEN PMT_AM END),0) AS MONTH10,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'11' THEN PMT_AM END),0) AS MONTH11,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'12' THEN PMT_AM END),0) AS MONTH12
				    FROM TBCSPLFI104L 
				   WHERE ALW_DVSN_CD = #AlwDvsnCd#
				   GROUP BY CNB ,DPT_CD
					) A,
			    TBDCMACM001M B, 
			    TBDCMACM013C C,
			    TBDCMACM002M E
			WHERE A.CNB = B.CNB 
			AND B.USR_NAM LIKE  '%' || #name# ||'%'
			AND CMM_CD_DVSN_CD = '1000144' 
			AND A.DPT_CD = C.CD  
			AND A.DPT_CD = E.DPT_CD 
			ORDER BY E.DPT_SNO ASC, E.SRT_SNO ASC, A.DPT_CD ASC, B.INN_RANK_CD ASC, B. CRNT_RANK_APM_DT ASC
	 	]]>
	</select>
	
	<!-- 년도별 개인 모니터링활동비2 지급내역 -->
	<select id="CSPLFI2428RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT E.ABR_DPT_NM_2 AS DPT, /* 20181104 EUNOK C.CD_NM -> E.ABR_DPT_NM_2 */ 
				 A.CNB,
			     B.USR_NAM,
			     B.USR_NAM || '(' || A.CNB || ')' AS NM,
			     MONTH1,MONTH2,MONTH3,MONTH4,MONTH5,MONTH6, 
			     MONTH7,MONTH8,MONTH9,MONTH10,MONTH11,MONTH12, 
			     (MONTH1+MONTH2+MONTH3+MONTH4+MONTH5+MONTH6+ 
			     MONTH7+MONTH8+MONTH9+MONTH10+MONTH11+MONTH12) AS TOTAL 
			     ,#yyyy# as YYYY
			FROM (
				  SELECT CNB, 
				         DPT_CD,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'01' THEN PMT_AM END),0) AS MONTH1,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'02' THEN PMT_AM END),0) AS MONTH2,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'03' THEN PMT_AM END),0) AS MONTH3,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'04' THEN PMT_AM END),0) AS MONTH4,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'05' THEN PMT_AM END),0) AS MONTH5,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'06' THEN PMT_AM END),0) AS MONTH6,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'07' THEN PMT_AM END),0) AS MONTH7,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'08' THEN PMT_AM END),0) AS MONTH8,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'09' THEN PMT_AM END),0) AS MONTH9,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'10' THEN PMT_AM END),0) AS MONTH10,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'11' THEN PMT_AM END),0) AS MONTH11,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'12' THEN PMT_AM END),0) AS MONTH12
				    FROM TBCSPLFI104L 
				   WHERE ALW_DVSN_CD = #AlwDvsnCd#
				   GROUP BY CNB ,DPT_CD
					) A,
			    TBDCMACM001M B, 
			    TBDCMACM013C C, 
			    TBDCMACM002M E
			WHERE A.CNB = B.CNB 
			AND B.USR_NAM LIKE  '%' || #name# ||'%'
			AND CMM_CD_DVSN_CD = '1000144' 
			AND A.DPT_CD = C.CD 
			AND A.DPT_CD = E.DPT_CD 
			ORDER BY E.DPT_SNO ASC, E.SRT_SNO ASC, A.DPT_CD ASC, B.INN_RANK_CD ASC, B. CRNT_RANK_APM_DT ASC
	 	]]>
	</select>
	
	<!-- 년도별 개인 정보수집활동비 지급내역 -->
	<select id="CSPLFI2429RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT E.ABR_DPT_NM_2 AS DPT, /* 20181104 EUNOK C.CD_NM -> E.ABR_DPT_NM_2 */ 
				 A.CNB,
			     B.USR_NAM,
			     B.USR_NAM || '(' || A.CNB || ')' AS NM,
			     MONTH1,MONTH2,MONTH3,MONTH4,MONTH5,MONTH6, 
			     MONTH7,MONTH8,MONTH9,MONTH10,MONTH11,MONTH12, 
			     (MONTH1+MONTH2+MONTH3+MONTH4+MONTH5+MONTH6+ 
			     MONTH7+MONTH8+MONTH9+MONTH10+MONTH11+MONTH12) AS TOTAL
			     ,#yyyy# as YYYY
			FROM (
				  SELECT CNB, 
				         DPT_CD,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'01' THEN PMT_AM END),0) AS MONTH1,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'02' THEN PMT_AM END),0) AS MONTH2,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'03' THEN PMT_AM END),0) AS MONTH3,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'04' THEN PMT_AM END),0) AS MONTH4,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'05' THEN PMT_AM END),0) AS MONTH5,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'06' THEN PMT_AM END),0) AS MONTH6,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'07' THEN PMT_AM END),0) AS MONTH7,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'08' THEN PMT_AM END),0) AS MONTH8,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'09' THEN PMT_AM END),0) AS MONTH9,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'10' THEN PMT_AM END),0) AS MONTH10,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'11' THEN PMT_AM END),0) AS MONTH11,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'12' THEN PMT_AM END),0) AS MONTH12
				    FROM TBCSPLFI104L 
				   WHERE ALW_DVSN_CD = #AlwDvsnCd#
				   GROUP BY CNB ,DPT_CD
					) A,
			    TBDCMACM001M B, 
			    TBDCMACM013C C, 
			    TBDCMACM002M E 
			WHERE A.CNB = B.CNB 
			AND B.USR_NAM LIKE  '%' || #name# ||'%'
			AND CMM_CD_DVSN_CD = '1000144' 
			AND A.DPT_CD = C.CD  
			AND A.DPT_CD = E.DPT_CD 
			ORDER BY E.DPT_SNO ASC, E.SRT_SNO ASC, A.DPT_CD ASC, B.INN_RANK_CD ASC, B. CRNT_RANK_APM_DT ASC
	 	]]>
	</select>
	
	<!-- 년도별 개인 기타 지급내역 -->
	<select id="CSPLFI2430RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT E.ABR_DPT_NM_2 AS DPT, /* 20181104 EUNOK C.CD_NM -> E.ABR_DPT_NM_2 */ 
				 A.CNB,
			     B.USR_NAM,
			     B.USR_NAM || '(' || A.CNB || ')' AS NM,
			     MONTH1,MONTH2,MONTH3,MONTH4,MONTH5,MONTH6, 
			     MONTH7,MONTH8,MONTH9,MONTH10,MONTH11,MONTH12, 
			     (MONTH1+MONTH2+MONTH3+MONTH4+MONTH5+MONTH6+ 
			     MONTH7+MONTH8+MONTH9+MONTH10+MONTH11+MONTH12) AS TOTAL
			     ,#yyyy# as YYYY
			FROM (
				  SELECT CNB, 
				         DPT_CD,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'01' THEN PMT_AM END),0) AS MONTH1,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'02' THEN PMT_AM END),0) AS MONTH2,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'03' THEN PMT_AM END),0) AS MONTH3,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'04' THEN PMT_AM END),0) AS MONTH4,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'05' THEN PMT_AM END),0) AS MONTH5,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'06' THEN PMT_AM END),0) AS MONTH6,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'07' THEN PMT_AM END),0) AS MONTH7,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'08' THEN PMT_AM END),0) AS MONTH8,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'09' THEN PMT_AM END),0) AS MONTH9,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'10' THEN PMT_AM END),0) AS MONTH10,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'11' THEN PMT_AM END),0) AS MONTH11,
				         NVL(SUM(CASE WHEN PMT_YM = #yyyy# ||'12' THEN PMT_AM END),0) AS MONTH12
				    FROM TBCSPLFI104L 
				   WHERE ALW_DVSN_CD = #AlwDvsnCd#
				   GROUP BY CNB ,DPT_CD
					) A,
			    TBDCMACM001M B, 
			    TBDCMACM013C C, 
			    TBDCMACM002M E 
			WHERE A.CNB = B.CNB 
			AND B.USR_NAM LIKE  '%' || #name# ||'%'
			AND CMM_CD_DVSN_CD = '1000144' 
			AND A.DPT_CD = C.CD
			AND A.DPT_CD = E.DPT_CD 
			ORDER BY E.DPT_SNO ASC, E.SRT_SNO ASC, A.DPT_CD ASC, B.INN_RANK_CD ASC, B. CRNT_RANK_APM_DT ASC
	 	]]>
	</select>
	
	<!-- 년도별 실국별 월정직책급 지급내역 -->
	<select id="CSPLFI2431RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT CD,CD_NM,
				   CNT1, MONTH1, CNT2, MONTH2, 
			       CNT3, MONTH3, CNT4,MONTH4, CNT5, MONTH5,CNT6, MONTH6, 
			       CNT7, MONTH7, CNT8, MONTH8, CNT9, MONTH9, CNT10, MONTH10, 
			       CNT11, MONTH11, CNT12, MONTH12, CNTTOTAL,TOTAL,#yyyy# as YYYY
			  FROM( 
			        SELECT substring(A.CD,1,3) AS CD
			             , B.ABR_DPT_NM_2 AS CD_NM /* 20181104 EUNOK CD_NM -> E.ABR_DPT_NM_2 */ 
			             , B.DPT_SNO
                         , B.SRT_SNO
			        FROM TBDCMACM013C A, TBDCMACM002M B 
			        WHERE A.CMM_CD_DVSN_CD = '1000144' 
			        AND (A.CD LIKE '___000' OR  A.CD ='770770') 
			        AND A.USE_YN ='Y'
			        AND A.CD = B.DPT_CD 
			       ) a, 
			     (SELECT substring(DPT_CD,1,3) AS DPT_CD, SUM(CNT1) AS CNT1,SUM(MONTH1) MONTH1, 
			     		SUM(CNT2) AS CNT2, SUM(MONTH2) AS MONTH2, SUM(CNT3) AS CNT3 ,SUM(MONTH3) AS  MONTH3, 
			            SUM(CNT4) AS CNT4, SUM(MONTH4) AS MONTH4, SUM(CNT5) AS CNT5, SUM(MONTH5) AS  MONTH5, 
			            SUM(CNT6) AS CNT6, SUM(MONTH6) AS MONTH6, SUM(CNT7) AS CNT7, SUM(MONTH7) AS  MONTH7, 
			            SUM(CNT8) AS CNT8 ,SUM(MONTH8) AS MONTH8, SUM(CNT9) AS CNT9, SUM(MONTH9) AS  MONTH9, 
			            SUM(CNT10) AS CNT10,SUM(MONTH10) AS MONTH10,SUM(CNT11) AS CNT11, SUM(MONTH11) AS MONTH11, 
			            SUM(CNT12) AS CNT12, SUM(MONTH12) AS MONTH12, 
			            SUM(CNT1+CNT2+CNT3+CNT4+CNT5+CNT6+CNT7+CNT8+CNT9+CNT10+CNT11+CNT12) AS CNTTOTAL, 
			            SUM(MONTH1+MONTH2+MONTH3+MONTH4+MONTH5+MONTH6+ 
			            MONTH7+MONTH8+MONTH9+MONTH10+MONTH11+MONTH12) AS TOTAL 
			        FROM (
			              SELECT DPT_CD, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'01' THEN CNB END) as CNT1, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'01' THEN PMT_AM END),0) as MONTH1, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'02' THEN CNB END) as CNT2, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'02' THEN PMT_AM END),0) as MONTH2, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'03' THEN CNB END) as CNT3, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'03' THEN PMT_AM END),0) as MONTH3, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'04' THEN CNB END) as CNT4, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'04' THEN PMT_AM END),0) as MONTH4, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'05' THEN CNB END) as CNT5, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'05' THEN PMT_AM END),0) as MONTH5, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'06' THEN CNB END) as CNT6, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'06' THEN PMT_AM END),0) as MONTH6, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'07' THEN CNB END) as CNT7, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'07' THEN PMT_AM END),0) as MONTH7, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'08' THEN CNB END) as CNT8, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'08' THEN PMT_AM END),0) as MONTH8, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'09' THEN CNB END) as CNT9, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'09' THEN PMT_AM END),0) as MONTH9, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'10' THEN CNB END) as CNT10, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'10' THEN PMT_AM END),0) as MONTH10, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'11' THEN CNB END) as CNT11, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'11' THEN PMT_AM END),0) as MONTH11, 
			                     COUNT(CASE WHEN PMT_YM = #yyyy#||'12' THEN CNB END) as CNT12, 
			                     NVL(SUM(CASE WHEN PMT_YM = #yyyy#||'12' THEN PMT_AM END),0) as MONTH12 
			               FROM TBCSPLFI104L 
			               WHERE ALW_DVSN_CD = #AlwDvsnCd#  
			               GROUP BY DPT_CD 
			              )
			        GROUP BY substring(DPT_CD,1,3)
			        ) b 
			WHERE substring(CD,1,3)= substring(DPT_CD,1,3)
			ORDER BY a.DPT_SNO ASC, a.SRT_SNO ASC
	 	]]>
	</select>
	
	<!-- 년도별 직위/직급별 지급내역 -->
	<select id="CSPLFI2436RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			 SELECT B.CD_NM ||DECODE(F_CODE_NM ('1000176', A.ALW_PST_CD), NULL, '','-') || F_CODE_NM ('1000176', A.ALW_PST_CD) AS ALW_RANK_CD,
			        CNT1,MONTH1,
			   		CNT2,MONTH2,
			   		CNT3,MONTH3,
			        CNT4,MONTH4,
			        CNT5,MONTH5,
			        CNT6,MONTH6,
			        CNT7,MONTH7,
			        CNT8,MONTH8,
			        CNT9,MONTH9,
			        CNT10,MONTH10,
			        CNT11,MONTH11,
			        CNT12,MONTH12,
			        (CNT1+CNT2+CNT3+CNT4+CNT5+CNT6+CNT7+CNT8+CNT9+CNT10+CNT11+CNT12) AS CNTTOTAL,
			        (MONTH1+MONTH2+MONTH3+MONTH4+MONTH5+MONTH6+ 
			        MONTH7+MONTH8+MONTH9+MONTH10+MONTH11+MONTH12) AS TOTAL
			        ,#yyyy# as YYYY
			  FROM (
			        SELECT ALW_RANK_CD,ALW_PST_CD,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '01' THEN CNB END) AS CNT1,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '01' THEN PMT_AM END),0) AS MONTH1,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '02' THEN CNB END) AS CNT2,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '02' THEN PMT_AM END),0) AS MONTH2,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '03' THEN CNB END) AS CNT3,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '03' THEN PMT_AM END),0) AS MONTH3,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '04' THEN CNB END) AS CNT4,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '04' THEN PMT_AM END),0) AS MONTH4,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '05' THEN CNB END) AS CNT5,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '05' THEN PMT_AM END),0) AS MONTH5,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '06' THEN CNB END) AS CNT6,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '06' THEN PMT_AM END),0) AS MONTH6,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '07' THEN CNB END) AS CNT7,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '07' THEN PMT_AM END),0) AS MONTH7,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '08' THEN CNB END) AS CNT8,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '08' THEN PMT_AM END),0) AS MONTH8,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '09' THEN CNB END) AS CNT9,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '09' THEN PMT_AM END),0) AS MONTH9,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '10' THEN CNB END) AS CNT10,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '10' THEN PMT_AM END),0) AS MONTH10,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '11' THEN CNB END) AS CNT11,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '11' THEN PMT_AM END),0) AS MONTH11,
			               COUNT(CASE WHEN PMT_YM = #yyyy# || '12' THEN CNB END) AS CNT12,
			               NVL(SUM(CASE WHEN PMT_YM = #yyyy# || '12' THEN PMT_AM END),0) AS MONTH12
			          FROM TBCSPLFI104L 
			         WHERE ALW_DVSN_CD = #AlwDvsnCd#
			         GROUP BY ALW_RANK_CD,ALW_PST_CD 
			        ) A,
			       TBDCMACM013C B
			 WHERE B.CMM_CD_DVSN_CD = '1000173' 
			   AND B.CD = A.ALW_RANK_CD 
			 ORDER BY B.CD_NM ASC,ALW_RANK_CD DESC 
	 	]]>
	</select>
	
	
	<select id="CSPLFI2441RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		/**
		 *	개인별 직책수행경비 지급내역 - 9991
		 *  개인별 모니터링활동비 지급내역 - 9992
		 *  개인별 모니터링활동비2 지급내내역 - 9993
		 */
		SELECT	D2.DPT_CD
				, D3.ABR_DPT_NM_2 AS DPT_NM /* 20181104 EUNOK  D3.DPT_NM -> D3.ABR_DPT_NM_2 변경 */
				, D2.RANK_CD
				, D4.CD_NM AS ALW_RANK_CD_NM
				, D1.CNB
				, D2.USR_NAM
				, D5.CD_NM AS ALW_DVSN_CD_NM
				, D1.ALW_DVSN_CD
				, D1.ALW_AM
				, '1' AS CNT
		FROM	TBCSPLFI102M D1
				, TBDCMACM001M D2
				, TBDCMACM002M D3
				, ( SELECT CD, CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' ) AS D4
				, ( SELECT CD, CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000145' ) AS D5
		WHERE	D1.CNB = D2.CNB
		AND		D2.DPT_CD = D3.DPT_CD
		AND		D2.RANK_CD = D4.CD
		AND		D1.ALW_DVSN_CD = D5.CD
		AND		D1.ALW_DVSN_CD = #AlwDvsnCd#
		]]>

		<dynamic>
			<isNotEmpty property="dptCd">
				AND		D2.DPT_CD = #dptCd#			
			</isNotEmpty>
			<isNotEmpty property="cnb">
				AND		D2.CNB = #cnb#
			</isNotEmpty>
		</dynamic>

		<![CDATA[
		AND		D2.DPT_CD != '880880'
		AND		( D2.RSG_DT IS NULL OR D2.RSG_DT = '')
		AND		D1.ALW_AM > 0
		AND		D2.BAI_USR_YN = 'Y'
		ORDER BY D3.DPT_SNO, D3.SRT_SNO, DPT_CD, RANK_CD, CNB
	 	]]>
	</select>
	
	<select id="CSPLFI2443RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
		SELECT	D2.DPT_CD
				, D3.DPT_NM
				, D4.CD_NM AS ALW_RANK_CD_NM
				, D1.CNB
				, D2.USR_NAM
				, MAX(DECODE(D1.ALW_DVSN_CD, '9993', D1.ALW_AM, 0)) AS ALW_AM
				, '모니터링활동비Ⅱ' AS ALW_DVSN_CD_NM
				, '1' AS CNT
		FROM	TBCSPLFI102M D1
				, TBDCMACM001M D2
				, (
					SELECT	DISTINCT D11.DPT_CD
							, D11.ABR_DPT_NM_2 AS DPT_NM /* 20181104 EUNOK  D11.DPT_NM -> D11.ABR_DPT_NM_2 변경*/
							, D11.DPT_SNO
							, D11.SRT_SNO
					FROM	TBDCMACM002M D11
							, TBDCMACM001M D12
					WHERE	D11.DPT_CD = D12.DPT_CD
					AND		D12.DPT_CD != '880880'
					AND		D12.BAI_USR_YN = 'Y'
					AND		D11.USE_YN = 'Y'
					AND		( D12.RSG_DT IS NULL OR D12.RSG_DT = '')
					AND		D12.CNB IN ( SELECT CNB FROM TBCSPLFI102M WHERE ALW_DVSN_CD IN ( '9992', '9993' ) AND ALW_AM > 0 )
					ORDER BY DPT_CD
				) D3
				, ( SELECT CD, CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' ) AS D4
		WHERE	D1.CNB = D2.CNB
		AND		D2.DPT_CD = D3.DPT_CD
				AND		D2.RANK_CD = D4.CD
				AND		D1.ALW_DVSN_CD IN ( '9992', '9993' )
				AND		D2.DPT_CD != '880880'
				AND		( D2.RSG_DT IS NULL OR D2.RSG_DT = '')
				AND		D2.BAI_USR_YN != 'N'
				AND		D1.ALW_AM > 0 
		]]>		
		<dynamic>
			<isNotEmpty property="dptCd">
				AND		D3.DPT_CD = #dptCd#
			</isNotEmpty>
			<isNotEmpty property="cnb">
				AND		D2.CNB = #cnb#
			</isNotEmpty>
				
		</dynamic>
		<![CDATA[		
				GROUP BY D2.DPT_CD
						, D3.DPT_NM
						, D3.DPT_SNO
       					, D3.SRT_SNO
						, D2.RANK_CD
						, D4.CD_NM
						, D1.CNB
						, D2.USR_NAM
				ORDER BY D3.DPT_SNO, D3.SRT_SNO, DPT_CD, RANK_CD, CNB
	 	]]>
	</select>
	
	<select id="CSPLFI2444RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			/**
			 *	개인별 정보수집활동비 지급내역
			 */
			SELECT	D2.DPT_CD
					, D3.DPT_NM
					, D4.CD_NM AS RANK_CD_NM
					, D1.CNB
					, D2.USR_NAM  
					, MAX(DECODE(D1.ALW_DVSN_CD, '9994', D1.ALW_AM, 0)) AS ALW_AM_9994
					, MAX(DECODE(D1.ALW_DVSN_CD, '9995', D1.ALW_AM, 0)) AS ALW_AM_9995
					, MAX(DECODE(D1.ALW_DVSN_CD, '9994', D1.ALW_AM, 0))
					  + MAX(DECODE(D1.ALW_DVSN_CD, '9995', D1.ALW_AM, 0)) AS ALW_AM_SUM
					, '1' AS CNT
			FROM	TBCSPLFI102M D1
					, TBDCMACM001M D2
					, (
						SELECT	DISTINCT D11.DPT_CD
								, D11.ABR_DPT_NM_2 AS DPT_NM /* 20181104 EUNOK  D11.DPT_NM -> D11.ABR_DPT_NM_2 변경*/
								, D11.DPT_SNO
               					, D11.SRT_SNO
						FROM	TBDCMACM002M D11
								, TBDCMACM001M D12
						WHERE	D11.DPT_CD = D12.DPT_CD
						AND		D12.DPT_CD != '880880'
						AND		D12.BAI_USR_YN = 'Y'
						AND		D11.USE_YN = 'Y'
						AND		( D12.RSG_DT IS NULL OR D12.RSG_DT = '')
						AND		D12.CNB IN ( SELECT CNB FROM TBCSPLFI102M WHERE ALW_DVSN_CD IN ( '9994', '9995' ) AND ALW_AM > 0 )
						ORDER BY DPT_SNO, SRT_SNO, DPT_CD
					) D3
					, ( SELECT CD, CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' ) AS D4
			WHERE	D1.CNB = D2.CNB
			AND		D2.DPT_CD = D3.DPT_CD
			AND		D2.RANK_CD = D4.CD
			AND		D1.ALW_DVSN_CD IN ( '9994', '9995' )
			AND		D2.DPT_CD != '880880'
			AND		( D2.RSG_DT IS NULL OR D2.RSG_DT = '')
			AND		D2.BAI_USR_YN != 'N'
			AND		D1.ALW_AM > 0 
		
		]]>		
		<dynamic>
			<isNotEmpty property="dptCd">
				AND		D3.DPT_CD = #dptCd#
			</isNotEmpty>
			<isNotEmpty property="cnb">
				AND		D2.CNB = #cnb#
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		
			GROUP BY D2.DPT_CD
					, D3.DPT_NM
					, D3.DPT_SNO
       				, D3.SRT_SNO
					, D2.RANK_CD
					, D4.CD_NM
					, D1.CNB
					, D2.USR_NAM
			ORDER BY D3.DPT_SNO, D3.SRT_SNO, DPT_CD, RANK_CD, CNB
	 	]]>
	</select>
	
	<select id="CSPLFI2445RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			/** 개인별 직책수행경비/정보자료수집활동비 지급내역
			 */
			SELECT	D2.DPT_CD
					, D3.DPT_NM
					, D4.CD_NM AS RANK_CD_NM
					, D1.CNB
					, D2.USR_NAM
					, MAX(DECODE(D1.ALW_DVSN_CD, '9991', D1.ALW_AM, 0)) AS ALW_AM_9991
					, MAX(DECODE(D1.ALW_DVSN_CD, '9994', D1.ALW_AM, 0)) AS ALW_AM_9994
					, MAX(DECODE(D1.ALW_DVSN_CD, '9995', D1.ALW_AM, 0)) AS ALW_AM_9995
					, MAX(DECODE(D1.ALW_DVSN_CD, '9994', D1.ALW_AM, 0))
					  + MAX(DECODE(D1.ALW_DVSN_CD, '9995', D1.ALW_AM, 0)) AS ALW_AM_9994_9995_SUM
					, MAX(DECODE(D1.ALW_DVSN_CD, '9991', D1.ALW_AM, 0))
					  + MAX(DECODE(D1.ALW_DVSN_CD, '9994', D1.ALW_AM, 0))
					  + MAX(DECODE(D1.ALW_DVSN_CD, '9995', D1.ALW_AM, 0)) AS ALW_AM_SUM
					, '1' AS CNT
			FROM	TBCSPLFI102M D1
					, TBDCMACM001M D2
					, (
						SELECT	DISTINCT D11.DPT_CD
								, D11.ABR_DPT_NM_2 AS DPT_NM /* 20181104 EUNOK  D11.DPT_NM -> D11.ABR_DPT_NM_2 변경*/
								, D11.DPT_SNO
               					, D11.SRT_SNO
						FROM	TBDCMACM002M D11
								, TBDCMACM001M D12
						WHERE	D11.DPT_CD = D12.DPT_CD
						AND		D12.DPT_CD != '880880'
						AND		D12.BAI_USR_YN = 'Y'
						AND		D11.USE_YN = 'Y'
						AND		( D12.RSG_DT IS NULL OR D12.RSG_DT = '')
						AND		D12.CNB IN ( SELECT CNB FROM TBCSPLFI102M WHERE ALW_DVSN_CD IN ( '9991', '9994', '9995' ) AND ALW_AM > 0 )
						ORDER BY DPT_CD
					) D3
					, ( SELECT CD, CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' ) AS D4
			WHERE	D1.CNB = D2.CNB
			AND		D2.DPT_CD = D3.DPT_CD
			AND		D2.RANK_CD = D4.CD
			AND		D1.ALW_DVSN_CD IN ( '9991', '9994', '9995' )
			AND		D2.DPT_CD != '880880'
			AND		( D2.RSG_DT IS NULL OR D2.RSG_DT = '')
			AND		D2.BAI_USR_YN != 'N'
			AND		D1.ALW_AM > 0
		
		]]>		
		<dynamic>
			<isNotEmpty property="dptCd">
				AND		D3.DPT_CD = #dptCd#
			</isNotEmpty>
			<isNotEmpty property="cnb">
				AND		D2.CNB = #cnb#
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		
			GROUP BY D2.DPT_CD
					, D3.DPT_NM
					, D3.DPT_SNO
					, D3.SRT_SNO
					, D2.RANK_CD
					, D4.CD_NM
					, D1.CNB
					, D2.USR_NAM
			ORDER BY D3.DPT_SNO, D3.SRT_SNO, DPT_CD, RANK_CD, CNB
	 	]]>
	</select>
	
	<select id="CSPLFI2446RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			/**
			 *  실국별 직책수행경비 수당 합계액
			 */
			SELECT	D3.DPT_CD
					, D4.DPT_NM
					, D3.CNT
					, D3.ALW_AM_SUM
			FROM	(
						SELECT	SUBSTR(D2.DPT_CD, 1, 3) || '000' AS DPT_CD
								, COUNT(D1.CNB) AS CNT
								, NVL(SUM(D1.ALW_AM),0) AS ALW_AM_SUM
						FROM	TBCSPLFI102M D1
								, TBDCMACM001M D2
						WHERE	D1.CNB = D2.CNB
						AND		D1.ALW_DVSN_CD = '9991'
						AND		( D2.RSG_DT IS NULL OR D2.RSG_DT = '')
						AND		D2.DPT_CD != '880880'
						AND		D2.BAI_USR_YN != 'N'
						AND		D1.ALW_AM > 0
						GROUP BY SUBSTR(D2.DPT_CD, 1, 3)
					) D3
					, (
						SELECT	SUBSTR(D1.DPT_CD, 1, 3) || '000' AS DPT_CD
								, D1.ABR_DPT_NM_2 AS DPT_NM  /* 20181104 EUNOK  D1.DPT_NM -> D1.ABR_DPT_NM_2 변경*/
								, D1.DPT_SNO
								, D1.SRT_SNO
						FROM	TBDCMACM002M D1
						WHERE	( D1.DPT_CD LIKE '___000' OR D1.DPT_CD = '770770' )
					) D4
			WHERE	D3.DPT_CD = D4.DPT_CD
			ORDER BY D4.DPT_SNO, D4.SRT_SNO, DPT_CD
	 	]]>
	</select>
	
	<select id="CSPLFI2447RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			/**
			 *	실국별 모니터링활동비 수당 합계액
			 */
			SELECT	D3.DPT_CD
					, DECODE(D4.DPT_CD, '770000', '파견자', D4.DPT_NM ) AS DPT_NM
					, D3.CNT
					, D3.ALW_AM_SUM
			FROM	(
						SELECT	SUBSTR(D2.DPT_CD, 1, 3) || '000' AS DPT_CD
								, SUM(CASE WHEN D1.ALW_AM > 0 THEN 1 ELSE 0 END) AS CNT
								, NVL(SUM(D1.ALW_AM),0) AS ALW_AM_SUM
						FROM	TBCSPLFI102M D1
								, TBDCMACM001M D2
						WHERE	D1.CNB = D2.CNB
						AND		D1.ALW_DVSN_CD = '9992'
						AND		( D2.RSG_DT IS NULL OR D2.RSG_DT = '')
						AND		D2.DPT_CD != '880880'
						AND		D2.BAI_USR_YN != 'N'
						GROUP BY SUBSTR(D2.DPT_CD, 1, 3)
					) D3
					, (
						SELECT	SUBSTR(D1.DPT_CD, 1, 3) || '000' AS DPT_CD
								, D1.ABR_DPT_NM_2 AS DPT_NM  /* 20181104 EUNOK  D1.DPT_NM -> D1.ABR_DPT_NM_2 변경*/
								, D1.DPT_SNO
								, D1.SRT_SNO
						FROM	TBDCMACM002M D1
						WHERE	( D1.DPT_CD LIKE '___000' OR D1.DPT_CD = '770770' )
					) D4
			WHERE	D3.DPT_CD = D4.DPT_CD
			ORDER BY D4.DPT_SNO, D4.SRT_SNO, DPT_CD
	 	]]>
	</select>
	
	<select id="CSPLFI2448RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			/**
			 *	실국별 모니터링활동비2 수당 합계액
			 */
			SELECT	D3.DPT_CD
					, DECODE(D4.DPT_CD, '770000', '파견자', D4.DPT_NM ) AS DPT_NM
					, D3.CNT
					, D3.ALW_AM_SUM
			FROM	(
						SELECT	SUBSTR(D2.DPT_CD, 1, 3) || '000' AS DPT_CD
								, SUM(CASE WHEN D1.ALW_AM > 0 THEN 1 ELSE 0 END) AS CNT
								, SUM(D1.ALW_AM) AS ALW_AM_SUM
						FROM	TBCSPLFI102M D1
								, TBDCMACM001M D2
						WHERE	D1.CNB = D2.CNB
						AND		D1.ALW_DVSN_CD = '9993'
						AND		( D2.RSG_DT IS NULL OR D2.RSG_DT = '')
						AND		D2.DPT_CD != '880880'
						AND		D2.BAI_USR_YN != 'N'
						GROUP BY SUBSTR(D2.DPT_CD, 1, 3)
					) D3
					, (
						SELECT	SUBSTR(D1.DPT_CD, 1, 3) || '000' AS DPT_CD
								, D1.ABR_DPT_NM_2 AS DPT_NM /* 20181104 EUNOK  D1.DPT_NM -> D1.ABR_DPT_NM_2 변경*/
								, D1.DPT_SNO
								, D1.SRT_SNO
						FROM	TBDCMACM002M D1
						WHERE	( D1.DPT_CD LIKE '___000' OR D1.DPT_CD = '770770' )
					) D4
			WHERE	D3.DPT_CD = D4.DPT_CD
			ORDER BY D4.DPT_SNO, D4.SRT_SNO, DPT_CD
	 	]]>
	</select>
	
	<select id="CSPLFI2449RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			/**
			 *	실국별 정보수집활동비 수당 합계액
			 */
			SELECT	D3.DPT_CD
					, DECODE(D4.DPT_CD, '770000', '파견자', D4.DPT_NM ) AS DPT_NM
					, NVL(D3.CNT_9994,0) AS CNT_9994 ,
				       NVL(D3.ALW_AM_9994_SUM,0) AS ALW_AM_9994_SUM ,
				       NVL(D3.CNT_9995,0) AS CNT_9995 ,
				       NVL(D3.ALW_AM_9995_SUM,0) AS ALW_AM_9995_SUM ,
				       NVL(D3.CNT_9994 + D3.CNT_9995,0) AS CNT_SUM ,
				       NVL(D3.ALW_AM_9994_SUM + D3.ALW_AM_9995_SUM,0) AS ALW_AM_SUM
			FROM	(
						SELECT	SUBSTR(D2.DPT_CD, 1, 3) || '000' AS DPT_CD
								, SUM(CASE WHEN D1.ALW_DVSN_CD = '9994' AND D1.ALW_AM > 0 THEN 1 ELSE 0 END) AS CNT_9994
								, SUM(CASE WHEN D1.ALW_DVSN_CD = '9995' AND D1.ALW_AM > 0 THEN 1 ELSE 0 END) AS CNT_9995
								, SUM(DECODE(D1.ALW_DVSN_CD, '9994', D1.ALW_AM, 0)) AS ALW_AM_9994_SUM 
								, SUM(DECODE(D1.ALW_DVSN_CD, '9995', D1.ALW_AM, 0)) AS ALW_AM_9995_SUM 
						FROM	TBCSPLFI102M D1
								, TBDCMACM001M D2
						WHERE	D1.CNB = D2.CNB
						AND		D1.ALW_DVSN_CD IN ( '9994', '9995' )
						AND		( D2.RSG_DT IS NULL OR D2.RSG_DT = '')
						AND		D2.DPT_CD != '880880'
						AND		D2.BAI_USR_YN != 'N'
						GROUP BY SUBSTR(D2.DPT_CD, 1, 3)
					) D3
					, (
						SELECT	SUBSTR(D1.DPT_CD, 1, 3) || '000' AS DPT_CD
								, D1.ABR_DPT_NM_2 AS DPT_NM /* 20181104 EUNOK  D1.DPT_NM -> D1.ABR_DPT_NM_2 변경*/
								, D1.DPT_SNO
								, D1.SRT_SNO
						FROM	TBDCMACM002M D1
						WHERE	( D1.DPT_CD LIKE '___000' OR D1.DPT_CD = '770770' )
						AND		D1.USE_YN = 'Y'
					) D4
			WHERE	D3.DPT_CD = D4.DPT_CD
			ORDER BY D4.DPT_SNO, D4.SRT_SNO, DPT_CD
	 	]]>
	</select>
	
	<select id="CSPLFI2450RselectReport" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			/**
			 *	실국별 직책수행경비/정보자료수집활동비 수당 합계액
			 */
			SELECT	D3.DPT_CD
					, DECODE(D4.DPT_CD, '770000', '파견자', D4.DPT_NM ) AS DPT_NM
					, D3.CNT_9991
					, D3.ALW_AM_9991_SUM
					, D3.CNT_9994
					, D3.ALW_AM_9994_SUM
					, D3.CNT_9995
					, D3.ALW_AM_9995_SUM
					, D3.CNT_9994 + D3.CNT_9995 AS CNT_9994_9995_SUM
					, D3.ALW_AM_9994_SUM + D3.ALW_AM_9995_SUM AS ALW_AM_9994_9995_SUM
					, D3.CNT_9991 + D3.CNT_9994 + D3.CNT_9995 AS CNT_SUM
					, D3.ALW_AM_9991_SUM + D3.ALW_AM_9994_SUM + D3.ALW_AM_9995_SUM AS ALW_AM_SUM
			FROM	(
						SELECT	SUBSTR(D2.DPT_CD, 1, 3) || '000' AS DPT_CD
								, SUM(CASE WHEN D1.ALW_DVSN_CD = '9991' AND D1.ALW_AM > 0 THEN 1 ELSE 0 END) AS CNT_9991
								, SUM(CASE WHEN D1.ALW_DVSN_CD = '9994' AND D1.ALW_AM > 0 THEN 1 ELSE 0 END) AS CNT_9994
								, SUM(CASE WHEN D1.ALW_DVSN_CD = '9995' AND D1.ALW_AM > 0 THEN 1 ELSE 0 END) AS CNT_9995
								, SUM(DECODE(D1.ALW_DVSN_CD, '9991', D1.ALW_AM, 0)) AS ALW_AM_9991_SUM 
								, SUM(DECODE(D1.ALW_DVSN_CD, '9994', D1.ALW_AM, 0)) AS ALW_AM_9994_SUM 
								, SUM(DECODE(D1.ALW_DVSN_CD, '9995', D1.ALW_AM, 0)) AS ALW_AM_9995_SUM 
						FROM	TBCSPLFI102M D1
								, TBDCMACM001M D2
						WHERE	D1.CNB = D2.CNB
						AND		D1.ALW_DVSN_CD IN ( '9991', '9994', '9995' )
						AND		( D2.RSG_DT IS NULL OR D2.RSG_DT = '')
						AND		D2.DPT_CD != '880880'
						AND		D2.BAI_USR_YN != 'N'
						GROUP BY SUBSTR(D2.DPT_CD, 1, 3)
					) D3
					, (
						SELECT	SUBSTR(D1.DPT_CD, 1, 3) || '000' AS DPT_CD
								, D1.ABR_DPT_NM_2 AS DPT_NM /* 20181104 EUNOK  D1.DPT_NM -> D1.ABR_DPT_NM_2 변경*/
								, D1.DPT_SNO
								, D1.SRT_SNO
						FROM	TBDCMACM002M D1
						WHERE	( D1.DPT_CD LIKE '___000' OR D1.DPT_CD = '770770' )
						AND		D1.USE_YN = 'Y'
					) D4
			WHERE	D3.DPT_CD = D4.DPT_CD
			ORDER BY D4.DPT_SNO, D4.SRT_SNO, DPT_CD
	 	]]>
	</select>
 
</sqlMap> 
