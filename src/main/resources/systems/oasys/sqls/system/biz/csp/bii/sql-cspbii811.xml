<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="csp/bii/811">

	<!-- GCC연계 기관 목록 조회-->
	<select id="CSPBII811QMainSelect" parameterClass="paramMap" resultClass="resultMap">
		<![CDATA[
			SELECT F_CODE_NM('1000401', A.MTRL_KND_CD)           AS MTRL_KND_NM /* 자료종류명 */
			     , CASE WHEN A.MTRL_KND_CD = '2' THEN A.INF_NO
			            ELSE NULL
			       END                                           AS INF_NO      /* 정보번호 */
			     , (SELECT ORG_NM 
			          FROM TBDCMACM015M B
			         WHERE B.ORG_CD = A.COPT_GD_CD)              AS COPT_GD_NM  /* 소관부처명 */
			     , A.MTRL_NM                                                    /* 자료명 */
			     , A.ETRT_NOC                                                   /* 추출건수 */
			     , A.ETRT_STAD_DT                                               /* 추출기준일 */
			     , A.ETRT_TG_PRD_TXT                                            /* 추출대상기간내용 */
			     , A.YE                                                         /* 연도 */
			     , A.SRNO                                                       /* 일련번호 */
			  FROM TBCSPBII800L A
			 WHERE 1=1			   
		]]>
		
		<!-- 소관부처 -->
		<isNotEmpty property="strCoptGdCd">
			AND A.COPT_GD_CD = #strCoptGdCd#
		</isNotEmpty>
		
		<!-- 입수기관 -->
		<isNotEmpty property="strAcqrOrgCd">
			AND A.ACQR_ORG_CD = #strAcqrOrgCd#
		</isNotEmpty>
		
		<!-- 검색어내용 -->
		<isNotEmpty property="strSrchTxt">
			AND (A.MTRL_NM LIKE '%' || #strSrchTxt# || '%'
			  OR A.ETRT_CLU_TXT LIKE '%' || #strSrchTxt# || '%')			
		</isNotEmpty>
		ORDER BY DECODE(A.MTRL_KND_CD, '1', 1, 2)
		       , A.YE
		       , A.SRNO
	</select>
	
</sqlMap>