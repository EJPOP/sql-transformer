<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">


<!--############################################################################################################################# -->
<sqlMap namespace="proj/common">

	<select id="NSYSmenuinfoselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[       
			SELECT  D1.NCOM905_MENU_PGM_ID AS "menu_pgm_id"
				  , D2.NCOM095_SYS_ID AS "system_id"
			      , D5.NCOM091_SYS_NM AS "system_nm"
			      , D2.NCOM095_SUB_ID AS "sub_id"
			      , D6.NCOM092_SUB_NM AS "sub_nm"
			      , D2.NCOM095_MENU_ID AS "menu_id"
			      , D3.NCOM094_MENU_NM AS "menu_nm"
			      , D2.NCOM095_PGM_ID AS "pgm_id"
			      , D2.NCOM095_MENU_PGM_NM AS "pgm_nm"
			      , D4.NCOM093_URL AS "url"
			      , D5.NCOM091_SYS_NM||'>'||D6.NCOM092_SUB_NM||'>'||D3.NCOM094_MENU_NM||'>'||D2.NCOM095_MENU_PGM_NM||' ('||D2.NCOM095_PGM_ID||')' AS "menu_path"
			      , NVL(D3.NCOM094_UP_MENU_ID, 'NONE') AS "up_menu_id"
			      , NVL(D3.NCOM094_PRT_STEP, 99999) AS "menu_prt_step"
			      , NVL(D2.NCOM095_PRT_STEP, 99999) AS "pgm_prt_step"
			    FROM (	SELECT NCOM905_EMP_NO   
			               , NCOM905_AUTH_GRP_ID  
			               , NCOM905_MENU_PGM_ID
			          	FROM NCOM905VW
			    		) D1
          	 , NCOM095TL D2
				   , NCOM094TL D3
			       , NCOM093TL D4
			       , NCOM091TL D5
			       , NCOM092TL D6 
			WHERE 1 = 1
			  AND D1.NCOM905_MENU_PGM_ID = D2.NCOM095_MENU_PGM_ID
			  AND D2.NCOM095_SYS_ID = D3.NCOM094_SYS_ID
			  AND D2.NCOM095_SUB_ID = D3.NCOM094_SUB_ID
			  AND D2.NCOM095_MENU_ID = D3.NCOM094_MENU_ID
			  AND D2.NCOM095_PGM_ID = D4.NCOM093_PGM_ID
			  AND D2.NCOM095_SYS_ID = D5.NCOM091_SYS_ID
			  AND D2.NCOM095_SYS_ID = D6.NCOM092_SYS_ID
			  AND D2.NCOM095_SUB_ID = D6.NCOM092_SUB_ID
			  AND D2.NCOM095_MENU_PGM_ID = #menu_pgm_id#
        ]]>
	</select>

	<select id="Authmenuauthselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
			SELECT 'M' AS "WRITE_AUTH_CD" ,
			       'A' AS "SCOPE_AUTH_CD" ,
			       'Y' AS "DOWN_POS_YN" ,
			       ''  AS "AUTH_GRP_ID" ,
			       MENU_PGM_ID  AS "MENU_PGM_ID" ,
			       SYSTEM_ID  AS "SYS_ID" ,
			       SUB_ID  AS "SUB_ID" ,
			       MENU_ID  AS "MENU_ID" ,
			       PGM_ID  AS "PGM_ID" ,
			       PGM_NM  AS "PGM_NM" ,
			       MENU_PATH  AS "MENU_PATH"
			  FROM IMSI_TEMP_MENU
			 WHERE 1=1    
        ]]>
        <isNotEmpty property="menu_pgm_id">
        	 AND (MENU_PGM_ID = #menu_pgm_id# OR  PGM_ID = #pgm_id# )
        </isNotEmpty>
        <isEmpty property="menu_pgm_id">
        	 AND MENU_PGM_ID = 'TEST'
        </isEmpty>
	</select>
	


	<select id="NCOMCodeauthcodeselect" parameterClass="paramMap"
		resultClass="resultMap">
        <![CDATA[
            SELECT CODE_DIV 
			     , CODE 
			     , DECODE(USE_YN, 'Y', NM_KOR, NM_KOR||' (미사용)') AS NM_KOR
			     , DECODE(USE_YN, 'Y', NM_ENG, NM_ENG||' (No-Use)') AS NM_ENG
			     , USE_YN 
			     , RELATION 
			     , RELATION2
			     , RELATION3
			     , RELATION4
			     , RELATION5
			     , RELATION6
			     , RELATION7
			     , RELATION8
			     , RELATION9
			     , RELATION10
			     , NM_KOR2
			     , NM_ENG2
			     , PRT_ORD
			     , CODE AS CD
			     , (CASE WHEN #app_locale# = 'en_US' THEN DECODE(USE_YN, 'Y', NM_ENG, NM_ENG||' (No-Use)') ELSE DECODE(USE_YN, 'Y', NM_KOR, NM_KOR||' (미사용)') END) AS CD_NM
				FROM (
		        	SELECT *
		        		FROM COM030TL D1
					WHERE 1 = 1
					  AND CODE_DIV = #code_div#
					  AND CODE <> '000000'
					  AND CODE_DIV NOT IN (
			                                    SELECT S1.RELATION
			                                      FROM COM030TL S1
			                                    WHERE 1 = 1
			                                      AND S1.CODE_DIV = 'NCOM118'
			                                      AND S1.CODE <> '000000'
			                                   )
					UNION
					SELECT *
					  FROM COM030TL D1
					 WHERE 1 = 1 
					   AND CODE_DIV = #code_div#
					   AND CODE <> '000000'
					   AND CODE_DIV IN (	
			                                    SELECT S1.RELATION
			                                      FROM COM030TL S1
			                                    WHERE 1 = 1
			                                      AND S1.CODE_DIV = 'NCOM118'
			                                      AND S1.CODE <> '000000'
			                                   )
				)
			WHERE 1 = 1
			ORDER BY 3
        ]]>
	</select>
 	<select id="NCOMMONCurrentTimeSelect" parameterClass="paramMap"
		resultClass="resultMap">
 		<![CDATA[        
			SELECT TO_CHAR(SYSDATE, 'YYYY') AS CURRENT_YEAR					/* 현재년도*/
				 , TO_CHAR(SYSDATE, 'YYYYMMDD') AS CURRENT_DATE				/* 현재일자*/
				 , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AS CURRENT_TIME		/* 현재시간*/
		     	 , TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS') AS FORMAT_CURRENT_TIME 	/* 현재시간(포맷)*/
		     	 , TO_CHAR(SYSDATE, 'D') AS CURRENT_YOIL					/* 현재요일(1:일, 2:월, 3:화, 4:수, 5:목, 6:금, 7:토)*/
			FROM DUAL
        
  		]]> 
  	</select>	
</sqlMap> 
