<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="common/cmnLog">
<!-- 
	<insert id="commonInsertLog" parameterClass="paramMap">
        <![CDATA[
        
            INSERT INTO TBDCMACM014H (
               LG_SRNO,
			   SIT_CD, MNU_ID, CNB, 
			   TSK_CAT_CD, FUNC_CAT_CD, RQS_DH, 
			   RQS_SVC_ID, RQS_SVC_PRMT_TXT, RQS_IP_NO, 
			   FRT_USR_ID, FNL_USR_ID, FNL_DEAL_DPT_CD, 
			   FNL_MNU_ID, FRT_REGI_DH, FNL_MDF_DH) 
			VALUES ( 
			  SBDCM001.NEXTVAL,
			  'S001' ,
			  #MNU_ID# ,
			  #CNB# ,
			  #TSK_CAT_CD# ,
			  #FUNC_CAT_CD# ,
			  SYSDATE ,
			  #RQS_SVC_ID# ,
			  #RQS_SVC_PRMT_TXT# ,
			  #RQS_IP_NO# ,
			  #FRT_USR_ID# ,
			  #FNL_USR_ID# ,
			  #FNL_DEAL_DPT_CD# ,
			  #FNL_MNU_ID# ,
			  SYSDATE ,
			  SYSDATE  )
        ]]>
	</insert> -->

 
	<insert id="commonInsertLog" parameterClass="paramMap">
        <![CDATA[
            INSERT INTO TBDCMACM014H (
                LG_SRNO,
			   SIT_CD, MNU_ID, CNB, 
			   TSK_CAT_CD, FUNC_CAT_CD, RQS_DH, 
			   RQS_SVC_ID, RQS_SVC_PRMT_TXT, RQS_IP_NO, 
			   FRT_USR_ID, FNL_USR_ID, FNL_DEAL_DPT_CD, 
			   FNL_MNU_ID, FRT_REGI_DH, FNL_MDF_DH
			  , LVL_MNU_NM_1
			  , LVL_MNU_NM_2
			  , LVL_MNU_NM_3
			  , LVL_MNU_NM_4
			  , LVL_MNU_NM_5

			   ) 
			SELECT    SBDCM001.NEXTVAL,
			         'S001' ,
			         #MNU_ID# ,
			         #CNB# ,
			         #TSK_CAT_CD# ,
			         #FUNC_CAT_CD# ,
			         SYSDATE ,
			         #RQS_SVC_ID# ,
					 #RQS_SVC_PRMT_TXT# ,
					 #RQS_IP_NO# ,
					 #FRT_USR_ID# ,
					 #FNL_USR_ID# ,
					 #FNL_DEAL_DPT_CD# ,
					 #FNL_MNU_ID# ,
					 SYSDATE ,
				     SYSDATE 
	
					, REGEXP_SUBSTR(PATH_DESC, '[^>]+', 1, 1) AS LEVEL1
					, REGEXP_SUBSTR(PATH_DESC, '[^>]+', 1, 2) AS LEVEL2
					, REGEXP_SUBSTR(PATH_DESC, '[^>]+', 1, 3) AS LEVEL3
					, REGEXP_SUBSTR(PATH_DESC, '[^>]+', 1, 4) AS LEVEL4
					, REGEXP_SUBSTR(PATH_DESC, '[^>]+', 1, 5) AS LEVEL5
					FROM (
					SELECT RESOURCE_ID, RESOURCE_NAME, RESOURCE_DESC
					, SYS_CONNECT_BY_PATH(RESOURCE_DESC, '>') AS PATH_DESC
					FROM COMMON_RESOURCE
					WHERE CODE_ID = 'COD00003'
					AND RESOURCE_ID <> '1791'
					START WITH RESOURCE_ID2 = '1791'
					CONNECT BY PRIOR RESOURCE_ID = RESOURCE_ID2
					)
					WHERE RESOURCE_NAME = #FNL_MNU_ID#

        ]]>
	</insert>

</sqlMap> 
