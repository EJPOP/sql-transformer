<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.fdm.adm.dao.FDMADM001PMapper">
	
	<select id="getAudDocData" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.fdm.adm.dao.FDMADM001PMapper.getAudDocData*/
		SELECT AUD_DOC_CD,
			   TSK_KND_CD,
			   AUD_STEP_CD,
			   MNT_CHO_CD,
			   APV_WAY_CD,
			   AUD_DOC_KND_CD,
			   TRNM_POSS_YN,
			   DOC_PRD_DPT_CD,
			   CON_PGM_CD
		  FROM TBFDMADM001M
		 WHERE AUD_DOC_CD = #{audDocCd}
	</select>
		
	<insert id="insertFDMADM001M" parameterType="paramMap">
		/* kr.go.bai.eip.fdm.adm.dao.FDMADM001PMapper.insertFDMADM001M*/
		INSERT INTO TBFDMADM001M (AUD_DOC_CD,
								  TSK_KND_CD,
								  AUD_STEP_CD,
								  MNT_CHO_CD,
								  APV_WAY_CD,
								  AUD_DOC_KND_CD,
								  TRNM_POSS_YN,
								  DOC_PRD_DPT_CD,
								  CON_PGM_CD,
								  FRT_USR_ID,
								  FNL_USR_ID,
								  FNL_DEAL_DPT_CD,
								  FNL_MNU_ID,
								  FRT_REGI_DH,
								  FNL_MDF_DH)
						  VALUES (#{audDocCd},
				  		          #{tskKndCd},
				  		          #{audStepCd},
				  		          #{mntChoCd},
				  		          #{apvWayCd},
				  		          #{audDocKndCd},
				  		          #{trnmPossYn},
				  		          #{docPrdDptCd},
				  		          #{conPgmCd},
				  		          #{usrId},    /*세션정보*/
                                  #{usrId},
                                  #{dptCd},
                                  #{menuNo},
                                  SYSDATE,
                                  SYSDATE)
	</insert>
	
	<update id="updateFDMADM001M" parameterType="paramMap">
		/* kr.go.bai.eip.fdm.adm.dao.FDMADM001PMapper.updateFDMADM001M*/
		UPDATE TBFDMADM001M 
		   SET TSK_KND_CD = #{tskKndCd},
			   AUD_STEP_CD = #{audStepCd},
			   MNT_CHO_CD = #{mntChoCd},
			   APV_WAY_CD = #{apvWayCd},
			   AUD_DOC_KND_CD = #{audDocKndCd},
			   TRNM_POSS_YN = #{trnmPossYn},
			   DOC_PRD_DPT_CD = #{docPrdDptCd},
			   CON_PGM_CD = #{conPgmCd},
               FNL_MDF_DH = SYSDATE,
               FNL_USR_ID = #{usrId},
               FNL_DEAL_DPT_CD =#{dptCd}
		 WHERE AUD_DOC_CD = #{audDocCd}
	</update>

	<select id="selectAudStepList" parameterType="paramMap" resultType="egovMap" >
	<![CDATA[
		/* kr.go.bai.eip.fdm.adm.dao.FDMADM001PMapper.selectAudStepList*/
		SELECT CMM_CD_DVSN_CD,
		 	   CD,
		 	   CD_NM
	      FROM TBDCMACM013C
	     WHERE 1 = 1
	       AND CD <> '000000000'
	       AND CMM_CD_DVSN_CD = #{tskKndCdDvsnCd}
	       AND USR_DFN_TXT_1 = #{cmmCdDvsnCd}
	]]>
	       <if test="tskKndCd != null and tskKndCd != ''">
	       AND USR_DFN_TXT_2 = #{tskKndCd}
	       </if>
 	     ORDER BY CMM_CD_DVSN_CD, CD, CD_NM
	</select>
	
	<select id="selectAudDocList" parameterType="paramMap" resultType="egovMap" >
	<![CDATA[
		/* kr.go.bai.eip.fdm.adm.dao.FDMADM001PMapper.selectAudDocList*/
		SELECT CMM_CD_DVSN_CD,
	 	       CD AS AUD_DOC_CD,
	 	       CD_NM
	      FROM TBDCMACM013C
	     WHERE 1 = 1
	       AND CD <> '000000000'
	       AND CMM_CD_DVSN_CD = '1000786'
           AND USR_DFN_TXT_1 = #{cmmCdDvsnCd}
    ]]>           
           <if test="tskKndCd != null and tskKndCd != ''">
           AND USR_DFN_TXT_2 = #{tskKndCd}
           </if>
	       AND CD NOT IN (SELECT AUD_DOC_CD 
			    	        FROM TBFDMADM001M
	
			    	       <if test="audDocCd != null and audDocCd != ''">
			    	       <![CDATA[
					       WHERE AUD_DOC_CD <> #{audDocCd}
					       ]]>
					       </if>
	                     )
	</select>
	
</mapper> 