<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.fer.dao.AEPFER001QMapper">
    
    <select id="selectMainList" parameterType="paramMap" resultType="egovMap" >
            /* kr.go.bai.eip.aep.fer.dao.AEPFER001QMapper.selectMainList */
            <![CDATA[
            SELECT G1.*
              FROM (
                    SELECT 
-- 총,차장 단계 분리로 인하여 코드 재정의 (2019.04.18 LSR 수정)
                        CASE
                       		 WHEN TOT_DHD_DVS_CD IS NOT NULL
                             THEN
		                          CASE
		                              WHEN PRSS_STEP_CD = '02' THEN TO_CHAR(SYSDATE,'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '03' THEN TO_CHAR(SYSDATE,'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '04' THEN TO_CHAR(NVL(TO_DATE(RPT_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '07' THEN TO_CHAR(NVL(TO_DATE(BRDV_HNDL_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '08' THEN TO_CHAR(NVL(TO_DATE(RVW_RM_APV_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '09' THEN TO_CHAR(NVL(TO_DATE(DHD_APV_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '10' THEN TO_CHAR(NVL(TO_DATE(PSD_APV_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '11' THEN TO_CHAR(NVL(TO_DATE(CHF_CMTR_APV_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              ELSE TO_CHAR(NVL(TO_DATE(ENF_APV_DDLN_DT), SYSDATE),'YYYY-MM-DD')
		                          END
                             ELSE
		                          CASE
		                              WHEN PRSS_STEP_CD = '02' THEN TO_CHAR(SYSDATE,'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '03' THEN TO_CHAR(SYSDATE,'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '04' THEN TO_CHAR(NVL(TO_DATE(RPT_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '07' THEN TO_CHAR(NVL(TO_DATE(BRDV_HNDL_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '08' THEN TO_CHAR(NVL(TO_DATE(RVW_RM_APV_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '09' THEN TO_CHAR(NVL(TO_DATE(TOT_DHD_APV_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              WHEN PRSS_STEP_CD = '10' THEN TO_CHAR(NVL(TO_DATE(CHF_CMTR_APV_DDLN_DT)+1, SYSDATE),'YYYY-MM-DD')
		                              ELSE TO_CHAR(NVL(TO_DATE(ENF_APV_DDLN_DT), SYSDATE),'YYYY-MM-DD')
		                          END
		                END AS NOW_STEP_DH
                        , AUD_YR
                        , AUD_NO
                        , AUD_KND_CD
                        , AUD_GRN_NO
                        , AUD_YR_NO
                        , AUD_KND_NM
                        , AUD_SBJ_NM
                        , MNG_DPT_NM
                        , AUD_STR_DT
                        , TO_CHAR(TO_DATE(RTN_DT), 'YYYY-MM-DD') AS RTN_DT
                        , TO_CHAR(TO_DATE(HNDL_DDLN_DT), 'YYYY-MM-DD') AS STAD_HNDL_DT
-- 총,차장 단계 분리로 인하여 코드 재정의 (2019.04.18 LSR 수정)
                       , CASE
                       		 WHEN TOT_DHD_DVS_CD IS NOT NULL
                             THEN
		                          CASE
		                              WHEN PRSS_STEP_CD = '02' THEN '출장'
		                              WHEN PRSS_STEP_CD = '03' THEN '종료보고'
		                              WHEN PRSS_STEP_CD = '04' THEN '과장'
		                              WHEN PRSS_STEP_CD = '07' THEN '국장'
		                              WHEN PRSS_STEP_CD = '08' THEN '차장'
		                              WHEN PRSS_STEP_CD = '09' THEN '총장'
		                              WHEN PRSS_STEP_CD = '10' THEN '주심위원'
		                              WHEN PRSS_STEP_CD = '11' THEN '시행'
		                          END
                             ELSE
		                          CASE
		                              WHEN PRSS_STEP_CD = '02' THEN '출장'
		                              WHEN PRSS_STEP_CD = '03' THEN '종료보고'
		                              WHEN PRSS_STEP_CD = '04' THEN '과장'
		                              WHEN PRSS_STEP_CD = '07' THEN '국장'
		                              WHEN PRSS_STEP_CD = '08' THEN '총차장'
		                              WHEN PRSS_STEP_CD = '09' THEN '주심위원'
		                              WHEN PRSS_STEP_CD = '10' THEN '시행'
		                          END
		               END AS NOW_STEP_NM
-- 총,차장 단계 분리로 인하여 코드 재정의 (2019.04.18 LSR 수정)
                       , CASE
                       		 WHEN  TOT_DHD_DVS_CD IS NOT NULL
                             THEN
		                          CASE
		                              WHEN PRSS_STEP_CD = '03' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(RPT_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(RPT_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '04' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(BRDV_HNDL_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(BRDV_HNDL_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '07' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(RVW_RM_APV_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(RVW_RM_APV_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '08' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(DHD_APV_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(DHD_APV_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '09' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(PSD_APV_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(PSD_APV_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '10' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(CHF_CMTR_APV_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(CHF_CMTR_APV_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '11' 
		                              THEN CASE 
		                                       WHEN ENF_APV_DT IS NULL
		                                       THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(ENF_APV_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(ENF_APV_DDLN_DT))
		                                       ELSE DECODE(SIGN(TO_DATE(ENF_APV_DDLN_DT) - TO_DATE(ENF_APV_DT)), -1, '0', TO_DATE(ENF_APV_DDLN_DT) - TO_DATE(ENF_APV_DT))
		                                   END
		                             ELSE '0'
		                          END
                             ELSE
		                          CASE
		                              WHEN PRSS_STEP_CD = '03' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(RPT_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(RPT_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '04' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(BRDV_HNDL_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(BRDV_HNDL_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '07' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(RVW_RM_APV_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(RVW_RM_APV_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '08' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(TOT_DHD_APV_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(TOT_DHD_APV_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '09' 
		                              THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(CHF_CMTR_APV_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(CHF_CMTR_APV_DDLN_DT))
		                              WHEN PRSS_STEP_CD = '10' 
		                              THEN CASE 
		                                       WHEN ENF_APV_DT IS NULL
		                                       THEN DECODE(SIGN(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(ENF_APV_DDLN_DT)), -1, '0', TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(ENF_APV_DDLN_DT))
		                                       ELSE DECODE(SIGN(TO_DATE(ENF_APV_DDLN_DT) - TO_DATE(ENF_APV_DT)), -1, '0', TO_DATE(ENF_APV_DDLN_DT) - TO_DATE(ENF_APV_DT))
		                                   END
		                             ELSE '0'
		                          END
                         END AS DLAY_DCN
                    FROM (
                          SELECT T1.AUD_YR
                               , T1.AUD_NO
                               , T1.AUD_KND_CD
                               , T1.AUD_GRN_NO
                               , F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, T1.AUD_KND_CD, '-') AS AUD_YR_NO
                               , F_CODE_NM('1000007', T1.AUD_KND_CD) AS AUD_KND_NM
                               , T1.AUD_SBJ_NM
                               , F_DPT_INFO(T1.MNG_DPT_CD,'1') AS MNG_DPT_NM
                               , T2.RTN_RPT_DT
--                               , TO_CHAR(TO_DATE(HNDL_DDLN_DT) + DECODE(GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS HNDL_DDLN_DT
                               , NVL(EXTN_HNDL_DDLN_DT, HNDL_DDLN_DT) AS HNDL_DDLN_DT -- (2019.04.05 LSR 수정)
                               , T2.RTN_DT
                               , (SELECT MIN(AUD_STR_DT) AS AUD_STR_DT
                                    FROM(SELECT TO_CHAR(TO_DATE(AUD_STR_DT),'YYYY-MM-DD') AS AUD_STR_DT
                                           FROM TBBADDED002M
                                          WHERE REL_AUD_YR =#{audYr}
                                            AND REL_AUD_NO = #{audNo}
                                            AND AUD_BZT_KND_CD = '00' 
                                         UNION ALL
                                         SELECT TO_CHAR(TO_DATE(AUD_STR_DT),'YYYY-MM-DD') AS AUD_STR_DT
                                           FROM TBBADDED002M T1 INNER JOIN TBBADDED101L T2 ON  T1.REL_AUD_YR = T2.REL_AUD_YR AND T1.REL_AUD_NO = T2.REL_AUD_NO
                                          WHERE T2.AUD_YR  = #{audYr}
                                            AND T2.AUD_NO =#{audNo})) AS AUD_STR_DT
-- 총,차장 단계 분리로 인하여 코드 재정의 (2019.04.18 LSR 수정)
                               , CASE
                               		 WHEN PSD_APV_DDLN_DT IS NOT NULL
                                     THEN
		                                CASE 
		                                     WHEN T1.PRSS_STEP_CD = 'A1010' 
		                                        OR T1.PRSS_STEP_CD = 'A1020' 
		                                        OR T1.PRSS_STEP_CD = 'A1030' 
		                                        OR T1.PRSS_STEP_CD = 'A1040' THEN '02'                                      /* 자료수집, 확인출장, 감사실시 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1050' THEN '03'                                         /* 종료보고 */
					                         WHEN T1.PRSS_STEP_CD = 'A1060' AND T2.OW_DHD_APV_DT IS NOT NULL THEN '09'         /* 총장 */
					                         WHEN T1.PRSS_STEP_CD = 'A1060' AND T2.JA_JDG_SSEC_APV_DT IS NOT NULL THEN '08'         /* 차장 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1060' AND T2.AUD_BRDV_APV_DT IS NOT NULL THEN '07'    /* 국장 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1060' THEN '04'       /* 과장 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1070' AND T2.SBCN_DT IS NULL AND T2.CHF_CMTR_APV_DT IS NULL THEN '10'       /* 주심위원 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1070' AND T2.CHF_CMTR_APV_DT IS NOT NULL THEN '11'            /* 부의 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1080' THEN '12'            /* 부의 */    
		                                     ELSE T1.PRSS_STEP_CD
		                                 END
		                       		 ELSE
		                                CASE 
		                                     WHEN T1.PRSS_STEP_CD = 'A1010' 
		                                        OR T1.PRSS_STEP_CD = 'A1020' 
		                                        OR T1.PRSS_STEP_CD = 'A1030' 
		                                        OR T1.PRSS_STEP_CD = 'A1040' THEN '02'                                      /* 자료수집, 확인출장, 감사실시 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1070' AND T2.CHF_CMTR_APV_DT IS NOT NULL THEN 'A1070'    /* 부의 (A1070, 주심위원 결재 후) */
		                                     WHEN T1.PRSS_STEP_CD = 'A1070' THEN '09'                                                                         /* A1070 단계 - 주심위원 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1060' AND T2.OW_DHD_APV_DT IS NOT NULL THEN '08'            /* 총장 (A1060, 차장 결재 후) */
		                                     WHEN T1.PRSS_STEP_CD = 'A1060' AND T2.JA_JDG_SSEC_APV_DT IS NOT NULL THEN '08'    /* 차장 (A1060, 국장 결재 후) */
		                                     WHEN T1.PRSS_STEP_CD = 'A1060' AND T2.AUD_BRDV_APV_DT IS NOT NULL THEN '07'         /* 국장 (A1060, 과장 결재 후) */
		                                     WHEN T1.PRSS_STEP_CD = 'A1060' THEN '04'                                                                        /* 과장 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1050' THEN '03'                                                                        /* 종료보고 */
		                                     WHEN T1.PRSS_STEP_CD = 'A1080' THEN '11'            /* 부의 */    
		                                     ELSE T1.PRSS_STEP_CD
		                                 END
		                       END AS PRSS_STEP_CD
                               , '1' AS DLAY_DCN
--                               , TO_CHAR(TO_DATE(RPT_DDLN_DT) + NVL(EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RPT_DDLN_DT
--                               , TO_CHAR(TO_DATE(BRDV_HNDL_DDLN_DT) + DECODE(GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS BRDV_HNDL_DDLN_DT
--                               , TO_CHAR(TO_DATE(RVW_RM_APV_DDLN_DT) + DECODE(GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RVW_RM_APV_DDLN_DT
--                               , TO_CHAR(TO_DATE(TOT_DHD_APV_DDLN_DT) + DECODE(GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS TOT_DHD_APV_DDLN_DT
--                               , TO_CHAR(TO_DATE(CHF_CMTR_APV_DDLN_DT) + DECODE(GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS CHF_CMTR_APV_DDLN_DT
--                               , TO_CHAR(TO_DATE(ENF_APV_DDLN_DT) + DECODE(GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS ENF_APV_DDLN_DT
                               , NVL(EXTN_RPT_DDLN_DT, RPT_DDLN_DT) AS RPT_DDLN_DT								-- (2019.04.05 LSR 수정)
                               , NVL(EXTN_BRDV_HNDL_DDLN_DT, BRDV_HNDL_DDLN_DT) AS BRDV_HNDL_DDLN_DT			-- (2019.04.05 LSR 수정)
                               , NVL(EXTN_RVW_RM_APV_DDLN_DT, RVW_RM_APV_DDLN_DT) AS RVW_RM_APV_DDLN_DT			-- (2019.04.05 LSR 수정)
                               , NVL(EXTN_TOT_DHD_APV_DDLN_DT, TOT_DHD_APV_DDLN_DT) AS TOT_DHD_APV_DDLN_DT		-- (2019.04.05 LSR 수정)
                               , NVL(EXTN_DHD_APV_DDLN_DT, DHD_APV_DDLN_DT) AS DHD_APV_DDLN_DT					-- (2019.04.05 LSR 수정)
                               , NVL(EXTN_PSD_APV_DDLN_DT, PSD_APV_DDLN_DT) AS PSD_APV_DDLN_DT					-- (2019.04.05 LSR 수정)
                               , NVL(EXTN_CHF_CMTR_APV_DDLN_DT, CHF_CMTR_APV_DDLN_DT) AS CHF_CMTR_APV_DDLN_DT	-- (2019.04.05 LSR 수정)
                               , NVL(EXTN_ENF_APV_DDLN_DT, ENF_APV_DDLN_DT) AS ENF_APV_DDLN_DT					-- (2019.04.05 LSR 수정)
                               , PSD_APV_DDLN_DT AS TOT_DHD_DVS_CD												-- 총,차장 단계 분리 구분 (2019.04.18 LSR 수정)
                               , ENF_APV_DT
                            FROM TBBADDED001M T1
                           INNER JOIN TBBADDED003M T2 ON T1.AUD_YR = T2.AUD_YR
                                                     AND T1.AUD_NO = T2.AUD_NO
                           WHERE 1=1
                             AND SUBSTR(T1.AUD_KND_CD, 3, 1) <> 5
                             AND EXISTS (
                                         SELECT 1
                                           FROM TBDCMACM002M S
                                          WHERE S.DPT_CD = T1.MNG_DPT_CD
                                            AND S.USE_YN = 'Y'
                                        )
                    AND T1.AUD_YR  = #{audYr}
                    AND T1.AUD_NO = #{audNo}
                    )
                ) G1
        ]]>
    </select>
    
    <select id="selectSubList1" parameterType="paramMap" resultType="egovMap" >
        /* kr.go.bai.eip.aep.fer.dao.AEPFER001QMapper.selectSubList1 */
        <![CDATA[
            SELECT F_CODE_NM ('1000030', AUD_BZT_KND_CD) AS AUD_BZT_KND_NM /*감사출장종류코드*/
                    , TO_CHAR(TO_DATE(AUD_STR_DT),'YYYY-MM-DD') AS AUD_STR_DT
                    , TO_CHAR(TO_DATE(AUD_END_DT),'YYYY-MM-DD') AS AUD_END_DT
                    , AUD_BZT_KND_CD
                    , AUD_DCN
                    , (SELECT COUNT(1)
                       FROM TBBADDED005L T2
                      WHERE T2.BZT_YR = T1.BZT_YR 
                         AND T2.BZT_SNO = T1.BZT_SNO) AS NOP_CNT
            FROM  TBBADDED002M T1
           WHERE REL_AUD_YR = #{audYr}
              AND REL_AUD_NO = #{audNo}
           UNION ALL
           SELECT F_CODE_NM ('1000030', AUD_BZT_KND_CD) AS AUD_BZT_KND_NM /*감사출장종류코드*/
                   , TO_CHAR(TO_DATE(AUD_STR_DT),'YYYY-MM-DD') AS AUD_STR_DT
                   , TO_CHAR(TO_DATE(AUD_END_DT),'YYYY-MM-DD') AS AUD_END_DT
                   , AUD_BZT_KND_CD
                   , AUD_DCN
                   , (SELECT COUNT(1)
                      FROM TBBADDED005L T2
                     WHERE T2.BZT_YR = T1.BZT_YR 
                        AND T2.BZT_SNO = T1.BZT_SNO) AS NOP_CNT      
          FROM TBBADDED002M T1 INNER JOIN TBBADDED101L T2
                                                       ON  T1.REL_AUD_YR = T2.REL_AUD_YR
                                                      AND T1.REL_AUD_NO = T2.REL_AUD_NO
         WHERE T2.AUD_YR  =  #{audYr}
            AND T2.AUD_NO = #{audNo}
         ORDER BY AUD_STR_DT, AUD_BZT_KND_CD
         ]]>
    </select>
    
    <select id="selectSubList2" parameterType="paramMap" resultType="egovMap" >
        /* kr.go.bai.eip.aep.fer.dao.AEPFER001QMapper.selectSubList2 */
        <![CDATA[
            SELECT PRSS_STEP_NM
                 , TO_CHAR(TO_DATE(DDLN_DT), 'YYYY-MM-DD') AS DDLN_DT
                  , CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND NVL(EXTN_PRD_COFM_DT, 0)  = 0  THEN ''
                        WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND NVL(EXTN_PRD_COFM_DT, 0) <> 0 THEN TO_CHAR(TO_DATE(EXTN_DDLN_DT ) - 5, 'YYYY-MM-DD')
                        WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT > 0 AND NVL(EXTN_PRD_COFM_DT, 0) = 0 THEN TO_CHAR(TO_DATE(EXTN_DDLN_DT), 'YYYY-MM-DD')
                        WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT > 0 AND NVL(EXTN_PRD_COFM_DT, 0) <> 0 THEN TO_CHAR(TO_DATE(EXTN_DDLN_DT), 'YYYY-MM-DD')
                        WHEN GNR_HNDL_PLAN_YN <>'Y' AND NVL(EXTN_PRD_COFM_DT, 0) > 0  THEN TO_CHAR(TO_DATE(EXTN_DDLN_DT), 'YYYY-MM-DD')
                        ELSE ''
                        END  AS MDT_DT  
                 , TO_CHAR(TO_DATE(APV_DT), 'YYYY-MM-DD') AS APV_DT
                 , CASE 
                       WHEN APV_DT IS NULL AND SYSDATE > TO_DATE(NVL((CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND PRSS_STEP_CD <> '03'  THEN TO_CHAR(TO_DATE(EXTN_DDLN_DT ) - 5, 'YYYY-MM-DD')
                                                                                                     ELSE TO_CHAR(TO_DATE(EXTN_DDLN_DT), 'YYYY-MM-DD') END), DDLN_DT))
                       THEN TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD')) - TO_DATE(NVL((CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND PRSS_STEP_CD <> '03'  THEN TO_CHAR(TO_DATE(EXTN_DDLN_DT) - 5 , 'YYYY-MM-DD')
                                                                                                                    ELSE TO_CHAR(TO_DATE(EXTN_DDLN_DT), 'YYYY-MM-DD') END), DDLN_DT))
                       WHEN APV_DT IS NOT NULL AND TO_DATE(APV_DT) > TO_DATE(NVL((CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND PRSS_STEP_CD <> '03'  THEN TO_CHAR(TO_DATE(EXTN_DDLN_DT) - 5, 'YYYY-MM-DD')
                                                                                                                      ELSE TO_CHAR(TO_DATE(EXTN_DDLN_DT), 'YYYY-MM-DD') END), DDLN_DT))
                       THEN TO_DATE(APV_DT) - TO_DATE(NVL((CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND PRSS_STEP_CD <> '03'  THEN TO_CHAR(TO_DATE(EXTN_DDLN_DT) - 5 , 'YYYY-MM-DD')
                                                                                  ELSE TO_CHAR(TO_DATE(EXTN_DDLN_DT), 'YYYY-MM-DD') END), DDLN_DT))
                       ELSE 0
                   END AS DELAY_DT	-- (2019.04.05 LSR 수정)
              FROM (
                    
                   WITH BASE AS (SELECT '03' AS PRSS_STEP_CD, '종료보고' AS PRSS_STEP_NM, 'A' AS TOT_DHD_DVS_CD FROM DUAL UNION ALL
                                SELECT '06' AS PRSS_STEP_CD, '과장' AS PRSS_STEP_NM, 'A' AS TOT_DHD_DVS_CD FROM DUAL UNION ALL
                                SELECT '07' AS PRSS_STEP_CD, '국장' AS PRSS_STEP_NM, 'A' AS TOT_DHD_DVS_CD FROM DUAL UNION ALL
                                SELECT '08' AS PRSS_STEP_CD, '차총장' AS PRSS_STEP_NM, 'N' AS TOT_DHD_DVS_CD FROM DUAL UNION ALL
                                SELECT '09' AS PRSS_STEP_CD, '주심위원' AS PRSS_STEP_NM, 'N' AS TOT_DHD_DVS_CD FROM DUAL UNION ALL
                                SELECT '10' AS PRSS_STEP_CD, '시행' AS PRSS_STEP_NM, 'N' AS TOT_DHD_DVS_CD FROM DUAL UNION ALL
                                SELECT '08' AS PRSS_STEP_CD, '차장' AS PRSS_STEP_NM, 'Y' AS TOT_DHD_DVS_CD FROM DUAL UNION ALL
                                SELECT '09' AS PRSS_STEP_CD, '총장' AS PRSS_STEP_NM, 'Y' AS TOT_DHD_DVS_CD FROM DUAL UNION ALL
                                SELECT '10' AS PRSS_STEP_CD, '주심위원' AS PRSS_STEP_NM, 'Y' AS TOT_DHD_DVS_CD FROM DUAL UNION ALL
                                SELECT '11' AS PRSS_STEP_CD, '시행' AS PRSS_STEP_NM, 'Y' AS TOT_DHD_DVS_CD FROM DUAL)
                    SELECT T2.PRSS_STEP_NM
                         , T2.PRSS_STEP_CD
                         , CASE
                       	 		WHEN PSD_APV_DDLN_DT IS NOT NULL
                       	 		THEN
		                         	DECODE ( T2.PRSS_STEP_CD, '03', T1.RPT_DDLN_DT
		                                                   , '06', T1.BRDV_HNDL_DDLN_DT
		                                                   , '07', T1.RVW_RM_APV_DDLN_DT
		                                                   , '08', T1.DHD_APV_DDLN_DT
		                                                   , '09', T1.PSD_APV_DDLN_DT
		                                                   , '10', T1.CHF_CMTR_APV_DDLN_DT
		                                                   , '11', T1.ENF_APV_DDLN_DT )
                       	 		ELSE
		                         	DECODE ( T2.PRSS_STEP_CD, '03', T1.RPT_DDLN_DT
		                                                   , '06', T1.BRDV_HNDL_DDLN_DT
		                                                   , '07', T1.RVW_RM_APV_DDLN_DT
		                                                   , '08', T1.TOT_DHD_APV_DDLN_DT
		                                                   , '09', T1.CHF_CMTR_APV_DDLN_DT
		                                                   , '10', T1.ENF_APV_DDLN_DT )
                       	 	END AS DDLN_DT
                         , CASE
                       	 		WHEN PSD_APV_DDLN_DT IS NOT NULL
                       	 		THEN
		                         	DECODE ( T2.PRSS_STEP_CD, '03', T1.EXTN_RPT_DDLN_DT
		                                                   , '06', T1.EXTN_BRDV_HNDL_DDLN_DT
		                                                   , '07', T1.EXTN_RVW_RM_APV_DDLN_DT
		                                                   , '08', T1.EXTN_DHD_APV_DDLN_DT
		                                                   , '09', T1.EXTN_PSD_APV_DDLN_DT
		                                                   , '10', T1.EXTN_CHF_CMTR_APV_DDLN_DT
		                                                   , '11', T1.EXTN_ENF_APV_DDLN_DT )
                       	 		ELSE
		                         	DECODE ( T2.PRSS_STEP_CD, '03', T1.EXTN_RPT_DDLN_DT
		                                                   , '06', T1.EXTN_BRDV_HNDL_DDLN_DT
		                                                   , '07', T1.EXTN_RVW_RM_APV_DDLN_DT
		                                                   , '08', T1.EXTN_TOT_DHD_APV_DDLN_DT
		                                                   , '09', T1.EXTN_CHF_CMTR_APV_DDLN_DT
		                                                   , '10', T1.EXTN_ENF_APV_DDLN_DT )
                       	 	END AS EXTN_DDLN_DT
                         , CASE
                       	 		WHEN PSD_APV_DDLN_DT IS NOT NULL
                       	 		THEN
		                         	DECODE ( T2.PRSS_STEP_CD, '03',
																	(SELECT
																		TO_CHAR(MAX(DECODE(D2.APVR_PST_CD,'0055600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
																							,DECODE(D2.APVR_PST_CD,'0045900',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),''))), 'YYYY-MM-DD') -- 사무차장, 본부장 결재일로 변경 2019.05.23 LSR
																	FROM TBBADDED103M D1
																	,TBDCMACM023L D2
																	WHERE 1=1
																	AND D1.APV_RQS_ID  = D2.APV_DOC_NO
																	AND D1.RPRT_CD     = 'A10500200' --종료보고서
																	AND D1.AUD_YR = T1.AUD_YR
																	AND D1.AUD_NO = T1.AUD_NO
																	GROUP BY D1.AUD_YR, D1.AUD_NO)
		                                                   , '06',
																	(SELECT
																	    MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0013600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
   															                                                                                            ,DECODE(D2.APVR_PST_CD,'0057400',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'')) END)
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4'))
		                                                   , '07',
																	(SELECT
																	    MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0015800',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
																	                              ,DECODE(D2.APVR_PST_CD,'0035100',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
																	                              ,DECODE(D2.APVR_PST_CD,'0058100',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),''))) END)	--국단실장결재일
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4'))
		                                                   , '08',
																	(SELECT
																	    MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0045900',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
																	                              ,DECODE(D2.APVR_PST_CD,'0055600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'')) END)	--사무차장결재일
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4'))
		                                                   , '09',
																	(SELECT
																	    MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0055700',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'') END)	--사무총장결재일
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4'))
		                                                   , '10',
																	(SELECT
																	    TO_CHAR(MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN (SELECT MIN(D6.APV_DH)
																	                                                FROM TBDCMACM023H D6 
																	                                                    ,TBBADDED103M D7
																	                                               WHERE D6.APV_DOC_NO = D7.APV_RQS_ID
																	                                                 AND D6.APVR_KND_CD IN ('2','3','4')
																	                                                 AND D7.RPRT_CD = 'A10700100'
																	                                                 AND D7.APV_STA_CD = '30'
																	                                                 AND D6.APVR_PST_CD = '0010600'
																	                                                 AND D6.APVR_STA_CD <> '401'
																	                                                 AND REF_ID = D1.DOC_ID) END), 'YYYY-MM-DD')	--주심위원결재일
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4'))
		                                                   , '11', T1.ENF_APV_DT )
                       	 		ELSE
		                         	DECODE ( T2.PRSS_STEP_CD, '03',
																	(SELECT
																		TO_CHAR(MAX(DECODE(D2.APVR_PST_CD,'0055600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
																							,DECODE(D2.APVR_PST_CD,'0045900',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),''))), 'YYYY-MM-DD') -- 사무차장, 본부장 결재일로 변경 2019.05.23 LSR
																	FROM TBBADDED103M D1
																	,TBDCMACM023L D2
																	WHERE 1=1
																	AND D1.APV_RQS_ID  = D2.APV_DOC_NO
																	AND D1.RPRT_CD     = 'A10500200' --종료보고서
																	AND D1.AUD_YR = T1.AUD_YR
																	AND D1.AUD_NO = T1.AUD_NO
																	GROUP BY D1.AUD_YR, D1.AUD_NO)
		                                                   , '06',
																	(SELECT
																	    MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0013600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
   															                                                                                            ,DECODE(D2.APVR_PST_CD,'0057400',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'')) END)
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4'))
		                                                   , '07',
																	(SELECT
																	    MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0015800',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
																	                              ,DECODE(D2.APVR_PST_CD,'0035100',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
																	                              ,DECODE(D2.APVR_PST_CD,'0058100',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),''))) END)	--국단실장결재일
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4'))
		                                                   , '08',
																	NVL((SELECT
																	    MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0055700',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'') END)	--사무총장결재일
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4'))
																	,(SELECT
																	    MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0045900',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
																	                              ,DECODE(D2.APVR_PST_CD,'0055600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'')) END)	--사무차장결재일
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4')))
		                                                   , '09',
																	(SELECT
																	    TO_CHAR(MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN (SELECT MIN(D6.APV_DH)
																	                                                FROM TBDCMACM023H D6 
																	                                                    ,TBBADDED103M D7
																	                                               WHERE D6.APV_DOC_NO = D7.APV_RQS_ID
																	                                                 AND D6.APVR_KND_CD IN ('2','3','4')
																	                                                 AND D7.RPRT_CD = 'A10700100'
																	                                                 AND D7.APV_STA_CD = '30'
																	                                                 AND D6.APVR_PST_CD = '0010600'
																	                                                 AND D6.APVR_STA_CD <> '401'
																	                                                 AND REF_ID = D1.DOC_ID) END), 'YYYY-MM-DD')	--주심위원결재일
																	FROM TBBADDED103M D1
																	     ,TBDCMACM023L D2
																	WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
																	  AND D1.AUD_YR           = T1.AUD_YR
																	  AND D1.AUD_NO           = T1.AUD_NO
																	  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
																	  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
																	  AND D2.APVR_KND_CD IN ('1','2','3','4'))
		                                                   , '10', T1.ENF_APV_DT )
                       	 	END AS APV_DT
                         , T1.GNR_HNDL_PLAN_YN
                         , T1.EXTN_PRD_COFM_DT
                         ,(SELECT COUNT(*) FROM TBBADDED103M A 
                                         INNER JOIN TBDCMACM023H B 
                                                 ON A.APV_RQS_ID = B.APV_DOC_NO AND B.APVR_KND_CD = 1 AND B.APVR_STA_CD = '201' 
                              WHERE 1=1
                              AND A.AUD_YR = T1.AUD_YR
                                AND A.AUD_NO  = T1.AUD_NO
                                AND A.RPRT_CD = 'A10600200'
                                AND A.AUD_RPRT_DVSN_CD = '10'
                                AND A.AUD_STEP_CD = 'A1060') AS CNT
                      FROM TBBADDED003M T1, BASE T2
                     WHERE T1.AUD_YR = #{audYr}
                       AND T1.AUD_NO = #{audNo}
	                     AND (T2.TOT_DHD_DVS_CD = DECODE(T1.PSD_APV_DDLN_DT, NULL, 'N', 'Y') 
	                     		OR T2.TOT_DHD_DVS_CD = 'A')
                   ) 
          ]]>
	</select>
    
    <select id="selectSubList3" parameterType="paramMap" resultType="egovMap" >
        /* kr.go.bai.eip.aep.fer.dao.AEPFER001QMapper.selectSubList3 */
        <![CDATA[
            SELECT CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 THEN TO_CHAR(TO_DATE(HNDL_DDLN_DT)  - 5, 'YYYY-MM-DD')
                        ELSE TO_CHAR(TO_DATE(HNDL_DDLN_DT), 'YYYY-MM-DD') END AS HNDL_DDLN_DT   
                 , ENF_DT
                 , STAD_HNDL_DT
                 , CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 THEN TO_CHAR(EXTN_PRD_COFM_DT  - 5)
                        ELSE TO_CHAR(EXTN_PRD_COFM_DT) END AS EXTN_PRD_COFM_DT
                 , CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND EXTN_PRD_COFM_DT1 = 0  THEN ''
                        WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND EXTN_PRD_COFM_DT1 <> 0 THEN TO_CHAR(EXTN_HNDL_DT  - 5)
                        ELSE TO_CHAR(EXTN_HNDL_DT) END AS EXTN_HNDL_DT
                 , CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 THEN TO_CHAR(REAL_HNDL_DT  - 5)
                        ELSE TO_CHAR(REAL_HNDL_DT) END AS REAL_HNDL_DT                
                 ,CASE WHEN  ((CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 THEN TO_CHAR(REAL_HNDL_DT  - 5)
                                   ELSE TO_CHAR(REAL_HNDL_DT) END) - 
                             (CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND EXTN_PRD_COFM_DT1 = 0  THEN ''
                                   WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND EXTN_PRD_COFM_DT1 <> 0 THEN TO_CHAR(EXTN_HNDL_DT  - 5)
                                    ELSE TO_CHAR(EXTN_HNDL_DT) END))  > 0 THEN ((CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 THEN TO_CHAR(REAL_HNDL_DT  - 5)
                                   ELSE TO_CHAR(REAL_HNDL_DT) END) - 
                             (CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND EXTN_PRD_COFM_DT1 = 0  THEN ''
                                   WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0 AND EXTN_PRD_COFM_DT1 <> 0 THEN TO_CHAR(EXTN_HNDL_DT  - 5)
                                    ELSE TO_CHAR(EXTN_HNDL_DT) END))
                         ELSE 0 END AS EXCS_DT
              FROM (
                    SELECT
--                    	TO_CHAR(
--                                DECODE(T1.GNR_HNDL_PLAN_YN, 'N', TO_DATE(T1.HNDL_DDLN_DT) + NVL(T1.EXTN_PRD_COFM_DT, 0)
--                                                        , 'Y', 5 + TO_DATE(T1.HNDL_DDLN_DT) + NVL(T1.EXTN_PRD_COFM_DT, 0),'') , 'YYYY-MM-DD') AS HNDL_DDLN_DT
                         NVL(T1.EXTN_HNDL_DDLN_DT, T1.HNDL_DDLN_DT) AS HNDL_DDLN_DT			-- (2019.04.18 LSR 수정)
                         , TO_CHAR(TO_DATE(T1.ENF_APV_DT),'YYYY-MM-DD') AS ENF_DT
                         , NVL(T1.STAD_HNDL_DCN, 0) AS STAD_HNDL_DT
--                         , DECODE(T1.GNR_HNDL_PLAN_YN, 'N', NVL(T1.EXTN_PRD_COFM_DT, 0)
--                                                     , 'Y', 5 + NVL(T1.EXTN_PRD_COFM_DT, 0), '0') AS EXTN_PRD_COFM_DT
                         , DECODE(T1.GNR_HNDL_PLAN_YN, 'N', NVL(T1.EXTN_PRD_COFM_DT, 0)
                                                     , 'Y', NVL(F_GNR_HNDL_PLAN_EXTN_DCN(T1.AUD_YR, T1.AUD_NO), 0) + NVL(T1.EXTN_PRD_COFM_DT, 0), '0') AS EXTN_PRD_COFM_DT	-- (2019.04.18 LSR 수정)
--                         , NVL(T1.STAD_HNDL_DCN, 0)
--                           + DECODE(T1.GNR_HNDL_PLAN_YN, 'N', NVL(T1.EXTN_PRD_COFM_DT, 0)
--                                                     , 'Y', 5 + NVL(T1.EXTN_PRD_COFM_DT, 0), '0') AS EXTN_HNDL_DT
                         , NVL(T1.STAD_HNDL_DCN, 0)
                           + DECODE(T1.GNR_HNDL_PLAN_YN, 'N', NVL(T1.EXTN_PRD_COFM_DT, 0)
                                                     , 'Y', NVL(F_GNR_HNDL_PLAN_EXTN_DCN(T1.AUD_YR, T1.AUD_NO), 0) + NVL(T1.EXTN_PRD_COFM_DT, 0), '0') AS EXTN_HNDL_DT	-- (2019.04.18 LSR 수정)
--                         , NVL(NVL(TO_DATE(T1.ENF_APV_DT), TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM/DD'))) - (TO_DATE(T1.RTN_DT)-1), 0) AS REAL_HNDL_DT
                         , NVL(CASE WHEN NVL(T1.EXTN_PRD_COFM_DT, 0) > 0 OR NVL(T1.GNR_HNDL_PLAN_YN, 'N') = 'Y'
                         			THEN F_EXTN_HNDL_DT_CNT(T1.AUD_YR, T1.AUD_NO, TO_CHAR(TO_DATE(T1.RTN_DT)-1, 'YYYYMMDD'), NVL(T1.ENF_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '5', '9', 'T')
                         			ELSE F_HNDL_DT_CNT(T1.AUD_YR, T1.AUD_NO, TO_CHAR(TO_DATE(T1.RTN_DT)-1, 'YYYYMMDD'), NVL(T1.ENF_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '2', '9')
                         		END, 0) AS REAL_HNDL_DT	-- (2019.04.18 LSR 수정)
                         , (SELECT COUNT(*) FROM TBBADDED103M A 
                                         INNER JOIN TBDCMACM023H B 
                                                 ON A.APV_RQS_ID = B.APV_DOC_NO AND B.APVR_KND_CD = 1 AND B.APVR_STA_CD = '201' 
                              WHERE 1=1
                              AND A.AUD_YR = T1.AUD_YR
                                AND A.AUD_NO  = T1.AUD_NO
                                AND A.RPRT_CD = 'A10600200'
                                AND A.AUD_RPRT_DVSN_CD = '10'
                                AND A.AUD_STEP_CD = 'A1060') AS CNT
                           , T1.GNR_HNDL_PLAN_YN
                          , NVL(T1.EXTN_PRD_COFM_DT, 0) AS EXTN_PRD_COFM_DT1
                      FROM TBBADDED003M T1
                     WHERE T1.AUD_YR = #{audYr}
                       AND T1.AUD_NO = #{audNo}
                    )
        ]]>
    </select>

    <select id="selectCalendar" parameterType="paramMap" resultType="egovMap" >
        <![CDATA[
        /* kr.go.bai.eip.aep.fer.dao.AEPFER001QMapper.selectCalendar */
	        SELECT DATATYP
	             , CMMCDNM
	             , STDT
	             , DECODE(STDT, ENDDT, ENDDT, TO_CHAR(TO_DATE(ENDDT)+1,'YYYY-MM-DD')) AS ENDDT
	          FROM (    
	            SELECT DECODE(AUD_BZT_KND_CD, '00', '1', '01', '2', '3') AS DATATYP
	                 , F_CODE_NM ('1000030', DECODE(AUD_BZT_KND_CD, '03', '02', AUD_BZT_KND_CD)) AS CMMCDNM
	                 , TO_CHAR(TO_DATE(MIN(AUD_STR_DT)),'YYYY-MM-DD') AS STDT
	                 , TO_CHAR(TO_DATE(MAX(AUD_END_DT)),'YYYY-MM-DD') AS ENDDT
	              FROM TBBADDED002M
	             WHERE REL_AUD_YR = #{audYr}
	               AND REL_AUD_NO = #{audNo}
	             GROUP BY AUD_BZT_KND_CD , REL_AUD_YR, REL_AUD_NO
	            HAVING AUD_BZT_KND_CD IN ('00','01','02','03')
	            UNION ALL
-- 총,차장 단계 분리로 인하여 코드 재정의 (2019.04.18 LSR 수정)	                   
	            SELECT DECODE(RNUM, 1, '4', '0') AS DATATYP
                     , CASE
                   	 		WHEN PSD_APV_DDLN_DT IS NOT NULL
                   	 		THEN
				                  DECODE(RNUM ,1, '귀청일'
				                               ,2, '종료보고기준일'
				                               ,3, '과장결재기준일'
				                               ,4, '국장결재기준일'
				                               ,5, '차장결재기준일'
				                               ,6, '총장결재기준일'
				                               ,7, '주심위원결재기준일'
				                               ,8, '시행기준일','')
                   	 		ELSE
				                  DECODE(RNUM ,1, '귀청일'
				                               ,2, '종료보고기준일'
				                               ,3, '과장결재기준일'
				                               ,4, '국장결재기준일'
				                               ,5, '총차장결재기준일'
				                               ,6, '주심위원결재기준일'
				                               ,7, '시행기준일','')
			         END AS CMMCDNM
                      ,DECODE(RNUM, 1, TO_CHAR(TO_DATE(STDT), 'YYYY-MM-DD'),
                                           2, TO_CHAR(TO_DATE(NVL(EXTN_STDT, STDT)), 'YYYY-MM-DD') ,
                                          CASE WHEN GNR_HNDL_PLAN_YN = 'Y' AND CNT = 0   THEN TO_CHAR(TO_DATE(NVL(EXTN_STDT, STDT))  - 5 , 'YYYY-MM-DD') 
                                                   ELSE TO_CHAR(TO_DATE(NVL(EXTN_STDT, STDT)), 'YYYY-MM-DD')
                                                   END ) AS STDT	-- (2019.04.05 LSR 수정)
	                  ,ENDDT
	              FROM (   
	                SELECT ROWNUM AS RNUM
                         , CASE
                       	 		WHEN PSD_APV_DDLN_DT IS NOT NULL
                       	 		THEN
				                      DECODE(ROWNUM, 1, RTN_DT
				                                    , 2, RPT_DDLN_DT
				                                    , 3, BRDV_HNDL_DDLN_DT
				                                    , 4, RVW_RM_APV_DDLN_DT
				                                    , 5, DHD_APV_DDLN_DT
				                                    , 6, PSD_APV_DDLN_DT
				                                    , 7, CHF_CMTR_APV_DDLN_DT
				                                    , 8, ENF_APV_DDLN_DT
				                                    ,'')
                       	 		ELSE
				                      DECODE(ROWNUM, 1, RTN_DT
				                                    , 2, RPT_DDLN_DT
				                                    , 3, BRDV_HNDL_DDLN_DT
				                                    , 4, RVW_RM_APV_DDLN_DT
				                                    , 5, TOT_DHD_APV_DDLN_DT
				                                    , 6, CHF_CMTR_APV_DDLN_DT
				                                    , 7, ENF_APV_DDLN_DT
				                                    ,'')
				         END AS STDT
                         , CASE
                       	 		WHEN PSD_APV_DDLN_DT IS NOT NULL
                       	 		THEN                
			                          DECODE(ROWNUM, 1, RTN_DT
			                                        , 2, EXTN_RPT_DDLN_DT
			                                        , 3, EXTN_BRDV_HNDL_DDLN_DT
			                                        , 4, EXTN_RVW_RM_APV_DDLN_DT
			                                        , 5, EXTN_DHD_APV_DDLN_DT
			                                        , 6, EXTN_PSD_APV_DDLN_DT
			                                        , 7, EXTN_CHF_CMTR_APV_DDLN_DT
			                                        , 8, EXTN_ENF_APV_DDLN_DT
			                                        ,'')
                       	 		ELSE
			                          DECODE(ROWNUM, 1, RTN_DT
			                                        , 2, EXTN_RPT_DDLN_DT
			                                        , 3, EXTN_BRDV_HNDL_DDLN_DT
			                                        , 4, EXTN_RVW_RM_APV_DDLN_DT
			                                        , 5, EXTN_TOT_DHD_APV_DDLN_DT
			                                        , 6, EXTN_CHF_CMTR_APV_DDLN_DT
			                                        , 7, EXTN_ENF_APV_DDLN_DT
			                                        ,'')
				         END AS EXTN_STDT
	                      ,'' AS ENDDT
	                      ,GNR_HNDL_PLAN_YN
	                      ,EXTN_PRD_COFM_DT
	                      ,PSD_APV_DDLN_DT
	                      ,(SELECT COUNT(*)
	                        FROM TBBADDED103M A 
                                    INNER JOIN TBDCMACM023H B 
                                              ON A.APV_RQS_ID = B.APV_DOC_NO AND B.APVR_KND_CD = 1 AND B.APVR_STA_CD = '201' 
                          WHERE 1=1
                             AND A.AUD_YR = T1.AUD_YR
                             AND A.AUD_NO  = T1.AUD_NO
                             AND A.RPRT_CD = 'A10600200'
                             AND A.AUD_RPRT_DVSN_CD = '10'
                             AND A.AUD_STEP_CD = 'A1060') AS CNT
	                  FROM (
	                        SELECT 1
	                          FROM DUAL
	                        CONNECT BY LEVEL <= (SELECT DECODE(PSD_APV_DDLN_DT, NULL, '7', '8') FROM TBBADDED003M WHERE AUD_YR = #{audYr} AND AUD_NO = #{audNo})
	                       ), TBBADDED003M T1
	                 WHERE T1.AUD_YR = #{audYr}
	                    AND T1.AUD_NO = #{audNo})
	            UNION ALL
                  SELECT *
                  FROM (
                    SELECT
	                     CASE
	                   	 	 WHEN PSD_APV_DDLN_DT IS NOT NULL
	                   	 	 THEN
		                    	  DECODE(NO, 1, '5'
		                                    , 2, '6'
		                                    , 3, '7'
		                                    , 4, '8'
		                                    , 5, '9', '')
	                   	 	 ELSE
		                    	  DECODE(NO, 1, '5'
                                    		, 2, '6'
		                                    , 3, '7'
		                                    , 4, '8', '')
	                   	 END AS DATATYP
	                     , CASE
	                   	 	 WHEN PSD_APV_DDLN_DT IS NOT NULL
	                   	 	 THEN
		                          DECODE(NO, 1, '과장결재'
		                                    , 2, '국장결재'
		                                    , 3, '차장결재'
		                                    , 4, '총장결재'
		                                    , 5, '주심위원결재', '')
	                   	 	 ELSE
		                          DECODE(NO, 1, '과장결재'
		                                    , 2, '국장결재'
		                                    , 3, '총차장결재'
		                                    , 4, '주심위원결재', '')
	                   	 END AS CMMCDNM
	                     , CASE
	                   	 	 WHEN PSD_APV_DDLN_DT IS NOT NULL
	                   	 	 THEN
		                          DECODE(NO, 1, S5
		                                    , 2, E5
		                                    , 3, E6
		                                    , 4, E7
		                                    , 5, S8, '')
	                   	 	 ELSE
		                           DECODE(NO, 1, S5
		                                    , 2, E5
		                                    , 3, E6
		                                    , 4, S8, '')
	                   	 END AS STDT
	                     , CASE
	                   	 	 WHEN PSD_APV_DDLN_DT IS NOT NULL
	                   	 	 THEN
		                          DECODE(NO, 1, E5
		                                    , 2, E6
		                                    , 3, E7
		                                    , 4, E8
		                                    , 5, E9, '')
	                   	 	 ELSE
		                          DECODE(NO, 1, E5
		                                    , 2, E6
		                                    , 3, NVL(E8, E7)
		                                    , 4, E9, '')
	                   	 END AS ENDDT
                      FROM (
                        SELECT TO_CHAR(MIN(S5), 'YYYY-MM-DD') AS S5
                              ,TO_CHAR(TO_DATE(MIN(S8)), 'YYYY-MM-DD') AS S8
                              ,TO_CHAR(TO_DATE(MAX(E5)), 'YYYY-MM-DD') AS E5
                              ,TO_CHAR(TO_DATE(MAX(E6)), 'YYYY-MM-DD') AS E6
                              ,TO_CHAR(TO_DATE(MAX(E7)), 'YYYY-MM-DD') AS E7
               	 			  ,TO_CHAR(TO_DATE(MAX(E8)), 'YYYY-MM-DD') AS E8
	                       	  ,TO_CHAR(MAX(E9), 'YYYY-MM-DD') AS E9
	                       	  ,PSD_APV_DDLN_DT
                         FROM (
                               SELECT D1.AUD_YR
                                     ,D1.AUD_NO
                                     ,CASE WHEN D2.APVR_KND_CD = '1' AND D1.RPRT_CD = 'A10600200' THEN (SELECT MIN(D6.APV_DH) 
                                                                                FROM TBDCMACM023H D6 
                                                                                    ,TBBADDED103M D7
                                                                               WHERE D6.APV_DOC_NO = D7.APV_RQS_ID
                                                                                 AND D6.APVR_KND_CD = '1'
                                                                                 AND D7.RPRT_CD = 'A10600200'
                                                                                 AND D7.DOC_ID = D1.DOC_ID) END AS S5
                                    ,CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0013600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
                                                              ,DECODE(D2.APVR_PST_CD,'0057400',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'')) END                                AS E5   --과장결재일                               AS E5   --과장결재일
                                     ,CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0015800',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
                                                              ,DECODE(D2.APVR_PST_CD,'0035100',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
                                                              ,DECODE(D2.APVR_PST_CD,'0058100',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),''))) END                               AS E6   --국단실장결재일
                                     ,CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0045900',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
                                                              ,DECODE(D2.APVR_PST_CD,'0055600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'')) END                                AS E7   --사무차장결재일
                                     ,CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0055700',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'') END                                 AS E8 --사무총장결재일
                                     ,CASE WHEN D2.APVR_KND_CD = '1' THEN (SELECT TO_CHAR(MIN(D6.APV_DH), 'YYYY-MM-DD') 
                                                                                FROM TBDCMACM023H D6 
                                                                                    ,TBBADDED103M D7
                                                                               WHERE D6.APV_DOC_NO = D7.APV_RQS_ID
                                                                                 AND D6.APVR_KND_CD = '1'
                                                                                 AND D7.RPRT_CD = 'A10700100'
                                                                                 AND D6.APVR_STA_CD <> '401'
                                                                                 AND REF_ID = D1.DOC_ID) END AS S8
                                     ,CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN (SELECT MIN(D6.APV_DH)
                                                                                FROM TBDCMACM023H D6 
                                                                                    ,TBBADDED103M D7
                                                                               WHERE D6.APV_DOC_NO = D7.APV_RQS_ID
                                                                                 AND D6.APVR_KND_CD IN ('2','3','4')
                                                                                 AND D7.RPRT_CD = 'A10700100'
                                                                                 AND D7.APV_STA_CD = '30'
                                                                                 AND D6.APVR_PST_CD = '0010600'
                                                                                 AND D6.APVR_STA_CD <> '401'
                                                                                 AND REF_ID = D1.DOC_ID) END                                AS E9    --주심위원결재일
                                     
                                     ,CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0013600','5','0057400','5',
                                                                                      '0015800','6',
                                                                                      '0035100','6',
                                                                                      '0058100','6',
                                                                                      '0055600','7',
                                                                                      '0045900','7',
                                                                                      '0055700','7',
                                                                                      '')
                                           WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10700100' THEN DECODE(D2.APVR_PST_CD,'0010600','8',
                                                                                      '')
                                           WHEN D2.APVR_KND_CD = '1' THEN(DECODE(D1.RPRT_CD, 'A10600200', '5'
                                                                                           , 'A10700100', '8')) END AS APV_KND    --주심위원결재일
                                     ,D1.SYT_TRTM_DVSN_YN
                                     ,D3.PSD_APV_DDLN_DT
                                 FROM TBBADDED103M D1
                                     ,TBDCMACM023L D2
                                     ,TBBADDED003M D3
                                WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
                                  AND D1.AUD_YR = D3.AUD_YR(+)
                                  AND D1.AUD_NO = D3.AUD_NO(+)
                                  AND D1.AUD_YR           = #{audYr} --PARAM
                                  AND D1.AUD_NO           = #{audNo}
                                  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
                                  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
                                  AND D2.APVR_KND_CD IN ('1','2','3','4')
                                ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D2.APV_SNO,D2.APVR_SEQ
                               ) D3
                            GROUP BY PSD_APV_DDLN_DT
                           ) D4 , (SELECT LEVEL NO FROM DUAL CONNECT BY LEVEL <= (SELECT DECODE(PSD_APV_DDLN_DT, NULL, '4', '5') FROM TBBADDED003M WHERE AUD_YR = #{audYr} AND AUD_NO = #{audNo})) D5
                       )
                   WHERE STDT IS NOT NULL
	           UNION ALL
	           SELECT DATATYP
	                 , CMMCDNM
	                 , STDT
	                 , ENDDT
	              FROM (
	                SELECT '10' AS DATATYP
	                    , '시행일' CMMCDNM
	                    , TO_CHAR(TO_DATE(MIN(ENF_APV_DT)),'YYYY-MM-DD') AS STDT
	                    , '' AS ENDDT
	                 FROM TBBADDED003M
	                WHERE AUD_YR = #{audYr}
	                  AND AUD_NO = #{audNo}
	                GROUP BY AUD_YR, AUD_NO )
	             WHERE STDT IS NOT NULL
	           UNION ALL
	           SELECT '11' AS DATATYP
                      ,'종료보고' AS CMMCDNM
--                      ,TO_CHAR (MAX(DECODE(C1.APV_STA_CD,'30',C2.APV_DH,'')), 'YYYY-MM-DD')       AS STDT   --최종결재일
--                      ,TO_CHAR (MAX(DECODE(C1.APV_STA_CD,'30',C2.APV_DH,'')), 'YYYY-MM-DD')       AS ENDDT   --최종결재일
						, TO_CHAR(MAX(DECODE(C2.APVR_PST_CD,'0055600',F_GET_FIRST_APVR_DH(C1.DOC_ID,C2.APVR_CNB)
											,DECODE(C2.APVR_PST_CD,'0045900',F_GET_FIRST_APVR_DH(C1.DOC_ID,C2.APVR_CNB),''))), 'YYYY-MM-DD') AS STDT -- 사무차장, 본부장 결재일로 변경 2019.05.23 LSR
						, TO_CHAR(MAX(DECODE(C2.APVR_PST_CD,'0055600',F_GET_FIRST_APVR_DH(C1.DOC_ID,C2.APVR_CNB)
											,DECODE(C2.APVR_PST_CD,'0045900',F_GET_FIRST_APVR_DH(C1.DOC_ID,C2.APVR_CNB),''))), 'YYYY-MM-DD') AS ENDDT -- 사무차장, 본부장 결재일로 변경 2019.05.23 LSR
                  FROM TBBADDED103M C1
                      ,TBDCMACM023L C2
                 WHERE 1=1
                   AND C1.APV_RQS_ID  = C2.APV_DOC_NO
                   AND C1.RPRT_CD     = 'A10500200' --종료보고서
                   AND C1.AUD_YR = #{audYr}
                   AND C1.AUD_NO = #{audNo}
                 GROUP BY C1.AUD_YR, C1.AUD_NO )
	       WHERE STDT IS NOT NULL
	       ORDER BY TO_NUMBER(DATATYP)
	   ]]>
    </select>
</mapper> 
