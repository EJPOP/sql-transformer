<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.arp.dao.AEPARP002PMapper">

    <select id="selectDocIdList" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.aep.arp.dao.AEPARP002PMapper.selectDocIdList */
        <include refid="include.pageSelct" />
            SELECT DTIL_AUD_DOC_NO, DTIL_AUD_DOC_NM, DOC_ID
              FROM TBFDMADM002M
            <!-- 2019.01.09 hsyun 수사요청, 개별처분요구안 팝업 구분 -->
			<choose>
				<when test="audMainStepId == '600101'"> 
	        WHERE AUD_DOC_CD IN ('A10600100', 'A10601500')
	            </when>
	            <when test="audMainStepId == '600701'">
	        WHERE AUD_DOC_CD IN ('A10601100', 'A10601700')
	            </when>
	            <when test="audMainStepId == '600801'">
	        WHERE AUD_DOC_CD IN ('A10601320', 'A10601330', 'A10601340')
	            </when>
	            <when test="audMainStepId == '400801'">
	        WHERE AUD_DOC_CD IN ('A10950200', 'A10950300','A10950400', 'A10950500')
	            </when>
	            <when test="audMainStepId == '400901'">
	        WHERE AUD_DOC_CD IN ('A10950600', 'A10950800')
	            </when>
	            <when test="audMainStepId == '401001'">
	        WHERE AUD_DOC_CD IN ('A10950900', 'A10951000')
	            </when>
	            <otherwise>
	        WHERE AUD_DOC_CD IN ('A10600100', 'A10601100', 'A10601300','A10601320', 'A10601330', 'A10601340', 'A10601500', 'A10601700')
	            </otherwise>
            </choose>
            ORDER BY AUD_DOC_CD, DECODE(DTIL_AUD_DOC_NO,'613',1,DTIL_AUD_DOC_NO) 
        <include refid="include.pageOrder" />
    </select>
    
    <select id="selectDocIdList2" parameterType="paramMap" resultType="egovMap" >
    	<include refid="include.pageSelct" />
    	<![CDATA[
         SELECT D1.TSK_KND_CD,
        	   F_CODE_NM('1000787', D1.TSK_KND_CD) AS TSK_KND_NM,
        	   D1.AUD_STEP_CD,
        	   F_CODE_NM('1000785', D1.AUD_STEP_CD) AS AUD_STEP_NM,
        	   D1.AUD_DOC_CD,
        	   --F_CODE_NM('1000786', D1.AUD_DOC_CD) AS AUD_DOC_NM,
        	   D2.DTIL_AUD_DOC_NO,
        	   D2.DTIL_AUD_DOC_NM,
        	   DOC_ID,
               CON_PGM_CD
          FROM TBFDMADM001M D1, TBFDMADM002M D2
         WHERE D1.AUD_DOC_CD = D2.AUD_DOC_CD(+)
           AND D2.HIDDEN_YN = 'N'
           AND D1.APV_WAY_CD <> '40'	  --현장징구 문서는 검색제외
           AND D1.TSK_KND_CD = 'A10'	  --실지감사
           AND D2.DOC_KND_CD <> '30'      --첨부문서는 검색제외
           AND (D1.AUD_STEP_CD = 'A1040' OR D1.AUD_STEP_CD ='A1095')
           AND D1.AUD_DOC_CD IN ('A10951200', 'A10951300')
        ]]>
           AND NOT EXISTS (
                           SELECT 1
                             FROM TBBADDED102B D3
                            WHERE D3.AUD_STEP_CD = D1.AUD_STEP_CD
                              AND AUD_DOC_CD IS NOT NULL
                              AND D2.AUD_DOC_CD = D3.AUD_DOC_CD
                          )
           ORDER BY D1.AUD_STEP_CD, D2.DTIL_AUD_DOC_NO 
        <include refid="include.pageOrder" />
    </select>

</mapper> 