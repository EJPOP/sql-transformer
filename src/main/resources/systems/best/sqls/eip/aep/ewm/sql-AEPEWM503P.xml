<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.ewm.dao.AEPEWM503PMapper">
	
	<!-- 징계위원회 출석 결과 보고 문서 목록 조회  selectAepevmList-->
	<select id="selectAepevmList"  parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM503PMapper.selectAepevmList */
			SELECT A.AUD_YR,
	                 A.AUD_NO,
	                 A.AUD_STEP_CD,
	                 A.DOC_ID,
	                 A.RPRT_NM,
	                 A.RPRT_CD,
	                 F_DPT_INFO(B.SND_DPT_CD,'1') AS SND_DPT_NM,
	                 (SELECT
                              CASE 
                                WHEN S1.APV_STA_CD = '3' THEN '결재완료 ('||TO_CHAR(S1.FNL_APV_DH, 'YY.MM.DD HH24:MI')||' )'
                                ELSE F_CODE_NM('1000773',A.APV_STA_CD) 
                              END 
		             FROM TBDCMACM022L S1
		            WHERE S1.APV_DOC_NO = A.APV_RQS_ID) AS  APV_STA_NM,
		            A.APV_RQS_ID,
	                TO_CHAR(B.SND_DH ,'YY"."MM"."DD HH24":"MI') AS SND_DH ,
	                A.REF_ID	,
	                A.APV_STA_CD,
	                F_OPEN_EDIT(A.LINK_URL) AS DOC_TYPE,
	                A.AUD_KND_CD,
	                F_MNG_KND_AUDYRNO(A.AUD_YR, A.AUD_NO, A.AUD_KND_CD, '-') AS AUD_YR_NO,   
	                A.SORT_SNO
           FROM TBBADDED103M A
           JOIN TBBADDED111M B 
          ON(A.AUD_YR = B.AUD_YR AND A.AUD_NO = B.AUD_NO AND A.AUD_STEP_CD = B.AUD_STEP_CD AND A.DOC_ID = B.DOC_ID)
          WHERE 1=1
          AND A.AUD_YR =  #{audYr}
          AND A.AUD_NO =  #{audNo}
          AND A.AUD_STEP_CD = #{audStepCd}
          AND A.REF_ID = #{dspRqSno}
          ORDER BY A.SORT_SNO
	</select>


	
</mapper> 
