<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.cfr.dao.AEPCFR012QMapper">

    <select id="selectInfCmtRslt" parameterType="paramMap" resultType="egovMap">
    	/*kr.go.bai.eip.aep.cfr.dao.AEPCFR012QMapper.selectInfCmtRslt*/
    	<include refid="include.pageSelct" />
			SELECT A.TBL_DES ||'('|| A.TBL_NM ||')'AS TBL_DVSN
			     , A.TBL_DES
			     , A.TBL_NM
                 , F_CODE_NM('1000848',A.IF_WAY_DVSN ) AS IF_WAY_DVSN_NM
				 , A.TRNM_DATA_CNT
				 , A.IF_MSG
                 , TO_CHAR(A.IF_STR_DH, 'YYYY-MM-DD HH24:MI:SS') AS IF_STR_DH
                 , TO_CHAR(A.IF_END_DH, 'YYYY-MM-DD HH24:MI:SS') AS IF_END_DH
                 , A.TRNM_DY
                 , A.IF_SEQ
			 FROM EA_INF_CMT_RSLT_INFO A
			WHERE 1=1
              AND A.TRNM_DY BETWEEN REPLACE(#{schStrDt},'-') AND REPLACE(#{schEndDt},'-')
			<if test='schTblNm != null and schTblNm != ""'>
			  AND A.TBL_NM = #{schTblNm}
			</if>
			<if test='srDvsn != null and srDvsn != ""'>
			  AND A.SR_DVSN = #{srDvsn}
			</if>
             <if test='schIfWayDvsn != null and schIfWayDvsn != ""'>
              AND A.IF_WAY_DVSN = #{schIfWayDvsn}
            </if>
			ORDER BY A.IF_STR_DH DESC
		<include refid="include.pageOrder" />
    </select>

    <select id="selectEaInfTBBADDED113M" parameterType="paramMap" resultType="egovMap">
    	/*kr.go.bai.eip.aep.cfr.dao.AEPCFR012QMapper.selectEaInfTBBADDED113M*/
    	<include refid="include.pageSelct" />
			SELECT A.AUD_YR
				 , A.AUD_NO
				 , A.AFF_SNO
			     , A.DSP_RQ_SNO
			     , TO_CHAR(TO_DATE(A.SBCN_REGI_REQ_DT) , 'YYYY-MM-DD') AS SBCN_REGI_REQ_DT
                 , A.SBCN_NBC
                 , TO_CHAR(TO_DATE(A.SBCN_DY) , 'YYYY-MM-DD') AS SBCN_DY
                 , A.SBCN_PAGE_CNT
                 , A.SBCN_NO
                 , A.SBCN_PRSS_DPT_NM
                 , A.IF_CHNG_STAT_DVSN
                 , A.IF_MSG
                 , TO_CHAR(A.IF_TRNS_DH, 'YYYY-MM-DD HH24:MI:SS') AS IF_TRNS_DH
                 , 'TBBADDED113M' AS TBL_NM
                 , A.TRNM_DY
                 , A.IF_SEQ
                 , A.DOC_ID
                 , A.APVR_CD
                 , F_MNG_KND_AUDYRNO(A.AUD_YR, A.AUD_NO, A.AUD_KND_CD, '-') AS AUD_YR_NO    --분류번호
			 FROM EA_INF_TBBADDED113M A
			WHERE 1=1
			<if test='trnmDy != null and trnmDy != ""'>
			  AND A.TRNM_DY = #{trnmDy}
			</if>
			<if test='ifSeq != null and ifSeq != ""'>
			  AND A.IF_SEQ = #{ifSeq}
			</if>
            ORDER BY A.AFF_SNO, A.DSP_RQ_SNO   
		<include refid="include.pageOrder" />
    </select>
    
    <select id="selectEaInfTBBADDED120M" parameterType="paramMap" resultType="egovMap">
    	/*kr.go.bai.eip.aep.cfr.dao.AEPCFR012QMapper.selectEaInfTBBADDED120M*/
    	<include refid="include.pageSelct" />
			SELECT TO_CHAR(TO_DATE(A.CMT_DY) , 'YYYY-MM-DD') AS CMT_DY
				 , A.CMT_SQ
				 , A.CMT_DVSN_CD
				 , A.TIME_DVSN_CD
			     , A.CMT_TIME
			     , A.CMT_MIN
                 , A.CMT_TIT
                  , CASE A.TIME_DVSN_CD WHEN 'AM' THEN '오전'
                                        WHEN 'PM' THEN '오후'
                                        ELSE '' END || DECODE(A.CMT_TIME,NULL,'',A.CMT_TIME||'시') 
                  || DECODE(A.CMT_MIN,NULL,'',A.CMT_MIN||'분') AS CMT_DY_NM
                 , A.CMT_END_YN
                 , TO_CHAR(A.CMT_END_DH, 'YYYY-MM-DD HH24:MI:SS') AS CMT_END_DH 
                 , A.CMT_SBCN_YN
                 , A.IF_CHNG_STAT_DVSN
                 , A.IF_MSG
                 , TO_CHAR(A.IF_TRNS_DH, 'YYYY-MM-DD HH24:MI:SS') AS IF_TRNS_DH
                 , 'TBBADDED120M' AS TBL_NM
                 , A.TRNM_DY
                 , A.IF_SEQ
			 FROM EA_INF_TBBADDED120M A
			WHERE 1=1
			<if test='trnmDy != null and trnmDy != ""'>
			  AND A.TRNM_DY = #{trnmDy}
			</if>
			<if test='ifSeq != null and ifSeq != ""'>
			  AND A.IF_SEQ = #{ifSeq}
			</if>
			ORDER BY A.CMT_DY
		<include refid="include.pageOrder" />
    </select>
    
    <select id="selectEaInfTBBADFRE113M" parameterType="paramMap" resultType="egovMap">
    	/*kr.go.bai.eip.aep.cfr.dao.AEPCFR012QMapper.selectEaInfTBBADFRE113M*/
    	<include refid="include.pageSelct" />
			SELECT A.ACP_YR
			     , DECODE(A.ACP_DVSN_CD,'1','심사','2','재심') AS ACP_DVSN_NM
				 , A.ACP_DVSN_CD
				 , A.ACP_SRNO
				 , A.AFF_SNO
			     , A.DSP_RQ_SNO
                 , TO_CHAR(TO_DATE(A.SBCN_REGI_REQ_DT) , 'YYYY-MM-DD') AS SBCN_REGI_REQ_DT
                 , A.SBCN_REGI_REQ_YN
                 , A.SBCN_NBC
                 , TO_CHAR(TO_DATE(A.SBCN_DY) , 'YYYY-MM-DD') AS SBCN_DY
                 , SBCN_DY
                 , SBCN_PAGE_CNT
                 , A.SBCN_NO
                 , A.IF_MSG
                 , A.IF_CHNG_STAT_DVSN
                 , TO_CHAR(A.IF_TRNS_DH, 'YYYY-MM-DD HH24:MI:SS') AS IF_TRNS_DH
                 , 'TBBADFRE113M' AS TBL_NM
                 , A.TRNM_DY
                 , A.IF_SEQ
                 , A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' ||A.ACP_SRNO AS ACP_YR_NO /* 분류번호 */
			 FROM EA_INF_TBBADFRE113M A
			WHERE 1=1
			<if test='trnmDy != null and trnmDy != ""'>
			  AND A.TRNM_DY = #{trnmDy}
			</if>
			<if test='ifSeq != null and ifSeq != ""'>
			  AND A.IF_SEQ = #{ifSeq}
			</if>
            ORDER BY A.AFF_SNO, A.DSP_RQ_SNO   
		<include refid="include.pageOrder" />
    </select>
    
    <select id="selecCntInfCmtRslt" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.aep.cfr.dao.AEPCFR012QMapper.selecCntInfCmtRslt*/
     <![CDATA[     
          SELECT   
                 COUNT(1) AS TRNM_DATA_CNT
                ,'1' AS SNO
		    FROM
		         (
		            SELECT 
		                   CASE WHEN TO_CHAR(FRT_REGI_DH, 'YYYYMMDDHH24MISS') > #{maxIfStrDh1} then 'I'
		                        WHEN TO_CHAR(FNL_MDF_DH,'YYYYMMDDHH24MISS') > #{maxIfStrDh1} then 'U'
		                        ELSE 'E'
		                   END IF_CHNG_STAT_DVSN
		             FROM TBBADDED113M A
		            WHERE 1=1
		              AND TO_CHAR(FNL_MDF_DH, 'YYYYMMDDHH24MI') >  #{maxIfStrDh1}
		        ) B
		   WHERE 1=1
     ]]>
             <if test='maxIfStrDh1 != "0"'>
              AND B.IF_CHNG_STAT_DVSN = 'U'  
             </if>
     <![CDATA[     
       UNION ALL
           SELECT   
                 COUNT(1) AS TRNM_DATA_CNT
                ,'2' AS SNO
		    FROM
		         (
		            SELECT 
		                   CASE WHEN TO_CHAR(FRT_REGI_DH, 'YYYYMMDDHH24MISS') > #{maxIfStrDh2} then 'I'
		                        WHEN TO_CHAR(FNL_MDF_DH,'YYYYMMDDHH24MISS') > #{maxIfStrDh2} then 'U'
		                        ELSE 'E'
		                   END IF_CHNG_STAT_DVSN
		             FROM TBBADDED120M A
		            WHERE 1=1
		              AND TO_CHAR(FNL_MDF_DH, 'YYYYMMDDHH24MI') >  #{maxIfStrDh2}
		        ) B
		    WHERE 1=1
     ]]>
             <if test='maxIfStrDh2 != "0"'>
              AND B.IF_CHNG_STAT_DVSN = 'U'  
             </if>
     <![CDATA[     
              UNION ALL
          SELECT   
                 COUNT(1) AS TRNM_DATA_CNT
                ,'3' AS SNO
		    FROM
		         (
		            SELECT 
		                   CASE WHEN TO_CHAR(FRT_REGI_DH, 'YYYYMMDDHH24MISS') > #{maxIfStrDh3} then 'I'
		                        WHEN TO_CHAR(FNL_MDF_DH,'YYYYMMDDHH24MISS') > #{maxIfStrDh3} then 'U'
		                        ELSE 'E'
		                   END IF_CHNG_STAT_DVSN
		             FROM TBBADFRE113M A
		            WHERE 1=1
		              AND TO_CHAR(FNL_MDF_DH, 'YYYYMMDDHH24MI') >  #{maxIfStrDh3}
		        ) B
		    WHERE 1=1
     ]]>
             <if test='maxIfStrDh3 != "0"'>
              AND B.IF_CHNG_STAT_DVSN = 'U'  
             </if>
       ORDER BY SNO                             
    </select>
</mapper> 