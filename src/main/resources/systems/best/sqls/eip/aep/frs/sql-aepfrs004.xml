<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.go.bai.eip.aep.frs.dao.AEPFRS004QMapper">
    
    <!-- 포렌식 요청 목록 조회 -->
    <select id="selectMainList" parameterType="paramMap" resultType="egovMap" >
        <![CDATA[
        /* kr.go.bai.eip.aep.frs.dao.AEPRLA004QMapper.selectMainList */
        SELECT T1.AUD_YR           /* 감사년도 */
              ,T1.AUD_NO           /* 감사번호 */
              ,F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, '', '-') AS AUD_YR_NO /* 분류번호 */
              ,T2.AUD_SBJ_NM       /* 감사사항명 */
              ,T2.AUD_KND_CD       /* 감사종류 */
              ,T1.FRS_REQ_SRNO     /* 포렌식 요청 일련번호 */
              ,T1.AUD_STEP_CD      /* 감사단계코드 */
              ,T1.FRS_REQ_DVSN_CD  /* 포렌식 요청 구분 코드 */
              ,F_CODE_NM('1000798',FRS_REQ_DVSN_CD) AS FRS_REQ_DVSN_NM  /* 포렌식 요청 구분명 */
              ,T1.REQ_DPT_CD       /* 요청부서코드 */
              ,(SELECT E.DPT_NM
			          FROM TBDCMACM002M E
			         WHERE E.DPT_CD = T1.REQ_DPT_CD) AS REQ_DPT_NM      /* 요청부서명 */
              ,T1.REQ_DH           /* 요청일시 */
              ,TO_CHAR(T1.REQ_DH,'yyyy-MM-dd') AS REQ_DT /* 요청일자 */
              ,T1.REQ_CNB          /* 요청자전산번호 */
              ,(SELECT E.USR_NAM
			          FROM TBDCMACM001M E
			         WHERE E.CNB = T1.REQ_CNB) AS USR_NAM /* 요청자명 */
              ,T1.REQ_STAT_CD      /* 요청상태코드 */
              ,F_CODE_NM('1000994',T1.REQ_STAT_CD) AS REQ_STAT_NM /* 요청상태명 */
              ,(SELECT RPRT_NM
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610100'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS RPRT_NM /* 포렌식 요청 계획서명 */
              ,(SELECT F_CODE_NM('1000773',A.APV_STA_CD) 
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610100'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS REQ_DOC_APV_STA_NM /* 요청서 작성,결재상태 */
              ,T1.ORG_CD	       /* 대상기관코드 */
              ,F_ORG_INFO(T1.ORG_CD, '1') AS ORG_NM /* 대상기관명 */
              ,T1.FRS_DPT_RCP_YN   /* 포렌식 법무부서 접수여부 */
              ,DECODE(T1.FRS_SYS_RCP_YN,'N','미접수','Y',(DECODE(T1.HNDL_RPT_OM_YN,'Y','완료','N','접수'))) AS RCP_NM
              ,T1.FRS_DPT_RCP_DH   /* 포렌식 법무부서 접수일시 */
              ,T1.REV_OPT_RCV_YN   /* 검토의견서 수신여부 */
              ,T1.REV_OPT_RCV_DH   /* 검토의견서 수신일시 */
              ,T1.REV_OPT_OM_YN    /* 검토의견서 발신여부 */
              ,T1.REV_OPT_OM_DH    /* 검토의견서 발신일시 */
              ,(SELECT F_CODE_NM('1000773',A.APV_STA_CD) 
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610210'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS REV_DOC_APV_STA_NM /* 의견서 작성,결재상태 */ 
              ,TO_CHAR(T1.HNDL_DH,'YYYY-MM-DD') AS HNDL_DH /* 처리일시 */
              ,F_USR_INFO(T1.HNDL_PEN_CNB, '2') AS HNDL_PEN_NM /* 처리자명 */
              ,T1.HNDL_PEN_CNB     /* 처리자전산번호 */
              ,T1.HNDL_DPT_CD      /* 처리부서코드 */
              ,T1.HNDL_RPT_RCV_YN  /* 처리보고서 수신여부 */
              ,T1.HNDL_RPT_RCV_DH  /* 처리보고서 수신일시 */
              ,T1.HNDL_RPT_OM_YN   /* 처리보고서 발신여부 */
              ,T1.FRS_SYS_RCP_YN   /* 포렌식 시스템운영과 접수여부 */
              ,T1.FRS_SYS_RCP_DH   /* 포렌식 시스템운영과 접수일시 */
              ,T1.DOC_ID
              ,(SELECT F_CODE_NM('1000773',A.APV_STA_CD) 
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610300'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS HNDL_DOC_APV_STA_NM /* 처리서 작성,결재상태 */ 
              ,(SELECT COUNT(*)
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610300'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS HNDL_DOC_CNT /* 처리서 갯수 */ 
			  ,(SELECT MAX(DOC_ID) FROM TBAEPFRS101L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND FRS_REQ_SRNO = T1.FRS_REQ_SRNO AND FILE_DVSN = 'AG') AS DOC_ID2
         FROM
        ]]>
               TBAEPFRS101M T1, TBBADDED001M T2 
        WHERE  
               T1.AUD_YR = T2.AUD_YR
          AND  T1.AUD_NO = T2.AUD_NO
          AND  T1.REQ_STAT_CD > 50  

        <if test="schAudYr != null and schAudYr != ''">
          AND  T1.AUD_YR = #{schAudYr}
        </if>
        <if test="schAudYrNoKndCd != null and schAudYrNoKndCd != ''">
          AND  T2.AUD_KND_CD = #{schAudYrNoKndCd}
        </if>
        <if test="schAudGrnNo != null and schAudGrnNo != ''">
          AND  T2.AUD_GRN_NO = #{schAudGrnNo}
        </if>
        <if test="schAudSbjNm != null and schAudSbjNm != ''">
          AND  T2.AUD_SBJ_NM LIKE '%'||#{schAudSbjNm}||'%'
        </if>
        ORDER BY T1.REQ_DH DESC
                 
    </select>
    
    <!-- 포렌식 처리 목록 엑셀다운로드 목록 조회 -->
    <select id="selectMainHndlList" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.aep.frs.dao.AEPFRS004EMapper.selectMainHndlList */
		<![CDATA[    
		SELECT T1.AUD_YR           /* 감사년도 */
              ,T1.AUD_NO           /* 감사번호 */
              ,F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, '', '-') AS AUD_YR_NO /* 분류번호 */
              ,T2.AUD_SBJ_NM       /* 감사사항명 */
              ,T2.AUD_KND_CD       /* 감사종류 */
              ,T1.FRS_REQ_SRNO     /* 포렌식 요청 일련번호 */
              ,T1.AUD_STEP_CD      /* 감사단계코드 */
              ,T1.FRS_REQ_DVSN_CD  /* 포렌식 요청 구분 코드 */
              ,F_CODE_NM('1000798',FRS_REQ_DVSN_CD) AS FRS_REQ_DVSN_NM  /* 포렌식 요청 구분명 */
              ,T1.REQ_DPT_CD       /* 요청부서코드 */
              ,(SELECT E.DPT_NM
			          FROM TBDCMACM002M E
			         WHERE E.DPT_CD = T1.REQ_DPT_CD) AS REQ_DPT_NM      /* 요청부서명 */
              ,T1.REQ_DH           /* 요청일시 */
              ,TO_CHAR(T1.REQ_DH,'yyyy-MM-dd') AS REQ_DT /* 요청일자 */
              ,T1.REQ_CNB          /* 요청자전산번호 */
              ,(SELECT E.USR_NAM
			          FROM TBDCMACM001M E
			         WHERE E.CNB = T1.REQ_CNB) AS USR_NAM /* 요청자명 */
              ,T1.REQ_STAT_CD      /* 요청상태코드 */
              ,F_CODE_NM('1000994',T1.REQ_STAT_CD) AS REQ_STAT_NM /* 요청상태명 */
              ,(SELECT RPRT_NM
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610100'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS RPRT_NM /* 포렌식 요청 계획서명 */
              ,(SELECT F_CODE_NM('1000773',A.APV_STA_CD) 
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610100'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS REQ_DOC_APV_STA_NM /* 요청서 작성,결재상태 */
              ,T1.ORG_CD	       /* 대상기관코드 */
              ,F_ORG_INFO(T1.ORG_CD, '1') AS ORG_NM /* 대상기관명 */
              ,T1.FRS_DPT_RCP_YN   /* 포렌식 법무부서 접수여부 */
              ,DECODE(T1.FRS_SYS_RCP_YN,'N','미접수','Y',(DECODE(T1.HNDL_RPT_OM_YN,'Y','완료','N','접수'))) AS RCP_NM
              ,T1.FRS_DPT_RCP_DH   /* 포렌식 법무부서 접수일시 */
              ,T1.REV_OPT_RCV_YN   /* 검토의견서 수신여부 */
              ,T1.REV_OPT_RCV_DH   /* 검토의견서 수신일시 */
              ,T1.REV_OPT_OM_YN    /* 검토의견서 발신여부 */
              ,T1.REV_OPT_OM_DH    /* 검토의견서 발신일시 */
              ,(SELECT F_CODE_NM('1000773',A.APV_STA_CD) 
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610210'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS REV_DOC_APV_STA_NM /* 의견서 작성,결재상태 */ 
              ,TO_CHAR(T1.HNDL_DH,'YYYY-MM-DD') AS HNDL_DH /* 처리일시 */
              ,F_USR_INFO(T1.HNDL_PEN_CNB, '2') AS HNDL_PEN_NM /* 처리자명 */
              ,T1.HNDL_PEN_CNB     /* 처리자전산번호 */
              ,T1.HNDL_DPT_CD      /* 처리부서코드 */
              ,T1.HNDL_RPT_RCV_YN  /* 처리보고서 수신여부 */
              ,T1.HNDL_RPT_RCV_DH  /* 처리보고서 수신일시 */
              ,T1.HNDL_RPT_OM_YN   /* 처리보고서 발신여부 */
              ,T1.FRS_SYS_RCP_YN   /* 포렌식 시스템운영과 접수여부 */
              ,T1.FRS_SYS_RCP_DH   /* 포렌식 시스템운영과 접수일시 */
              ,T1.DOC_ID
              ,(SELECT F_CODE_NM('1000773',A.APV_STA_CD) 
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610300'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS HNDL_DOC_APV_STA_NM /* 처리서 작성,결재상태 */ 
              ,(SELECT COUNT(*)
                  FROM TBBADDED103M A
				 WHERE A.AUD_YR = T1.AUD_YR
				   AND A.AUD_NO = T1.AUD_NO
				   AND A.RPRT_CD = 'A10610300'
				   AND A.REF_ID = T1.FRS_REQ_SRNO ) AS HNDL_DOC_CNT /* 처리서 갯수 */ 
			  ,(SELECT MAX(DOC_ID) FROM TBAEPFRS101L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND FRS_REQ_SRNO = T1.FRS_REQ_SRNO AND FILE_DVSN = 'AG') AS DOC_ID2   
		      ,count(CASE WHEN T4.FRS_TYPE_CD = '03' THEN '1'
		                  ELSE ''   
		              END ) AS FRS_TYPE_TOT3 /* 하드디스크   */
		      ,count(CASE WHEN T4.FRS_TYPE_CD = '10' THEN '1'
		                  ELSE ''   
		              END ) AS FRS_TYPE_TOT11 /* 모바일 */
		      ,count(CASE WHEN T4.FRS_TYPE_CD = '14' THEN '1'
		                  ELSE ''   
		              END ) AS FRS_TYPE_TOT12 /* 태블릿 */
		      ,count(CASE WHEN T4.FRS_TYPE_CD = '05' THEN '1'
		                  ELSE ''   
		              END ) AS FRS_TYPE_TOT4 /* USB   */
		      ,count(CASE WHEN T4.FRS_TYPE_CD = '04' THEN '1'
		                  ELSE ''   
		              END ) AS FRS_TYPE_TOT5 /* 외장하드디스크   */
		FROM
		        ]]>
		       TBAEPFRS101M T1, TBBADDED001M T2,
		       TBAEPFRS102M T3, TBAEPFRS102D T4
        WHERE  
               T1.AUD_YR = T2.AUD_YR
          AND  T1.AUD_NO = T2.AUD_NO
--          AND  (SELECT A.APV_STA_CD
--                 FROM TBBADDED103M A
--                 WHERE A.AUD_YR = T1.AUD_YR
--                 AND A.AUD_NO = T1.AUD_NO
--                 AND A.RPRT_CD = 'A10610100'
--                 AND A.REF_ID = T1.FRS_REQ_SRNO ) = '30'
          AND T1.REQ_STAT_CD > 50
		  AND T3.AUD_YR = T4.AUD_YR(+)
		  AND T3.AUD_NO = T4.AUD_NO(+)
		  AND T3.FRS_REQ_SRNO = T4.FRS_REQ_SRNO(+)
		  AND T3.FRS_TG_SRNO = T4.FRS_TG_SRNO(+)   
		  AND T1.AUD_YR = T3.AUD_YR(+)
		  AND T1.AUD_NO = T3.AUD_NO(+)
		  AND T1.FRS_REQ_SRNO = T3.FRS_REQ_SRNO(+)
		  <if test="schAudYr != null and schAudYr != ''">
		  AND  T1.AUD_YR = #{schAudYr}
		  </if>
		  <if test="schAudYrNoKndCd != null and schAudYrNoKndCd != ''">
		  AND  T2.AUD_KND_CD = #{schAudYrNoKndCd}
		  </if>
		  <if test="schAudGrnNo != null and schAudGrnNo != ''">
		  AND  T2.AUD_GRN_NO = #{schAudGrnNo}
		  </if>
		  <if test="schAudSbjNm != null and schAudSbjNm != ''">
		  AND  T2.AUD_SBJ_NM LIKE '%'||#{schAudSbjNm}||'%'
		  </if>     
		  GROUP BY 
              T1.AUD_YR           /* 감사년도 */
              ,T1.AUD_NO           /* 감사번호 */
              ,T2.AUD_SBJ_NM       /* 감사사항명 */
              ,T2.AUD_KND_CD       /* 감사종류 */
              ,T1.FRS_REQ_SRNO     /* 포렌식 요청 일련번호 */
              ,T1.AUD_STEP_CD      /* 감사단계코드 */
              ,T1.FRS_REQ_DVSN_CD  /* 포렌식 요청 구분 코드 */
              ,T1.REQ_DPT_CD       /* 요청부서코드 */
              ,T1.REQ_DH           /* 요청일시 */
              ,T1.REQ_CNB          /* 요청자전산번호 */
              ,T1.REQ_STAT_CD      /* 요청상태코드 */
              ,T1.ORG_CD	       /* 대상기관코드 */
              ,T1.FRS_DPT_RCP_YN   /* 포렌식 법무부서 접수여부 */
              ,T1.FRS_DPT_RCP_DH   /* 포렌식 법무부서 접수일시 */
              ,T1.REV_OPT_RCV_YN   /* 검토의견서 수신여부 */
              ,T1.REV_OPT_RCV_DH   /* 검토의견서 수신일시 */
              ,T1.REV_OPT_OM_YN    /* 검토의견서 발신여부 */
              ,T1.REV_OPT_OM_DH    /* 검토의견서 발신일시 */
              ,T1.HNDL_DH  /* 처리일시 */
              ,T1.HNDL_PEN_CNB     /* 처리자전산번호 */
              ,T1.HNDL_DPT_CD      /* 처리부서코드 */
              ,T1.HNDL_RPT_RCV_YN  /* 처리보고서 수신여부 */
              ,T1.HNDL_RPT_RCV_DH  /* 처리보고서 수신일시 */
              ,T1.HNDL_RPT_OM_YN   /* 처리보고서 발신여부 */
              ,T1.FRS_SYS_RCP_YN   /* 포렌식 시스템운영과 접수여부 */
              ,T1.FRS_SYS_RCP_DH   /* 포렌식 시스템운영과 접수일시 */
              ,T1.DOC_ID
		 ORDER BY T1.REQ_DH DESC
    </select>

    <!-- 포렌식 자료매체 합계 목록 조회 -->
	<select id="selectMdmTotList" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.aep.frs.dao.AEPFRS004QMapper.selectMdmTotList */
        <![CDATA[
        	SELECT nvl(count(FRS_TG_TOT),0) AS FRS_TG_TOT
        	      ,nvl(sum(USR_TYPE_TOT1),0) AS USR_TYPE_TOT1
        	      ,nvl(sum(USR_TYPE_TOT2),0) AS USR_TYPE_TOT2
        	      ,nvl(sum(FRS_TYPE_TOT1),0) AS FRS_TYPE_TOT1
        	      ,nvl(sum(FRS_TYPE_TOT2),0) AS FRS_TYPE_TOT2
        	      ,nvl(sum(FRS_TYPE_TOT3),0) AS FRS_TYPE_TOT3
        	      ,nvl(sum(FRS_TYPE_TOT4),0) AS FRS_TYPE_TOT4
        	      ,nvl(sum(FRS_TYPE_TOT5),0) AS FRS_TYPE_TOT5
        	      ,nvl(sum(FRS_TYPE_TOT6),0) AS FRS_TYPE_TOT6
        	      ,nvl(sum(FRS_TYPE_TOT7),0) AS FRS_TYPE_TOT7
        	      ,nvl(sum(FRS_TYPE_TOT8),0) AS FRS_TYPE_TOT8
        	      ,nvl(sum(FRS_TYPE_TOT9),0) AS FRS_TYPE_TOT9
        	      ,nvl(sum(FRS_TYPE_TOT10),0) AS FRS_TYPE_TOT10
        	      ,nvl(sum(FRS_TYPE_TOT11),0) AS FRS_TYPE_TOT11
        	      ,nvl(sum(FRS_TYPE_TOT12),0) AS FRS_TYPE_TOT12
        	  FROM (
		        	SELECT T1.FRS_TG||T1.AUD_YR||T1.AUD_NO||T1.FRS_REQ_SRNO||T1.FRS_TG_SRNO  AS FRS_TG_TOT /* 인원   */
		        		  ,count(CASE WHEN T2.USR_TYPE = '01' THEN '1'
                                      ELSE '' 
                                  END ) AS USR_TYPE_TOT1 /* 공용  */
                          ,count(CASE WHEN T2.USR_TYPE = '02' THEN '1'
                                      ELSE ''
                                  END ) AS USR_TYPE_TOT2 /* 개인  */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '01' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT1 /* 데스크톱   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '02' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT2 /* 노트북   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '03' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT3 /* 하드디스크   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '05' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT4 /* USB   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '04' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT5 /* 외장하드디스크   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '15' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT6 /* 메모리카드 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '08' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT7 /* 이메일 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '16' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT8 /* 메신저 */ 
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '11' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT9 /* 웹하드 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '13' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT10 /* 클라우드 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '10' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT11 /* 모바일 */ 
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '14' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT12 /* 태블릿 */  
		        	  FROM TBAEPFRS102M T1
		        		  ,TBAEPFRS102D T2
		        	 WHERE 1=1
		        	   AND T1.AUD_YR = T2.AUD_YR(+)
		        	   AND T1.AUD_NO = T2.AUD_NO(+)
		        	   AND T1.FRS_REQ_SRNO = T2.FRS_REQ_SRNO(+)
		        	   AND T1.FRS_TG_SRNO = T2.FRS_TG_SRNO(+)
		          GROUP BY T1.FRS_TG||T1.AUD_YR||T1.AUD_NO||T1.FRS_REQ_SRNO||T1.FRS_TG_SRNO
	             )
		]]>
	</select> 
	
    <!-- 포렌식 자료매체 합계 목록 조회 -->
	<select id="selectMdmTotList2" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.aep.frs.dao.AEPFRS004QMapper.selectMdmTotList2 */
        <![CDATA[
        	SELECT nvl(count(FRS_TG_TOT),0) AS FRS_TG_TOT
        	      ,nvl(sum(USR_TYPE_TOT1),0) AS USR_TYPE_TOT1
        	      ,nvl(sum(USR_TYPE_TOT2),0) AS USR_TYPE_TOT2
        	      ,nvl(sum(FRS_TYPE_TOT1),0) AS FRS_TYPE_TOT1
        	      ,nvl(sum(FRS_TYPE_TOT2),0) AS FRS_TYPE_TOT2
        	      ,nvl(sum(FRS_TYPE_TOT3),0) AS FRS_TYPE_TOT3
        	      ,nvl(sum(FRS_TYPE_TOT4),0) AS FRS_TYPE_TOT4
        	      ,nvl(sum(FRS_TYPE_TOT5),0) AS FRS_TYPE_TOT5
        	      ,nvl(sum(FRS_TYPE_TOT6),0) AS FRS_TYPE_TOT6
        	      ,nvl(sum(FRS_TYPE_TOT7),0) AS FRS_TYPE_TOT7
        	      ,nvl(sum(FRS_TYPE_TOT8),0) AS FRS_TYPE_TOT8
        	      ,nvl(sum(FRS_TYPE_TOT9),0) AS FRS_TYPE_TOT9
        	      ,nvl(sum(FRS_TYPE_TOT10),0) AS FRS_TYPE_TOT10
        	      ,nvl(sum(FRS_TYPE_TOT11),0) AS FRS_TYPE_TOT11
        	      ,nvl(sum(FRS_TYPE_TOT12),0) AS FRS_TYPE_TOT12
        	  FROM (
		        	SELECT T1.FRS_TG||T1.AUD_YR||T1.AUD_NO||T1.FRS_REQ_SRNO||T1.FRS_TG_SRNO  AS FRS_TG_TOT /* 인원   */
		        		  ,count(CASE WHEN T2.USR_TYPE = '01' THEN '1'
                                      ELSE '' 
                                  END ) AS USR_TYPE_TOT1 /* 공용  */
                          ,count(CASE WHEN T2.USR_TYPE = '02' THEN '1'
                                      ELSE ''
                                  END ) AS USR_TYPE_TOT2 /* 개인  */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '01' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT1 /* 데스크톱   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '02' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT2 /* 노트북   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '03' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT3 /* 하드디스크   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '05' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT4 /* USB   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '04' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT5 /* 외장하드디스크   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '15' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT6 /* 메모리카드 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '08' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT7 /* 이메일 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '16' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT8 /* 메신저 */ 
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '11' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT9 /* 웹하드 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '13' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT10 /* 클라우드 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '10' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT11 /* 모바일 */ 
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '14' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT12 /* 태블릿 */  
		        	  FROM TBAEPFRS102M T1
		        		  ,TBAEPFRS102D T2
		        	 WHERE 1=1
		        	   AND T1.AUD_YR = T2.AUD_YR(+)
		        	   AND T1.AUD_NO = T2.AUD_NO(+)
		        	   AND T1.FRS_REQ_SRNO = T2.FRS_REQ_SRNO(+)
		        	   AND T1.FRS_TG_SRNO = T2.FRS_TG_SRNO(+)
		        	   AND T1.AUD_YR = #{audYr}
		        	   AND T1.AUD_NO = #{audNo}
		          GROUP BY T1.FRS_TG||T1.AUD_YR||T1.AUD_NO||T1.FRS_REQ_SRNO||T1.FRS_TG_SRNO
	             )
		]]>
	</select> 	
	
    <!-- 포렌식 자료매체 합계 목록 조회 -->
	<select id="selectMdmTotList3" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.aep.frs.dao.AEPFRS004QMapper.selectMdmTotList3 */
        <![CDATA[
        	SELECT nvl(count(FRS_TG_TOT),0) AS FRS_TG_TOT
        	      ,nvl(sum(USR_TYPE_TOT1),0) AS USR_TYPE_TOT1
        	      ,nvl(sum(USR_TYPE_TOT2),0) AS USR_TYPE_TOT2
        	      ,nvl(sum(FRS_TYPE_TOT1),0) AS FRS_TYPE_TOT1
        	      ,nvl(sum(FRS_TYPE_TOT2),0) AS FRS_TYPE_TOT2
        	      ,nvl(sum(FRS_TYPE_TOT3),0) AS FRS_TYPE_TOT3
        	      ,nvl(sum(FRS_TYPE_TOT4),0) AS FRS_TYPE_TOT4
        	      ,nvl(sum(FRS_TYPE_TOT5),0) AS FRS_TYPE_TOT5
        	      ,nvl(sum(FRS_TYPE_TOT6),0) AS FRS_TYPE_TOT6
        	      ,nvl(sum(FRS_TYPE_TOT7),0) AS FRS_TYPE_TOT7
        	      ,nvl(sum(FRS_TYPE_TOT8),0) AS FRS_TYPE_TOT8
        	      ,nvl(sum(FRS_TYPE_TOT9),0) AS FRS_TYPE_TOT9
        	      ,nvl(sum(FRS_TYPE_TOT10),0) AS FRS_TYPE_TOT10
        	      ,nvl(sum(FRS_TYPE_TOT11),0) AS FRS_TYPE_TOT11
        	      ,nvl(sum(FRS_TYPE_TOT12),0) AS FRS_TYPE_TOT12
        	  FROM (
		        	SELECT T1.FRS_TG||T1.AUD_YR||T1.AUD_NO||T1.FRS_REQ_SRNO||T1.FRS_TG_SRNO  AS FRS_TG_TOT /* 인원   */
		        		  ,count(CASE WHEN T2.USR_TYPE = '01' THEN '1'
                                      ELSE '' 
                                  END ) AS USR_TYPE_TOT1 /* 공용  */
                          ,count(CASE WHEN T2.USR_TYPE = '02' THEN '1'
                                      ELSE ''
                                  END ) AS USR_TYPE_TOT2 /* 개인  */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '01' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT1 /* 데스크톱   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '02' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT2 /* 노트북   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '03' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT3 /* 하드디스크   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '05' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT4 /* USB   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '04' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT5 /* 외장하드디스크   */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '15' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT6 /* 메모리카드 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '08' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT7 /* 이메일 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '16' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT8 /* 메신저 */ 
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '11' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT9 /* 웹하드 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '13' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT10 /* 클라우드 */
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '10' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT11 /* 모바일 */ 
                          ,count(CASE WHEN T2.FRS_TYPE_CD = '14' THEN '1'
                                      ELSE ''   
                                  END ) AS FRS_TYPE_TOT12 /* 태블릿 */  
		        	  FROM TBAEPFRS102M T1
		        		  ,TBAEPFRS102D T2
		        	 WHERE 1=1
		        	   AND T1.AUD_YR = T2.AUD_YR(+)
		        	   AND T1.AUD_NO = T2.AUD_NO(+)
		        	   AND T1.FRS_REQ_SRNO = T2.FRS_REQ_SRNO(+)
		        	   AND T1.FRS_TG_SRNO = T2.FRS_TG_SRNO(+)
		        	   AND T1.AUD_YR = #{audYr}
		        	   AND T1.AUD_NO = #{audNo}
		        	   AND T1.FRS_REQ_SRNO = #{frsReqSrno}
		          GROUP BY T1.FRS_TG||T1.AUD_YR||T1.AUD_NO||T1.FRS_REQ_SRNO||T1.FRS_TG_SRNO
	             )
		]]>
	</select> 	

</mapper>