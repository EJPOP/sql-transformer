<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.cfr.dao.AEPCFR003QMapper">

    <select id="selectUsrList" parameterType="paramMap" resultType="egovMap">
    	/*kr.go.bai.eip.aep.cfr.dao.AEPCFR003QMapper.selectUsrList*/
    	<include refid="include.pageSelct" />
			SELECT A.USR_ID
				 , A.CNB
				 , A.USR_NAM
				 , F_CODE_NM('1000173',A.RANK_CD) AS RANK_NM
			     , F_CODE_NM('1000176',A.PST_CD)  AS PST_NM
			     , F_CODE_NM('1000161',A.INN_RANK_CD)  AS INN_RANK_NM
			     , F_DPT_INFO(A.DPT_CD,'1') AS DPT_NM
			     , A.AGORA_ROLE_ID
			     , NVL(A.AGORA_ADM_DVSN, 0) AS AGORA_ADM_DVSN
			     , TO_CHAR(A.FNL_MDF_DH,'YYYY-MM-DD HH24:MI:SS') AS FNL_MDF_DH
			 	 , A.RANK_CD
			 	 , A.PST_CD
			 	 , A.INN_RANK_CD
			 	 , A.DPT_CD
			 FROM TBDCMACM001M A
			WHERE 1=1
			<if test='schUsrNm != null and schUsrNm != ""'>
			  AND A.USR_NAM LIKE '%'||#{schUsrNm}||'%'
			</if>
			<if test='schUsrId != null and schUsrId != ""'>
			  AND A.USR_ID LIKE #{schUsrId}||'%'
			</if>
			<if test='schCnb != null and schCnb != ""'>
			  AND A.CNB LIKE #{schCnb}||'%'
			</if>
			<if test='schDptCd != null and schDptCd != ""'>
			  AND A.DPT_CD = #{schDptCd}
			</if>
			ORDER BY A.USR_NAM
		<include refid="include.pageOrder" />
    </select>
    
    <update id="updateUsrInfoByAgora" parameterType="paramMap">
        /*kr.go.bai.eip.aep.cfr.dao.AEPCFR003QMapper.updateUsrInfoByAgora*/
        UPDATE TBDCMACM001M
           SET FNL_MDF_DH = SYSDATE
             , FNL_USR_ID = #{usrId}
             , AGORA_ROLE_ID = #{agoraRoleId}
             , AGORA_ADM_DVSN  = #{agoraAdmDvsn}
             <if test='esn != null and esn != ""'>
             , ESN = #{esn}
             </if>
         WHERE CNB = #{cnb}
    </update>
</mapper> 