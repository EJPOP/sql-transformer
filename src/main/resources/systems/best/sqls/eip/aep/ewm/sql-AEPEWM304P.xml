<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.ewm.dao.AEPEWM304PMapper">
	
	<resultMap type="java.util.Map" id="examRprtselect">
		<result property="AUD_YR"                        column="AUD_YR"                        jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="AUD_NO"                        column="AUD_NO"                        jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="DSP_RQ_SNO"                    column="DSP_RQ_SNO"                    jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_DSP_RQ_SBT"          column="EXAM_RPRT_DSP_RQ_SBT"          jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_UNENFM_RTWR_TXT"     column="EXAM_RPRT_UNENFM_RTWR_TXT"     jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_UNENFM_RSN_EXAM_TXT" column="EXAM_RPRT_UNENFM_RSN_EXAM_TXT" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_APV_STA_DT"          column="EXAM_RPRT_APV_STA_DT"          jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_APV_DOC_NO"          column="EXAM_RPRT_APV_DOC_NO"          jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_APV_STA_CD"          column="EXAM_RPRT_APV_STA_CD"          jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="EXAM_RPRT_ALL_TXT"             column="EXAM_RPRT_ALL_TXT"             jdbcType="CLOB"     javaType="java.lang.String"/>
	</resultMap>
	
	<!--검토보고서 내용조회  BADFRE003EExamRprtselect-->
	<select id="selectExamRprt" parameterType="paramMap" resultMap="examRprtselect">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM304PMapper.selectExamRprt */
	<![CDATA[	
			SELECT AUD_YR                         /* 감사년도 */
			      ,AUD_NO                         /* 감사번호 */
			      ,DSP_RQ_SNO                     /* 처분요구순번 */
			      ,NVL(EXAM_RPRT_DSP_RQ_SBT,'') AS EXAM_RPRT_DSP_RQ_SBT           /* 검토보고서처분요구요지 */
			      ,NVL(EXAM_RPRT_UNENFM_RTWR_TXT,'') AS EXAM_RPRT_UNENFM_RTWR_TXT     /* 검토보고서미집행경위내용 */
			      ,NVL(EXAM_RPRT_UNENFM_RSN_EXAM_TXT,'') AS EXAM_RPRT_UNENFM_RSN_EXAM_TXT  /* 검토보고서미집행사유검토내용 */
			      ,NVL(EXAM_RPRT_APV_STA_DT,'')  AS  EXAM_RPRT_APV_STA_DT        /* 검토보고서결재상태일 */
			      ,NVL(EXAM_RPRT_APV_DOC_NO,'')  AS  EXAM_RPRT_APV_DOC_NO       /* 검토보고서결재문서번호 */
			      ,NVL(EXAM_RPRT_APV_STA_CD,'')  AS  EXAM_RPRT_APV_STA_CD        /* 검토보고서결재상태코드 */
			      ,EXAM_RPRT_ALL_TXT              /* 검토보고서전체내용 */
			  FROM TBBADEAR002D 
			 WHERE 1 = 1
			   AND AUD_YR     = #{audYr}        
			   AND AUD_NO     = #{audNo}
			   AND DSP_RQ_SNO = #{dspRqSno}		

		 ]]>
 	</select>
 	
 	
	<!-- 최종 완결처리 업데이트 BADFRE003EExamRprtupdate -->
	<update id="saveExamRprt" parameterType="paramMap">
       /* kr.go.bai.eip.aep.ewm.dao.AEPEWM304PMapper.saveExamRprt */
        <![CDATA[
			UPDATE TBBADEAR002D
			   SET EXAM_RPRT_ALL_TXT = #{examRprtAllTxt,jdbcType=CLOB} 
			      ,FNL_USR_ID        = #{fnlUsrId}
			      ,FNL_DEAL_DPT_CD   = #{fnlDealDptCd}
			      ,FNL_MNU_ID        = #{fnlMnuId}
			      ,FNL_MDF_DH        = SYSDATE
			 WHERE 1 = 1
			   AND AUD_YR            = #{audYr}    
			   AND AUD_NO            = #{audNo}    
			   AND DSP_RQ_SNO        = #{dspRqSno}	
        ]]>
	</update>
	
</mapper> 
