<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.go.bai.eip.aep.cam.dao.AEPCAM013PMapper">
    
    <select id="selectMaxMms" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.cam.dao.AEPCAM013PMapper.selectMaxMms*/
          /* kr.go.bai.eip.bad.fre.dao.BADFRE019Mapper.BADFRE019EMmsselect */
		<![CDATA[
			SELECT MMS_CONTENTS_INFO_SEQ.NEXTVAL AS MAX_CNT FROM DUAL
		]]>
    </select>
    
    <!--MMS 정보 insert -->
	<insert id="insertMms" parameterType="paramMap">
		/* kr.go.bai.eip.aep.cam.dao.AEPCAM013PMapper.insertMms */
		INSERT
		  INTO MMS_CONTENTS_INFO
		     ( CONT_SEQ
		     , FILE_CNT
		     , BUILD_YN
		     , MMS_BODY
		     , MMS_SUBJECT
		     )
		VALUES
		     ( #{maxCnt}
		     , 1
		     , 'N'
		     , #{smsTxt}
		     , '소명자료 접수'
			  )
	</insert>
    
    <!--SMS 전송 insert -->
	<insert id="insertSms" parameterType="paramMap">
		/* kr.go.bai.eip.aep.cam.dao.AEPCAM013PMapper.insertSms */
		INSERT
		  INTO MSG_DATA
		     ( MSG_SEQ	/*메시지의 고유번호*/
		     , CUR_STATE /*상태 값(발송요청:0, 전송 중:1, 전송:2, 결과수신:3)*/
		     , REQ_DATE /*즉시전송 및 예약 일시*/
		     , CALL_TO /*수신번호*/
		     , CALL_FROM /*발신번호*/
		     , MSG_TYPE /*메시지의 TYPE(4: SMS 전송 ,5: URL 전송 ,6: MMS전송)*/
		     , CONT_SEQ /* MMS 메시지 테이블과 연결되는 키 */
		     )
		VALUES
		     ( MSG_DATA_SEQ.NEXTVAL
		     , 0
		     , SYSDATE
		     , REPLACE(#{hpTnb} ,'-','')
		     , REPLACE(#{callFrom} ,'-','')
		     , 6
		     , #{maxCnt})
	</insert>
	
    <update id="updateSmsSendDateTBCSPKDE103M" parameterType="paramMap">
    /* kr.go.bai.eip.aep.cam.dao.AEPCAM013PMapper.updateSmsSendDateTBCSPKDE103M */
        UPDATE TBCSPKDE103M
           SET SMS_SEN_DH = SYSDATE
         WHERE AUD_YR = #{audYr}
           AND AUD_NO = #{audNo}
           AND SRNO = #{srno}
    </update>
</mapper> 