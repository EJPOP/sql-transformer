<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper">
	
	
    <resultMap type="java.util.HashMap" id="aepewmMap">
        <result property="audSbjNm"			            column="AUD_SBJ_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="audKndCd"                     column="AUD_KND_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="audKndNm"                     column="AUD_KND_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="audYr"                        column="AUD_YR"            jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="audNo"                        column="AUD_NO"            jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="audGrnNo"                     column="AUD_GRN_NO"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dspRqSno"                     column="DSP_RQ_SNO"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dspRqKndCd"                  column="DSP_RQ_KND_CD"     jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dspRqKndNm"                  column="DSP_RQ_KND_NM"     jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="totDspRqNo"                   column="TOT_DSP_RQ_NO"     jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfDt"                        column="ENF_DT"            jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="titTxt"                       column="TIT_TXT"           jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="hndlDdlnDt"                   column="HNDL_DDLN_DT"      jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="pnlDrinPsvtAm"                column="PNL_DRIN_PSVT_AM"  jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="rsrAm"                        column="RSR_AM"            jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="splpAm"                       column="SPLP_AM"           jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="bgtRdcAm"                     column="BGT_RDC_AM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="incIcrAm"                     column="INC_ICR_AM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="pplBdnRdtAm"                  column="PPL_BDN_RDT_AM"    jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="frtnIncrAm"                   column="FRTN_INCR_AM"      jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="expnRtnlAm"                   column="EXPN_RTNL_AM"      jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="ijsAm"                        column="IJS_AM"            jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="slf_hndlRqAm"                 column="SLF_HNDL_RQ_AM"    jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="apvDocNo"                     column="APV_DOC_NO"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="apvDocGrpNo"                  column="APV_DOC_GRP_NO"    jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="coptOfiCd"                   column="COPT_OFI_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="coptOfiNm"                   column="COPT_OFI_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfBrdvCd"                    column="ENF_BRDV_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfBrdvNm"                    column="ENF_BRDV_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmMngBrdvCd"                column="ENFM_MNG_BRDV_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmMngBrdvNm"                column="ENFM_MNG_BRDV_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dspRqApvStaCd"                column="DSP_RQ_APV_STA_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dspRqApvStaNm"                column="DSP_RQ_APV_STA_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dtmYn"                        column="DTM_YN"           jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dtmYnNm"                      column="DTM_YN_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmWhlsApvKndCd"             column="ENFM_WHLS_APV_KND_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmWhlsApvKndNm"             column="ENFM_WHLS_APV_KND_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="repRltnOrgCd"                 column="REP_RLTN_ORG_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="repRltnOrgNm"                 column="REP_RLTN_ORG_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="rltnOrgCd"                    column="RLTN_ORG_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="rltnOrgNm"                    column="RLTN_ORG_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="tgOrgChgrNm"                  column="TG_ORG_CHGR_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="tgOrgTnb"                     column="TG_ORG_TNB"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="cpltYn"                       column="CPLT_YN"          jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="cpltYnNm"                     column="CPLT_YN_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="hndSbjTxt"                    column="HND_SBJ_TXT"       jdbcType="CLOB" javaType="java.lang.String" />  
        <result property="chgrNm"                       column="CHGR_NM"          jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmCpltIptDt"                column="ENFM_CPLT_IPT_DT"           jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmCpltIptPenId"             column="ENFM_CPLT_IPT_PEN_ID"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmCpltIptPenNm"             column="ENFM_CPLT_IPT_PEN_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="cpltDt"                       column="CPLT_DT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="cpltPenId"                    column="CPLT_PEN_ID"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="cpltPenNm"                    column="CPLT_PEN_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmWhlsDtmDt"                column="ENFM_WHLS_DTM_DT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmWhlsDtmPenId"             column="ENFM_WHLS_DTM_PEN_ID"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmWhlsDtmPenNm"             column="ENFM_WHLS_DTM_PEN_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="fnlApvDt"                     column="FNL_APV_DT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="fnlApvCnb"                    column="FNL_APV_CNB"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="fnlApvNm"                     column="FNL_APV_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmStaNm"                    column="ENFM_STA_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="examRprtDspRqSbt"             column="EXAM_RPRT_DSP_RQ_SBT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="examRprtUnenfmRtwrTxt"        column="EXAM_RPRT_UNENFM_RTWR_TXT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="examRprtUnenfmRsnExamTx"      column="EXAM_RPRT_UNENFM_RSN_EXAM_TXT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="mngSnoMax"                    column="MNG_SNO_MAX"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="spcnMng"                      column="SPCN_MNG"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="prsuCnt"                      column="PRSU_CNT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="jesimCnt"                     column="JESIM_CNT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="gamsapCnt"                    column="GAMSAP_CNT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="hrkMngAsgYn"                  column="HRK_MNG_ASG_YN"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="hrkMngAsgRsn"                 column="HRK_MNG_ASG_RSN"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dtmApvStaCd"                  column="DTM_APV_STA_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dtmApvStaDt"                  column="DTM_APV_STA_DT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dtmApvDocNo"                  column="DTM_APV_DOC_NO"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dtmRetRsnTxt"                 column="DTM_RET_RSN_TXT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="notCpltStaDvsnCd"             column="NOT_CPLT_STA_DVSN_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="cpltStaDvsnCd"                column="CPLT_STA_DVSN_CD"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dtmFrtApvDt"                  column="DTM_FRT_APV_DT"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="dtmFrtApvNm"                  column="DTM_FRT_APV_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="execDspNm"                    column="EXEC_DSP_NM"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="audYrGrnNo"                   column="AUD_YR_GRN_NO"        jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="docIdNo"                      column="DOC_ID_NO"        jdbcType="VARCHAR" javaType="java.lang.String" />
        
        <result property="odEnfmMngBrdvCd"              column="OD_ENFM_MNG_BRDV_CD"      jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="odEnfmMngBrdvNm"              column="OD_ENFM_MNG_BRDV_NM"      jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="mainEnfmMngTgYn"              column="MAIN_ENFM_MNG_TG_YN"      jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="mainEnfmMngTgYnNm"            column="MAIN_ENFM_MNG_TG_YN_NM"   jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmMngOrgCd"                 column="ENFM_MNG_ORG_CD"          jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="enfmMngOrgNm"                 column="ENFM_MNG_ORG_NM"          jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="docType"                 column="DOC_TYPE"          jdbcType="VARCHAR" javaType="java.lang.String" />
        <result property="rprtNm"                 column="RPRT_NM"          jdbcType="VARCHAR" javaType="java.lang.String" />
    </resultMap>	
	
	
	
	<!-- 집행전말 관리 목록 조회  BADFRE003EMainselect -->
	<select id="selectMainList" parameterType="paramMap" resultMap="aepewmMap" >
	
			/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectMainList */
	       <![CDATA[
			SELECT T.AUD_SBJ_NM,
			       T.AUD_KND_CD,
			       F_CODE_NM('1000007', T.AUD_KND_CD) AS AUD_KND_NM,
			       T1.AUD_YR,
			       T1.AUD_NO,
			       T.AUD_GRN_NO,
			       T1.DSP_RQ_SNO,
			       T1.DSP_RQ_KND_CD,
			       F_CODE_NM('1000002', T1.DSP_RQ_KND_CD) AS DSP_RQ_KND_NM,
			       F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, T.AUD_KND_CD, '-') ||'-'|| T1.DSP_RQ_SNO AS TOT_DSP_RQ_NO, 
			       TO_CHAR(TO_DATE(T2.ENF_DT),'YYYY-MM-DD') AS ENF_DT,
			       T1.TIT_TXT,
			       T2.HNDL_DDLN_DT,
			       (
				       SELECT SUM(S1.PNL_DRIN_PSVT_AM) 
					   FROM TBBADEAR003M S1
					   WHERE 1 = 1
	                   AND S1.AUD_YR = T2.AUD_YR
					   AND S1.AUD_NO = T2.AUD_NO
					   AND S1.DSP_RQ_SNO = T2.DSP_RQ_SNO
			       ) AS PNL_DRIN_PSVT_AM,
			       
				   (
				       SELECT SUM(S1.RSR_AM) 
					   FROM TBBADEAR003M S1
					   WHERE 1 = 1
	                   AND S1.AUD_YR = T2.AUD_YR
					   AND S1.AUD_NO = T2.AUD_NO
					   AND S1.DSP_RQ_SNO = T2.DSP_RQ_SNO
			       ) AS RSR_AM,
			       
				   T2.SPLP_AM,
				   T2.BGT_RDC_AM,
				   T2.INC_ICR_AM,
				   T2.PPL_BDN_RDT_AM,
				   T2.FRTN_INCR_AM,
				   T2.EXPN_RTNL_AM,
				   T2.IJS_AM,
				   T2.SLF_HNDL_RQ_AM,
				   T2.APV_DOC_NO,
				   T2.APV_DOC_GRP_NO,
			       T2.COPT_OFI_CD,
			       (SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T2.COPT_OFI_CD AND ROWNUM = 1) AS COPT_OFI_NM,
			       T2.ENF_BRDV_CD,
			       (SELECT DPT_NM FROM TBDCMACM002M WHERE DPT_CD = T2.ENF_BRDV_CD AND ROWNUM = 1) AS ENF_BRDV_NM,
                   T2.ENFM_MNG_BRDV_CD,
                   (SELECT DPT_NM FROM TBDCMACM002M WHERE DPT_CD = T2.ENFM_MNG_BRDV_CD AND ROWNUM = 1) AS ENFM_MNG_BRDV_NM,
                   T2.DSP_RQ_APV_STA_CD,
                   F_CODE_NM('1000333', T2.DSP_RQ_APV_STA_CD) AS DSP_RQ_APV_STA_NM,
                   T2.DTM_YN,
                   DECODE(T2.DTM_YN,'Y','완결','미결') AS DTM_YN_NM,
                   T2.ENFM_WHLS_APV_KND_CD,
				   F_CODE_NM('1000529', T2.ENFM_WHLS_APV_KND_CD) AS ENFM_WHLS_APV_KND_NM,
                   T2.RLTN_ORG_CD AS REP_RLTN_ORG_CD,
                   (SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T2.RLTN_ORG_CD AND ROWNUM = 1) AS REP_RLTN_ORG_NM,
                   T3.RLTN_ORG_CD,
                   (SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T3.RLTN_ORG_CD AND ROWNUM = 1) AS RLTN_ORG_NM,
                   T4.TG_ORG_CHGR_NM,
                   T4.TG_ORG_TNB,
                   DECODE(T3.CPLT_YN, 'Y', 'Y', 'N') AS CPLT_YN,
                   DECODE(T3.CPLT_YN, 'Y', '완결', '미결') AS CPLT_YN_NM,
                   
                   (SELECT REGEXP_REPLACE(ST1.DSP_RQ_HND_SBJ,'-/\%')
                    FROM TBBADEAR005M ST1
                    WHERE ST1.AUD_YR = T2.AUD_YR
                    AND   ST1.AUD_NO = T2.AUD_NO
                    AND   ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
                   ) AS HND_SBJ_TXT,
                   
                   /* '' AS HND_SBJ_TXT, */
                   
                   
                   
                   T2.CHGR_NM,
                   TO_CHAR(TO_DATE(T2.ENFM_CPLT_IPT_DT),'YYYY-MM-DD')  AS ENFM_CPLT_IPT_DT,
                   T2.ENFM_CPLT_IPT_PEN_ID,
                   (SELECT USR_NAM FROM TBDCMACM001M WHERE CNB = T2.ENFM_CPLT_IPT_PEN_ID AND ROWNUM = 1) AS ENFM_CPLT_IPT_PEN_NM,
                   TO_CHAR(TO_DATE(T2.CPLT_DT),'YYYY-MM-DD')  AS CPLT_DT,
                   T2.CPLT_PEN_ID,
                   F_USR_INFO(T2.CPLT_PEN_ID, '2') AS CPLT_PEN_NM,
                   TO_CHAR(TO_DATE(T2.ENFM_WHLS_DTM_DT),'YYYY-MM-DD')  AS ENFM_WHLS_DTM_DT,
                   T2.ENFM_WHLS_DTM_PEN_ID,
                   F_USR_INFO(T2.ENFM_WHLS_DTM_PEN_ID, '2') AS ENFM_WHLS_DTM_PEN_NM,
                   
                   /* T2.APV_DOC_GRP_NO를 사용하는 부분 주석처리 - 2015.04.30 yyh 
                   NVL((
                     SELECT DECODE(APV_STA_CD,3,TO_CHAR(FNL_APV_DH, 'YYYYMMDD'),'') AS FNL_APV_DT
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_GRP_NO
				        AND ROWNUM = 1
                   ),(
                     SELECT DECODE(APV_STA_CD,3,TO_CHAR(FNL_APV_DH, 'YYYYMMDD'),'') AS FNL_APV_DT
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
                   )) AS FNL_APV_DT,
                   
                   NVL((
                     SELECT DECODE(APV_STA_CD,3,FNL_APV_CNB,'') AS FNL_APV_CNB
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_GRP_NO
				        AND ROWNUM = 1
				   ),(
                     SELECT DECODE(APV_STA_CD,3,FNL_APV_CNB,'') AS FNL_APV_CNB
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
				   )) AS FNL_APV_CNB,
				   
				   
                   NVL((
                     SELECT DECODE(APV_STA_CD,3,F_USR_INFO(FNL_APV_CNB,'2'),'') AS FNL_APV_NM
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_GRP_NO
				        AND ROWNUM = 1
				   ),(
                     SELECT DECODE(APV_STA_CD,3,F_USR_INFO(FNL_APV_CNB,'2'),'') AS FNL_APV_NM
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
				   )) AS FNL_APV_NM,
				   */
				   
                   (
                     SELECT DECODE(APV_STA_CD,3,TO_CHAR(FNL_APV_DH, 'YYYY-MM-DD'),'') AS FNL_APV_DT
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
                   ) AS FNL_APV_DT,
                   
                   (
                     SELECT DECODE(APV_STA_CD,3,FNL_APV_CNB,'') AS FNL_APV_CNB
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
				   ) AS FNL_APV_CNB,
				   
				   (
                     SELECT DECODE(APV_STA_CD,3,F_USR_INFO(FNL_APV_CNB,'2'),'') AS FNL_APV_NM
				       FROM TBDCMACM022L
				      WHERE APV_DOC_NO = T2.APV_DOC_NO
				        AND ROWNUM = 1
				   ) AS FNL_APV_NM,
				   
				   
				   (
					CASE 
					WHEN T2.DTM_STA_CD = '2' THEN '확정'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
					     AND T2.DSP_RQ_APV_STA_CD = '3'
					THEN '완결(결재완료)'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
						 AND T2.DSP_RQ_APV_STA_CD = '2'
					THEN '미결(결재중)'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
						 AND T2.DSP_RQ_APV_STA_CD = '5'
					THEN '미결(상신취소)'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
					     AND T2.DSP_RQ_APV_STA_CD = '4'
					THEN '미결(반려)'
					WHEN T2.DTM_STA_CD = '1' AND T2.DTM_YN = 'Y'
					     AND (T2.DSP_RQ_APV_STA_CD = '1' OR T2.DSP_RQ_APV_STA_CD IS NULL)
					THEN '미결(미상신)'
					WHEN T2.DTM_STA_CD = '1' AND (T2.DTM_YN <> 'Y' OR T2.DTM_YN IS NULL)
					THEN '미결'
					ELSE '처분요구 미확정'
					END
				   ) AS ENFM_STA_NM,
				   T2.EXAM_RPRT_DSP_RQ_SBT,
				   T2.EXAM_RPRT_UNENFM_RTWR_TXT,
				   T2.EXAM_RPRT_UNENFM_RSN_EXAM_TXT,
				   (
					   SELECT NVL(MAX(ST1.MNG_SNO), 0) AS MNG_SNO_MAX
					   FROM TBBADFRE011M ST1
					   WHERE ST1.AUD_YR = T2.AUD_YR
					   AND ST1.AUD_NO = T2.AUD_NO
					   AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
					   AND ST1.RLTN_ORG_CD = T2.RLTN_ORG_CD
				   ) AS MNG_SNO_MAX,
				   (
					   SELECT DECODE(NVL(COUNT(1), 0), 0, '', '특수관리') AS SPCN_MNG
					   FROM TBBADFRE011M ST1
					   WHERE ST1.AUD_YR = T2.AUD_YR
					   AND ST1.AUD_NO = T2.AUD_NO
					   AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
				   ) AS SPCN_MNG,
				   (
					   SELECT DECODE(NVL(COUNT(1), 0), 0, '', 
					   		DECODE(T1.DSP_RQ_KND_CD,'610','이행계획제출요구',
					   		                        '611','이행계획제출요구',
					   		                        '620','이행계획제출요구',
					   		                        '621','이행계획제출요구',
					   		                        '623','이행계획제출요구',
					   		                        '630','이행계획제출요구',
					   		                        '510','이행계획제출요구',
					   		                        '520','이행계획제출요구','이행독촉')) AS PRSU_CNT
						 FROM TBBADFRE009M ST1
						WHERE ST1.AUD_YR = T2.AUD_YR
						  AND ST1.AUD_NO = T2.AUD_NO
						  AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
				   ) AS PRSU_CNT,
				   (
					   SELECT AGGR_CONCAT(ST1.ACP_YR || '-' || ST1.ACP_DVSN_CD || '-' || ST1.ACP_SRNO || '-' || ST1.DPT_CD, ',') AS JESIM_CNT
						 FROM TBBADFRE012M ST1
						WHERE ST1.AUD_YR = T2.AUD_YR
						  AND ST1.AUD_NO = T2.AUD_NO
						  AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
				   ) AS JESIM_CNT,
				   (
					   SELECT DECODE(NVL(COUNT(1), 0), 0, '', '감사자보기') AS GAMSAP_CNT
						 FROM TBBADEAR004M ST1
						WHERE ST1.AUD_YR = T2.AUD_YR
						  AND ST1.AUD_NO = T2.AUD_NO
						  AND ST1.DSP_RQ_SNO = T2.DSP_RQ_SNO
				   ) AS GAMSAP_CNT,
				   NVL(T2.HRK_MNG_ASG_YN, 'N') AS HRK_MNG_ASG_YN,
				   T2.HRK_MNG_ASG_RSN
				   
				   /* 확정관련 추가 - 2016.05.17 yyh */
				   ,T2.DTM_APV_STA_CD        /* 확정결재상태코드 */
				   ,T2.DTM_APV_STA_DT        /* 확정결재상태일 */
				   ,T2.DTM_APV_DOC_NO        /* 확정결재문서번호 */
				   ,T2.DTM_RET_RSN_TXT       /* 확정반려사유 */
				   ,T2.NOT_CPLT_STA_DVSN_CD  /* 미결상태구분코드 */
				   ,T2.CPLT_STA_DVSN_CD      /* 완결상태구분코드 */
				   
				   /* 확정검토 결재상신정보 추가 - 2016.05.24 yyh */
                   ,(SELECT TO_CHAR(APV_DH, 'YYYY-MM-DD')
				       FROM TBDCMACM023L
				      WHERE APV_DOC_NO = T2.DTM_APV_DOC_NO
				        AND APV_SNO = 1
				        AND ROWNUM  = 1)                    AS DTM_FRT_APV_DT
                   ,(SELECT F_USR_INFO(APVR_CNB,'2')
				       FROM TBDCMACM023L
				      WHERE APV_DOC_NO = T2.DTM_APV_DOC_NO
				        AND APV_SNO = 1				      
				        AND ROWNUM  = 1)                    AS DTM_FRT_APV_NM				   
				   ,(SELECT Z2.DOC_ID
						FROM TBBADEAR001M      Z1
					   INNER JOIN TBBADDED103M Z2
					      ON Z1.AUD_YR                  = Z2.AUD_YR
					     AND Z1.AUD_NO                  = Z2.AUD_NO
					     AND TO_CHAR(Z1.AUD_DSP_RQ_SNO) = Z2.REF_ID
				       WHERE Z1.AUD_YR                  = T1.AUD_YR
						 AND Z1.AUD_NO                  = T1.AUD_NO
					     AND Z1.DSP_RQ_SNO              = T1.DSP_RQ_SNO
					     AND Z2.AUD_STEP_CD             = 'A1080'
					   	 AND Z2.RPRT_CD                 = 'A10800500')                  AS DOC_ID_NO     /* 익명처리 보고서 쿼리 수정 - 2017.07.24 yyh */
                   ,T1.EXEC_DSP_NM    -- 시행문 번호
                   ,F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, T.AUD_KND_CD, '-')          AS AUD_YR_GRN_NO
                      
                    /* 이하 추가 - 2017.05.11 yyh*/
                   ,T2.OD_ENFM_MNG_BRDV_CD                                              AS OD_ENFM_MNG_BRDV_CD
			       ,F_DPT_INFO(T2.OD_ENFM_MNG_BRDV_CD,'1')                              AS OD_ENFM_MNG_BRDV_NM
			       ,NVL(T2.MAIN_ENFM_MNG_TG_YN, 'N')                                    AS MAIN_ENFM_MNG_TG_YN
			       ,CASE WHEN T2.MAIN_ENFM_MNG_TG_YN = 'Y' THEN '주요이행관리대상'
			             ELSE ''
			         END                                                                AS MAIN_ENFM_MNG_TG_YN_NM
			       ,T3.ENFM_MNG_ORG_CD                                                  AS ENFM_MNG_ORG_CD /* 이행관리기관 */
			       ,(SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T3.ENFM_MNG_ORG_CD) AS ENFM_MNG_ORG_NM 
			       ,DECODE(T.DOC_WRIT_KND_CD,'10','polaris','hancom')    AS DOC_TYPE  /*편집기구분*/
				  , ( SELECT NVL(CASE WHEN COUNT(T5.RPRT_NM) > 1 
				     			     THEN MIN(T5.RPRT_NM)||' (외 '||TO_CHAR(COUNT(1)-1)||'건)'||' (총'||TO_CHAR(COUNT(1))||'건)'
				     			     ELSE MAX(T5.RPRT_NM) 
				     			     END ,'없음')
				     FROM TBBADEAR001M TT
				     INNER JOIN TBBADDED111M T5
				     ON(TT.AUD_YR = T5.AUD_YR AND TT.AUD_NO = T5.AUD_NO AND TT.DSP_RQ_SNO = T5.REF_ID)
				     WHERE 1=1  
				     AND T5.RPRT_CD = 'A10900900' 
				     AND T5.AUD_YR =  #{audYr}	 
				     AND T5.AUD_NO =  #{audNo}
				     AND T5.REF_ID = #{dspRqSno}   
				     ) AS RPRT_NM 
			  FROM TBBADDED001M T,
			       TBBADEAR001M T1,
			       TBBADEAR002D T2,
			       TBBADEAR006M T3,
                   TBBADFRE001M T4
			 WHERE 1 = 1
			   AND T.AUD_YR = T1.AUD_YR
			   AND T.AUD_NO = T1.AUD_NO
			   AND T1.AUD_YR = T2.AUD_YR
			   AND T1.AUD_NO = T2.AUD_NO
			   AND T1.DSP_RQ_SNO = T2.DSP_RQ_SNO
			   AND T2.AUD_YR = T3.AUD_YR(+)
			   AND T2.AUD_NO = T3.AUD_NO(+)
			   AND T2.DSP_RQ_SNO = T3.DSP_RQ_SNO(+)
			   AND T3.AUD_YR = T4.AUD_YR(+)
               AND T3.AUD_NO = T4.AUD_NO(+)
               AND T3.DSP_RQ_SNO = T4.DSP_RQ_SNO(+)
               AND T3.RLTN_ORG_CD = T4.RLTN_ORG_CD(+)
			   AND T1.AUD_YR               = #{audYr}	 	
			   AND T1.AUD_NO               = #{audNo}	 	   
			   AND T2.DSP_RQ_SNO           = #{dspRqSno}       
			  ORDER BY T2.AUD_YR, T1.AUD_NO, T2.DSP_RQ_SNO, T3.RLTN_ORG_CD
			  ]]>
	</select>
	
	<select id="selectLitigaYn" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM010EMapper.selectLiGaList */
			SELECT 
                   T3.LWS_PRSS_CD                               AS LWS_PRSS_CD   /* 소송여부 */      
                  ,T3.LWS_RSLT_CD                               AS LWS_RSLT_CD   /* 소송결과 */
                  ,T3.LOSE_RSN                                  AS LOSE_RSN      /* 패소사유 */
              FROM TBBADEAR001M T1  /* 처분요구사항기본 */
                  ,TBBADEAR002D T2  /* 처분요구사항상세 */
                  ,TBBADEAR038M T3  /* 소송관리기본 */
                  ,TBBADDED001M T4  /* 감사사항기본 */
              WHERE 1=1                                                            
                AND T1.AUD_YR     	= T2.AUD_YR                              
                AND T1.AUD_NO     	= T2.AUD_NO                               
                AND T1.DSP_RQ_SNO 	= T2.DSP_RQ_SNO   
                AND T2.AUD_YR     	= T3.AUD_YR(+) /*T2 감사연도 LEFT OUTER JOIN*/
                AND T2.AUD_NO     	= T3.AUD_NO(+) /*T2 감사번호 LEFT OUTER JOIN*/
                AND T2.DSP_RQ_SNO 	= T3.DSP_RQ_SNO(+) /*T2 처분요구순번 LEFT OUTER JOIN*/
                AND T1.AUD_YR     	= T4.AUD_YR                                 
                AND T1.AUD_NO     	= T4.AUD_NO 
                
              
                AND   T1.AUD_YR = #{audYr}
				AND	  T1.AUD_NO = #{audNo}
				AND	  T1.DSP_RQ_SNO = #{dspRqSno}
                
                
              ORDER BY T1.AUD_YR
                      ,T1.AUD_NO
                      ,T1.DSP_RQ_SNO
	
	</select>
	
	
	<!-- 집행전말이력 조회 BADFRE003EEnfmHisselect-->
	<select id="selectEnfmHisList" parameterType="paramMap" resultType="egovMap" >
	
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectEnfmHisList */
       <![CDATA[
			SELECT
				T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.HST_NO
				,TO_CHAR(TO_DATE(T1.ENF_DT),'YYYY-MM-DD')  AS  ENF_DT
				,TO_CHAR(TO_DATE(T1.ENFM_DT),'YYYY-MM-DD') AS ENFM_DT
				,T1.ENFM_STEP_CD
				,F_CODE_NM('1000016', T1.ENFM_STEP_CD) AS ENFM_STEP_NM
				,T1.ENFM_HIS
				,T1.EXAM_STA_CD
				,F_CODE_NM('1000390', T1.EXAM_STA_CD) AS EXAM_STA_NM
				,T1.EXAM_OPIN_TXT
				,TO_CHAR(TO_DATE(T1.BAI_CHGD_ACP_DT),'YYYY-MM-DD') AS BAI_CHGD_ACP_DT
				,T1.CNTR_ADMN_ORG_ACP_DT
				,TO_CHAR(TO_DATE(T1.SLF_SEN_DT),'YYYY-MM-DD')  AS	SLF_SEN_DT
				,T1.SLF_IPT_YN
				,T1.HST_RMK
				,T1.CHGR_ID
				,F_USR_INFO(T1.CHGR_ID,'2') AS CHGR_NM				
				,T1.ENFM_WHLS_APV_STA_CD
				,DECODE(T1.ENFM_WHLS_APV_STA_CD, '', '상신전',
					F_CODE_NM('1000333', T1.ENFM_WHLS_APV_STA_CD)) AS ENFM_WHLS_APV_STA_NM
				,T1.DOC_ID
				,T1.DOC_TYP_CD	
				,T1.APV_DOC_NO			
				,T1.TG_ORG_APV_DT
				,T1.TG_ORG_APVR_BLT_NM
				,T1.TG_ORG_APVR_RANK_NM
				,T1.TG_ORG_APVR_PST_NM
				,T1.TG_ORG_APVR_NAM
				, #{reportparam} AS REPORT_PARAM
				,TO_CHAR(TO_DATE(T1.CHGR_EXAM_DT),'YYYY-MM-DD') AS CHGR_EXAM_DT /* 담당자검토일 추가 - 2017.11.07 yyh */
			FROM TBBADFRE001H T1
			 WHERE 1 = 1 
			   AND T1.AUD_YR               = #{audYr} 	
			   AND T1.AUD_NO               = #{audNo}	   
			   AND T1.DSP_RQ_SNO           = #{dspRqSno}	 	   
			   /*  AND T1.RLTN_ORG_CD          = rltnOrgCd    slfIptYnParam 추가로 인하여 */
		]]>
		
		<!-- 2015.01.21 추가  -->
		<if test='slfIptYnParam == "N"' >
     	       /* 프로세스 이행관리 조회용으로 AND T1.BAI_CHGD_ACP_DT IS NULL */
     	       
		</if>
		<if test='slfIptYnParam != "N"'>
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}
		</if>
		
		<!-- 2015.01.21 추가  -->
		<if test='hstno != null and hstno != ""'>
     	       AND T1.HST_NO = #{hstno}
		</if>
        <![CDATA[       
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.HST_NO DESC 
        ]]>
	</select>
	
	

	<!-- 집행전말이력 조회 레포트 용 BADFRE003EEnfmHisselect-->
	<select id="selectEnfmHisListRpt" parameterType="paramMap" resultType="resultMap" >
	
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectEnfmHisListRpt */
       <![CDATA[
			SELECT
				T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.HST_NO
				,TO_CHAR(TO_DATE(T1.ENF_DT),'YYYY-MM-DD')  AS  ENF_DT
				,TO_CHAR(TO_DATE(T1.ENFM_DT),'YYYY-MM-DD') AS ENFM_DT
				,T1.ENFM_STEP_CD
				,F_CODE_NM('1000016', T1.ENFM_STEP_CD) AS ENFM_STEP_NM
				,T1.ENFM_HIS
				,T1.EXAM_STA_CD
				,F_CODE_NM('1000390', T1.EXAM_STA_CD) AS EXAM_STA_NM
				,T1.EXAM_OPIN_TXT
				,TO_CHAR(TO_DATE(T1.BAI_CHGD_ACP_DT),'YYYY-MM-DD') AS BAI_CHGD_ACP_DT
				,T1.CNTR_ADMN_ORG_ACP_DT
				,TO_CHAR(TO_DATE(T1.SLF_SEN_DT),'YYYY-MM-DD')  AS	SLF_SEN_DT
				,T1.SLF_IPT_YN
				,T1.HST_RMK
				,T1.CHGR_ID
				,F_USR_INFO(T1.CHGR_ID,'2') AS CHGR_NM				
				,T1.ENFM_WHLS_APV_STA_CD
				,DECODE(T1.ENFM_WHLS_APV_STA_CD, '', '상신전',
					F_CODE_NM('1000333', T1.ENFM_WHLS_APV_STA_CD)) AS ENFM_WHLS_APV_STA_NM
				,T1.DOC_ID
				,T1.DOC_TYP_CD	
				,T1.APV_DOC_NO			
				,T1.TG_ORG_APV_DT
				,T1.TG_ORG_APVR_BLT_NM
				,T1.TG_ORG_APVR_RANK_NM
				,T1.TG_ORG_APVR_PST_NM
				,T1.TG_ORG_APVR_NAM
				, #{reportparam} AS REPORT_PARAM
				,TO_CHAR(TO_DATE(T1.CHGR_EXAM_DT),'YYYY-MM-DD') AS CHGR_EXAM_DT /* 담당자검토일 추가 - 2017.11.07 yyh */
			FROM TBBADFRE001H T1
			 WHERE 1 = 1 
			   AND T1.AUD_YR               = #{audYr} 	
			   AND T1.AUD_NO               = #{audNo}	   
			   AND T1.DSP_RQ_SNO           = #{dspRqSno}	 	   
			   /*  AND T1.RLTN_ORG_CD          = rltnOrgCd    slfIptYnParam 추가로 인하여 */
		]]>
		
		<!-- 2015.01.21 추가  -->
		<if test='slfIptYnParam == "N"' >
     	       AND T1.BAI_CHGD_ACP_DT IS NULL
		</if>
		<if test='slfIptYnParam != "N"'>
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}
		</if>
		
		<!-- 2015.01.21 추가  -->
		<if test='hstno != null and hstno != ""'>
     	       AND T1.HST_NO = #{hstno}
		</if>
        <![CDATA[       
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.HST_NO
        ]]>
	</select>
	
	
	<!--집행전말 상세조회 관련기관집행전말 조회  BADFRE003ERltnOrgEnfmselect -->
	<select id="selectRltnOrgEnfmList" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectRltnOrgEnfmsList */
	
        <![CDATA[
			SELECT
			    T1.AUD_YR,
				T1.AUD_NO,
				T1.DSP_RQ_SNO,
				T1.RLTN_ORG_CD,
				(SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T1.RLTN_ORG_CD AND ROWNUM = 1) AS RLTN_ORG_NM,
				T1.ENFM_SNO,
				(
					SELECT MAX(ST1.ENFM_SNO) + 1
					FROM TBBADFRE006M ST1
					WHERE 1 = 1
					AND ST1.AUD_YR = T1.AUD_YR
					AND ST1.AUD_NO = T1.AUD_NO
					AND ST1.DSP_RQ_SNO = T1.DSP_RQ_SNO
					AND ST1.RLTN_ORG_CD = T1.RLTN_ORG_CD
				) AS MAX_ENFM_SNO,
                CASE WHEN  LENGTH(T1.ENFM_DT) = 8 
                     THEN  TO_CHAR(TO_DATE(T1.ENFM_DT),'YYYY-MM-DD')
                     ELSE  T1.ENFM_DT END AS ENFM_DT ,   /* 기존 데이터는  텍스트 입력으로  날짜 형변환 불가 데이터 있음 */
				T1.PNL_AM,
				T1.ENFM_SHP_CD,
				F_CODE_NM('1000003', T1.ENFM_SHP_CD) AS ENFM_SHP_NM,
				T1.ENFM_HIS,
				T1.ENFM_NOC,
				T1.FRT_USR_ID,
				T1.FNL_USR_ID,
				T1.FNL_DEAL_DPT_CD,
				T1.FNL_MNU_ID,
				T1.FRT_REGI_DH,
				T1.FNL_MDF_DH
			  FROM TBBADFRE006M T1
			 WHERE 1 = 1	 
			   AND T1.AUD_YR               = #{audYr}	 	
			   AND T1.AUD_NO               = #{audNo}	   
			   AND T1.DSP_RQ_SNO           = #{dspRqSno}	 	   
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}    
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.ENFM_SNO 
        ]]>
	</select>
	
	

	<!--회계사항 insert  BADEAR003AcctInsert -->
	<insert id="insertAcct" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertAcct */
		<![CDATA[
		DECLARE
			BEGIN			
			INSERT INTO TBBADEAR003M (
			       AUD_YR
			     , AUD_NO
			     , DSP_RQ_SNO
			     , ACNT_SBJ_SNO
			     , DSP_RQ_ACNT_CD
			     , EPT_EFCT_DVSN_CD
			     , ACNT_YE
			     , PNL_DRIN_PSVT_AM
			     , RSR_AM
			     , SPLP_AM
			     , EPT_EFCT_AM
			     , EXPOT_Y_EFCT_AM
			     , EXPOT_Y_EFCT_AM_CALC_BAS_TXT
			     , ETC_ACNT_NM
			     , FRT_USR_ID
			     , FNL_USR_ID
			     , FNL_DEAL_DPT_CD
			     , FNL_MNU_ID
			     , FRT_REGI_DH
			     , FNL_MDF_DH
			) VALUES(
			       #{audYr}
			     , #{audNo}
			     , #{dspRqSno}
			     , (SELECT TO_CHAR(NVL(MAX(TO_NUMBER(ACNT_SBJ_SNO)),0)+1) AS MAX_ACNT_SBJ_SNO
				   FROM TBBADEAR003M
				   WHERE 1=1
					AND AUD_YR = #{audYr}
					AND AUD_NO = #{audNo}
					AND DSP_RQ_SNO = #{dspRqSno}
			     	)
			     , #{dspRqAcntCd}
			     , #{eptEfctDvsnCd}
			     , #{acntYe}
			     , #{pnlDrinPsvtAm}
			     , #{rsrAm}
			     , #{splpAm}
			     , #{eptEfctAm}
			     , #{expotYEfctAm}
			     , #{expotYEfctAmCalcBasTxt}
			     , #{etcAcntNm}
			     , #{frtUsrId}
			     , #{fnlUsrId}
			     , #{fnlDealDptCd}
			     , #{fnlMnuId}
			     , SYSDATE
			     , SYSDATE
			);
		END;			
		]]>
	</insert>
	
	<!-- 회계사항 Update BADEAR003EAcctUpdate -->
	<update id="updateAcct" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateAcct */
		<![CDATA[ 	
		DECLARE
			BEGIN		
			UPDATE TBBADEAR003M
			   SET AUD_YR        = #{audYr} 
			     , AUD_NO        = #{audNo} 		
			     , DSP_RQ_SNO    = #{dspRqSno}
			     , ACNT_SBJ_SNO  = #{acntSbjSno}
   
		]]>	 
		<if test='dspRqAcntCd != null and dspRqAcntCd != ""'>
			     ,DSP_RQ_ACNT_CD	= #{dspRqAcntCd}
		</if>	
		<if test='eptEfctDvsnCd != null and eptEfctDvsnCd != ""'>	
			     ,EPT_EFCT_DVSN_CD	= #{eptEfctDvsnCd}	
		</if>		  		
		<if test='acntYe != null and acntYe != ""'>	       
			      ,ACNT_YE      = #{acntYe}
		</if>	
		<if test='pnlDrinPsvtAm != null and pnlDrinPsvtAm != ""'>	       
			      ,PNL_DRIN_PSVT_AM      = #{pnlDrinPsvtAm}
		</if>	
		<if test='rsrAm != null and rsrAm != ""'>	       
			      ,RSR_AM      = #{rsrAm}
		</if>	
		<if test='splpAm != null and splpAm != ""'>	       
			      ,SPLP_AM      = #{splpAm}
		</if>	
		<if test='eptEfctAm != null and eptEfctAm != ""'>	       
			      ,EPT_EFCT_AM      = #{eptEfctAm}
		</if>	
		<if test='expotYEfctAm != null and expotYEfctAm != ""'>
			      ,EXPOT_Y_EFCT_AM      = #{expotYEfctAm}
		</if>	
		<if test='expotYEfctAmCalcBasTxt != null and expotYEfctAmCalcBasTxt != ""'>	       
			      ,EXPOT_Y_EFCT_AM_CALC_BAS_TXT      = #{expotYEfctAmCalcBasTxt}
		</if>				
		<if test='fnlUsrId != null and fnlUsrId != ""'>	       
			      ,FNL_USR_ID      = #{fnlUsrId}
		</if>	
		<if test='fnlDealDptCd != null and fnlDealDptCd != ""'>	       
			      ,FNL_DEAL_DPT_CD  = #{fnlDealDptCd}
		</if>		
		<if test='fnlMnuId != null and fnlMnuId != ""'>
			      ,FNL_MNU_ID        = #{fnlMnuId}
		</if>
		<if test='etcAcntNm != null and etcAcntNm != ""'>
			      ,ETC_ACNT_NM        = #{etcAcntNm}
		</if>		
		<![CDATA[ 	
				 , FNL_MDF_DH        = SYSDATE			
			  WHERE 1=1
			    AND AUD_YR 		= #{audYr} 
			    AND AUD_NO 		= #{audNo} 	
			    AND DSP_RQ_SNO 	= #{dspRqSno}
			    AND ACNT_SBJ_SNO		= #{acntSbjSno}				    
			  ; 
		END; 				  
		]]>			    					        
	</update>		
	
	<!--회계사항 delete  BADEAR003EAcctDelete-->
	<update id="deleteAcct" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateAcct */
		<![CDATA[
		DECLARE
			BEGIN			
			  FOR CS IN ( 
			    SELECT AUD_YR
			         , AUD_NO
			         , DSP_RQ_SNO
			         , ACNT_SBJ_SNO
				  FROM TBBADEAR003M
				 WHERE 1=1
				   AND AUD_YR 		= #{audYr} 
				   AND AUD_NO 		= #{audNo} 	
				   AND DSP_RQ_SNO 	= #{dspRqSno}	
		]]>
		<if test='acntSbjSno != null and acntSbjSno != ""'>
			       AND ACNT_SBJ_SNO		= #{acntSbjSno}
		</if>	
		<if test='dspRqAcntCd != null and dspRqAcntCd != ""'>
			      AND DSP_RQ_ACNT_CD	= #{dspRqAcntCd}
		</if>	
		<if test='eptEfctDvsnCd != null and eptEfctDvsnCd != ""'>
 			      AND EPT_EFCT_DVSN_CD	= #{eptEfctDvsnCd}	
		</if>	
		<![CDATA[
			)
			LOOP 				   		
			   DELETE 
				 FROM TBBADEAR003M
				WHERE 1=1
				  AND AUD_YR 		= CS.AUD_YR
				  AND AUD_NO 		= CS.AUD_NO
				  AND DSP_RQ_SNO 	= CS.DSP_RQ_SNO
				  AND ACNT_SBJ_SNO	= CS.ACNT_SBJ_SNO
				;
				
			END LOOP;
		END;												
		]]>
	</update>	

	

	<!-- 회계사항 수정시 처분요구상세에 회계사항 관련 컬럼을 Update 한다.  BADEAR003EAcctToDetailUpdate -->
	<update id="updateAcctToDetail" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateAcctToDetail */
		<![CDATA[ 	
			UPDATE TBBADEAR002D D1
			   SET ( BGT_RDC_AM         /*예산절감*/
			       , INC_ICR_AM         /*수입증대*/
			       , PPL_BDN_RDT_AM     /*국민부담경감금액*/
			       , FRTN_INCR_AM       /*재산증가*/
			       , EXPN_RTNL_AM       /*지출합리화*/
			       , PNL_DRIN_PSVT_AM   /*추징회수보전금액*/ 
			       , RSR_AM             /*환급금액*/
			       , SPLP_AM            /*추급금액*/
			       , EXPOT_Y_EFCT_AM    /*사후적효과금액*/
			       
			       ) = (SELECT SUM(DECODE(EPT_EFCT_DVSN_CD,'1',EPT_EFCT_AM,''))     AS EPT_EFCT_AM1                 /*예산절감*/
			                 , SUM(DECODE(EPT_EFCT_DVSN_CD,'2',EPT_EFCT_AM,''))     AS EPT_EFCT_AM2                 /*수입증대*/
			                 , SUM(DECODE(EPT_EFCT_DVSN_CD,'3',EPT_EFCT_AM,''))     AS EPT_EFCT_AM3                 /*국민편익*/
			                 , SUM(DECODE(EPT_EFCT_DVSN_CD,'4',EPT_EFCT_AM,''))     AS EPT_EFCT_AM4                 /*재산증가*/     
			                 , SUM(DECODE(EPT_EFCT_DVSN_CD,'5',EPT_EFCT_AM,''))     AS EPT_EFCT_AM5                 /*지출합리화*/    
			                 , SUM(PNL_DRIN_PSVT_AM)                                AS PNL_DRIN_PSVT_AM             /*추징회수보전금액*/
			                 , SUM(RSR_AM)                                          AS RSR_AM                       /*환급금액*/
			                 , SUM(SPLP_AM)                                         AS SPLP_AM                      /*추급금액*/
			                 , SUM(EXPOT_Y_EFCT_AM)                                 AS EXPOT_Y_EFCT_AM              /*사후적효과금액*/
			              FROM TBBADEAR003M
			             WHERE 1=1
			               AND AUD_YR       = D1.AUD_YR
			               AND AUD_NO       = D1.AUD_NO
			               AND DSP_RQ_SNO   = D1.DSP_RQ_SNO
			             GROUP BY AUD_YR
			                    , AUD_NO
			                    , DSP_RQ_SNO)
			 WHERE 1=1
			   AND D1.AUD_YR        = #{audYr}
			   AND D1.AUD_NO        = #{audNo}
			   AND D1.DSP_RQ_SNO    = #{dspRqSno}
		]]>			    					        
	</update>




	<!-- 회계사항 이력 insert  BADEAR003EAcctHisInsert -->
	<insert id="insertAcctHis" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertAcctHis */
		<![CDATA[
			INSERT INTO TBBADEAR009H (
			       AUD_YR
			     , AUD_NO
			     , DSP_RQ_SNO
			     , ACNT_SBJ_SNO
			     , DSP_RQ_ACNT_CD
			     , EPT_EFCT_DVSN_CD
			     , HST_SNO
			     , ACNT_YE
			     , PNL_DRIN_PSVT_AM
			     , RSR_AM
			     , SPLP_AM
			     , EPT_EFCT_AM
			     , EXPOT_Y_EFCT_AM
			     , EXPOT_Y_EFCT_AM_CALC_BAS_TXT
			     , FRT_USR_ID
			     , FNL_USR_ID
			     , FNL_DEAL_DPT_CD
			     , FNL_MNU_ID
			     , FRT_REGI_DH
			     , FNL_MDF_DH 
			) 
			SELECT AUD_YR
			     , AUD_NO
			     , DSP_RQ_SNO
			     , ACNT_SBJ_SNO
			     , DSP_RQ_ACNT_CD
			     , EPT_EFCT_DVSN_CD
			     , (
					SELECT TO_CHAR(NVL(MAX(TO_NUMBER(HST_SNO)),0)+1) AS MAX_HST_SNO
					  FROM TBBADEAR009H
					 WHERE 1=1
					   AND AUD_YR     = #{audYr}   
					   AND AUD_NO     = #{audNo}   
					   AND DSP_RQ_SNO = #{dspRqSno}
			       )
			     , ACNT_YE
			     , PNL_DRIN_PSVT_AM
			     , RSR_AM
			     , SPLP_AM
			     , EPT_EFCT_AM
			     , EXPOT_Y_EFCT_AM
			     , EXPOT_Y_EFCT_AM_CALC_BAS_TXT
			     , #{frtUsrId}
			     , #{fnlUsrId}
			     , #{fnlDealDptCd}
			     , #{fnlMnuId}
			     , SYSDATE
			     , SYSDATE
			  FROM TBBADEAR003M
			 WHERE 1=1
			   AND AUD_YR     = #{audYr}
			   AND AUD_NO     = #{audNo}
			   AND DSP_RQ_SNO = #{dspRqSno}
		]]>
	</insert>		


	
	
	
	
	
	
	
	
	
	
	
	
	
	<!--집행전말 상세조회 관계자 조회   BADFRE003EDfntselect -->
	<select id="selectDfntList" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectDfntList */
        <![CDATA[
			SELECT
			    T1.AUD_YR,
				T1.AUD_NO,
				T1.DSP_RQ_SNO,
				T1.RLTN_ORG_CD,
                (SELECT ORG_NM FROM TBDCMACM015M WHERE ORG_CD = T1.RLTN_ORG_CD AND ROWNUM = 1) AS RLTN_ORG_NM,				
				T1.DFNT_SNO,
				T1.AD,
				T1.OCP_CD,
				F_CODE_NM('1000057', T1.OCP_CD) AS OCP_NM,
				T1.RANK_CD,
				F_CODE_NM('1000058', T1.RANK_CD) AS RANK_NM,
				T1.DFNT_NAM,
				DECODE(T1.EIN,'','',SUBSTR(T1.EIN,0,6)||'-'||SUBSTR(T1.EIN,7,1)||'*') AS EIN,
				T1.BK_COM_AD,
				T1.CMPY_NM,
				T1.ACNT_NM,
				T1.HND_CD,
				T1.AM,
				DECODE(T1.CPLT_YN, 'Y', 'Y', 'N') AS CPLT_YN,
                DECODE(T1.CPLT_YN, 'Y', '완결', '미결') AS CPLT_YN_NM,
				T1.HND_RQ_KND_CD,
				F_CODE_NM('1000011', T1.HND_RQ_KND_CD) AS HND_RQ_KND_NM,
				T1.CPLT_DT,
				T1.CPLT_PEN_ID,
				T1.SDY_GRT_AM,
				T1.SDY_GRT_RSN,
				T1.AUD_PNSH_RQ,
				T1.ORG_PNSH_DSP
			  FROM TBBADEAR007M T1
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #{audYr}	 	
			   AND T1.AUD_NO               = #{audNo}	   
			   AND T1.DSP_RQ_SNO           = #{dspRqSno}	 	   
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}
			          
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.DFNT_SNO 
        ]]>
	</select>
	
	
	
	<!--  집행전말 상세조회 관계자집행전말 조회   BADFRE003EDfntEnfmselect  -->
	<select id="selectDfntEnfmList" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectDfntEnfmList */
        <![CDATA[
			SELECT
			    T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.DFNT_SNO
				,T1.ENFM_SNO
				,(
					SELECT MAX(ST1.ENFM_SNO) + 1
					FROM TBBADFRE008M ST1
					WHERE 1 = 1
					AND ST1.AUD_YR = T1.AUD_YR
					AND ST1.AUD_NO = T1.AUD_NO
					AND ST1.DSP_RQ_SNO = T1.DSP_RQ_SNO
					AND ST1.RLTN_ORG_CD = T1.RLTN_ORG_CD
					AND ST1.DFNT_SNO = T1.DFNT_SNO
				) AS MAX_DFNT_ENFM_SNO			
				,T1.ENFM_SHP_CD
				,F_CODE_NM('1000003', T1.ENFM_SHP_CD) AS ENFM_SHP_NM
				,T1.PNL_AM
				,TO_CHAR(TO_DATE(T1.ENFM_DT),'YYYY-MM-DD') AS ENFM_DT
				,T1.ENFM_HIS
				,T1.ENFM_NOC
				,(SELECT DFNT_NAM FROM TBBADEAR007M WHERE AUD_YR = T1.AUD_YR
				     AND AUD_NO = T1.AUD_NO
				     AND DSP_RQ_SNO = T1.DSP_RQ_SNO
				     AND RLTN_ORG_CD = T1.RLTN_ORG_CD
				     AND DFNT_SNO = T1.DFNT_SNO
				     AND ROWNUM = 1
				 ) AS DFNT_NAM
				,T1.FRT_USR_ID
				,T1.FNL_USR_ID
				,T1.FNL_DEAL_DPT_CD
				,T1.FNL_MNU_ID
				,T1.FRT_REGI_DH
				,T1.FNL_MDF_DH
			  FROM TBBADFRE008M T1
			 WHERE 1 = 1 
			   AND T1.AUD_YR               = #{audYr}	
			   AND T1.AUD_NO               = #{audNo}	   
			   AND T1.DSP_RQ_SNO           = #{dspRqSno}	 	   
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}	 	   
			   AND T1.DFNT_SNO          = #{dfntSno}    
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.DFNT_SNO, T1.ENFM_SNO  
        ]]>
	</select>

	
	
    <!--집행전말이력 MAX HST_NO 값 조회  BADFRE003EEnfmHisMaxCntselect-->
	<select id="selectEnfmHisMaxCnt" parameterType="paramMap" resultType="String">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectEnfmHisMaxCnt */
        <![CDATA[
			SELECT
			    MAX(T1.HST_NO) + 1 AS MAX_HST_NO
			FROM TBBADFRE001H T1
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #{audYr} 	
			   AND T1.AUD_NO               = #{audNo}	   
			   AND T1.DSP_RQ_SNO           = #{dspRqSno}	 	   
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}
        ]]>
	</select>	
	
	
	<!--집행전말단계별계획 조회 BADFRE003EEnfmStepPlanselect-->
	<select id="selectEnfmStepPlanList" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectEnfmStepPlanList */
	
        <![CDATA[
			SELECT
				T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.HST_NO
				,T1.ENFM_STEP_NO
                ,CASE WHEN LENGTH(T1.ENFM_STEP_STR_DT) = 8 THEN TO_CHAR(TO_DATE(T1.ENFM_STEP_STR_DT),'YYYY-MM-DD')
                      ELSE T1.ENFM_STEP_STR_DT 
                  END                                         AS ENFM_STEP_STR_DT
                ,CASE WHEN LENGTH(T1.ENFM_STEP_END_DT) = 8 THEN TO_CHAR(TO_DATE(T1.ENFM_STEP_END_DT),'YYYY-MM-DD')
                      ELSE T1.ENFM_STEP_END_DT 
                  END                                         AS ENFM_STEP_END_DT				
				,T1.ENFM_STEP_PLN_TXT
				,T1.FRT_USR_ID
				,T1.FNL_USR_ID
				,T1.FNL_DEAL_DPT_CD
				,T1.FNL_MNU_ID
				,T1.FRT_REGI_DH
				,T1.FNL_MDF_DH
			FROM TBBADFRE001L T1
			 WHERE 1 = 1 
			   AND T1.AUD_YR               = #{audYr}
			   AND T1.AUD_NO               = #{audNo} 
			   AND T1.DSP_RQ_SNO           = #{dspRqSno} 	   
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd} 	   
			   AND T1.HST_NO               = #{hstNo}
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.HST_NO
        ]]>
	</select>
	
	<!-- 처분요구 회계사항 조회 BADFRE003EAccountingselect-->
	<select id="selectAccountingList" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectAccountingList */
	
        <![CDATA[
			SELECT T1.AUD_YR
			,T1.AUD_NO
			,T1.DSP_RQ_SNO
			,T1.ACNT_SBJ_SNO
			,T1.DSP_RQ_ACNT_CD
			,F_CODE_NM('1000004', T1.DSP_RQ_ACNT_CD) AS DSP_RQ_ACNT_NM
			,T1.EPT_EFCT_DVSN_CD
			,F_CODE_NM('1000334', T1.EPT_EFCT_DVSN_CD) AS EPT_EFCT_DVSN_NM
			,T1.ACNT_YE
			,T1.PNL_DRIN_PSVT_AM
			,T1.RSR_AM
			,T1.SPLP_AM
			,T1.EPT_EFCT_AM
			,T1.EXPOT_Y_EFCT_AM
			,T1.EXPOT_Y_EFCT_AM_CALC_BAS_TXT
			,T1.FRT_USR_ID
			,T1.FNL_USR_ID
			,T1.FNL_DEAL_DPT_CD
			,T1.FNL_MNU_ID
			,T1.FRT_REGI_DH
			,T1.FNL_MDF_DH
			FROM TBBADEAR003M T1
			WHERE 1 = 1
			AND T1.AUD_YR               = #{audYr}
			AND T1.AUD_NO               = #{audNo}
			AND T1.DSP_RQ_SNO           = #{dspRqSno}
        ]]>
	</select>
	
	
	<!-- 처분요구 회계사항 저장  BADFRE003EAccountingselect-->
	<insert id="insertAccountingInfo" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertAccountingInfo */
       <![CDATA[
 			INSERT INTO TBBADEAR003M
		  (
			AUD_YR
			,AUD_NO
			,DSP_RQ_SNO
			,ACNT_SBJ_SNO
			,DSP_RQ_ACNT_CD
			,EPT_EFCT_DVSN_CD
			,ACNT_YE
			,PNL_DRIN_PSVT_AM
			,RSR_AM
			,SPLP_AM
			,EPT_EFCT_AM
			,EXPOT_Y_EFCT_AM
			,EXPOT_Y_EFCT_AM_CALC_BAS_TXT
			,FRT_USR_ID
			,FNL_USR_ID
			,FNL_DEAL_DPT_CD
			,FNL_MNU_ID
			,FRT_REGI_DH
			,FNL_MDF_DH     
		  )
		  VALUES
		  (
			#{audYr}
			,#{audNo}
			,#{dspRqSno}
			,#{acntSbjSno}
			,#{dspRqAcntCd}
			,#{eptEfctDvsnCd}
			,#{acntYe}
			,#{pnlDrinPsvtAm}
			,#{rsrAm}
			,#{splpAm}
			,#{eptEfctAm}
			,#{expotYEfctAm}
			,#{expotYEfctAmCalcBasTxt}
			,#{frtUsrId}
			,#{fnlUsrId}
			,#{fnlDealDptCd}
			,#{fnlMnuId}
			,SYSDATE
			,SYSDATE   
		  )
       ]]>
	</insert>
	
	<!-- 처분요구 회계사항 수정  BADFRE003EAccountingInfoupdate-->
	<update id="updateAccountingInfo" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateAccountingInfo */
		<![CDATA[		
		     UPDATE TBBADEAR003M		
		     SET FNL_MDF_DH	=	SYSDATE		
		]]>		
		<if test='audYr != null and audYr != ""'>
		     ,AUD_YR	=	#{audYr}
		</if>		
		<if test='audNo != null and audNo != ""'>
		     AUD_NO	=	#{audNo}
		</if>		
		<if test='dspRqSno != null and dspRqSno != ""'>
		     DSP_RQ_SNO	=	#{dspRqSno}
		</if>		
		<if test='acntSbjSno != null and acntSbjSno != ""'>
		     ACNT_SBJ_SNO	=	#{acntSbjSno}
		</if>		
		<if test='dspRqAcntCd != null and dspRqAcntCd != ""'>
		     DSP_RQ_ACNT_CD	=	#{dspRqAcntCd}
		</if>		
		<if test='eptEfctDvsnCd != null and eptEfctDvsnCd != ""'>
		     EPT_EFCT_DVSN_CD	=	#{eptEfctDvsnCd}
		</if>		
		<if test='acntYe != null and acntYe != ""'>
		     ACNT_YE	=	#{acntYe}
		</if>		
		<if test='pnlDrinPsvtAm != null and pnlDrinPsvtAm != ""'>
		     PNL_DRIN_PSVT_AM	=	#{pnlDrinPsvtAm}
		</if>		
		<if test='rsrAm != null and rsrAm != ""'>
		     RSR_AM	=	#{rsrAm}
		</if>		
		<if test='splpAm != null and splpAm != ""'>
		     SPLP_AM	=	#{splpAm}
		</if>		
		<if test='eptEfctAm != null and eptEfctAm != ""'>
		     EPT_EFCT_AM	=	#{eptEfctAm}
		</if>		
		<if test='expotYEfctAm != null and expotYEfctAm != ""'>
		     EXPOT_Y_EFCT_AM	=	#{expotYEfctAm}
		</if>		
		<if test='expotYEfctAmCalcBasTxt != null and expotYEfctAmCalcBasTxt != ""'>
		     EXPOT_Y_EFCT_AM_CALC_BAS_TXT	=	#{expotYEfctAmCalcBasTxt}
		</if>		
		<if test='dspRqBkAcntCd != null and dspRqBkAcntCd != ""'>
		     DSP_RQ_BK_ACNT_CD	=	#{dspRqBkAcntCd}
		</if>		
		<if test='fnlUsrId != null and fnlUsrId != ""'>
		     FNL_USR_ID	=	#{fnlUsrId}
		</if>		
		<if test='fnlDealDptCd != null and fnlDealDptCd != ""'>
		     FNL_DEAL_DPT_CD	=	#{fnlDealDptCd}
		</if>		
		<if test='fnlMnuId != null and fnlMnuId != ""'>
		     FNL_MNU_ID	=	#{fnlMnuId}
		</if>		
		<![CDATA[	
     WHERE 1=1		

				AND AUD_YR           = #{audYr}
				AND AUD_NO           = #{audNo}
				AND DSP_RQ_SNO       = #{dspRqSno}
				AND ACNT_SBJ_SNO     = #{acntSbjSno}	
        ]]>
	</update>
	
	<!-- 처분요구 회계사항 삭제  BADFRE003EAccountingInfodelete-->
	<delete id="deleteAccountingInfo" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.deleteAccountingInfo */
        <![CDATA[
        	  DELETE
        	    FROM TBBADEAR003M
			   WHERE 1 = 1
				AND AUD_YR           = #{audYr}
				AND AUD_NO           = #{audNo}
				AND DSP_RQ_SNO       = #{dspRqSno}
				AND ACNT_SBJ_SNO     = #{acntSbjSno}
        ]]>
	</delete>
	



	<!--집행전말 상세조회 집행독촉 조회-->
	<select id="selectEnfmPrsuList" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectEnfmPrsuList */
        <![CDATA[
			SELECT
				T1.AUD_YR
				,T1.AUD_NO
				,T1.DSP_RQ_SNO
				,T1.RLTN_ORG_CD
				,T1.ENFM_PRSU_SNO
				,(
					SELECT MAX(ST1.ENFM_PRSU_SNO) + 1
					FROM TBBADFRE009M ST1
					WHERE 1 = 1
					AND ST1.AUD_YR = T1.AUD_YR
					AND ST1.AUD_NO = T1.AUD_NO
					AND ST1.DSP_RQ_SNO = T1.DSP_RQ_SNO
					AND ST1.RLTN_ORG_CD = T1.RLTN_ORG_CD
				) AS MAX_ENFM_PRSU_SNO
				,T1.ENFM_PRSU_HIS
				,TO_CHAR(TO_DATE(T1.ENFM_PRSU_DT),'YYYY-MM-DD') AS ENFM_PRSU_DT
				,T1.ENFM_PRSU_PEN_ID
				,NVL(F_USR_INFO(T1.ENFM_PRSU_PEN_ID, '2'), T1.ENFM_PRSU_PEN_ID) AS ENFM_PRSU_PEN_NM
				,T1.UN_ENFM_RSN
				,T1.ENFM_PLAN_TXT
				,T1.ENFM_PRSU_RSP_DT
				,T1.ENFM_PRSU_RSPR_ID
				,T1.ENFM_PRSU_ACP_DT
				,T1.ENFM_PRSU_RCEP_ID
				,T1.PRSU_DVSN_CD
				,T1.SLF_ACP_STA_CD
				,T1.SLF_ACP_DT
				,T1.SLF_APV_DT
				,T1.ONR_SEN_DT
				,T1.ONR_SEN_PEN_ID
				,T1.DOC_ID
				,T1.DOC_TYP_CD
				/* ,T1.OPM_TXT */
				,(CASE WHEN OPM_TXT IS NOT NULL THEN 'Y' ELSE 'N' END) AS OPM_TXT_YN
				,T1.ONR_DOC_MNG_CRD_ID
				,T1.CVPT_OPM_APV_HNDL_STA_CD
				,T1.ADMN_INF_HNDL_NO
				,T1.ONR_APV_RQS_DH
				,T1.ONR_APV_CMPT_DH
				,T1.FRT_USR_ID
				,T1.FNL_USR_ID
				,T1.FNL_DEAL_DPT_CD
				,T1.FNL_MNU_ID
				,T1.FRT_REGI_DH
				,T1.FNL_MDF_DH
			  FROM TBBADFRE009M T1
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #{audYr} 	
			   AND T1.AUD_NO               = #{audNo} 	   
			   AND T1.DSP_RQ_SNO           = #{dspRqSno} 	   
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}
			   AND T1.SLF_ACP_STA_CD       = '30'
		]]>	   
			
			<if test='enfmPrsuSno != null and enfmPrsuSno != ""'>
     		   AND T1.ENFM_PRSU_SNO        = #{enfmPrsuSno}
			</if>
			
		<![CDATA[ 	   
			  ORDER BY T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.ENFM_PRSU_SNO 
        ]]>
	</select>	
	
	
	
	
	<!-- 감사자 SELECT -->
	<select id="selectEtrList" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectEtrList */
        <![CDATA[     	
			SELECT D1.AUD_YR                    AS AUD_YR                   /*감사년도*/
			     , D1.AUD_NO                    AS AUD_NO                   /*감사번호*/
			     , D1.DSP_RQ_SNO                AS DSP_RQ_SNO               /*처분요구순번*/
			     , D1.ETR_PEN_ID                AS ETR_PEN_ID               /*적출자ID*/
			     , D1.ETR_PEN_BLT_CD            AS ETR_PEN_BLT_CD           /*적출자소속코드*/
			     , D1.ETR_PEN_RANK_CD           AS ETR_PEN_RANK_CD          /*적출자직급코드*/
			     , D1.ETR_PEN_NAM               AS ETR_PEN_NAM              /*적출자성명*/
			     , F_DPT_INFO(D1.ETR_PEN_BLT_CD,'1')	    AS ETR_PEN_BLT_NM   /*적출자소속명*/
			     , F_CODE_NM('1000173',D1.ETR_PEN_RANK_CD)	AS ETR_PEN_RANK_NM  /*적출자직급명*/
			     , D1.CTB_RTE                   AS CTB_RTE                  /*기여율*/
			     , D1.PNL_DRIN_PSVT_AM          AS PNL_DRIN_PSVT_AM         /*추징회수보전금액*/
			     , D1.IJS_AM                    AS IJS_AM                   /*부당금액*/
			     , D1.NOP_RTE                   AS NOP_RTE                  /*인원율*/
			     , D1.ETR_PEN_EXAM_OPIN_TXT     AS ETR_PEN_EXAM_OPIN_TXT    /*적출자검토의견내용*/
			     , F_DPT_INFO( F_USR_INFO(D1.ETR_PEN_ID, '5'),'1')       AS BLT_NM	/*현재소속부서*/
                 , F_CODE_NM('1000173',F_USR_INFO(D1.ETR_PEN_ID, '3'))   AS RANK_NM	/*현재직급*/
			  FROM TBBADEAR004M D1      
			 WHERE 1=1
			   AND D1.AUD_YR 		= #{audYr} 	 
			   AND D1.AUD_NO 		= #{audNo} 	 
			   AND D1.DSP_RQ_SNO 	= #{dspRqSno} 
			 ORDER BY D1.ETR_PEN_ID			 
		]]>
	</select>
	
	

	<!--관계기관 완결처리 (관련 관계자 완결여부 확인)  BADFRE003EDfntCompleteselect  -->
	<select id="selectDfntComplete" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectDfntComplete */
        <![CDATA[     	
			SELECT T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.DFNT_SNO
			  FROM TBBADEAR007M T1 
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #{audYr} 	 
			   AND T1.AUD_NO               = #{audNo} 	 
			   AND T1.DSP_RQ_SNO           = #{dspRqSno} 
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}
			   AND (T1.CPLT_YN <> 'Y' OR T1.CPLT_YN IS NULL)
		]]>
	</select>
	
	
	
	
	
	<!--최종 완결처리 (관계자 완결여부 확인)  BADFRE003EFinalDfntCompleteselect-->
	<select id="selectFinalDfntComplete" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectFinalDfntComplete */
        <![CDATA[
			SELECT T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD, T1.DFNT_SNO
			  FROM TBBADEAR007M T1 
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #{audYr} 	 
			   AND T1.AUD_NO               = #{audNo} 	 
			   AND T1.DSP_RQ_SNO           = #{dspRqSno} 
			   AND (T1.CPLT_YN <> 'Y' OR T1.CPLT_YN IS NULL)
        ]]>
	</select>
	
	<!--최종 완결처리 (관련 관계기관 완결여부 확인) BADFRE003ERltnOrgCompleteselect -->
	<select id="selectRltnOrgComplete" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectRltnOrgComplete */
        <![CDATA[
			SELECT T1.AUD_YR, T1.AUD_NO, T1.DSP_RQ_SNO, T1.RLTN_ORG_CD 
			  FROM TBBADEAR006M T1 
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #{audYr} 	
			   AND T1.AUD_NO               = #{audNo} 	
			   AND T1.DSP_RQ_SNO           = #{dspRqSno}
			   AND (T1.CPLT_YN <> 'Y' OR T1.CPLT_YN IS NULL)
        ]]>
	</select>
	
		<!-- 최종 완결처리 업데이트  BADFRE003ECompleteResultupdate-->
	<update id="updateCompleteResult" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateCompleteResult */
       <![CDATA[
			UPDATE TBBADEAR002D
			SET DTM_YN                        = #{dtmYn}
			   ,CPLT_DT                       = DECODE(#{dtmYn},'Y',#{cpltDt},'')
			   ,CPLT_PEN_ID                   = DECODE(#{dtmYn},'Y',#{sCnb},'')
			   ,ENFM_CPLT_IPT_DT              = DECODE(#{dtmYn},'Y',TO_CHAR(SYSDATE,'YYYYMMDD'),'') 
			   ,ENFM_CPLT_IPT_PEN_ID          = DECODE(#{dtmYn},'Y',#{sCnb},'')
			   ,ENFM_WHLS_APV_KND_CD          = DECODE(#{dtmYn},'Y',#{enfmWhlsApvKndCd},'')
			   ,EXAM_RPRT_DSP_RQ_SBT          = DECODE(#{dtmYn},'Y',#{examRprtDspRqSbt},'')
			   ,EXAM_RPRT_UNENFM_RTWR_TXT     = DECODE(#{dtmYn},'Y',#{examRprtUnenfmRtwrTxt},'')
			   ,EXAM_RPRT_UNENFM_RSN_EXAM_TXT = DECODE(#{dtmYn},'Y',#{examRprtUnenfmRsnExamTxt},'')
			   
			   /* 미결,완결 상태구분코드 추가 - 2016.05.19 yyh */
			   /* 화면에서 콤보 1개로 해서 분기 */
			]]>
			<if test='dtmYn == "Y"'>
			   ,NOT_CPLT_STA_DVSN_CD          = ''
			   ,CPLT_STA_DVSN_CD              = #{cpltStaDvsnCd}
			</if>
			<if test='dtmYn == "N"'>
			   ,NOT_CPLT_STA_DVSN_CD          = #{cpltStaDvsnCd}
			   ,CPLT_STA_DVSN_CD              = ''
			</if>
		 <![CDATA[	
			   ,FNL_USR_ID                    = #{fnlUsrId}
			   ,FNL_DEAL_DPT_CD               = #{fnlDealDptCd}
			   ,FNL_MNU_ID                    = #{fnlMnuId}
			   ,FNL_MDF_DH                    = SYSDATE
			WHERE 1 = 1
			AND AUD_YR               = #{audYr}
			AND AUD_NO               = #{audNo}
			AND DSP_RQ_SNO           = #{dspRqSno}	
        ]]>
	</update>
	
	<!-- 확정취소 - 2017.05.16 yyh -->
	<update id="updateConfirmCancel" parameterType="paramMap">
        <![CDATA[
			UPDATE TBBADEAR002D
			   SET 
			      /* 반려 */
			       DSP_RQ_APV_STA_CD    = '4'
			      ,DSP_RQ_APV_STA_DT    = TO_CHAR(SYSDATE,'YYYYMMDD')
			      ,APV_DOC_NO           = ''
			
			      /* 확정취소 */
			      ,DTM_STA_CD           = '1'
			      ,ENFM_WHLS_DTM_DT     = ''
			      ,ENFM_WHLS_DTM_PEN_ID = ''
                  ,DTM_APV_STA_CD       = ''
			      ,DTM_APV_STA_DT       = ''
			      ,DTM_APV_DOC_NO       = ''			   
			      ,FNL_USR_ID           = #{fnlUsrId}
			      ,FNL_DEAL_DPT_CD      = #{fnlDealDptCd}
			      ,FNL_MNU_ID           = #{fnlMnuId}
			      ,FNL_MDF_DH           = SYSDATE
			 WHERE 1 = 1
			   AND AUD_YR               = #{audYr}
			   AND AUD_NO               = #{audNo}
			   AND DSP_RQ_SNO           = #{dspRqSno}	
        ]]>
	</update>	

	<!-- 확정시 결재로직을 한번 더 실행하므로, 확정취소시에만 아래 쿼리를 실행함 - 2016.05.19 yyh  BADFRE003EConfirmupdate-->
	<update id="updateConfirm" parameterType="paramMap">
       /* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateConfirm */
       <![CDATA[
			UPDATE TBBADEAR002D
			SET DTM_STA_CD                    = #{dtmStaCd}
			   ,ENFM_WHLS_DTM_DT              = DECODE(#{dtmStaCd},'2',TO_CHAR(SYSDATE,'YYYYMMDD'),'')
			   ,ENFM_WHLS_DTM_PEN_ID          = DECODE(#{dtmStaCd},'2',#{sCnb},'')
               ,DTM_APV_STA_CD                = ''
			   ,DTM_APV_STA_DT                = ''
			   ,DTM_APV_DOC_NO                = ''			   
			   ,FNL_USR_ID                    = #{fnlUsrId}
			   ,FNL_DEAL_DPT_CD               = #{fnlDealDptCd}
			   ,FNL_MNU_ID                    = #{fnlMnuId}
			   ,FNL_MDF_DH                    = SYSDATE
			WHERE 1 = 1
			AND AUD_YR               = #{audYr}
			AND AUD_NO               = #{audNo}
			AND DSP_RQ_SNO           = #{dspRqSno}	
        ]]>
	</update>
	
	<!-- 처분요구 반려 업데이트(확정시 결산담당관 반려) BADFRE003EDspRqRejectupdate-->
	<update id="updateDspRqReject" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateDspRqReject */
        <![CDATA[
			UPDATE TBBADEAR002D
			SET DSP_RQ_APV_STA_CD = '4'
			   ,DSP_RQ_APV_STA_DT = TO_CHAR(SYSDATE,'YYYYMMDD')
			   ,APV_DOC_NO        = ''
			   ,DTM_RET_RSN_TXT   = #{dtmretrsntxt}    /* 반려사유추가 - 2016.05.18 yyh */
			   ,FNL_USR_ID        = #{fnlUsrId}
			   ,FNL_DEAL_DPT_CD   = #{fnlDealDptCd}
			   ,FNL_MNU_ID        = #{fnlMnuId}
			   ,FNL_MDF_DH        = SYSDATE
			WHERE 1 = 1
			   AND AUD_YR       = #{audYr}
			   AND AUD_NO       = #{audNo}
			   AND DSP_RQ_SNO   = #{dspRqSno}	
        ]]>
	</update>
	
	
	<!-- 
	     현재 특정 기관은 공감시스템에서 회보가 오지 않으므로 담당자가 메일로 받아서 직접입력함
	     이런 경우 집행담당자와 연락처를 입력할 수 없어서 입력받기 위해 신규입력 추가함 
	    2016.03.16 yyh   BADFRE003ERltnOrgTgOrgSlfInsert
	 -->
	<update id="insertRltnOrgTgOrgSlf" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertRltnOrgTgOrgSlf */
        <![CDATA[            
			MERGE INTO TBBADFRE001M
			USING DUAL
			   ON (     
			            AUD_YR      = #{audYr}
			        AND AUD_NO      = #{audNo}
			        AND DSP_RQ_SNO  = #{dspRqSno} 
			        AND RLTN_ORG_CD = #{rltnOrgCd}
			      ) 
			 WHEN MATCHED THEN 
			    UPDATE 
			       SET TG_ORG_CHGR_NM   = #{tgOrgChgrNm}
			         , TG_ORG_TNB       = #{tgOrgTnb}
			         , FNL_USR_ID       = #{fnlUsrId}
			         , FNL_DEAL_DPT_CD  = #{fnlDealDptCd}
			         , FNL_MNU_ID       = #{fnlMnuId}
			         , FNL_MDF_DH       = SYSDATE
			 WHEN NOT MATCHED THEN   
			    INSERT( 
			  	      AUD_YR
				     ,AUD_NO
				     ,DSP_RQ_SNO
				     ,RLTN_ORG_CD
				     ,TG_ORG_CHGR_NM
				     ,TG_ORG_TNB
				     ,FRT_USR_ID
				     ,FNL_USR_ID
				     ,FNL_DEAL_DPT_CD
				     ,FNL_MNU_ID
				     ,FRT_REGI_DH
				     ,FNL_MDF_DH
			    ) VALUES ( 
			  	      #{audYr}
				     ,#{audNo}
				     ,#{dspRqSno}
				     ,#{rltnOrgCd}
				     ,#{tgOrgChgrNm}
				     ,#{tgOrgTnb}				
				     ,#{frtUsrId}
				     ,#{fnlUsrId}
				     ,#{fnlDealDptCd}
				     ,#{fnlMnuId}
				     ,SYSDATE
				     ,SYSDATE
			    ) 
		]]>
	</update>
		 




	<!--관계기관 완결처리  BADFRE003ERltnOrgCompleteupdate-->
	<update id="updateRltnOrgComplete" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateRltnOrgComplete */
        <![CDATA[
			UPDATE TBBADEAR006M T1 
			   SET T1.CPLT_YN     = #{cpltYn}, 
			       T1.CPLT_DT     = DECODE(#{cpltYn},'N','' ,TO_CHAR(SYSDATE,'YYYYMMDD')), 
			       T1.CPLT_PEN_ID = DECODE(#{cpltYn},'N','' ,#{sCnb}),
			       T1.FNL_USR_ID      = #{fnlUsrId},
				   T1.FNL_DEAL_DPT_CD = #{fnlDealDptCd},
				   T1.FNL_MNU_ID      = #{fnlMnuId},
				   T1.FNL_MDF_DH      = SYSDATE
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #{audYr}
			   AND T1.AUD_NO               = #{audNo}
			   AND T1.DSP_RQ_SNO           = #{dspRqSno}
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}
		]]>
	</update>
	
	<!--관계자 완결처리 BADFRE003EDfntCompleteupdate-->
	<update id="updateDfntComplete" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateDfntComplete */
        <![CDATA[
			UPDATE TBBADEAR007M T1 
			   SET T1.CPLT_YN     = #{cpltYn}, 
			       T1.CPLT_DT     = DECODE(#{cpltYn},'N','' ,TO_CHAR(SYSDATE,'YYYYMMDD')), 
			       T1.CPLT_PEN_ID = DECODE(#{cpltYn},'N','' ,#{sCnb}),
			       T1.AUD_PNSH_RQ     = #{audPnshRq},
			       T1.ORG_PNSH_DSP    = #{orgPnshDsp},
			       T1.FNL_USR_ID      = #{fnlUsrId},
				   T1.FNL_DEAL_DPT_CD = #{fnlDealDptCd},
				   T1.FNL_MNU_ID      = #{fnlMnuId},
				   T1.FNL_MDF_DH      = SYSDATE
			 WHERE 1 = 1
			   AND T1.AUD_YR               = #{audYr}
			   AND T1.AUD_NO               = #{audNo}
			   AND T1.DSP_RQ_SNO           = #{dspRqSno}
			   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}
			   AND T1.DFNT_SNO             = #{dfntSno}
		]]>
	</update>
	
	<!-- BADFRE003ERltnOrgEnfmdelete -->
	<delete id="deleteRltnOrgEnfm" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.deleteRltnOrgEnfm */
        <![CDATA[
        	  DELETE
        	    FROM TBBADFRE006M
			   WHERE 1 = 1
			   AND AUD_YR       = #{audYr}
			   AND AUD_NO       = #{audNo}
			   AND DSP_RQ_SNO   = #{dspRqSno}
			   AND RLTN_ORG_CD  = #{rltnOrgCd}
			   AND ENFM_SNO     = #{enfmSno}
        ]]>
	</delete>
	



	<!--  BADFRE003ERltnOrgEnfminsert -->
	<insert id="insertRltnOrgEnfm" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertRltnOrgEnfm */
        <![CDATA[       
	  INSERT INTO TBBADFRE006M
				  (
					AUD_YR
					,AUD_NO
					,DSP_RQ_SNO
					,RLTN_ORG_CD
					,ENFM_SNO
					,ENFM_DT
					,PNL_AM
					,ENFM_SHP_CD
					,ENFM_HIS
					,ENFM_NOC
					,USR_ID
					,IPT_DH
					,FRT_USR_ID
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,FRT_REGI_DH
					,FNL_MDF_DH
				  )
				  VALUES
				  (
					#{audYr}
					,#{audNo}
					,#{dspRqSno}
					,#{rltnOrgCd}
					,(
						SELECT NVL(MAX(ST1.ENFM_SNO),0) + 1
						FROM TBBADFRE006M ST1
						WHERE 1 = 1
						AND ST1.AUD_YR = #{audYr}
						AND ST1.AUD_NO = #{audNo}
						AND ST1.DSP_RQ_SNO = #{dspRqSno}
						AND ST1.RLTN_ORG_CD = #{rltnOrgCd}
					)
					,REPLACE(#{enfmDt},'-','')
					,#{pnlAm}
					,#{enfmShpCd}
					,#{enfmHis}
					,#{enfmNoc}
					,#{usrId}
					,#{iptDh}
					,#{frtUsrId}
					,#{fnlUsrId}
					,#{fnlDealDptCd}
					,#{fnlMnuId}
					,SYSDATE
					,SYSDATE
				  )
	        ]]>
	</insert>
	<!--  BADFRE003ERltnOrgEnfmupdate -->
	<update id="updateRltnOrgEnfm" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateRltnOrgEnfm */
		<![CDATA[
		     UPDATE TBBADFRE006M
		     SET
		     FNL_MDF_DH=SYSDATE
		]]>
		<if test='audYr != null and audYr != ""'>
		     ,AUD_YR=#{audYr}
		</if>
		<if test='audNo != null and audNo != ""'>
		     ,AUD_NO=#{audNo}
		</if>
		<if test='dspRqSno != null and dspRqSno != ""'>
		     ,DSP_RQ_SNO=#{dspRqSno}
		</if>
		<if test='rltnOrgCd != null and rltnOrgCd != ""'>
		     ,RLTN_ORG_CD=#{rltnOrgCd}
		</if>
		<if test='enfmSno != null and enfmSno != ""'>
		     ,ENFM_SNO=#{enfmSno}
		</if>
		<if test='enfmDt != null and enfmDt != ""'>
		     ,ENFM_DT=REPLACE(#{enfmDt},'-','')
		</if>
		<if test='pnlAm != null and pnlAm != ""'>
		     ,PNL_AM=#{pnlAm}
		</if>
		<if test='enfmShpCd != null and enfmShpCd != ""'>
		     ,ENFM_SHP_CD=#{enfmShpCd}
		</if>
		<if test='enfmHis != null and enfmHis != ""'>
		     ,ENFM_HIS=#{enfmHis}
		</if>
		<if test='enfmNoc != null and enfmNoc != ""'>
		     ,ENFM_NOC=#{enfmNoc}
		</if>
		<if test='usrId != null and usrId != ""'>
		     ,USR_ID=#{usrId}
		</if>
		<if test='iptDh != null and iptDh != ""'>
		     ,IPT_DH=#{iptDh}
		</if>
		<if test='frtUsrId != null and frtUsrId != ""'>
		     ,FRT_USR_ID=#{frtUsrId}
		</if>
		<if test='fnlUsrId != null and fnlUsrId != ""'>
		     ,FNL_USR_ID=#{fnlUsrId}
		</if>
		<if test='fnlDealDptCd != null and fnlDealDptCd != ""'>
		     ,FNL_DEAL_DPT_CD=#{fnlDealDptCd}
		</if>
		<if test='fnlMnuId != null and fnlMnuId != ""'>
		     ,FNL_MNU_ID=#{fnlMnuId}
		</if>
		<![CDATA[
		     WHERE 1=1
		
					   AND AUD_YR       = #{audYr}
					   AND AUD_NO       = #{audNo}
					   AND DSP_RQ_SNO   = #{dspRqSno}
					   AND RLTN_ORG_CD  = #{rltnOrgCd}
					   AND ENFM_SNO     = #{enfmSno} 	
		        ]]>
	</update>
	
	



	<!-- 관계자 이행 상황   BADFRE003EDfntEnfminsert -->
	<insert id="insertDfntEnfm" parameterType="paramMap">
        /* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertDfntEnfm */
        <![CDATA[
			  INSERT INTO TBBADFRE008M
			  (
				AUD_YR          
				,AUD_NO         
				,DSP_RQ_SNO     
				,RLTN_ORG_CD    
				,DFNT_SNO       
				,ENFM_SNO       
				,ENFM_SHP_CD    
				,PNL_AM         
				,ENFM_DT        
				,ENFM_HIS       
				,ENFM_NOC       
				,USR_ID         
				,IPT_DH         
				,FRT_USR_ID     
				,FNL_USR_ID     
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID     
				,FRT_REGI_DH    
				,FNL_MDF_DH     
			  )
			  VALUES
			  (
				#{audYr}         
				,#{audNo}         
				,#{dspRqSno}     
				,#{rltnOrgCd}    
				,#{dfntSno}
				,(
					SELECT NVL(MAX(ST1.ENFM_SNO),0) + 1
					FROM TBBADFRE008M ST1
					WHERE 1 = 1
					AND ST1.AUD_YR = #{audYr}
					AND ST1.AUD_NO = #{audNo}
					AND ST1.DSP_RQ_SNO = #{dspRqSno}
					AND ST1.RLTN_ORG_CD = #{rltnOrgCd}
					AND ST1.DFNT_SNO = #{dfntSno}
				)	
				,#{enfmShpCd}    
				,#{pnlAm}         
				,REPLACE(#{enfmDt},'-','')        
				,#{enfmHis}       
				,#{enfmNoc}       
				,#{usrId}         
				,#{iptDh}         
				,#{frtUsrId}     
				,#{fnlUsrId}     
				,#{fnlDealDptCd}
				,#{fnlMnuId}     
				,SYSDATE    
				,SYSDATE     
			  )
        ]]>
	</insert>


	<!-- 관계자 이행 상황 수정   BADFRE003EDfntEnfmupdate -->
	<update id="updateDfntEnfm" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateDfntEnfm */
		<![CDATA[
		     UPDATE TBBADFRE008M
		     SET FNL_MDF_DH=SYSDATE
		]]>
		<if test='audYr != null and audYr != ""'>
		     ,AUD_YR=#{audYr}
		</if>
		<if test='audNo != null and audNo != ""'>
		     ,AUD_NO=#{audNo}
		</if>
		<if test='dspRqSno != null and dspRqSno != ""'>
		     ,DSP_RQ_SNO=#{dspRqSno}
		</if>
		<if test='rltnOrgCd != null and rltnOrgCd != ""'>
		     ,RLTN_ORG_CD=#{rltnOrgCd}
		</if>
		<if test='dfntSno != null and dfntSno != ""'>
		     ,DFNT_SNO=#{dfntSno}
		</if>
		
		<if test='enfmSno != null and enfmSno != ""'>
		     ,ENFM_SNO=#{enfmSno}
		</if>
		
		<if test='enfmShpCd != null and enfmShpCd != ""'>
		     ,ENFM_SHP_CD=#{enfmShpCd}
		</if>
		
		<if test='pnlAm != null and pnlAm != ""'>
		     ,PNL_AM=#{pnlAm}
		</if>
		
		<if test='enfmDt != null and enfmDt != ""'>
		     ,ENFM_DT=REPLACE(#{enfmDt},'-','')
		</if>
		
		<if test='enfmHis != null and enfmHis != ""'>
		     ,ENFM_HIS=#{enfmHis}
		</if>
		<if test='enfmNoc != null and enfmNoc != ""'>
		     ,ENFM_NOC=#{enfmNoc}
		</if>
		<if test='usrId != null and usrId != ""'>
		     ,USR_ID=#{usrId}
		</if>
		<if test='iptDh != null and iptDh != ""'>
		     ,IPT_DH=#{iptDh}
		</if>
		<if test='frtUsrId != null and frtUsrId != ""'>
		     ,FRT_USR_ID=#{frtUsrId}
		</if>
		<if test='fnlUsrId != null and fnlUsrId != ""'>
		     ,FNL_USR_ID=#{fnlUsrId}
		</if>
		<if test='fnlDealDptCd != null and fnlDealDptCd != ""'>
		     ,FNL_DEAL_DPT_CD=#{fnlDealDptCd}
		</if>
		<if test='fnlMnuId != null and fnlMnuId != ""'>
		     ,FNL_MNU_ID=#{fnlMnuId}
		</if>
		<if test='frtRegiDh != null and frtRegiDh != ""'>
		     ,FRT_REGI_DH=#{frtRegiDh}
		</if>
		<![CDATA[
		     WHERE 1=1
		
					    AND AUD_YR      = #{audYr}
						AND AUD_NO      = #{audNo}
						AND DSP_RQ_SNO  = #{dspRqSno}
						AND RLTN_ORG_CD = #{rltnOrgCd}
						AND DFNT_SNO    = #{dfntSno}
						AND ENFM_SNO    = #{enfmSno} 	
		        ]]>
	</update>
	
	<!-- BADFRE003EDfntEnfmdelete  -->
	<delete id="deleteDfntEnfmd" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.deleteDfntEnfmd */
        <![CDATA[
        	  DELETE
        	    FROM TBBADFRE008M
			   WHERE 1 = 1
				AND AUD_YR      = #{audYr}
				AND AUD_NO      = #{audNo}
				AND DSP_RQ_SNO  = #{dspRqSno}
				AND RLTN_ORG_CD = #{rltnOrgCd}
				AND DFNT_SNO    = #{dfntSno}
				AND ENFM_SNO    = #{enfmSno}
        ]]>
	</delete>
		




	<!-- 이행 게획 실적 회보 내용 저장  BADFRE003EEnfmReturnHisinsert-->
	<insert id="insertEnfmReturnHis" parameterType="paramMap">
        <![CDATA[       
			/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertEnfmReturnHis */
	
  			INSERT INTO TBBADFRE001H
			  (
			  	 AUD_YR
				,AUD_NO
				,DSP_RQ_SNO
				,RLTN_ORG_CD
				,HST_NO
				,ENF_DT
				,ENFM_DT
				,ENFM_STEP_CD
				,ENFM_HIS
				,HST_RMK
				,TG_ORG_APV_DT
				,TG_ORG_APVR_BLT_NM
				,TG_ORG_APVR_RANK_NM
				,TG_ORG_APVR_PST_NM
				,TG_ORG_APVR_NAM
				,DTM_DVSN_CD
				,EXAM_OPIN_TXT
				,EXAM_STA_CD
				,BAI_CHGD_ACP_DT
				,CNTR_ADMN_ORG_ACP_DT
				,CNTR_ADMN_ORG_RCEP_ID
				,TG_ORG_IPT_DH
				,TG_ORG_IPT_PEN_ID
				,CHGR_IPT_DH
				,CHGR_ID
				,ENFM_WHLS_APV_STA_CD
				,APV_DOC_NO
				,ENFM_WHLS_APV_STA_DT
				,SLF_PRSS_STA_CD
				,SLF_APV_DT
				,SLF_SEN_DT
				,SLF_IPT_YN
				,CON_RTRN_CD
				,RET_RSN_TXT
				,DOC_ID
				,DOC_TYP_CD
				,ENFM_WHLS_CON_NO
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
				,CHGR_EXAM_DT /* 담당자검토일 추가 - 2017.11.07 yyh */
			  )
			  VALUES
			  (
			  	 #{audYr}
				,#{audNo}
				,#{dspRqSno}
				,#{rltnOrgCd}
				,(
					SELECT
					    NVL(MAX(T1.HST_NO),0) + 1 AS MAX_HST_NO
					FROM TBBADFRE001H T1
					 WHERE 1 = 1
					   AND T1.AUD_YR               = #{audYr} 	
					   AND T1.AUD_NO               = #{audNo}	   
					   AND T1.DSP_RQ_SNO           = #{dspRqSno}	 	   
					   AND T1.RLTN_ORG_CD          = #{rltnOrgCd}
				)
				,#{enfDt}
				,REPLACE(#{enfmDt},'-','')
				,#{enfmStepCd}
				,#{enfmHis}
				,#{hstRmk}
				,#{tgOrgApvDt}
				,#{tgOrgApvrBltNm}
				,#{tgOrgApvrRankNm}
				,#{tgOrgApvrPstNm}
				,#{tgOrgApvrNam}
				,#{dtmDvsnCd}
				,#{examOpinTxt}
				,'1'
				,TO_CHAR(SYSDATE, 'YYYYMMDD')
				,#{cntrAdmnOrgAcpDt}
				,#{cntrAdmnOrgRcepId}
				,#{tgOrgIptDh}
				,#{tgOrgIptPenId}
				,SYSDATE
				,#{sCnb}
				,#{enfmWhlsApvStaCd}
				,#{apvDocNo}
				,REPLACE(#{enfmWhlsApvStaDt},'-','')
				,#{slfPrssStaCd}
				,#{slfApvDt}
				,REPLACE(#{slfSenDt},'-','')
				,'Y'
				,#{conRtrnCd}
				,#{retRsnTxt}
				,#{docId}
				,#{docTypCd}
				,#{enfmWhlsConNo}
				,#{frtUsrId}
				,#{fnlUsrId}
				,#{fnlDealDptCd}
				,#{fnlMnuId}
				,SYSDATE
				,SYSDATE
				,REPLACE(#{chgrExamDt},'-','')
			  )
        ]]>
	</insert>
	
	
	
	<!-- 이행 게획 실적 회보 내용 수정 BADFRE003EEnfmReturnHisupdate-->
	<update id="updateEnfmReturnHis" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateEnfmReturnHis */
        <![CDATA[
		     UPDATE TBBADFRE001H
		     SET
		      FNL_MDF_DH=SYSDATE
		     ,FNL_USR_ID=#{fnlUsrId}
		     ,FNL_MNU_ID=#{fnlMnuId}
		     ,FNL_DEAL_DPT_CD=#{fnlDealDptCd}
		     ,CHGR_IPT_DH=SYSDATE
		     ,CHGR_ID=#{sCnb}
		     ,CHGR_EXAM_DT = REPLACE(#{chgrExamDt},'-','') /* 담당자검토일 추가 - 2017.11.07 yyh */
		]]>
		<if test='enfDt != null and enfDt != ""'>
		     ,ENF_DT=#{enfDt}
		</if>
		<if test='enfmDt != null and enfmDt != ""'>
		     ,ENFM_DT=REPLACE(#{enfmDt},'-','')
		</if>
		<if test='enfmStepCd != null and enfmStepCd != ""'>
		     ,ENFM_STEP_CD=#{enfmStepCd}
		</if>
		<if test='enfmHis != null and enfmHis != ""'>
		     ,ENFM_HIS=#{enfmHis}
		</if>
		<if test='hstRmk != null and hstRmk != ""'>
		     ,HST_RMK=#{hstRmk}
		</if>
		<if test='tgOrgApvDt != null and tgOrgApvDt != ""'>
		     ,TG_ORG_APV_DT=#{tgOrgApvDt}
		</if>
		<if test='tgOrgApvrBltNm != null and tgOrgApvrBltNm != ""'>
		     ,TG_ORG_APVR_BLT_NM=#{tgOrgApvrBltNm}
		</if>
		<if test='tgOrgApvrRankNm != null and tgOrgApvrRankNm != ""'>
		     ,TG_ORG_APVR_RANK_NM=#{tgOrgApvrRankNm}
		</if>
		<if test='tgOrgApvrPstNm != null and tgOrgApvrPstNm != ""'>
		     ,TG_ORG_APVR_PST_NM=#{tgOrgApvrPstNm}
		</if>
		<if test='tgOrgApvrNam != null and tgOrgApvrNam != ""'>
		     ,TG_ORG_APVR_NAM=#{tgOrgApvrNam}
		</if>
		<if test='dtmDvsnCd != null and dtmDvsnCd != ""'>
		     ,DTM_DVSN_CD=#{dtmDvsnCd}
		</if>
		<if test='examOpinTxt != null and examOpinTxt != ""'>
		     ,EXAM_OPIN_TXT=#{examOpinTxt}
		</if>
		<if test='examStaCd != null and examStaCd != ""'>
		     ,EXAM_STA_CD=#{examStaCd}
		</if>
		<if test='baiChgdAcpDt != null and baiChgdAcpDt != ""'>
		     ,BAI_CHGD_ACP_DT= REPLACE(#{baiChgdAcpDt},'-','')
		</if>
		<if test='cntrAdmnOrgAcpDt != null and cntrAdmnOrgAcpDt != ""'>
		     ,CNTR_ADMN_ORG_ACP_DT=REPLACE(#{cntrAdmnOrgAcpDt},'-','')
		</if>
		<if test='cntrAdmnOrgRcepId != null and cntrAdmnOrgRcepId != ""'>
		     ,CNTR_ADMN_ORG_RCEP_ID=#{cntrAdmnOrgRcepId}
		</if>
		<if test='tgOrgIptDh != null and tgOrgIptDh != ""'>
		     ,TG_ORG_IPT_DH=#{tgOrgIptDh}
		</if>
		<if test='tgOrgIptPenId != null and tgOrgIptPenId != ""'>
		     ,TG_ORG_IPT_PEN_ID=#{tgOrgIptPenId}
		</if>
		<if test='enfmWhlsApvStaCd != null and enfmWhlsApvStaCd != ""'>
		     ,ENFM_WHLS_APV_STA_CD=#{enfmWhlsApvStaCd}
		</if>
		<if test='apvDocNo != null and apvDocNo != ""'>
		     ,APV_DOC_NO=#{apvDocNo}
		</if>
		<if test='enfmWhlsApvStaDt != null and enfmWhlsApvStaDt != ""'>
		    , ENFM_WHLS_APV_STA_DT=REPLACE(#{enfmWhlsApvStaDt},'-','')
		</if>
		<if test='slfPrssStaCd != null and slfPrssStaCd != ""'>
		     SLF_PRSS_STA_CD=#{slfPrssStaCd}
		</if>
		<if test='slfApvDt != null and slfApvDt != ""'>
		     ,SLF_APV_DT=#{slfApvDt}
		</if>
		<if test='slfSenDt != null and slfSenDt != ""'>
		     ,SLF_SEN_DT=REPLACE(#{slfSenDt},'-','')
		</if>
		<if test='slfIptYn != null and slfIptYn != ""'>
		     ,SLF_IPT_YN=#{slfIptYn}
		</if>
		<if test='conRtrnCd != null and conRtrnCd != ""'>
		     ,CON_RTRN_CD=#{conRtrnCd}
		</if>
		<if test='retRsnTxt != null and retRsnTxt != ""'>
		     ,RET_RSN_TXT=#{retRsnTxt}
		</if>
		<if test='docId != null and docId != ""'>
		     ,DOC_ID=#{docId}
		</if>
		<if test='docTypCd != null and docTypCd != ""'>
		     ,DOC_TYP_CD=#{docTypCd}
		</if>
		<if test='enfmWhlsConNo != null and enfmWhlsConNo != ""'>
		     ,ENFM_WHLS_CON_NO=#{enfmWhlsConNo}
		</if>

		        <![CDATA[
		     WHERE 1=1
					   AND AUD_YR       = #{audYr}
					   AND AUD_NO       = #{audNo}
					   AND DSP_RQ_SNO   = #{dspRqSno}
					   AND RLTN_ORG_CD  = #{rltnOrgCd}
					   AND HST_NO       = #{hstNo} 	
		        ]]>
	</update>
	<!-- 이행 계획 실적 회보 내용  삭제 BADFRE003EEnfmReturnHisdelete-->
	<delete id="deleteEnfmReturnHis" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.deleteEnfmReturnHis */
        <![CDATA[
        	  DELETE
        	    FROM TBBADFRE001H
			   WHERE 1 = 1
			   AND AUD_YR       = #{audYr}
			   AND AUD_NO       = #{audNo}
			   AND DSP_RQ_SNO   = #{dspRqSno}
			   AND RLTN_ORG_CD  = #{rltnOrgCd}
			   AND HST_NO       = #{hstNo}
        ]]>
	</delete>
	
	
	

		
	<!-- 이행 독촉   BADFRE003EEnfmPrsuinsert-->	
	<insert id="insertEnfmPrsu" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertEnfmPrsu */
        <![CDATA[       
			
	
			  INSERT INTO TBBADFRE009M
			  (
				AUD_YR             
				,AUD_NO            
				,DSP_RQ_SNO        
				,RLTN_ORG_CD       
				,ENFM_PRSU_SNO     
				,ENFM_PRSU_HIS     
				,ENFM_PRSU_DT      
				,ENFM_PRSU_PEN_ID  
				,UN_ENFM_RSN       
				,ENFM_PLAN_TXT     
				,ENFM_PRSU_RSP_DT  
				,ENFM_PRSU_RSPR_ID 
				,ENFM_PRSU_ACP_DT  
				,ENFM_PRSU_RCEP_ID 
				,PRSU_DVSN_CD      
				,SLF_ACP_STA_CD    
				,SLF_ACP_DT        
				,SLF_APV_DT        
				,ONR_SEN_DT        
				,ONR_SEN_PEN_ID    
				,DOC_ID            
				,DOC_TYP_CD        
				,FRT_USR_ID        
				,FNL_USR_ID        
				,FNL_DEAL_DPT_CD   
				,FNL_MNU_ID        
				,FRT_REGI_DH       
				,FNL_MDF_DH        
			  )
			  VALUES
			  (
				#{audYr}
				,#{audNo}
				,#{dspRqSno}
				,#{rltnOrgCd}
				,(SELECT TO_CHAR(NVL(MAX(TO_NUMBER(ENFM_PRSU_SNO)),0)+1) AS MAX_ACNT_SBJ_SNO
				   FROM TBBADFRE009M
					WHERE 1 = 1
					AND AUD_YR = #{audYr}
					AND AUD_NO = #{audNo}
					AND DSP_RQ_SNO = #{dspRqSno}
					AND RLTN_ORG_CD = #{rltnOrgCd}
			     )
				,#{enfmPrsuHis}
				,REPLACE(#{enfmPrsuDt},'-','')
				,#{enfmPrsuPenId}
				,#{unEnfmRsn}
				,#{enfmPlanTxt}
				,#{enfmPrsuRspDt}
				,#{enfmPrsuRsprId}
				,#{enfmPrsuAcpDt}
				,#{enfmPrsuRcepId}
				,#{prsuDvsnCd}
				,'10'
				,#{slfAcpDt}
				,#{slfApvDt}
				,#{onrSenDt}
				,#{onrSenPenId}
				,#{docId}
				,#{docTypCd}
				,#{frtUsrId}
				,#{fnlUsrId}
				,#{fnlDealDptCd}
				,#{fnlMnuId}
				,SYSDATE
				,SYSDATE
			  )
        ]]>
	</insert>


	<!-- 이행 독촉  수정  BADFRE003EEnfmPrsuupdate-->	
	<update id="updateEnfmPrsu" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.updateEnfmPrsu */
		<![CDATA[		
		     UPDATE TBBADFRE009M		
		     SET
		     FNL_MDF_DH=SYSDATE     		
		]]>	
		<if test='audYr != null and audYr != ""'>
		     ,AUD_YR=#{audYr}
		</if>
		<if test='audNo != null and audNo != ""'>
		     ,AUD_NO=#{audNo}
		</if>
		<if test='dspRqSno != null and dspRqSno != ""'>
		     ,DSP_RQ_SNO=#{dspRqSno}
		</if>
		<if test='rltnOrgCd != null and rltnOrgCd != ""'>
		     ,RLTN_ORG_CD=#{rltnOrgCd}
		</if>
		<if test='enfmPrsuSno != null and enfmPrsuSno != ""'>
		     ,ENFM_PRSU_SNO=#{enfmPrsuSno}
		</if>
		<if test='enfmPrsuHis != null and enfmPrsuHis != ""'>
		     ,ENFM_PRSU_HIS=#{enfmPrsuHis}
		</if>
		<if test='enfmPrsuDt != null and enfmPrsuDt != ""'>
		     ,ENFM_PRSU_DT=REPLACE(#{enfmPrsuDt},'-','')
		</if>
		<if test='enfmPrsuPenId != null and enfmPrsuPenId != ""'>
		     ,ENFM_PRSU_PEN_ID=#{enfmPrsuPenId}
		</if>
		<if test='unEnfmRsn != null and unEnfmRsn != ""'>
		     ,UN_ENFM_RSN=#{unEnfmRsn}
		</if>
		<if test='enfmPlanTxt != null and enfmPlanTxt != ""'>
		     ,ENFM_PLAN_TXT=#{enfmPlanTxt}
		</if>
		<if test='enfmPrsuRspDt != null and enfmPrsuRspDt != ""'>
		     ,ENFM_PRSU_RSP_DT=#{enfmPrsuRspDt}
		</if>
		<if test='enfmPrsuRsprId != null and enfmPrsuRsprId != ""'>
		     ,ENFM_PRSU_RSPR_ID=#{enfmPrsuRsprId}
		</if>
		<if test='enfmPrsuAcpDt != null and enfmPrsuAcpDt != ""'>
		     ,ENFM_PRSU_ACP_DT=#{enfmPrsuAcpDt}
		</if>
		<if test='enfmPrsuRcepId != null and enfmPrsuRcepId != ""'>
		     ,ENFM_PRSU_RCEP_ID=#{enfmPrsuRcepId}
		</if>
		<if test='prsuDvsnCd != null and prsuDvsnCd != ""'>
		    , PRSU_DVSN_CD=#{prsuDvsnCd}
		</if>
		<if test='slfAcpStaCd != null and slfAcpStaCd != ""'>
		     ,SLF_ACP_STA_CD=#{slfAcpStaCd}
		</if>
		<if test='slfAcpDt != null and slfAcpDt != ""'>
		     ,SLF_ACP_DT=#{slfAcpDt}
		</if>
		<if test='slfApvDt != null and slfApvDt != ""'>
		     ,SLF_APV_DT=#{slfApvDt}
		</if>
		<if test='onrSenDt != null and onrSenDt != ""'>
		     ,ONR_SEN_DT=#{onrSenDt}
		</if>
		<if test='onrSenPenId != null and onrSenPenId != ""'>
		     ,ONR_SEN_PEN_ID=#{onrSenPenId}
		</if>
		<if test='docId != null and docId != ""'>
		     ,DOC_ID=#{docId}
		</if>
		<if test='docTypCd != null and docTypCd != ""'>
		     ,DOC_TYP_CD=#{docTypCd}
		</if>
		<if test='fnlUsrId != null and fnlUsrId != ""'>
		     ,FNL_USR_ID=#{fnlUsrId}
		</if>
		<if test='fnlDealDptCd != null and fnlDealDptCd != ""'>
		     ,FNL_DEAL_DPT_CD=#{fnlDealDptCd}
		</if>
		<if test='fnlMnuId != null and fnlMnuId != ""'>
		     ,FNL_MNU_ID=#{fnlMnuId}
		</if>
		<![CDATA[
		     WHERE 1=1		
					   AND AUD_YR        = #{audYr}
					   AND AUD_NO        = #{audNo}
					   AND DSP_RQ_SNO    = #{dspRqSno}
					   AND RLTN_ORG_CD   = #{rltnOrgCd}
					   AND ENFM_PRSU_SNO = #{enfmPrsuSno}
		]]>			   
	</update>
	
	
	<!-- BADFRE003EEnfmPrsudelete  -->
	<delete id="deleteEnfmPrsu" parameterType="paramMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.deleteEnfmPrsu */
        <![CDATA[
        	  DELETE
        	    FROM TBBADFRE009M
			   WHERE 1 = 1
			   AND AUD_YR        = #{audYr}
			   AND AUD_NO        = #{audNo}
			   AND DSP_RQ_SNO    = #{dspRqSno}
			   AND RLTN_ORG_CD   = #{rltnOrgCd}
			   AND ENFM_PRSU_SNO = #{enfmPrsuSno}
        ]]>
	</delete>
		





		
	<!--  BADFRE003EEnfmReturnHisReturninsert  -->	
	<insert id="insertEnfmReturnHisReturn" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertEnfmReturnHisReturn */
        <![CDATA[       
  			INSERT INTO TBBADFRE021H
			  (
				CON_NO             
				,AUD_YR            
				,AUD_NO        
				,DSP_RQ_SNO       
				,RLTN_ORG_CD     
				,HST_NO        
				,ENFM_DT
				,ENFM_STEP_CD
				,ENFM_HIS
				,HST_RMK
				,SLF_SEN_DT
				,TG_ORG_APVR_BLT_NM
				,TG_ORG_APVR_RANK_NM
				,TG_ORG_APVR_PST_NM
				,TG_ORG_APVR_NAM
				,EXAM_OPIN_TXT
				,EXAM_STA_CD
				,CHGR_ID
				,CHGR_IPT_DH
				,USE_YN
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
			  )
			  VALUES
			  (
				(SELECT NVL(MAX(ST1.CON_NO), 0)+ 1
					  FROM TBBADFRE021H ST1
					 WHERE 1 = 1)
				,#{audYr}
				,#{audNo}
				,#{dspRqSno}
				,#{rltnOrgCd}
				,#{hstNo}
				,REPLACE(#{enfmDt},'-','')
				,#{enfmStepCd}
				,#{enfmHis}
				,#{hstRmk}
				,REPLACE(#{slfSenDt},'-','')
				,#{tgOrgApvrBltNm}
				,#{tgOrgApvrRankNm}
				,#{tgOrgApvrPstNm}
				,#{tgOrgApvrNam}
				,#{examOpinTxt}
				,#{examStaCd}
				,#{chgrId}
				,#{chgrIptDh}
				,'N'
				,#{frtUsrId}
				,#{fnlUsrId}
				,#{fnlDealDptCd}
				,#{fnlMnuId}
				,SYSDATE
				,SYSDATE
			  )
        ]]>
	</insert>
		
	<!--  처분번호 레벨에서 접수처리시 연계테이블에 일괄입력 - 2023.01.25 yyh  -->	
	<insert id="insertEnfmReturnHisReturnAudYrNoDspAll" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertEnfmReturnHisReturnAudYrNoDspAll */
        <![CDATA[       
						DECLARE
							BEGIN	
							  FOR CS IN ( 
										 SELECT AUD_YR            
											      ,AUD_NO        
											      ,DSP_RQ_SNO       
											      ,RLTN_ORG_CD     
											      ,HST_NO        
											      ,ENFM_DT
											      ,ENFM_STEP_CD
											      ,ENFM_HIS
											      ,HST_RMK
											      ,SLF_SEN_DT
											      ,TG_ORG_APVR_BLT_NM
											      ,TG_ORG_APVR_RANK_NM
											      ,TG_ORG_APVR_PST_NM
											      ,TG_ORG_APVR_NAM
											      ,EXAM_OPIN_TXT
											      ,EXAM_STA_CD
											      ,CHGR_ID
											      ,CHGR_IPT_DH
											      ,'N' AS USE_YN
										  FROM TBBADFRE001H
										 WHERE AUD_YR       = #{audYr}
										    AND AUD_NO      = #{audNo}
										    AND DSP_RQ_SNO = #{dspRqSno}
										    AND BAI_CHGD_ACP_DT IS NULL 
							)
							LOOP 	
				  			INSERT INTO TBBADFRE021H
							(
								 CON_NO             
								,AUD_YR            
								,AUD_NO        
								,DSP_RQ_SNO       
								,RLTN_ORG_CD     
								,HST_NO        
								,ENFM_DT
								,ENFM_STEP_CD
								,ENFM_HIS
								,HST_RMK
								,SLF_SEN_DT
								,TG_ORG_APVR_BLT_NM
								,TG_ORG_APVR_RANK_NM
								,TG_ORG_APVR_PST_NM
								,TG_ORG_APVR_NAM
								,EXAM_OPIN_TXT
								,EXAM_STA_CD
								,CHGR_ID
								,CHGR_IPT_DH
								,USE_YN
								,FRT_USR_ID
								,FNL_USR_ID
								,FNL_DEAL_DPT_CD
								,FNL_MNU_ID
								,FRT_REGI_DH
								,FNL_MDF_DH
							  )
							  VALUES
							  (
								(SELECT NVL(MAX(CON_NO), 0)+ 1
								  FROM TBBADFRE021H)
								,CS.AUD_YR              
								,CS.AUD_NO              
								,CS.DSP_RQ_SNO          
								,CS.RLTN_ORG_CD         
								,CS.HST_NO              
								,CS.ENFM_DT             
								,CS.ENFM_STEP_CD        
								,CS.ENFM_HIS            
								,CS.HST_RMK             
								,CS.SLF_SEN_DT          
								,CS.TG_ORG_APVR_BLT_NM  
								,CS.TG_ORG_APVR_RANK_NM 
								,CS.TG_ORG_APVR_PST_NM  
								,CS.TG_ORG_APVR_NAM     
								,CS.EXAM_OPIN_TXT       
								,CS.EXAM_STA_CD         
								,CS.CHGR_ID             
								,CS.CHGR_IPT_DH         
								,CS.USE_YN              
								,#{frtUsrId}            
								,#{fnlUsrId}            
								,#{fnlDealDptCd}        
								,#{fnlMnuId}            
								,SYSDATE                
								,SYSDATE                
							  );
							END LOOP;			
						END;			         
        ]]>
	</insert>
	
	<!--집행전말 검토 보고서 조회 -->
	<select id="selectRpt" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.selectEtrList */
        <![CDATA[     	
			SELECT
					 AUD_YR
					,AUD_NO
					,AUD_STEP_CD
					,DOC_ID
					,AUD_KND_CD
					,AUD_GRN_NO
					,F_OPEN_EDIT(LINK_URL) AS DOC_TYPE
			FROM TBBADDED103M
			WHERE 1=1 
		        AND AUD_YR = #{audYr}
				AND AUD_NO = #{audNo}
				AND REF_ID  =   #{refId}
		        AND AUD_STEP_CD = 'A1090'
		        AND RPRT_CD = 'A10900400'		 
		]]>
	</select>


	<!-- BADFRE003EEnfmDelHisinsert  -->
	<insert id="insertEnfmDelHis" parameterType="paramMap">
	/* kr.go.bai.eip.aep.ewm.dao.AEPEWM003EMapper.insertEnfmDelHis */
        <![CDATA[       
  		INSERT INTO TBBADFRE022H
			  (
			    CON_NO
				,AUD_YR            
				,AUD_NO        
				,DSP_RQ_SNO       
				,RLTN_ORG_CD     
				,HST_NO
				,CON_HNDL_CD
				,USE_YN
				,CON_RTRN_CD      
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
			  )
			  VALUES
			  (
			    (SELECT NVL(MAX(ST1.CON_NO), 0)+ 1
					  FROM TBBADFRE022H ST1
					 WHERE 1 = 1)
				,#{audYr}
				,#{audNo}
				,#{dspRqSno}
				,#{rltnOrgCd}
				,#{hstNo}
				,'D'
				,'N'
				,'900'
				,#{frtUsrId}
				,#{fnlUsrId}
				,#{fnlDealDptCd}
				,#{fnlMnuId}
				,SYSDATE
				,SYSDATE
			  )
        ]]>
	</insert>

</mapper> 
