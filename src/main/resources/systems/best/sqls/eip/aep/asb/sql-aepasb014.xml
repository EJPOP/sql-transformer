<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper">
<select id="selectSbcnRegiList" parameterType="paramMap"
        resultType="egovMap">
        /* kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.selectSbcnRegiList */
        <include refid="include.pageSelct" />
        <![CDATA[
             SELECT  REGI_REQ_DT, REGI_NO, AUD_YR_NO, MNG_DPT_NM ,CMTR_NM ,AUD_SBJ_NM ,RLTN_ORG_NM ,REQR, CMT_SQ, SBCN_DY, SBCN_NO, TITLE_NM, DSP_RQ_NM, SBCN_PAGE_CNT, CHGR
                        , AUD_YR,  AUD_NO,  DOC_ID,  APVR_CD,  AFF_SNO,  DSP_RQ_SNO,  SBCN_REGI_REQ_DT, ACP_DVSN_CD, SBCN_VT_NM
               FROM(
		             SELECT  
		                 TO_CHAR(TO_DATE(SBCN_REGI_REQ_DT),'MM"월 "DD"일"') AS REGI_REQ_DT
		                 , (SELECT ST.REGI_NO FROM TBBADFRE112D ST WHERE ST.ACP_YR = T1.ACP_YR AND ST.ACP_DVSN_CD = T1.ACP_DVSN_CD AND ST.ACP_SRNO = T1.ACP_SRNO AND ST.DOC_ID = T1.DOC_ID) AS REGI_NO
		                 , T2.ACP_YR || '-' || DECODE(T2.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || DECODE(T2.ORG_ACP_SRNO, null, T2.ACP_SRNO, T2.ORG_ACP_SRNO)  AS AUD_YR_NO
		                 , F_DPT_INFO(T2.DPT_CD,'1') AS MNG_DPT_NM
		                 , (SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO(ST1.CHF_CMTR_CNB, '2')||DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1), 0, '', ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1))) )
		                       FROM TBBADDED116L ST1
		                      WHERE ST1.AUD_YR = T1.ACP_YR AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO) AND ST1.TASK_DVSN_CD = T1.ACP_DVSN_CD AND ST1.DOC_ID = T1.DOC_ID
		                    	AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T2.ACP_YR AND AUD_NO = TO_CHAR(T2.ACP_SRNO) AND TASK_DVSN_CD = T2.ACP_DVSN_CD AND DOC_ID = T1.DOC_ID)) AS CMTR_NM
		                 , T2.TIT_NM AS AUD_SBJ_NM
		                 , T2.ORG_NM AS RLTN_ORG_NM
		                 , T2.REQR_NM AS REQR       
		                 , CMT_SQ
		                 , TO_CHAR(TO_DATE(SBCN_DY),'MM"월 "DD"일"') AS SBCN_DY
		                 , T1.SBCN_NO
		                 , T2.TIT_NM AS TITLE_NM
		                 , F_CODE_NM('1000002',T1.DSP_RQ_CD ) AS DSP_RQ_NM
		                 , SBCN_PAGE_CNT
		                 , T2.HNDL_CHGR_NM AS CHGR
                          , T1.ACP_YR AS AUD_YR,  TO_CHAR(T1.ACP_SRNO) AS AUD_NO,  T1.DOC_ID, T1.APVR_CD,  T1.AFF_SNO,  T1.DSP_RQ_SNO,  T1.SBCN_REGI_REQ_DT, T1.ACP_DVSN_CD
                          , F_CODE_NM('1000772',T1.SBCN_VT_CD) AS SBCN_VT_NM
		            FROM TBBADFRE113M T1
		                 INNER JOIN TBBADFRE012M T2
		                 ON (T1.ACP_YR = T2.ACP_YR AND T1.ACP_SRNO = T2.ACP_SRNO AND T1.ACP_DVSN_CD = T2.ACP_DVSN_CD)
                         INNER JOIN TBBADFRE112D T8
                         ON (T1.ACP_YR = T8.ACP_YR AND T1.ACP_DVSN_CD = T8.ACP_DVSN_CD AND T1.ACP_SRNO = T8.ACP_SRNO AND T1.DOC_ID = T8.DOC_ID)
		                 LEFT OUTER JOIN TBBADDED120M T3 
		                 ON (T3.CMT_DY = T1.SBCN_DY AND T3.CMT_DVSN_CD = '10')
		                 INNER JOIN TBBADFRE112M T4
		                 ON (T1.ACP_YR = T4.ACP_YR AND T1.ACP_SRNO = T4.ACP_SRNO AND T1.ACP_DVSN_CD = T4.ACP_DVSN_CD)
		                 LEFT OUTER JOIN TBBADDED116L T7
		                       ON (T2.ACP_YR = T7.AUD_YR AND TO_CHAR(T2.ACP_SRNO) = T7.AUD_NO  AND T7.TASK_DVSN_CD = T2.ACP_DVSN_CD
		                           AND T7.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T2.ACP_YR AND AUD_NO = TO_CHAR(T2.ACP_SRNO) AND TASK_DVSN_CD = T2.ACP_DVSN_CD))
		           WHERE T1.SBCN_DY IS NOT NULL 
		      ]]>
		             	<if test='audYrStr != null and audYrStr != "" and audYrEnd != null and audYrEnd != ""'>
                			AND SUBSTR(T1.SBCN_DY,0,4) BETWEEN #{audYrStr} AND #{audYrEnd}
            			</if>
			            <if test="schSpvBrdvCd != null and schSpvBrdvCd != ''">
			             	   AND (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = T2.DPT_CD) =
			              		  #{schSpvBrdvCd}
			            </if>
			            <if test="schDeptCd != null and schDeptCd != ''">
			                AND T2.DPT_CD = #{schDeptCd}
			            </if>
			            <if test="iptChfMbId != null and iptChfMbId != ''">
			                AND (T7.CHF_CMTR_CNB = #{iptChfMbId}
			                     OR T7.CHF_CMTR1_CNB = #{iptChfMbId}
			                     OR T7.CHF_CMTR2_CNB = #{iptChfMbId}
			                     OR T7.CHF_CMTR3_CNB = #{iptChfMbId}
			                     OR T7.CHF_CMTR4_CNB = #{iptChfMbId}
			                     OR T7.CHF_CMTR5_CNB = #{iptChfMbId})
			            </if>
			            <if test="dspRqCd != null and dspRqCd != ''">
			                AND T1.DSP_RQ_CD = #{dspRqCd}
			            </if>
			            <if test="iptSbcnNbc != null and iptSbcnNbc != ''">
			                AND T3.CMT_SQ  = #{iptSbcnNbc}
			            </if>
                        <if test="schAudSbjNm != null and schAudSbjNm != ''">
                            AND T2.TIT_NM LIKE '%'||#{schAudSbjNm}||'%'
                       </if>
                       
                       <if test="schRegiYr != '' or schRegiDsvn != '' or schRegiNo != ''">
                            AND T8.REGI_NO LIKE '%'||#{schRegiYr}||'%'||#{schRegiDsvn}||'%'||#{schRegiNo}||'%'
                       </if>
			  <![CDATA[
			                ORDER BY CMT_SQ, SBCN_PAGE_CNT, SBCN_NO, SBCN_DY
		  	)
         UNION ALL
         
             SELECT  
                 TO_CHAR(TO_DATE(SBCN_REGI_REQ_DT),'MM"월 "DD"일"') AS REGI_REQ_DT
                 , REGI_NO
                 , F_MNG_KND_AUDYRNO(T2.AUD_YR, T2.AUD_NO, T2.AUD_KND_CD, '-') AS AUD_YR_NO
                 , F_DPT_INFO(T2.MNG_DPT_CD,'1') AS MNG_DPT_NM
                 , (SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO(ST1.CHF_CMTR_CNB, '2')||DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1), 0, '', ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1))) )
                       FROM TBBADDED116L ST1
                      WHERE ST1.AUD_YR = T1.AUD_YR AND ST1.AUD_NO = T1.AUD_NO AND ST1.TASK_DVSN_CD = '9'
                        AND ST1.DOC_ID = T1.DOC_ID
                    	AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND TASK_DVSN_CD = '9' AND DOC_ID = ST1.DOC_ID)) AS CMTR_NM
                 , T2.AUD_SBJ_NM
                 , (SELECT F_ORG_INFO(ST1.RLTN_ORG_CD,'1')
                      FROM TBBADDED146M ST1
                     WHERE ST1.AUD_YR = T1.AUD_YR
                       AND ST1.AUD_NO = T1.AUD_NO
                       AND ST1.DOC_ID = T1.DOC_ID
                       AND ST1.APVR_CD = T1.APVR_CD
                       AND ST1.AFF_SNO = T1.AFF_SNO
                       AND ST1.DSP_RQ_SNO = T1.DSP_RQ_SNO) AS RLTN_ORG_NM
                 , '' AS REQR
                 , CMT_SQ
                 , TO_CHAR(TO_DATE(SBCN_DY),'MM"월 "DD"일"') AS SBCN_DY
                 , T1.SBCN_NO
                 , T5.TITLE_NM
                 , F_CODE_NM('1000002',T1.DSP_RQ_CD ) AS DSP_RQ_NM
                 , SBCN_PAGE_CNT
                 , (SELECT MAX(AUDTOR)
                      FROM TBBADDED145M ST1
                     WHERE ST1.AUD_YR = T5.AUD_YR
                       AND ST1.AUD_NO = T5.AUD_NO
                       AND ST1.AUD_STEP_CD = 'A1050'
                       AND ST1.AFF_CD = T5.AFF_CD) AS CHGR
                 , T1.AUD_YR,  T1.AUD_NO,  T1.DOC_ID, T1.APVR_CD,  T1.AFF_SNO,  T1.DSP_RQ_SNO,  T1.SBCN_REGI_REQ_DT, '9' AS ACP_DVSN_CD
                 , F_CODE_NM('1000772',T1.SBCN_VT_CD) AS SBCN_VT_NM
            FROM TBBADDED113M T1
                 INNER JOIN TBBADDED001M T2
                 ON (T1.AUD_YR = T2.AUD_YR AND T1.AUD_NO = T2.AUD_NO)
                 LEFT OUTER JOIN TBBADDED120M T3 
                 ON (T3.CMT_DY = T1.SBCN_DY AND T3.CMT_DVSN_CD = '10')
                 INNER JOIN TBBADDED112D T4
                 ON (T1.AUD_YR = T4.AUD_YR AND T1.AUD_NO = T4.AUD_NO AND T1.DOC_ID = T4.DOC_ID)
                 INNER JOIN TBBADDED145M T5
                 ON (T5.AUD_YR = T1.AUD_YR
                     AND T5.AUD_NO = T1.AUD_NO
                     AND T5.DOC_ID = T1.DOC_ID
                     AND T5.APVR_CD = T1.APVR_CD
                     AND T5.AFF_SNO = T1.AFF_SNO)
                 LEFT OUTER JOIN TBBADDED116L T7
                       ON (T1.AUD_YR = T7.AUD_YR AND T1.AUD_NO = T7.AUD_NO  AND T7.TASK_DVSN_CD = '9'
                           AND T1.DOC_ID = T7.DOC_ID
                           AND T7.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND TASK_DVSN_CD = '9' AND DOC_ID = T7.DOC_ID))
           WHERE T1.SBCN_DY IS NOT NULL 
            ]]>
            <if test='audYrStr != null and audYrStr != "" and audYrEnd != null and audYrEnd != ""'>
                AND SUBSTR(T1.SBCN_DY,0,4) BETWEEN #{audYrStr} AND #{audYrEnd}
            </if>
            <if test="schSpvBrdvCd != null and schSpvBrdvCd != ''">
                AND (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = T2.MNG_DPT_CD) =
                #{schSpvBrdvCd}
            </if>
            <if test="schDeptCd != null and schDeptCd != ''">
                AND T2.MNG_DPT_CD = #{schDeptCd}
            </if>
            <if test="iptChfMbId != null and iptChfMbId != ''">
                AND (T7.CHF_CMTR_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR1_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR2_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR3_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR4_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR5_CNB = #{iptChfMbId})
            </if>
            <if test="dspRqCd != null and dspRqCd != ''">
                AND T1.DSP_RQ_CD = #{dspRqCd}
            </if>
            <if test="iptSbcnNbc != null and iptSbcnNbc != ''">
                AND T3.CMT_SQ  = #{iptSbcnNbc}
            </if>
            <if test="schAudSbjNm != null and schAudSbjNm != ''">
                AND T2.AUD_SBJ_NM LIKE '%'||#{schAudSbjNm}||'%'
           </if>
           
           <if test="schRegiYr != '' or schRegiDsvn != '' or schRegiNo != ''">
                AND T4.REGI_NO LIKE '%'||#{schRegiYr}||'%'||#{schRegiDsvn}||'%'||#{schRegiNo}||'%'
           </if>
            <![CDATA[
                ORDER BY CMT_SQ, SBCN_PAGE_CNT, SBCN_NO, SBCN_DY
            ]]>
        <include refid="include.pageOrder" />
    </select>

    <select id="selectSbcnRegiDtlList" parameterType="paramMap"
        resultType="egovMap">
        /* kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.selectSbcnRegiDtlList */
        <include refid="include.pageSelct" />
          <![CDATA[
   		SELECT  REGI_NO, MNG_DPT_NM, AUD_YR_NO, AUD_SBJ_NM, AUD_RPRT_DVSN_NM, SBCN_AGD_CNT, CHF_CMTR_NM, SBCN_DY, SBCN_NBC, ENF_JA_CPR_DT, AUD_RPRT_CHA, AUD_RPRT_CHONG,
			RTN_RPRT_CHA, RTN_RPRT_CHONG, AUD_RPRT_ONE, AUD_YR, AUD_NO, DOC_ID, REGI_DH, ACP_DVSN_CD, RMK_SBJ, REL_TSK_NM
         FROM(  
              SELECT  REGI_NO, MNG_DPT_NM, AUD_YR_NO, AUD_SBJ_NM, AUD_RPRT_DVSN_NM, SBCN_AGD_CNT, CHF_CMTR_NM, SBCN_DY, SBCN_NBC, ENF_JA_CPR_DT, AUD_RPRT_CHA, AUD_RPRT_CHONG,
      			RTN_RPRT_CHA, RTN_RPRT_CHONG, AUD_RPRT_ONE, AUD_YR, AUD_NO, DOC_ID, SBCN_PAGE_CNT, REGI_DH, ACP_DVSN_CD, RMK_SBJ, REL_TSK_NM
               FROM(  
              SELECT 
                    (SELECT ST.REGI_NO FROM TBBADFRE112D ST WHERE ST.ACP_YR = T1.ACP_YR AND ST.ACP_DVSN_CD = T1.ACP_DVSN_CD AND ST.ACP_SRNO = T1.ACP_SRNO AND ST.DOC_ID = T1.DOC_ID) AS REGI_NO
                    , F_DPT_INFO(T3.DPT_CD,'1') AS MNG_DPT_NM
                    , T1.ACP_YR || '-' || DECODE(T1.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || DECODE(T3.ORG_ACP_SRNO, null, T1.ACP_SRNO, T3.ORG_ACP_SRNO)  AS AUD_YR_NO
                    , T2.TIT_NM AS AUD_SBJ_NM
                    , F_CODE_NM('1000788',T4.ACP_RPRT_DVSN_CD) AS AUD_RPRT_DVSN_NM
                    , COUNT(1) AS SBCN_AGD_CNT
                    , (SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO(ST1.CHF_CMTR_CNB, '2')||DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1), 0, '', ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1))) )
                           FROM TBBADDED116L ST1
                          WHERE ST1.AUD_YR = T1.ACP_YR AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO) AND ST1.TASK_DVSN_CD = T1.ACP_DVSN_CD AND ST1.DOC_ID = T1.DOC_ID
                        	AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.ACP_YR AND AUD_NO = TO_CHAR(T1.ACP_SRNO) AND TASK_DVSN_CD = T1.ACP_DVSN_CD AND DOC_ID = T1.DOC_ID)) AS CHF_CMTR_NM
                    , TO_CHAR(TO_DATE(T1.SBCN_DY),'YYYY"-"MM"-"DD') AS SBCN_DY
                    , SUBSTR(T1.SBCN_DY,3,2)||'-'||SUBSTR('0'||SBCN_NBC,-2) AS SBCN_NBC
                    , TO_CHAR(TO_DATE(T1.ENF_JA_CPR_DT),'YYYY"-"MM"-"DD') AS ENF_JA_CPR_DT
                    , T5.AUD_RPRT_CHA
                    , T5.AUD_RPRT_CHONG
                    , '' AS RTN_RPRT_CHA
                    , '' AS RTN_RPRT_CHONG
                    , T5.AUD_RPRT_ONE
                    , T1.ACP_YR AS AUD_YR
                    , TO_CHAR(T1.ACP_SRNO) AS AUD_NO
                    , T1.DOC_ID
                    , T1.SBCN_PAGE_CNT
                    , T3.ACP_DVSN_CD
                    , (SELECT TO_CHAR(TO_DATE(ST.RVW_REQ_DT),'YYYY-MM-DD') FROM TBBADFRE112D ST WHERE ST.ACP_YR = T1.ACP_YR AND ST.ACP_DVSN_CD = T1.ACP_DVSN_CD AND ST.ACP_SRNO = T1.ACP_SRNO AND ST.DOC_ID = T1.DOC_ID) AS REGI_DH
                    , T8.RMK_SBJ
                    , '' AS REL_TSK_NM
                  FROM TBBADFRE113M T1
                       INNER JOIN TBBADFRE112M T2
                       ON (T1.ACP_YR = T2.ACP_YR AND T1.ACP_DVSN_CD = T2.ACP_DVSN_CD AND T1.ACP_SRNO = T2.ACP_SRNO)
                       INNER JOIN TBBADFRE112D T8
                       ON (T1.ACP_YR = T8.ACP_YR AND T1.ACP_DVSN_CD = T8.ACP_DVSN_CD AND T1.ACP_SRNO = T8.ACP_SRNO AND T1.DOC_ID = T8.DOC_ID)
                       INNER JOIN TBBADFRE012M T3
                       ON (T1.ACP_YR = T3.ACP_YR AND T1.ACP_DVSN_CD = T3.ACP_DVSN_CD AND T1.ACP_SRNO = T3.ACP_SRNO)
                       INNER JOIN TBBADFRE103M T4
                       ON (T1.ACP_YR = T4.ACP_YR AND T1.ACP_DVSN_CD = T4.ACP_DVSN_CD AND T1.ACP_SRNO = T4.ACP_SRNO AND T1.DOC_ID = T4.DOC_ID)
                      INNER JOIN (
								      SELECT 
								              ST1.ACP_YR, ST1.ACP_SRNO, ST1.ACP_DVSN_CD 
								 ,MIN(CASE WHEN ST1.RPRT_CD IN ('D10200200','E10200200')  THEN DECODE(ST2.APVR_PST_CD,'0055600',F_USR_INFO(ST2.APVR_CNB,'2'),
								                                                          DECODE(ST2.APVR_PST_CD,'0045900',F_USR_INFO(ST2.APVR_CNB,'2'),''))
								                                                     ELSE '' END) AS AUD_RPRT_CHA   /* 0045900 : 본부장 추가 */
								 ,MIN(CASE WHEN ST1.RPRT_CD IN ('D10200200','E10200200')  THEN DECODE(ST2.APVR_PST_CD,'0055700',F_USR_INFO(ST2.APVR_CNB,'2'),'')
								 													 ELSE '' END) AS AUD_RPRT_CHONG
								 ,MIN(CASE WHEN ST1.RPRT_CD IN ('D10200200','E10200200')  THEN DECODE(ST2.APVR_PST_CD,'0067400',F_USR_INFO(ST2.APVR_CNB,'2'),'')
								 													 ELSE '' END) AS AUD_RPRT_ONE
								 ,MIN(CASE WHEN ST1.RPRT_CD IN ('D10200200','E10200200')  THEN DECODE(ST2.APVR_KND_CD, '3', TO_CHAR(ST2.APV_DH,'YYYY"-"MM"-"DD" "HH24:MI'), '')
						  	 													     ELSE '' END) AS REGI_DH		
								  
								                FROM TBBADFRE103M ST1 INNER JOIN TBDCMACM023H ST2
								                   ON (ST1.APV_RQS_ID = ST2.APV_DOC_NO AND ST2.APVR_STA_CD IN ('202','203'))
								             WHERE ST1.RPRT_CD IN('D10200200','E10200200')
								             GROUP BY ST1.ACP_YR, ST1.ACP_SRNO,ST1.ACP_DVSN_CD
						            ) T5
						ON (T1.ACP_YR = T5.ACP_YR AND T1.ACP_SRNO = T5.ACP_SRNO AND T1.ACP_DVSN_CD = T5.ACP_DVSN_CD)
                       LEFT OUTER JOIN TBBADDED116L T7
                       ON (T1.ACP_YR = T7.AUD_YR AND TO_CHAR(T1.ACP_SRNO) = T7.AUD_NO  AND T1.ACP_DVSN_CD = T7.TASK_DVSN_CD
                           AND T7.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.ACP_YR AND AUD_NO = TO_CHAR(T1.ACP_SRNO) AND TASK_DVSN_CD = T1.ACP_DVSN_CD ))
                WHERE 1=1
       		 ]]>
            <if test='iptAudYr != null and iptAudYr != ""'>
                AND T1.ACP_YR = #{iptAudYr}
            </if>
            <if test="schSpvBrdvCd != null and schSpvBrdvCd != ''">
                AND (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = T3.DPT_CD) =
                #{schSpvBrdvCd}
            </if>
            <if test="schDeptCd != null and schDeptCd != ''">
                AND T3.DPT_CD = #{schDeptCd}
            </if>
            <if test="iptChfMbId != null and iptChfMbId != ''">
                AND (T7.CHF_CMTR_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR1_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR2_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR3_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR4_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR5_CNB = #{iptChfMbId})
            </if>
            <if test="dspRqCd != null and dspRqCd != ''">
                AND T1.DSP_RQ_CD = #{dspRqCd}
            </if>
            <if test="iptSbcnNbc != null and iptSbcnNbc != ''">
                AND T1.SBCN_NBC  = #{iptSbcnNbc}
            </if>
            <if test="sbcnVtCd != null and sbcnVtCd != ''">
                AND T1.SBCN_VT_CD   = #{sbcnVtCd}
           </if>
            <if test="schAudSbjNm != null and schAudSbjNm != ''">
                AND T2.TIT_NM LIKE '%'||#{schAudSbjNm}||'%'
           </if>
           <if test="schAudYrNoKndCd != null and schAudYrNoKndCd != ''">
                AND T2.ACP_DVSN_CD   = #{schAudYrNoKndCd}
           </if>
           <if test="schAudNo != null and schAudNo != ''">
                AND T3.ACP_SRNO   = #{schAudNo}
           </if>
           <if test="schRegiYr != '' or schRegiDsvn != '' or schRegiNo != ''">
                AND T8.REGI_NO LIKE '%'||#{schRegiYr}||'%'||#{schRegiDsvn}||'%'||#{schRegiNo}||'%'
           </if>
           
                  <![CDATA[ 
           		GROUP BY T2.REGI_NO,T3.DPT_CD,T1.ACP_YR,T1.ACP_DVSN_CD,T3.ORG_ACP_SRNO,T2.TIT_NM,T4.ACP_RPRT_DVSN_CD,T1.SBCN_DY,T1.SBCN_NBC,
           		T1.ENF_JA_CPR_DT,T1.ACP_YR,T1.ACP_SRNO,T1.DOC_ID,T1.SBCN_PAGE_CNT,T5.AUD_RPRT_CHA,T5.AUD_RPRT_CHONG,T5.AUD_RPRT_ONE,T5.REGI_DH,T3.ACP_DVSN_CD, T8.RMK_SBJ

                 ORDER BY T1.SBCN_NBC, T1.SBCN_PAGE_CNT
               
         )
         UNION ALL          
   
               SELECT  REGI_NO, MNG_DPT_NM, AUD_YR_NO, AUD_SBJ_NM, AUD_RPRT_DVSN_NM, SBCN_AGD_CNT, CHF_CMTR_NM, SBCN_DY, SBCN_NBC, ENF_JA_CPR_DT, AUD_RPRT_CHA, AUD_RPRT_CHONG,
      				   RTN_RPRT_CHA, RTN_RPRT_CHONG, AUD_RPRT_ONE, AUD_YR, AUD_NO, DOC_ID, SBCN_PAGE_CNT, REGI_DH, ACP_DVSN_CD, RMK_SBJ, REL_TSK_NM
                 FROM( 
		              SELECT 
		                    T2.REGI_NO
		                    , F_DPT_INFO(T3.MNG_DPT_CD,'1') AS MNG_DPT_NM
		                    , F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, T3.AUD_KND_CD, '-') AS AUD_YR_NO
		                    , T3.AUD_SBJ_NM
		                    , F_CODE_NM('1000788',AUD_RPRT_DVSN_CD) AS AUD_RPRT_DVSN_NM
		                    , COUNT(1) AS SBCN_AGD_CNT
		                    , (SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO(ST1.CHF_CMTR_CNB, '2')||DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1), 0, '', ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1))) )
		                           FROM TBBADDED116L ST1
		                          WHERE ST1.AUD_YR = T1.AUD_YR AND ST1.AUD_NO = T1.AUD_NO AND ST1.TASK_DVSN_CD = '9'
                                    AND ST1.DOC_ID = T1.DOC_ID
		                        	AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND TASK_DVSN_CD = '9' AND DOC_ID = ST1.DOC_ID)) AS CHF_CMTR_NM
		                    , TO_CHAR(TO_DATE(T1.SBCN_DY),'YYYY"-"MM"-"DD') AS SBCN_DY
		                    , SUBSTR(T1.SBCN_DY,3,2)||'-'||SUBSTR('0'||SBCN_NBC,-2) AS SBCN_NBC
		                    , TO_CHAR(TO_DATE(T1.ENF_JA_CPR_DT),'YYYY"-"MM"-"DD') AS ENF_JA_CPR_DT
		                    , T5.AUD_RPRT_CHA
		                    , T5.AUD_RPRT_CHONG
		                    , T6.RTN_RPRT_CHA
		                    , T6.RTN_RPRT_CHONG
		                    , T5.AUD_RPRT_ONE
		                    , T1.AUD_YR
		                    , T1.AUD_NO
		                    , T1.DOC_ID
		                    , T1.SBCN_PAGE_CNT
		                    , '9' AS ACP_DVSN_CD
		                    , NVL(T5.AUD_RPRT_ONE_DH, NVL(T5.AUD_RPRT_CHONG_DH,AUD_RPRT_CHA_DH)) AS REGI_DH
                            , T2.RMK_SBJ
                            , (SELECT 
                                 MAX(CASE WHEN DVSN_CD IN ('1','2','3') THEN (SELECT S1.ACP_YR||'-'||F_CODE_NM('1000740',S1.REQ_DVSN_CD)||'-'||S1.RM_CVPT_ACP_NO
                                                                               FROM TBCSPDCP101M S1
                                                                              WHERE ST1.TSK_KEY1 = S1.ACP_YR
                                                                                AND ST1.TSK_KEY2 = S1.REQ_DVSN_CD
                                                                                AND ST1.TSK_KEY3 = S1.CVPT_ACP_NO)
                                         WHEN DVSN_CD = '4'            THEN ST1.TSK_KEY1 ||'-국회-'|| ST1.TSK_KEY3      /*국회 로직 추가 2017.01.11 전상철*/
                                         WHEN DVSN_CD IN ('5','6','7') THEN (SELECT CASE WHEN S1.ACP_YR >= '2016' 
                                                                                            THEN S1.ACP_YR || '-' || DECODE(S1.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || S1.ACP_SRNO
                                                                                         ELSE S1.ACP_YR || '-' || S1.ACP_DVSN_CD || '-' || S1.ACP_SRNO END
                                                                               FROM TBBADFRE012M S1 
                                                                              WHERE ST1.TSK_KEY1 = S1.ACP_YR   
                                                                                AND ST1.TSK_KEY2 = S1.ACP_DVSN_CD
                                                                                AND ST1.TSK_KEY3 = TO_CHAR(S1.ACP_SRNO)
                                                                                AND ST1.TSK_KEY4 = S1.DPT_CD)
                                         WHEN DVSN_CD IN ('8','9')     THEN (SELECT CASE WHEN S1.OGN_DVSN_CD = '6' THEN S1.YR||'-판청-'||S1.ACP_NO
                                                                                         ELSE S1.YR||'-손망-'||S1.ACP_NO END 
                                                                               FROM TBBADGDA001M S1
                                                                              WHERE ST1.TSK_KEY1 = S1.ORG_CD
                                                                                AND ST1.TSK_KEY2 = S1.NTF_DVSN_CD
                                                                                AND ST1.TSK_KEY3 = S1.NNB)
                                         WHEN DVSN_CD = '0'            THEN TSK_KEY1 ||'-정보-'|| TSK_KEY2
                                         WHEN DVSN_CD = 'A'            THEN F_MNG_KND_AUDYRNO(TSK_KEY1, TSK_KEY2, (SELECT AUD_KND_CD 
                                                                                                                     FROM TBBADDED001M 
                                                                                                                    WHERE AUD_YR = TSK_KEY1 
                                                                                                                      AND AUD_NO = TSK_KEY2), '-') ||'-'|| TSK_KEY3 ||'-'|| F_ORG_INFO(TSK_KEY4,'1')
                                        WHEN DVSN_CD = 'C'            THEN TSK_KEY1 ||'-청금-'||(SELECT RM_CVPT_ACP_NO FROM TBDCPDCP101M WHERE 1=1 AND ACP_YR = TSK_KEY1 AND REQ_DVSN_CD = TSK_KEY2 AND CVPT_ACP_NO = TSK_KEY3)
                                                                                      /*청탁금지법 추가 2020.12.15 최성호*/
                                 WHEN DVSN_CD = 'D'            THEN TSK_KEY1 ||'-'||F_CODE_NM('1000742', 'D')||'-'|| (SELECT RM_CVPT_ACP_NO FROM TBCORCOR101M WHERE 1=1 AND ACP_YR = TSK_KEY1 AND REQ_DVSN_CD = TSK_KEY2 AND CVPT_ACP_NO = TSK_KEY3)
										       										/*부패방지법 추가 2020.12.15 최성호*/
                                                            ELSE ''
                                                        END)||DECODE(COUNT(1),0,'',DECODE(COUNT(1),1,'',' 외 '||(COUNT(1)-1)||'건')) AS EXEC_NO
                                  FROM TBBADDED030L ST1
                                 WHERE ST1.AUD_YR = T1.AUD_YR
                                   AND ST1.AUD_NO = T1.AUD_NO) AS REL_TSK_NM
		                  FROM TBBADDED113M T1
		                       INNER JOIN TBBADDED112D T2
		                       ON (T1.AUD_YR = T2.AUD_YR AND T1.AUD_NO = T2.AUD_NO AND T1.DOC_ID = T2.DOC_ID)
		                       INNER JOIN TBBADDED001M T3
		                       ON (T1.AUD_YR = T3.AUD_YR AND T1.AUD_NO = T3.AUD_NO)
		                       INNER JOIN TBBADDED103M T4
		                       ON (T1.AUD_YR = T4.AUD_YR AND T1.AUD_NO = T4.AUD_NO AND T1.DOC_ID = T4.DOC_ID)
		                       INNER JOIN (
		                                    SELECT 
		                                        ST1.AUD_YR, ST1.AUD_NO, ST1.DOC_ID
		                                        , MIN(DECODE(ST1.RPRT_CD,'A10600200',DECODE(ST2.APVR_PST_CD,'0055600',F_USR_INFO(ST2.APVR_CNB,'2') ,
		                                                                                                  DECODE(ST2.APVR_PST_CD,'0045900',F_USR_INFO(ST2.APVR_CNB,'2') ,'')),'')) AS AUD_RPRT_CHA  /* 0045900 : 본부장 추가 */
		                                        , MIN(DECODE(ST1.RPRT_CD,'A10600200',DECODE(ST2.APVR_PST_CD,'0055700',F_USR_INFO(ST2.APVR_CNB,'2'),''),'')) AS AUD_RPRT_CHONG
		                                        , MIN(DECODE(ST1.RPRT_CD,'A10600200',DECODE(ST2.APVR_PST_CD,'0055600',TO_CHAR(ST2.APV_DH,'YYYY"-"MM"-"DD" "HH24:MI') ,
		                                                                                                          DECODE(ST2.APVR_PST_CD,'0045900',TO_CHAR(ST2.APV_DH,'YYYY"-"MM"-"DD" "HH24:MI') ,'')),'')) AS AUD_RPRT_CHA_DH  /* 0045900 : 본부장 추가 */
		                                        , MIN(DECODE(ST1.RPRT_CD,'A10600200',DECODE(ST2.APVR_PST_CD,'0055700',TO_CHAR(ST2.APV_DH,'YYYY"-"MM"-"DD" "HH24:MI'),''),'')) AS AUD_RPRT_CHONG_DH
		                                        , MIN(DECODE(ST1.RPRT_CD,'A10600200',DECODE(ST2.APVR_PST_CD,'0067400',F_USR_INFO(ST2.APVR_CNB,'2'),''),'')) AS AUD_RPRT_ONE
		                                        , MIN(DECODE(ST1.RPRT_CD,'A10600200',DECODE(ST2.APVR_PST_CD,'0067400',TO_CHAR(ST2.APV_DH,'YYYY"-"MM"-"DD" "HH24:MI'),''),'')) AS AUD_RPRT_ONE_DH
		                                      FROM TBBADDED103M ST1 INNER JOIN TBDCMACM023H ST2
		                                           ON (ST1.APV_RQS_ID = ST2.APV_DOC_NO AND ST2.APVR_STA_CD IN ('202','203'))
		                                     WHERE ST1.RPRT_CD = 'A10600200'
		                                     GROUP BY ST1.AUD_YR, ST1.AUD_NO, ST1.DOC_ID
		                                    ) T5
		                       ON (T1.AUD_YR = T5.AUD_YR AND T1.AUD_NO = T5.AUD_NO AND T1.DOC_ID = T5.DOC_ID)
		                       LEFT OUTER JOIN (
		                                    SELECT 
		                                         ST1.AUD_YR, ST1.AUD_NO
		                                        , MIN(DECODE(ST1.RPRT_CD,'A10500200',DECODE(ST2.APVR_PST_CD,'0055600',F_USR_INFO(ST2.APVR_CNB,'2'),
		                                                                                                          DECODE(ST2.APVR_PST_CD,'0045900',F_USR_INFO(ST2.APVR_CNB,'2'),'')),'')) AS RTN_RPRT_CHA   /* 0045900 : 본부장 추가 */
		                                        , MIN(DECODE(ST1.RPRT_CD,'A10500200',DECODE(ST2.APVR_PST_CD,'0055700',F_USR_INFO(ST2.APVR_CNB,'2'),''),'')) AS RTN_RPRT_CHONG
		                                        , MIN(DECODE(ST1.RPRT_CD,'A10500200',DECODE(ST2.APVR_PST_CD,'0067400',F_USR_INFO(ST2.APVR_CNB,'2'),''),'')) AS RTN_RPRT_ONE
		                                      FROM TBBADDED103M ST1 INNER JOIN TBDCMACM023H ST2
		                                           ON (ST1.APV_RQS_ID = ST2.APV_DOC_NO AND ST2.APVR_STA_CD IN ('202','203'))
		                                     WHERE ST1.RPRT_CD = 'A10500200'
		                                     GROUP BY ST1.AUD_YR, ST1.AUD_NO
		                                    ) T6
		                       ON (T1.AUD_YR = T6.AUD_YR AND T1.AUD_NO = T6.AUD_NO)
		                       LEFT OUTER JOIN TBBADDED116L T7
		                       ON (T1.AUD_YR = T7.AUD_YR AND T1.AUD_NO = T7.AUD_NO  AND T7.TASK_DVSN_CD = '9'
                                   AND T1.DOC_ID = T7.DOC_ID
		                           AND T7.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND TASK_DVSN_CD = '9' AND DOC_ID = T7.DOC_ID))
		                 WHERE T1.SBCN_VT_CD IS NOT NULL
		            ]]>
		            <if test='iptAudYr != null and iptAudYr != ""'>
		                AND T1.AUD_YR = #{iptAudYr}
		            </if>
		            <if test="schSpvBrdvCd != null and schSpvBrdvCd != ''">
		                AND (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = T3.MNG_DPT_CD) =
		                #{schSpvBrdvCd}
		            </if>
		            <if test="schDeptCd != null and schDeptCd != ''">
		                AND T3.MNG_DPT_CD = #{schDeptCd}
		            </if>
		            <if test="iptChfMbId != null and iptChfMbId != ''">
		                AND (T7.CHF_CMTR_CNB = #{iptChfMbId}
		                     OR T7.CHF_CMTR1_CNB = #{iptChfMbId}
		                     OR T7.CHF_CMTR2_CNB = #{iptChfMbId}
		                     OR T7.CHF_CMTR3_CNB = #{iptChfMbId}
		                     OR T7.CHF_CMTR4_CNB = #{iptChfMbId}
		                     OR T7.CHF_CMTR5_CNB = #{iptChfMbId})
		            </if>
		            <if test="dspRqCd != null and dspRqCd != ''">
		                AND T1.DSP_RQ_CD = #{dspRqCd}
		            </if>
		            <if test="iptSbcnNbc != null and iptSbcnNbc != ''">
		                AND T1.SBCN_NBC  = #{iptSbcnNbc}
		            </if>
		            <if test="sbcnVtCd != null and sbcnVtCd != ''">
		                AND T1.SBCN_VT_CD   = #{sbcnVtCd}
		            </if>
                    <if test="schAudSbjNm != null and schAudSbjNm != ''">
                        AND T3.AUD_SBJ_NM LIKE '%'||#{schAudSbjNm}||'%'
                   </if>
                   <if test="schAudYrNoKndCd != null and schAudYrNoKndCd != ''">
                        AND T3.AUD_KND_CD   = #{schAudYrNoKndCd}
                   </if>
                   <if test="schAudNo != null and schAudNo != ''">
                        AND T3.AUD_GRN_NO   = #{schAudNo}
                   </if>
                   <if test="schRegiYr != '' or schRegiDsvn != '' or schRegiNo != ''">
                        AND T2.REGI_NO LIKE '%'||#{schRegiYr}||'%'||#{schRegiDsvn}||'%'||#{schRegiNo}||'%'
                   </if>
		            <![CDATA[
		                GROUP BY T2.REGI_NO, T3.MNG_DPT_CD, T1.AUD_YR, T1.AUD_NO, T3.AUD_KND_CD, T3.AUD_SBJ_NM, AUD_RPRT_DVSN_CD, T1.SBCN_DY, SBCN_NBC, T2.RMK_SBJ
		                    , T1.ENF_JA_CPR_DT, T5.AUD_RPRT_CHA, T5.AUD_RPRT_CHONG, T6.RTN_RPRT_CHA, T6.RTN_RPRT_CHONG, T5.AUD_RPRT_ONE,T1.SBCN_PAGE_CNT, T1.DOC_ID, T5.AUD_RPRT_CHONG_DH, T5.AUD_RPRT_CHA_DH,T5.AUD_RPRT_ONE_DH
		                 ORDER BY T1.SBCN_NBC, T1.SBCN_PAGE_CNT
		             )
		    ) 
		     ORDER BY SBCN_NBC, SBCN_PAGE_CNT
		            ]]>
        <include refid="include.pageOrder" />
    </select>
    
    <select id="selectSbcnDfList" parameterType="paramMap"
        resultType="egovMap">
        /* kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.selectSbcnDfList */
        <include refid="include.pageSelct" />
        <![CDATA[
              SELECT AUD_YR, AUD_NO, DOC_ID, APVR_CD, AFF_SNO, DSP_RQ_SNO, REGI_NO, SBCN_DY, SBCN_NBC, SBCN_PAGE_CNT, MNG_DPT_NM, CHF_CMTR_NM, AUD_YR_NO, AUD_SBJ_NM, TITLE_NM, SBCN_VT_TXT, AFF_DSP_CD, DSP_RQ_NM, HD_SBCN_DY, HD_SBCN_NBC, HD_TITLE_NM, HD_DSP_RQ_NM, HD_SBCN_VT_NM, HD_SBCN_VT_TXT
              FROM (
              SELECT T1.AUD_YR
                          ,T1.AUD_NO
                          ,T1.DOC_ID
                          ,T1.APVR_CD
                          ,T1.AFF_SNO
                          ,T1.DSP_RQ_SNO
                          --------------------- 보류사항정리부 시작 ---------------------------------------
                          ,(SELECT S1.REGI_NO FROM TBBADDED112D S1
                             WHERE S1.AUD_YR = T1.AUD_YR
                               AND S1.AUD_NO = T1.AUD_NO
                               AND S1.DOC_ID = T1.DOC_ID) AS REGI_NO    --등재번호
                          ,TO_CHAR(TO_DATE(T1.SBCN_DY),'YYYY"-"MM"-"DD') AS SBCN_DY                                   --부의일자
                          ,T1.SBCN_NBC                                  --부의회수
                          ,T1.SBCN_PAGE_CNT                             --부의면수
                          ,F_DPT_INFO(T2.MNG_DPT_CD,'1') AS MNG_DPT_NM  --국과
                          , (SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO(ST1.CHF_CMTR_CNB, '2')||DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1), 0, '', ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1))) )
                               FROM TBBADDED116L ST1
                              WHERE ST1.AUD_YR = T1.AUD_YR AND ST1.AUD_NO = T1.AUD_NO AND ST1.TASK_DVSN_CD = '9'
                                AND ST1.DOC_ID = T1.DOC_ID
                            	AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND TASK_DVSN_CD = '9' AND DOC_ID = ST1.DOC_ID)) AS CHF_CMTR_NM
                          ,F_MNG_KND_AUDYRNO(T2.AUD_YR, T2.AUD_NO, T2.AUD_KND_CD, '-') AS AUD_YR_NO --분류번호
                          ,T2.AUD_SBJ_NM    --감사명
                          ,T3.TITLE_NM      --사건명
                          ,T1.SBCN_VT_TXT   --의결비고
                          ,F_MNG_KND_AUDYRNO(T2.AUD_YR, T2.AUD_NO, T2.AUD_KND_CD, '-')||'-'||T3.AFF_CD||'-'||T3.AFF_DSP_CD AS AFF_DSP_CD --처분요구코드
                          ,F_CODE_NM('1000002',T1.DSP_RQ_CD ) AS DSP_RQ_NM  --처분요구명
                          --------------------- 재상정 DATA ---------------------------------------
                          ,T4.SBCN_DY                                AS HD_SBCN_DY     --재상정일자
                          ,T4.SBCN_NBC                               AS HD_SBCN_NBC    --재상정회수
                          ,T4.TITLE_NM                               AS HD_TITLE_NM    --재상정건명
                          ,T4.DSP_RQ_NM                              AS HD_DSP_RQ_NM   --재상정처분요구
                          ,T4.SBCN_VT_NM                             AS HD_SBCN_VT_NM  --재상정결과
                          ,T4.SBCN_VT_TXT                            AS HD_SBCN_VT_TXT --비고
                          ,T5.SORT_SNO
                      FROM TBBADDED113M T1 --부의안건정보T1
                          ,TBBADDED001M T2 --감사기본정보T2
                          ,(SELECT Z1.AUD_YR
                                  ,Z1.AUD_NO
                                  ,Z1.DOC_ID
                                  ,Z1.APVR_CD
                                  ,Z1.AFF_SNO
                                  ,Z1.TITLE_NM
                                  ,Z1.AFF_CD
                                  ,Z2.DSP_RQ_SNO
                                  ,Z2.AFF_DSP_CD
                              FROM TBBADDED145M Z1
                                  ,TBBADDED146M Z2
                             WHERE 1=1
                             ]]>
                            <if test='iptAudYr != null and iptAudYr != ""'>
                                AND Z1.AUD_YR      = #{iptAudYr}
                            </if>
                               AND Z1.AUD_YR      = Z2.AUD_YR
                               AND Z1.AUD_NO      = Z2.AUD_NO
                               AND Z1.AUD_STEP_CD = Z2.AUD_STEP_CD
                               AND Z1.DOC_ID      = Z2.DOC_ID
                               AND Z1.APVR_CD     = Z2.APVR_CD
                               AND Z1.AFF_SNO     = Z2.AFF_SNO
                           ) T3 --사건,처분요구T3
                          ,(SELECT Y1.AUD_YR
                                  ,Y1.AUD_NO
                                  ,Y1.DOC_ID
                                  ,Y1.APVR_CD
                                  ,Y1.AFF_SNO
                                  ,Y1.DSP_RQ_SNO
                                  ,TO_CHAR(TO_DATE(Y1.SBCN_DY),'YYYY-MM-DD') AS SBCN_DY
                                  ,Y1.SBCN_NBC
                                  ,Y4.TITLE_NM
                                  ,F_CODE_NM('1000002',Y1.DSP_RQ_CD ) AS DSP_RQ_NM
                                  ,F_CODE_NM('1000772', Y1.SBCN_VT_CD) AS SBCN_VT_NM
                                  ,Y1.SBCN_VT_CD
                                  ,Y1.SBCN_VT_TXT
                                  ,Y5.HD_AUD_STEP_CD 
                                  ,Y5.HD_DOC_ID 
                                  ,Y5.HD_APVR_CD 
                                  ,Y5.HD_AFF_SNO 
                                  ,Y5.HD_DSP_RQ_SNO 
                              FROM TBBADDED113M Y1
                                  ,TBBADDED103M Y2
                                  ,TBBADDED145M Y4
                                  ,TBBADDED146M Y5
                             WHERE 1=1
                             <if test='iptAudYr != null and iptAudYr != ""'>
                                AND Y1.AUD_YR     = #{iptAudYr}
                            </if>
                               AND Y1.DOC_ID            = Y2.DOC_ID
                               AND Y2.AUD_RPRT_DVSN_CD  = '40'   --감사보고서구분코드(10:본안,20:우선,30:별도,40:재부의)
                               AND Y1.AUD_YR            = Y4.AUD_YR
                               AND Y1.AUD_NO            = Y4.AUD_NO
                               AND Y1.DOC_ID            = Y4.DOC_ID
                               AND Y1.APVR_CD           = Y4.APVR_CD
                               AND Y1.AFF_SNO           = Y4.AFF_SNO
                               AND Y1.AUD_YR            = Y5.AUD_YR
                               AND Y1.AUD_NO            = Y5.AUD_NO
                               AND Y1.DOC_ID            = Y5.DOC_ID
                               AND Y1.APVR_CD           = Y5.APVR_CD
                               AND Y1.AFF_SNO           = Y5.AFF_SNO
                               AND Y1.DSP_RQ_SNO        = Y5.DSP_RQ_SNO
                           ) T4 --재부의T4
                           , TBBADDED112M T5
                           , (SELECT AUD_YR, AUD_NO, TASK_DVSN_CD, SRNO, CHF_CMTR_CNB, CHF_CMTR1_CNB, CHF_CMTR2_CNB, CHF_CMTR3_CNB, CHF_CMTR4_CNB, CHF_CMTR5_CNB, DOC_ID 
                              FROM TBBADDED116L
                              WHERE (AUD_YR, AUD_NO, TASK_DVSN_CD, SRNO, DOC_ID) IN (SELECT AUD_YR, AUD_NO, TASK_DVSN_CD, MAX(SRNO), DOC_ID 
                                                                                     FROM TBBADDED116L 
                                                                                     GROUP BY AUD_YR, AUD_NO, TASK_DVSN_CD, DOC_ID)
                              ) T6
                           , TBBADDED112D T7
                     WHERE T1.AUD_YR        = T2.AUD_YR
                       AND T1.AUD_NO        = T2.AUD_NO
                       AND T1.AUD_YR        = T3.AUD_YR
                       AND T1.AUD_NO        = T3.AUD_NO
                       AND T1.DOC_ID        = T3.DOC_ID
                       AND T1.APVR_CD       = T3.APVR_CD
                       AND T1.AFF_SNO       = T3.AFF_SNO
                       AND T1.DSP_RQ_SNO    = T3.DSP_RQ_SNO
                       AND T3.AUD_YR        = T4.AUD_YR(+)
                       AND T3.AUD_NO        = T4.AUD_NO(+)
                       AND T3.DOC_ID        = T4.HD_DOC_ID(+)
                       AND T3.APVR_CD       = T4.HD_APVR_CD(+)
                       AND T3.AFF_SNO       = T4.HD_AFF_SNO(+)
                       AND T3.DSP_RQ_SNO    = T4.HD_DSP_RQ_SNO(+)
                       AND T1.AUD_YR = T6.AUD_YR(+)
                       AND T1.AUD_NO = T6.AUD_NO(+)
                       AND T1.DOC_ID = T6.DOC_ID(+)
                       AND T1.AUD_YR = T5.AUD_YR
                       AND T1.AUD_NO = T5.AUD_NO
                       AND T1.AUD_YR = T7.AUD_YR(+)
                       AND T1.AUD_NO = T7.AUD_NO(+)
                       AND T1.DOC_ID = T7.DOC_ID(+)
                       AND T1.SBCN_VT_CD    = '90'   --의결코드(10:원안가결,20:문안수정,30:종류변경,40:새로추가,50:불문,90:보류)

            <if test='iptAudYr != null and iptAudYr != ""'>
                AND T1.AUD_YR = #{iptAudYr}
            </if>
            <if test="schSpvBrdvCd != null and schSpvBrdvCd != ''">
                AND (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = T2.MNG_DPT_CD) =
                #{schSpvBrdvCd}
            </if>
            <if test="schDeptCd != null and schDeptCd != ''">
                AND T2.MNG_DPT_CD = #{schDeptCd}
            </if>
            <if test="iptChfMbId != null and iptChfMbId != ''">
                AND (T6.CHF_CMTR_CNB = #{iptChfMbId}
                     OR T6.CHF_CMTR1_CNB = #{iptChfMbId}
                     OR T6.CHF_CMTR2_CNB = #{iptChfMbId}
                     OR T6.CHF_CMTR3_CNB = #{iptChfMbId}
                     OR T6.CHF_CMTR4_CNB = #{iptChfMbId}
                     OR T6.CHF_CMTR5_CNB = #{iptChfMbId})
            </if>
            <if test="dspRqCd != null and dspRqCd != ''">
                AND T3.DSP_RQ_CD = #{dspRqCd}
            </if>
            <if test="iptSbcnNbc != null and iptSbcnNbc != ''">
                AND T1.SBCN_NBC  = #{iptSbcnNbc}
            </if>
            <if test="sbcnVtCd != null and sbcnVtCd != ''">
                AND T4.SBCN_VT_CD   = #{sbcnVtCd}
            </if>
            
            <if test="schAudSbjNm != null and schAudSbjNm != ''">
                AND T2.AUD_SBJ_NM LIKE '%'||#{schAudSbjNm}||'%'
           </if>
           <if test="schAudYrNoKndCd != null and schAudYrNoKndCd != ''">
                AND T2.AUD_KND_CD   = #{schAudYrNoKndCd}
           </if>
           <if test="schAudNo != null and schAudNo != ''">
                AND T2.AUD_GRN_NO   = #{schAudNo}
           </if>
           <if test="schRegiYr != '' or schRegiDsvn != '' or schRegiNo != ''">
                AND T7.REGI_NO LIKE '%'||#{schRegiYr}||'%'||#{schRegiDsvn}||'%'||#{schRegiNo}||'%'
           </if>
           
            <![CDATA[
            /*심사, 재심*/
                UNION ALL
                
                SELECT T1.ACP_YR AS AUD_YR
                          ,T1.ACP_SRNO || '' AS AUD_NO
                          ,T1.DOC_ID
                          ,T1.APVR_CD
                          ,T1.AFF_SNO
                          ,T1.DSP_RQ_SNO
                          --------------------- 보류사항정리부 시작 ---------------------------------------
                          ,(SELECT S1.REGI_NO FROM TBBADFRE112D S1
                             WHERE S1.ACP_YR = T1.ACP_YR
                               AND S1.ACP_DVSN_CD = T1.ACP_DVSN_CD
                               AND S1.ACP_SRNO = T1.ACP_SRNO
                               AND S1.DOC_ID = T1.DOC_ID) AS REGI_NO    --등재번호
                          ,TO_CHAR(TO_DATE(T1.SBCN_DY),'YYYY"-"MM"-"DD') AS SBCN_DY                                   --부의일자
                          ,T1.SBCN_NBC                                  --부의회수
                          ,T1.SBCN_PAGE_CNT                             --부의면수
                          ,F_DPT_INFO(T2.DPT_CD,'1') AS MNG_DPT_NM  --국과
                          , (SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO(ST1.CHF_CMTR_CNB, '2')||DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1), 0, '', ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1))) )
                               FROM TBBADDED116L ST1
                              WHERE ST1.AUD_YR = T1.ACP_YR AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO) AND ST1.TASK_DVSN_CD = T1.ACP_DVSN_CD
                                AND ST1.DOC_ID = T1.DOC_ID
                            	AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.ACP_YR AND AUD_NO = TO_CHAR(T1.ACP_SRNO) AND TASK_DVSN_CD = T1.ACP_DVSN_CD AND DOC_ID = ST1.DOC_ID)) AS CHF_CMTR_NM
                          ,T2.ACP_YR || '-' || DECODE(T2.ACP_DVSN_CD, '1', '심사','재심') || '-' || T2.ACP_SRNO AS AUD_YR_NO --분류번호
                          ,DECODE(T2.ACP_DVSN_CD, '1', '심사청구','재심의청구') AS AUD_SBJ_NM    --감사명
                          ,T2.TIT_NM      --사건명
                          ,T1.SBCN_VT_TXT   --의결비고
                          ,CASE WHEN T6.AUD_YR IS NOT NULL THEN F_MNG_KND_AUDYRNO(T6.AUD_YR, T6.AUD_NO, T7.AUD_KND_CD, '-')||'-'||T6.AFF_CD||'-'||T6.AFF_DSP_CD ELSE '' END AS AFF_DSP_CD --처분요구코드
                          ,F_CODE_NM('1000002',T6.DSP_RQ_KND_CD ) AS DSP_RQ_NM  --처분요구명
                          --------------------- 재상정 DATA ---------------------------------------
                          ,TO_CHAR(TO_DATE(T4.SBCN_DY), 'YYYY-MM-DD')                                AS HD_SBCN_DY     --재상정일자
                          ,T4.SBCN_NBC                               AS HD_SBCN_NBC    --재상정회수
                          ,CASE WHEN T4.SBCN_DY IS NOT NULL THEN T2.TIT_NM ELSE '' END AS HD_TITLE_NM    --재상정건명
                          ,CASE WHEN T4.SBCN_DY IS NOT NULL THEN F_CODE_NM('1000002',T6.DSP_RQ_KND_CD ) ELSE '' END AS HD_DSP_RQ_NM   --재상정처분요구
                          ,F_CODE_NM('1000772', T4.SBCN_VT_CD) AS HD_SBCN_VT_NM  --재상정결과
                          ,T4.SBCN_VT_TXT                            AS HD_SBCN_VT_TXT --비고
                          ,T8.SORT_SNO
                      FROM TBBADFRE113M T1 --부의안건정보T1
                      INNER JOIN TBBADFRE012M T2 ON (T2.ACP_YR = T1.ACP_YR AND T2.ACP_DVSN_CD = T1.ACP_DVSN_CD AND T2.ACP_SRNO = T1.ACP_SRNO) --감사기본정보T2
                      LEFT OUTER JOIN TBBADFRE113M T4 ON (T4.ACP_YR = T1.ACP_YR AND T4.ACP_DVSN_CD = T1.ACP_DVSN_CD AND T4.ACP_SRNO = T1.ACP_SRNO AND T4.SBCN_VT_CD <> '90')
                      INNER JOIN TBBADFRE112M T5 ON (T5.ACP_YR = T1.ACP_YR AND T5.ACP_DVSN_CD = T1.ACP_DVSN_CD AND T5.ACP_SRNO = T1.ACP_SRNO)
                      LEFT OUTER JOIN TBBADEAR001M T6 ON (T6.AUD_YR = T2.AUD_YR AND T6.AUD_NO = T2.AUD_NO AND T6.DSP_RQ_SNO = T2.DSP_RQ_SNO)
                      LEFT OUTER JOIN TBBADDED001M T7 ON (T7.AUD_YR = T6.AUD_YR AND T7.AUD_NO = T6.AUD_NO)
                      LEFT OUTER JOIN TBBADFRE112M T8 ON (T8.ACP_YR = T1.ACP_YR AND T8.ACP_DVSN_CD = T1.ACP_DVSN_CD AND T8.ACP_SRNO = T1.ACP_SRNO)
                      LEFT OUTER JOIN TBBADFRE112D T10 ON (T10.ACP_YR = T1.ACP_YR AND T10.ACP_DVSN_CD = T1.ACP_DVSN_CD AND T10.ACP_SRNO = T1.ACP_SRNO AND T10.DOC_ID = T1.DOC_ID)
                      LEFT OUTER JOIN TBBADDED116L T9 ON (T9.AUD_YR = T1.ACP_YR AND T9.AUD_NO = TO_CHAR(T1.ACP_SRNO) AND T9.TASK_DVSN_CD = T1.ACP_DVSN_CD AND T9.DOC_ID = T1.DOC_ID AND T9.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.ACP_YR AND AUD_NO = TO_CHAR(T1.ACP_SRNO) AND TASK_DVSN_CD = T1.ACP_DVSN_CD AND DOC_ID = T1.DOC_ID))
                     WHERE T1.SBCN_VT_CD    = '90'   --의결코드(10:원안가결,20:문안수정,30:종류변경,40:새로추가,50:불문,90:보류)
                    ]]>
                     <if test='iptAudYr != null and iptAudYr != ""'>
                         AND T1.ACP_YR = #{iptAudYr}
                     </if>
                     <if test="schSpvBrdvCd != null and schSpvBrdvCd != ''">
                         AND (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = T2.DPT_CD) = #{schSpvBrdvCd}
                     </if>
                     <if test="schDeptCd != null and schDeptCd != ''">
                         AND T2.DPT_CD = #{schDeptCd}
                     </if>
                     <if test="iptChfMbId != null and iptChfMbId != ''">
                         AND (T9.CHF_CMTR_CNB = #{iptChfMbId}
                         OR T9.CHF_CMTR1_CNB = #{iptChfMbId}
                         OR T9.CHF_CMTR2_CNB = #{iptChfMbId}
                         OR T9.CHF_CMTR3_CNB = #{iptChfMbId}
                         OR T9.CHF_CMTR4_CNB = #{iptChfMbId}
                         OR T9.CHF_CMTR5_CNB = #{iptChfMbId})
                     </if>
                     <if test="dspRqCd != null and dspRqCd != ''">
                         AND T6.DSP_RQ_KND_CD = #{dspRqCd}
                     </if>
                     <if test="iptSbcnNbc != null and iptSbcnNbc != ''">
                         AND T1.SBCN_NBC  = #{iptSbcnNbc}
                     </if>
                     <if test="sbcnVtCd != null and sbcnVtCd != ''">
                         AND T4.SBCN_VT_CD   = #{sbcnVtCd}
                     </if>
                     
                     <if test="schAudSbjNm != null and schAudSbjNm != ''">
                            AND T2.TIT_NM LIKE '%'||#{schAudSbjNm}||'%'
                       </if>
                       <if test="schAudYrNoKndCd != null and schAudYrNoKndCd != ''">
                            AND T2.ACP_DVSN_CD   = #{schAudYrNoKndCd}
                       </if>
                       <if test="schAudNo != null and schAudNo != ''">
                            AND T2.ACP_SRNO   = #{schAudNo}
                       </if>
                       <if test="schRegiYr != '' or schRegiDsvn != '' or schRegiNo != ''">
                            AND T10.REGI_NO LIKE '%'||#{schRegiYr}||'%'||#{schRegiDsvn}||'%'||#{schRegiNo}||'%'
                       </if>
                     <![CDATA[
                     )
                     ORDER BY SBCN_PAGE_CNT, SBCN_DY, AUD_YR, AUD_NO, SORT_SNO
                     ]]>
        <include refid="include.pageOrder" />
    </select>
    
    <select id="selectSbmtAgdList" parameterType="paramMap"
        resultType="egovMap">
        /* kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.selectSbmtAgdList */
        <include refid="include.pageSelct" />
        <![CDATA[
        SELECT  CMT_SQ,SBMT_FIX_DT,REGI_NO,SBMT_DVSN_NM,DSP_RQ_NM,SBMT_REL_PER,TITLE_NM,SBMT_REL_CON,MNG_DPT_NM,CHF_CMTR_NM,ATTEN_CMTR_NM, 
				SBMT_RMK_TXT , AUD_YR, AUD_NO,AUD_STEP_CD,DOC_ID,APVR_CD,AFF_SNO,SBMT_SEQ,MNG_DPT_CD,CHF_CMTR_ID,DFNT_ATTEN_INFO,AGT_ATTEN_INFO,NOT_ATTEN_INFO,ACP_DVSN_CD
         FROM (
				SELECT A.CMT_SQ, A.SBMT_FIX_DT, A.REGI_NO, A.SBMT_DVSN_NM, A.DSP_RQ_NM, A.SBMT_REL_PER, A.TITLE_NM, A.SBMT_REL_CON, A.MNG_DPT_NM,
        	   		   A.CHF_CMTR_NM, A.ATTEN_CMTR_NM, A.SBMT_RMK_TXT, A.AUD_YR, A.AUD_NO, A.AUD_STEP_CD, A.DOC_ID, A.APVR_CD, A.AFF_SNO, A.SBMT_SEQ,
        	  		   A.MNG_DPT_CD, A.CHF_CMTR_ID, A.DFNT_ATTEN_INFO, A.AGT_ATTEN_INFO, A.NOT_ATTEN_INFO, A.ACP_DVSN_CD
          		  FROM (
 
                                 SELECT
                            (SELECT CMT_SQ||'회'
                                  FROM TBBADDED120M
                                 WHERE CMT_DVSN_CD = '20'
                                   AND CMT_DY = T1.SBMT_FIX_DT
                                   AND SBMT_DVSN_NO = T1.SBMT_DVSN_NO) AS CMT_SQ
                            , DECODE(T1.SBMT_FIX_DT,NULL,'미정', TO_CHAR(TO_DATE(T1.SBMT_FIX_DT),'MM"-"DD')||' ('||TO_CHAR(TO_DATE(T1.SBMT_FIX_DT, 'YYYY-MM-DD'),'DY','NLS_DATE_LANGUAGE=korean')||') '||CHR(13)||CHR(10)||T1.SBMT_FIX_DH||'  ') AS SBMT_FIX_DT
                            , DECODE(T1.SBMT_FIX_DT,NULL,'',ROW_NUMBER() OVER (PARTITION BY SUBSTR(T1.SBMT_FIX_DT,0,4) ORDER BY T1.SBMT_FIX_DT ASC, T1.SBMT_SEQ ASC)) AS REGI_NO
                            , T1.SBMT_DVSN_NO||'소위' AS SBMT_DVSN_NM
                            ,(
			                        SELECT F_CODE_NM('1000002',A.DSP_RQ_KND_CD) 
						              FROM TBBADEAR001M A
						             WHERE 1=1
						               AND A.AUD_YR = T5.AUD_YR
						               AND A.AUD_NO = T5.AUD_NO
						               AND A.DSP_RQ_SNO = T5.DSP_RQ_SNO
						               AND A.AUD_YR IS NOT NULL
			                      ) AS DSP_RQ_NM
                            ,  (SELECT NVL(SUM(DECODE(ATTEN_NAME,NULL,0,1)+DECODE(AGT_NAME,NULL,0,1)),0)
                                 FROM TBBADDED114D ST1
                                WHERE ST1.AUD_YR = T1.ACP_YR
                                  AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO)
                                  AND ST1.AUD_STEP_CD = T1.ACP_STEP_CD
                                  AND ST1.DOC_ID = T1.DOC_ID
                                  AND ST1.APVR_CD = T1.APVR_CD
                                  AND ST1.SBMT_SEQ = T1.SBMT_SEQ
                                  AND ST1.SBMT_DTL_DVSN NOT IN ('90')) AS SBMT_REL_PER
                            , T4.TIT_NM AS TITLE_NM
                            , T1.SBMT_REL_CON
                            , F_DPT_INFO(T5.DPT_CD,'4') AS MNG_DPT_NM
                            , (SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO(ST1.CHF_CMTR_CNB, '2')||DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1), 0, '', ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1))) )
                                   FROM TBBADDED116L ST1
                                  WHERE ST1.AUD_YR = T1.ACP_YR AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO) AND ST1.TASK_DVSN_CD = T1.ACP_DVSN_CD
                                    AND ST1.DOC_ID = (SELECT DOC_ID FROM TBBADFRE103M WHERE REF_ID = T1.DOC_ID AND ACP_STEP_CD IN ('D1020','E1020'))
                                	AND ST1.SRNO = (SELECT MAX(SRNO) 
                                	                FROM TBBADDED116L 
                                	                WHERE AUD_YR = T1.ACP_YR 
                                	                AND AUD_NO = TO_CHAR(T1.ACP_SRNO) 
                                	                AND TASK_DVSN_CD = T1.ACP_DVSN_CD
                                	                AND DOC_ID = (SELECT DOC_ID FROM TBBADFRE103M WHERE REF_ID = T1.DOC_ID AND ACP_STEP_CD IN ('D1020','E1020')))
                                	) AS CHF_CMTR_NM
                            , (SELECT AGGR_CONCAT(DECODE(LV,1,DECODE(CMTR1_ID,NULL,'',F_USR_INFO(CMTR1_ID,'2'))
                                                            ,2,DECODE(CMTR2_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR2_ID,'2'))
                                                            ,3,DECODE(CMTR3_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR3_ID,'2'))
                                                            ,4,DECODE(CMTR4_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR4_ID,'2'))
                                                            ,5,DECODE(CMTR5_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR5_ID,'2'))
                                                            ,6,DECODE(CMTR6_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR6_ID,'2')),'') ,'')
                                  FROM TBBADDED120M
                                       ,(SELECT LEVEL AS LV FROM DUAL CONNECT BY LEVEL < 7)
                                 WHERE CMT_DVSN_CD = '20'
                                   AND CMT_DY = T1.SBMT_FIX_DT
                                   AND SBMT_DVSN_NO = T1.SBMT_DVSN_NO) AS ATTEN_CMTR_NM
                            , T1.SBMT_RMK_TXT
                            , T1.ACP_YR AS AUD_YR
                            , TO_CHAR(T1.ACP_SRNO) AS AUD_NO
                            , T1.ACP_STEP_CD AS AUD_STEP_CD
                            , T1.DOC_ID
                            , T1.APVR_CD
                            , T1.AFF_SNO
                            , T1.SBMT_SEQ
                            , T5.DPT_CD AS MNG_DPT_CD
                            ,  T1.ACP_DVSN_CD
                            , (SELECT CHF_CMTR_CNB AS CHF_CMTR_ID
                                   FROM TBBADDED116L ST1
                                  WHERE ST1.AUD_YR = T1.ACP_YR AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO) AND ST1.TASK_DVSN_CD = T1.ACP_DVSN_CD
                                    AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.ACP_YR AND AUD_NO = TO_CHAR(T1.ACP_SRNO) AND TASK_DVSN_CD =T1.ACP_DVSN_CD)) AS CHF_CMTR_ID
                            , (SELECT AGGR_CONCAT(ATTEN_NAME||DECODE(ATTEN_ORG,NULL,'','('||ATTEN_ORG||')'),'<br/>') -- 참석 관계인
                                 FROM TBBADDED114D ST1
                                WHERE ST1.AUD_YR = T1.ACP_YR
                                  AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO)
                                  AND ST1.AUD_STEP_CD = T1.ACP_STEP_CD
                                  AND ST1.DOC_ID = T1.DOC_ID
                                  AND ST1.APVR_CD = T1.APVR_CD
                                  AND ST1.SBMT_SEQ = T1.SBMT_SEQ
                                  AND ST1.ATTEN_CMPT_YN = 'Y'
                                  AND ST1.SBMT_DTL_DVSN = '10') AS DFNT_ATTEN_INFO
                            , (SELECT AGGR_CONCAT(ATTEN_NAME||' 대리인-'||AGT_NAME||DECODE(AGT_ORG,NULL,'','('||AGT_ORG||')'),'<br/>') -- 참석 대리인
                                 FROM TBBADDED114D ST1
                                WHERE ST1.AUD_YR = T1.ACP_YR
                                  AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO)
                                  AND ST1.AUD_STEP_CD = T1.ACP_STEP_CD
                                  AND ST1.DOC_ID = T1.DOC_ID
                                  AND ST1.APVR_CD = T1.APVR_CD
                                  AND ST1.SBMT_SEQ = T1.SBMT_SEQ
                                  AND ST1.AGT_NAME IS NOT NULL
                                  AND ST1.AGT_ATTEN_CMPT_YN = 'Y'
                                  AND ST1.SBMT_DTL_DVSN = '10') AS AGT_ATTEN_INFO
                            , (SELECT AGGR_CONCAT(DECODE(ATTEN_CMPT_YN,'N', ATTEN_NAME||'(관계인'||DECODE(ATTEN_ORG,NULL,'',','||ATTEN_ORG)||')<br/>','')||DECODE(AGT_ATTEN_YN,'N', AGT_ATTEN_CMPT_YN||'(대리인'||DECODE(AGT_ORG,NULL,'',','||AGT_ORG)||')<br/>','')           ,'') -- 불참
                                 FROM TBBADDED114D ST1
                                WHERE ST1.AUD_YR = T1.ACP_YR
                                  AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO)
                                  AND ST1.AUD_STEP_CD = T1.ACP_STEP_CD
                                  AND ST1.DOC_ID = T1.DOC_ID
                                  AND ST1.APVR_CD = T1.APVR_CD
                                  AND ST1.SBMT_SEQ = T1.SBMT_SEQ
                                  AND (ST1.ATTEN_CMPT_YN = 'N' OR ST1.AGT_ATTEN_CMPT_YN = 'N')
                                  AND ST1.SBMT_DTL_DVSN IN ('10')) AS NOT_ATTEN_INFO
                          FROM TBBADFRE114M T1
                               INNER JOIN TBBADFRE112M T4
                               ON (T1.ACP_YR = T4.ACP_YR
                                   AND T1.ACP_SRNO = T4.ACP_SRNO
                                   AND T1.ACP_DVSN_CD = T4.ACP_DVSN_CD)
                               INNER JOIN TBBADFRE012M T5
                               ON (T1.ACP_YR = T5.ACP_YR
                                   AND T1.ACP_SRNO = T5.ACP_SRNO
                                   AND T1.ACP_DVSN_CD = T5.ACP_DVSN_CD)
                         WHERE 1=1
                           AND SBMT_REQ_DT IS NOT NULL --소위안건요청일자
                           ]]>
                           <if test="schAudSbjNm != null and schAudSbjNm != ''">
                                AND T5.TIT_NM LIKE '%'||#{schAudSbjNm}||'%'
                           </if>
                           <if test="schAudYrNoKndCd != null and schAudYrNoKndCd != ''">
                                AND T5.ACP_DVSN_CD   = #{schAudYrNoKndCd}
                           </if>
                           <if test="schAudNo != null and schAudNo != ''">
                                AND T5.ACP_SRNO   = #{schAudNo}
                           </if>
                           <![CDATA[
                           GROUP BY T5.AUD_YR,T5.AUD_NO,T5.DSP_RQ_SNO,T1.SBMT_FIX_DT, T4.CHF_CMTR_ID, T1.SBMT_DVSN_CD, T1.SBMT_REL_PER, T4.TIT_NM, T1.SBMT_REL_CON, T1.SBMT_DVSN_NO
                            , T5.DPT_CD, T1.SBMT_RMK_TXT, T1.ACP_YR, T1.ACP_SRNO, T1.ACP_STEP_CD, T1.DOC_ID, T1.APVR_CD, T1.AFF_SNO, T1.SBMT_SEQ, T1.SBMT_FIX_DH, T1.ACP_DVSN_CD
                         ORDER BY T1.SBMT_FIX_DT ASC, T1.SBMT_SEQ ASC 
                ) A
                         LEFT OUTER JOIN TBBADDED116L T7
                        ON (A.AUD_YR = T7.AUD_YR AND A.AUD_NO = T7.AUD_NO  AND T7.TASK_DVSN_CD = A.ACP_DVSN_CD
                           AND T7.DOC_ID = (SELECT DOC_ID FROM TBBADFRE103M WHERE REF_ID = A.DOC_ID AND ACP_STEP_CD IN ('D1020','E1020'))
                           AND T7.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = A.AUD_YR AND AUD_NO = A.AUD_NO AND TASK_DVSN_CD = A.ACP_DVSN_CD))
                 WHERE 1=1
                    AND A.SBMT_FIX_DT IS NOT NULL
                    
            ]]>
            <if test='iptAudYr != null and iptAudYr != ""'>
                AND A.AUD_YR = #{iptAudYr}
            </if>
            <if test="schSpvBrdvCd != null and schSpvBrdvCd != ''">
                AND (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.MNG_DPT_CD) =
                #{schSpvBrdvCd}
            </if>
            <if test="schDeptCd != null and schDeptCd != ''">
                AND A.MNG_DPT_CD = #{schDeptCd}
            </if>
            <if test="iptChfMbId != null and iptChfMbId != ''">
                AND (T7.CHF_CMTR_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR1_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR2_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR3_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR4_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR5_CNB = #{iptChfMbId})
            </if>
            <![CDATA[
     UNION ALL
        

              SELECT A.CMT_SQ, A.SBMT_FIX_DT, A.REGI_NO, A.SBMT_DVSN_NM, A.DSP_RQ_NM, A.SBMT_REL_PER, A.TITLE_NM, A.SBMT_REL_CON, A.MNG_DPT_NM,
        	  		 A.CHF_CMTR_NM, A.ATTEN_CMTR_NM, A.SBMT_RMK_TXT, A.AUD_YR, A.AUD_NO, A.AUD_STEP_CD, A.DOC_ID, A.APVR_CD, A.AFF_SNO, A.SBMT_SEQ,
        		     A.MNG_DPT_CD, A.CHF_CMTR_ID, A.DFNT_ATTEN_INFO, A.AGT_ATTEN_INFO, A.NOT_ATTEN_INFO, A.ACP_DVSN_CD
                FROM (
                        SELECT
                            (SELECT CMT_SQ||'회'
                                  FROM TBBADDED120M
                                 WHERE CMT_DVSN_CD = '20'
                                   AND CMT_DY = T1.SBMT_FIX_DT
                                   AND SBMT_DVSN_NO = T1.SBMT_DVSN_NO) AS CMT_SQ
                            , DECODE(T1.SBMT_FIX_DT,NULL,'미정', TO_CHAR(TO_DATE(T1.SBMT_FIX_DT),'MM"-"DD')||' ('||TO_CHAR(TO_DATE(T1.SBMT_FIX_DT, 'YYYY-MM-DD'),'DY','NLS_DATE_LANGUAGE=korean')||') '||CHR(13)||CHR(10)||T1.SBMT_FIX_DH||'  ') AS SBMT_FIX_DT
                            , DECODE(T1.SBMT_FIX_DT,NULL,'',ROW_NUMBER() OVER (PARTITION BY SUBSTR(T1.SBMT_FIX_DT,0,4) ORDER BY T1.SBMT_FIX_DT ASC, T1.SBMT_SEQ ASC)) AS REGI_NO
                            , T1.SBMT_DVSN_NO||'소위' AS SBMT_DVSN_NM
                            --, F_CODE_NM('1000787', T1.SBMT_DVSN_CD) AS SBMT_DVSN_CD
                            , AGGR_CONCAT(T3.DSP_RQ_NM||DECODE(T3.DSP_RQ_CNT,1,'',T3.DSP_RQ_CNT), ',')  AS DSP_RQ_NM
                            ,  (SELECT NVL(SUM(DECODE(ATTEN_NAME,NULL,0,1)+DECODE(AGT_NAME,NULL,0,1)),0)
                                 FROM TBBADDED114D ST1
                                WHERE ST1.AUD_YR = T1.AUD_YR
                                  AND ST1.AUD_NO = T1.AUD_NO
                                  AND ST1.AUD_STEP_CD = T1.AUD_STEP_CD
                                  AND ST1.DOC_ID = T1.DOC_ID
                                  AND ST1.APVR_CD = T1.APVR_CD
                                  AND ST1.AFF_SNO = T1.AFF_SNO
                                  AND ST1.SBMT_SEQ = T1.SBMT_SEQ
                                  AND ST1.SBMT_DTL_DVSN NOT IN ('90')) AS SBMT_REL_PER
                            , T2.TITLE_NM
                            , T1.SBMT_REL_CON
                            , F_DPT_INFO(T5.MNG_DPT_CD,'4') AS MNG_DPT_NM
                            , (SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO(ST1.CHF_CMTR_CNB, '2')||DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1), 0, '', ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1))) )
                                   FROM TBBADDED116L ST1
                                  WHERE ST1.AUD_YR = T1.AUD_YR AND ST1.AUD_NO = T1.AUD_NO AND ST1.TASK_DVSN_CD = '9'
                                    AND ST1.DOC_ID = T1.DOC_ID
                                	AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND TASK_DVSN_CD = '9' AND DOC_ID = ST1.DOC_ID)) AS CHF_CMTR_NM
                            , (SELECT AGGR_CONCAT(DECODE(LV,1,DECODE(CMTR1_ID,NULL,'',F_USR_INFO(CMTR1_ID,'2'))
                                                            ,2,DECODE(CMTR2_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR2_ID,'2'))
                                                            ,3,DECODE(CMTR3_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR3_ID,'2'))
                                                            ,4,DECODE(CMTR4_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR4_ID,'2'))
                                                            ,5,DECODE(CMTR5_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR5_ID,'2'))
                                                            ,6,DECODE(CMTR6_ID,NULL,'',','||CHR(13)||CHR(10)||F_USR_INFO(CMTR6_ID,'2')),'') ,'')
                                  FROM TBBADDED120M
                                       ,(SELECT LEVEL AS LV FROM DUAL CONNECT BY LEVEL < 7)
                                 WHERE CMT_DVSN_CD = '20'
                                   AND CMT_DY = T1.SBMT_FIX_DT
                                   AND SBMT_DVSN_NO = T1.SBMT_DVSN_NO) AS ATTEN_CMTR_NM
                            , T1.SBMT_RMK_TXT
                            , T1.AUD_YR
                            , T1.AUD_NO
                            , T1.AUD_STEP_CD
                            , T1.DOC_ID
                            , T1.APVR_CD
                            , T1.AFF_SNO
                            , T1.SBMT_SEQ
                            , T5.MNG_DPT_CD
                            , '9' AS ACP_DVSN_CD
                            , (SELECT CHF_CMTR_CNB AS CHF_CMTR_ID
                                   FROM TBBADDED116L ST1
                                  WHERE ST1.AUD_YR = T1.AUD_YR AND ST1.AUD_NO = T1.AUD_NO AND ST1.TASK_DVSN_CD = '9'
                                    AND ST1.DOC_ID = T1.DOC_ID
                                    AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND TASK_DVSN_CD = '9' AND DOC_ID = ST1.DOC_ID)) AS CHF_CMTR_ID
                            , (SELECT AGGR_CONCAT(ATTEN_NAME||DECODE(ATTEN_ORG,NULL,'','('||ATTEN_ORG||')'),'<br/>') -- 참석 관계인
                                 FROM TBBADDED114D ST1
                                WHERE ST1.AUD_YR = T1.AUD_YR
                                  AND ST1.AUD_NO = T1.AUD_NO
                                  AND ST1.AUD_STEP_CD = T1.AUD_STEP_CD
                                  AND ST1.DOC_ID = T1.DOC_ID
                                  AND ST1.APVR_CD = T1.APVR_CD
                                  AND ST1.AFF_SNO = T1.AFF_SNO
                                  AND ST1.SBMT_SEQ = T1.SBMT_SEQ
                                  AND ST1.ATTEN_CMPT_YN = 'Y'
                                  AND ST1.SBMT_DTL_DVSN = '10') AS DFNT_ATTEN_INFO
                            , (SELECT AGGR_CONCAT(ATTEN_NAME||' 대리인-'||AGT_NAME||DECODE(AGT_ORG,NULL,'','('||AGT_ORG||')'),'<br/>') -- 참석 대리인
                                 FROM TBBADDED114D ST1
                                WHERE ST1.AUD_YR = T1.AUD_YR
                                  AND ST1.AUD_NO = T1.AUD_NO
                                  AND ST1.AUD_STEP_CD = T1.AUD_STEP_CD
                                  AND ST1.DOC_ID = T1.DOC_ID
                                  AND ST1.APVR_CD = T1.APVR_CD
                                  AND ST1.AFF_SNO = T1.AFF_SNO
                                  AND ST1.SBMT_SEQ = T1.SBMT_SEQ
                                  AND ST1.AGT_NAME IS NOT NULL
                                  AND ST1.AGT_ATTEN_CMPT_YN = 'Y'
                                  AND ST1.SBMT_DTL_DVSN = '10') AS AGT_ATTEN_INFO
                            , (SELECT AGGR_CONCAT(DECODE(ATTEN_CMPT_YN,'N', ATTEN_NAME||'(관계인'||DECODE(ATTEN_ORG,NULL,'',','||ATTEN_ORG)||')<br/>','')||DECODE(AGT_ATTEN_YN,'N', AGT_ATTEN_CMPT_YN||'(대리인'||DECODE(AGT_ORG,NULL,'',','||AGT_ORG)||')<br/>','')           ,'') -- 불참
                                 FROM TBBADDED114D ST1
                                WHERE ST1.AUD_YR = T1.AUD_YR
                                  AND ST1.AUD_NO = T1.AUD_NO
                                  AND ST1.AUD_STEP_CD = T1.AUD_STEP_CD
                                  AND ST1.DOC_ID = T1.DOC_ID
                                  AND ST1.APVR_CD = T1.APVR_CD
                                  AND ST1.AFF_SNO = T1.AFF_SNO
                                  AND ST1.SBMT_SEQ = T1.SBMT_SEQ
                                  AND (ST1.ATTEN_CMPT_YN = 'N' OR ST1.AGT_ATTEN_CMPT_YN = 'N')
                                  AND ST1.SBMT_DTL_DVSN IN ('10')) AS NOT_ATTEN_INFO
                          FROM TBBADDED114M T1
                               INNER JOIN TBBADDED145M T2
                               ON (T1.AUD_YR = T2.AUD_YR
                                   AND T1.AUD_NO = T2.AUD_NO
                                   AND T1.AUD_STEP_CD = T2.AUD_STEP_CD
                                   AND T1.DOC_ID = T2.DOC_ID
                                   AND T1.APVR_CD = T2.APVR_CD
                                   AND T1.AFF_SNO = T2.AFF_SNO)
                               INNER JOIN (  SELECT 
                                            ST1.AUD_YR
                                           , ST1.AUD_NO
                                           , ST1.AUD_STEP_CD
                                           , ST1.DOC_ID
                                           , ST1.APVR_CD
                                           , ST1.AFF_SNO
                                           , ST1.SBMT_SEQ
                                           , F_CODE_NM('1000002', ST2.DSP_RQ_CD) AS DSP_RQ_NM
                                           , COUNT(ST2.DSP_RQ_CD) AS DSP_RQ_CNT
                                         FROM TBBADDED114D ST1
                                              INNER JOIN TBBADDED146M ST2
                                              ON (ST1.AUD_YR = ST2.AUD_YR
                                                  AND ST1.AUD_NO = ST2.AUD_NO
                                                  AND ST1.AUD_STEP_CD = ST2.AUD_STEP_CD
                                                  AND ST1.DOC_ID = ST2.DOC_ID
                                                  AND ST1.APVR_CD = ST2.APVR_CD
                                                  AND ST1.AFF_SNO = ST2.AFF_SNO
                                                  AND ST1.DSP_RQ_SNO = ST2.DSP_RQ_SNO)
                                        GROUP BY ST1.AUD_YR, ST1.AUD_NO, ST1.AUD_STEP_CD, ST1.DOC_ID, ST1.APVR_CD
                                                , ST1.AFF_SNO, ST1.SBMT_SEQ, ST2.DSP_RQ_CD) T3
                               ON (T1.AUD_YR = T3.AUD_YR
                                   AND T1.AUD_NO = T3.AUD_NO
                                   AND T1.AUD_STEP_CD = T3.AUD_STEP_CD
                                   AND T1.DOC_ID = T3.DOC_ID
                                   AND T1.APVR_CD = T3.APVR_CD
                                   AND T1.AFF_SNO = T3.AFF_SNO)
                               INNER JOIN TBBADDED112M T4
                               ON (T1.AUD_YR = T4.AUD_YR
                                   AND T1.AUD_NO = T4.AUD_NO)
                               INNER JOIN TBBADDED001M T5
                               ON (T1.AUD_YR = T5.AUD_YR
                                   AND T1.AUD_NO = T5.AUD_NO)
                         WHERE 1=1
                            ]]>
                           <if test="schAudSbjNm != null and schAudSbjNm != ''">
                                AND T5.AUD_SBJ_NM LIKE '%'||#{schAudSbjNm}||'%'
                           </if>
                           <if test="schAudYrNoKndCd != null and schAudYrNoKndCd != ''">
                                AND T5.AUD_KND_CD   = #{schAudYrNoKndCd}
                           </if>
                           <if test="schAudNo != null and schAudNo != ''">
                                AND T5.AUD_GRN_NO   = #{schAudNo}
                           </if>
                           <![CDATA[
                           AND SBMT_REQ_DT IS NOT NULL
                           GROUP BY T1.SBMT_FIX_DT, T4.CHF_CMTR_ID, T1.SBMT_DVSN_CD, T1.SBMT_REL_PER, T2.TITLE_NM, T1.SBMT_REL_CON, T1.SBMT_DVSN_NO
                            , T5.MNG_DPT_CD, T1.SBMT_RMK_TXT, T1.AUD_YR, T1.AUD_NO, T1.AUD_STEP_CD, T1.DOC_ID, T1.APVR_CD, T1.AFF_SNO, T1.SBMT_SEQ, T1.SBMT_FIX_DH
                         ORDER BY T1.SBMT_FIX_DT ASC, T1.SBMT_SEQ ASC 
                   )A
                         LEFT OUTER JOIN TBBADDED116L T7
                        ON (A.AUD_YR = T7.AUD_YR AND A.AUD_NO = T7.AUD_NO  AND T7.TASK_DVSN_CD = '9'
                           AND T7.DOC_ID = A.DOC_ID
                           AND T7.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = A.AUD_YR AND AUD_NO = A.AUD_NO AND TASK_DVSN_CD = '9' AND DOC_ID = T7.DOC_ID))
                 WHERE 1=1
                    AND A.SBMT_FIX_DT IS NOT NULL
            ]]>
            <if test='iptAudYr != null and iptAudYr != ""'>
                AND A.AUD_YR = #{iptAudYr}
            </if>
            <if test="schSpvBrdvCd != null and schSpvBrdvCd != ''">
                AND (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.MNG_DPT_CD) =
                #{schSpvBrdvCd}
            </if>
            <if test="schDeptCd != null and schDeptCd != ''">
                AND A.MNG_DPT_CD = #{schDeptCd}
            </if>
            <if test="iptChfMbId != null and iptChfMbId != ''">
                AND (T7.CHF_CMTR_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR1_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR2_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR3_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR4_CNB = #{iptChfMbId}
                     OR T7.CHF_CMTR5_CNB = #{iptChfMbId})
            </if>
            <![CDATA[
            )
                ORDER BY SBMT_FIX_DT, REGI_NO
            ]]>
        <include refid="include.pageOrder" />
    </select>
    
    <update id="saveSbmtRmkTxt" parameterType="paramMap">
    /*kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.saveSbmtRmkTxt*/
        UPDATE TBBADDED114M
               SET SBMT_RMK_TXT = #{sbmtRmkTxt},
                      FNL_USR_ID = #{usrId},
                      FNL_DEAL_DPT_CD = #{dptCd},
                      FNL_MNU_ID = #{menuNo},
                      FNL_MDF_DH = SYSDATE
          WHERE AUD_YR = #{audYr}
               AND AUD_NO = #{audNo}
               AND AUD_STEP_CD = #{audStepCd}
               AND DOC_ID = #{docId}
               AND APVR_CD = #{apvrCd}
               AND AFF_SNO = #{affSno}
               AND SBMT_SEQ = #{sbmtSeq}
    </update>
    <update id="saveBADFRESbmtRmkTxt" parameterType="paramMap">
    /*kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.saveBADFRESbmtRmkTxt*/
        UPDATE TBBADFRE114M
               SET SBMT_RMK_TXT = #{sbmtRmkTxt},
                      FNL_USR_ID = #{usrId},
                      FNL_DEAL_DPT_CD = #{dptCd},
                      FNL_MNU_ID = #{menuNo},
                      FNL_MDF_DH = SYSDATE
          WHERE ACP_YR = #{audYr}
               AND ACP_SRNO = #{audNo}
               AND ACP_STEP_CD = #{audStepCd}
               AND ACP_DVSN_CD = #{acpDvsnCd}
               AND DOC_ID = #{docId}
               AND APVR_CD = #{apvrCd}
               AND SBMT_SEQ = #{sbmtSeq}
    </update>
    <update id="saveEnfJaCprDt" parameterType="paramMap">
    /*kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.saveEnfJaCprDt*/
        UPDATE TBBADDED113M
               SET ENF_JA_CPR_DT = REPLACE(#{enfJaCprDt},'-'),
                      FNL_USR_ID = #{usrId},
                      FNL_DEAL_DPT_CD = #{dptCd},
                      FNL_MNU_ID = #{menuNo},
                      FNL_MDF_DH = SYSDATE
          WHERE AUD_YR = #{audYr}
               AND AUD_NO = #{audNo}
               AND DOC_ID = #{docId}
               AND SBCN_DY = REPLACE(#{sbcnDy},'-')
    </update>
    
    <update id="saveBADFREEnfJaCprDt" parameterType="paramMap">
    /*kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.saveBADFREEnfJaCprDt*/
        UPDATE TBBADFRE113M
               SET ENF_JA_CPR_DT = REPLACE(#{enfJaCprDt},'-'),
                      FNL_USR_ID = #{usrId},
                      FNL_DEAL_DPT_CD = #{dptCd},
                      FNL_MNU_ID = #{menuNo},
                      FNL_MDF_DH = SYSDATE
          WHERE ACP_YR = #{audYr}
               AND ACP_SRNO = #{audNo}
			   AND ACP_DVSN_CD = #{acpDvsnCd}
               AND DOC_ID = #{docId}
               AND SBCN_DY = REPLACE(#{sbcnDy},'-')
    </update>
    <update id="saveSbcnNo" parameterType="paramMap">
    /*kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.saveSbcnNo*/
        UPDATE TBBADDED113M
               SET SBCN_NO = #{sbcnNo},
                      FNL_USR_ID = #{usrId},
                      FNL_DEAL_DPT_CD = #{dptCd},
                      FNL_MNU_ID = #{menuNo},
                      FNL_MDF_DH = SYSDATE
          WHERE AUD_YR = #{audYr}
               AND AUD_NO = #{audNo}
               AND DOC_ID = #{docId}
               AND APVR_CD = #{apvrCd}
               AND AFF_SNO = #{affSno}
               AND DSP_RQ_SNO = #{dspRqSno}
               AND SBCN_REGI_REQ_DT = #{sbcnRegiReqDt}
    </update>
    <update id="saveFreSbcnNo" parameterType="paramMap">
    /*kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.saveFreSbcnNo*/
        UPDATE TBBADFRE113M
               SET SBCN_NO = #{sbcnNo},
                      FNL_USR_ID = #{usrId},
                      FNL_DEAL_DPT_CD = #{dptCd},
                      FNL_MNU_ID = #{menuNo},
                      FNL_MDF_DH = SYSDATE
          WHERE ACP_YR = #{audYr}
               AND ACP_DVSN_CD = #{acpDvsnCd}
               AND ACP_SRNO = #{audNo}
               AND DOC_ID = #{docId}
               AND APVR_CD = #{apvrCd}
               AND AFF_SNO = #{affSno}
               AND DSP_RQ_SNO = #{dspRqSno}
               AND SBCN_REGI_REQ_DT = #{sbcnRegiReqDt}
    </update>
        <update id="saveSbcnDfList" parameterType="paramMap">
    /*kr.go.bai.eip.aep.asb.dao.AEPASB014QMapper.saveSbcnDfList*/
        UPDATE TBBADDED113M
               SET RE_SBCN_DY = REPLACE(#{reSbcnDy},'-'),
                      RE_SBCN_CMT_SQ = #{reSbcnCmtSq},
                      RE_SBCN_TITLE_NM = #{reSbcnTitleNm},
                      RE_SBCN_TXT = #{reSbcnTxt},
                      FNL_USR_ID = #{usrId},
                      FNL_DEAL_DPT_CD = #{dptCd},
                      FNL_MNU_ID = #{menuNo},
                      FNL_MDF_DH = SYSDATE
          WHERE AUD_YR = #{audYr}
               AND AUD_NO = #{audNo}
               AND DOC_ID = #{docId}
               AND APVR_CD = #{apvrCd}
               AND AFF_SNO = #{affSno}
               AND DSP_RQ_SNO = #{dspRqSno}
               AND SBCN_REGI_REQ_DT = REPLACE(#{sbcnRegiReqDt},'-')
               
    </update>
    
    
</mapper> 
