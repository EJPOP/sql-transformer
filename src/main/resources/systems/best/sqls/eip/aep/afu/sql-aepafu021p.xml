<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.afu.dao.AEPAFU021PMapper">

	<select id="selectRestoreRsn" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.aep.afu.dao.AEPAFU021PMapper.selectRestoreRsn*/
		SELECT A.AUD_YR
		     , A.AUD_NO
		     , A.RESTORE_RSN
		  FROM TBBADDED001M A
		 WHERE A.AUD_YR = #{audYr}
		   AND A.AUD_NO = #{audNo} 
    </select>
    
    <update id="updateRestoreRsn" parameterType="paramMap">
    /*kr.go.bai.eip.aep.afu.dao.AEPAFU021PMapper.updateRestoreRsn*/
       UPDATE TBBADDED001M
          SET RESTORE_RSN = #{restoreRsn}
        WHERE AUD_YR = #{audYr}
          AND AUD_NO = #{audNo} 
    </update>
    
    
    <insert id="insertSendMessage" parameterType="paramMap">
    /*kr.go.bai.eip.aep.afu.dao.AEPAFU021PMapper.insertSendMessage*/
            INSERT INTO
            TBDCMACM026L
            (
              MSG_SNO
            , TSK_CAT_CD
            , FUNC_CAT_CD
            , SEND_ID
            , MSG_TP_YN   
            , MSG_TXT_2
            , RCNT_CNT
            , RCNT_HIS
            , MSG_REGI_DH   
            , FRT_USR_ID
            , FNL_USR_ID
            , FNL_DEAL_DPT_CD
            , FNL_MNU_ID
            , FRT_REGI_DH
            , FNL_MDF_DH  
            )
            (
            SELECT
              (SELECT NVL(MAX(MSG_SNO),'0') AS MSG_SNO FROM TBDCMACM026L) + ROWNUM
            , 'CM'
            , 'CM'
            , 'SYSTEM'
            , '0'
            ,#{restoreRsn}
            , 1
            , F_USR_INFO_BY_ID(FRT_USR_ID,'1')
            , SYSDATE 
            , #{usrId}
            , #{usrId}
            , #{dptCd}
            , #{mnuId}
            , SYSDATE
            , SYSDATE
            FROM TBBADDED001M
            WHERE AUD_YR = #{audYr}
              AND AUD_NO = #{audNo}
            )
    </insert>
</mapper> 