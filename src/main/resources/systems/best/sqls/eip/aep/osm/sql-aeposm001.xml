<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper">
    
    <select id="selectMainList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectMainList*/
        <include refid="include.pageSelct" />
            <![CDATA[
            SELECT TO_CHAR(TO_DATE(T.CMT_DT, 'YYYYMMDD' ), 'YYYY"년"MM"월"DD"일"(DY)')AS CMT_NM
                  ,T.CMT_DT
                  ,TO_CHAR(TO_DATE(T.CMT_DT,'YYYYMMDD'),'YYYY-MM-DD') AS CMT_DY
                  ,T.TOTAL_TIME
                  ,T.TIME_DVSN_CD
                  ,T.CMT_TIME
                  ,T.CMT_MIN
                  ,T.CMT_TIT
                  ,SUM(T.TOTAL_CNT) AS TOTAL_CNT
                  ,T.CMT_DVSN_CD
                  ,T.CMT_DVSN_NM
                  ,T.CMT_END_YN_NM
                  ,T.OSM_TYPE
                  ,T.RTN
                  ,T.CMT_END_YN
                  ,T.CMT_SQ AS CMT_SQ
                  ,DECODE(T.CMT_SQ, NULL, '', '제'||T.CMT_SQ||'회 ' ||T.CMT_TIT) AS CMT_TIT_NM
                  ,DECODE(T.CMT_SQ, NULL, '', '제'||T.CMT_SQ||'회') AS CMT_SQ_NM
                  ,DECODE(T.CMT_SQ, NULL, 'NEW', 'UPT') AS CMT_TYPE
                  ,T.CHF_CMTR_ID AS TOP_USR_ID
                  ,F_USR_INFO(T.CHF_CMTR_ID, '2') AS TOP_USR
                  ,T.CMTR1_ID    AS SUB_USR1_ID
                  ,F_USR_INFO(T.CMTR1_ID, '2')   AS SUB_USR1
                  ,T.CMTR2_ID    AS SUB_USR2_ID
                  ,F_USR_INFO(T.CMTR2_ID, '2')   AS SUB_USR2
                  ,T.CMTR3_ID    AS SUB_USR3_ID
                 ,F_USR_INFO(T.CMTR3_ID, '2')   AS SUB_USR3
                 ,T.CMTR4_ID    AS SUB_USR4_ID
                 ,F_USR_INFO(T.CMTR4_ID, '2')   AS SUB_USR4
                 ,T.CMTR5_ID    AS SUB_USR5_ID
                 ,F_USR_INFO(T.CMTR5_ID, '2')   AS SUB_USR5
                 ,T.CMTR6_ID    AS SUB_USR6_ID
                 ,F_USR_INFO(T.CMTR6_ID, '2')   AS SUB_USR6
                 ,T.CMT_STR_TXT
                 ,T.CMT_END_TXT
                 , T.SBMT_DVSN_NO
          FROM
        (   
         /*************** 부의(시스템) ****************/
          SELECT A.SBCN_DY AS CMT_DT
                   ,CASE B.TIME_DVSN_CD WHEN 'AM' THEN '오전'
                                        WHEN 'PM' THEN '오후'
                                        ELSE '' END || DECODE(B.CMT_TIME,NULL,'',B.CMT_TIME||'시') || DECODE(B.CMT_MIN,NULL,'',B.CMT_MIN||'분') AS TOTAL_TIME
                   ,B.CMT_TIT AS CMT_TIT
                   ,COUNT(DISTINCT A.AUD_YR||A.AUD_NO) + COUNT(DISTINCT C.CMT_DY||C.CMT_DVSN_CD||C.CMT_SQ||C.CMT_SBJ_DVSN_CD||C.CMT_SBJ_SNO) AS TOTAL_CNT
                   ,NVL(B.CMT_DVSN_CD, '10') AS CMT_DVSN_CD
                   ,F_CODE_NM('1000789', NVL(B.CMT_DVSN_CD, '10')) AS CMT_DVSN_NM
                   ,DECODE(B.CMT_END_YN, NULL, '미등록',  '회의등록'||'('||TO_CHAR(B.FRT_REGI_DH,'YYYY-MM-DD')||')') AS CMT_END_YN_NM
                   ,DECODE(B.CMT_END_YN, NULL, '', 'N', '진행중', '종료'||'('||TO_CHAR(B.CMT_END_DH,'YYYY-MM-DD')||')') AS OSM_TYPE
                   ,DECODE(B.CMT_END_YN, NULL, '', 'N', '결과입력', '입력완료') AS RTN
                   ,A.SBCN_DY
                   ,B.CMT_DY
                   ,B.CMT_SQ
                   ,B.TIME_DVSN_CD
                   ,B.CMT_TIME
                   ,B.CMT_MIN
                   ,B.CMT_STR_TXT
                   ,B.CMT_END_TXT
                   ,B.CMT_END_YN
                   ,B.CHF_CMTR_ID
                   ,B.CMTR1_ID
                   ,B.CMTR2_ID
                   ,B.CMTR3_ID
                   ,B.CMTR4_ID
                   ,B.CMTR5_ID
                   ,B.CMTR6_ID 
                   ,'' AS SBMT_DVSN_NO
              FROM TBBADDED113M A LEFT OUTER JOIN TBBADDED120M B 
                ON A.SBCN_DY =  B.CMT_DY   
               AND B.CMT_DVSN_CD = '10'    
               LEFT OUTER JOIN TBBADDED121M AS C ON B.CMT_DY = C.CMT_DY
                                                    AND B.CMT_DVSN_CD = C.CMT_DVSN_CD
                                                    AND B.CMT_SQ = C.CMT_SQ 
             WHERE A.SBCN_DY BETWEEN REPLACE(#{schStrDt},'-') AND REPLACE(#{schEndDt},'-')
            GROUP BY A.SBCN_DY, B.CMT_DY, B.CMT_DVSN_CD, B.CMT_SQ, B.TIME_DVSN_CD, B.CMT_TIME, B.CMT_MIN,
                     B.CMT_TIT, B.CMT_STR_TXT, B.CMT_END_TXT, B.CMT_END_YN, TO_CHAR(B.FNL_MDF_DH,'YYYY-MM-DD'),B.CMT_END_DH,
                     B.CHF_CMTR_ID, B.CMTR1_ID, B.CMTR2_ID, B.CMTR3_ID, B.CMTR4_ID, B.CMTR5_ID, B.CMTR6_ID, B.FRT_REGI_DH
              UNION ALL
              /*************** 부의(수기입력) ****************/
                SELECT B.CMT_DY AS CMT_DT
                   ,CASE B.TIME_DVSN_CD WHEN 'AM' THEN '오전'
                                        WHEN 'PM' THEN '오후'
                                        ELSE '' END || DECODE(B.CMT_TIME,NULL,'',B.CMT_TIME||'시') || DECODE(B.CMT_MIN,NULL,'',B.CMT_MIN||'분') AS TOTAL_TIME
                   ,B.CMT_TIT AS CMT_TIT
                   ,COUNT(DISTINCT C.CMT_DY||C.CMT_DVSN_CD||C.CMT_SQ||C.CMT_SBJ_DVSN_CD||C.CMT_SBJ_SNO) AS TOTAL_CNT
                   ,B.CMT_DVSN_CD
                   ,F_CODE_NM('1000789',B.CMT_DVSN_CD) AS CMT_DVSN_NM
                   ,DECODE(B.CMT_END_YN, NULL, '미등록',  '회의등록'||'('||TO_CHAR(B.FRT_REGI_DH,'YYYY-MM-DD')||')') AS CMT_END_YN_NM
                   ,DECODE(B.CMT_END_YN, NULL, '', 'N', '진행중', '종료'||'('||TO_CHAR(B.CMT_END_DH,'YYYY-MM-DD')||')') AS OSM_TYPE
                   ,DECODE(B.CMT_END_YN, NULL, '', 'N', '결과입력', '입력완료') AS RTN
                   ,'' AS SBCN_DY
                   ,B.CMT_DY
                   ,B.CMT_SQ
                   ,B.TIME_DVSN_CD
                   ,B.CMT_TIME
                   ,B.CMT_MIN
                   ,B.CMT_STR_TXT
                   ,B.CMT_END_TXT
                   ,B.CMT_END_YN
                   ,B.CHF_CMTR_ID
                   ,B.CMTR1_ID
                   ,B.CMTR2_ID
                   ,B.CMTR3_ID
                   ,B.CMTR4_ID
                   ,B.CMTR5_ID
                   ,B.CMTR6_ID 
                   ,'' AS SBMT_DVSN_NO
              FROM TBBADDED120M B 
               LEFT OUTER JOIN TBBADDED121M AS C ON B.CMT_DY = C.CMT_DY
                                                    AND B.CMT_DVSN_CD = C.CMT_DVSN_CD
                                                    AND B.CMT_SQ = C.CMT_SQ 
             WHERE B.CMT_DY BETWEEN REPLACE(#{schStrDt},'-') AND REPLACE(#{schEndDt},'-')
                AND (B.CMT_DVSN_CD IN  ('30', '10') AND NOT EXISTS (SELECT 1 FROM TBBADDED113M D  WHERE D.SBCN_DY =  B.CMT_DY  ))
            GROUP BY B.CMT_DY, B.CMT_DVSN_CD, B.CMT_SQ, B.TIME_DVSN_CD, B.CMT_TIME, B.CMT_MIN,B.CMT_END_DH,
                     B.CMT_TIT, B.CMT_STR_TXT, B.CMT_END_TXT, B.CMT_END_YN, TO_CHAR(B.FNL_MDF_DH,'YYYY-MM-DD'),
                     B.CHF_CMTR_ID, B.CMTR1_ID, B.CMTR2_ID, B.CMTR3_ID, B.CMTR4_ID, B.CMTR5_ID, B.CMTR6_ID, B.FRT_REGI_DH
            UNION ALL
            /*************** 부의(시스템-심사,재심) ****************/
            SELECT A.SBCN_DY AS CMT_DT
                   ,CASE B.TIME_DVSN_CD WHEN 'AM' THEN '오전'
                                        WHEN 'PM' THEN '오후'
                                        ELSE '' END || DECODE(B.CMT_TIME,NULL,'',B.CMT_TIME||'시') || DECODE(B.CMT_MIN,NULL,'',B.CMT_MIN||'분') AS TOTAL_TIME
                   ,B.CMT_TIT AS CMT_TIT
                   ,COUNT(DISTINCT NVL(C.MG_ACP_YR, C.ACP_YR)||NVL(C.MG_ACP_SRNO, C.ACP_DVSN_CD)||NVL(C.MG_ACP_SRNO,C.ACP_SRNO)) AS TOTAL_CNT
                   ,NVL(B.CMT_DVSN_CD, '10') AS CMT_DVSN_CD
                   ,F_CODE_NM('1000789', NVL(B.CMT_DVSN_CD, '10')) AS CMT_DVSN_NM
                   ,DECODE(B.CMT_END_YN, NULL, '미등록',  '회의등록'||'('||TO_CHAR(B.FRT_REGI_DH,'YYYY-MM-DD')||')') AS CMT_END_YN_NM
                   ,DECODE(B.CMT_END_YN, NULL, '', 'N', '진행중', '종료'||'('||TO_CHAR(B.CMT_END_DH,'YYYY-MM-DD')||')') AS OSM_TYPE
                   ,DECODE(B.CMT_END_YN, NULL, '', 'N', '결과입력', '입력완료') AS RTN
                   ,A.SBCN_DY
                   ,B.CMT_DY
                   ,B.CMT_SQ
                   ,B.TIME_DVSN_CD
                   ,B.CMT_TIME
                   ,B.CMT_MIN
                   ,B.CMT_STR_TXT
                   ,B.CMT_END_TXT
                   ,B.CMT_END_YN
                   ,B.CHF_CMTR_ID
                   ,B.CMTR1_ID
                   ,B.CMTR2_ID
                   ,B.CMTR3_ID
                   ,B.CMTR4_ID
                   ,B.CMTR5_ID
                   ,B.CMTR6_ID 
                   ,'' AS SBMT_DVSN_NO
              FROM TBBADFRE113M A 
              LEFT OUTER JOIN TBBADDED120M B ON A.SBCN_DY =  B.CMT_DY   
                                            AND B.CMT_DVSN_CD = '10'
              INNER JOIN TBBADFRE012M C ON C.ACP_YR = A.ACP_YR AND C.ACP_DVSN_CD = A.ACP_DVSN_CD AND C.ACP_SRNO = A.ACP_SRNO
             WHERE A.SBCN_DY BETWEEN REPLACE(#{schStrDt},'-') AND REPLACE(#{schEndDt},'-')
            GROUP BY A.SBCN_DY, B.CMT_DY, B.CMT_DVSN_CD, B.CMT_SQ, B.TIME_DVSN_CD, B.CMT_TIME, B.CMT_MIN,
                                   B.CMT_TIT, B.CMT_STR_TXT, B.CMT_END_TXT, B.CMT_END_YN, TO_CHAR(B.FNL_MDF_DH,'YYYY-MM-DD'),B.CMT_END_DH,
                                   B.CHF_CMTR_ID, B.CMTR1_ID, B.CMTR2_ID, B.CMTR3_ID, B.CMTR4_ID, B.CMTR5_ID, B.CMTR6_ID, B.FRT_REGI_DH
            UNION ALL
            /*************** 소위원회(실지감사) ****************/
            SELECT CMT_DT
                   , CASE NVL(TIME_DVSN_CD, DECODE(MIN(SBMT_FIX_DH), NULL, '', CASE WHEN SUBSTR(MIN(SBMT_FIX_DH),0,2) >= '12' THEN 'PM' ELSE 'AM' END)) 
                        WHEN 'AM' THEN '오전' 
                        WHEN 'PM' THEN '오후' 
                        ELSE '' 
                     END 
                     || DECODE(CMT_TIME, NULL, DECODE(MIN(SBMT_FIX_DH), NULL, '', CASE WHEN SUBSTR(MIN(SBMT_FIX_DH),0,2) >'12' THEN LPAD(TO_CHAR(TO_NUMBER(SUBSTR(MIN(SBMT_FIX_DH),0,2)) - 12),2,'0')  ELSE LPAD(SUBSTR(MIN(SBMT_FIX_DH),0,2),2,'0') END||'시'),CMT_TIME||'시') 
                     || DECODE(CMT_MIN, NULL, DECODE(MIN(SBMT_FIX_DH), NULL, '', SUBSTR(MIN(SBMT_FIX_DH),4,2)||'분') ,CMT_MIN||'분') AS TOTAL_TIME
                   , CMT_TIT, SUM(TOTAL_CNT) AS TOTAL_CNT, CMT_DVSN_CD, CMT_DVSN_NM, CMT_END_YN_NM, OSM_TYPE, RTN, SBMT_FIX_DT, CMT_DY, CMT_SQ
				   , NVL(TIME_DVSN_CD, DECODE(MIN(SBMT_FIX_DH), NULL, '', CASE WHEN SUBSTR(MIN(SBMT_FIX_DH),0,2) >= '12' THEN 'PM' ELSE 'AM' END)) AS TIME_DVSN_CD
                   , NVL(CMT_TIME, DECODE(MIN(SBMT_FIX_DH), NULL, '', CASE WHEN SUBSTR(MIN(SBMT_FIX_DH),0,2) >'12' THEN LPAD(TO_CHAR(TO_NUMBER(SUBSTR(MIN(SBMT_FIX_DH),0,2)) - 12),2,'0')  ELSE LPAD(SUBSTR(MIN(SBMT_FIX_DH),0,2),2,'0') END)) AS CMT_TIME
                   , NVL(CMT_MIN, DECODE(MIN(SBMT_FIX_DH), NULL, '', SUBSTR(MIN(SBMT_FIX_DH),4,2))) AS CMT_MIN
                   , CMT_STR_TXT, CMT_END_TXT, CMT_END_YN, CHF_CMTR_ID, CMTR1_ID, CMTR2_ID, CMTR3_ID, CMTR4_ID, CMTR5_ID, CMTR6_ID,SBMT_DVSN_NO
              FROM (
	            SELECT A.SBMT_FIX_DT AS CMT_DT
	               ,B.CMT_TIT AS CMT_TIT
	               ,COUNT(DISTINCT A.AUD_YR||A.AUD_NO||A.AFF_SNO||A.SBMT_DVSN_NO) + COUNT(DISTINCT C.CMT_DY||C.CMT_DVSN_CD||C.CMT_SQ||C.CMT_SBJ_DVSN_CD||C.CMT_SBJ_SNO) AS TOTAL_CNT
	               ,NVL(B.CMT_DVSN_CD, '20') AS CMT_DVSN_CD
	               ,F_CODE_NM('1000789', NVL(B.CMT_DVSN_CD, '20')) AS CMT_DVSN_NM
	               ,DECODE(B.CMT_END_YN, NULL, '미등록',  '회의등록'||'('||TO_CHAR(B.FRT_REGI_DH,'YYYY-MM-DD')||')') AS CMT_END_YN_NM
	               ,DECODE(B.CMT_END_YN, NULL, '', 'N', '진행중', '종료'||'('||TO_CHAR(B.CMT_END_DH,'YYYY-MM-DD')||')') AS OSM_TYPE
	               ,DECODE(B.CMT_END_YN, NULL, '', 'N', '회의종료', '') AS RTN
	               ,A.SBMT_FIX_DT
	               ,B.CMT_DY
	               ,B.CMT_SQ
	               ,B.TIME_DVSN_CD
	               ,B.CMT_TIME
	               ,B.CMT_MIN
	               ,B.CMT_STR_TXT
	               ,B.CMT_END_TXT
	               ,B.CMT_END_YN
	               ,B.CHF_CMTR_ID
	               ,B.CMTR1_ID
	               ,B.CMTR2_ID
	               ,B.CMTR3_ID
	               ,B.CMTR4_ID
	               ,B.CMTR5_ID
	               ,B.CMTR6_ID 
	               ,A.SBMT_DVSN_NO
                   ,MIN(A.SBMT_FIX_DH) AS SBMT_FIX_DH
	          FROM TBBADDED114M A LEFT OUTER JOIN TBBADDED120M B 
	            ON (A.SBMT_FIX_DT =  B.CMT_DY
	                  AND A.SBMT_DVSN_NO = B.SBMT_DVSN_NO)
	           AND B.CMT_DVSN_CD = '20'
	           LEFT OUTER JOIN TBBADDED121M AS C ON B.CMT_DY = C.CMT_DY
	                                                AND B.CMT_DVSN_CD = C.CMT_DVSN_CD
	                                                AND B.CMT_SQ = C.CMT_SQ 
	         WHERE A.SBMT_FIX_DT BETWEEN REPLACE(#{schStrDt},'-') AND REPLACE(#{schEndDt},'-')
	           AND A.SBMT_STA_CD > '20'
             GROUP BY A.AUD_YR,  A.SBMT_FIX_DT, B.CMT_DY, B.CMT_DVSN_CD, B.CMT_SQ, B.TIME_DVSN_CD, B.CMT_TIME, B.CMT_MIN,B.CMT_END_DH,
	                               B.CMT_TIT, B.CMT_STR_TXT, B.CMT_END_TXT, B.CMT_END_YN, TO_CHAR(B.FNL_MDF_DH,'YYYY-MM-DD'),
	                               B.CHF_CMTR_ID, B.CMTR1_ID, B.CMTR2_ID, B.CMTR3_ID, B.CMTR4_ID, B.CMTR5_ID, B.CMTR6_ID, A.SBMT_DVSN_NO, B.FRT_REGI_DH
             UNION
            /*************** 소위원회(수기입력) ****************/
                SELECT B.CMT_DY AS CMT_DT
                   ,B.CMT_TIT AS CMT_TIT
                   ,COUNT(DISTINCT C.CMT_DY||C.CMT_DVSN_CD||C.CMT_SQ||C.CMT_SBJ_DVSN_CD||C.CMT_SBJ_SNO) AS TOTAL_CNT
                   ,B.CMT_DVSN_CD
                   ,F_CODE_NM('1000789',B.CMT_DVSN_CD) AS CMT_DVSN_NM
                   ,DECODE(B.CMT_END_YN, NULL, '미등록',  '회의등록'||'('||TO_CHAR(B.FRT_REGI_DH,'YYYY-MM-DD')||')') AS CMT_END_YN_NM
	               ,DECODE(B.CMT_END_YN, NULL, '', 'N', '진행중', '종료'||'('||TO_CHAR(B.CMT_END_DH,'YYYY-MM-DD')||')') AS OSM_TYPE
	               ,DECODE(B.CMT_END_YN, NULL, '', 'N', '회의종료', '') AS RTN
                   ,B.CMT_DY AS SBMT_FIX_DT
                   ,B.CMT_DY
                   ,B.CMT_SQ
                   ,B.TIME_DVSN_CD
                   ,B.CMT_TIME
                   ,B.CMT_MIN
                   ,B.CMT_STR_TXT
                   ,B.CMT_END_TXT
                   ,B.CMT_END_YN
                   ,B.CHF_CMTR_ID
                   ,B.CMTR1_ID
                   ,B.CMTR2_ID
                   ,B.CMTR3_ID
                   ,B.CMTR4_ID
                   ,B.CMTR5_ID
                   ,B.CMTR6_ID 
                   ,B.SBMT_DVSN_NO
                   ,'' AS SBMT_FIX_DH
              FROM TBBADDED120M B 
               LEFT OUTER JOIN TBBADDED121M AS C ON B.CMT_DY = C.CMT_DY
                                                    AND B.CMT_DVSN_CD = C.CMT_DVSN_CD
                                                    AND B.CMT_SQ = C.CMT_SQ 
             WHERE B.CMT_DY BETWEEN REPLACE(#{schStrDt},'-') AND REPLACE(#{schEndDt},'-')
                AND (B.CMT_DVSN_CD = '20' 
                         AND NOT EXISTS (SELECT 1 FROM TBBADDED114M D  WHERE D.SBMT_FIX_DT =  B.CMT_DY AND D.SBMT_DVSN_NO = B.SBMT_DVSN_NO
                                                     UNION ALL 
                                                     SELECT 1 FROM TBBADFRE114M D  WHERE D.SBMT_FIX_DT =  B.CMT_DY AND D.SBMT_DVSN_NO = B.SBMT_DVSN_NO)
                        )
            GROUP BY B.CMT_DY, B.CMT_DVSN_CD, B.CMT_SQ, B.TIME_DVSN_CD, B.CMT_TIME, B.CMT_MIN,B.CMT_END_DH,
                     B.CMT_TIT, B.CMT_STR_TXT, B.CMT_END_TXT, B.CMT_END_YN, TO_CHAR(B.FNL_MDF_DH,'YYYY-MM-DD'),
                     B.CHF_CMTR_ID, B.CMTR1_ID, B.CMTR2_ID, B.CMTR3_ID, B.CMTR4_ID, B.CMTR5_ID, B.CMTR6_ID, B.FRT_REGI_DH, B.SBMT_DVSN_NO
              UNION ALL
              /*************** 소위원회(심사/재심의) ****************/
	             SELECT A.SBMT_FIX_DT AS CMT_DT
	               ,B.CMT_TIT AS CMT_TIT
	               ,COUNT(DISTINCT A.ACP_YR||A.ACP_SRNO||A.SBMT_DVSN_NO) + COUNT(DISTINCT C.CMT_DY||C.CMT_DVSN_CD||C.CMT_SQ||C.CMT_SBJ_DVSN_CD||C.CMT_SBJ_SNO) AS TOTAL_CNT
	               ,NVL(B.CMT_DVSN_CD, '20') AS CMT_DVSN_CD
	               ,F_CODE_NM('1000789', NVL(B.CMT_DVSN_CD, '20')) AS CMT_DVSN_NM
	               ,DECODE(B.CMT_END_YN, NULL, '미등록',  '회의등록'||'('||TO_CHAR(B.FRT_REGI_DH,'YYYY-MM-DD')||')') AS CMT_END_YN_NM
	               ,DECODE(B.CMT_END_YN, NULL, '', 'N', '진행중', '종료'||'('||TO_CHAR(B.CMT_END_DH,'YYYY-MM-DD')||')') AS OSM_TYPE
	               ,DECODE(B.CMT_END_YN, NULL, '', 'N', '회의종료', '') AS RTN
	               ,A.SBMT_FIX_DT
	               ,B.CMT_DY
	               ,B.CMT_SQ
	               ,B.TIME_DVSN_CD
	               ,B.CMT_TIME
	               ,B.CMT_MIN
	               ,B.CMT_STR_TXT
	               ,B.CMT_END_TXT
	               ,B.CMT_END_YN
	               ,B.CHF_CMTR_ID
	               ,B.CMTR1_ID
	               ,B.CMTR2_ID
	               ,B.CMTR3_ID
	               ,B.CMTR4_ID
	               ,B.CMTR5_ID
	               ,B.CMTR6_ID 
	               ,A.SBMT_DVSN_NO
                   ,MIN(A.SBMT_FIX_DH) AS SBMT_FIX_DH
	          FROM TBBADFRE114M A LEFT OUTER JOIN TBBADDED120M B 
	            ON (A.SBMT_FIX_DT =  B.CMT_DY
	                  AND A.SBMT_DVSN_NO = B.SBMT_DVSN_NO)
	           AND B.CMT_DVSN_CD = '20'
	           LEFT OUTER JOIN TBBADDED121M AS C ON B.CMT_DY = C.CMT_DY
	                                                AND B.CMT_DVSN_CD = C.CMT_DVSN_CD
	                                                AND B.CMT_SQ = C.CMT_SQ 
	         WHERE A.SBMT_FIX_DT BETWEEN REPLACE(#{schStrDt},'-') AND REPLACE(#{schEndDt},'-')
	           AND A.SBMT_STA_CD > '20'
	         GROUP BY A.SBMT_FIX_DT, B.CMT_DY, B.CMT_DVSN_CD, B.CMT_SQ, B.TIME_DVSN_CD, B.CMT_TIME, B.CMT_MIN,
	                               B.CMT_TIT, B.CMT_STR_TXT, B.CMT_END_TXT, B.CMT_END_YN, TO_CHAR(B.FNL_MDF_DH,'YYYY-MM-DD'),B.CMT_END_DH,
	                               B.CHF_CMTR_ID, B.CMTR1_ID, B.CMTR2_ID, B.CMTR3_ID, B.CMTR4_ID, B.CMTR5_ID, B.CMTR6_ID, A.SBMT_DVSN_NO, B.FRT_REGI_DH
			)  GROUP BY CMT_DT, CMT_TIT, CMT_DVSN_CD, CMT_DVSN_NM, CMT_END_YN_NM, OSM_TYPE, RTN, SBMT_FIX_DT, CMT_DY, CMT_SQ, TIME_DVSN_CD, CMT_TIME, CMT_MIN, CMT_STR_TXT,
						CMT_END_TXT, CMT_END_YN, CHF_CMTR_ID, CMTR1_ID, CMTR2_ID, CMTR3_ID,  CMTR4_ID, CMTR5_ID, CMTR6_ID, SBMT_DVSN_NO
        ) T
        WHERE 1=1 
        ]]>
            <if test="schCmtTit != null and schCmtTit != ''">
                AND T.CMT_TIT LIKE '%'||#{schCmtTit}||'%'
            </if>
            <if test="schCmtDvsnCd != null and schCmtDvsnCd != ''">
                AND T.CMT_DVSN_CD = #{schCmtDvsnCd}
            </if>
            <if test="schCmtRegYn != null and schCmtRegYn != ''">
                AND DECODE(T.CMT_END_YN,NULL,'N','Y') = #{schCmtRegYn}
             </if>
       <![CDATA[         
       GROUP BY T.CMT_DT,T.TOTAL_TIME,T.TIME_DVSN_CD,T.CMT_TIME,T.CMT_MIN,T.CMT_TIT,T.CMT_DVSN_CD,T.CMT_DVSN_NM,T.CMT_END_YN_NM
                  ,T.OSM_TYPE,T.RTN,T.CMT_END_YN,T.CMT_SQ,T.CHF_CMTR_ID,T.CMTR1_ID,T.CMTR2_ID,T.CMTR3_ID,T.CMTR4_ID,T.CMTR5_ID,T.CMTR6_ID,T.CMT_STR_TXT,T.CMT_END_TXT
                 , T.SBMT_DVSN_NO 
        ORDER BY  CMT_DT DESC, CMT_SQ DESC, TOTAL_TIME  NULLS FIRST
        ]]>
         <include refid="include.pageOrder" />
    </select>

    <select id="userList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.userList*/
        <choose>
            <when test="sbmtDvsnNo != null and sbmtDvsnNo != ''">
            SELECT  
                'SUB' AS TMP_TYPE,
               F_USR_INFO(CMTR_CNB,'2') AS USR_INFO,
               CMTR_CNB AS CNB
              FROM TBDCMACM001M T1
                  LEFT OUTER JOIN TBBADDED116M T2
                   ON (T1.CNB = T2.CMTR_CNB)
             WHERE T1.DPT_CD = '510000'
               AND T1.PST_CD = '0010600'
               AND  SBMT_DVSN_NO = #{sbmtDvsnNo}
             ORDER BY T1.RAL_BLT_DIV_CD 
            </when>
            <otherwise>
                SELECT 'TOP' AS TMP_TYPE,
                       USR_NAM AS USR_INFO,
                       USR_ID,
                       RAL_BLT_DIV_CD,
                       RANK_CD,
                       CNB
                  FROM TBDCMACM001M
                 WHERE DPT_CD = '500000' 
                   AND BAI_USR_YN ='Y'
                   AND RANK_CD = '004'
                   AND WOK_DVSN_CD = 'AAA'
                   AND ROWNUM = 1
                 UNION ALL
                SELECT 'SUB' AS TMP_TYPE,
                       USR_NAM AS USR_INFO,
                       USR_ID,
                       RAL_BLT_DIV_CD,
                       RANK_CD,
                       CNB
                  FROM TBDCMACM001M
                 WHERE RAL_BLT_DIV_CD LIKE '5105%'
                   AND RANK_CD = '007'
                   AND WOK_DVSN_CD = 'AAA'
                   <if test="subUsr1Id != null and subUsr1Id != ''">
                   AND CNB IN (#{subUsr1Id}, #{subUsr2Id}, #{subUsr3Id}, #{subUsr4Id}, #{subUsr5Id}, #{subUsr6Id})
                   </if>
                ORDER BY RAL_BLT_DIV_CD, RANK_CD
            </otherwise>
        </choose>
    </select>

    <select id="selectNewSeq" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectNewSeq*/
        <![CDATA[
        SELECT NVL(MAX(CMT_SQ)+1,'1') AS SEQ
          FROM TBBADDED120M
         WHERE CMT_DVSN_CD = #{cmtDvsnCd}
         ]]>
         <if test="cmtDy != null and cmtDy != ''">
              AND SUBSTR(CMT_DY,1,4) = SUBSTR(#{cmtDy}, 1, 4)
         </if>
         <if test="cmtDy == null or cmtDy == ''">
              AND SUBSTR(CMT_DY,1,4) = SUBSTR(TO_CHAR(SYSDATE,'YYYY"-"MM"-"DD'), 1, 4)
         </if>
    </select>
    
    <select id="selectNextCmtYn" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectNextCmtYn*/
        <![CDATA[
        SELECT 
            DECODE(COUNT(1),0,'N','Y') AS NEXT_CMT_EXIST_YN
            , AGGR_CONCAT(T1.CMT_SQ,', ' ORDER BY T1.CMT_SQ) AS NEXT_CMT_SQ
          FROM TBBADDED120M T1
         WHERE T1.CMT_DVSN_CD = '20'
           AND T1.CMT_DY > REPLACE(#{cmtDy},'-')
         ]]>
    </select>
    
    <select id="selectSbmtAgdList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectSbmtAgdList*/
        <include refid="include.pageSelct" />
            <![CDATA[
                SELECT
                    F_DPT_INFO(T5.MNG_DPT_CD,'1') AS MNG_DPT_NM
                    , T5.AUD_SBJ_NM
                    , F_MNG_KND_AUDYRNO(T1.AUD_YR, T1.AUD_NO, T1.AUD_KND_CD, '-')||'-'||T1.AFF_CD AS AFF_CD_NM
                    , T1.TITLE_NM
                    , AGGR_CONCAT(T3.DSP_RQ_NM||DECODE(T3.DSP_RQ_CNT,1,'',T3.DSP_RQ_CNT), ',')  AS DSP_RQ_NM
                    , (SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO(ST1.CHF_CMTR_CNB, '2')||DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1), 0, '', ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1))) )
                           FROM TBBADDED116L ST1
                          WHERE ST1.AUD_YR = T1.AUD_YR AND ST1.AUD_NO = T1.AUD_NO AND ST1.TASK_DVSN_CD = '9' AND ST1.DOC_ID = T1.DOC_ID
                            AND ST1.SRNO = (SELECT MAX(SRNO) FROM TBBADDED116L WHERE AUD_YR = T1.AUD_YR AND AUD_NO = T1.AUD_NO AND TASK_DVSN_CD = '9' AND DOC_ID = ST1.DOC_ID)) AS CHF_CMTR_NM
                    , T1.SBMT_DVSN_NO||'소위' AS SBMT_DVSN_NM
                    , T1.SBMT_DVSN_NO AS SBMT_DVSN_NO
                    , NVL(TO_CHAR(TO_DATE(T1.SBMT_PLAN_DT),'YYYY"-"MM"-"DD'),'미정') AS SBMT_PLAN_DT
                    , T1.SBMT_REL_CON
                    , (SELECT NVL(SUM(DECODE(ATTEN_NAME,NULL,0,1)+DECODE(AGT_NAME,NULL,0,1)),0)
                         FROM TBBADDED114D ST1
                        WHERE ST1.AUD_YR = T1.AUD_YR
                          AND ST1.AUD_NO = T1.AUD_NO
                          AND ST1.AUD_STEP_CD = T1.AUD_STEP_CD
                          AND ST1.DOC_ID = T1.DOC_ID
                          AND ST1.APVR_CD = T1.APVR_CD
                          AND ST1.AFF_SNO = T1.AFF_SNO
                          AND ST1.SBMT_SEQ = T1.SBMT_SEQ
                          AND ST1.SBMT_DTL_DVSN NOT IN ('90')) AS SBMT_REL_PER
                    , NVL(TO_CHAR(T1.SBMT_REQ_DT,'YYYY"-"MM"-"DD'),'미요청') AS SBMT_REQ_DT
                    , T1.SBMT_NO
                    , TO_CHAR(TO_DATE(T1.SBMT_FIX_DT),'YYYY"-"MM"-"DD') AS SBMT_FIX_DT
                    , F_CODE_NM('1000808', T1.SBMT_STA_CD) AS SBMT_STA_NM
                    , T1.AUD_YR 
                    , T1.AUD_NO 
                    , T1.AUD_STEP_CD 
                    , T1.DOC_ID 
                    , T1.APVR_CD 
                    , T1.AFF_SNO 
                    , T1.SBMT_SEQ 
                    , T1.AUD_MAIN_STEP_SNO
                    , CASE WHEN T1.SBMT_STA_CD < '30' THEN 'N' ELSE 'Y' END AS SBMT_FIX_YN
                    , T1.SBMT_STA_CD
                    , T6.DOC_ID AS SBMT_RPRT_DOC_ID
                    , T5.AUD_KND_CD
                    , '90' AS ACP_DVSN_CD
                    
                    , T6.RPRT_NM AS SBMT_RPRT_DOC_NM    -- 소위원회 심의안 요약문 보고서명
                    , T7.DOC_ID AS SBMT_RPRT_RPT_DOC_ID -- 소위원회 심의안 요약문(보고자용) DOC_ID
                    , T7.RPRT_NM AS SBMT_RPRT_RPT_DOC_NM    -- 소위원회 심의안 요약문(보고자용) 보고서명
                    
                    , T1.DOC_ID AS RL_DOC_ID
                    , '' AS SBMT_DOC_ID
                    , 'N' AS ADD_YN
                    , NULL AS CMT_DY
                     , NULL AS CMT_DVSN_CD
                     , NULL AS CMT_SQ
                     , NULL AS CMT_SBJ_DVSN_CD
                     , NULL AS CMT_SBJ_SNO
                     , NVL(T7.EDT_AUTH,'Y') AS EDT_AUTH
                     , (SELECT DECODE(COUNT(1),0,'N','Y')
                               FROM TBBADDED111M ST1 
                              WHERE ST1.DOC_ID = T8.DOC_ID) AS SBCN_RPRT_SEND_YN
                     , T1.SBCN_PRSS_DPT_NM
                     , F_CODE_NM('1000894', T5.DOC_WRIT_KND_CD)  AS DOC_TYPE
                     , T1.RPRT_FILD_ID
                     , (SELECT NVL(COUNT(1),0)
                        FROM TBCSPKDE106M B
                        WHERE B.RPRT_FILD_ID = T1.RPRT_FILD_ID) AS SBCN_CAM_CNT
                     , (SELECT NVL(COUNT(1),0)
                        FROM TBBADDED126M A
                        WHERE A.RPRT_FILD_ID = T1.RPRT_FILD_ID
                        AND A.WRK_DVSN_CD = 'A10'
                        AND A.REQ_STAT_CD = '60') AS SBCN_LAW_CNT
                  FROM TBBADDED114M T1
                       INNER JOIN TBBADDED145M T2
                       ON (T1.AUD_YR = T2.AUD_YR
                           AND T1.AUD_NO = T2.AUD_NO
                           AND T1.AUD_STEP_CD = T2.AUD_STEP_CD
                           AND T1.DOC_ID = T2.DOC_ID
                           AND T1.APVR_CD = T2.APVR_CD
                           AND T1.AFF_SNO = T2.AFF_SNO)
                       INNER JOIN ( SELECT 
                                            ST1.AUD_YR
                                           , ST1.AUD_NO
                                           , ST1.AUD_STEP_CD
                                           , ST1.DOC_ID
                                           , ST1.APVR_CD
                                           , ST1.AFF_SNO
                                           , ST1.SBMT_SEQ
                                           , F_CODE_NM('1000002', ST2.DSP_RQ_CD) AS DSP_RQ_NM
                                           , COUNT(ST2.DSP_RQ_CD) AS DSP_RQ_CNT
                                         FROM TBBADDED114D ST1
                                              INNER JOIN TBBADDED146M ST2
                                              ON (ST1.AUD_YR = ST2.AUD_YR
                                                  AND ST1.AUD_NO = ST2.AUD_NO
                                                  AND ST1.AUD_STEP_CD = ST2.AUD_STEP_CD
                                                  AND ST1.DOC_ID = ST2.DOC_ID
                                                  AND ST1.APVR_CD = ST2.APVR_CD
                                                  AND ST1.AFF_SNO = ST2.AFF_SNO
                                                  AND ST1.DSP_RQ_SNO = ST2.DSP_RQ_SNO)
                                        GROUP BY ST1.AUD_YR, ST1.AUD_NO, ST1.AUD_STEP_CD, ST1.DOC_ID, ST1.APVR_CD
                                                , ST1.AFF_SNO, ST1.SBMT_SEQ, ST2.DSP_RQ_CD
                                ) T3
                       ON (T1.AUD_YR = T3.AUD_YR
                           AND T1.AUD_NO = T3.AUD_NO
                           AND T1.AUD_STEP_CD = T3.AUD_STEP_CD
                           AND T1.DOC_ID = T3.DOC_ID
                           AND T1.APVR_CD = T3.APVR_CD
                           AND T1.AFF_SNO = T3.AFF_SNO
                           AND T1.SBMT_SEQ = T3.SBMT_SEQ)
                       INNER JOIN TBBADDED112M T4
                       ON (T1.AUD_YR = T4.AUD_YR
                           AND T1.AUD_NO = T4.AUD_NO)
                       INNER JOIN TBBADDED001M T5
                       ON (T1.AUD_YR = T5.AUD_YR
                           AND T1.AUD_NO = T5.AUD_NO)
                       LEFT OUTER JOIN TBBADDED103M T6
                       ON (T6.RPRT_CD = 'A10700230' -- 소위원회 심의안 요약문(원장용)
                          AND T6.AUD_YR = T1.AUD_YR
                          AND T6.AUD_NO = T1.AUD_NO
                          AND T6.REF_DY = T1.SBMT_SEQ
                          AND T6.REF_ID = TO_CHAR(T1.AFF_SNO))
                      LEFT OUTER JOIN TBBADDED103M T7
                       ON (T7.RPRT_CD = 'A10700220' -- 소위원회 심의안 요약문(보고자용)
                          AND T7.AUD_YR = T1.AUD_YR
                          AND T7.AUD_NO = T1.AUD_NO
                          AND T7.REF_DY = T1.SBMT_SEQ
                          AND T7.REF_ID = TO_CHAR(T1.AFF_SNO))
                      LEFT OUTER JOIN TBBADDED103M T8
                            ON (T8.RPRT_CD = 'A10700200' -- 소위원회 심의안
                               AND T8.AUD_YR = T1.AUD_YR
                               AND T8.AUD_NO = T1.AUD_NO
                               AND T8.REF_DY = T1.SBMT_SEQ
                               AND T8.REF_ID = TO_CHAR(T1.AFF_SNO))
                  WHERE 1=1
                   AND SBMT_FIX_DT = REPLACE(#{cmtDy},'-')
                   AND T1.SBMT_DVSN_NO = #{sbmtDvsnNo}
                GROUP BY T1.AUD_YR, T1.AUD_NO, T1.AUD_KND_CD, T1.AFF_CD, T1.TITLE_NM, T4.CHF_CMTR_ID, T1.SBMT_PLAN_DT
                    , T1.SBMT_REL_CON, T1.SBMT_REL_PER, T1.SBMT_REQ_DT, T1.SBMT_NO, T1.SBMT_STA_CD, T1.AUD_YR 
                    , T1.AUD_NO, T1.AUD_STEP_CD, T1.DOC_ID, T1.APVR_CD, T1.AFF_SNO, T1.SBMT_SEQ, T1.SBMT_FIX_DT, T1.AUD_MAIN_STEP_SNO
                    , T5.MNG_DPT_CD, T5.AUD_SBJ_NM, T1.SBMT_STA_CD, T6.DOC_ID, T5.AUD_KND_CD, T1.SBMT_DVSN_NO, T6.RPRT_NM, T7.DOC_ID, T7.RPRT_NM , T7.EDT_AUTH, T8.DOC_ID, T1.SBCN_PRSS_DPT_NM
                    , T5.DOC_WRIT_KND_CD, T1.RPRT_FILD_ID
                    
                UNION ALL
                
                SELECT 
                    SBMT_MNG_DPT_NM AS MNG_DPT_NM
                    , DECODE(T1.WORK_DVSN_CD,'A10', (SELECT AUD_SBJ_NM FROM TBBADDED001M WHERE AUD_YR = T1.REL_AUD_YR AND AUD_NO = T1.REL_AUD_NO)
                                                                    ,'D10', '심사청구', '재심의청구') AS AUD_SBJ_NM
                    , DECODE(T1.WORK_DVSN_CD, 'A10', F_MNG_KND_AUDYRNO(T1.REL_AUD_YR, T1.REL_AUD_NO, (SELECT AUD_KND_CD FROM TBBADDED001M WHERE AUD_YR = T1.REL_AUD_YR AND AUD_NO = T1.REL_AUD_NO), '-') 
                                                                             , T1.REL_AUD_YR || '-' || DECODE(T1.WORK_DVSN_CD, 'D10', '심사', 'E10', '재심', '') || '-' || TO_CHAR(T1.REL_AUD_NO)) AS AFF_CD_NM
                    , T1.CMT_SBJ_TIT AS TITLE_NM
                    , DECODE(T1.WORK_DVSN_CD, 'A10', DECODE(T1.REL_AUD_NO,'255','통보(인사자료)',  '766', '징계문책',  '276', DECODE(T1.CMT_SBJ_SNO, 1, '징계문책', 2,'징계문책'  ) ,   '')
                                                                    , (SELECT F_CODE_NM('1000002', ST2.DSP_RQ_KND_CD) AS DSP_RQ_NM
                                                                        FROM TBBADFRE012M ST1 
                                                                             LEFT OUTER JOIN TBBADEAR001M ST2 
                                                                             ON (ST1.AUD_YR = ST2.AUD_YR
                                                                                 AND ST1.AUD_NO = ST2.AUD_NO
                                                                                 AND ST1.DSP_RQ_SNO = ST2.DSP_RQ_SNO)
                                                                       WHERE ST1.ACP_YR = T1.REL_AUD_YR
                                                                         AND ST1.ACP_DVSN_CD = DECODE(T1.WORK_DVSN_CD, 'D10', '1', '2')
                                                                         AND TO_CHAR(ST1.ACP_SRNO) = T1.REL_AUD_NO)) AS DSP_RQ_NM
                     , T1.SBMT_CMTR_NM
                     , T1.SBMT_DVSN_NO||'소위' AS SBMT_DVSN_NM
                     , T1.SBMT_DVSN_NO
                     , '' AS SBMT_PLAN_DT
                     , SBMT_REL_ORG_NM AS SBMT_REL_CON
                     , NULL AS SBMT_REL_PER
                     , NVL(TO_CHAR(T1.FRT_REGI_DH,'YYYY"-"MM"-"DD'),'미요청') AS SBMT_REQ_DT
                     , SBCN_SNO AS SBMT_NO
                     , TO_CHAR(TO_DATE(T1.CMT_DY),'YYYY"-"MM"-"DD') AS SBMT_FIX_DT
                     , F_CODE_NM('1000808', '60') AS SBMT_STA_NM
                     , T1.REL_AUD_YR
                     , T1.REL_AUD_NO
                     , NULL AS AUD_STEP_CD
                     , T2.BAICHF_DOC_ID AS DOC_ID
                     , NULL AS APVR_CD
                     , NULL AS AFF_SNO
                     , NULL AS SBMT_SEQ
                     , NULL AS AUD_MAIN_STEP_SNO
                     , 'Y' AS SBMT_FIX_YN
                     , '60' AS SBMT_STA_CD
                     , T2.REF_ID AS SBMT_RPRT_DOC_ID
                     , DECODE(T1.WORK_DVSN_CD, 'D10', '1', '2') AS AUD_KND_CD
                     , DECODE(T1.WORK_DVSN_CD, 'D10', '1', '2') AS ACP_DVSN_CD
                     , T2.BAICHF_RPRT_NM AS SBMT_RPRT_DOC_NM
                     , T2.RPT_DOC_ID AS SBMT_RPRT_RPT_DOC_ID
                     , T2.RPT_RPRT_NM AS SBMT_RPRT_RPT_DOC_NM
                     , NULL AS RL_DOC_ID
                     , T2.DOC_ID AS SBMT_DOC_ID
                     , 'Y' AS ADD_YN
                     , T1.CMT_DY
                     , T1.CMT_DVSN_CD
                     , T1.CMT_SQ
                     , T1.CMT_SBJ_DVSN_CD
                     , T1.CMT_SBJ_SNO
                     , '' AS EDT_AUTH
                     , 'Y' AS SBCN_RPRT_SEND_YN
                     , '' AS SBCN_PRSS_DPT_NM
                     , 'hancom'  AS DOC_TYPE
                      , '' AS RPRT_FILD_ID
                     , 0 AS SBCN_CAM_CNT
                     , 0 AS SBCN_LAW_CNT
                  FROM TBBADDED121M T1
                       LEFT OUTER JOIN (
                          SELECT 
                                CMT_DY,
                                CMT_DVSN_CD,
                                CMT_SQ,
                                CMT_SBJ_DVSN_CD,
                                CMT_SBJ_SNO,
                                MAX(REF_ID) AS REF_ID,
                                MAX(DOC_ID) AS DOC_ID,
                                MAX(BAICHF_DOC_ID) AS BAICHF_DOC_ID, 
                                MAX(BAICHF_RPRT_NM) AS BAICHF_RPRT_NM,
                                MAX(RPT_DOC_ID) AS RPT_DOC_ID,
                                MAX(RPT_RPRT_NM) AS RPT_RPRT_NM,
                                '' AS EDT_AUTH
                              FROM (
                                SELECT 
                                    ST1.CMT_DY,
                                    ST1.CMT_DVSN_CD,
                                    ST1.CMT_SQ,
                                    ST1.CMT_SBJ_DVSN_CD,
                                    ST1.CMT_SBJ_SNO,
                                    /* CMT_SBJ_DTL_SNO - 1 : 심의안, 2 : 심의안요약(보고자용), 3 : 심의안요약(원장용) 
                                       기타안건(CMT_SBJ_DVSN_CD:90)일 경우 1 로 대체*/
                                    DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,1), ST2.DOC_ID, NULL) AS REF_ID,
                                    DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,3), ST2.DOC_ID, NULL) AS DOC_ID,
                                    DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,2), ST2.DOC_ID, NULL) AS RPT_DOC_ID,
                                    DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,2), ST2.FILE_NM, NULL) AS RPT_RPRT_NM,
                                    DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,3), ST2.DOC_ID, NULL) AS BAICHF_DOC_ID,
                                    DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,3), ST2.FILE_NM, NULL) AS BAICHF_RPRT_NM,
                                    '' AS EDT_AUTH
                                  FROM TBBADDED121M ST1
                                       INNER JOIN TBBADDED122M ST2
                                       ON (ST1.CMT_DY = ST2.CMT_DY 
                                           AND ST1.CMT_DVSN_CD = ST2.CMT_DVSN_CD
                                           AND ST1.CMT_SQ = ST2.CMT_SQ
                                           AND ST1.CMT_SBJ_DVSN_CD = ST2.CMT_SBJ_DVSN_CD
                                           AND ST1.CMT_SBJ_SNO = ST2.CMT_SBJ_SNO)
                                 WHERE ST1.CMT_SBJ_DVSN_CD IN ('10','90')
                                )
                             GROUP BY CMT_DY, CMT_DVSN_CD, CMT_SQ, CMT_SBJ_DVSN_CD,CMT_SBJ_SNO) T2
                       ON (T1.CMT_DY = T2.CMT_DY 
                          AND T1.CMT_DVSN_CD = T2.CMT_DVSN_CD
                          AND T1.CMT_SQ = T2.CMT_SQ
                          AND T1.CMT_SBJ_DVSN_CD = T2.CMT_SBJ_DVSN_CD
                          AND T1.CMT_SBJ_SNO = T2.CMT_SBJ_SNO)      
                 WHERE 1=1
                   AND T1.CMT_DY = REPLACE(#{cmtDy},'-')
                   AND T1.SBMT_DVSN_NO = #{sbmtDvsnNo}
                   AND T1.CMT_DVSN_CD = '20'

                 
UNION ALL
           
                
SELECT F_DPT_INFO (T1.DPT_CD,
			        '1') AS MNG_DPT_NM,
			        DECODE(T1.ACP_DVSN_CD, '1', '심사청구', '재심의청구') AS AUD_SBJ_NM, 
			        T1.ACP_YR || '-' || DECODE(T1.ACP_DVSN_CD, '1', '심사', '재심') || '-' || TO_CHAR(T1.ACP_SRNO) AS AFF_CD_NM,
			        T1.TITLE_NM,
			        T1.DSP_RQ_NM,
			        ( SELECT DECODE(CHF_CMTR_CNB, NULL, '', F_USR_INFO (ST1.CHF_CMTR_CNB, '2') || DECODE(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1),
			                  0,
			                  '',
			                  ' 외 ' || TO_CHAR(DECODE(ST1.CHF_CMTR1_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR2_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR3_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR4_CNB, NULL, 0, 1) + DECODE(ST1.CHF_CMTR5_CNB, NULL, 0, 1) ) ) )
			             FROM TBBADDED116L ST1
			            WHERE ST1.AUD_YR = T1.RL_ACP_YR
			              AND ST1.AUD_NO = TO_CHAR(T1.RL_ACP_SRNO)
			              AND ST1.TASK_DVSN_CD = T1.RL_ACP_DVSN_CD
			              AND ST1.DOC_ID = T1.CMTR_DOC_ID
			              AND ST1.SRNO = ( SELECT MAX(SRNO)
			                                 FROM TBBADDED116L
			                                WHERE AUD_YR = T1.RL_ACP_YR
			                                  AND AUD_NO = TO_CHAR(T1.RL_ACP_SRNO)
			                                  AND TASK_DVSN_CD = T1.RL_ACP_DVSN_CD
			                                  AND DOC_ID = T1.CMTR_DOC_ID) ) AS CHF_CMTR_NM,
			        T1.SBMT_DVSN_NO || '소위' AS SBMT_DVSN_NM,
			        T1.SBMT_DVSN_NO AS SBMT_DVSN_NO,
			        NVL(TO_CHAR(TO_DATE(T1.SBMT_PLAN_DT),
			        'YYYY"-"MM"-"DD'),
			        '미정') AS SBMT_PLAN_DT,
			        T1.SBMT_REL_CON,
			        (SELECT NVL(SUM(DECODE(ATTEN_NAME,NULL,0,1)+DECODE(AGT_NAME,NULL,0,1)),0)
			                     FROM TBBADDED114D ST1
			                    WHERE ST1.AUD_YR = T1.ACP_YR
			                      AND ST1.AUD_NO = TO_CHAR(T1.ACP_SRNO)
			                      AND ST1.AUD_STEP_CD = T1.ACP_STEP_CD
			                      AND ST1.DOC_ID = T1.RL_DOC_ID
			                      AND ST1.APVR_CD = T1.APVR_CD
			                      AND ST1.AFF_SNO = T1.AFF_SNO
			                      AND ST1.SBMT_SEQ = T1.SBMT_SEQ
			                      AND ST1.SBMT_DTL_DVSN NOT IN ('90')) AS SBMT_REL_PER,
			        NVL(TO_CHAR(T1.SBMT_REQ_DT,
			        'YYYY"-"MM"-"DD'),
			        '미요청') AS SBMT_REQ_DT,
			        T1.SBMT_NO,
			        TO_CHAR(TO_DATE(T1.SBMT_FIX_DT),
			        'YYYY"-"MM"-"DD') AS SBMT_FIX_DT,
			        F_CODE_NM ('1000808',
			        T1.SBMT_STA_CD) AS SBMT_STA_NM,
			        T1.ACP_YR,
			        TO_CHAR(T1.ACP_SRNO),
			        T1.ACP_STEP_CD,
			        T1.REF_ID,
			        T1.APVR_CD,
			        T1.AFF_SNO,
			        T1.SBMT_SEQ,
			        T1.ACP_MAIN_STEP_SNO AS AUD_MAIN_STEP_SNO,
			        CASE WHEN T1.SBMT_STA_CD < '30' THEN 'N' ELSE 'Y' END AS SBMT_FIX_YN,
			        T1.SBMT_STA_CD,
			        (SELECT SST1.DOC_ID FROM TBBADFRE103M SST1
						WHERE SST1.REF_ID=T1.REF_ID
						AND SST1.RPRT_CD = DECODE(T1.ACP_STEP_CD,'D1030','D10300620','E1030','E10300320')
					) AS SBMT_RPRT_DOC_ID, -- 소위원회 심의안 DOC_ID 심사재심의 문서함 조인해서 뽑아야할듯,
			        T1.ACP_DVSN_CD,
			        T1.ACP_DVSN_CD AS ACP_DVSN_CD,
                    (SELECT SST1.RPRT_NM FROM TBBADFRE103M SST1
						WHERE SST1.REF_ID=T1.REF_ID
						AND SST1.RPRT_CD = DECODE(T1.ACP_STEP_CD,'D1030','D10300620','E1030','E10300320')
					) AS SBMT_RPRT_DOC_NM    -- 소위원회 심의안 요약문 보고서명
					,( SELECT SST2.DOC_ID FROM TBBADFRE103M SST2
						WHERE SST2.REF_ID=T1.REF_ID
						AND SST2.RPRT_CD = DECODE(T1.ACP_STEP_CD,'D1030','D10300610','E1030','E10300310')
					) AS SBMT_RPRT_RPT_DOC_ID -- 소위원회 심의안 요약문(보고자용) DOC_ID
					, ( SELECT SST3.RPRT_NM FROM TBBADFRE103M SST3
						 WHERE SST3.REF_ID=T1.REF_ID
   							AND SST3.RPRT_CD = DECODE(T1.ACP_STEP_CD,'D1030','D10300610','E1030','E10300310')
					) AS SBMT_RPRT_RPT_DOC_NM    -- 소위원회 심의안 요약문(보고자용) 보고서명
					, T1.RL_DOC_ID
                    , '' AS SBMT_DOC_ID
                    , 'N' AS ADD_YN
                    , NULL AS CMT_DY
                     , NULL AS CMT_DVSN_CD
                     , NULL AS CMT_SQ
                     , NULL AS CMT_SBJ_DVSN_CD
                     , NULL AS CMT_SBJ_SNO
                     , ( SELECT NVL(SST3.EDT_AUTH,'Y') FROM TBBADFRE103M SST3
						 WHERE SST3.REF_ID=T1.REF_ID
   							AND SST3.RPRT_CD = DECODE(T1.ACP_STEP_CD,'D1030','D10300610','E1030','E10300310')
					  )  AS EDT_AUTH
                     , (SELECT DECODE(COUNT(1),0,'N','Y')
                               FROM TBBADFRE111M ST1 
                              WHERE ST1.DOC_ID = T1.DOC_ID
                      ) AS SBCN_RPRT_SEND_YN
                     , T1.SBCN_PRSS_DPT_NM
                     , T1.DOC_TYPE
                     , '' AS RPRT_FILD_ID
                     , 0 AS SBCN_CAM_CNT
                     , (SELECT COUNT(1)
                        FROM TBBADDED126M C
                        WHERE C.WRK_YR = T1.ACP_YR
                        AND C.WRK_NO = TO_CHAR(T1.ACP_SRNO)
                        AND C.REQ_STAT_CD = '60'
                        AND C.WRK_DVSN_CD = DECODE(T1.ACP_DVSN_CD, '1', 'D10', '2', 'E10','A10')) AS  SBCN_LAW_CNT
			   FROM ( SELECT T3.SBMT_SEQ,
			                 T3.MG_DIV_CD,
			                 T3.ACP_YR,
			                 T3.ACP_SRNO,
			                 T3.ACP_DVSN_CD,
			                 ST3.DOC_ID AS REF_ID /*심의안 결정문 아이디*/,
			                 ST3.RPRT_NM,
			                 ST3.DOC_WRT_ID,
			                 ST3.APV_STA_CD,
			                 T3.DPT_CD,
			                 T3.ACP_STEP_CD,
			                 T3.SBMT_PLAN_DT,
			                 T3.SBMT_REL_CON,
			                 T3.SBMT_REL_PER,
			                 T3.SBMT_REQ_DT,
			                 T3.SBMT_NO,
			                 T3.SBMT_FIX_DT,
			                 T3.SBMT_STA_CD,
			                 T3.APVR_CD,
			                 T3.AFF_SNO,
			                 T3.ACP_MAIN_STEP_SNO,
			                 ( SELECT DOC_ID
			                      FROM TBBADFRE103M
			                     WHERE REF_ID = ST3.DOC_ID
			                       AND RPRT_CD NOT IN ('D10300610','E10300310','D10300620','E10300320')
			                 ) AS DOC_ID /*심의안 요약문 아이디*/,
			                 ST3.RPRT_CD,
			                 T3.TITLE_NM,
			                 T3.SBMT_DVSN_NO,
			                 T3.DSP_RQ_NM,
			                 T3.RL_ACP_YR,
	                         T3.RL_ACP_SRNO,
	                         T3.RL_ACP_DVSN_CD,
	                         T3.RL_DOC_ID,
	                         T3.SBCN_PRSS_DPT_NM,
	                         ST4.DOC_ID AS CMTR_DOC_ID,
	                         T3.DOC_TYPE
			            from ( SELECT ST1.SBMT_SEQ AS SBMT_SEQ,
			                          ST2.MG_DIV_CD,
			                          DECODE(ST2.MG_DIV_CD, NULL, ST1.ACP_YR, ST2.MG_ACP_YR) AS RL_ACP_YR,
			                          DECODE(ST2.MG_DIV_CD, NULL, ST1.ACP_SRNO, ST2.MG_ACP_SRNO) AS RL_ACP_SRNO,
			                          DECODE(ST2.MG_DIV_CD, NULL, ST1.ACP_DVSN_CD, ST2.MG_ACP_DVSN_CD) AS RL_ACP_DVSN_CD,
			                          ST2.DPT_CD,
			                          ST1.SBMT_PLAN_DT,
			                          ST1.SBMT_REL_CON,
			                          ST1.SBMT_REL_PER,
			                          ST1.SBMT_REQ_DT,
			                          ST1.SBMT_NO,
			                          ST1.SBMT_FIX_DT,
			                          ST1.SBMT_STA_CD,
			                          ST1.APVR_CD,
			                          ST1.AFF_SNO,
			                          ST1.ACP_MAIN_STEP_SNO,
			                          NVL(ST1.TITLE_NM,' ') AS TITLE_NM,
			                          ST1.SBMT_DVSN_NO,
			                         (
				                        SELECT F_CODE_NM('1000002',A.DSP_RQ_KND_CD) 
							              FROM TBBADEAR001M A
							             WHERE 1=1
							               AND A.AUD_YR = ST2.AUD_YR
							               AND A.AUD_NO = ST2.AUD_NO
							               AND A.DSP_RQ_SNO = ST2.DSP_RQ_SNO
							               AND A.AUD_YR IS NOT NULL
				                      ) AS DSP_RQ_NM,
			                          ST1.ACP_YR AS ACP_YR,
			                          ST1.ACP_SRNO AS ACP_SRNO,
			                          ST1.ACP_DVSN_CD AS ACP_DVSN_CD,
			                          ST1.DOC_ID AS RL_DOC_ID,
			                          ST1.ACP_STEP_CD,
			                          ST1.SBCN_PRSS_DPT_NM,
			                          F_CODE_NM('1000894', ST2.DOC_WRIT_KND_CD) AS DOC_TYPE
			                     FROM TBBADFRE114M ST1 INNER JOIN TBBADFRE012M ST2 ON (ST1.ACP_YR=ST2.ACP_YR
			                      AND ST1.ACP_SRNO = ST2.ACP_SRNO
			                      AND ST1.ACP_DVSN_CD = ST2.ACP_DVSN_CD)
			                    WHERE 1=1
			                      AND ST1.SBMT_FIX_DT = REPLACE(#{cmtDy},
			                          '-') 
			    			      AND ST1.SBMT_DVSN_NO = #{sbmtDvsnNo}
			                       ) T3 LEFT JOIN (
			                                       SELECT G.DOC_ID, 
                                                          G.RPRT_NM,
                                                          G.DOC_WRT_ID,
                                                          G.APV_STA_CD,
                                                          G.RPRT_CD,
                                                          G.ACP_YR,G.ACP_DVSN_CD,G.ACP_SRNO,
                                                          G.REF_ID
			                                         FROM TBBADFRE103M G
			                                        WHERE G.RPRT_CD IN (DECODE(G.ACP_DVSN_CD,'1','D10300500','2','E10300200'))
			                                       ) ST3 ON (T3.ACP_YR=ST3.ACP_YR
			                                                 AND T3.ACP_SRNO = ST3.ACP_SRNO
			                                                 AND T3.ACP_DVSN_CD = ST3.ACP_DVSN_CD
			                                                 AND TO_CHAR(T3.SBMT_SEQ) = ST3.REF_ID/*20170905 UPDATE*/
			             ) LEFT JOIN TBBADFRE103M ST4 ON (T3.RL_ACP_YR=ST4.ACP_YR
					              AND T3.RL_ACP_SRNO = ST4.ACP_SRNO
					              AND T3.RL_ACP_DVSN_CD = ST4.ACP_DVSN_CD)
			           WHERE ST4.RPRT_CD = DECODE(T3.ACP_DVSN_CD,'1','D10300200','2','E10300150') 
			           ) T1 left outer JOIN TBBADFRE112M T2 ON (T1.RL_ACP_YR = T2.ACP_YR
			    AND T1.RL_ACP_DVSN_CD = T2.ACP_DVSN_CD
			    AND T1.RL_ACP_SRNO = T2.ACP_SRNO) 
			    --				         INNER JOIN ( SELECT -- 참석인원 TBBADDED114D 테이블 같이 쓸지 확인 후 수정해야함 --                                            ST1.AUD_YR --                                           , ST1.AUD_NO --                                           , ST1.AUD_STEP_CD --                                           , ST1.DOC_ID --                                           , ST1.APVR_CD --                                           , ST1.AFF_SNO --                                           , ST1.SBMT_SEQ --                                           , F_CODE_NM('1000002', ST2.DSP_RQ_CD) AS DSP_RQ_NM --                                           , COUNT(ST2.DSP_RQ_CD) AS DSP_RQ_CNT --                                         FROM TBBADDED114D ST1 --                                              INNER JOIN TBBADDED146M ST2 --                                              ON (ST1.AUD_YR = ST2.AUD_YR --                                                  AND ST1.AUD_NO = ST2.AUD_NO --                                                  AND ST1.AUD_STEP_CD = ST2.AUD_STEP_CD --                                                  AND ST1.DOC_ID = ST2.DOC_ID --                                                  AND ST1.APVR_CD = ST2.APVR_CD --                                                  AND ST1.AFF_SNO = ST2.AFF_SNO --                                                  AND ST1.DSP_RQ_SNO = ST2.DSP_RQ_SNO) --                                        GROUP BY ST1.AUD_YR, ST1.AUD_NO, ST1.AUD_STEP_CD, ST1.DOC_ID, ST1.APVR_CD --                                                , ST1.AFF_SNO, ST1.SBMT_SEQ, ST2.DSP_RQ_CD --                                ) T3 --                       ON (T1.AUD_YR = T3.AUD_YR --                           AND T1.AUD_NO = T3.AUD_NO --                           AND T1.AUD_STEP_CD = T3.AUD_STEP_CD --                           AND T1.DOC_ID = T3.DOC_ID --                           AND T1.APVR_CD = T3.APVR_CD --                           AND T1.AFF_SNO = T3.AFF_SNO) --T6 심의안결정문
			  WHERE 1=1
                 GROUP BY T1.ACP_YR, T1.ACP_SRNO, T1.ACP_DVSN_CD, T1.TITLE_NM, T1.SBMT_PLAN_DT
                , T1.SBMT_REL_CON, T1.SBMT_REL_PER, T1.SBMT_REQ_DT, T1.SBMT_NO, T1.SBMT_STA_CD
                , T1.ACP_STEP_CD, T1.DOC_ID, T1.APVR_CD, T1.AFF_SNO, T1.SBMT_SEQ, T1.SBMT_FIX_DT, T1.ACP_MAIN_STEP_SNO
                , T1.DPT_CD,  T1.SBMT_DVSN_NO ,T1.DSP_RQ_NM   ,T1.MG_DIV_CD,T1.RL_ACP_YR,T1.RL_ACP_SRNO
                , T1.RL_ACP_DVSN_CD, T1.RL_DOC_ID, T1.REF_ID, T1.SBCN_PRSS_DPT_NM, T1.CMTR_DOC_ID
                , T1.DOC_TYPE
                 ORDER BY SBMT_DVSN_NO, SBMT_NO, SBMT_SEQ DESC
             ]]>
         <include refid="include.pageOrder" />
    </select>
    
    <select id="selectSubList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectSubList*/
        <include refid="include.pageSelct" />
            <![CDATA[
            SELECT T.TITLE, T.TITLE AS V_TITLE
            ,T.SBCN_PAGE_CNT
            ,T.DTL_CNT
            ,T.MNG_DPT_NM
            ,T.ADD_YN_NM
            ,T.ADD_YN
            ,T.CMT_DY
            ,T.CMT_DVSN_CD
            ,T.CMT_SQ
            ,T.CMT_SBJ_DVSN_CD
            ,T.CMT_SBJ_SNO
            ,T.AUD_YR
            ,T.AUD_NO
            ,T.AUD_KND_CD
            ,T.AUD_GRN_NO
            ,T.AUD_MAIN_STEP_SNO
            ,T.REF_ID
            ,T.DOC_ID
            ,T.BAICHF_DOC_ID
            ,T.BAICHF_RPRT_NM
            ,T.RPT_DOC_ID
            ,T.RPT_RPRT_NM
            ,T.SBCN_REGI_REQ_DT
            ,T.CMT_ADD_YN
            ,NVL(T.EDT_AUTH,'Y') AS EDT_AUTH
            ,T.SBCN_RPTR
            ,T.WORK_DVSN_NM
            ,T.PRSS_DPT_NM
            ,T.REL_TSK_NM
            ,T.REGI_NO
            ,T.REF_DOC_ID
            ,T.SBCN_RPRT_SEND_YN
            ,T.CAM_CNT
           --법률자문 SQL START --
            , (SELECT COUNT(*)  
                FROM TBBADDED126M T1
               WHERE T1.WRK_YR = T.AUD_YR
                 AND T1.WRK_NO = T.AUD_NO
                 AND T1.LEGAL_REQ_DVSN_CD IN ('20', '30') 
                 AND T1.REQ_STAT_CD = '60'
                 AND T1.WRK_DVSN_CD = DECODE(T.ACP_DVSN_CD, '1', 'D10', '2', 'E10','A10')
                 AND (T1.WRK_DVSN_CD IN ( 'D10', 'E10') 
                      OR 
                     (T1.WRK_DVSN_CD = 'A10' AND EXISTS (SELECT 1 FROM TBBADDED145M A 
                                                         WHERE A.AUD_YR = T1.WRK_YR 
                                                           AND A.AUD_NO =  T1.WRK_NO
                                                           AND A.APVR_CD = T1.APVR_CD
                                                           AND A.AFF_SNO = T1.AFF_SNO
                                                           AND A.DOC_ID = T.REF_DOC_ID
                                                           AND A.RPRT_FILD_ID = T1.RPRT_FILD_ID))) ) AS LAW_CNT
           --법률자문 SQL END --   
            ,T.MG_DIV_CD
            , T.RAL_BLT_DIV_CD
            , T.DOC_TYPE
            , T.ACP_DVSN_CD
      FROM
          (
          /* 실지감사 시스템 */
          SELECT  DECODE(A.REL_TSK_NM,NULL
                                ,'('||F_MNG_KND_AUDYRNO(D.AUD_YR, D.AUD_NO, D.AUD_KND_CD, '-')||')'||D.AUD_SBJ_NM
                                ,'('||A.REL_TSK_NM||')'||D.AUD_SBJ_NM)||(SELECT REL_TEXT1
                                                                                 FROM TBBADDED121T F
                                                                                WHERE F.AUD_YR = A.AUD_YR
                                                                                   AND F.AUD_NO  = A.AUD_NO
                                                                                   AND F.AUD_YR_DY = C.REF_DY) AS TITLE,
                     A.SBCN_PAGE_CNT                   AS SBCN_PAGE_CNT,
                     COUNT(A.DSP_RQ_SNO)||'건'       AS DTL_CNT,
                     F_DPT_INFO(D.MNG_DPT_CD,'1')      AS MNG_DPT_NM,
                     ''                                AS ADD_YN_NM,
                     'N'                               AS ADD_YN,
                     D4.CMT_DY                         AS CMT_DY,
                     '10'                              AS CMT_DVSN_CD,
                     TO_CHAR(D4.CMT_SQ)                AS CMT_SQ,
                     ''                                AS CMT_SBJ_DVSN_CD,
                     ''                                AS CMT_SBJ_SNO,
                     D.AUD_YR                          AS AUD_YR,
                     D.AUD_NO                          AS AUD_NO,
                     D.AUD_KND_CD                      AS AUD_KND_CD,
                     D.AUD_GRN_NO                      AS AUD_GRN_NO,
                     TO_CHAR(MAX(A.AUD_MAIN_STEP_SNO)) AS AUD_MAIN_STEP_SNO,
                     A.SBCN_REGI_REQ_DT                AS SBCN_REGI_REQ_DT,
                     'N'                               AS CMT_ADD_YN,
                     A.SBCN_RPTR,
                     C.REF_ID,
                     C.DOC_ID,
                     C.RPT_DOC_ID,
                     C.RPT_RPRT_NM,
                     C.BAICHF_DOC_ID,
                     C.BAICHF_RPRT_NM,
                     C.EDT_AUTH,
                     '실지감사' AS WORK_DVSN_NM,
                     'A10' AS WORK_DVSN_CD,
                     A.SBCN_PRSS_DPT_NM AS PRSS_DPT_NM,
                     A.REL_TSK_NM,
                     ( SELECT COUNT( COUNT(*))
                       FROM TBCSPKDE106M ST2 INNER JOIN TBBADDED145M ST3
                          ON ST2.AUD_YR = ST3.AUD_YR
                         AND ST2.AUD_NO  = ST3.AUD_NO
                         AND ST2.AFF_SNO = ST3.AFF_SNO
                         AND ST3.APVR_CD = 'A1070'
                         AND ST3.REFER_DVSN_CD = 'D10'
                         AND ST2.RPRT_FILD_ID = ST3.RPRT_FILD_ID                         
                      WHERE ST2.AUD_YR = A.AUD_YR
                         AND ST2.AUD_NO = A.AUD_NO
                         AND ST3.DOC_ID = A.DOC_ID
                         GROUP BY ST2.AFF_SNO ) AS CAM_CNT, 
                     (SELECT REGI_NO 
                         FROM TBBADDED112D ST1
                       WHERE ST1.AUD_YR = A.AUD_YR
                            AND ST1.AUD_NO = A.AUD_NO
                            AND ST1.DOC_ID = A.DOC_ID) AS REGI_NO,
                     A.DOC_ID AS REF_DOC_ID /*감사보고서 DOC_ID*/
                     , (SELECT DECODE(COUNT(1),0,'N','Y')
                               FROM TBBADDED111M ST1 
                              WHERE ST1.AUD_YR = A.AUD_YR
                                AND ST1.AUD_NO = A.AUD_NO
                                AND ST1.DOC_ID = C.DOC_ID) AS SBCN_RPRT_SEND_YN
                     , '' AS MG_DIV_CD
                     , (SELECT ST1.RAL_BLT_DIV_CD 
                          FROM TBDCMACM001M ST1 
                    INNER JOIN TBBADDED116L ST2 ON (ST2.CHF_CMTR_CNB = ST1.CNB)
                         WHERE ST2.AUD_YR = A.AUD_YR AND ST2.AUD_NO = A.AUD_NO AND ST2.DOC_ID = A.DOC_ID AND ST2.SRNO = (SELECT MAX(ST3.SRNO) FROM TBBADDED116L ST3 WHERE ST3.AUD_YR = A.AUD_YR AND ST3.AUD_NO = A.AUD_NO AND ST3.DOC_ID = A.DOC_ID)) AS RAL_BLT_DIV_CD
                     , F_CODE_NM('1000894', D.DOC_WRIT_KND_CD) AS DOC_TYPE
                     , '' AS ACP_DVSN_CD
                FROM TBBADDED113M AS A
                     INNER JOIN TBBADDED001M AS D 
                     ON (A.AUD_YR   = D.AUD_YR AND A.AUD_NO = D.AUD_NO)
                     LEFT OUTER JOIN TBBADDED120M D4 
                     ON (D4.CMT_DY = A.SBCN_DY AND D4.CMT_DVSN_CD = '10')
                     LEFT OUTER JOIN 
                        (SELECT 
                            AUD_YR,
                            AUD_NO,
                            REF_DY,
                            REF_DOC_ID,
                            MAX(REF_ID) AS REF_ID,
                            MAX(DOC_ID) AS DOC_ID,
                            MAX(BAICHF_DOC_ID) AS BAICHF_DOC_ID, 
                            MAX(BAICHF_RPRT_NM) AS BAICHF_RPRT_NM,
                            MAX(RPT_DOC_ID) AS RPT_DOC_ID,
                            MAX(RPT_RPRT_NM) AS RPT_RPRT_NM,
                            MAX(EDT_AUTH) AS EDT_AUTH
                          FROM (
                            SELECT 
                                AUD_YR,
                                AUD_NO,
                                REF_DY,
                                REF_DOC_ID,
                                DECODE(ST1.RPRT_CD, 'A10700500', DOC_ID, NULL) AS REF_ID,
                                DECODE(ST1.RPRT_CD, 'A10700600', DOC_ID, NULL) AS DOC_ID,
                                DECODE(ST1.RPRT_CD, 'A10700700', DOC_ID, NULL) AS RPT_DOC_ID,
                                DECODE(ST1.RPRT_CD, 'A10700700', RPRT_NM, NULL) AS RPT_RPRT_NM,
                                DECODE(ST1.RPRT_CD, 'A10700800', DOC_ID, NULL) AS BAICHF_DOC_ID,
                                DECODE(ST1.RPRT_CD, 'A10700800', RPRT_NM, NULL) AS BAICHF_RPRT_NM,
                                DECODE(ST1.RPRT_CD, 'A10700700', EDT_AUTH, NULL) AS EDT_AUTH
                              FROM TBBADDED103M ST1
                             WHERE RPRT_CD IN ('A10700500', 'A10700600', 'A10700700', 'A10700800')
                           )
                         GROUP BY AUD_YR, AUD_NO, REF_DY,REF_DOC_ID) C
                     ON (A.AUD_YR = C.AUD_YR AND A.AUD_NO = C.AUD_NO AND C.REF_DY = A.SBCN_REGI_REQ_DT AND C.REF_DOC_ID = A.DOC_ID)
               WHERE A.SBCN_DY = REPLACE(#{cmtDy},'-')
                 AND A.SBCN_DY IS NOT NULL
            GROUP BY D.AUD_YR, D.AUD_NO, D.AUD_KND_CD, D.AUD_GRN_NO, D.AUD_SBJ_NM, D.MNG_DPT_CD, A.SBCN_PAGE_CNT, A.SBCN_REGI_REQ_DT
                    , A.AUD_YR, A.AUD_NO, D4.CMT_DY , D4.CMT_SQ, A.SBCN_RPTR, C.REF_ID, A.SBCN_PRSS_DPT_NM, A.DOC_ID
                    , C.DOC_ID,C.RPT_DOC_ID,C.RPT_RPRT_NM,C.BAICHF_DOC_ID, C.BAICHF_RPRT_NM,C.EDT_AUTH, A.REL_TSK_NM,  C.REF_DY
                    , D.DOC_WRIT_KND_CD
           /* 심사,재심 시스템 */     
           UNION ALL
           SELECT  '('||A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD, '1', '심사', '재심') || '-' || TO_CHAR(A.ACP_SRNO)||')'|| (SELECT TIT_NM FROM TBBADFRE112M WHERE ACP_YR = A.ACP_YR AND ACP_DVSN_CD = A.ACP_DVSN_CD AND ACP_SRNO = A.ACP_SRNO) AS TITLE,
                     A.SBCN_PAGE_CNT                   AS SBCN_PAGE_CNT,
                     (SELECT DECODE(COUNT(1),0,1,COUNT(1))
                        FROM TBBADFRE012M
                       WHERE MG_ACP_YR = A.ACP_YR
		                 AND MG_ACP_DVSN_CD = A.ACP_DVSN_CD
		                 AND MG_ACP_SRNO = A.ACP_SRNO
		                 AND DEL_YN IS NULL)||'건'       AS DTL_CNT,
                     F_DPT_INFO((SELECT DPT_CD FROM TBBADFRE012M WHERE ACP_YR = A.ACP_YR AND ACP_DVSN_CD = A.ACP_DVSN_CD AND ACP_SRNO = A.ACP_SRNO),'1')      AS MNG_DPT_NM,
                     ''                                AS ADD_YN_NM,
                     'N'                               AS ADD_YN,
                     D4.CMT_DY                         AS CMT_DY,
                     '10'                              AS CMT_DVSN_CD,
                     TO_CHAR(D4.CMT_SQ)                AS CMT_SQ,
                     ''                                AS CMT_SBJ_DVSN_CD,
                     ''                                AS CMT_SBJ_SNO,
                     A.ACP_YR                          AS AUD_YR,
                     TO_CHAR(A.ACP_SRNO)                          AS AUD_NO,
                     A.ACP_DVSN_CD                      AS AUD_KND_CD,
                     ''                      AS AUD_GRN_NO,
                     TO_CHAR(MAX(A.ACP_MAIN_STEP_SNO)) AS AUD_MAIN_STEP_SNO,
                     A.SBCN_REGI_REQ_DT                AS SBCN_REGI_REQ_DT,
                     'N'                               AS CMT_ADD_YN,
                     A.SBCN_RPTR,
                     C.REF_ID,
                     C.DOC_ID,
                     C.RPT_DOC_ID,
                     C.RPT_RPRT_NM,
                     C.BAICHF_DOC_ID,
                     C.BAICHF_RPRT_NM,
                     C.EDT_AUTH,
                     DECODE(A.ACP_DVSN_CD,'1','심사','2','재심') AS WORK_DVSN_NM,
                     DECODE(A.ACP_DVSN_CD,'1','D10','2','E10') AS WORK_DVSN_CD,
                     
                     A.SBCN_PRSS_DPT_NM AS PRSS_DPT_NM,                     
                     '' AS REL_TSK_NM, /*A.REL_TSK_NM,*/
                     0 AS CAM_CNT,
                     (SELECT REGI_NO 
                         FROM TBBADFRE112D ST1
                       WHERE ST1.ACP_YR = A.ACP_YR
                            AND ST1.ACP_DVSN_CD = A.ACP_DVSN_CD
                            AND ST1.ACP_SRNO = A.ACP_SRNO
                            AND ST1.DOC_ID = A.DOC_ID) AS REGI_NO,
                     A.DOC_ID AS REF_DOC_ID /*감사보고서 DOC_ID*/
                     , (SELECT DECODE(COUNT(1),0,'N','Y')
                               FROM TBBADFRE111M ST1 
                              WHERE ST1.ACP_YR = A.ACP_YR
                                AND ST1.ACP_SRNO = A.ACP_SRNO
                                AND ST1.ACP_DVSN_CD = A.ACP_DVSN_CD
                                AND ST1.DOC_ID = C.DOC_ID) AS SBCN_RPRT_SEND_YN
                     , D.MG_DIV_CD
                     , '' AS RAL_BLT_DIV_CD
                     , F_CODE_NM('1000894', D.DOC_WRIT_KND_CD) AS DOC_TYPE
                     , D.ACP_DVSN_CD
                FROM TBBADFRE113M AS A
                     INNER JOIN TBBADFRE012M AS D 
                     ON (A.ACP_YR   = NVL(D.MG_ACP_YR, D.ACP_YR) AND A.ACP_SRNO = NVL(D.MG_ACP_SRNO, D.ACP_SRNO) AND A.ACP_DVSN_CD = NVL(D.ACP_DVSN_CD, D.ACP_DVSN_CD))
                     LEFT OUTER JOIN TBBADDED120M D4 
                     ON (D4.CMT_DY = A.SBCN_DY AND D4.CMT_DVSN_CD = '10')
                     LEFT OUTER JOIN 
                        (SELECT 
                            ACP_YR,
                            ACP_SRNO,
                            ACP_DVSN_CD,
                            REF_DY,
                            REF_ID,
                            MAX(DOC_ID) AS DOC_ID,
                            MAX(BAICHF_DOC_ID) AS BAICHF_DOC_ID, 
                            MAX(BAICHF_RPRT_NM) AS BAICHF_RPRT_NM,
                            MAX(RPT_DOC_ID) AS RPT_DOC_ID,
                            MAX(RPT_RPRT_NM) AS RPT_RPRT_NM,
                            MAX(EDT_AUTH) AS EDT_AUTH
                          FROM (
                            SELECT 
                                ACP_YR,
                                ACP_SRNO,
                                ACP_DVSN_CD,
                                REF_DY,
                                REF_ID,
                                DECODE(ST1.RPRT_CD, 'D10301100', DOC_ID,'E10500600', DOC_ID, NULL) AS DOC_ID,
                                DECODE(ST1.RPRT_CD, 'D10301110', DOC_ID,'E10500610', DOC_ID, NULL) AS RPT_DOC_ID,
                                DECODE(ST1.RPRT_CD, 'D10301110', RPRT_NM,'E10500610', RPRT_NM, NULL) AS RPT_RPRT_NM,
                                DECODE(ST1.RPRT_CD, 'D10301120', DOC_ID,'E10500620', DOC_ID, NULL) AS BAICHF_DOC_ID,
                                DECODE(ST1.RPRT_CD, 'D10301120', RPRT_NM,'E10500620', RPRT_NM, NULL) AS BAICHF_RPRT_NM,
                                DECODE(ST1.RPRT_CD, 'D10301110', EDT_AUTH,'E10500610', EDT_AUTH, NULL) AS EDT_AUTH
                              FROM TBBADFRE103M ST1
                             WHERE RPRT_CD IN ('D10301100', 'E10500600','D10301110','E10500610','D10301120','E10500620')
                           )
                         GROUP BY ACP_YR, ACP_SRNO, ACP_DVSN_CD, REF_DY, REF_ID) C
                     ON (A.ACP_YR = C.ACP_YR AND A.ACP_DVSN_CD = C.ACP_DVSN_CD AND A.ACP_SRNO = C.ACP_SRNO AND C.REF_DY = A.SBCN_REGI_REQ_DT AND C.REF_DY = A.SBCN_REGI_REQ_DT)
               WHERE A.SBCN_DY = REPLACE(#{cmtDy},'-')
                 AND A.SBCN_DY IS NOT NULL
            GROUP BY A.ACP_YR, A.ACP_SRNO, A.ACP_DVSN_CD, A.SBCN_PAGE_CNT, A.SBCN_REGI_REQ_DT
                    , A.ACP_YR, A.ACP_SRNO,A.ACP_DVSN_CD,A.SBCN_PRSS_DPT_NM, D4.CMT_DY , D4.CMT_SQ, A.SBCN_RPTR, C.REF_ID
                    , C.DOC_ID,C.RPT_DOC_ID,C.RPT_RPRT_NM,C.BAICHF_DOC_ID, C.BAICHF_RPRT_NM,C.EDT_AUTH,  C.REF_DY, A.DOC_ID, D.MG_DIV_CD, D.DOC_WRIT_KND_CD,  D.ACP_DVSN_CD
               /* 실지감사 수기 */     
               UNION ALL
               SELECT 
                    DECODE(A.REL_TSK_NM,NULL,DECODE(A.WORK_DVSN_CD,'D10','('||REL_AUD_YR||'-심사-'||REL_AUD_NO||')'||A.CMT_SBJ_TIT   /* 심사청구 */
                                                                        ,'E10','('||REL_AUD_YR||'-재심-'||REL_AUD_NO||')'||A.CMT_SBJ_TIT   /* 재심의청구 */
                                                                        ,'A10','('||(SELECT F_MNG_KND_AUDYRNO(ST1.AUD_YR, ST1.AUD_NO, ST1.AUD_KND_CD, '-')
                                                                                            FROM TBBADDED001M ST1
                                                                                          WHERE ST1.AUD_YR = A.REL_AUD_YR
                                                                                               AND ST1.AUD_NO = A.REL_AUD_NO)||')'||A.CMT_SBJ_TIT,A.CMT_SBJ_TIT)
                                            ,'('||A.REL_TSK_NM||')'||A.CMT_SBJ_TIT) AS TITLE,
                     A.SBCN_SNO               AS SBCN_PAGE_CNT,
                     DECODE(A.BFR_SBCN_CNT,NULL,(SELECT TO_CHAR(COUNT(1))
                                                    FROM TBBADDED122M ST1
                                                   WHERE ST1.CMT_DY = A.CMT_DY
                                                     AND ST1.CMT_DVSN_CD = A.CMT_DVSN_CD
                                                     AND ST1.CMT_SQ = A.CMT_SQ
                                                     AND ST1.CMT_SBJ_DVSN_CD = A.CMT_SBJ_DVSN_CD
                                                     AND ST1.CMT_SBJ_SNO = A.CMT_SBJ_SNO),A.BFR_SBCN_CNT)||'건' AS DTL_CNT,
                     F_DPT_INFO(A.REL_DPT_CD,'1')  AS MNG_DPT_NM,
                     '안건추가'                    AS ADD_YN_NM,
                     'Y'                           AS ADD_YN,
                     A.CMT_DY                      AS CMT_DY,
                     A.CMT_DVSN_CD                 AS CMT_DVSN_CD,
                     TO_CHAR(A.CMT_SQ)             AS CMT_SQ,
                     A.CMT_SBJ_DVSN_CD             AS CMT_SBJ_DVSN_CD,
                     TO_CHAR(A.CMT_SBJ_SNO)        AS CMT_SBJ_SNO,
                     A.REL_AUD_YR                  AS AUD_YR,
                     A.REL_AUD_NO                  AS AUD_NO,
                     ''                            AS AUD_KND_CD,
                     ''                            AS AUD_GRN_NO,
                     ''                            AS AUD_MAIN_STEP_SNO,
                     ''                            AS SBCN_REGI_REQ_DT,
                     A.CMT_ADD_YN                  AS CMT_ADD_YN,
                     SBCN_RPTR                     AS SBCN_RPTR,
                     C.REF_ID,
                     C.DOC_ID,
                     C.RPT_DOC_ID,
                     C.RPT_RPRT_NM,
                     C.BAICHF_DOC_ID,
                     C.BAICHF_RPRT_NM,
                     C.EDT_AUTH,
                     DECODE(A.WORK_DVSN_CD,'A10','실지감사'
                                          ,'D10','심사청구'
                                          ,'E10','재심의청구'
                                          ,'Z90','기타안건','기타안건') AS WORK_DVSN_NM,
                     A.WORK_DVSN_CD,
                     A.PRSS_DPT_NM AS PRSS_DPT_NM,
                     A.REL_TSK_NM,
                     0 AS CAM_CNT,
                     A.REGI_NO,
                     NULL AS REF_DOC_ID
                     , 'Y' AS SBCN_RPRT_SEND_YN
                     , '' AS MG_DIV_CD
                     , '' AS RAL_BLT_DIV_CD
                     , 'hancom' AS DOC_TYPE
                     , '' AS ACP_DVSN_CD
                FROM TBBADDED121M AS A
                     LEFT OUTER JOIN (
                              SELECT 
                                    CMT_DY,
                                    CMT_DVSN_CD,
                                    CMT_SQ,
                                    CMT_SBJ_DVSN_CD,
                                    CMT_SBJ_SNO,
                                    MAX(REF_ID) AS REF_ID,
                                    MAX(DOC_ID) AS DOC_ID,
                                    MAX(BAICHF_DOC_ID) AS BAICHF_DOC_ID, 
                                    MAX(BAICHF_RPRT_NM) AS BAICHF_RPRT_NM,
                                    MAX(RPT_DOC_ID) AS RPT_DOC_ID,
                                    MAX(RPT_RPRT_NM) AS RPT_RPRT_NM,
                                    '' AS EDT_AUTH
                                  FROM (
                                    SELECT 
                                        ST1.CMT_DY,
                                        ST1.CMT_DVSN_CD,
                                        ST1.CMT_SQ,
                                        ST1.CMT_SBJ_DVSN_CD,
                                        ST1.CMT_SBJ_SNO,
                                        /* CMT_SBJ_DTL_SNO - 1 : 부의안, 2 : 부의안요약(보고자용), 3 : 부의안요약(원장용) 
                                           기타안건(CMT_SBJ_DVSN_CD:90)일 경우 1 로 대체*/
                                        DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,1), ST2.DOC_ID, NULL) AS REF_ID,
                                        DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,3), ST2.DOC_ID, NULL) AS DOC_ID,
                                        DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,2), ST2.DOC_ID, NULL) AS RPT_DOC_ID,
                                        DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,2), ST2.FILE_NM, NULL) AS RPT_RPRT_NM,
                                        DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,3), ST2.DOC_ID, NULL) AS BAICHF_DOC_ID,
                                        DECODE(ST2.CMT_SBJ_DTL_SNO, DECODE(ST2.CMT_SBJ_DVSN_CD,'90',1,3), ST2.FILE_NM, NULL) AS BAICHF_RPRT_NM,
                                        '' AS EDT_AUTH
                                      FROM TBBADDED121M ST1
                                           INNER JOIN TBBADDED122M ST2
                                           ON (ST1.CMT_DY = ST2.CMT_DY 
                                               AND ST1.CMT_DVSN_CD = ST2.CMT_DVSN_CD
                                               AND ST1.CMT_SQ = ST2.CMT_SQ
                                               AND ST1.CMT_SBJ_DVSN_CD = ST2.CMT_SBJ_DVSN_CD
                                               AND ST1.CMT_SBJ_SNO = ST2.CMT_SBJ_SNO)
                                     WHERE ST1.CMT_SBJ_DVSN_CD IN ('10','90')
                                    )
                                 GROUP BY CMT_DY, CMT_DVSN_CD, CMT_SQ, CMT_SBJ_DVSN_CD,CMT_SBJ_SNO) C
                      ON (A.CMT_DY = C.CMT_DY 
                          AND A.CMT_DVSN_CD = C.CMT_DVSN_CD
                          AND A.CMT_SQ = C.CMT_SQ
                          AND A.CMT_SBJ_DVSN_CD = C.CMT_SBJ_DVSN_CD
                          AND A.CMT_SBJ_SNO = C.CMT_SBJ_SNO)
               WHERE A.CMT_DY = REPLACE(#{cmtDy},'-')
                 AND A.CMT_DVSN_CD = #{cmtDvsnCd}
                 AND A.CMT_SQ = #{cmtSq}
                ) T
                WHERE T.CMT_DVSN_CD = '10'
                ORDER BY T.SBCN_PAGE_CNT, T.RAL_BLT_DIV_CD ASC, AUD_MAIN_STEP_SNO ASC
             ]]>
         <include refid="include.pageOrder" />
    </select>
    
    <insert id="insertBADDED120M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.insertBADDED120M*/
        INSERT INTO TBBADDED120M(CMT_DY,
                                 CMT_DVSN_CD,
                                 CMT_SQ,
                                 TIME_DVSN_CD,
                                 CMT_TIME,
                                 CMT_MIN,
                                 CMT_TIT,
                                 CHF_CMTR_ID,
                                 CMTR1_ID,
                                 CMTR2_ID,
                                 CMTR3_ID,
                                 CMTR4_ID,
                                 CMTR5_ID,
                                 CMTR6_ID,
                                 CMT_STR_TXT,
                                 CMT_END_TXT,
                                 CMT_END_YN,
                                 SBMT_DVSN_NO,
                                 FRT_USR_ID,
                                 FNL_USR_ID,
                                 FNL_DEAL_DPT_CD,
                                 FNL_MNU_ID,
                                 FRT_REGI_DH,
                                 FNL_MDF_DH)
                          VALUES(REPLACE(#{cmtDy},'-'),
                                 #{cmtDvsnCd},
                                 (SELECT NVL(MAX(CMT_SQ)+1,'1') AS SMT_SQ FROM TBBADDED120M WHERE CMT_DY LIKE SUBSTR(#{cmtDy}, 1, 4)||'%' AND CMT_DVSN_CD = #{cmtDvsnCd}),
                                 #{timeDvsnCd},
                                 #{cmtTime},
                                 #{cmtMin},
                                 #{cmtTit},
                                 #{topUsrId},
                                 #{subUsr1Id},
                                 #{subUsr2Id},
                                 #{subUsr3Id},
                                 #{subUsr4Id},
                                 #{subUsr5Id},
                                 #{subUsr6Id},
                                 #{cmtStrTxt1}||'|'||#{cmtStrTxt2}||'|'||#{cmtStrTxt3},
                                 #{cmtEndTxt1}||'|'||#{cmtEndTxt2}||'|'||#{cmtEndTxt3},
                                 'N',
                                 #{cmtDvsnSoCd},
                                 #{usrId},
                                 #{usrId},
                                 #{dptCd},
                                 #{menuNo},
                                 SYSDATE,
                                 SYSDATE)
    </insert>
    
    <insert id="insertBADDED121M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001Mapper.insertBADDED121M*/
        INSERT INTO TBBADDED121M(CMT_DY,
                                 CMT_DVSN_CD,
                                 CMT_SQ,
                                 CMT_SBJ_DVSN_CD,
                                 CMT_SBJ_SNO,
                                 CMT_SBJ_TIT,
                                 REL_DPT_CD,
                                 CMT_ADD_YN,
                                 DOC_ID,
                                 FILE_NM,
                                 FRT_USR_ID,
                                 FNL_USR_ID,
                                 FNL_DEAL_DPT_CD,
                                 FNL_MNU_ID,
                                 FRT_REGI_DH,
                                 FNL_MDF_DH)
                          VALUES(REPLACE(#{cmtDy},'-'),
                                 #{cmtDvsnCd},
                                 #{cmtSq},
                                 '90',
                                 (SELECT NVL(MAX(CMT_SBJ_SNO)+1,'1') FROM TBBADDED121M WHERE CMT_DY = REPLACE(#{cmtDy},'-') AND CMT_DVSN_CD = #{cmtDvsnCd} AND CMT_SQ = #{cmtSq}),
                                 #{cmtSbjTit},
                                 #{relDptCd},
                                 'Y',
                                 #{docId},
                                 #{fileNm},
                                 #{usrId},
                                 #{usrId},
                                 #{dptCd},
                                 #{menuNo},
                                 SYSDATE,
                                 SYSDATE)
    </insert>
    
    <insert id="insertBADDED123M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.insertBADDED123M*/
        INSERT INTO TBBADDED123M(CMT_DY,
                                 CMT_DVSN_CD,
                                 CMT_SQ,
                                 CMT_SBJ_DVSN_CD,
                                 CMT_SBJ_SNO,
                                 CMTR_SNO,
                                 CMTR_ID,
                                 FRT_USR_ID,
                                 FNL_USR_ID,
                                 FNL_DEAL_DPT_CD,
                                 FNL_MNU_ID,
                                 FRT_REGI_DH,
                                 FNL_MDF_DH)
                          VALUES(REPLACE(#{cmtDy},'-'),
                                 #{cmtDvsnCd},
                                 #{cmtSq},
                                 '90',
                                 1,
                                 (SELECT NVL(MAX(CMTR_SNO)+1,'1') AS SMT_SQ 
                                     FROM TBBADDED123M 
                                   WHERE CMT_DY = REPLACE(#{cmtDy},'-') 
                                        AND CMT_DVSN_CD = #{cmtDvsnCd}
                                        AND CMT_SQ = #{cmtSq}),
                                 #{cmtrId},
                                 #{usrId},
                                 #{usrId},
                                 #{dptCd},
                                 #{menuNo},
                                 SYSDATE,
                                 SYSDATE)
    </insert>
    
    <update id="updateBADDED120M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateBADDED120M*/
        UPDATE TBBADDED120M SET TIME_DVSN_CD    = #{timeDvsnCd},
                <if test="cmtDvsnCd != null and cmtDvsnCd !='' and cmtDvsnCd eq '30'.toString()">
                CMT_DY = REPLACE(#{cmtDy},'-'),
                </if>
                CMT_TIME        = #{cmtTime},
                CMT_MIN         = #{cmtMin},
                CMT_TIT         = #{cmtTit},
                CMT_STR_TXT     = #{cmtStrTxt1}||'|'||#{cmtStrTxt2}||'|'||#{cmtStrTxt3},
                CHF_CMTR_ID     = #{topUsrId},
                CMTR1_ID        = #{subUsr1Id},
                CMTR2_ID        = #{subUsr2Id},
                CMTR3_ID        = #{subUsr3Id},
                CMTR4_ID        = #{subUsr4Id},
                CMTR5_ID        = #{subUsr5Id},
                CMTR6_ID        = #{subUsr6Id},
                CMT_END_TXT     = #{cmtEndTxt1}||'|'||#{cmtEndTxt2}||'|'||#{cmtEndTxt3},
                FNL_USR_ID      = #{usrId},
                FNL_DEAL_DPT_CD = #{dptCd},
                FNL_MNU_ID      = #{menuNo},
                FNL_MDF_DH      = SYSDATE
          WHERE CMT_DY          = REPLACE(#{cmtDt},'-')
            AND CMT_DVSN_CD     = #{cmtDvsnCd}
            AND CMT_SQ          = #{cmtSq}
        <if test="sbmtDvsnNo != null and sbmtDvsnNo !='' and cmtDvsnCd eq '20'.toString()">
            AND SBMT_DVSN_NO = #{sbmtDvsnNo}
        </if>
    </update>
    
        <update id="updateBADDED121M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateBADDED121M*/
        UPDATE TBBADDED121M SET 
                                <if test="cmtDvsnCd != null and cmtDvsnCd !='' and cmtDvsnCd eq '30'.toString()">
                                CMT_DY = REPLACE(#{cmtDy},'-'),
                                </if>
                                <if test="docId == null or docId ==''">
                                DOC_ID = '',
                                </if>
                                <if test="fileNm == null or fileNm ==''">
                                FILE_NM = #{fileNm},
                                </if>
                                <if test="docId != null and docId !=''">
                                DOC_ID = #{docId},
                                </if>
                                <if test="fileNm != null and fileNm !=''">
                                FILE_NM = #{fileNm},
                                </if>
                                <if test="cmtSbjTit != null and cmtSbjTit !=''">
                                CMT_SBJ_TIT = #{cmtSbjTit},
                                </if>
                                <if test="relDptCd != null and relDptCd !=''">
                                REL_DPT_CD = #{relDptCd},
                                </if>
                                FNL_USR_ID = #{usrId},
                                FNL_DEAL_DPT_CD = #{dptCd},
                                FNL_MNU_ID = #{menuNo},
                                FNL_MDF_DH = SYSDATE
                          WHERE CMT_DY = REPLACE(#{cmtDt}, '-')
                            AND CMT_DVSN_CD = #{cmtDvsnCd}
                            AND CMT_SQ = #{cmtSq}

    </update>
        <update id="updateBADDED122M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateBADDED122M*/
        UPDATE TBBADDED122M SET 
                               <if test="cmtDvsnCd != null and cmtDvsnCd !='' and cmtDvsnCd eq '30'.toString()">
                                CMT_DY = REPLACE(#{cmtDy},'-'),
                                </if>
                                FNL_USR_ID = #{usrId},
                                FNL_DEAL_DPT_CD = #{dptCd},
                                FNL_MNU_ID = #{menuNo},
                                FNL_MDF_DH = SYSDATE
                          WHERE CMT_DY = REPLACE(#{cmtDt}, '-')
                               AND CMT_DVSN_CD     = #{cmtDvsnCd}
                               AND CMT_SQ          = #{cmtSq}


    </update>
     <update id="updateBADDED123M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateBADDED123M*/
        UPDATE TBBADDED123M SET 
                                 <if test="cmtDvsnCd != null and cmtDvsnCd !='' and cmtDvsnCd eq '30'.toString()">
                                CMT_DY = REPLACE(#{cmtDy},'-'),
                                </if>
                                FNL_USR_ID = #{usrId},
                                FNL_DEAL_DPT_CD = #{dptCd},
                                FNL_MNU_ID = #{menuNo},
                                FNL_MDF_DH = SYSDATE
                          WHERE CMT_DY = REPLACE(#{cmtDt}, '-')
                           AND CMT_DVSN_CD     = #{cmtDvsnCd}
                           AND CMT_SQ          = #{cmtSq}

    </update>
    
    <delete id="deleteBADDED120M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.deleteBADDED120M*/
        DELETE FROM TBBADDED120M WHERE CMT_DY      = REPLACE(#{cmtDt},'-')
                                   AND CMT_DVSN_CD = #{cmtDvsnCd}
                                   AND CMT_SQ      = #{cmtSq}
    </delete>
    
    <delete id="deleteBADDED121M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.deleteBADDED121M*/
        DELETE FROM TBBADDED121M WHERE CMT_DY          = REPLACE(#{cmtDy},'-')
                                   AND CMT_DVSN_CD     = #{cmtDvsnCd}
                                   AND CMT_SQ          = #{cmtSq}
                                   <if test="cmtSbjDvsnCd != null and cmtSbjDvsnCd != ''">
                                   AND CMT_SBJ_DVSN_CD = #{cmtSbjDvsnCd}
                                   </if>
                                   <if test="cmtSbjSno != null and cmtSbjSno != ''">
                                   AND CMT_SBJ_SNO     = #{cmtSbjSno}
                                   </if>
    </delete>
    
    <delete id="deleteBADDED122M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.deleteBADDED122M*/
        DELETE FROM TBBADDED122M WHERE CMT_DY          = REPLACE(#{cmtDy},'-')
                                   AND CMT_DVSN_CD     = #{cmtDvsnCd}
                                   AND CMT_SQ          = #{cmtSq}
                                   <if test="cmtSbjDvsnCd != null and cmtSbjDvsnCd != ''">
                                   AND CMT_SBJ_DVSN_CD = #{cmtSbjDvsnCd}
                                   </if>
                                   <if test="cmtSbjSno != null and cmtSbjSno != ''">
                                   AND CMT_SBJ_SNO     = #{cmtSbjSno}
                                   </if>
                                   <if test="cmtSbjDtlSno != null and cmtSbjDtlSno != ''">
                                   AND CMT_SBJ_DTL_SNO = #{cmtSbjDtlSno}
                                   </if>
    </delete>
    
    <delete id="deleteBADDED123M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.deleteBADDED123M*/
        DELETE FROM TBBADDED123M 
                   WHERE CMT_DY      = REPLACE(#{cmtDt},'-')
                        AND CMT_DVSN_CD = #{cmtDvsnCd}
                        AND CMT_SQ      = #{cmtSq}
    </delete>
    
    <delete id="deleteBADDED103M" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.deleteBADDED103M*/
        DELETE FROM TBBADDED103M 
                   WHERE AUD_YR     = #{audYr}
                        AND AUD_NO    = #{audNo}
                        AND REF_DY      = REPLACE(#{cmtDy},'-')
                        AND RPRT_CD IN ('A10700500','A10700600','A10700800','A10700700')
    </delete>
    
    <select id="selectTmpId" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectTmpId*/
        SELECT DOC_ID FROM TBBADDED103M WHERE AUD_YR  = #{audYr}
                                          AND AUD_NO  = #{audNo}
                                          AND REF_DY  = REPLACE(#{cmtDy},'-')
                                          AND RPRT_CD = 'A10700600'
    </select>
    
    <select id="selectRefId" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectRefId*/
        SELECT DOC_ID FROM TBBADDED103M WHERE AUD_YR  = #{audYr}
                                          AND AUD_NO  = #{audNo}
                                          AND REF_DY  = REPLACE(#{cmtDy},'-')
                                          AND RPRT_CD = 'A10700500'
    </select>
    
    <select id="selectWtAgdData" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectWtAgdData*/
        SELECT 
            CMT_SBJ_TIT
            , REL_DPT_CD
            , F_DPT_INFO(REL_DPT_CD,'1') AS REL_DPT_NM
            , DOC_ID
            , FILE_NM
            , CMT_SBJ_SNO
          FROM TBBADDED121M
         WHERE CMT_DY = REPLACE(#{cmtDy},'-')
           AND CMT_DVSN_CD = #{cmtDvsnCd}
           AND CMT_SQ = #{cmtSq}
    </select>
    
    <select id="selectWtAgdVtCnt" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectWtAgdVtCnt*/
        SELECT 
            NVL(SUM(DECODE(CMTR_SBCN_YN,'N',1,DECODE(CMTR_SBCN_YN,'Y',1,0))),0) AS CMTR_SBCN_CNT
          FROM TBBADDED123M
         WHERE CMT_DY = REPLACE(#{cmtDy},'-')
           AND CMT_DVSN_CD = #{cmtDvsnCd}
           AND CMT_SQ = #{cmtSq}
    </select>
   
   <select id="selectCmptSnoYn" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectCmptSnoYn*/
    SELECT 
        COUNT(1) AS BEF_CMT_CNT,    /* 이전회차 회의 COUNT */
        NVL(SUM(DECODE(SBCN_SNO, NULL, 1, 0)),0) AS BEF_SBCN_NULL_CNT   /* 이전회차 회의 중 부의면수가 안따진 회의 COUNT */
          FROM (
                SELECT SBCN_PAGE_CNT AS SBCN_SNO
                  FROM TBBADDED113M
                 WHERE SBCN_DY = (SELECT MIN(CMT_DY)
                                    FROM TBBADDED120M
                                   WHERE CMT_SQ = #{cmtSq}-1
                                     AND CMT_DVSN_CD = '10'
                                     AND SUBSTR(CMT_DY,0,4) = SUBSTR( REPLACE(#{cmtDy},'-'),0,4))
                UNION ALL
                SELECT SBCN_PAGE_CNT AS SBCN_SNO
                  FROM TBBADFRE113M
                 WHERE SBCN_DY = (SELECT MIN(CMT_DY)
                                    FROM TBBADDED120M
                                   WHERE CMT_SQ = #{cmtSq}-1
                                     AND CMT_DVSN_CD = '10'
                                     AND SUBSTR(CMT_DY,0,4) = SUBSTR( REPLACE(#{cmtDy},'-'),0,4))
                UNION ALL
                SELECT SBCN_SNO AS SBCN_SNO
                  FROM TBBADDED121M
                 WHERE CMT_SQ = #{cmtSq}-1
                   AND CMT_DVSN_CD = '10'
                   AND SUBSTR(CMT_DY,0,4) = SUBSTR( REPLACE(#{cmtDy},'-'),0,4) 
               )
    </select>
   
    <select id="selectMaxSbcnSno" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectMaxSbcnSno*/
    SELECT MAX(MAX_SNO) AS MAX_SNO, MAX(MAX_SBCN_SNO) AS MAX_SBCN_SNO
      FROM (
            SELECT NVL(MAX(SBCN_SNO),0) + 1 AS MAX_SNO, 0 AS MAX_SBCN_SNO
              FROM TBBADDED121M
             WHERE 1=1
               AND CMT_SQ <![CDATA[<]]>= #{cmtSq}-1
               AND CMT_DVSN_CD = '10'
               AND SUBSTR(CMT_DY,0,4) = SUBSTR( REPLACE(#{cmtDy},'-'),0,4)    
            UNION 
            SELECT NVL(MAX(SBCN_PAGE_CNT),0) + 1 AS MAX_SNO, NVL(MAX(SBCN_NO),0) + 1 AS MAX_SBCN_SNO
              FROM TBBADDED113M
             WHERE 1=1
               AND SUBSTR(SBCN_DY,0,4) = SUBSTR( REPLACE(#{cmtDy},'-'),0,4)    
               AND SBCN_DY <![CDATA[<]]>= (SELECT MIN(CMT_DY)
                                FROM TBBADDED120M
                               WHERE 1=1
                                 AND CMT_SQ = #{cmtSq}-1
                                 AND CMT_DVSN_CD = '10'
                                 AND SUBSTR(CMT_DY,0,4) = SUBSTR( REPLACE(#{cmtDy},'-'),0,4))
            UNION 
            SELECT NVL(MAX(SBCN_PAGE_CNT),0) + 1 AS MAX_SNO, NVL(MAX(SBCN_NO),0) + 1 AS MAX_SBCN_SNO
              FROM TBBADFRE113M
             WHERE 1=1
               AND (ACP_YR, ACP_DVSN_CD, ACP_SRNO) IN (SELECT NVL(A.MG_ACP_YR, A.ACP_YR), NVL(A.MG_ACP_DVSN_CD, A.ACP_DVSN_CD), NVL(A.MG_ACP_SRNO, A.ACP_SRNO) 
                                                         FROM TBBADFRE012M A
                                                   INNER JOIN TBBADFRE113M B ON (B.ACP_YR = A.ACP_YR AND B.ACP_DVSN_CD = A.ACP_DVSN_CD AND B.ACP_SRNO = B.ACP_SRNO))
               AND SUBSTR(SBCN_DY,0,4) = SUBSTR( REPLACE(#{cmtDy},'-'),0,4)    
               AND SBCN_DY <![CDATA[<]]>= (SELECT MIN(CMT_DY)
                                FROM TBBADDED120M
                               WHERE 1=1
                                 AND CMT_SQ = #{cmtSq}-1
                                 AND CMT_DVSN_CD = '10'
                                 AND SUBSTR(CMT_DY,0,4) = SUBSTR( REPLACE(#{cmtDy},'-'),0,4)))
    </select>

    <update id="updateTBBADDED120MSbcnSno" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateTBBADDED120MSbcnSno*/
        UPDATE TBBADDED121M
              SET SBCN_SNO = #{sbcnSno}
                  , FNL_USR_ID = #{usrId}
                  , FNL_DEAL_DPT_CD = #{dptCd}
                  , FNL_MDF_DH = SYSDATE
            WHERE CMT_DY = REPLACE(#{cmtDy},'-')
              AND CMT_DVSN_CD = #{cmtDvsnCd}
              AND CMT_SQ = #{cmtSq}
              AND CMT_SBJ_DVSN_CD = #{cmtSbjDvsnCd}
              AND CMT_SBJ_SNO = #{cmtSbjSno}
    </update>
    
    
    <update id="updateTBBADDED113MSbcnPageSno" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateTBBADDED113MSbcnPageSno*/
        UPDATE TBBADDED113M
              SET SBCN_NBC =  #{cmtSq}
                  , SBCN_PAGE_CNT = #{sbcnSno}
                  , FNL_USR_ID = #{usrId}
                  , FNL_DEAL_DPT_CD = #{dptCd}
                  , FNL_MDF_DH = SYSDATE
            WHERE SBCN_DY = REPLACE(#{cmtDy},'-')
              AND AUD_YR = #{audYr}
              AND AUD_NO = #{audNo}
              AND SBCN_REGI_REQ_DT = #{sbcnRegiReqDt}
    </update>
    
    <update id="updateTBBADFRE113MSbcnPageSno" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateTBBADFRE113MSbcnPageSno*/
        UPDATE TBBADFRE113M
              SET SBCN_NBC =  #{cmtSq}
                  , SBCN_PAGE_CNT = #{sbcnSno}
                  , FNL_USR_ID = #{usrId}
                  , FNL_DEAL_DPT_CD = #{dptCd}
                  , FNL_MDF_DH = SYSDATE
            WHERE SBCN_DY = REPLACE(#{cmtDy},'-')
              AND (ACP_YR, ACP_DVSN_CD, ACP_SRNO) IN (SELECT ACP_YR, ACP_DVSN_CD, ACP_SRNO 
                                                        FROM TBBADFRE012M 
                                                       WHERE NVL(MG_ACP_YR, ACP_YR) = #{audYr}
                                                         AND NVL(MG_ACP_DVSN_CD, ACP_DVSN_CD) = #{audKndCd}
                                                         AND NVL(MG_ACP_SRNO, ACP_SRNO) = #{audNo})
              AND SBCN_REGI_REQ_DT = #{sbcnRegiReqDt}
    </update>
    
    <select id="selectSbcnList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectSbcnList*/
        SELECT 
            AUD_YR
            ,AUD_NO
            ,DOC_ID
            ,APVR_CD
            ,AFF_SNO
            ,DSP_RQ_SNO
            ,SBCN_REGI_REQ_DT 
           FROM TBBADDED113M
         WHERE SBCN_DY = REPLACE(#{cmtDy},'-')
              AND AUD_YR = #{audYr}
              AND AUD_NO = #{audNo}
              AND SBCN_REGI_REQ_DT = #{sbcnRegiReqDt}
              AND DOC_ID = #{refDocId}
         ORDER BY SORT_SNO
    </select>
    
    <select id="selectExcelList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectExcelList*/	
    	SELECT  	T.TITLE --의결사항명
             	,F_DPT_INFO(T.DPT_CD,'1')  AS DPT_NM --부서명
              	,NVL(F_CODE_NM('1000787', T.WRK_DVSN_CD), '기타안건') AS WRK_DVSN_NM  --업무구분명
             	,NVL(TO_CHAR(T.REGI_NO),' ') AS  REGI_NO
              	,NVL(TO_CHAR(T.SBCN_PAGE_CNT),' ') AS SBCN_PAGE_CNT --부의면수
              	,NVL(TO_CHAR(T.AUD_YR_NO),' ') AS AUD_YR_NO --분류번호
              	,NVL(TO_CHAR(T.AUD_YR),' ') AS AUD_YR  --년도
              	,NVL(TO_CHAR(T.AUD_NO),' ') AS AUD_NO  --번호
              	,NVL(T.WRK_DVSN_CD,' ')AS WRK_DVSN_CD  --업무구분코드
              	,NVL(T.DPT_CD,' ') AS DPT_CD  --부서코드
              	,NVL(T.AUD_KND_CD,' ') AS AUD_KND_CD   --감사종류
              	,T.CMT_DY  --회의일자
              	,'제'||T.CMT_SQ||'회 '||T.CMT_TIT AS CMT_TIT  --회의제목
      	FROM
          	(
          	SELECT 	F_MNG_KND_AUDYRNO(D.AUD_YR, D.AUD_NO, D.AUD_KND_CD, '-') AS AUD_YR_NO
                     ,D.AUD_SBJ_NM AS TITLE
                     ,A.SBCN_PAGE_CNT  AS SBCN_PAGE_CNT
                     ,D.MNG_DPT_CD AS DPT_CD
                     ,D4.CMT_DY   AS CMT_DY
                     ,'10'  AS CMT_DVSN_CD
                     ,TO_CHAR(D4.CMT_SQ)  AS CMT_SQ
                     ,D.AUD_YR  AS AUD_YR
                     ,D.AUD_NO  AS AUD_NO
                     ,D.AUD_KND_CD  AS AUD_KND_CD
                     ,A.SBCN_REGI_REQ_DT AS SBCN_REGI_REQ_DT
                     ,'실지감사' AS WRK_DVSN_NM
                     ,'A10' AS WRK_DVSN_CD              
                     ,(SELECT REGI_NO 
                         FROM TBBADDED112D ST1
                       WHERE ST1.AUD_YR = A.AUD_YR
                            AND ST1.AUD_NO = A.AUD_NO
                            AND ST1.DOC_ID = A.DOC_ID) AS REGI_NO,
                      D4.CMT_TIT
                FROM TBBADDED113M AS A
                     INNER JOIN TBBADDED001M AS D 
                     ON (A.AUD_YR   = D.AUD_YR AND A.AUD_NO = D.AUD_NO)
                     LEFT OUTER JOIN TBBADDED120M D4 
                     ON (D4.CMT_DY = A.SBCN_DY  AND D4.CMT_DVSN_CD = #{cmtDvsnCd} ) -- 회의구분코드 PARAMETER
               WHERE A.SBCN_DY = REPLACE(#{cmtDy},'-')  --회의일자 PARAMETER
                 AND A.SBCN_DY IS NOT NULL
            GROUP BY D.AUD_YR, D.AUD_NO, D.AUD_KND_CD, D.AUD_SBJ_NM, D.MNG_DPT_CD, A.SBCN_PAGE_CNT, A.SBCN_REGI_REQ_DT
                    , A.AUD_YR, A.AUD_NO, D4.CMT_DY , D4.CMT_SQ, A.DOC_ID, D4.CMT_TIT
           UNION ALL
           SELECT  A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD, '1', '심사', '재심') || '-' || TO_CHAR(A.ACP_SRNO)AS AUD_YR_NO
                     , (SELECT TIT_NM FROM TBBADFRE112M WHERE ACP_YR = A.ACP_YR AND ACP_DVSN_CD = A.ACP_DVSN_CD AND ACP_SRNO = A.ACP_SRNO) AS TITLE,
                     A.SBCN_PAGE_CNT                   AS SBCN_PAGE_CNT,
                     (SELECT DPT_CD FROM TBBADFRE012M WHERE ACP_YR = A.ACP_YR AND ACP_DVSN_CD = A.ACP_DVSN_CD AND ACP_SRNO = A.ACP_SRNO) AS DPT_CD,
                     D4.CMT_DY                         AS CMT_DY,
                     '10'                              AS CMT_DVSN_CD,
                     TO_CHAR(D4.CMT_SQ)                AS CMT_SQ,
                     A.ACP_YR                          AS AUD_YR,
                     TO_CHAR(A.ACP_SRNO)                          AS AUD_NO,
                     A.ACP_DVSN_CD                      AS AUD_KND_CD,
                     A.SBCN_REGI_REQ_DT                AS SBCN_REGI_REQ_DT,
                     DECODE(A.ACP_DVSN_CD,'1','심사','2','재심') AS WRK_DVSN_NM,
                     DECODE(A.ACP_DVSN_CD,'1','D10','2','E10') AS WRK_DVSN_CD,                     
                     (SELECT REGI_NO 
                         FROM TBBADFRE112D ST1
                       WHERE ST1.ACP_YR = A.ACP_YR
                            AND ST1.ACP_DVSN_CD = A.ACP_DVSN_CD
                            AND ST1.ACP_SRNO = A.ACP_SRNO
                            AND ST1.DOC_ID = A.DOC_ID) AS REGI_NO,
                      D4.CMT_TIT
                FROM TBBADFRE113M AS A
                     INNER JOIN TBBADFRE012M AS D 
                     ON (A.ACP_YR   = NVL(D.MG_ACP_YR, D.ACP_YR) AND A.ACP_SRNO = NVL(D.MG_ACP_SRNO, D.ACP_SRNO) AND A.ACP_DVSN_CD = NVL(D.ACP_DVSN_CD, D.ACP_DVSN_CD))
                     LEFT OUTER JOIN TBBADDED120M D4 
                     ON (D4.CMT_DY = A.SBCN_DY AND D4.CMT_DVSN_CD = #{cmtDvsnCd}) -- 회의구분코드 PARAMETER
               WHERE A.SBCN_DY = REPLACE(#{cmtDy},'-')   --회의일자 PARAMETER
                 AND A.SBCN_DY IS NOT NULL
            GROUP BY A.ACP_YR, A.ACP_SRNO, A.ACP_DVSN_CD, A.SBCN_PAGE_CNT, A.SBCN_REGI_REQ_DT
                    , A.ACP_YR, A.ACP_SRNO,A.ACP_DVSN_CD, D4.CMT_DY , D4.CMT_SQ,  A.DOC_ID, D4.CMT_TIT
               UNION ALL
               SELECT DECODE(A.WORK_DVSN_CD,'D10',   REL_AUD_YR||'-심사-'||REL_AUD_NO   /* 심사청구 */
                                                                        ,'E10',REL_AUD_YR||'-재심-'||REL_AUD_NO   /* 재심의청구 */
                                                                        ,'A10',  (SELECT F_MNG_KND_AUDYRNO(ST1.AUD_YR, ST1.AUD_NO, ST1.AUD_KND_CD, '-')
                                                                                            FROM TBBADDED001M ST1
                                                                                          WHERE ST1.AUD_YR = A.REL_AUD_YR
                                                                                               AND ST1.AUD_NO = A.REL_AUD_NO))  AS AUD_YR_NO,                   
                    DECODE(A.REL_TSK_NM,  NULL, A.CMT_SBJ_TIT) AS TITLE,
                     A.SBCN_SNO               AS SBCN_PAGE_CNT,       
                     A.REL_DPT_CD AS DPT_CD,            
                     A.CMT_DY                      AS CMT_DY,
                     A.CMT_DVSN_CD                 AS CMT_DVSN_CD,
                     TO_CHAR(A.CMT_SQ)             AS CMT_SQ,
                     A.REL_AUD_YR                  AS AUD_YR,
                     A.REL_AUD_NO                  AS AUD_NO,
                     ''                            AS AUD_KND_CD,
                     ''                            AS SBCN_REGI_REQ_DT,
                     DECODE(A.WORK_DVSN_CD,'A10','실지감사'
                                          ,'D10','심사청구'
                                          ,'E10','재심의청구'
                                          ,'Z90','기타안건','기타안건') AS WRK_DVSN_NM,
                     A.WORK_DVSN_CD,
                     A.REGI_NO,
                    D4.CMT_TIT
                FROM TBBADDED121M AS A  
                LEFT OUTER JOIN TBBADDED120M D4 
                     ON (D4.CMT_DY = A.CMT_DY AND D4.CMT_DVSN_CD = #{cmtDvsnCd})  -- 회의구분코드 PARAMETER
               WHERE A.CMT_DY = REPLACE(#{cmtDy},'-')   --회의일자 PARAMETER
                 AND A.CMT_DVSN_CD = #{cmtDvsnCd}  -- 회의구분코드 PARAMETER
                 AND A.CMT_SQ = #{cmtSq}  --회의회차 PARAMETER
                ) T
                WHERE T.CMT_DVSN_CD = #{cmtDvsnCd} -- 회의구분코드 PARAMETER
                ORDER BY T.SBCN_PAGE_CNT ASC
                
    </select>
    
    <select id="selectSbcnListEtc" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectSbcnListEtc*/
        SELECT 
            ACP_YR
            ,ACP_SRNO
            ,DOC_ID
            ,APVR_CD
            ,AFF_SNO
            ,DSP_RQ_SNO
            ,SBCN_REGI_REQ_DT 
           FROM TBBADFRE113M
          WHERE SBCN_DY = REPLACE(#{cmtDy},'-')
            AND (ACP_YR, ACP_DVSN_CD, ACP_SRNO) IN (SELECT ACP_YR, ACP_DVSN_CD, ACP_SRNO 
                                                        FROM TBBADFRE012M 
                                                       WHERE NVL(MG_ACP_YR, ACP_YR) = #{audYr}
                                                         AND NVL(MG_ACP_DVSN_CD, ACP_DVSN_CD) = #{audKndCd}
                                                         AND NVL(MG_ACP_SRNO, ACP_SRNO) = #{audNo})
            AND SBCN_REGI_REQ_DT = #{sbcnRegiReqDt}
         ORDER BY SORT_SNO
    </select>
    
    <update id="updateTBBADDED113MSbcnSno" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateTBBADDED113MSbcnSno*/
        UPDATE TBBADDED113M
           SET SBCN_NO = #{sbcnSno}
             , FNL_USR_ID = #{usrId}
             , FNL_DEAL_DPT_CD = #{dptCd}
             , FNL_MDF_DH = SYSDATE
         WHERE AUD_YR = #{audYr}
           AND AUD_NO = #{audNo}
           AND DOC_ID = #{docId}
           AND APVR_CD = #{apvrCd}
           AND AFF_SNO = #{affSno}
           AND DSP_RQ_SNO = #{dspRqSno}
           AND SBCN_REGI_REQ_DT =  #{sbcnRegiReqDt}
    </update>
    
    <update id="updateTBBADFRE113MSbcnSno" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateTBBADFRE113MSbcnSno*/
        UPDATE TBBADFRE113M
           SET SBCN_NO = #{sbcnSno}
             , FNL_USR_ID = #{usrId}
             , FNL_DEAL_DPT_CD = #{dptCd}
             , FNL_MDF_DH = SYSDATE
         WHERE ACP_YR = #{acpYr}
           AND ACP_SRNO = #{acpSrno}
           AND APVR_CD = #{apvrCd}
           AND AFF_SNO = #{affSno}
           AND DSP_RQ_SNO = #{dspRqSno}
           AND SBCN_REGI_REQ_DT =  #{sbcnRegiReqDt}
    </update>
    
    <update id="updateEdtAuth" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateEdtAuth*/
        UPDATE TBBADDED103M SET EDT_AUTH    = #{edtAuth},
                                APV_STA_CD = #{apvStaCd},
                                FNL_USR_ID      = #{usrId},
                                FNL_DEAL_DPT_CD = #{dptCd},
                                FNL_MNU_ID      = #{menuNo},
                                FNL_MDF_DH      = SYSDATE
                          WHERE AUD_YR          = #{audYr}
                            AND AUD_NO     = #{audNo}
                            AND DOC_ID      IN (#{baichfDocId}, #{rptDocId}, #{refId})
    </update>
    
    <update id="updateEdtAuthEtc" parameterType="paramMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.updateEdtAuthEtc*/
        UPDATE TBBADFRE103M SET EDT_AUTH    = #{edtAuth},
                                APV_STA_CD = #{apvStaCd},
                                FNL_USR_ID      = #{usrId},
                                FNL_DEAL_DPT_CD = #{dptCd},
                                FNL_MNU_ID      = #{menuNo},
                                FNL_MDF_DH      = SYSDATE
                          WHERE ACP_YR          = #{audYr}
                            AND ACP_SRNO     = #{audNo}
                            AND ACP_DVSN_CD     = #{audKndCd}
                            AND DOC_ID      IN (#{baichfDocId}, #{rptDocId}, #{refId})
    </update>
    
    <update id="updateEdtAuthEH_INF_CM_CM_001" parameterType="paramMap">
    /*kr.go.bai.eip.aep.cam.dao.AEPOSM001EMapper.updateEdtAuthEH_INF_CM_CM_001*/
		MERGE INTO EH_INF_CM_CM_001 A
			USING
				(
				SELECT
					T1.AUD_YR AS RECEV_DY
					, T1.IMMUN_SRNO AS IMMUN_SRNO
				FROM TBCSPKDE103M T1
				WHERE T1.AUD_YR = #{audYr}
				AND T1.AUD_NO = #{audNo}
				) B
		    ON  (A.CMM_COL1 = B.RECEV_DY
		    	AND A.CMM_COL3 = TO_CHAR(B.IMMUN_SRNO)
		    	AND A.FLAG != 'D'
		    	AND A.DVSN_CD = 'SOMYUNG')
		WHEN MATCHED THEN 
			UPDATE SET A.CMM_COL7 = '50'		-- 처리완료
					 , A.FNL_MDF_DH = SYSDATE
    </update>
    
    <select id="selectSoCodeList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper."selectSoCodeList"*/
        SELECT DISTINCT SBMT_DVSN_NO AS CD
             , SBMT_DVSN_NO||'소위'   AS CD_NM
  		  FROM TBBADDED116M
  		ORDER BY CD
    </select>
    
    <select id="selectAgoraList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM001EMapper.selectAgoraList*/
            <![CDATA[
            SELECT DECODE(B.SBCN_DY, NULL, '없음', TO_CHAR(TO_DATE(B.SBCN_DY), 'YYYY-MM-DD')) AS SBCN_DY
			     , DECODE(C.SBMT_FIX_DT, NULL, '없음', TO_CHAR(TO_DATE(C.SBMT_FIX_DT), 'YYYY-MM-DD')) AS SBMT_FIX_DT
			     , NVL((SELECT DECODE(NVL(EDT_AUTH, 'Y'), 'Y', '마감 전', '마감 후') AS EDT_AUTH
		              FROM TBBADDED103M
		             WHERE AUD_YR = D.AUD_YR
		               AND AUD_NO = D.AUD_NO
		               AND DECODE(D.RPRT_CD, 'A10700200', REF_DOC_ID, 'A10700210', REF_DOC_ID, 'A10700220', REF_DOC_ID, 'A10700230', REF_DOC_ID, REF_ID)
		                 = DECODE(D.RPRT_CD, 'A10700200', D.DOC_ID, 'A10700210', D.REF_DOC_ID, 'A10700220', D.REF_DOC_ID, 'A10700230', D.REF_DOC_ID, 'A10700500', D.DOC_ID, D.REF_ID)
		               AND RPRT_CD IN ('A10700220', 'A10700700')), '없음') AS EDT_AUTH
			  FROM TBBADDED001M A
			 LEFT OUTER JOIN TBBADDED113M B ON (B.AUD_YR   = A.AUD_YR AND B.AUD_NO = A.AUD_NO)
			 LEFT OUTER JOIN TBBADDED114M C ON (C.AUD_YR   = A.AUD_YR AND C.AUD_NO = A.AUD_NO)
			 LEFT OUTER JOIN TBBADDED103M D ON (D.AUD_YR   = A.AUD_YR AND D.AUD_NO = A.AUD_NO)
			 WHERE A.AUD_YR = #{audYr}
			   AND A.AUD_NO = #{audNo}
			   AND D.DOC_ID = #{docId}
			 UNION ALL
			SELECT DECODE(B.SBCN_DY, NULL, '없음', TO_CHAR(TO_DATE(B.SBCN_DY), 'YYYY-MM-DD')) AS SBCN_DY
			     , DECODE(C.SBMT_FIX_DT, NULL, '없음', TO_CHAR(TO_DATE(C.SBMT_FIX_DT), 'YYYY-MM-DD')) AS SBMT_FIX_DT
			     , NVL((SELECT DECODE(NVL(EDT_AUTH, 'Y'), 'Y', '마감 전', '마감 후') AS EDT_AUTH
			          FROM TBBADFRE103M
			         WHERE ACP_YR = D.ACP_YR
			           AND ACP_DVSN_CD = D.ACP_DVSN_CD
			           AND ACP_SRNO = D.ACP_SRNO
			           AND REF_ID =  DECODE(D.RPRT_CD, 'D10300500', D.DOC_ID, 'E10300200', D.DOC_ID, NVL(D.REF_ID, D.DOC_ID))
			           AND RPRT_CD IN ('D10301110', 'D10300610', 'E10300310', 'E10500610')), '없음') AS EDT_AUTH
			  FROM TBBADFRE012M A
			 LEFT OUTER JOIN TBBADFRE113M B ON (B.ACP_YR = A.ACP_YR AND B.ACP_DVSN_CD = A.ACP_DVSN_CD AND B.ACP_SRNO = A.ACP_SRNO)
			 LEFT OUTER JOIN TBBADFRE114M C ON (C.ACP_YR = A.ACP_YR AND C.ACP_DVSN_CD = A.ACP_DVSN_CD AND C.ACP_SRNO = A.ACP_SRNO)
			 LEFT OUTER JOIN TBBADFRE103M D ON (D.ACP_YR = A.ACP_YR AND D.ACP_DVSN_CD = A.ACP_DVSN_CD AND D.ACP_SRNO = A.ACP_SRNO)
			 WHERE A.ACP_YR = #{audYr}
			   AND D.DOC_ID = #{docId}
             ]]>
    </select>
    
</mapper>