<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.go.bai.eip.aep.frs.dao.AEPFRS003PMapper">

	<!-- 포렌식 대상 순번 -->
    <select id="getMaxFrsSno" parameterType="paramMap" resultType="String">
        SELECT TO_CHAR(NVL(MAX(FRS_TG_SRNO),0) + 1) AS MAX_FRS_TG_SRNO
         FROM TBAEPFRS102M
        WHERE 1=1
          AND AUD_YR = #{audYr}
          AND AUD_NO = #{audNo}
          AND FRS_REQ_SRNO = #{frsReqSrno}
    </select>

	<!-- 포렌식 매체 순번 -->
    <select id="getMaxFrsDtlSno" parameterType="paramMap" resultType="String">
        SELECT TO_CHAR(NVL(MAX(SRNO),0) + 1) AS MAX_SRNO
         FROM TBAEPFRS102D
        WHERE 1=1
          AND AUD_YR = #{audYr}
          AND AUD_NO = #{audNo}
          AND FRS_REQ_SRNO = #{frsReqSrno}
          AND FRS_TG_SRNO = #{frsTgSrno}
    </select>
    
    <!-- 포렌식 대상 엑셀일괄등록 -->
    <insert id="insertFrsExcel" parameterType="paramMap">
    /* kr.go.bai.eip.aep.frs.dao.AEPFRS003PMapper.insertFrsExcel */
        INSERT INTO TBAEPFRS102M(  AUD_YR
                                 , AUD_NO
                                 , FRS_REQ_SRNO
                                 , FRS_TG_SRNO
                                 , FRS_TG
                                 , ORG_NM
                                 , DPT_NM
                                 , FRS_CLC_DT
                                 , FRT_USR_ID
                                 , FNL_USR_ID
                                 , FNL_DEAL_DPT_CD
                                 , FNL_MNU_ID
                                 , FRT_REGI_DH
                                 , FNL_MDF_DH  )
                          VALUES ( #{audYr}
                                 , #{audNo}
                                 , #{frsReqSrno}
                                 , #{frsTgSrno}
                                 , #{frsTg}
                                 , #{orgNm}
                                 , #{dptNm}
                                 , #{frsClcDt}
                                 , #{frtUsrId}
                                 , #{fnlUsrId}
                                 , #{fnlDealDptCd}
                                 , #{fnlMnuId}
                                 , SYSDATE
                                 , SYSDATE )
    </insert>    
    
    <!-- 포렌식 매체 엑셀일괄등록 -->
    <insert id="insertFrsDtlExcel" parameterType="paramMap">
    /* kr.go.bai.eip.aep.frs.dao.AEPFRS003PMapper.insertFrsDtlExcel */
        INSERT INTO TBAEPFRS102D(  AUD_YR
                                 , AUD_NO
                                 , FRS_REQ_SRNO
                                 , FRS_TG_SRNO
                                 , SRNO
                                 , FRS_DT
                                 , FRS_TYPE_CD
                                 , USR_TYPE
                                 , MDM_ETP
                                 , MDM_SRNO
                                 , MDM_MD
                                 , MDM_CPT
                                 , USR_TNB
                                 , USR_ACCT
                                 , USIM
                                 , EXTL_DRIV
                                 , RMK_TXT
                                 , FRT_USR_ID
                                 , FNL_USR_ID
                                 , FNL_DEAL_DPT_CD
                                 , FNL_MNU_ID
                                 , FRT_REGI_DH
                                 , FNL_MDF_DH  )
                          VALUES ( #{audYr}
                                 , #{audNo}
                                 , #{frsReqSrno}
                                 , #{frsTgSrno}
                                 , #{srno}
                                 , #{frsDt}
                                 , #{frsTypeCd}
                                 , #{usrType}
                                 , #{mdmEtp}
                                 , #{mdmSrno}
                                 , #{mdmMd}
                                 , #{mdmCpt}
                                 , #{usrTnb}
                                 , #{usrAcct}
                                 , #{usim}
                                 , #{extlDriv}
                                 , #{rmkTxt}
                                 , #{frtUsrId}
                                 , #{fnlUsrId}
                                 , #{fnlDealDptCd}
                                 , #{fnlMnuId}
                                 , SYSDATE
                                 , SYSDATE )
    </insert>	
   
</mapper>