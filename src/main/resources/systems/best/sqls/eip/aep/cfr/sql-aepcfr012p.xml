<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.cfr.dao.AEPCFR012PMapper">

    <select id="selectMaxIfStrDh" parameterType="paramMap" resultType="string">
        /*kr.go.bai.eip.aep.cfr.dao.AEPCFR012PMapper.selectMaxIfStrDh*/
        SELECT NVL(TO_CHAR(MAX(IF_STR_DH),'YYYYMMDDHH24MI'), '0')
          FROM EA_INF_CMT_RSLT_INFO
         WHERE 1 = 1
           AND TBL_NM = #{tblNm};
    </select>
    
     <select id="selectTBBADDED113M" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.aep.cfr.dao.AEPCFR012PMapper.selectTBBADDED113M*/
        <include refid="include.pageSelct" />
     <![CDATA[     
          SELECT   
		         B.IF_CHNG_STAT_DVSN
		       , B.AUD_YR_NO
		       , B.AFF_SNO
		       , B.DSP_RQ_SNO
		       , B.SBCN_REGI_REQ_DT
		       , B.SBCN_NBC
		       , B.SBCN_DY
		       , B.SBCN_PAGE_CNT
		       , B.SBCN_NO
		       , B.SBCN_PRSS_DPT_NM
		       , B.TBL_NM
		    FROM
			   (
		            SELECT 
		                   CASE WHEN TO_CHAR(FRT_REGI_DH, 'YYYYMMDDHH24MISS') > #{maxIfStrDh} then 'I'
		                        WHEN TO_CHAR(FNL_MDF_DH,'YYYYMMDDHH24MISS') > #{maxIfStrDh} then 'U'
		                        ELSE 'E'
		                   END IF_CHNG_STAT_DVSN
		                 , F_MNG_KND_AUDYRNO(A.AUD_YR, A.AUD_NO, A.AUD_KND_CD, '-') AS AUD_YR_NO    --분류번호
						 , A.AFF_SNO
					     , A.DSP_RQ_SNO
					     , TO_CHAR(TO_DATE(A.SBCN_REGI_REQ_DT), 'YYYY-MM-DD') AS SBCN_REGI_REQ_DT
		                 , A.SBCN_NBC
					     , TO_CHAR(TO_DATE(A.SBCN_DY), 'YYYY-MM-DD') AS SBCN_DY
		                 , A.SBCN_PAGE_CNT
		                 , A.SBCN_NO
		                 , A.SBCN_PRSS_DPT_NM
		                 , 'TBBADDED113M' AS TBL_NM
		             FROM TBBADDED113M A
		            WHERE 1=1
		              AND TO_CHAR(FNL_MDF_DH, 'YYYYMMDDHH24MI') >  #{maxIfStrDh}
	            ) B   
	            WHERE 1=1
       ]]>
		        <if test='maxIfStrDh != "0"'>
		          AND B.IF_CHNG_STAT_DVSN = 'U'  
		        </if>
	            ORDER BY B.AFF_SNO, B.DSP_RQ_SNO   
        <include refid="include.pageOrder" />
    </select>
    
    <select id="selectTBBADDED120M" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.aep.cfr.dao.AEPCFR012PMapper.selectTBBADDED120M*/
        <include refid="include.pageSelct" />
     <![CDATA[     
          SELECT   
		         B.IF_CHNG_STAT_DVSN
		       , B.CMT_DY
		       , B.CMT_SQ
		       , B.CMT_DY_NM
		       , B.CMT_TIT
		       , B.CMT_END_DH
		       , B.TBL_NM
		    FROM
		         (
		            SELECT 
		                   CASE WHEN TO_CHAR(FRT_REGI_DH, 'YYYYMMDDHH24MISS') > #{maxIfStrDh} then 'I'
		                        WHEN TO_CHAR(FNL_MDF_DH,'YYYYMMDDHH24MISS') > #{maxIfStrDh} then 'U'
		                        ELSE 'E'
		                   END IF_CHNG_STAT_DVSN
		                 , TO_CHAR(TO_DATE(A.CMT_DY), 'YYYY-MM-DD') AS CMT_DY
						 , A.CMT_SQ
						 , A.CMT_DVSN_CD
						 , A.TIME_DVSN_CD
						 , CASE A.TIME_DVSN_CD WHEN 'AM' THEN '오전'
		                                       WHEN 'PM' THEN '오후'
		                                       ELSE '' END || DECODE(A.CMT_TIME,NULL,'',A.CMT_TIME||'시') 
		                  || DECODE(A.CMT_MIN,NULL,'',A.CMT_MIN||'분') AS CMT_DY_NM
					     , A.CMT_TIME
					     , A.CMT_MIN
		                 , A.CMT_TIT
		                 , A.CMT_END_YN
		                 , TO_CHAR(A.CMT_END_DH, 'YYYY-MM-DD HH24:MI:SS') AS CMT_END_DH 
		                 , A.CMT_SBCN_YN
		                 , 'TBBADDED120M' AS TBL_NM
		             FROM TBBADDED120M A
		            WHERE 1=1
		              AND TO_CHAR(FNL_MDF_DH, 'YYYYMMDDHH24MI') >  #{maxIfStrDh}
		        ) B
		    WHERE 1=1
     ]]>
             <if test='maxIfStrDh != "0"'>
              AND B.IF_CHNG_STAT_DVSN = 'U'  
             </if>
            ORDER BY B.CMT_DY
        <include refid="include.pageOrder" />
    </select>
    
    <select id="selectTBBADFRE113M" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.aep.cfr.dao.AEPCFR012PMapper.selectTBBADFRE113M*/
        <include refid="include.pageSelct" />
     <![CDATA[     
          SELECT   
		         B.IF_CHNG_STAT_DVSN
		       , B.ACP_YR_NO
		       , B.AFF_SNO
		       , B.DSP_RQ_SNO
		       , B.SBCN_REGI_REQ_DT
		       , B.SBCN_NBC
		       , B.SBCN_DY
		       , B.SBCN_PAGE_CNT
		       , B.SBCN_NO
		       , B.SBCN_PRSS_DPT_NM
		       , B.TBL_NM
		    FROM
			   (
		            SELECT 
		                   CASE WHEN TO_CHAR(FRT_REGI_DH, 'YYYYMMDDHH24MISS') > #{maxIfStrDh} then 'I'
		                        WHEN TO_CHAR(FNL_MDF_DH,'YYYYMMDDHH24MISS') > #{maxIfStrDh} then 'U'
		                        ELSE 'E'
		                   END IF_CHNG_STAT_DVSN
                         , A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' ||A.ACP_SRNO AS ACP_YR_NO /* 분류번호 */
						 , A.AFF_SNO
					     , A.DSP_RQ_SNO
					     , TO_CHAR(TO_DATE(A.SBCN_REGI_REQ_DT), 'YYYY-MM-DD') AS SBCN_REGI_REQ_DT
		                 , A.SBCN_NBC
					     , TO_CHAR(TO_DATE(A.SBCN_DY), 'YYYY-MM-DD') AS SBCN_DY
		                 , A.SBCN_PAGE_CNT
		                 , A.SBCN_NO
		                 , A.SBCN_PRSS_DPT_NM
		                 , 'TBBADFRE113M' AS TBL_NM
		             FROM TBBADFRE113M A
		            WHERE 1=1
		              AND TO_CHAR(FNL_MDF_DH, 'YYYYMMDDHH24MI') >  #{maxIfStrDh}
	            ) B   
	            WHERE 1=1
       ]]>
		        <if test='maxIfStrDh != "0"'>
		          AND B.IF_CHNG_STAT_DVSN = 'U'  
		        </if>
	            ORDER BY B.AFF_SNO, B.DSP_RQ_SNO   
        <include refid="include.pageOrder" />
    </select>
</mapper> 