<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.asb.dao.AEPASB020PMapper">
    <select id="selectAttenList" parameterType="paramMap"
        resultType="egovMap">
        /* kr.go.bai.eip.aep.asb.dao.AEPASB020PMapper.selectAttenList */
        <![CDATA[
        SELECT AUD_YR
	       		, AUD_NO
	       		, AUD_STEP_CD 	
	       		, DOC_ID
	       		, APVR_CD
	       		, AFF_SNO 
	       		, SBMT_SEQ
	       		, SBMT_DTL_SEQ
	       		, SBMT_DTL_DVSN
	       		, ATTEN_NAME
	       		, ATTEN_ORG
	       		, ATTEN_YN
	       		, AGT_NAME
	       		, AGT_ORG
	       		, AGT_ATTEN_YN
	       		, RMK
                , ATTEN_CMPT_YN
                , AGT_ATTEN_CMPT_YN
        	FROM TBBADDED114D T1
        	 WHERE T1.AUD_YR = #{audYr}
           		AND T1.AUD_NO = #{audNo}
          	 	AND T1.AUD_STEP_CD = #{audStepCd}
           		AND T1.DOC_ID = #{docId}
           		AND T1.APVR_CD = #{apvrCd}
           		AND T1.AFF_SNO = #{affSno}
           		AND T1.SBMT_SEQ = #{sbmtSeq}
           		AND T1.SBMT_DTL_DVSN IN ('10')
           	ORDER BY AFF_SNO
        ]]>
    </select>
    
    <insert id="insertAttenList">
        /* kr.go.bai.eip.aep.asb.dao.AEPASB020PMapper.insertAttenList */
    <![CDATA[
        INSERT INTO TBBADDED114D
        (
                AUD_YR,
                AUD_NO,
                AUD_STEP_CD,
                DOC_ID,
                APVR_CD,
                AFF_SNO,
                SBMT_SEQ,
                SBMT_DTL_SEQ,
                SBMT_DTL_DVSN,
                ATTEN_NAME,
                ATTEN_ORG,
                ATTEN_YN,
                AGT_NAME,
        		AGT_ORG,
        		AGT_ATTEN_YN,
        		RMK,
                FRT_USR_ID,
                FNL_USR_ID,
                FNL_DEAL_DPT_CD,
                FNL_MNU_ID,
                FRT_REGI_DH,
                FNL_MDF_DH
                , ATTEN_CMPT_YN
                , AGT_ATTEN_CMPT_YN
         )
         VALUES 
         (
         	#{audYr}
            , #{audNo}
            , #{audStepCd}
            , #{docId}
            , #{apvrCd}
            , #{affSno}
            , #{sbmtSeq}
            , (SELECT NVL(MAX(SBMT_DTL_SEQ),0)+1
                  FROM TBBADDED114D
	                 WHERE AUD_YR =  #{audYr}
	                   AND AUD_NO = #{audNo}
	                   AND AUD_STEP_CD = #{audStepCd}
	                   AND DOC_ID = #{docId}
	                   AND APVR_CD = #{apvrCd}
	                   AND AFF_SNO = #{affSno}
	                   AND SBMT_SEQ = #{sbmtSeq})
            , #{sbmtDtlDvsn}
            , #{attenName}
            , #{attenOrg}
            , #{attenYn}
            , #{agtName}
            , #{agtOrg}
            , #{agtAttenYn}
            , #{rmk}
            , #{usrId}
            , #{usrId}
            , #{dptCd}
            , 'AEPASB020P'
            , SYSDATE
            , SYSDATE
            , #{attenCmptYn}
            , #{agtAttenCmptYn}
        )
        ]]>
    </insert>
    
    <delete id="deleteAttenList">
        /* kr.go.bai.eip.aep.asb.dao.AEPASB020PMapper.deleteAttenList */
    <![CDATA[
         DELETE TBBADDED114D
            WHERE AUD_YR = #{audYr}
	            AND AUD_NO =  #{audNo}
	            AND AUD_STEP_CD =  #{audStepCd}
	            AND DOC_ID =  #{docId}
	            AND APVR_CD =  #{apvrCd}
	            AND AFF_SNO =  #{affSno}
	            AND SBMT_SEQ =  #{sbmtSeq}
	            AND SBMT_DTL_SEQ = #{sbmtDtlSeq};
        ]]>
    </delete>

    <update id="updateAttenList" parameterType="paramMap">
        /* kr.go.bai.eip.aep.asb.dao.AEPASB020PMapper.updateAttenList */
        <![CDATA[
        UPDATE TBBADDED114D
        SET 
            SBMT_DTL_DVSN = #{sbmtDtlDvsn},
            ATTEN_NAME = #{attenName},
            ATTEN_ORG = #{attenOrg},
            ATTEN_YN = #{attenYn},
            AGT_NAME = #{agtName},
            AGT_ORG = #{agtOrg},
            AGT_ATTEN_YN = #{agtAttenYn},
            ATTEN_CMPT_YN = #{attenCmptYn},
            AGT_ATTEN_CMPT_YN = #{agtAttenCmptYn},
            RMK = #{rmk},
            FNL_USR_ID  = #{usrId},
            FNL_DEAL_DPT_CD = #{dptCd},
            FNL_MDF_DH = SYSDATE,
            FNL_MNU_ID = 'AEPASB020P'
        WHERE AUD_YR = #{audYr}
	        AND AUD_NO = #{audNo}
	        AND AUD_STEP_CD = #{audStepCd}
	        AND DOC_ID = #{docId} 
	        AND APVR_CD = #{apvrCd}
	        AND AFF_SNO = #{affSno}
	        AND SBMT_SEQ = #{sbmtSeq}
	        AND SBMT_DTL_SEQ = #{sbmtDtlSeq}
        ]]>
    </update>

</mapper> 
