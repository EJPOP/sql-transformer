<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.aep.osm.dao.AEPOSM013PMapper">
    
    <select id="selectMainList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.aep.osm.dao.AEPOSM013PMapper.selectMainList*/
    <include refid="include.pageSelct" />
            <![CDATA[
        SELECT NVL(F_CODE_NM('1000361',(SELECT CVPT_HNDL_STA_CD
                                              FROM TBCSPDCP101M
                                             WHERE T1.TSK_KEY1||T1.TSK_KEY2||T1.TSK_KEY3 = ACP_YR||REQ_DVSN_CD||CVPT_ACP_NO)),'-') AS CVPT_HNDL_STA_NM,
               T1.AUD_YR,
               T1.AUD_NO,
               T1.SRNO,
               T1.DVSN_CD,
               F_CODE_NM('1000742', T1.DVSN_CD) AS DVSN_NM,
               T1.TSK_KEY1,
               T1.TSK_KEY2,
               T1.TSK_KEY3,
               T1.TSK_KEY4,
               T1.TSK_KEY1 || '-' || T1.TSK_KEY2 || '-' || T1.TSK_KEY3 AS SUM_KEY,
               CASE WHEN DVSN_CD IN ('1','2','3') THEN (SELECT S1.ACP_YR||'-'||F_CODE_NM('1000740',S1.REQ_DVSN_CD)||'-'||S1.RM_CVPT_ACP_NO
                                                          FROM TBCSPDCP101M S1
                                                         WHERE T1.TSK_KEY1 = S1.ACP_YR
                                                           AND T1.TSK_KEY2 = S1.REQ_DVSN_CD
                                                           AND T1.TSK_KEY3 = S1.CVPT_ACP_NO)
                    WHEN DVSN_CD = '4'              THEN T1.TSK_KEY1 ||'-국회-'|| T1.TSK_KEY3		/*국회 로직 추가 2017.01.11 전상철*/
                    WHEN DVSN_CD IN ('5','6','7') THEN (SELECT CASE WHEN S1.ACP_YR >= '2016' THEN S1.ACP_YR || '-' || DECODE(S1.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || S1.ACP_SRNO
                                                                    ELSE S1.ACP_YR || '-' || S1.ACP_DVSN_CD || '-' || S1.ACP_SRNO END
                                                          FROM TBBADFRE012M S1 
                                                         WHERE T1.TSK_KEY1 = S1.ACP_YR   
                                                           AND T1.TSK_KEY2 = S1.ACP_DVSN_CD
                                                           AND T1.TSK_KEY3 = S1.ACP_SRNO
                                                           AND T1.TSK_KEY4 = S1.DPT_CD)
                    WHEN DVSN_CD IN ('8','9')     THEN (SELECT CASE WHEN S1.OGN_DVSN_CD = '6' THEN S1.YR||'-판청-'||S1.ACP_NO
                                                                    ELSE S1.YR||'-손망-'||S1.ACP_NO END 
                                                          FROM TBBADGDA001M S1
                                                         WHERE T1.TSK_KEY1 = S1.ORG_CD
                                                           AND T1.TSK_KEY2 = S1.NTF_DVSN_CD
                                                           AND T1.TSK_KEY3 = S1.NNB)
                    WHEN DVSN_CD = '0'            THEN TSK_KEY1 ||'-정보-'|| TSK_KEY2
                    WHEN DVSN_CD = 'A'            THEN F_MNG_KND_AUDYRNO(TSK_KEY1, TSK_KEY2, (SELECT AUD_KND_CD 
                                                                                                FROM TBBADDED001M 
                                                                                               WHERE AUD_YR = TSK_KEY1 
                                                                                                 AND AUD_NO = TSK_KEY2), '-') ||'-'|| TSK_KEY3 ||'-'|| F_ORG_INFO(TSK_KEY4,'1')
                    WHEN DVSN_CD = 'C'            THEN TSK_KEY1 ||'-청금-'|| (SELECT RM_CVPT_ACP_NO FROM TBDCPDCP101M WHERE 1=1 AND ACP_YR = TSK_KEY1 AND REQ_DVSN_CD = TSK_KEY2 AND CVPT_ACP_NO = TSK_KEY3)
                                                                                      /*청탁금지법 추가 2020.12.15 최성호*/
                   WHEN DVSN_CD = 'D'           THEN TSK_KEY1 ||'-'||F_CODE_NM('1000742', 'D')||'-'||(SELECT RM_CVPT_ACP_NO FROM TBCORCOR101M WHERE 1=1 AND ACP_YR = TSK_KEY1 AND REQ_DVSN_CD = TSK_KEY2 AND CVPT_ACP_NO = TSK_KEY3)
										   										    /*부패방지법 추가 2020.12.15 최성호*/
                    ELSE ''
                END AS EXEC_NO 
              ,CASE WHEN DVSN_CD IN ('1','2','3') THEN (SELECT S1.TIT_NM
                                                            FROM TBCSPDCP101M S1
                                                           WHERE T1.TSK_KEY1 = S1.ACP_YR
                                                               AND T1.TSK_KEY2 = S1.REQ_DVSN_CD
                                                             AND T1.TSK_KEY3 = S1.CVPT_ACP_NO)
                                                              
                    WHEN DVSN_CD = '4'            THEN (SELECT S1.AUD_REQ_TIT_NM
                                                          FROM TBCSPEAR007M S1
                                                         WHERE T1.TSK_KEY1 = S1.ACP_YR
                                                           AND T1.TSK_KEY2 = S1.REQ_DVSN_CD
                                                           AND T1.TSK_KEY3 = S1.CVPT_ACP_NO
                                                             )	/*국회 로직 추가 2017.01.11 전상철*/
                    WHEN DVSN_CD IN ('5','6','7') THEN (SELECT S1.TIT_NM
                                                          FROM TBBADFRE012M S1 
                                                         WHERE T1.TSK_KEY1 = S1.ACP_YR
                                                           AND T1.TSK_KEY2 = S1.ACP_DVSN_CD
                                                           AND T1.TSK_KEY3 = S1.ACP_SRNO
                                                           AND T1.TSK_KEY4 = S1.DPT_CD)
                    WHEN DVSN_CD IN ('8','9')     THEN (SELECT S1.TIT_NM  
                                                          FROM TBBADGDA001M S1
                                                         WHERE T1.TSK_KEY1 = S1.ORG_CD
                                                           AND T1.TSK_KEY2 = S1.NTF_DVSN_CD
                                                           AND T1.TSK_KEY3 = S1.NNB)
                    WHEN DVSN_CD = '0'            THEN (SELECT TIT_TXT 
                                                          FROM TBCSPBII100M S1
                                                         WHERE S1.YE   = T1.TSK_KEY1
                                                           AND S1.SRNO = T1.TSK_KEY2)
                    WHEN DVSN_CD = 'A'            THEN (SELECT TIT_TXT
                                                          FROM TBBADEAR001M S1
                                                         WHERE S1.AUD_YR      = T1.TSK_KEY1
                                                           AND S1.AUD_NO      = T1.TSK_KEY2
                                                           AND S1.DSP_RQ_SNO  = T1.TSK_KEY3)
                    WHEN DVSN_CD = 'C'            THEN 
                                                           (SELECT TIT_NM
                                                           FROM TBDCPDCP101M
                                                           WHERE 1=1
                                                           AND ACP_YR = T1.TSK_KEY1
                                                           AND REQ_DVSN_CD = T1.TSK_KEY2
                                                           AND CVPT_ACP_NO = T1.TSK_KEY3) /*청탁금지법 추가 2020.12.15 최성호*/
                   WHEN DVSN_CD = 'D'            THEN 
                   										   (SELECT TIT_NM
                                                           FROM TBCORCOR101M
                                                           WHERE 1=1
                                                           AND ACP_YR = T1.TSK_KEY1
                                                           AND REQ_DVSN_CD = T1.TSK_KEY2
                                                           AND CVPT_ACP_NO = T1.TSK_KEY3) /*청탁금지법 추가 2020.12.15 최성호*/
                    ELSE '' END AS EXEC_TIT_NM
          FROM TBBADDED030L T1
         WHERE T1.AUD_YR = #{audYr}
           AND T1.AUD_NO = #{audNo}
        ORDER BY T1.SRNO
       ]]>
       <include refid="include.pageOrder" />
    </select>
</mapper>