<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.dcm.acm.dao.DCMACM015EMapper">

    <select id="selectDocList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.dcm.acm.dao.DCMACM015EMapper.selectDocList*/
            <![CDATA[   
	    SELECT ROWNUM AS NUM,
       		     F_CODE_NM('1000912',PATCH_TYPE) AS PATCH_TYPE_NM,
         	     PATCH_VER,
       		     DOC_ID,
       		     FILE_NM,
       		     ROUND(FILE_SIZE / 1024 / 1024, 2) ||'MB' AS FILE_SIZE,
       		     TO_CHAR(PATCH_DATE,'YYYY-MM-DD HH24:MI')AS PATCH_DATE,
       		     EDIT_FLAG,
       		     ODT_SNO
	   FROM   TBBADDED125D
	   WHERE 1=1
    ORDER BY PATCH_DATE DESC
       ]]>
       </select>

 <delete id="deleteDCMACM125D"  parameterType="paramMap">
 	/* kr.go.bai.eip.dcm.acm.dao.DCMACM015EMapper.deleteDCMACM125D*/
 	    DELETE 
        FROM TBBADDED125D
  	    WHERE 1=1
        <if test="odtSno != null and odtSno !=''">
        AND  ODT_SNO = #{odtSno}
        </if>
        <if test="editFlag != null and editFlag !=''">
        AND  EDIT_FLAG = #{editFlag}
        </if>
        <if test="docId != null and docId !=''">
        AND  DOC_ID = #{docId}
        </if>
 </delete>	
 <delete id="deleteDCMACM125M"  parameterType="paramMap">
 	/* kr.go.bai.eip.dcm.acm.dao.DCMACM015EMapper.deleteDCMACM125M*/
 	    DELETE 
        FROM TBBADDED125M
  	    WHERE 1=1
        <if test="odtSno != null and odtSno !=''">
        AND  ODT_SNO = #{odtSno}
        </if>
        <if test="editFlag != null and editFlag !=''">
        AND  EDIT_FLAG = #{editFlag}
        </if>
 </delete>	
 <insert id="insertDCMACM125M" parameterType="paramMap">
 	/* kr.go.bai.eip.dcm.acm.dao.DCMACM015EMapper.insertDCMACM125M*/
 	   
 	         INSERT INTO TBBADDED125M(
              EDIT_FLAG
            , ODT_SNO
            , EDT_TITLE_NM
            , EDT_VER  /*작성기 버전*/
            , ODT_TITLE_NM
            , ODT_VER /*엔진 버전*/
            , PATCH_DATE
            , FRT_USR_ID
            , FNL_USR_ID
            , FNL_DEAL_DPT_CD
            , FNL_MNU_ID
            , FRT_REGI_DH
            , FNL_MDF_DH
            , OLD_EDT_VER
        ) VALUES (
               DECODE(#{patchType},'10','ODT','HWP') 
             , #{odtSno}
             , '문서작성기 최신버전'
             , DECODE(#{patchType},'30',(SELECT EDT_VER
                                               FROM TBBADDED125M 
                                               WHERE (ODT_SNO, EDIT_FLAG) IN (
                                                          SELECT MAX(ODT_SNO), EDIT_FLAG
                                                          FROM TBBADDED125M
                                                          WHERE 1=1
                                                          AND EDIT_FLAG = DECODE(#{patchType},'10','ODT','HWP')
                                                          GROUP BY EDIT_FLAG)), #{patchVer})
             , DECODE(#{patchType},'10','ODT 편집기','HWP 편집기')
             , DECODE(#{patchType},'30',#{patchVer},(SELECT ODT_VER
                                                             FROM TBBADDED125M 
                                                             WHERE (ODT_SNO, EDIT_FLAG) IN (
                                                                        SELECT MAX(ODT_SNO), EDIT_FLAG
                                                                        FROM TBBADDED125M
                                                                        WHERE 1=1
                                                                        AND EDIT_FLAG = DECODE(#{patchType},'10','ODT','HWP')
                                                                        GROUP BY EDIT_FLAG))	)	
             , SYSDATE
             , #{usrId}
             , #{usrId}
             , #{dptCd}
             , #{menuId}
             , SYSDATE
             , SYSDATE
              ,'v1.0.1.0000'
              
        )
 
 </insert>

</mapper> 