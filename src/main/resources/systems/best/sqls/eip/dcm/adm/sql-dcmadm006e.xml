<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.dcm.adm.dao.DCMADM006EMapper">

	<!-- 감사자료 제출 요구 목록 조회 -->
	<select id="selectMainList" parameterType="paramMap"
		resultType="egovMap">
		<include refid="include.pageSelct"/>
		<![CDATA[
			SELECT T2.IDVT_MTRL_SRNO,
					T2.MTRL_SRNO
			      ,T2.FL_NM
			      ,T2.FL_HASH
			      ,T2.DOC_ID
			      ,T2.FL_DNV
			      ,T2.FL_SIGN
			      ,T2.FL_CPT
			      ,NVL(T2.ACP_DVSN_CD, '10') AS ACP_DVSN_CD
			      ,F_CODE_NM('1000989',NVL(T2.ACP_DVSN_CD, '10')) AS ACP_DVSN_NM
			      ,T2.SHAR_DVSN_CD
			      ,T2.CERT_CRE_YN
			      ,T2.PSN_INF_ICLS_YN
			      ,T2.CLC_TM_CD
			      ,T2.CLC_PPS_CD
			      ,T2.MTRL_TYP_CD
			      ,TO_CHAR(TO_DATE(T1.SMT_DT),'YYYY-MM-DD') AS SMT_DT
			      ,T1.SMT_ORG_NM
			      ,T1.CRT_DVSN_CD
			      ,F_CODE_NM('1000983', T1.CRT_DVSN_CD) AS CRT_DVSN_NM
			      ,F_CODE_NM('1000991',T1.SMT_DVSN_CD) AS SMT_DVSN_NM
			      ,NVL(T2.DEL_YN,'N') AS DEL_YN
			      ,F_USR_INFO(T1.RQR_CNB ,'2') AS RQR_NAM
			      ,F_DPT_INFO(T1.RQR_DPT_CD, '1') RQR_DPT_NM 
			      ,T2.CERT_DOC_ID
			  FROM TBDCMADM002M T1
			         , TBDCMADM003M T2 
			 WHERE 1=1
			  AND T1.MTRL_SRNO = T2.MTRL_SRNO
		]]>
		
		<if test='schAcpDvsnCd != null and schAcpDvsnCd != ""'>
				<![CDATA[
				   AND T2.ACP_DVSN_CD = #{schAcpDvsnCd}
				]]>
			</if>
			
			
		<if test='schSmtDts != null and schSmtDts != ""'>
				<![CDATA[
				   AND T1.SMT_DT >= #{schSmtDts}
				]]>
			</if>
			
		<if test='schSmtDte != null and schSmtDte != ""'>
				<![CDATA[
				   AND T1.SMT_DT <= #{schSmtDte}
				]]>
			</if>
		<if test='schSmtDvsnCd != null and schSmtDvsnCd != ""'>
				<![CDATA[
				   AND T1.SMT_DVSN_CD = #{schSmtDvsnCd}
				]]>
			</if>
		<if test='schSmtOrgNm != null and schSmtOrgNm != ""'>
				<![CDATA[
				   AND T1.SMT_ORG_NM LIKE  '%'||#{schSmtOrgNm}||'%'
				]]>
			</if>
			<if test='schPrsrNm != null and schPrsrNm != ""'>
				<![CDATA[
				   AND T1.PRSR_NM LIKE  '%'||#{schPrsrNm}||'%'
				]]>
			</if>
			
			<if test='schTitNm != null and schTitNm != ""'>
				<![CDATA[
				   AND T2.FL_NM LIKE  '%'||#{schTitNm}||'%'
				]]>
			</if>
			
			<if test='schSharDvsnCd != null and schSharDvsnCd != ""'>
				<![CDATA[
				   AND T2.SHAR_DVSN_CD  = #{schSharDvsnCd}
				]]>
			</if>
			
			<if test='schPsnInfIclsYn != null and schPsnInfIclsYn != ""'>
				<![CDATA[
				   AND NVL(T2.PSN_INF_ICLS_YN,'N')  = #{schPsnInfIclsYn}
				]]>
			</if>
			
			<if test='schDelYn != null and schDelYn != ""'>
				<![CDATA[
				   AND NVL(T2.DEL_YN,'N')  = #{schDelYn}
				]]>
			</if>
			
			<if test='schClcTmCd != null and schClcTmCd != ""'>
				<![CDATA[
				   AND T2.CLC_TM_CD  = #{schClcTmCd}
				]]>
			</if>
			
			<if test='schClcPpsCd != null and schClcPpsCd != ""'>
				<![CDATA[
				   AND T2.CLC_PPS_CD  = #{schClcPpsCd}
				]]>
			</if>
			
			<if test='schMtrlTypCd != null and schMtrlTypCd != ""'>
				<![CDATA[
				   AND T2.MTRL_TYP_CD  = #{schMtrlTypCd}
				]]>
			</if>
			
		<![CDATA[
			ORDER BY T1.MTRL_SRNO DESC
		]]>
		<include refid="include.pageOrder" />
	</select>
	
	<select id="selectExcelList" parameterType="paramMap"
		resultType="egovMap">
		/* DCMADM002EMapper.selectMainList 감사자료 제출 요구 목록 조회 */
		<![CDATA[
			SELECT T2.IDVT_MTRL_SRNO,
					T2.MTRL_SRNO
			      ,T2.FL_NM
			      ,T2.FL_HASH
			      ,T2.DOC_ID
			      ,T2.FL_DNV
			      ,T2.FL_SIGN
			      ,T2.FL_CPT
			      ,NVL(T2.ACP_DVSN_CD, '10') AS ACP_DVSN_CD
			      ,F_CODE_NM('1000989',NVL(T2.ACP_DVSN_CD, '10')) AS ACP_DVSN_NM
			      ,F_CODE_NM('1000987', T2.SHAR_DVSN_CD) AS SHAR_DVSN_NM
			      ,NVL(T2.CERT_CRE_YN,'N') AS CERT_CRE_YN
			      ,NVL(T2.PSN_INF_ICLS_YN,'N') AS PSN_INF_ICLS_YN
			      ,F_CODE_NM('1000984', T2.CLC_TM_CD) AS CLC_TM_NM
			      ,F_CODE_NM('1000985', T2.CLC_PPS_CD)  AS CLC_PPS_NM
			      ,F_CODE_NM('1000985', MTRL_TYP_CD) AS MTRL_TYP_NM
			      ,TO_CHAR(TO_DATE(T1.SMT_DT),'YYYY-MM-DD') AS SMT_DT
			      ,T1.SMT_ORG_NM
			      ,F_CODE_NM('1000983', T1.CRT_DVSN_CD) AS CRT_DVSN_NM
			      ,F_CODE_NM('1000991',T1.SMT_DVSN_CD) AS SMT_DVSN_NM
			      ,NVL(T2.DEL_YN,'N') AS DEL_YN
			      ,T1.PRSR_NM
			      ,F_USR_INFO(T1.RQR_CNB ,'2') AS RQR_NAM
			      ,F_DPT_INFO(T1.RQR_DPT_CD, '1') RQR_DPT_NM
			  FROM TBDCMADM002M T1
			         , TBDCMADM003M T2 
			 WHERE 1=1
			  AND T1.MTRL_SRNO = T2.MTRL_SRNO
		]]>
		
		<if test='schAcpDvsnCd != null and schAcpDvsnCd != ""'>
				<![CDATA[
				   AND T2.ACP_DVSN_CD = #{schAcpDvsnCd}
				]]>
			</if>
			
			
		<if test='schSmtDts != null and schSmtDts != ""'>
				<![CDATA[
				   AND T1.SMT_DT >= #{schSmtDts}
				]]>
			</if>
			
		<if test='schSmtDte != null and schSmtDte != ""'>
				<![CDATA[
				   AND T1.SMT_DT <= #{schSmtDte}
				]]>
			</if>
		<if test='schSmtDvsnCd != null and schSmtDvsnCd != ""'>
				<![CDATA[
				   AND T1.SMT_DVSN_CD = #{schSmtDvsnCd}
				]]>
			</if>
		<if test='schSmtOrgNm != null and schSmtOrgNm != ""'>
				<![CDATA[
				   AND T1.SMT_ORG_NM LIKE  '%'||#{schSmtOrgNm}||'%'
				]]>
			</if>
			<if test='schPrsrNm != null and schPrsrNm != ""'>
				<![CDATA[
				   AND T1.PRSR_NM LIKE  '%'||#{schPrsrNm}||'%'
				]]>
			</if>
			
			<if test='schTitNm != null and schTitNm != ""'>
				<![CDATA[
				   AND T2.FL_NM LIKE  '%'||#{schTitNm}||'%'
				]]>
			</if>
			
			<if test='schSharDvsnCd != null and schSharDvsnCd != ""'>
				<![CDATA[
				   AND T2.SHAR_DVSN_CD  = #{schSharDvsnCd}
				]]>
			</if>
			
			<if test='schPsnInfIclsYn != null and schPsnInfIclsYn != ""'>
				<![CDATA[
				   AND NVL(T2.PSN_INF_ICLS_YN,'N')  = #{schPsnInfIclsYn}
				]]>
			</if>
			
			<if test='schDelYn != null and schDelYn != ""'>
				<![CDATA[
				   AND NVL(T2.DEL_YN,'N')  = #{schDelYn}
				]]>
			</if>
			
			<if test='schClcTmCd != null and schClcTmCd != ""'>
				<![CDATA[
				   AND T2.CLC_TM_CD  = #{schClcTmCd}
				]]>
			</if>
			
			<if test='schClcPpsCd != null and schClcPpsCd != ""'>
				<![CDATA[
				   AND T2.CLC_PPS_CD  = #{schClcPpsCd}
				]]>
			</if>
			
			<if test='schMtrlTypCd != null and schMtrlTypCd != ""'>
				<![CDATA[
				   AND T2.MTRL_TYP_CD  = #{schMtrlTypCd}
				]]>
			</if>
		<![CDATA[
			ORDER BY T1.MTRL_SRNO DESC
		]]>
	</select>
	
</mapper>
