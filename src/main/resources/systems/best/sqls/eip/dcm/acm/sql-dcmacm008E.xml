<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.dcm.acm.dao.DCMACM008EMapper">
	<select id="selectAudDocList" parameterType="paramMap" resultType="egovMap" >
		/* kr.go.bai.eip.dcm.acm.dao.DCMACM008EMapper.selectAudDocList*/
		<include refid="include.pageSelct" />
		SELECT DT.AUD_DOC_CD
			  ,DT.AUD_DOC_NM
			  ,DT.DTIL_AUD_DOC_NO
			  ,DT.DTIL_AUD_DOC_NM
			  ,DT.TSK_KND_CD
			  ,F_CODE_NM('1000787',DT.TSK_KND_CD) AS TSK_KND_NM
			  ,DT.AUD_STEP_CD
			  ,F_CODE_NM('1000785',DT.AUD_STEP_CD) AS AUD_STEP_NM
			  ,DT.MNT_CHO_CD
			  ,F_CODE_NM('1000768',DT.MNT_CHO_CD) AS MNT_CHO_NM
			  ,DT.APV_WAY_CD
			  ,F_CODE_NM('1000767',DT.APV_WAY_CD) AS APV_WAY_NM
			  ,DT.AUD_DOC_KND_CD
			  ,F_CODE_NM('1000769',DT.AUD_DOC_KND_CD) AS AUD_DOC_KND_NM
			  ,DT.TRNM_POSS_YN
			  ,DT.DOC_PRD_DPT_CD
			  ,F_CODE_NM('1000771',DT.DOC_PRD_DPT_CD) AS DOC_PRD_DPT_NM
			  ,DT.CON_PGM_CD
			  ,F_CODE_NM('1000790',DT.CON_PGM_CD) AS CON_PGM_NM
			  ,DT.DOC_ID
			  ,DT.DOC_KND_CD
			  ,F_CODE_NM('1000782',DT.DOC_KND_CD) AS DOC_KND_NM
			  ,DT.HIDDEN_YN
			  ,CASE WHEN DT.HIDDEN_YN = 'Y' THEN 'N'
		            ELSE 'Y' END AS ETC_DOC_DIS_YN
		  FROM ( 
				SELECT A.AUD_DOC_CD
					  ,F_CODE_NM('1000786', A.AUD_DOC_CD) AS AUD_DOC_NM
					  ,A.TSK_KND_CD
					  ,A.AUD_STEP_CD
					  ,A.MNT_CHO_CD
					  ,A.APV_WAY_CD
					  ,A.AUD_DOC_KND_CD
					  ,A.TRNM_POSS_YN
					  ,A.DOC_PRD_DPT_CD
					  ,A.CON_PGM_CD
					  ,D.DTIL_AUD_DOC_NO
					  ,D.DTIL_AUD_DOC_NM
					  ,D.DOC_ID
					  ,D.DOC_KND_CD
					  ,D.HIDDEN_YN   
				  FROM TBFDMADM001M A
				      ,TBFDMADM002M D
				 WHERE 1 = 1
				   AND A.AUD_DOC_CD = D.AUD_DOC_CD
				   AND A.APV_WAY_CD IN ('10','30')
				UNION ALL 
				SELECT 'D10100001' AS AUD_DOC_CD
				       , '선람전 (국)' AS AUD_DOC_NM
				       , 'D10' AS TSK_KND_CD
					   , '' AS AUD_STEP_CD
					   , '' AS MNT_CHO_CD
					   , '10' AS APV_WAY_CD
					   , '' AS AUD_DOC_KND_CD
					   , '' AS TRNM_POSS_YN
					   , '' AS DOC_PRD_DPT_CD
					   , '' AS CON_PGM_CD
					   , 0  AS DTIL_AUD_DOC_NO
				       , '선람전 (국)' AS DTIL_AUD_DOC_NM
					   , '' AS DOC_ID
					   , '' AS DOC_KND_CD
					   , '' AS HIDDEN_YN   
				  FROM DUAL
				UNION ALL 
				SELECT 'D10100002' AS AUD_DOC_CD
				       , '선람전 (과)' AS AUD_DOC_NM
				       , 'D10' AS TSK_KND_CD
					   , '' AS AUD_STEP_CD
					   , '' AS MNT_CHO_CD
					   , '10' AS APV_WAY_CD
					   , '' AS AUD_DOC_KND_CD
					   , '' AS TRNM_POSS_YN
					   , '' AS DOC_PRD_DPT_CD
					   , '' AS CON_PGM_CD
					   , 0  AS DTIL_AUD_DOC_NO
				       , '선람전 (과)' AS DTIL_AUD_DOC_NM
					   , '' AS DOC_ID
					   , '' AS DOC_KND_CD
					   , '' AS HIDDEN_YN   
				  FROM DUAL
				  UNION ALL 
				SELECT 'E10100001' AS AUD_DOC_CD
				       , '선람전 (국)' AS AUD_DOC_NM
				       , 'E10' AS TSK_KND_CD
					   , '' AS AUD_STEP_CD
					   , '' AS MNT_CHO_CD
					   , '10' AS APV_WAY_CD
					   , '' AS AUD_DOC_KND_CD
					   , '' AS TRNM_POSS_YN
					   , '' AS DOC_PRD_DPT_CD
					   , '' AS CON_PGM_CD
					   , 0  AS DTIL_AUD_DOC_NO
				       , '선람전 (국)' AS DTIL_AUD_DOC_NM
					   , '' AS DOC_ID
					   , '' AS DOC_KND_CD
					   , '' AS HIDDEN_YN   
				  FROM DUAL
				UNION ALL 
				SELECT 'E10100002' AS AUD_DOC_CD
				       , '선람전 (과)' AS AUD_DOC_NM
				       , 'E10' AS TSK_KND_CD
					   , '' AS AUD_STEP_CD
					   , '' AS MNT_CHO_CD
					   , '10' AS APV_WAY_CD
					   , '' AS AUD_DOC_KND_CD
					   , '' AS TRNM_POSS_YN
					   , '' AS DOC_PRD_DPT_CD
					   , '' AS CON_PGM_CD
					   , 0  AS DTIL_AUD_DOC_NO
				       , '선람전 (과)' AS DTIL_AUD_DOC_NM
					   , '' AS DOC_ID
					   , '' AS DOC_KND_CD
					   , '' AS HIDDEN_YN   
				  FROM DUAL
			) DT
		<if test="apvrUsrNm != null and apvrUsrNm != ''">
			,TBDCMACM019L B
			,TBDCMACM001M C
		</if>
		 WHERE 1=1
		 <if test="audDocNm != null and audDocNm != ''">
		   AND AUD_DOC_NM LIKE '%' || #{audDocNm} || '%'
		</if>
		<if test="apvrUsrNm != null and apvrUsrNm != ''">
		   AND DT.AUD_DOC_CD = B.AUD_DOC_CD
		   AND B.APVR_CNB = C.CNB
		   AND C.USR_NAM LIKE '%' || #{apvrUsrNm} || '%'
		</if>
		<if test="tskKndCd != null and tskKndCd != ''">
		   AND DT.TSK_KND_CD  = #{tskKndCd}
		</if>
		<if test="audStepCd != null and audStepCd != ''">
		   AND DT.AUD_STEP_CD  = #{audStepCd}
		</if>		 
		 ORDER BY DT.TSK_KND_CD, DT.AUD_STEP_CD, DT.AUD_DOC_CD
		
		<include refid="include.pageOrder" />
	</select>
	
	<select id="selectDefApvrListByAudDocCd" parameterType="paramMap" resultType="egovMap" >
		/* kr.go.bai.eip.dcm.acm.dao.DCMACM008EMapper.selectDefApvrListByAudDocCd*/
		SELECT  A.AUD_DOC_CD
		      , A.DTIL_AUD_DOC_NO
		      , (SELECT D.DTIL_AUD_DOC_NM FROM TBFDMADM002M D WHERE D.AUD_DOC_CD = A.AUD_DOC_CD AND D.DTIL_AUD_DOC_NO = A.DTIL_AUD_DOC_NO) AS DTIL_AUD_DOC_NM
			  ,	A.APVR_SNO
			  , A.APVR_KND_CD
			  , F_CODE_NM('1000825', A.APVR_KND_CD) AS APVR_KND_NM
		      , A.APNT_DVSN_CD
		      , F_CODE_NM('1000826', A.APNT_DVSN_CD) AS APNT_DVSN_NM
		      , A.APNT_PST_CD
		      , F_CODE_NM('1000827', A.APNT_PST_CD) AS APNT_PST_NM
		      , A.APVR_PST_CD
			  , DECODE(A.APVR_PST_CD,'',F_CODE_NM('1000173', A.APVR_RANK_CD),F_CODE_NM('1000176', A.APNT_PST_CD)) AS APVR_PST_NM
		      , A.APVR_CNB
		      , F_USR_INFO(A.APVR_CNB, '2') AS USR_NM
		      , A.APVR_RANK_CD
		      , A.APVR_DPT_CD
		      , F_DPT_INFO(A.APVR_DPT_CD, '1') AS APVR_DPT_NM
		      , DECODE(A.APNT_DVSN_CD,'1',F_CODE_NM('1000827', A.APNT_PST_CD),F_USR_INFO(A.APVR_CNB, '2')) AS DP_APVR_INFO
		  FROM TBDCMACM019L A
		 WHERE A.AUD_DOC_CD = #{audDocCd}
		   AND A.DTIL_AUD_DOC_NO = #{dtilAudDocNo}
	</select>
	
	<select id="selectAudDocInfo" parameterType="paramMap" resultType="egovMap" >
		/* kr.go.bai.eip.dcm.acm.dao.DCMACM008EMapper.selectAudDocInfo*/
		SELECT DT.AUD_DOC_CD
			  ,DT.AUD_DOC_NM
			  ,DT.DTIL_AUD_DOC_NO
			  ,DT.DTIL_AUD_DOC_NM
			  ,DT.TSK_KND_CD
			  ,F_CODE_NM('1000787',DT.TSK_KND_CD) AS TSK_KND_NM
			  ,DT.AUD_STEP_CD
			  ,F_CODE_NM('1000785',DT.AUD_STEP_CD) AS AUD_STEP_NM
			  ,DT.MNT_CHO_CD
			  ,F_CODE_NM('1000768',DT.MNT_CHO_CD) AS MNT_CHO_NM
			  ,DT.APV_WAY_CD
			  ,F_CODE_NM('1000767',DT.APV_WAY_CD) AS APV_WAY_NM
			  ,DT.AUD_DOC_KND_CD
			  ,F_CODE_NM('1000769',DT.AUD_DOC_KND_CD) AS AUD_DOC_KND_NM
			  ,DT.TRNM_POSS_YN
			  ,DT.DOC_PRD_DPT_CD
			  ,F_CODE_NM('1000771',DT.DOC_PRD_DPT_CD) AS DOC_PRD_DPT_NM
			  ,DT.CON_PGM_CD
			  ,F_CODE_NM('1000790',DT.CON_PGM_CD) AS CON_PGM_NM
			  ,DT.DOC_ID
			  ,DT.DOC_KND_CD
			  ,F_CODE_NM('1000782',DT.DOC_KND_CD) AS DOC_KND_NM
		  FROM ( 
				SELECT A.AUD_DOC_CD
					  ,F_CODE_NM('1000786', A.AUD_DOC_CD) AS AUD_DOC_NM
					  ,A.TSK_KND_CD
					  ,A.AUD_STEP_CD
					  ,A.MNT_CHO_CD
					  ,A.APV_WAY_CD
					  ,A.AUD_DOC_KND_CD
					  ,A.TRNM_POSS_YN
					  ,A.DOC_PRD_DPT_CD
					  ,A.CON_PGM_CD
					  ,D.DTIL_AUD_DOC_NO
					  ,D.DTIL_AUD_DOC_NM
					  ,D.DOC_ID
					  ,D.DOC_KND_CD
					  ,D.HIDDEN_YN   
				  FROM TBFDMADM001M A
				      ,TBFDMADM002M D
				 WHERE 1 = 1
				   AND A.AUD_DOC_CD = D.AUD_DOC_CD
				   AND A.APV_WAY_CD IN ('10','30')
				UNION ALL 
				SELECT 'D10100001' AS AUD_DOC_CD
				       , '선람전 (국)' AS AUD_DOC_NM
				       , 'D10' AS TSK_KND_CD
					   , '' AS AUD_STEP_CD
					   , '' AS MNT_CHO_CD
					   , '10' AS APV_WAY_CD
					   , '' AS AUD_DOC_KND_CD
					   , '' AS TRNM_POSS_YN
					   , '' AS DOC_PRD_DPT_CD
					   , '' AS CON_PGM_CD
					   , 0  AS DTIL_AUD_DOC_NO
				       , '선람전 (국)' AS DTIL_AUD_DOC_NM
					   , '' AS DOC_ID
					   , '' AS DOC_KND_CD
					   , 'N' AS HIDDEN_YN   
				  FROM DUAL
				UNION ALL 
				SELECT 'D10100002' AS AUD_DOC_CD
				       , '선람전 (과)' AS AUD_DOC_NM
				       , 'D10' AS TSK_KND_CD
					   , '' AS AUD_STEP_CD
					   , '' AS MNT_CHO_CD
					   , '10' AS APV_WAY_CD
					   , '' AS AUD_DOC_KND_CD
					   , '' AS TRNM_POSS_YN
					   , '' AS DOC_PRD_DPT_CD
					   , '' AS CON_PGM_CD
					   , 0  AS DTIL_AUD_DOC_NO
				       , '선람전 (과)' AS DTIL_AUD_DOC_NM
					   , '' AS DOC_ID
					   , '' AS DOC_KND_CD
					   , 'N' AS HIDDEN_YN   
				  FROM DUAL
				  UNION ALL 
				SELECT 'E10100001' AS AUD_DOC_CD
				       , '선람전 (국)' AS AUD_DOC_NM
				       , 'E10' AS TSK_KND_CD
					   , '' AS AUD_STEP_CD
					   , '' AS MNT_CHO_CD
					   , '10' AS APV_WAY_CD
					   , '' AS AUD_DOC_KND_CD
					   , '' AS TRNM_POSS_YN
					   , '' AS DOC_PRD_DPT_CD
					   , '' AS CON_PGM_CD
					   , 0  AS DTIL_AUD_DOC_NO
				       , '선람전 (국)' AS DTIL_AUD_DOC_NM
					   , '' AS DOC_ID
					   , '' AS DOC_KND_CD
					   , 'N' AS HIDDEN_YN   
				  FROM DUAL
				UNION ALL 
				SELECT 'E10100002' AS AUD_DOC_CD
				       , '선람전 (과)' AS AUD_DOC_NM
				       , 'E10' AS TSK_KND_CD
					   , '' AS AUD_STEP_CD
					   , '' AS MNT_CHO_CD
					   , '10' AS APV_WAY_CD
					   , '' AS AUD_DOC_KND_CD
					   , '' AS TRNM_POSS_YN
					   , '' AS DOC_PRD_DPT_CD
					   , '' AS CON_PGM_CD
					   , 0  AS DTIL_AUD_DOC_NO
				       , '선람전 (과)' AS DTIL_AUD_DOC_NM
					   , '' AS DOC_ID
					   , '' AS DOC_KND_CD
					   , 'N' AS HIDDEN_YN   
				  FROM DUAL
			) DT
		 WHERE DT.AUD_DOC_CD = #{audDocCd}
		   AND DT.DTIL_AUD_DOC_NO = #{dtilAudDocNo}
	</select>
	
	<insert id="insertDcmacm019l" parameterType="paramMap">
	    /* kr.go.bai.eip.dcm.acm.dao.DCMACM008EMapper.insertDCMACM019L*/
		INSERT INTO TBDCMACM019L
			(
				AUD_DOC_CD
				,DTIL_AUD_DOC_NO
				,APVR_SNO
				,APVR_KND_CD
				,APNT_PST_CD
				,APNT_DVSN_CD
				,APVR_CNB
				,APVR_PST_CD
				,APVR_RANK_CD
				,APVR_DPT_CD
				,FRT_USR_ID
				,FNL_USR_ID
				,FNL_DEAL_DPT_CD
				,FNL_MNU_ID
				,FRT_REGI_DH
				,FNL_MDF_DH
			)
			VALUES
			(
				#{audDocCd}
				,#{dtilAudDocNo}
				, (SELECT NVL(MAX(APVR_SNO),0)+1 FROM TBDCMACM019L WHERE AUD_DOC_CD = #{audDocCd} AND DTIL_AUD_DOC_NO = #{dtilAudDocNo})
				, #{apvrKndCd}
				, #{apntPstCd}
				, #{apntDvsnCd}
				, #{apvrCnb}
				, #{apvrPstCD}
				, #{apvrRankCd}
				, #{apvrDptCd}
				, #{usrId}
				, #{usrId}
				, #{dptCd}
				, #{menuNo}
				, SYSDATE
				, SYSDATE
			)
	</insert>
	
	<delete id="deleteDcmacm019l" parameterType="paramMap">
    	/* kr.go.bai.eip.dcm.acm.dao.DCMACM008EMapper.deleteDCMACM019L*/
        DELETE 
		  FROM TBDCMACM019L
		 WHERE AUD_DOC_CD = #{audDocCd}
		   AND DTIL_AUD_DOC_NO = #{dtilAudDocNo}
           
    </delete>
</mapper> 