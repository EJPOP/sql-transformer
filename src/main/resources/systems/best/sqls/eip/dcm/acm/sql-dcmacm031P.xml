<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.dcm.acm.dao.DCMACM031PMapper">

  
	<select id="selectVersionList" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.dcm.acm.dao.DCMACM031PMapper.selectVersionList */
	<![CDATA[
       SELECT ODT_SNO
              , EDIT_FLAG
              , DOC_ID
              , PATCH_TYPE
              , F_CODE_NM('1000912', PATCH_TYPE) AS PATCH_TYPE_NM
              , PATCH_VER
              , TO_CHAR(PATCH_DATE,'YYYY-MM-DD HH24:MI:SS') AS PATCH_DATE
              , FILE_NM
              , ROUND(FILE_SIZE / 1024 / 1024, 2) AS FILE_SIZE
              , FRT_USR_ID
              , FNL_USR_ID
              , FNL_DEAL_DPT_CD
              , FNL_MNU_ID
              , FRT_REGI_DH
              , FNL_MDF_DH
        FROM TBBADDED125D
       WHERE 1=1
        ]]>
        <if test="patchType != null and patChType != '' and patchType eq '10'.toString()">
        AND PATCH_DATE IN (SELECT MAX(PATCH_DATE) FROM TBBADDED125D WHERE PATCH_TYPE = #{patchType})
        </if>
        <if test="patchType != null and patChType != '' and patchType eq '20'.toString()">
        AND PATCH_DATE IN (SELECT MAX(PATCH_DATE) FROM TBBADDED125D WHERE PATCH_TYPE = #{patchType})
        </if>
        <if test="patchType != null and patChType != '' and patchType eq '30'.toString()">
        AND ((PATCH_TYPE, PATCH_DATE) IN (SELECT PATCH_TYPE,MAX(PATCH_DATE) FROM TBBADDED125D WHERE PATCH_TYPE = '20' GROUP BY PATCH_TYPE)
             OR (PATCH_TYPE, PATCH_DATE) IN (SELECT PATCH_TYPE,MAX(PATCH_DATE) FROM TBBADDED125D WHERE PATCH_TYPE = '30' GROUP BY PATCH_TYPE))
        </if>
        ORDER BY PATCH_DATE DESC
	</select>
</mapper> 