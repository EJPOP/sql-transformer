<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.dcm.acm.dao.DCMACM032PMapper">

  
	<select id="selectEdtVersionInfo" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.dcm.acm.dao.DCMACM032PMapper.selectEdtVersionInfo */
	<![CDATA[
       SELECT ODT_SNO
              , EDIT_FLAG
              , DOC_ID
              , PATCH_TYPE
              , PATCH_VER
              , PATCH_DATE
              , FILE_NM
              , FRT_USR_ID
              , FNL_USR_ID
              , FNL_DEAL_DPT_CD
              , FNL_MNU_ID
              , FRT_REGI_DH
              , FNL_MDF_DH
              , FILE_SIZE
        FROM TBBADDED125D
       WHERE ODT_SNO = #{odtSno}
         AND EDIT_FLAG = #{editFlag}
         AND DOC_ID = #{docId}
          ]]>
	</select>
	
	<select id="selectMaxOdtSno" parameterType="paramMap" resultType="string">
	/* kr.go.bai.eip.dcm.acm.dao.DCMACM032PMapper.selectMaxOdtSno */
	<![CDATA[
       SELECT NVL(MAX(ODT_SNO),0) + 1
        FROM TBBADDED125M
       WHERE EDIT_FLAG = #{editFlag}
          ]]>
	</select>
	
	<select id="selectEditFlagByPatchType" parameterType="paramMap" resultType="string">
	/* kr.go.bai.eip.dcm.acm.dao.DCMACM032PMapper.selectMaxOdtSno */
	<![CDATA[
       SELECT NVL(MAX(ODT_SNO),0) + 1
        FROM TBBADDED125M
       WHERE EDIT_FLAG = #{editFlag}
          ]]>
	</select>
	
	<insert id="insertEdtVersion" parameterType="paramMap">
     /* kr.go.bai.eip.dcm.acm.dao.DCMACM032PMapper.insertEdtVersion */
		INSERT INTO TBBADDED125D
		(
			ODT_SNO
			, EDIT_FLAG
			, DOC_ID
			, PATCH_TYPE
			, PATCH_VER
			, PATCH_DATE
			, FILE_NM
			, FILE_SIZE
			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			, FNL_MDF_DH
		)
		VALUES
		(
			#{odtSno}
			, DECODE(#{patchType},'10','ODT','HWP') 
			, #{docId}
			, #{patchType}
			, #{patchVer}
			, SYSDATE
			, #{fileNm}
			, #{fileSize}
			, #{usrId}
			, #{usrId}
			, #{dptCd}
			, #{menuId}
			, SYSDATE
			, SYSDATE
		)
	</insert>
</mapper> 