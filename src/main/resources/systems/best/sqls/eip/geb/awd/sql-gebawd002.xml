<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper">

    <insert id="insertCSPDCP603M" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.insertCSPDCP603M */
        INSERT INTO
       			  TBCSPDCP603M
        (
            REQ_DVSN_CD
          , ACP_YR
          , CVPT_ACP_NO
          , ACP_STEP_CD
          , DOC_ID
          , RPRT_NM
          , LINK_URL
          , NECES_YN
          , APV_STA_CD
          , RPRT_CD
          , APV_RQS_ID
          , DOC_KND_CD
          , SORT_SNO
          , CON_PGM_CD
          , APV_WAY_CD
          , DOC_WRT_ID
          , ONR_HNDL_NO
        <if test="templateDocId != null and templateDocId != ''">
          , TEMPLATE_DOC_ID
        </if>
        <if test="refId != null and refId != ''">
          , REF_ID
        </if>
        <if test="refDy != null and refDy != ''">
          , REF_DY
        </if>
          , SRNO
          , FRT_USR_ID
          , FNL_USR_ID
          , FNL_DEAL_DPT_CD
          , FNL_MNU_ID
          , FRT_REGI_DH
          , FNL_MDF_DH
        ) VALUES (
            #{reqDvsnCd}
          , #{acpYr}
          , #{cvptAcpNo}
          , #{acpStepCd}
          , #{docId}
          , #{rprtNm}
          , #{linkUrl}
          , #{necesYn}
          , #{apvStaCd}
          , #{rprtCd}
          , #{apvRqsId}
          , #{docKndCd}
          , (SELECT NVL(MAX(SORT_SNO), 0) + 1 
               FROM TBCSPDCP603M
              WHERE 1=1
                AND ACP_YR      = #{acpYr}
                AND CVPT_ACP_NO = #{cvptAcpNo}
                AND ACP_STEP_CD = #{acpStepCd})
          , #{conPgmCd}
          , #{apvWayCd}
          , #{usrId}
          , #{onrHndlNo}
        <if test="templateDocId != null and templateDocId != ''">
          , #{templateDocId}
        </if>
        <if test="refId != null and refId != ''">
          , #{refId} 
        </if>
        <if test="refDy != null and refDy != ''">
          , #{refDy}
        </if>
          , #{dge}
          , #{usrId}
          , #{usrId}
          , #{dptCd}
          , #{menuNo}
          , SYSDATE
          , SYSDATE)
    </insert>
    
    <insert id="insertCORCOR603M" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.insertCORCOR603M */
        INSERT INTO
        	     TBCORCOR603M
        (
            REQ_DVSN_CD
          , ACP_YR
          , CVPT_ACP_NO
          , ACP_STEP_CD
          , DOC_ID
          , RPRT_NM
          , LINK_URL
          , NECES_YN
          , APV_STA_CD
          , RPRT_CD
          , APV_RQS_ID
          , DOC_KND_CD
          , SORT_SNO
          , CON_PGM_CD
          , APV_WAY_CD
          , DOC_WRT_ID
          , ONR_HNDL_NO
        <if test="templateDocId != null and templateDocId != ''">
          , TEMPLATE_DOC_ID
        </if>
        <if test="refId != null and refId != ''">
          , REF_ID
        </if>
        <if test="refDy != null and refDy != ''">
          , REF_DY
        </if>
          , FRT_USR_ID
          , FNL_USR_ID
          , FNL_DEAL_DPT_CD
          , FNL_MNU_ID
          , FRT_REGI_DH
          , FNL_MDF_DH
        ) VALUES (
            #{reqDvsnCd}
          , #{acpYr}
          , #{cvptAcpNo}
          , #{acpStepCd}
          , #{docId}
          , #{rprtNm}
          , #{linkUrl}
          , #{necesYn}
          , #{apvStaCd}
          , #{rprtCd}
          , #{apvRqsId}
          , #{docKndCd}
          , (SELECT NVL(MAX(SORT_SNO), 0) + 1 
               FROM TBCORCOR603M
              WHERE 1=1
                AND ACP_YR      = #{acpYr}
                AND CVPT_ACP_NO = #{cvptAcpNo}
                AND ACP_STEP_CD = #{acpStepCd})
          , #{conPgmCd}
          , #{apvWayCd}
          , #{usrId}
          , #{onrHndlNo}
        <if test="templateDocId != null and templateDocId != ''">
          , #{templateDocId}
        </if>
        <if test="refId != null and refId != ''">
          , #{refId} 
        </if>
        <if test="refDy != null and refDy != ''">
          , #{refDy}
        </if>
          , #{usrId}
          , #{usrId}
          , #{dptCd}
          , #{menuNo}
          , SYSDATE
          , SYSDATE)
    </insert>
    
    <insert id="insertDCPDCP603M" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.insertDCPDCP603M */
        INSERT INTO
        TBDCPDCP603M
        (
            REQ_DVSN_CD
          , ACP_YR
          , CVPT_ACP_NO
          , ACP_STEP_CD
          , DOC_ID
          , RPRT_NM
          , LINK_URL
          , NECES_YN
          , APV_STA_CD
          , RPRT_CD
          , APV_RQS_ID
          , DOC_KND_CD
          , SORT_SNO
          , CON_PGM_CD
          , APV_WAY_CD
          , DOC_WRT_ID
          , ONR_HNDL_NO
        <if test="templateDocId != null and templateDocId != ''">
          , TEMPLATE_DOC_ID
        </if>
        <if test="refId != null and refId != ''">
          , REF_ID
        </if>
        <if test="refDy != null and refDy != ''">
          , REF_DY
        </if>
          , FRT_USR_ID
          , FNL_USR_ID
          , FNL_DEAL_DPT_CD
          , FNL_MNU_ID
          , FRT_REGI_DH
          , FNL_MDF_DH
        ) VALUES (
            #{reqDvsnCd}
          , #{acpYr}
          , #{cvptAcpNo}
          , #{acpStepCd}
          , #{docId}
          , #{rprtNm}
          , #{linkUrl}
          , #{necesYn}
          , #{apvStaCd}
          , #{rprtCd}
          , #{apvRqsId}
          , #{docKndCd}
          , (SELECT NVL(MAX(SORT_SNO), 0) + 1 
               FROM TBDCPDCP603M
              WHERE 1=1
                AND ACP_YR      = #{acpYr}
                AND CVPT_ACP_NO = #{cvptAcpNo}
                AND ACP_STEP_CD = #{acpStepCd})
          , #{conPgmCd}
          , #{apvWayCd}
          , #{usrId}
          , #{onrHndlNo}
        <if test="templateDocId != null and templateDocId != ''">
          , #{templateDocId}
        </if>
        <if test="refId != null and refId != ''">
          , #{refId} 
        </if>
        <if test="refDy != null and refDy != ''">
          , #{refDy}
        </if>
          , #{usrId}
          , #{usrId}
          , #{dptCd}
          , #{menuNo}
          , SYSDATE
          , SYSDATE)
    </insert>

    <update id="updateCSPDCP603M" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateCSPDCP603M */
        UPDATE TBCSPDCP603M
           SET FNL_MDF_DH      = SYSDATE
             , FNL_USR_ID      = #{usrId}
             , FNL_DEAL_DPT_CD = #{dptCd}
        <if test="rprtNm != null and rprtNm != ''">
             , RPRT_NM         = #{rprtNm}
        </if>
        <if test="linkUrl != null and linkUrl != ''">
             , LINK_URL        = #{linkUrl}
        </if>
        <if test="apvStaCd != null and apvStaCd != ''">
             , APV_STA_CD      = #{apvStaCd}
        </if>
        <if test="apvRqsId != null and apvRqsId != ''">
             , APV_RQS_ID      = #{apvRqsId}
        </if>
        <if test="onrHndlNo != null and onrHndlNo != ''">
             , ONR_HNDL_NO     = #{onrHndlNo}
        </if>
        <if test="refId != null and refId != ''">
             , REF_ID          = #{refId} 
        </if>
        <if test="refDy != null and refDy != ''">
             , REF_DY          = #{refDy}
        </if>
         WHERE 1=1
           AND REQ_DVSN_CD = #{reqDvsnCd}
		   AND ACP_YR      = #{acpYr}
           AND CVPT_ACP_NO = #{cvptAcpNo}
           AND ACP_STEP_CD = #{acpStepCd}
           AND DOC_ID      = #{docId}
    </update>
    
    <update id="updateCORCOR603M" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateCORCOR603M */
        UPDATE TBCORCOR603M
           SET FNL_MDF_DH      = SYSDATE
             , FNL_USR_ID      = #{usrId}
             , FNL_DEAL_DPT_CD = #{dptCd}
        <if test="rprtNm != null and rprtNm != ''">
             , RPRT_NM         = #{rprtNm}
        </if>
        <if test="linkUrl != null and linkUrl != ''">
             , LINK_URL        = #{linkUrl}
        </if>
        <if test="apvStaCd != null and apvStaCd != ''">
             , APV_STA_CD      = #{apvStaCd}
        </if>
        <if test="apvRqsId != null and apvRqsId != ''">
             , APV_RQS_ID      = #{apvRqsId}
        </if>
        <if test="onrHndlNo != null and onrHndlNo != ''">
             , ONR_HNDL_NO     = #{onrHndlNo}
        </if>
        <if test="refId != null and refId != ''">
             , REF_ID          = #{refId} 
        </if>
        <if test="refDy != null and refDy != ''">
             , REF_DY          = #{refDy}
        </if>
         WHERE 1=1
           AND REQ_DVSN_CD = #{reqDvsnCd}
		   AND ACP_YR      = #{acpYr}
           AND CVPT_ACP_NO = #{cvptAcpNo}
           AND ACP_STEP_CD = #{acpStepCd}
           AND DOC_ID      = #{docId}
    </update>
    
    <update id="updateDCPDCP603M" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateDCPDCP603M */
        UPDATE TBDCPDCP603M
           SET FNL_MDF_DH      = SYSDATE
             , FNL_USR_ID      = #{usrId}
             , FNL_DEAL_DPT_CD = #{dptCd}
        <if test="rprtNm != null and rprtNm != ''">
             , RPRT_NM         = #{rprtNm}
        </if>
        <if test="linkUrl != null and linkUrl != ''">
             , LINK_URL        = #{linkUrl}
        </if>
        <if test="apvStaCd != null and apvStaCd != ''">
             , APV_STA_CD      = #{apvStaCd}
        </if>
        <if test="apvRqsId != null and apvRqsId != ''">
             , APV_RQS_ID      = #{apvRqsId}
        </if>
        <if test="onrHndlNo != null and onrHndlNo != ''">
             , ONR_HNDL_NO     = #{onrHndlNo}
        </if>
        <if test="refId != null and refId != ''">
             , REF_ID          = #{refId} 
        </if>
        <if test="refDy != null and refDy != ''">
             , REF_DY          = #{refDy}
        </if>
         WHERE 1=1
           AND REQ_DVSN_CD = #{reqDvsnCd}
		   AND ACP_YR      = #{acpYr}
           AND CVPT_ACP_NO = #{cvptAcpNo}
           AND ACP_STEP_CD = #{acpStepCd}
           AND DOC_ID      = #{docId}
    </update>
    
    <select id="getAudDocData" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getAudDocData */
        <if test=" 'Y'.toString() == onlyDocIdParam " >
        SELECT T.*
          FROM (
        </if>
        	 	 SELECT *
                  FROM TBCSPDCP603M
                 WHERE 1=1
        <if test =" onlyDocIdParam == null or onlyDocIdParam == '' " >
                   AND REQ_DVSN_CD = #{reqDvsnCd}
				   AND ACP_YR      = #{acpYr}
		           AND CVPT_ACP_NO = #{cvptAcpNo}
		           AND ACP_STEP_CD = #{acpStepCd}
		           AND DOC_ID      = #{docId}
        </if>
        <if test=" 'Y'.toString() == onlyDocIdParam " >
         	       AND DOC_ID      = #{docId}
         	     ORDER BY ACP_STEP_CD DESC) T
         WHERE 1=1
           AND ROWNUM = 1
      </if>
    </select>
    
    <select id="getAudDocDataCOR" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getAudDocDataCOR*/
        <if test=" 'Y'.toString() == onlyDocIdParam " >
             SELECT T.* FROM (
      </if>
        SELECT * FROM TBCORCOR603M
          WHERE 1=1
      <if test =" onlyDocIdParam == null or onlyDocIdParam == '' " >
         AND REQ_DVSN_CD = #{reqDvsnCd}
		 AND ACP_YR = #{acpYr}
         AND CVPT_ACP_NO = #{cvptAcpNo}
         AND ACP_STEP_CD = #{acpStepCd}
         AND DOC_ID = #{docId}
      </if>
      <if test=" 'Y'.toString() == onlyDocIdParam " >
         	AND DOC_ID = #{docId}
         	ORDER BY ACP_STEP_CD DESC
         ) T
         WHERE ROWNUM=1
      </if>
    </select>
    
    <select id="getAudDocDataDCP" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getAudDocDataDCP*/
        <if test=" 'Y'.toString() == onlyDocIdParam " >
             SELECT T.* FROM (
      </if>
        SELECT * FROM TBDCPDCP603M
          WHERE 1=1
      <if test =" onlyDocIdParam == null or onlyDocIdParam == '' " >
         AND REQ_DVSN_CD = #{reqDvsnCd}
		 AND ACP_YR = #{acpYr}
         AND CVPT_ACP_NO = #{cvptAcpNo}
         AND ACP_STEP_CD = #{acpStepCd}
         AND DOC_ID = #{docId}
      </if>
      <if test=" 'Y'.toString() == onlyDocIdParam " >
         	AND DOC_ID = #{docId}
         	ORDER BY ACP_STEP_CD DESC
         ) T
         WHERE ROWNUM=1
      </if>
    </select>
    
    <update id="updateDcmFileNm" parameterType="paramMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateDcmFileNm */
          UPDATE TBCSPDCP608D
             SET FILE_NM = #{fileNm}
           WHERE 1=1
             AND REQ_DVSN_CD = #{reqDvsnCd}
             AND ACP_YR = #{acpYr}
             AND CVPT_ACP_NO = #{cvptAcpNo}
             AND EVI_DCMB_SNO = #{eviDcmbSno}
             AND ACP_DCM_DOC_ID = #{acpDcmDocId}
        ]]>
    </update>
    
    <!-- BEST20증거서류명 변경(부패행위) -->
    <update id="updateDcmFileNmCOR" parameterType="paramMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateDcmFileNmCOR */
          UPDATE TBCORCOR608D
             SET FILE_NM = #{fileNm}
           WHERE 1=1
             AND REQ_DVSN_CD = #{reqDvsnCd}
             AND ACP_YR = #{acpYr}
             AND CVPT_ACP_NO = #{cvptAcpNo}
             AND EVI_DCMB_SNO = #{eviDcmbSno}
             AND ACP_DCM_DOC_ID = #{acpDcmDocId}
        ]]>
    </update>
    
    <!-- BEST20증거서류명 변경(청탁금지) -->
    <update id="updateDcmFileNmDCP" parameterType="paramMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateDcmFileNmDCP */
          UPDATE TBDCPDCP608D
             SET FILE_NM = #{fileNm}
           WHERE 1=1
             AND REQ_DVSN_CD = #{reqDvsnCd}
             AND ACP_YR = #{acpYr}
             AND CVPT_ACP_NO = #{cvptAcpNo}
             AND EVI_DCMB_SNO = #{eviDcmbSno}
             AND ACP_DCM_DOC_ID = #{acpDcmDocId}
        ]]>
    </update>
    
    <select id="selectStepAcpSbjDocList" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectStepAcpSbjDocList*/
        SELECT RPRT_NM ,       /*보고서명 */
               SORT_SNO ,      /*정렬순번  */
               DOC_ID,         /*결재문서번호 */
               RPRT_CD,
               RPRT_CD AS AUD_DOC_CD,
               F_CODE_NM('1000786', RPRT_CD) AS AUD_DOC_NM,
               RPRT_NM AS DOC_NM
          FROM TBCSPDCP603M
         WHERE REQ_DVSN_CD = #{reqDvsnCd}
           AND ACP_YR = #{acpYr}
           AND CVPT_ACP_NO = #{cvptAcpNo}
           AND APV_WAY_CD IN ('10', '30')
         ORDER BY RPRT_CD
    </select>
    
    <update id="updateAudRprtNm" parameterType="paramMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateAudRprtNm */
          UPDATE TBCSPDCP603M 
             SET RPRT_NM = #{rprtNm}
           WHERE 1=1
             AND REQ_DVSN_CD = #{reqDvsnCd}
             AND ACP_YR = #{acpYr}
             AND CVPT_ACP_NO = #{cvptAcpNo}
             AND ACP_STEP_CD = #{acpStepCd}
             AND DOC_ID = #{docId}
        ]]>
    </update>
    
    <update id="updateCSPDCP602M" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateCSPDCP602M*/
        UPDATE TBCSPDCP602M
           SET CMPT_YN         = 'Y'
             , FNL_MDF_DH      = SYSDATE
             , FNL_USR_ID      = #{usrId}
             , FNL_DEAL_DPT_CD = #{dptCd}
         WHERE 1=1
           AND ACP_YR            = #{acpYr}
           AND REQ_DVSN_CD       = #{reqDvsnCd}
           AND CVPT_ACP_NO       = #{cvptAcpNo}
           AND ACP_STEP_CD       = #{acpStepCd}
           AND ACP_MAIN_STEP_ID  = #{acpMainStepId}
        <if test='acpMainStepSno != null and acpMainStepSno != ""'>
           AND ACP_MAIN_STEP_SNO = #{acpMainStepSno}
        </if>
        <if test='srno != null and srno != ""'>
           AND SRNO              = #{srno}
        </if>
        <if test='dge != null and dge != ""'>
           AND SRNO              = #{dge}
        </if>
    </update>
    
    <update id="updateCORCOR602M" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateCORCOR602M*/
        UPDATE TBCORCOR602M
           SET CMPT_YN         = 'Y'
             , FNL_MDF_DH      = SYSDATE
             , FNL_USR_ID      = #{usrId}
             , FNL_DEAL_DPT_CD = #{dptCd}
         WHERE 1=1
           AND ACP_YR            = #{acpYr}
           AND REQ_DVSN_CD       = #{reqDvsnCd}
           AND CVPT_ACP_NO       = #{cvptAcpNo}
           AND ACP_STEP_CD       = #{acpStepCd}
           AND ACP_MAIN_STEP_ID  = #{acpMainStepId}
        <if test='acpMainStepSno != null and acpMainStepSno != ""'>
           AND ACP_MAIN_STEP_SNO = #{acpMainStepSno}
        </if>
    </update>
    
    <update id="updateDCPDCP602M" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateDCPDCP602M*/
        UPDATE TBDCPDCP602M
           SET CMPT_YN         = 'Y'
             , FNL_MDF_DH      = SYSDATE
             , FNL_USR_ID      = #{usrId}
             , FNL_DEAL_DPT_CD = #{dptCd}
         WHERE 1=1
           AND ACP_YR            = #{acpYr}
           AND REQ_DVSN_CD       = #{reqDvsnCd}
           AND CVPT_ACP_NO       = #{cvptAcpNo}
           AND ACP_STEP_CD       = #{acpStepCd}
           AND ACP_MAIN_STEP_ID  = #{acpMainStepId}
        <if test='acpMainStepSno != null and acpMainStepSno != ""'>
           AND ACP_MAIN_STEP_SNO = #{acpMainStepSno}
        </if>
    </update>
    
    <select id="getEvdencDocData" parameterType="paramMap" resultType="egovMap" >
		/* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getEvdencDocData*/
		<![CDATA[
		SELECT A.FOLDER_NM  /*폴더명 */
			 , B.FILE_NM	        /*파일명 */
             , B.ACP_DCM_DOC_ID
             , B.EVI_DCMB_SNO
             , B.EVI_DCM_DVSN_CD
             , F_CODE_NM('1000776',B.EVI_DCM_DVSN_CD) AS EVI_DCM_DVSN_NM
		 FROM TBCSPDCP608M A INNER JOIN TBCSPDCP608D B
		   ON A.ACP_YR = B.ACP_YR /*접수년도 */
		  AND A.REQ_DVSN_CD = B.REQ_DVSN_CD /* 구분코드 */
		  AND A.CVPT_ACP_NO = B.CVPT_ACP_NO /*접수번호 */
		  AND A.EVI_DCMB_SNO = B.EVI_DCMB_SNO   /*서류함순번 */
		  AND B.EVI_DCM_DVSN_CD <> '99'
		WHERE 1=1
		]]>
		<if test="eviDcmbDvsnCd != null">
		  AND B.EVI_DCMB_DVSN_CD = #{eviDcmbDvsnCd}
		</if>
		  AND A.ACP_YR = #{acpYr}
		  AND A.REQ_DVSN_CD = #{reqDvsnCd}
		  AND A.CVPT_ACP_NO = #{cvptAcpNo}
		  
		ORDER BY B.SORT_SNO
    </select>
    
    <!--* BEST20 부패행위*/  -->
    <select id="getEvdencDocDataCOR" parameterType="paramMap" resultType="egovMap" >
		/* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getEvdencDocDataCOR*/
		<![CDATA[
		SELECT A.FOLDER_NM  /*폴더명 */
			 , B.FILE_NM	        /*파일명 */
             , B.ACP_DCM_DOC_ID
             , B.EVI_DCMB_SNO
             , B.EVI_DCM_DVSN_CD
             , F_CODE_NM('1000776',B.EVI_DCM_DVSN_CD) AS EVI_DCM_DVSN_NM
		 FROM TBCORCOR608M A INNER JOIN TBCORCOR608D B
		   ON A.ACP_YR = B.ACP_YR /*접수년도 */
		  AND A.REQ_DVSN_CD = B.REQ_DVSN_CD /* 구분코드 */
		  AND A.CVPT_ACP_NO = B.CVPT_ACP_NO /*접수번호 */
		  AND A.EVI_DCMB_SNO = B.EVI_DCMB_SNO   /*서류함순번 */
		  AND B.EVI_DCM_DVSN_CD <> '99'
		WHERE 1=1
		]]>
		<if test="eviDcmbDvsnCd != null">
		  AND B.EVI_DCMB_DVSN_CD = #{eviDcmbDvsnCd}
		</if>
		  AND A.ACP_YR = #{acpYr}
		  AND A.REQ_DVSN_CD = #{reqDvsnCd}
		  AND A.CVPT_ACP_NO = #{cvptAcpNo}
		  
		ORDER BY B.SORT_SNO
    </select>
    
    <!--* BEST20 20.09.18 청탁금지*/  -->
    <select id="getEvdencDocDataDCP" parameterType="paramMap" resultType="egovMap" >
		/* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getEvdencDocDataDCP*/
		<![CDATA[
		SELECT A.FOLDER_NM  /*폴더명 */
			 , B.FILE_NM	        /*파일명 */
             , B.ACP_DCM_DOC_ID
             , B.EVI_DCMB_SNO
             , B.EVI_DCM_DVSN_CD
             , F_CODE_NM('1000776',B.EVI_DCM_DVSN_CD) AS EVI_DCM_DVSN_NM
		 FROM TBDCPDCP608M A INNER JOIN TBDCPDCP608D B
		   ON A.ACP_YR = B.ACP_YR /*접수년도 */
		  AND A.REQ_DVSN_CD = B.REQ_DVSN_CD /* 구분코드 */
		  AND A.CVPT_ACP_NO = B.CVPT_ACP_NO /*접수번호 */
		  AND A.EVI_DCMB_SNO = B.EVI_DCMB_SNO   /*서류함순번 */
		  AND B.EVI_DCM_DVSN_CD <> '99'
		WHERE 1=1
		]]>
		<if test="eviDcmbDvsnCd != null">
		  AND B.EVI_DCMB_DVSN_CD = #{eviDcmbDvsnCd}
		</if>
		  AND A.ACP_YR = #{acpYr}
		  AND A.REQ_DVSN_CD = #{reqDvsnCd}
		  AND A.CVPT_ACP_NO = #{cvptAcpNo}
		  
		ORDER BY B.SORT_SNO
    </select>
    
    <select id="selectAudGrnNo" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectAudGrnNo */
        SELECT /*A1.AUD_KND_CD,*/
               /*F_MNG_KND_AUDYRNO(A1.AUD_YR, A1.AUD_NO, A1.AUD_KND_CD, '-') as AUD_YR_GRN_NO,*/
               A1.LINK_URL
          FROM TBCSPDCP603M as A1
         WHERE REQ_DVSN_CD = #{reqDvsnCd}
           AND ACP_YR = #{acpYr}
           AND CVPT_ACP_NO = #{cvptAcpNo}
           AND ACP_STEP_CD = #{acpStepCd}
           AND DOC_ID = #{docId}
        ]]>
    </select>
    
    <update id="updateSvyRsltRprtTxt" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateSvyRsltRprtTxt */
   		 /*제보 조사결과보고서 업데이트쿼리*/
		UPDATE TBCSPDCP201M
		      SET	ANS_TXT = #{ansTxt, jdbcType=CLOB} 
		 	     ,	ANS_TXT2 = #{ansTxt2, jdbcType=CLOB} 
		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		   AND	ACP_YR = #{acpYr}
		   AND	CVPT_ACP_NO = #{cvptAcpNo}
    </update>
    
    <update id="updateSvyRsltRprtTxtCOR" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateSvyRsltRprtTxtCOR */
   		 /*부패방지 조사결과보고서 업데이트쿼리*/
		UPDATE TBCORCOR201M
		      SET	ANS_TXT = #{ansTxt, jdbcType=CLOB} 
		      , ANS_TXT2 = ' '
		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		   AND	ACP_YR = #{acpYr}
		   AND	CVPT_ACP_NO = #{cvptAcpNo}
    </update>
    
    <update id="updateSvyRsltRprtTxtDCP" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateSvyRsltRprtTxtDCP */
   		 /*청탁금지 조사결과보고서 업데이트쿼리*/
		UPDATE	TBDCPDCP201M
		      SET	ANS_TXT = #{ansTxt, jdbcType=CLOB} 
		      	 ,	ANS_TXT2 = #{ansTxt2, jdbcType=CLOB} 
		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		   AND	ACP_YR = #{acpYr}
		   AND	CVPT_ACP_NO = #{cvptAcpNo}
    </update>
    
    <update id="updateCvptSvyRsltRprtTxt" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateCvptSvyRsltRprtTxt */
   		 /*제보 조사결과보고서(일반민원) 업데이트쿼리*/
		UPDATE	TBCSPDCP401H
		      SET	ANS_TXT = #{ansTxt, jdbcType=CLOB} 
		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		   AND	ACP_YR = #{acpYr}
		   AND	CVPT_ACP_NO = #{cvptAcpNo}
		   <if test="dge != null and dge != ''">
		   AND 	DGE = #{dge}
		   </if>
    </update>
    
    <update id="updateCvptSvyRsltRprtTxtCOR" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateCvptSvyRsltRprtTxtCOR */
   		 /*부패행위 조사결과보고서(일반민원) 업데이트쿼리*/
		UPDATE	TBCORCOR401H
		      SET	ANS_TXT = #{ansTxt, jdbcType=CLOB} 
		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		   AND	ACP_YR = #{acpYr}
		   AND	CVPT_ACP_NO = #{cvptAcpNo}
		   <if test="dge != null and dge != ''">
		   AND 	DGE = #{dge}
		   </if>
    </update>
    
    <update id="updateCvptSvyRsltRprtTxtDCP" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateCvptSvyRsltRprtTxtDCP */
   		 /*청탁금지 조사결과보고서(일반민원) 업데이트쿼리*/
		UPDATE	TBDCPDCP401H
		      SET	ANS_TXT = #{ansTxt, jdbcType=CLOB} 
		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		   AND	ACP_YR = #{acpYr}
		   AND	CVPT_ACP_NO = #{cvptAcpNo}
		   <if test="dge != null and dge != ''">
		   AND 	DGE = #{dge}
		   </if>
    </update>
    
  <resultMap type="java.util.HashMap" id="rsltRprtMainMap">
	
     <result property="reqDvsnCd" column="REQ_DVSN_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="acpYr" column="ACP_YR" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="cvptAcpNo" column="CVPT_ACP_NO" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="acpNo" column="ACP_NO" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="cptYn" column="CPT_YN" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="acpRutNm" column="ACP_RUT_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="acpRutDtlCd" column="ACP_RUT_DTL_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="cvptrNm" column="CVPTR_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="jbNm" column="JB_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="rpstPenNm" column="RPST_PEN_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="bzn" column="BZN" jdbcType="VARCHAR"	javaType="java.lang.String" />
     
	 <result property="cpnmNm" column="CPNM_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="zcd" column="ZCD" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="ad" column="AD" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="hpn" column="HPN" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="emlId" column="EML_ID" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="emlDmiNm" column="EML_DMI_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="openYn" column="OPEN_YN" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="mngTypCd" column="MNG_TYP_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="rsltNtfWayCd" column="RSLT_NTF_WAY_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="rsltNtfWayNm" column="RSLT_NTF_WAY_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />

     <result property="titNm" column="TIT_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="acpDptCd" column="ACP_DPT_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="acpDptNm" column="ACP_DPT_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="rcepId" column="RCEP_ID" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="rcepNm" column="RCEP_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="acpDh" column="ACP_DH" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="cvptHndlStaCd" column="CVPT_HNDL_STA_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="audInfTgYn" column="AUD_INF_TG_YN" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="smgCvptAplNo" column="SMG_CVPT_APL_NO" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="smgCvptAcpNo" column="SMG_CVPT_ACP_NO" jdbcType="VARCHAR"	javaType="java.lang.String" />
     
     <result property="smgFnlHndlStaCd" column="SMG_FNL_HNDL_STA_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="smgCvptAplDh" column="SMG_CVPT_APL_DH" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="smgFrtCvptAplGccOrgCd" column="SMG_FRT_CVPT_APL_GCC_ORG_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property= "smgCatHstSrno" column="SMG_CAT_HST_SRNO" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="cvptTxt" column="CVPT_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
	 <result property="cvptSbt" column="CVPT_SBT" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="clmNm" column="CLM_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="wrkPlacNm" column="WRK_PLAC_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="clmZcd" column="CLM_ZCD" jdbcType="VARCHAR"	javaType="java.lang.String" />	
	 <result property="clmAd" column="CLM_AD" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 
     <result property="clmDtlAd" column="CLM_DTL_AD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="ansTxt" column="ANS_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
     <result property="cvptHnldDvsnNm" column="CVPT_HNLD_DVSN_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="hndlDptNm" column="HNDL_DPT_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="audRfrMtrlTrnkHstDptCd" column="AUD_RFR_MTRL_TRNF_HST_DPT_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="trnfDptNm" column="TRNF_DPT_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="orgNm" column="ORG_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="coptSgNm" column="COPT_SG_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="trnfOrgNm" column="TRNF_ORG_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="acpCnt" column="ACP_CNT" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 
	 <result property="cvptHndlDvsnCd" column="CVPT_HNDL_DVSN_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="sucTxt" column="SUC_TXT" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="fnlHndlDh" column="FNL_HNDL_DH" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="fnlApvDh" column="FNL_APV_DH" jdbcType="VARCHAR"	javaType="java.lang.String" />
	 <result property="audInfTrfDvsnCd" column="AUD_INF_TRF_DVSN_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
    </resultMap>
    
    <select id="selectSvyRsltRprtMainList" parameterType="paramMap" resultMap="rsltRprtMainMap" >
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectSvyRsltRprtMainList */
                     SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,(CASE WHEN A.REQ_DVSN_CD = '1' THEN A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO
                                                                 ELSE DECODE(A.RM_CVPT_ACP_NO,NULL,NULL,A.ACP_YR||'-'||F_CODE_NM('1000740',A.REQ_DVSN_CD)||'-'||A.RM_CVPT_ACP_NO)
                       END) AS ACP_NO /*분류번호*/
                    , DECODE(A.RM_ACP_KND_CD,'2','Y','N') AS CPT_YN /* BEST20 민원구분 */
                    ,F_CODE_NM('1000056', A.ACP_RUT_CD) AS ACP_RUT_NM          /*접수형태*/
   					,A.ACP_RUT_DTL_CD 
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM  /*20170726 EUNOK 수정 A.CVPTR_NM */
   					,A.JB_NM
   					,A.RPST_PEN_NM
   					,A.BZN
   					,A.CPNM_NM
   					,A.ZCD
   					,A.AD || ' ' || A.DTL_AD AS AD                      /*주소*/
    				,A.HPN                                          /*전화번호*/
   					,A.EML_ID
   					,A.EML_DMI_NM
   					,A.OPEN_YN
   					,A.MNG_TYP_CD
   					,A.RSLT_NTF_WAY_CD
                    ,CASE WHEN A.ACP_RUT_CD = '8' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						WHEN A.ACP_RUT_CD <> '8' AND A.RSLT_NTF_WAY_CD = '003' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						ELSE '홈페이지+'||F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)  END AS RSLT_NTF_WAY_NM        /*회신방식*/
   					,A.TIT_NM                                               /*제목*/
   					,A.ACP_DPT_CD
   					,F_DPT_INFO(A.ACP_DPT_CD,'1') AS ACP_DPT_NM             /*접수국과*/
   					,A.RCEP_ID
   					,F_USR_INFO_BY_ID(A.RCEP_ID,'2') AS RCEP_NM
   					,TO_CHAR(A.ACP_DH,'YYYY.MM.DD') AS ACP_DH       /*감사요청일*/
   					,A.CVPT_HNDL_STA_CD
   					,A.AUD_INF_TG_YN
   					,A.SMG_CVPT_APL_NO
   					,A.SMG_CVPT_ACP_NO
   					,A.SMG_FNL_HNDL_STA_CD
   					,A.SMG_CVPT_APL_DH
   					,A.SMG_FRT_CVPT_APL_GCC_ORG_CD
   					,A.SMG_CAT_HST_SRNO
   					,B.CVPT_TXT
   					,B.CVPT_SBT                                             /*요지*/
   					,C.CLM_NM
   					,C.WRK_PLAC_NM
   					,C.ZCD AS CLM_ZCD
   					,C.AD AS CLM_AD
   					,C.DTL_AD AS CLM_DTL_AD
   					,(SELECT AUD_INF_TRF_DVSN_CD FROM TBCSPDCP101M T1 WHERE	T1.REQ_DVSN_CD = A.REQ_DVSN_CD AND T1.ACP_YR = A.ACP_YR AND T1.CVPT_ACP_NO = A.CVPT_ACP_NO) AS AUD_INF_TRF_DVSN_CD
                    ,(	SELECT	F_CODE_NM('1000754', S3.CVPT_HNDL_DVSN_CD)
			      		FROM	TBCSPDCP205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBCSPDCP205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS CVPT_HNLD_DVSN_NM        /*처 리결과 - 단순종결,조사종결,즉시해소,즉시시정,감사실시,위탁조사,이송(대내),이첩*/
                    ,F_DPT_INFO(D.HNDL_DPT_CD,'1') AS HNDL_DPT_NM       /*처리부서*/
                    ,(	SELECT	DECODE(S3.AUD_RFR_MTRL_TRNF_DPT_CD,NULL,'',SUBSTR(S3.AUD_RFR_MTRL_TRNF_DPT_CD,1,3)||'000')
			      		FROM	TBCSPDCP205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBCSPDCP205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS AUD_RFR_MTRL_TRNF_HST_DPT_CD
                    ,(	SELECT	F_DPT_INFO(NVL(S3.TRNF_DPT_CD, S3.AUD_RFR_MTRL_TRNF_DPT_CD), '1')
			      		FROM	TBCSPDCP205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM TBCSPDCP205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS TRNF_DPT_NM                      /*대내이송부서*/
                     , (SELECT CASE WHEN S6.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(S6.ORG_CD,'1')
                                    ELSE S6.ORG_NM END AS ORG_NM
                        FROM TBCSPDCP206L S6
                        WHERE	(S6.REQ_DVSN_CD, S6.ACP_YR, S6.CVPT_ACP_NO, S6.HNDL_ORG_SRNO) IN (
                            SELECT S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO,MIN(S5.HNDL_ORG_SRNO)
                            FROM TBCSPDCP206L S5
                            WHERE A.REQ_DVSN_CD = S5.REQ_DVSN_CD
                            AND	A.ACP_YR = S5.ACP_YR
                            AND A.CVPT_ACP_NO = S5.CVPT_ACP_NO
                            AND S5.ORG_HIS_DVSN_CD ='1'
                            GROUP BY S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO
                         )
                       ) AS ORG_NM          /*관련기관*/
                     , (SELECT F_ORG_HRK_NM(S6.COPT_SG_CD)
                        FROM TBCSPDCP206L S6
                        WHERE	(S6.REQ_DVSN_CD, S6.ACP_YR, S6.CVPT_ACP_NO, S6.HNDL_ORG_SRNO) IN (
                            SELECT S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO,MIN(S5.HNDL_ORG_SRNO)
                            FROM TBCSPDCP206L S5
                            WHERE A.REQ_DVSN_CD = S5.REQ_DVSN_CD
                            AND	A.ACP_YR = S5.ACP_YR
                            AND A.CVPT_ACP_NO = S5.CVPT_ACP_NO
                            AND S5.ORG_HIS_DVSN_CD ='1'
                            GROUP BY S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO
                         )
                       ) AS COPT_SG_NM      /*소관청*/
                       , (SELECT F_ORG_INFO(S6.ORG_CD,'1')
                        FROM TBCSPDCP206L S6
                        WHERE	(S6.REQ_DVSN_CD, S6.ACP_YR, S6.CVPT_ACP_NO, S6.HNDL_ORG_SRNO) IN (
                            SELECT S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO,MIN(S5.HNDL_ORG_SRNO)
                            
                            FROM TBCSPDCP206L S5
                            
                            WHERE A.REQ_DVSN_CD = S5.REQ_DVSN_CD
                            AND	A.ACP_YR = S5.ACP_YR
                            AND A.CVPT_ACP_NO = S5.CVPT_ACP_NO
                            AND (S5.ORG_HIS_DVSN_CD ='3' OR S5.ORG_HIS_DVSN_CD ='2')
                            GROUP BY S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO
                         )
                       ) AS TRNF_ORG_NM     /*대외이송*/
                      , ( SELECT	COUNT(ROWNUM)
                            FROM	TBCSPDCP101M S7
                                    ,TBCSPDCP201M S8
                                    ,(	SELECT	Z1.CVPTR_NM, Z1.RPST_PEN_NM, Z1.HPN
                                        FROM	TBCSPDCP101M Z1
                                        WHERE	Z1.REQ_DVSN_CD = #{reqDvsnCd}
                                        AND		Z1.ACP_YR = #{acpYr}
                                        AND		Z1.CVPT_ACP_NO = #{cvptAcpNo}
                                    ) S9
                            WHERE	1=1
                            AND		S7.REQ_DVSN_CD = #{reqDvsnCd}
                            AND		S7.REQ_DVSN_CD = S8.REQ_DVSN_CD(+)
                            AND		S7.ACP_YR = S8.ACP_YR(+)
                            AND		S7.CVPT_ACP_NO = S8.CVPT_ACP_NO(+)
                            AND		S7.REQR_KND_CD <> '4'
                            AND		NOT EXISTS (
                                        SELECT 	''
                                        FROM	TBCSPDCP101M Z2
                                        WHERE	Z2.REQ_DVSN_CD = #{reqDvsnCd}
                                        AND		Z2.ACP_YR = #{acpYr}
                                        AND		Z2.CVPT_ACP_NO = #{cvptAcpNo}
                                        AND 	Z2.REQ_DVSN_CD = S7.REQ_DVSN_CD
                                        AND 	Z2.ACP_YR = S7.ACP_YR
                                        AND 	Z2.CVPT_ACP_NO = S7.CVPT_ACP_NO
                                    )
                            AND	S7.CVPTR_NM = S9.CVPTR_NM
                            AND	S7.HPN = S9.HPN ) AS ACP_CNT            /*신고횟수*/
                            ]]>
                            
               <if test= ' isClient == "N" '>
              ,(	SELECT	S3.CVPT_HNDL_DVSN_CD
			      		FROM	TBCSPDCP205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM TBCSPDCP205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS CVPT_HNDL_DVSN_CD        /*처리결과 - 단순종결,조사종결,즉시해소,즉시시정,감사실시,위탁조사,이송(대내),이첩*/
             </if>
             <if test= ' isClient == "Y"  '>
              ,(SELECT S3.RSLT_RPRT_HNDL_RSLT_CD
                              FROM TBCSPDCP402L S3
                       WHERE  A.REQ_DVSN_CD = S3.REQ_DVSN_CD
			             AND  A.ACP_YR = S3.ACP_YR(+)
			             AND  A.CVPT_ACP_NO = S3.CVPT_ACP_NO
                         AND  S3.DGE  = #{dge} ) AS CVPT_HNDL_DVSN_CD   /* 감사결과 민원처리전 - 처리결과코드 */
             </if>
             
              <![CDATA[
               , ( ( SELECT NVL2(T1.TXT,'합건 - '||T1.TXT ,'')
                    FROM ( SELECT AGGR_CONCAT(B3.RM_CVPT_ACP_NO ,', ') txt 
                                 FROM TBCSPDCP105L B2
                                     LEFT OUTER JOIN TBCSPDCP101M B3 ON (B2.SUC_ACP_YR = B3.ACP_YR 
                                                                                        AND B2.SUC_CVPT_ACP_NO = B3.CVPT_ACP_NO 
                                                                                        AND B2.SUC_REQ_DVSN_CD = B3.REQ_DVSN_CD)
                               WHERE B2.REQ_DVSN_CD =#{reqDvsnCd}
                                  AND B2.ACP_YR = #{acpYr}
                                  AND B2.CVPT_ACP_NO = #{cvptAcpNo}  ) T1
                   ) ||
                   ( SELECT NVL2(T1.TXT,' 합건(처리과) - '||T1.TXT ,'')
                    FROM ( SELECT AGGR_CONCAT(B3.RM_CVPT_ACP_NO ,', ') txt 
                                 FROM TBCSPDCP953L B2
                                     LEFT OUTER JOIN TBCSPDCP101M B3 ON (B2.SUC_ACP_YR = B3.ACP_YR 
                                                                                        AND B2.SUC_CVPT_ACP_NO = B3.CVPT_ACP_NO 
                                                                                        AND B2.SUC_REQ_DVSN_CD = B3.REQ_DVSN_CD)
                               WHERE B2.REQ_DVSN_CD =#{reqDvsnCd}
                                  AND B2.ACP_YR = #{acpYr}
                                  AND B2.CVPT_ACP_NO = #{cvptAcpNo}  ) T1
                   ) ) AS SUC_TXT /* 합건 */              
                , ( SELECT TO_CHAR(E.FNL_APV_DH ,'YYYY. MM. DD')
                	 FROM TBDCMACM022L E
                		INNER JOIN TBCSPDCP603M F ON (E.APV_DOC_NO = F.APV_RQS_ID)
	                WHERE E.APV_STA_CD='3'
	                ]]>
	                <if test= ' isClient == "Y" '>
	                AND F.RPRT_CD ='B20200400'
	                </if>
	                <if test= ' isClient == "N" '>
	                AND F.RPRT_CD IN ('B10200400','B10200600')
	                </if>
	                <![CDATA[
                        
	                    AND F.REQ_DVSN_CD = A.REQ_DVSN_CD
	                    AND F.ACP_YR = A.ACP_YR
	                    AND F.CVPT_ACP_NO = A.CVPT_ACP_NO )  AS FNL_APV_DH /* 결재일 */
                , TO_CHAR(D.FNL_HNDL_DH,'YYYY. MM. DD') AS FNL_HNDL_DH /*처리완료일 */
   			FROM	TBCSPDCP101M A
   					,TBCSPDCP102M B
   					,TBCSPDCP103M C
                    ,TBCSPDCP201M D
          ]]>
         <if test= ' isClient == "Y" '>
                    ,TBCSPDCP205L E
          </if>
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
            AND     A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = C.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO(+)
            AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = D.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
   			<if test= ' isClient == "Y" '>
   			AND     A.CVPT_HNDL_STA_CD = '60' --민원처리는 완료상태인것만
            AND		A.REQ_DVSN_CD = E.REQ_DVSN_CD
   			AND		A.ACP_YR = E.ACP_YR
   			AND		A.CVPT_ACP_NO = E.CVPT_ACP_NO
            AND     E.CVPT_HNDL_DVSN_CD IN ('70','100')--민원처리는 대내이송만
            </if>
    </select>
    
    <select id="selectSvyRsltRprtMainListCOR" parameterType="paramMap" resultMap="rsltRprtMainMap" >
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectSvyRsltRprtMainListCOR */
                     SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,(CASE WHEN A.REQ_DVSN_CD = '1' THEN A.ACP_YR||'-'|| '부감' ||'-'||A.RM_CVPT_ACP_NO
                                                    ELSE DECODE(A.RM_CVPT_ACP_NO,NULL,NULL,A.ACP_YR||'-'|| '부감' ||'-'||A.RM_CVPT_ACP_NO)
                       END) AS ACP_NO /*분류번호*/
                    ,F_CODE_NM('1000056', A.ACP_RUT_CD) AS ACP_RUT_NM          /*접수형태*/
   					,A.ACP_RUT_DTL_CD 
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM  /*20170726 EUNOK 수정 A.CVPTR_NM */
   					,A.JB_NM
   					,A.RPST_PEN_NM
   					,A.BZN
   					,A.CPNM_NM
   					,A.ZCD
   					,A.AD || ' ' || A.DTL_AD AS AD                      /*주소*/
    				,A.HPN                                          /*전화번호*/
   					,A.EML_ID
   					,A.EML_DMI_NM
   					,A.OPEN_YN
   					,A.MNG_TYP_CD
   					,A.RSLT_NTF_WAY_CD
                    ,CASE WHEN A.ACP_RUT_CD = '8' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						WHEN A.ACP_RUT_CD <> '8' AND A.RSLT_NTF_WAY_CD = '003' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						ELSE '홈페이지+'||F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)  END AS RSLT_NTF_WAY_NM        /*회신방식*/
   					,A.TIT_NM                                               /*제목*/
   					,A.ACP_DPT_CD
   					,F_DPT_INFO(A.ACP_DPT_CD,'1') AS ACP_DPT_NM             /*접수국과*/
   					,A.RCEP_ID
   					,F_USR_INFO_BY_ID(A.RCEP_ID,'2') AS RCEP_NM
   					,TO_CHAR(A.ACP_DH,'YYYY.MM.DD') AS ACP_DH       /*감사요청일*/
   					,A.CVPT_HNDL_STA_CD
   					,A.AUD_INF_TG_YN
   					,A.SMG_CVPT_APL_NO
   					,A.SMG_CVPT_ACP_NO
   					,A.SMG_FNL_HNDL_STA_CD
   					,A.SMG_CVPT_APL_DH
   					,A.SMG_FRT_CVPT_APL_GCC_ORG_CD
   					,A.SMG_CAT_HST_SRNO
   					,B.CVPT_TXT
   					,B.CVPT_SBT                                             /*요지*/
   					,C.CLM_NM
   					,C.WRK_PLAC_NM
   					,C.ZCD AS CLM_ZCD
   					,C.AD AS CLM_AD
   					,C.DTL_AD AS CLM_DTL_AD
   					,(SELECT AUD_INF_TRF_DVSN_CD FROM TBCORCOR101M T1 WHERE	T1.REQ_DVSN_CD = A.REQ_DVSN_CD AND T1.ACP_YR = A.ACP_YR AND T1.CVPT_ACP_NO = A.CVPT_ACP_NO) AS AUD_INF_TRF_DVSN_CD
                    ,(	SELECT	F_CODE_NM('1000943', S3.CVPT_HNDL_DVSN_CD)
			      		FROM	TBCORCOR205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBCORCOR205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS CVPT_HNLD_DVSN_NM        /*처 리결과 - 단순종결,조사종결,즉시해소,즉시시정,감사실시,위탁조사,이송(대내),이첩*/
                    ,F_DPT_INFO(D.HNDL_DPT_CD,'1') AS HNDL_DPT_NM       /*처리부서*/
                    ,(	SELECT	DECODE(S3.AUD_RFR_MTRL_TRNF_DPT_CD,NULL,'',SUBSTR(S3.AUD_RFR_MTRL_TRNF_DPT_CD,1,3)||'000')
			      		FROM	TBCORCOR205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBCORCOR205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS AUD_RFR_MTRL_TRNF_HST_DPT_CD
                    ,(	SELECT	F_DPT_INFO(NVL(S3.TRNF_DPT_CD, S3.AUD_RFR_MTRL_TRNF_DPT_CD), '1')
			      		FROM	TBCORCOR205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBCORCOR205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS TRNF_DPT_NM                      /*대내이송부서*/
                     , (SELECT CASE WHEN S6.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(S6.ORG_CD,'1')
                                    ELSE S6.ORG_NM END AS ORG_NM
                        FROM TBCORCOR206L S6
                        WHERE	(S6.REQ_DVSN_CD, S6.ACP_YR, S6.CVPT_ACP_NO, S6.HNDL_ORG_SRNO) IN (
                            SELECT S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO,MIN(S5.HNDL_ORG_SRNO)
                            FROM TBCORCOR206L S5
                            WHERE A.REQ_DVSN_CD = S5.REQ_DVSN_CD
                            AND	A.ACP_YR = S5.ACP_YR
                            AND A.CVPT_ACP_NO = S5.CVPT_ACP_NO
                            AND S5.ORG_HIS_DVSN_CD ='1'
                            GROUP BY S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO
                         )
                       ) AS ORG_NM          /*관련기관*/
                     , (SELECT F_ORG_HRK_NM(S6.COPT_SG_CD)
                        FROM TBCORCOR206L S6
                        WHERE	(S6.REQ_DVSN_CD, S6.ACP_YR, S6.CVPT_ACP_NO, S6.HNDL_ORG_SRNO) IN (
                            SELECT S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO,MIN(S5.HNDL_ORG_SRNO)
                            FROM TBCORCOR206L S5
                            WHERE A.REQ_DVSN_CD = S5.REQ_DVSN_CD
                            AND	A.ACP_YR = S5.ACP_YR
                            AND A.CVPT_ACP_NO = S5.CVPT_ACP_NO
                            AND S5.ORG_HIS_DVSN_CD ='1'
                            GROUP BY S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO
                         )
                       ) AS COPT_SG_NM      /*소관청*/
                       , (SELECT F_ORG_INFO(S6.ORG_CD,'1')
                        FROM TBCORCOR206L S6
                        WHERE	(S6.REQ_DVSN_CD, S6.ACP_YR, S6.CVPT_ACP_NO, S6.HNDL_ORG_SRNO) IN (
                            SELECT S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO,MIN(S5.HNDL_ORG_SRNO)
                            FROM TBCORCOR206L S5
                            WHERE A.REQ_DVSN_CD = S5.REQ_DVSN_CD
                            AND	A.ACP_YR = S5.ACP_YR
                            AND A.CVPT_ACP_NO = S5.CVPT_ACP_NO
                            AND (S5.ORG_HIS_DVSN_CD ='3' OR S5.ORG_HIS_DVSN_CD ='2')
                            GROUP BY S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO
                         )
                       ) AS TRNF_ORG_NM     /*대외이송*/
                      , ( SELECT	COUNT(ROWNUM)
                            FROM	TBCORCOR101M S7
                                    ,TBCORCOR201M S8
                                    ,(	SELECT	Z1.CVPTR_NM, Z1.RPST_PEN_NM, Z1.HPN
                                        FROM	TBCORCOR101M Z1
                                        WHERE	Z1.REQ_DVSN_CD = #{reqDvsnCd}
                                        AND		Z1.ACP_YR = #{acpYr}
                                        AND		Z1.CVPT_ACP_NO = #{cvptAcpNo}
                                    ) S9
                            WHERE	1=1
                            AND		S7.REQ_DVSN_CD = #{reqDvsnCd}
                            AND		S7.REQ_DVSN_CD = S8.REQ_DVSN_CD(+)
                            AND		S7.ACP_YR = S8.ACP_YR(+)
                            AND		S7.CVPT_ACP_NO = S8.CVPT_ACP_NO(+)
                            AND		S7.REQR_KND_CD <> '4'
                            AND		NOT EXISTS (
                                        SELECT 	''
                                        FROM	TBCORCOR101M Z2
                                        WHERE	Z2.REQ_DVSN_CD = #{reqDvsnCd}
                                        AND		Z2.ACP_YR = #{acpYr}
                                        AND		Z2.CVPT_ACP_NO = #{cvptAcpNo}
                                        AND 	Z2.REQ_DVSN_CD = S7.REQ_DVSN_CD
                                        AND 	Z2.ACP_YR = S7.ACP_YR
                                        AND 	Z2.CVPT_ACP_NO = S7.CVPT_ACP_NO
                                    )
                            AND	S7.CVPTR_NM = S9.CVPTR_NM
                            AND	S7.HPN = S9.HPN ) AS ACP_CNT            /*신고횟수*/
                            ]]>
                            
               <if test= ' isClient == "N" '>
              ,(	SELECT	S3.CVPT_HNDL_DVSN_CD
			      		FROM	TBCORCOR205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBCORCOR205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS CVPT_HNDL_DVSN_CD        /*처리결과 - 단순종결,조사종결,즉시해소,즉시시정,감사실시,위탁조사,이송(대내),이첩*/
             </if>
             <if test= ' isClient == "Y"  '>
              ,(SELECT S3.RSLT_RPRT_HNDL_RSLT_CD
                              FROM TBCORCOR402L S3
                       WHERE  A.REQ_DVSN_CD = S3.REQ_DVSN_CD
			             AND  A.ACP_YR = S3.ACP_YR(+)
			             AND  A.CVPT_ACP_NO = S3.CVPT_ACP_NO
                         AND  S3.DGE  = #{dge} ) AS CVPT_HNDL_DVSN_CD   /* 감사결과 민원처리전 - 처리결과코드 */
             </if>
             
              <![CDATA[
               , ( SELECT NVL2(T1.TXT,'합건 - '||T1.TXT ,'')
                    FROM ( SELECT AGGR_CONCAT(B3.RM_CVPT_ACP_NO ,', ') txt 
                                 FROM TBCORCOR105L B2
                                     LEFT OUTER JOIN TBCORCOR101M B3 ON (B2.SUC_ACP_YR = B3.ACP_YR 
                                                                                        AND B2.SUC_CVPT_ACP_NO = B3.CVPT_ACP_NO 
                                                                                        AND B2.SUC_REQ_DVSN_CD = B3.REQ_DVSN_CD)
                               WHERE B2.REQ_DVSN_CD =#{reqDvsnCd}
                                  AND B2.ACP_YR = #{acpYr}
                                  AND B2.CVPT_ACP_NO = #{cvptAcpNo}  ) T1
                   ) AS SUC_TXT /* 합건 */        
                , ( SELECT TO_CHAR(E.FNL_APV_DH ,'YYYY. MM. DD')
                	 FROM UBCREOWN.TBDCMACM022L E
                		INNER JOIN TBCORCOR603M F ON (E.APV_DOC_NO = F.APV_RQS_ID)
	                WHERE E.APV_STA_CD='3'
	                ]]>
	                <if test= ' isClient == "Y" '>
	                AND F.RPRT_CD ='F20200400'
	                </if>
	                <if test= ' isClient == "N" '>
	                AND F.RPRT_CD IN ('F10200400','F10200600')
	                </if>
	                <![CDATA[
                        
	                    AND F.REQ_DVSN_CD = A.REQ_DVSN_CD
	                    AND F.ACP_YR = A.ACP_YR
	                    AND F.CVPT_ACP_NO = A.CVPT_ACP_NO )  AS FNL_APV_DH /* 결재일 */
                , TO_CHAR(D.FNL_HNDL_DH,'YYYY. MM. DD') AS FNL_HNDL_DH /*처리완료일 */
   			FROM	TBCORCOR101M A
   					,TBCORCOR102M B
   					,TBCORCOR103M C
                    ,TBCORCOR201M D
          ]]>
         <if test= ' isClient == "Y" '>
                    ,TBCORCOR205L E
          </if>
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
            AND     A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = C.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO(+)
            AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = D.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
   			<if test= ' isClient == "Y" '>
   			AND     A.CVPT_HNDL_STA_CD = '60' --민원처리는 완료상태인것만
            AND		A.REQ_DVSN_CD = E.REQ_DVSN_CD
   			AND		A.ACP_YR = E.ACP_YR
   			AND		A.CVPT_ACP_NO = E.CVPT_ACP_NO
            AND     E.CVPT_HNDL_DVSN_CD IN ('20')--민원처리는 대내이송만
            </if>
    </select>
    
    <select id="selectSvyRsltRprtMainListDCP" parameterType="paramMap" resultMap="rsltRprtMainMap" >
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectSvyRsltRprtMainListDcp */
                     SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,DECODE(A.RM_CVPT_ACP_NO,NULL,NULL,A.ACP_YR||'-'||F_CODE_NM('1000740',A.REQ_DVSN_CD)||'-'||A.RM_CVPT_ACP_NO) AS ACP_NO          /*분류번호*/
                    ,F_CODE_NM('1000927', A.ACP_RUT_CD) AS ACP_RUT_NM          /*접수형태*/
   					,A.ACP_RUT_DTL_CD 
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM  /*20170726 EUNOK 수정 A.CVPTR_NM */
   					,A.JB_NM
   					,A.RPST_PEN_NM
   					,A.BZN
   					,A.CPNM_NM
   					,A.ZCD
   					,A.AD || ' ' || A.DTL_AD AS AD                      /*주소*/
    				,A.HPN                                          /*전화번호*/
   					,A.EML_ID
   					,A.EML_DMI_NM
   					,A.OPEN_YN
   					,A.MNG_TYP_CD
   					,A.RSLT_NTF_WAY_CD
                    ,CASE WHEN A.ACP_RUT_CD = '8' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						WHEN A.ACP_RUT_CD <> '8' AND A.RSLT_NTF_WAY_CD = '003' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						ELSE '홈페이지+'||F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)  END AS RSLT_NTF_WAY_NM        /*회신방식*/
   					,A.TIT_NM                                               /*제목*/
   					,A.ACP_DPT_CD
   					,F_DPT_INFO(A.ACP_DPT_CD,'1') AS ACP_DPT_NM             /*접수국과*/
   					,A.RCEP_ID
   					,F_USR_INFO_BY_ID(A.RCEP_ID,'2') AS RCEP_NM
   					,TO_CHAR(A.ACP_DH,'YYYY.MM.DD') AS ACP_DH       /*감사요청일*/
   					,A.CVPT_HNDL_STA_CD
   					,A.AUD_INF_TG_YN
   					,A.SMG_CVPT_APL_NO
   					,A.SMG_CVPT_ACP_NO
   					,A.SMG_FNL_HNDL_STA_CD
   					,A.SMG_CVPT_APL_DH
   					,A.SMG_FRT_CVPT_APL_GCC_ORG_CD
   					,A.SMG_CAT_HST_SRNO
   					,B.CVPT_TXT
   					,B.CVPT_SBT                                             /*요지*/
   					,C.CLM_NM
   					,C.WRK_PLAC_NM
   					,C.ZCD AS CLM_ZCD
   					,C.AD AS CLM_AD
   					,C.DTL_AD AS CLM_DTL_AD
   					,(SELECT AUD_INF_TRF_DVSN_CD FROM TBDCPDCP101M T1 WHERE	T1.REQ_DVSN_CD = A.REQ_DVSN_CD AND T1.ACP_YR = A.ACP_YR AND T1.CVPT_ACP_NO = A.CVPT_ACP_NO) AS AUD_INF_TRF_DVSN_CD
                    ,(	SELECT	F_CODE_NM('1000943', S3.CVPT_HNDL_DVSN_CD)
			      		FROM	TBDCPDCP205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBDCPDCP205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS CVPT_HNLD_DVSN_NM        /*처 리결과 - 단순종결,조사종결,즉시해소,즉시시정,감사실시,위탁조사,이송(대내),이첩*/
                    ,F_DPT_INFO(D.HNDL_DPT_CD,'1') AS HNDL_DPT_NM       /*처리부서*/
                    ,(	SELECT	DECODE(S3.AUD_RFR_MTRL_TRNF_DPT_CD,NULL,'',SUBSTR(S3.AUD_RFR_MTRL_TRNF_DPT_CD,1,3)||'000')
			      		FROM	TBDCPDCP205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBDCPDCP205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS AUD_RFR_MTRL_TRNF_HST_DPT_CD
                    ,(	SELECT	F_DPT_INFO(NVL(S3.TRNF_DPT_CD, S3.AUD_RFR_MTRL_TRNF_DPT_CD), '1')
			      		FROM	TBDCPDCP205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBDCPDCP205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS TRNF_DPT_NM                      /*대내이송부서*/
                     , (SELECT CASE WHEN S6.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(S6.ORG_CD,'1')
                                    ELSE S6.ORG_NM END AS ORG_NM
                        FROM TBDCPDCP206L S6
                        WHERE	(S6.REQ_DVSN_CD, S6.ACP_YR, S6.CVPT_ACP_NO, S6.HNDL_ORG_SRNO) IN (
                            SELECT S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO,MIN(S5.HNDL_ORG_SRNO)
                            FROM TBDCPDCP206L S5
                            WHERE A.REQ_DVSN_CD = S5.REQ_DVSN_CD
                            AND	A.ACP_YR = S5.ACP_YR
                            AND A.CVPT_ACP_NO = S5.CVPT_ACP_NO
                            AND S5.ORG_HIS_DVSN_CD ='1'
                            GROUP BY S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO
                         )
                       ) AS ORG_NM          /*관련기관*/
                     , (SELECT F_ORG_HRK_NM(S6.COPT_SG_CD)
                        FROM TBDCPDCP206L S6
                        WHERE	(S6.REQ_DVSN_CD, S6.ACP_YR, S6.CVPT_ACP_NO, S6.HNDL_ORG_SRNO) IN (
                            SELECT S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO,MIN(S5.HNDL_ORG_SRNO)
                            FROM TBDCPDCP206L S5
                            WHERE A.REQ_DVSN_CD = S5.REQ_DVSN_CD
                            AND	A.ACP_YR = S5.ACP_YR
                            AND A.CVPT_ACP_NO = S5.CVPT_ACP_NO
                            AND S5.ORG_HIS_DVSN_CD ='1'
                            GROUP BY S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO
                         )
                       ) AS COPT_SG_NM      /*소관청*/
                       , (SELECT F_ORG_INFO(S6.ORG_CD,'1')
                        FROM TBDCPDCP206L S6
                        WHERE	(S6.REQ_DVSN_CD, S6.ACP_YR, S6.CVPT_ACP_NO, S6.HNDL_ORG_SRNO) IN (
                            SELECT S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO,MIN(S5.HNDL_ORG_SRNO)
                            FROM TBDCPDCP206L S5
                            WHERE A.REQ_DVSN_CD = S5.REQ_DVSN_CD
                            AND	A.ACP_YR = S5.ACP_YR
                            AND A.CVPT_ACP_NO = S5.CVPT_ACP_NO
                            AND (S5.ORG_HIS_DVSN_CD ='3' OR S5.ORG_HIS_DVSN_CD ='2')
                            GROUP BY S5.REQ_DVSN_CD, S5.ACP_YR, S5.CVPT_ACP_NO
                         )
                       ) AS TRNF_ORG_NM     /*대외이송*/
                      , ( SELECT	COUNT(ROWNUM)
                            FROM	TBDCPDCP101M S7
                                    ,TBDCPDCP201M S8
                                    ,(	SELECT	Z1.CVPTR_NM, Z1.RPST_PEN_NM, Z1.HPN
                                        FROM	TBDCPDCP101M Z1
                                        WHERE	Z1.REQ_DVSN_CD = #{reqDvsnCd}
                                        AND		Z1.ACP_YR = #{acpYr}
                                        AND		Z1.CVPT_ACP_NO = #{cvptAcpNo}
                                    ) S9
                            WHERE	1=1
                            AND		S7.REQ_DVSN_CD = #{reqDvsnCd}
                            AND		S7.REQ_DVSN_CD = S8.REQ_DVSN_CD(+)
                            AND		S7.ACP_YR = S8.ACP_YR(+)
                            AND		S7.CVPT_ACP_NO = S8.CVPT_ACP_NO(+)
                            AND		S7.REQR_KND_CD <> '4'
                            AND		NOT EXISTS (
                                        SELECT 	''
                                        FROM	TBDCPDCP101M Z2
                                        WHERE	Z2.REQ_DVSN_CD = #{reqDvsnCd}
                                        AND		Z2.ACP_YR = #{acpYr}
                                        AND		Z2.CVPT_ACP_NO = #{cvptAcpNo}
                                        AND 	Z2.REQ_DVSN_CD = S7.REQ_DVSN_CD
                                        AND 	Z2.ACP_YR = S7.ACP_YR
                                        AND 	Z2.CVPT_ACP_NO = S7.CVPT_ACP_NO
                                    )
                            AND	S7.CVPTR_NM = S9.CVPTR_NM
                            AND	S7.HPN = S9.HPN ) AS ACP_CNT            /*신고횟수*/
                            ]]>
                            
               <if test= ' isClient == "N" '>
              ,(	SELECT	S3.CVPT_HNDL_DVSN_CD
			      		FROM	TBDCPDCP205L S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, S3.SRNO) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MIN(S4.SRNO)
			      																		FROM	TBDCPDCP205L S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	)
                      ) AS CVPT_HNDL_DVSN_CD        /*처리결과 - 단순종결,조사종결,즉시해소,즉시시정,감사실시,위탁조사,이송(대내),이첩*/
             </if>
             <if test= ' isClient == "Y"  '>
              ,(SELECT S3.RSLT_RPRT_HNDL_RSLT_CD
                              FROM TBDCPDCP402L S3
                       WHERE  A.REQ_DVSN_CD = S3.REQ_DVSN_CD
			             AND  A.ACP_YR = S3.ACP_YR(+)
			             AND  A.CVPT_ACP_NO = S3.CVPT_ACP_NO
                         AND  S3.DGE  = #{dge} ) AS CVPT_HNDL_DVSN_CD   /* 감사결과 민원처리전 - 처리결과코드 */
             </if>
             
              <![CDATA[
               , ( SELECT NVL2(T1.TXT,'합건 - '||T1.TXT ,'')
                    FROM ( SELECT AGGR_CONCAT(B3.RM_CVPT_ACP_NO ,', ') txt 
                                 FROM TBDCPDCP105L B2
                                     LEFT OUTER JOIN TBDCPDCP101M B3 ON (B2.SUC_ACP_YR = B3.ACP_YR 
                                                                                        AND B2.SUC_CVPT_ACP_NO = B3.CVPT_ACP_NO 
                                                                                        AND B2.SUC_REQ_DVSN_CD = B3.REQ_DVSN_CD)
                               WHERE B2.REQ_DVSN_CD =#{reqDvsnCd}
                                  AND B2.ACP_YR = #{acpYr}
                                  AND B2.CVPT_ACP_NO = #{cvptAcpNo}  ) T1
                   ) AS SUC_TXT /* 합건 */       
                , ( SELECT TO_CHAR(E.FNL_APV_DH ,'YYYY. MM. DD')
                	 FROM UBCREOWN.TBDCMACM022L E
                		INNER JOIN TBDCPDCP603M F ON (E.APV_DOC_NO = F.APV_RQS_ID)
	                WHERE E.APV_STA_CD='3'
	                ]]>
	                <if test= ' isClient == "Y" '>
	                AND F.RPRT_CD ='G20100400'
	                </if>
	                <if test= ' isClient == "N" '>
	                AND F.RPRT_CD IN ('G10200400','G10200600')
	                </if>
	                <![CDATA[
                        
	                    AND F.REQ_DVSN_CD = A.REQ_DVSN_CD
	                    AND F.ACP_YR = A.ACP_YR
	                    AND F.CVPT_ACP_NO = A.CVPT_ACP_NO )  AS FNL_APV_DH /* 결재일 */
                , TO_CHAR(D.FNL_HNDL_DH,'YYYY. MM. DD') AS FNL_HNDL_DH /*처리완료일 */
   			FROM	TBDCPDCP101M A
   					,TBDCPDCP102M B
   					,TBDCPDCP103M C
                    ,TBDCPDCP201M D
          ]]>
         <if test= ' isClient == "Y" '>
                    ,TBDCPDCP205L E
          </if>
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
            AND     A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = C.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO(+)
            AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = D.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
   			<if test= ' isClient == "Y" '>
   			AND     A.CVPT_HNDL_STA_CD = '60' --민원처리는 완료상태인것만
            AND		A.REQ_DVSN_CD = E.REQ_DVSN_CD
   			AND		A.ACP_YR = E.ACP_YR
   			AND		A.CVPT_ACP_NO = E.CVPT_ACP_NO
            AND     E.CVPT_HNDL_DVSN_CD IN ('20')--민원처리는 대내이송만
            </if>
    </select>
    
    <resultMap type="java.util.HashMap" id="rsltRprtSubMap">
	
     <result property="reqDvsnCd" column="REQ_DVSN_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="acpYr" column="ACP_YR" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="cvptAcpNo" column="CVPT_ACP_NO" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="srno" column="SRNO" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="cvptHndlDvsnCd" column="CVPT_HNDL_DVSN_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     
     <result property="cvptHndlDvsnNm" column="CVPT_HNDL_DVSN_NM" jdbcType="VARCHAR" javaType="java.lang.String" />
     <result property="audRfrMtrlTrnfDptCd" column="AUD_RFR_MTRL_TRNF_DPT_CD" jdbcType="VARCHAR"	 javaType="java.lang.String" />
     <result property="audRfrMtrlTrnfHstDptCd" column="AUD_RFR_MTRL_TRNF_HST_DPT_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="trnfDptCd" column="TRNF_DPT_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="trnfHstDptCd" column="TRNF_HST_DPT_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     
     <result property="oldCvptHndlDvsnCd" column="OLD_CVPT_HNDL_DVSN_CD" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="hndlDocId" column="HNDL_DOC_ID" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="docNm" column="DOC_NM" jdbcType="VARCHAR"	javaType="java.lang.String" />
     <result property="ansTxt" column="ANS_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
     </resultMap>
     
    <select id="selectSvyRsltRprtSubList" parameterType="paramMap" resultMap="rsltRprtSubMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectSvyRsltRprtSubList */
        SELECT	B.REQ_DVSN_CD
					,B.ACP_YR
   					,B.CVPT_ACP_NO
   					,B.SRNO
   					,B.CVPT_HNDL_DVSN_CD                /*10: 단순종결, 20:조사종결, 30,40:해소, 50:감사실시, 60,70,80:이첩 */
   					,F_CODE_NM('1000754',B.CVPT_HNDL_DVSN_CD) AS CVPT_HNDL_DVSN_NM
   					,B.AUD_RFR_MTRL_TRNF_DPT_CD
   					,DECODE(B.AUD_RFR_MTRL_TRNF_DPT_CD,NULL,'',SUBSTR(B.AUD_RFR_MTRL_TRNF_DPT_CD,1,3)||'000') AS AUD_RFR_MTRL_TRNF_HST_DPT_CD
   					,B.TRNF_DPT_CD
   					,DECODE(B.TRNF_DPT_CD,NULL,'',SUBSTR(B.TRNF_DPT_CD,1,3)||'000') AS TRNF_HST_DPT_CD
   					,B.CVPT_HNDL_DVSN_CD AS OLD_CVPT_HNDL_DVSN_CD
   					,B.DOC_ID AS HNDL_DOC_ID
   					,'첨부파일보기' AS DOC_NM
   					, ANS_TXT
   			FROM	TBCSPDCP201M A, TBCSPDCP205L B
   			WHERE	A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			ORDER BY B.SRNO ASC
        ]]>
    </select>

    <select id="selectPreiRprtList" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectPreiRprtList */
    	SELECT A.ACP_YR||'-'||F_CODE_NM('1000740',A.REQ_DVSN_CD)||'-'||substring(A.CVPT_ACP_NO, 3, 3) AS ACP_NO   /*접수번호*/
   		          ,NVL2(C.REQR_CNT, A.CVPTR_NM ||'외 '||C.REQR_CNT||'명', A.CVPTR_NM) AS CVPTR_NM     /*청구인*/
   		          ,A.AD || ' ' || A.DTL_AD AS AD /*주소*/
   		          ,A.TIT_NM               /*제목*/
   		          ,TO_CHAR(A.ACP_DH, 'YYYY/MM/DD') AS ACP_DH /*접수일*/
                  ,( SELECT AGGR_CONCAT(E.ORG_NM, ', ') --A.REQ_DVSN_CD ,A.ACP_YR ,A.CVPT_ACP_NO ,AGGR_CONCAT(B.ORG_NM, ', ') AS ORG_NM
                       FROM TBCSPDCP104L D ,TBDCMACM015M E 
                     WHERE C.REQ_DVSN_CD = D.REQ_DVSN_CD
                         AND C.ACP_YR = D.ACP_YR
                         AND C.CVPT_ACP_NO = D.CVPT_ACP_NO
                         AND D.AUD_TG_ORG_CD = E.ORG_CD
                    GROUP BY D.REQ_DVSN_CD ,D.ACP_YR ,D.CVPT_ACP_NO) AS ORG_NM
                 , (SELECT FRML_DPT_NM FROM TBDCMACM002M WHERE DPT_CD = C.HNDL_DPT_CD ) AS HNDL_DPT_NM       /*처리부서*/
   			FROM TBCSPDCP101M A
   					 ,TBCSPDCP102M B
   					 ,TBCSPEAR001M C
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = C.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO(+)
        ]]>
    </select>
    <resultMap type="java.util.HashMap" id="ansTxtMap">
  		<result property="ansTxt" column="ANS_TXT" jdbcType="CLOB"	javaType="java.lang.String" />
  		<result property="ansTxt2" column="ANS_TXT2" jdbcType="CLOB"	javaType="java.lang.String" />
    </resultMap>
     
        <select id="selectAnsTxt" parameterType="paramMap" resultMap="ansTxtMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectAnsTxt */
        SELECT ANS_TXT
                , NVL(ANS_TXT2,' ') AS ANS_TXT2
          FROM TBCSPDCP201M
        WHERE 	1=1 
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND ACP_YR = #{acpYr}
           AND CVPT_ACP_NO =#{cvptAcpNo}
        ]]>
    </select>
    <!-- BEST20 감사제보 관리 회신내용-->
    <select id="selectAnsTxt2" parameterType="paramMap" resultMap="ansTxtMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectAnsTxt2 */
        SELECT ANS_TXT
          FROM TBCSPDCP401H
        WHERE 	1=1 
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND ACP_YR = #{acpYr}
           AND CVPT_ACP_NO =#{cvptAcpNo}
           AND DGE = #{srno}
        ]]>
    </select>
    
    <select id="selectAnsTxtCOR" parameterType="paramMap" resultMap="ansTxtMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectAnsTxtCOR */
        SELECT ANS_TXT, ANS_TXT2
          FROM TBCORCOR201M
        WHERE 	1=1 
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND ACP_YR = #{acpYr}
           AND CVPT_ACP_NO =#{cvptAcpNo}
        ]]>
    </select>
    
    
    <select id="selectAnsTxtCOR2" parameterType="paramMap" resultMap="ansTxtMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectAnsTxtCOR2 */
        SELECT ANS_TXT
          FROM TBCORCOR401H
        WHERE 	1=1 
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND ACP_YR = #{acpYr}
           AND CVPT_ACP_NO =#{cvptAcpNo}
        ]]>
    </select>
    
    
    <select id="selectAnsTxtDCP" parameterType="paramMap" resultMap="ansTxtMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectAnsTxtDCP */
        SELECT ANS_TXT, ANS_TXT2
          FROM TBDCPDCP201M
        WHERE 	1=1 
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND ACP_YR = #{acpYr}
           AND CVPT_ACP_NO =#{cvptAcpNo}
        ]]>
    </select>
    
    <select id="selectAnsTxtDCP2" parameterType="paramMap" resultMap="ansTxtMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectAnsTxtDCP2 */
        SELECT ANS_TXT
          FROM TBDCPDCP401H
        WHERE 	1=1 
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND ACP_YR = #{acpYr}
           AND CVPT_ACP_NO =#{cvptAcpNo}
        ]]>
    </select>
    
      <select id="selectEtcDocumentList" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectEtcDocumentList */
			SELECT SPMT_DVSN_CD, F_CODE_NM('1000746', SPMT_DVSN_CD) AS SPMT_DVSN_NM , ACP_DCM_DOC_ID, FILE_NM
			  FROM TBCSPEAR003L A, TBCSPDCP608D B
			WHERE  A.ACP_YR = B.ACP_YR
			    AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
			    AND A.EVI_DCMB_SNO = B.EVI_DCMB_SNO
                AND A.REQ_DVSN_CD = #{reqDvsnCd}
                AND A.ACP_YR = #{acpYr}
                AND A.CVPT_ACP_NO =#{cvptAcpNo}
                AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
            ]]>
           <if test="spmtDvsnCd != null and spmtDvsnCd != ''">
			AND A.SPMT_DVSN_CD = #{spmtDvsnCd}
			</if>
			ORDER BY FILE_NM
    </select>
    
    <select id="selectSprvIdsEAR" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectSprvIdsEar */
		SELECT HNDL_CHGR_ID, AUD_EXEC_DCS_CHGR_ID 
		FROM TBCSPEAR001M --청구
        WHERE ACP_YR = #{acpYr}
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND CVPT_ACP_NO =#{cvptAcpNo}
    </select>
    
    <select id="selectSprvIdsCSP" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectSprvIdsCSP */
		SELECT  	HNDL_CHGR_ID
		FROM TBCSPDCP201M --제보
        WHERE ACP_YR = #{acpYr}
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND CVPT_ACP_NO =#{cvptAcpNo}
    </select>
    
    <select id="selectSprvIdsCOR" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectSprvIdsCOR */
		SELECT  	HNDL_CHGR_ID
		FROM TBCORCOR201M --부패행위
        WHERE ACP_YR = #{acpYr}
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND CVPT_ACP_NO =#{cvptAcpNo}
    </select>
    
    <select id="selectSprvIdsDCP" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectSprvIdsDCP */
		SELECT  	HNDL_CHGR_ID
		FROM TBDCPDCP201M --부패행위
        WHERE ACP_YR = #{acpYr}
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND CVPT_ACP_NO =#{cvptAcpNo}
    </select>
    
    <select id="selectAprvUserId" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectAprvUserId */
        SELECT F_USR_INFO(APVR_CNB, '1') AS APVR_ID, APVR_KND_CD
          FROM TBDCMACM023L
         WHERE APV_DOC_NO = #{apvRqsId}
          ]]>
          <if test="apvrGb =='apvrId' ">
         	<![CDATA[
	           AND SUBSTR(APVR_STA_CD,0,1) = '1' --결재 요청 상태 	        
 	           AND APVR_KND_CD <>'8' --열람자 제외
           	]]>
          </if>
       
    </select>
    
    <select id="selectCspRelDocList" parameterType="paramMap" resultType="egovMap">
    <![CDATA[
    /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectCspRelDocList */
    SELECT  A.CMT_DVSN_CD
				 , A.CMT_OEN_YE
				 , A.CMT_DGE
                 , C.TIT_NM 
			     , B.ACP_YR||'-'||F_CODE_NM('1000740',B.REQ_DVSN_CD)||'-'||substring(B.CVPT_ACP_NO, 3, 3) AS ACP_NO 
                 , E.STEP_GB_CD
                 , E.FOLDER_RPRT_NM
                 , E.FILE_DOC_NM
                 , E.EVI_DOC_ID
		  FROM TBCSPEAR010M A, --심사(자문)위원회기본
			       TBCSPEAR011M B, --심사(자문)위원회결과
			       TBCSPDCP101M C, --민원접수기본
			       TBCSPEAR001M D,--감사청구기본
      (   
        SELECT '10' AS STEP_GB_CD /* selectStepAcpSbjDocList 단계별 */
          		  , RPRT_NM AS FOLDER_RPRT_NM 
            	  , F_CODE_NM('1000786', RPRT_CD) AS FILE_DOC_NM
            	  , DOC_ID AS EVI_DOC_ID
            	  , ACP_YR
            	  , CVPT_ACP_NO
            	  , REQ_DVSN_CD
          FROM TBCSPDCP603M --제보청구문서함
         WHERE 1=1
            AND APV_WAY_CD IN ('10', '30')
        
        UNION ALL
         
			SELECT '20' AS STEP_GB_CD  /* selectEtcDocumentList 기타문서함 조회*/
                	, F_CODE_NM('1000746', SPMT_DVSN_CD)   AS FOLDER_RPRT_NM
                	, FILE_NM AS FILE_DOC_NM
                	, ACP_DCM_DOC_ID AS EVI_DOC_ID
	                , A.ACP_YR
	                , A.CVPT_ACP_NO
	                , A.REQ_DVSN_CD
			  FROM TBCSPEAR003L A, TBCSPDCP608D B 
			WHERE  A.ACP_YR = B.ACP_YR
			   AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
			   AND A.EVI_DCMB_SNO = B.EVI_DCMB_SNO
			   AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
             
    ) E      
          
        WHERE A.CMT_DVSN_CD = B.CMT_DVSN_CD
		    AND A.CMT_OEN_YE = B.CMT_OEN_YE
		    AND A.CMT_DGE = B.CMT_DGE
		    AND B.ACP_YR = C.ACP_YR
		    AND B.CVPT_ACP_NO = C.CVPT_ACP_NO
		    AND B.REQ_DVSN_CD = C.REQ_DVSN_CD
		    AND B.ACP_YR = D.ACP_YR
		    AND B.CVPT_ACP_NO = D.CVPT_ACP_NO
		    AND B.REQ_DVSN_CD = D.REQ_DVSN_CD
            AND B.ACP_YR = E.ACP_YR
		    AND B.CVPT_ACP_NO = E.CVPT_ACP_NO
		    AND B.REQ_DVSN_CD = E.REQ_DVSN_CD
		 ]]>
		 <if test='cmtDvsnCd != null and cmtDvsnCd != ""'>
			AND	A.CMT_DVSN_CD = #{cmtDvsnCd}
		</if>
		<if test='cmtOenYe != null and cmtOenYe != ""'>
			AND	A.CMT_OEN_YE = #{cmtOenYe}
		</if>
		<if test='cmtDge != null and cmtDge != ""'>
			AND	A.CMT_DGE = #{cmtDge}
		</if>
		 ORDER BY E.ACP_YR, E.CVPT_ACP_NO, E.REQ_DVSN_CD, E.STEP_GB_CD
    </select>
    
    <select id="getEdtStrEndDt" parameterType="paramMap" resultType="java.lang.String">
		/* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getEdtStrEndDt*/
		SELECT  (CASE WHEN (TO_DATE(B.EDT_STR_DT || B.EDT_STR_DH,'YYYYMMDDHH24MI') >= SYSTIMESTAMP OR SYSTIMESTAMP >= TO_DATE(B.EDT_END_DT || B.EDT_END_DH,'YYYYMMDDHH24MI')) THEN 'N'
				        WHEN B.EDT_AUTH_CNBS IS NOT NULL AND INSTR(B.EDT_AUTH_CNBS,#{cnb}) = 0  THEN 'N'
			                                          	                                                                       ELSE NVL(A.EDT_AUTH,'N')
				  END) AS EDT_AUTH            
        FROM TBCSPDCP603M A
        LEFT OUTER JOIN TBDCMACM018M B
        ON (A.ACP_YR = B.AUD_YR AND TO_CHAR(A.CVPT_ACP_NO) = B.AUD_NO AND A.ACP_STEP_CD = B.AUD_STEP_CD AND A.DOC_ID = B.DOC_ID )  
        WHERE 1=1
        AND A.ACP_YR = #{acpYr}
        AND A.CVPT_ACP_NO =#{cvptAcpNo}
        AND A.ACP_STEP_CD = #{acpStepCd}
        AND A.DOC_ID = #{docId}
        AND A.REQ_DVSN_CD = #{reqDvsnCd}
	</select>
	
	<!-- 권한조회 백업 -->
	<select id="getEdtStrEndDtBack" parameterType="paramMap" resultType="java.lang.String">
		/* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getEdtStrEndDt*/
		SELECT (CASE WHEN TO_DATE(SYSDATE) >= TO_DATE(B.EDT_END_DT)+1 THEN 'N'
	              ELSE  NVL(A.EDT_AUTH,'N')
		          END) AS EDT_AUTH	              
        FROM TBCSPDCP603M A
        LEFT OUTER JOIN TBDCMACM018M B
        ON (A.ACP_YR = B.AUD_YR AND TO_CHAR(A.CVPT_ACP_NO) = B.AUD_NO AND A.ACP_STEP_CD = B.AUD_STEP_CD AND A.DOC_ID = B.DOC_ID )  
        WHERE 1=1
        AND A.ACP_YR = #{acpYr}
        AND A.CVPT_ACP_NO =#{cvptAcpNo}
        AND A.ACP_STEP_CD = #{acpStepCd}
        AND A.DOC_ID = #{docId}
        AND A.REQ_DVSN_CD = #{reqDvsnCd}
	</select>
	
	<select id="getEdtStrEndDtCOR" parameterType="paramMap" resultType="java.lang.String">
		/* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getEdtStrEndDtCOR*/
		SELECT (CASE WHEN TO_DATE(SYSDATE) >= TO_DATE(B.EDT_END_DT)+1 THEN 'N'
	              ELSE  NVL(A.EDT_AUTH,'N')
		          END) AS EDT_AUTH	              
        FROM TBCORCOR603M A
        LEFT OUTER JOIN TBDCMACM018M B
        ON (A.ACP_YR = B.AUD_YR AND TO_CHAR(A.CVPT_ACP_NO) = B.AUD_NO AND A.ACP_STEP_CD = B.AUD_STEP_CD AND A.DOC_ID = B.DOC_ID )  
        WHERE 1=1
        AND A.ACP_YR = #{acpYr}
        AND A.CVPT_ACP_NO =#{cvptAcpNo}
        AND A.ACP_STEP_CD = #{acpStepCd}
        AND A.DOC_ID = #{docId}
        AND A.REQ_DVSN_CD = #{reqDvsnCd}
	</select>	
	
	<select id="getEdtStrEndDtDCP" parameterType="paramMap" resultType="java.lang.String">
		/* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.getEdtStrEndDtDCP*/
		SELECT (CASE WHEN TO_DATE(SYSDATE) >= TO_DATE(B.EDT_END_DT)+1 THEN 'N'
	              ELSE  NVL(A.EDT_AUTH,'N')
		          END) AS EDT_AUTH	              
        FROM TBDCPDCP603M A
        LEFT OUTER JOIN TBDCMACM018M B
        ON (A.ACP_YR = B.AUD_YR AND TO_CHAR(A.CVPT_ACP_NO) = B.AUD_NO AND A.ACP_STEP_CD = B.AUD_STEP_CD AND A.DOC_ID = B.DOC_ID )  
        WHERE 1=1
        AND A.ACP_YR = #{acpYr}
        AND A.CVPT_ACP_NO =#{cvptAcpNo}
        AND A.ACP_STEP_CD = #{acpStepCd}
        AND A.DOC_ID = #{docId}
        AND A.REQ_DVSN_CD = #{reqDvsnCd}
	</select>
    
      <select id="selectCSPDCP608DList" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectCSPDCP608DList */
	 	SELECT  ACP_YR  ,CVPT_ACP_NO ,REQ_DVSN_CD
   						 ,ACP_DCM_DOC_ID ,FILE_NM ,FILE_SIZE
 		  FROM TBCSPDCP608D
        WHERE ACP_YR = #{acpYr}
           AND REQ_DVSN_CD = #{reqDvsnCd}
           AND CVPT_ACP_NO =#{cvptAcpNo}
           AND EVI_DCMB_SNO = '1'
    </select>


	<select id="selectCvptHndlDvsnCdDcp" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectCvptHndlDvsnCdDcp */
	 	SELECT CVPT_HNDL_DVSN_CD
			  FROM TBDCPDCP205L
			 WHERE 1=1
			   AND REQ_DVSN_CD = #{reqDvsnCd}
			   AND  ACP_YR = #{acpYr}
			   AND CVPT_ACP_NO =#{cvptAcpNo}
			   AND SRNO = (SELECT	MAX(SRNO)
								FROM	TBDCPDCP205L S1
								WHERE	REQ_DVSN_CD = #{reqDvsnCd}
								AND		ACP_YR = #{acpYr}
								AND		CVPT_ACP_NO = #{cvptAcpNo})
    </select>
    
    <select id="selectCvptHndlDvsnCdCor" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.selectCvptHndlDvsnCdCor */
	 	SELECT CVPT_HNDL_DVSN_CD
			  FROM TBCORCOR205L
			 WHERE 1=1
			   AND REQ_DVSN_CD = #{reqDvsnCd}
			   AND  ACP_YR = #{acpYr}
			   AND CVPT_ACP_NO =#{cvptAcpNo}
			   AND SRNO = (SELECT	MAX(SRNO)
								FROM	TBCORCOR205L
								WHERE	REQ_DVSN_CD = #{reqDvsnCd}
								AND		ACP_YR = #{acpYr}
								AND		CVPT_ACP_NO = #{cvptAcpNo})
    </select>
    
    <update id="updateSvyRsltRprtTxtDCP2" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateSvyRsltRprtTxtDCP2 */
   		 /*청탁금지 조사결과보고서 업데이트쿼리*/
		UPDATE	TBDCPDCP201M
		      SET	ANS_TXT2 = #{ansTxt, jdbcType=CLOB} 
		      	,   ANS_TXT = ' '
		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		   AND	ACP_YR = #{acpYr}
		   AND	CVPT_ACP_NO = #{cvptAcpNo}
    </update>
    
     <update id="updateSvyRsltRprtTxtCOR2" parameterType="paramMap">
        /* kr.go.bai.eip.geb.awd.dao.GEBAWD002EMapper.updateSvyRsltRprtTxtCOR2 */
   		 /*청탁금지 조사결과보고서 업데이트쿼리*/
		UPDATE	TBCORCOR201M
		      SET	ANS_TXT = #{ansTxt, jdbcType=CLOB} 
		      	,   ANS_TXT2 = #{ansTxt2, jdbcType=CLOB}
		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		   AND	ACP_YR = #{acpYr}
		   AND	CVPT_ACP_NO = #{cvptAcpNo}
    </update>
</mapper> 