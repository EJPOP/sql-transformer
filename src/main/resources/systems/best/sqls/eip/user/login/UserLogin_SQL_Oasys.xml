<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">   
<mapper namespace="kr.go.bai.eip.user.login.service.impl.UserLoginOasysMapper">

  	<select id="selectUserLoginOasysByUsrId" parameterType="HashMap" resultType="HashMap">
  		/* kr.go.bai.eip.user.login.service.impl.UserLoginOasysMapper.selectUserLoginOasysByUsrId */
		<![CDATA[
            SELECT
                LIST.*
                , LIST.DPT_CD AS REAL_DPT_CD
                , LIST.DPT_NM AS REAL_DPT_NM
                , LIST.HIRK_DPT_CD AS REAL_HIRK_DPT_CD
                , LIST.HIRK_DPT_NM AS REAL_HIRK_DPT_NM
            FROM (SELECT 
                 A.CNB
                ,A.USR_ID
                ,A.USR_NAM
                ,A.TNB
                ,A.DPT_CD
                ,B.DPT_NM
                ,B.ABR_DPT_NM_1
                ,B.ABR_DPT_NM_2
                ,B.FRML_DPT_NM
                ,A.BAI_USR_YN
                ,A.RANK_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' AND CD = RANK_CD) RANK_NM
                ,A.PST_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000176' AND CD = PST_CD) PST_NM
                ,A.RANK_CD_2
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000175' AND CD = RANK_CD_2) RANK_NM_2
                ,B.HIRK_DPT_CD
                , (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD )AS SUB_HIRK_DPT_CD
                , F_DPT_INFO(B.HIRK_DPT_CD,'1') AS HIRK_DPT_NM
                , F_DPT_INFO((SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD ),'1') AS SUB_HIRK_DPT_NM
                , EML_AD    /* 메일주소 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, 0, INSTR(EML_AD, '@') - 1) ELSE '' END) AS EML_ID   /* 메일아이디 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, INSTR(EML_AD, '@') + 1) ELSE '' END) AS EML_DOMAIN /* 메일도메인 */
                ,A.INN_RANK_CD
                , 'S002' AS SIT_CD
                , A.SUB_DPT_CD
                , F_DPT_INFO(A.SUB_DPT_CD,'1') AS  SUB_DPT_NM
                , NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60')) AS SUB_INN_RANK_CD
                , F_DPT_INFO(A.DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.INN_RANK_CD,'60')) AS DPT_RANK_NM
                , F_DPT_INFO(A.SUB_DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60'))) AS SUB_DPT_RANK_NM
            FROM 
                TBDCMACM001M A
                    LEFT OUTER JOIN TBDCMACM002M B ON
                      A.DPT_CD = B.DPT_CD
            WHERE 
                A.USR_ID =  #{S_USR_ID}
            ) LIST
		]]>
	</select>
		  	
  	<select id="selectUserLoginOasysChk" parameterType="HashMap" resultType="HashMap">
  	/* kr.go.bai.eip.user.login.service.impl.UserLoginOasysMapper.selectUserLoginOasysChk */
		<![CDATA[
            SELECT
                LIST.*
                , LIST.DPT_CD AS REAL_DPT_CD
                , LIST.DPT_NM AS REAL_DPT_NM
                , LIST.HIRK_DPT_CD AS REAL_HIRK_DPT_CD
                , LIST.HIRK_DPT_NM AS REAL_HIRK_DPT_NM
            FROM (SELECT 
                 A.CNB
                ,A.USR_ID
                ,A.USR_NAM
                ,A.TNB
                ,A.DPT_CD
                ,B.DPT_NM
                ,B.ABR_DPT_NM_1
                ,B.ABR_DPT_NM_2
                ,B.FRML_DPT_NM
                ,A.BAI_USR_YN
                ,A.RANK_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' AND CD = RANK_CD) RANK_NM
                ,A.PST_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000176' AND CD = PST_CD) PST_NM
                ,A.RANK_CD_2
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000175' AND CD = RANK_CD_2) RANK_NM_2
                ,B.HIRK_DPT_CD
                , (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD )AS SUB_HIRK_DPT_CD
                , F_DPT_INFO(B.HIRK_DPT_CD,'1') AS HIRK_DPT_NM
                , F_DPT_INFO((SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD ),'1') AS SUB_HIRK_DPT_NM
                , EML_AD    /* 메일주소 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, 0, INSTR(EML_AD, '@') - 1) ELSE '' END) AS EML_ID   /* 메일아이디 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, INSTR(EML_AD, '@') + 1) ELSE '' END) AS EML_DOMAIN /* 메일도메인 */
                ,A.INN_RANK_CD
                , 'S002' AS SIT_CD
                , A.SUB_DPT_CD
                , F_DPT_INFO(A.SUB_DPT_CD,'1') AS  SUB_DPT_NM
                , NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60')) AS SUB_INN_RANK_CD
                , F_DPT_INFO(A.DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.INN_RANK_CD,'60')) AS DPT_RANK_NM
                , F_DPT_INFO(A.SUB_DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60'))) AS SUB_DPT_RANK_NM
                , A.ESN
            FROM 
                TBDCMACM001M A
                    LEFT OUTER JOIN TBDCMACM002M B ON
                      A.DPT_CD = B.DPT_CD
            WHERE 
                1=1
                AND A.USR_ID =  #{usrId}
                
    ]]>
             <if test="serverName == 'real'">
                   AND (SELECT ESN FROM TBDCMACM001M WHERE USR_ID = 'realguy21') = DGUARD.HASH('TB_ENC','ESN',#{usrPwd})
             </if>
            ) LIST
	</select>
    
    <select id="selectUserLoginOasysChk2" parameterType="HashMap" resultType="HashMap">
    /* kr.go.bai.eip.user.login.service.impl.UserLoginOasysMapper.selectUserLoginOasysChk2 */
        <![CDATA[
            SELECT
                LIST.*
                , LIST.DPT_CD AS REAL_DPT_CD
                , LIST.DPT_NM AS REAL_DPT_NM
                , LIST.HIRK_DPT_CD AS REAL_HIRK_DPT_CD
                , LIST.HIRK_DPT_NM AS REAL_HIRK_DPT_NM
            FROM (SELECT 
                 A.CNB
                ,A.USR_ID
                ,A.USR_NAM
                ,A.TNB
                ,A.DPT_CD
                ,B.DPT_NM
                ,B.ABR_DPT_NM_1
                ,B.ABR_DPT_NM_2
                ,B.FRML_DPT_NM
                ,A.BAI_USR_YN
                ,A.RANK_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' AND CD = RANK_CD) RANK_NM
                ,A.PST_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000176' AND CD = PST_CD) PST_NM
                ,A.RANK_CD_2
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000175' AND CD = RANK_CD_2) RANK_NM_2
                ,B.HIRK_DPT_CD
                , (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD )AS SUB_HIRK_DPT_CD
                , F_DPT_INFO(B.HIRK_DPT_CD,'1') AS HIRK_DPT_NM
                , F_DPT_INFO((SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD ),'1') AS SUB_HIRK_DPT_NM
                , EML_AD    /* 메일주소 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, 0, INSTR(EML_AD, '@') - 1) ELSE '' END) AS EML_ID   /* 메일아이디 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, INSTR(EML_AD, '@') + 1) ELSE '' END) AS EML_DOMAIN /* 메일도메인 */
                ,A.INN_RANK_CD
                , 'S002' AS SIT_CD
                , A.SUB_DPT_CD
                , F_DPT_INFO(A.SUB_DPT_CD,'1') AS  SUB_DPT_NM
                , NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60')) AS SUB_INN_RANK_CD
                , F_DPT_INFO(A.DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.INN_RANK_CD,'60')) AS DPT_RANK_NM
                , F_DPT_INFO(A.SUB_DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60'))) AS SUB_DPT_RANK_NM
            FROM 
                TBDCMACM001M A
                    LEFT OUTER JOIN TBDCMACM002M B ON
                      A.DPT_CD = B.DPT_CD
            WHERE 
                1=1
                AND A.USR_ID =  #{usrId}
            ) LIST
        ]]>
    </select>	

  	<select id="selectUserLoginOasysCert" parameterType="HashMap" resultType="HashMap">
  	/* kr.go.bai.eip.user.login.service.impl.UserLoginOasysMapper.selectUserLoginOasysCert */
		<![CDATA[
            SELECT
                LIST.*
                , LIST.DPT_CD AS REAL_DPT_CD
                , LIST.DPT_NM AS REAL_DPT_NM
                , LIST.HIRK_DPT_CD AS REAL_HIRK_DPT_CD
                , LIST.HIRK_DPT_NM AS REAL_HIRK_DPT_NM
            FROM (SELECT 
                 A.CNB
                ,A.USR_ID
                ,A.USR_NAM
                ,A.TNB
                ,A.DPT_CD
                ,B.DPT_NM
                ,B.ABR_DPT_NM_1
                ,B.ABR_DPT_NM_2
                ,B.FRML_DPT_NM
                ,A.BAI_USR_YN
                ,A.RANK_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' AND CD = RANK_CD) RANK_NM
                ,A.PST_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000176' AND CD = PST_CD) PST_NM
                ,A.RANK_CD_2
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000175' AND CD = RANK_CD_2) RANK_NM_2
                ,B.HIRK_DPT_CD
                , (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD )AS SUB_HIRK_DPT_CD
                , F_DPT_INFO(B.HIRK_DPT_CD,'1') AS HIRK_DPT_NM
                , F_DPT_INFO((SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD ),'1') AS SUB_HIRK_DPT_NM
                , EML_AD    /* 메일주소 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, 0, INSTR(EML_AD, '@') - 1) ELSE '' END) AS EML_ID   /* 메일아이디 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, INSTR(EML_AD, '@') + 1) ELSE '' END) AS EML_DOMAIN /* 메일도메인 */
                ,A.INN_RANK_CD
                , 'S002' AS SIT_CD
                , A.SUB_DPT_CD
                , F_DPT_INFO(A.SUB_DPT_CD,'1') AS  SUB_DPT_NM
                , NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60')) AS SUB_INN_RANK_CD
                , F_DPT_INFO(A.DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.INN_RANK_CD,'60')) AS DPT_RANK_NM
                , F_DPT_INFO(A.SUB_DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60'))) AS SUB_DPT_RANK_NM
            FROM 
                TBDCMACM001M A
                    LEFT OUTER JOIN TBDCMACM002M B ON
                      A.DPT_CD = B.DPT_CD
            WHERE 
                1=1
                AND A.USR_ID =  #{usrId}
                AND A.DNV_INF = #{dnvInf} 
            ) LIST
		]]>
	</select>		
	
	<select id="selectUserLoginAGORAChk" parameterType="HashMap" resultType="HashMap">
  	/* kr.go.bai.eip.user.login.service.impl.UserLoginOasysMapper.selectUserLoginAGORAChk */
		<![CDATA[
            SELECT
                LIST.*
                , LIST.DPT_CD AS REAL_DPT_CD
                , LIST.DPT_NM AS REAL_DPT_NM
                , LIST.HIRK_DPT_CD AS REAL_HIRK_DPT_CD
                , LIST.HIRK_DPT_NM AS REAL_HIRK_DPT_NM
            FROM (SELECT 
                 A.CNB
                ,A.USR_ID
                ,A.USR_NAM
                ,A.TNB
                ,A.DPT_CD
                ,B.DPT_NM
                ,B.ABR_DPT_NM_1
                ,B.ABR_DPT_NM_2
                ,B.FRML_DPT_NM
                ,A.BAI_USR_YN
                ,A.RANK_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000173' AND CD = RANK_CD) RANK_NM
                ,A.PST_CD
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000176' AND CD = PST_CD) PST_NM
                ,A.RANK_CD_2
                ,(SELECT CD_NM FROM TBDCMACM013C WHERE CMM_CD_DVSN_CD = '1000175' AND CD = RANK_CD_2) RANK_NM_2
                ,B.HIRK_DPT_CD
                , (SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD )AS SUB_HIRK_DPT_CD
                , F_DPT_INFO(B.HIRK_DPT_CD,'1') AS HIRK_DPT_NM
                , F_DPT_INFO((SELECT HIRK_DPT_CD FROM TBDCMACM002M WHERE DPT_CD = A.SUB_DPT_CD ),'1') AS SUB_HIRK_DPT_NM
                , EML_AD    /* 메일주소 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, 0, INSTR(EML_AD, '@') - 1) ELSE '' END) AS EML_ID   /* 메일아이디 */
                , (CASE WHEN INSTR(EML_AD, '@') > 0 THEN SUBSTR(EML_AD, INSTR(EML_AD, '@') + 1) ELSE '' END) AS EML_DOMAIN /* 메일도메인 */
                ,A.INN_RANK_CD
                , 'S002' AS SIT_CD
                , A.SUB_DPT_CD
                , F_DPT_INFO(A.SUB_DPT_CD,'1') AS  SUB_DPT_NM
                , NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60')) AS SUB_INN_RANK_CD
                , F_DPT_INFO(A.DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.INN_RANK_CD,'60')) AS DPT_RANK_NM
                , F_DPT_INFO(A.SUB_DPT_CD,'1')||'/'||F_CODE_NM('1000161',NVL(A.SUB_INN_RANK_CD,NVL(A.INN_RANK_CD,'60'))) AS SUB_DPT_RANK_NM
                , AGORA_ADM_DVSN
                , AGORA_ROLE_ID
            FROM 
                TBDCMACM001M A
                    LEFT OUTER JOIN TBDCMACM002M B ON
                      A.DPT_CD = B.DPT_CD
            WHERE 
                1=1
                AND A.USR_ID =  #{usrId}
                AND A.ESN = #{usrPwd}
            ) LIST
        ]]>
	</select>
	
	<select id="chkAgoraAdm" parameterType="HashMap" resultType="java.lang.String">
  		/* kr.go.bai.eip.user.login.service.impl.UserLoginOasysMapper.chkAgoraAdm */
		<![CDATA[
		    SELECT 	
		           CASE WHEN  A.AGORA_ADM_DVSN = '0' THEN 'N'
						WHEN  A.AGORA_ADM_DVSN = '1' OR A.AGORA_ADM_DVSN = '2' OR A.AGORA_ADM_DVSN = '3' THEN 'Y'
						ELSE 'N' END AS AGORA_ADM_YN
			  FROM TBDCMACM001M A
			 WHERE USR_ID = #{userId}
		]]>
	</select>
</mapper>