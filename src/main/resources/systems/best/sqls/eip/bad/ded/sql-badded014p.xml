<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.bad.ded.dao.BADDED014PMapper">

    <select id="selectMainList" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.bad.ded.dao.BADDED014PMapper.selectMainList*/
            <![CDATA[
            SELECT 
                   CMM_CD_DVSN_CD
                 , CD
                 , CD_NM
                 , CD_NM AS CD_NM_Rl
                 , USE_YN
                 , USR_DFN_TXT_1 AS USR_DFN_TXT
              FROM TBDCMACM013C
             WHERE CMM_CD_DVSN_CD  = '1000833'
               AND CD             <> '000000000'
            ]]>
    </select>
    
    <select id="selectGp1List" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.bad.ded.dao.BADDED014PMapper.selectGp1List*/
        <![CDATA[
            /* 예외 통계 */
            SELECT A.CD,
                   A.CD_NM,
                   COUNT(B.BZT_EX_KND_CD) AS NUM,
                   (SELECT COUNT(1) FROM TBBADDED032L WHERE BZT_YR=#{bztYr}) AS TOT
              FROM (SELECT CD,
                           CD_NM
                      FROM TBDCMACM013C
                     WHERE CMM_CD_DVSN_CD = '1000833'
                       AND CD <> '000000000') A LEFT JOIN (SELECT *
                      FROM TBBADDED032L
                     WHERE BZT_YR=#{bztYr}) B on(B.BZT_EX_KND_CD = A.CD)
             GROUP BY A.CD,
                   A.CD_NM,
                   B.BZT_EX_KND_CD
             ORDER BY A.CD
        ]]>
   </select>
    
    <insert id="insertEtcCodeList" parameterType="paramMap">
    /*kr.go.bai.eip.bad.ded.dao.BADDED014PMapper.insertEtcCodeList*/
        INSERT INTO TBDCMACM013C( CMM_CD_DVSN_CD
                                , CD
                                , TSK_CAT_CD
                                , FUNC_CAT_CD
                                , CD_NM
                                , USR_DFN_TXT_1
                                , USE_YN
                                , FRT_USR_ID
                                , FNL_USR_ID
                                , FNL_DEAL_DPT_CD
                                , FNL_MNU_ID
                                , FRT_REGI_DH
                                , FNL_MDF_DH )
                         VALUES ( #{cmmCdDvsnCd}
                                , #{cd}
                                , 'AD'
                                , 'ED'
                                , #{cdNm}
                                , #{usrDfnTxt}
                                , #{useYn}
                                , #{usrId}
                                , #{usrId}
                                , #{dptCd}
                                , #{menuNo}
                                , SYSDATE
                                , SYSDATE )
    </insert>
    
    <update id="updateEtcCodeList" parameterType="paramMap">
    /*kr.go.bai.eip.bad.ded.dao.BADDED014PMapper.updateEtcCodeList*/
        UPDATE TBDCMACM013C SET CD_NM           = #{cdNm}
                              , USR_DFN_TXT_1   = #{usrDfnTxt}
                              , USE_YN          = #{useYn}
                              , FNL_USR_ID      = #{usrId}
                              , FNL_DEAL_DPT_CD = #{dptCd}
                              , FNL_MNU_ID      = #{menuNo}
                              , FNL_MDF_DH      = SYSDATE
                          WHERE 1=1
                            AND CD              = #{cd}
                            AND CMM_CD_DVSN_CD  = '1000833'
    </update>
    
</mapper> 