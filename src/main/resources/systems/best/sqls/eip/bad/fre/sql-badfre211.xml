<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 감사사무처리부관리(자동)  -->
<mapper namespace="kr.go.bai.eip.bad.fre.dao.BADFRE211Mapper">

	<!-- 심사청구 조회-->
	<select id="BADFRE211QMainselect" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.bad.fre.dao.BADFRE211Mapper.BADFRE211QMainselect */
		SELECT T3.*
		      , (SELECT ST2.CD_NM
		           FROM TBBADFRE012M ST 
		          INNER JOIN TBDCMACM013C ST2 ON (ST2.CMM_CD_DVSN_CD = '1000807' AND ST2.CD = ST.ACP_HNDL_STA_CD)
		          WHERE ST.ACP_YR = T3.MG_ACP_YR 
		            AND ST.ACP_DVSN_CD = T3.MG_ACP_DVSN_CD 
		            AND ST.ACP_SRNO = T3.MG_ACP_SRNO) AS MG_ACP_HNDL_STA_NM
		     , (SELECT ST.CD_NM FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = '1000043' AND ST.CD = T3.JDG_REQ_DVSN_CD) AS JDG_REQ_DVSN_NM
		     , (SELECT ST.CD_NM FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = '1000045' AND ST.CD = T3.VT_KND_CD) AS VT_KND_NM
		     , (SELECT ST.CD_NM FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = '1000807' AND ST.CD = T3.ACP_HNDL_STA_CD) AS ACP_HNDL_STA_NM
		     , (SELECT ST.CD_NM FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = DECODE(T3.ACP_DVSN_CD, '1','1000873','1000874') AND ST.CD = T3.DMS_RSN_CD) AS DMS_RSN_NM
		     , (SELECT ST.USR_DFN_TXT_1 FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = DECODE(T3.ACP_DVSN_CD, '1','1000873','1000874') AND ST.CD = T3.DMS_RSN_CD) AS DMS_RSN_NO
		     , (SELECT ST.DPT_NM FROM TBDCMACM002M ST WHERE ST.DPT_CD = T3.DPT_CD) AS DPT_NM
		     , (SELECT TO_CHAR(TO_DATE(MAX(ST.SBMT_FIX_DT)),'YYYY-MM-DD')
		          FROM TBBADFRE114M ST
		         WHERE ST.ACP_YR = T3.ACP_YR
		           AND ST.ACP_DVSN_CD = T3.ACP_DVSN_CD
		           AND ST.ACP_SRNO = T3.ACP_SRNO) AS SBMT_FIX_DT /*소위원회 확정일*/
		     ,(CASE WHEN T3.MG_ACP_YR IS NULL THEN ''
                    WHEN T3.MG_DIV_CD = '10' THEN '병합(' || (SELECT COUNT(*)
                                                                 FROM TBBADFRE012M ST
                                                                WHERE ST.MG_ACP_YR = T3.MG_ACP_YR
                                                                  AND ST.MG_ACP_DVSN_CD = T3.MG_ACP_DVSN_CD
                                                                  AND ST.MG_ACP_SRNO = T3.MG_ACP_SRNO) || ')'
                    WHEN T3.MG_DIV_CD = '20' THEN '병행(' || (SELECT COUNT(*)
                                                                 FROM TBBADFRE012M ST
                                                                WHERE ST.MG_ACP_YR = T3.MG_ACP_YR
                                                                  AND ST.MG_ACP_DVSN_CD = T3.MG_ACP_DVSN_CD
                                                                  AND ST.MG_ACP_SRNO = T3.MG_ACP_SRNO) || ')'
                ELSE '' END) AS MG_COUNT
		     , NVL((SELECT TO_CHAR(TO_DATE(MAX(ST.SBCN_DY)),'YYYY-MM-DD')
		              FROM TBBADFRE113M ST
		             WHERE ST.ACP_YR = T3.ACP_YR
		               AND ST.ACP_DVSN_CD = T3.ACP_DVSN_CD
		               AND ST.ACP_SRNO = T3.ACP_SRNO), to_char(to_date(T3.SBCN_DT), 'YYYY-MM-DD')) AS SBCN_DY /*부의일*/
		  FROM (
		
		<include refid="include.pageSelct" />

		SELECT   ACP_NO
               , ACP_NO_HD
               , WRTANS_SEN_YN
               , ACP_HNDL_STA_CD
               , ACP_DT
               , DSP_OFC_ACP_DT
               , ORG_NM
               , DSP_OFC_UP_INSTT_CD
               , DSP_OFC_UP_INSTT_NAM
               , DSPTCH_INSTT_NAM
               , REQR_NM
               , AGT_NM
               , TIT_NM
               , JDG_REQ_DVSN_CD
               , DPT_CD
               , HNDL_DDLN_DT
               , HNDL_CHGR_NM
               , VT_KND_CD
               , ENF_DT
               , DCS_DT
               , ACP_YR
               , ACP_DVSN_CD
               , ACP_SRNO
               , ORG_ACP_SRNO
               , MG_ACP_YR
               , MG_ACP_DVSN_CD
               , MG_ACP_SRNO
               , MG_DPT_CD
               , MG_DIV_CD
               , ATH_RE_RVW_YN
               , MG_DIV_NM
               , LINK_URL
               , ACP_STEP_CD
               , ACP_STEP_NM
               , ZCD
               , AD
               , DTL_AD
               , SEC_AUD_YN
               , HNDL_DT
               , ORG_DSP_KWA_OPIN_SRCH_DT
               , ORG_DSP_KWA_OPIN_RCPT_DT
               , DOC_ID
               , SOWI_RPRT_KWA
               , SOWI_RPRT_KUK
               , SOWI_RPRT_CHA
               , SOWI_RPRT_CHONG
               , SOWI_RPRT_WON
               , SOWI_APV
               , FRE_RPRT_KWA
               , FRE_RPRT_KUK
               , FRE_RPRT_CHA
               , FRE_RPRT_CHONG
               , FRE_RPRT_WON
               , WI_APV
               , SBCN_DT
               , GAKHA_RPRT_KWA
               , GAKHA_RPRT_KUK
               , CNCL_DT
               , GAKHA_DT
               , DMS_RSN_CD
               , ACP_DOC_ID_1
               , ACP_DOC_ID_2
               , HST_NA
               , HST_DE
               , ETC_CMT_YN
               , ROWNUM
               , DOC_TYPE
               , DOC_TYPE2
               , ODOC_NO
               , AMIT_AM
               , FRT_DLY_RSN || CASE WHEN DLY_RSN_CNT > 1 THEN ' 외 ' || TO_CHAR(DLY_RSN_CNT - 1) || '건'
                                ELSE '' END AS  DLY_RSN_TXT
               , SUBSTR(DLY_RSN_ALL, 0, LENGTH(DLY_RSN_ALL)-2) AS DLY_RSN_ALL
               , DLY_RSN_DETAIL
        FROM (
        <![CDATA[
		SELECT A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || DECODE(A.ORG_ACP_SRNO, null, A.ACP_SRNO, A.ORG_ACP_SRNO) AS ACP_NO /* 분류번호 */
		         , A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || DECODE(A.ORG_ACP_SRNO, null, A.ACP_SRNO, A.ORG_ACP_SRNO) AS ACP_NO_HD
		         ,decode(A.WRTANS_SEN_YN,'Y','발송','N','미발송') as WRTANS_SEN_YN /* 부본 발송 여부 */    
		         ,A.ACP_HNDL_STA_CD /* 진행단계코드 */
			     ,to_char(to_date(A.ACP_DT), 'YYYY-MM-DD') AS ACP_DT		/* 접수일 */
			     ,to_char(to_date(A.DSP_OFC_ACP_DT), 'YYYY-MM-DD') AS DSP_OFC_ACP_DT		/* 처분청접수일자 */
			     ,A.ORG_NM /* 처분청 */ 
			     ,A.DSP_OFC_UP_INSTT_CD /* 처분청상급기관코드 */
			     ,A.DSP_OFC_UP_INSTT_NAM  /* 처분청상급기관명 */
			     ,A.DSPTCH_INSTT_NAM /* 발신기관명 */
			     ,DECODE(A.AGT_NM, NULL, A.REQR_NM, A.REQR_NM  ) AS REQR_NM/* 청구인명 */
			     ,A.AGT_NM /* 대리인명 */
			     ,A.TIT_NM /* 청구내용 */
			     ,A.JDG_REQ_DVSN_CD /* 심사청구부분코드 */
			     ,A.DPT_CD /* 부서코드 */
			     ,to_char(to_date(A.HNDL_DDLN_DT), 'YYYY-MM-DD') AS HNDL_DDLN_DT /* 처리기한 */
			     ,A.HNDL_CHGR_NM /* 담당자 */
                 ,A.VT_KND_CD
			     ,to_char(to_date(B.ENF_DT), 'YYYY-MM-DD') AS ENF_DT /* 시행일 */
			     ,to_char(to_date(A.DCS_DT), 'YYYY-MM-DD') AS DCS_DT /*완결일(위임:결정문 결재완료일,부의:부의일)*/
			     ,A.ACP_YR /* 접수년도 */
			     ,A.ACP_DVSN_CD /* 접수구분코드 */
			     ,A.ACP_SRNO /* 접수일련번호 */
			     ,A.ORG_ACP_SRNO /* 기존접수일련번호 */
			     ,A.MG_ACP_YR /* 병합접수년도 */
			     ,A.MG_ACP_DVSN_CD /* 병합접수구분코드 */
			     ,A.MG_ACP_SRNO /* 병합접수일련번호 */
			     ,A.MG_DPT_CD /* 병합부서코드 */
			     ,A.MG_DIV_CD /* 병합병행구분코드 */
			     ,A.ATH_RE_RVW_YN /* 직권재심의 여부 */
			     ,CASE WHEN (A.ACP_YR = A.MG_ACP_YR AND A.ACP_DVSN_CD = A.MG_ACP_DVSN_CD AND A.ACP_SRNO = A.MG_ACP_SRNO) THEN '대표'
			             WHEN A.MG_DIV_CD IS NULL AND A.MG_ACP_YR IS NULL THEN '대표'
			             WHEN A.MG_DIV_CD IS NULL THEN '대표'
			             WHEN A.MG_DIV_CD = '10' THEN '병합'
			             WHEN A.MG_DIV_CD = '20' THEN '병행'
			      END AS MG_DIV_NM /* 병합병행구분명 */
                 ,DECODE(C.LINK_URL, null, (
                 	SELECT ST1.LINK_URL
                    FROM TBBADFRE101M ST1
                   WHERE ST1.ACP_YR = A.ACP_YR
                      AND ST1.ACP_DVSN_CD = A.ACP_DVSN_CD
                      AND ST1.ACP_SRNO = A.ACP_SRNO
                      AND ST1.NECES_YN ='Y'
                      AND ST1.ACP_STEP_CD = DECODE(A.ACP_DVSN_CD, '1','D1010','E1010')
                 ), C.LINK_URL) AS LINK_URL /* 페이지 URL */
                 ,DECODE(C.ACP_STEP_CD, null, DECODE(A.ACP_DVSN_CD, '1','D1010','E1010'), C.ACP_STEP_CD) AS ACP_STEP_CD /* 프로세스 단계 코드 */
                ,C.ACP_STEP_NM /* 프로세스 단계명 */
				,A.ZCD
				,NVL(A.AGT_AD, A.AD) AS AD
				,NVL(A.AGT_DTL_AD, A.DTL_AD) AS DTL_AD
                , A.SEC_AUD_YN
			    ,CASE WHEN B.ENF_DT IS NULL THEN to_char(TO_DATE(SYSDATE) - TO_DATE(ACP_DT))
			    	  WHEN B.ENF_DT IS NOT NULL THEN to_char(TO_DATE(B.ENF_DT) - TO_DATE(ACP_DT))
			      END AS HNDL_DT /* 경과일 */
				, TO_CHAR(TO_DATE(A.ORG_DSP_KWA_OPIN_SRCH_DT),'YYYY-MM-DD') AS ORG_DSP_KWA_OPIN_SRCH_DT     /*원처분 의견조회일*/
                , TO_CHAR(TO_DATE(A.ORG_DSP_KWA_OPIN_RCPT_DT),'YYYY-MM-DD') AS ORG_DSP_KWA_OPIN_RCPT_DT   /*원처분 의견회신일*/
                , D.DOC_ID
                , D.SOWI_RPRT_KWA   /*소위원회 심의안 결재일*/
                , D.SOWI_RPRT_KUK
                , D.SOWI_RPRT_CHA
                , D.SOWI_RPRT_CHONG
                , D.SOWI_RPRT_WON
                , D.SOWI_APV
                , NVL(D.FRE_RPRT_KWA, to_char(to_date(E.DVCHF_APV_DT), 'YYYY-MM-DD')) AS FRE_RPRT_KWA    /*결정문 결재일*/
                , NVL(D.FRE_RPRT_KUK, to_char(to_date(E.BRUCHF_APV_DT), 'YYYY-MM-DD')) AS FRE_RPRT_KUK
                , D.FRE_RPRT_CHA
                , NVL(D.FRE_RPRT_CHONG, to_char(to_date(E.OW_PSD_APV_DT), 'YYYY-MM-DD')) AS FRE_RPRT_CHONG
                , NVL(D.FRE_RPRT_WON, to_char(to_date(E.LEDG_APV_DT), 'YYYY-MM-DD'))  AS FRE_RPRT_WON
                , NVL(D.WI_APV, to_char(to_date(E.CMTR_APV_DT), 'YYYY-MM-DD')) AS WI_APV
                , E.SBCN_DT
                , D.GAKHA_RPRT_KWA						/*각하검토보고서 결재일*/
                , D.GAKHA_RPRT_KUK
                , DECODE(A.VT_KND_CD, 7, to_char(to_date(B.ENF_DT), 'YYYY-MM-DD'), NULL) AS CNCL_DT /*취하(시행일)*/ 
                , DECODE(A.VT_KND_CD, 8, to_char(to_date(B.ENF_DT), 'YYYY-MM-DD'), NULL) AS GAKHA_DT /*각하(시행일)*/ 
                 , B.DMS_RSN_CD
                  , D.ACP_DOC_ID_1
                  , D.ACP_DOC_ID_2
                  , D.HST_NA /* 결재이력-선람전 (국) */
                  , D.HST_DE /* 결재이력-선람전 (과) */
                  , (SELECT CASE WHEN MAX(T2.CMT_DY) IS NOT NULL THEN 'Y' ELSE 'N' END
                       FROM TBBADDED121M T2
                      WHERE T2.REL_AUD_YR = A.ACP_YR AND DECODE(T2.WORK_DVSN_CD, 'D10','1','E10','2','9') = A.ACP_DVSN_CD 
                      AND T2.REL_AUD_NO = TO_CHAR(A.ACP_SRNO)
                    ) AS ETC_CMT_YN
                , F_CODE_NM('1000894', DOC_WRIT_KND_CD) AS DOC_TYPE
                , D.DOC_TYPE AS DOC_TYPE2  /* 편집기 구분  */ 
                , B.ODOC_NO			/*공문서번호*/
                , A.AMIT_AM         /*결정금액*/
                , DECODE(A.INVST_SUIT_YN,'Y',1,0) + DECODE(A.DMND_PRPS_CHNG_YN,'Y',1,0) + DECODE(A.EVI_MTRL_ADD_PRSN_YN,'Y',1,0) + DECODE(A.ETC_DLY_RSN_YN,'Y',1,0) AS DLY_RSN_CNT
                , DECODE(A.INVST_SUIT_YN,'Y','1항',DECODE(A.DMND_PRPS_CHNG_YN,'Y','2항',DECODE(A.EVI_MTRL_ADD_PRSN_YN,'Y','3항', DECODE(A.ETC_DLY_RSN_YN,'Y','4항','')))) AS FRT_DLY_RSN
                , DECODE(A.INVST_SUIT_YN,'Y','1. 수사 및 소송 관련, ','') || DECODE(A.DMND_PRPS_CHNG_YN,'Y','2. 청구 취지 변경, ','') || DECODE(A.EVI_MTRL_ADD_PRSN_YN,'Y','3. 증거자료 추가제출, ','') || DECODE(A.ETC_DLY_RSN_YN,'Y','4. 기타 지연사유, ','') AS DLY_RSN_ALL
                , A.DLY_RSN_DETAIL
         FROM TBBADFRE012M A  
         INNER JOIN TBBADFRE013D B ON B.ACP_YR = A.ACP_YR AND B.ACP_DVSN_CD = A.ACP_DVSN_CD AND B.ACP_SRNO = A.ACP_SRNO
         LEFT OUTER JOIN (SELECT ST.ACP_YR
                           ,ST.ACP_DVSN_CD
                           ,ST.ACP_SRNO
                           ,ST.LINK_URL
                           ,ST.ACP_STEP_CD
                           ,ST.ACP_STEP_NM
                           ,(SELECT MAX(ST2.ACP_STEP_CD)
                      						  FROM TBBADFRE101M ST2 
                      						  WHERE ST2.ACP_YR = ST.ACP_YR
						                      AND ST2.ACP_DVSN_CD = ST.ACP_DVSN_CD
						                      AND ST2.ACP_SRNO = ST.ACP_SRNO
						                      AND ST2.NECES_YN ='Y') AS MAX_ACP_STEP_CD
                     FROM TBBADFRE101M ST
                    WHERE ST.STEP_CMPT_YN = 'P'
                       AND ST.NECES_YN ='Y') C ON C.ACP_YR = A.ACP_YR AND C.ACP_DVSN_CD = A.ACP_DVSN_CD AND C.ACP_SRNO = A.ACP_SRNO
		  LEFT OUTER JOIN (SELECT A.ACP_YR
	                    , A.ACP_DVSN_CD
	                    , A.ACP_SRNO
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'30',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_KWA  /* 과장 결재일 */
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'20',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'25',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_KUK  /* 국장 결재일 */
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'14',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_CHA                   /* 차장 결재일 */
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'13',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_CHONG  /* 총장 결재일 */
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'11',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_WON  /* 원장 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'30',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_KWA  /* 과장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'20',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'25',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_KUK  /* 국장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'14',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_CHA                   /* 차장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'13',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_CHONG  /* 총장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'11',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_WON  /* 원장 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100200', 'E10100200') THEN DECODE(C.USR_DFN_TXT_5,'30',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS GAKHA_RPRT_KWA  /* 과장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10100200', 'E10100200') THEN DECODE(C.USR_DFN_TXT_5,'20',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'25',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS GAKHA_RPRT_KUK  /* 국장 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100001', 'E10100001') THEN A.APV_RQS_ID ELSE '' END) AS HST_NA
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100002', 'E10100002') THEN A.APV_RQS_ID ELSE '' END) AS HST_DE
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100001', 'E10100001') THEN A.DOC_ID ELSE '' END) AS ACP_DOC_ID_1
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100002', 'E10100002') THEN A.DOC_ID ELSE '' END) AS ACP_DOC_ID_2
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10300200', 'E10500200') THEN DECODE(C.USR_DFN_TXT_5,'12',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS WI_APV  /* 주심위원 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('E10300150') THEN DECODE(C.USR_DFN_TXT_5,'12',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS SOWI_APV  /* 주심위원 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10400600','E10600300') THEN A.DOC_ID ELSE '' END) AS DOC_ID
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10400600','E10600300') THEN DECODE(SUBSTR(A.LINK_URL, 1, 7),'polaris', 'polaris','hancom') ELSE '' END) AS DOC_TYPE
	             FROM TBBADFRE103M A
	             LEFT OUTER JOIN TBDCMACM023l B ON (A.APV_RQS_ID = B.APV_DOC_NO)
	             LEFT OUTER JOIN TBDCMACM013C C ON (C.USR_DFN_TXT_1 = B.APVR_PST_CD AND C.CMM_CD_DVSN_CD = '1000659' AND C.CD <> '24') 
	             WHERE A.RPRT_CD IN ('E10200200','D10200200', 'E10400200','D10100200', 'E10100200','D10100001', 'E10100001','D10100002', 'E10100002','D10300200', 'E10500200', 'E10300150', 'D10400600','E10600300')    /*소위원회 심의안, 결정문, 각하검토보고서*/
	             GROUP BY A.ACP_YR, A.ACP_DVSN_CD, A.ACP_SRNO) D ON D.ACP_YR = A.ACP_YR AND D.ACP_DVSN_CD = A.ACP_DVSN_CD AND D.ACP_SRNO = A.ACP_SRNO
	        LEFT OUTER JOIN TBBADFRE012D E ON (E.ACP_YR = A.ACP_YR AND E.ACP_DVSN_CD = A.ACP_DVSN_CD AND E.ACP_SRNO = A.ACP_SRNO)
                 WHERE A.DEL_YN IS NULL
		]]>
		<!-- 접수년도 -->
		<if test='dptCd != null and dptCd != ""'>
			AND A.DPT_CD  = #{dptCd}
		</if>
		<if test='acpYr != null and acpYr != ""'>
			AND A.ACP_YR = #{acpYr}
		</if>
		<!-- 구분코드 -->
		<if test='acpDvsnCd != null and acpDvsnCd != ""'>
			AND A.ACP_DVSN_CD = #{acpDvsnCd}
		</if>
		<!-- 접수번호 -->
		<if test='acpSrno != null and acpSrno != ""'>
			AND (NVL(A.ORG_ACP_SRNO,A.ACP_SRNO) = #{acpSrno})
		</if>
		<!-- 접수일자 -->
		<if test='acpDhs != null and acpDhs != ""'>
			AND TO_CHAR(TO_DATE(A.ACP_DT),'YYYYMMDD') &gt;= #{acpDhs}
		</if>
		<if test='acpDhe != null and acpDhe != ""'>
			AND TO_CHAR(TO_DATE(A.ACP_DT),'YYYYMMDD') &lt;= #{acpDhe}
		</if>
		<if test='dcsDts != null and dcsDts != ""'>
			AND TO_CHAR(TO_DATE(A.DCS_DT),'YYYYMMDD') &gt;= #{dcsDts}
		</if>
		<if test='dcsDte != null and dcsDte != ""'>
			AND TO_CHAR(TO_DATE(A.DCS_DT),'YYYYMMDD') &lt;= #{dcsDte}
		</if>
		<if test='enfDts != null and enfDts != ""'>
			AND TO_CHAR(TO_DATE(B.ENF_DT),'YYYYMMDD') &gt;= #{enfDts}
		</if>
		<if test='enfDte != null and enfDte != ""'>
			AND TO_CHAR(TO_DATE(B.ENF_DT),'YYYYMMDD') &lt;= #{enfDte}
		</if>
		<!-- 처리기한 -->
		<if test='hndlDdlnDts != null and hndlDdlnDts != ""'>
			AND TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYYMMDD') &gt;= #{hndlDdlnDts}
		</if>
		<if test='hndlDdlnDte != null and hndlDdlnDte != ""'>
			AND TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYYMMDD') &lt;= #{hndlDdlnDte}
		</if>
		<!-- <if test='enfYn == "Y"'>
			처리과
			<if test='dptCd != null and dptCd != ""'>
				AND A.DPT_CD =#{dptCd}
			</if>
			담당자
			<if test='hndlChgrCd != null and hndlChgrCd != ""'>
				AND A.HNDL_CHGR_CD  =#{hndlChgrCd}
			</if>
		</if> -->
		
		<if test='hndlChgrCd != null and hndlChgrCd != ""'>
			AND A.HNDL_CHGR_CD  =#{hndlChgrCd}
		</if>
		<if test='hndlChgrNm != null and hndlChgrNm != ""'>
			AND A.HNDL_CHGR_NM  =#{hndlChgrNm}
		</if>
		<!-- 진행단계 -->
		<if test='acpHndlStaCd != null and acpHndlStaCd != ""'>
			AND A.ACP_HNDL_STA_CD  =#{acpHndlStaCd}
		</if>
		<if test='titNm != null and titNm != ""'>
			AND A.TIT_NM  LIKE '%' || #{titNm} || '%'
		</if>
		<!-- 처분청 -->
		<if test='rltnOrgCd != null and rltnOrgCd != ""'>
			AND A.ORG_CD	= #{rltnOrgCd}
		</if>
		<!-- 발신기관 -->
		<if test='dsptchInsttNam != null and dsptchInsttNam != ""'>
			AND A.DSPTCH_INSTT_NAM like '%' || #{dsptchInsttNam} || '%'
		</if>
		<!-- 청구인명 -->
		<if test='reqrNm != null and reqrNm != ""'>
			AND A.REQR_NM LIKE '%' || #{reqrNm} || '%'
		</if>
		<!-- 병행/병합 -->
		<if test='sType != null and sType != ""'>
			AND A.MG_ACP_YR IS NULL
		</if>
        <!-- 완결여부 -->
        <if test='cpltYn != null and cpltYn != ""'>
        	<if test='cpltYn == "1"'>
                AND (B.ENF_DT IS NULL OR A.ACP_HNDL_STA_CD NOT IN ('420') )
            </if>
        	<if test='cpltYn == "2"'>
                AND ((B.ENF_DT IS NOT NULL AND A.ACP_HNDL_STA_CD IN ('420') )
                	OR A.ACP_HNDL_STA_CD IS NULL AND B.ENF_DT IS NOT NULL)
            </if>
        </if>
		<!-- 의결종류 -->
		<if test="vtKndCd != null and vtKndCd != ''">
            AND A.VT_KND_CD = #{vtKndCd}
		</if>
		<if test='viewYn == null or viewYn == ""'>
			<if test='authDvsnCd == "1"'>
				AND A.DPT_CD  = #{sDptCd}
			</if>
			<if test='authDvsnCd == "2"'>
				AND A.HNDL_CHGR_CD  = #{sCnb}
			</if>
		</if>	
		<if test='invstSuitYn != null and invstSuitYn != "" and invstSuitYn eq "Y".toString()'>
			AND INVST_SUIT_YN = 'Y'
		</if>
		<if test='dmndPrpsChngYn != null and dmndPrpsChngYn != "" and dmndPrpsChngYn eq "Y".toString()'>
			AND DMND_PRPS_CHNG_YN = 'Y'
		</if>
		<if test='eviMtrlAddPrsnYn != null and eviMtrlAddPrsnYn != "" and eviMtrlAddPrsnYn eq "Y".toString()'>
			AND EVI_MTRL_ADD_PRSN_YN = 'Y'
		</if>
		<if test='etcDlyRsnYn != null and etcDlyRsnYn != "" and etcDlyRsnYn eq "Y".toString()'>
			AND ETC_DLY_RSN_YN = 'Y'
		</if>
		ORDER BY A.FRT_REGI_DH DESC
		) T1
		WHERE 1=1
		<if test='popupCd != null and popupCd != ""'>
		   AND HNDL_CHGR_NM IS NOT NULL
		   AND ACP_HNDL_STA_CD >= 250
		</if>
		<if test='mgDivNm != null and mgDivNm != ""'>
		   AND MG_DIV_NM  = #{mgDivNm}
		</if>
		<if test='acpNo != null and acpNo != ""'>
		     AND ACP_NO NOT IN
			 <foreach item="item" index="index" collection="acpNo" open="(" close=")" separator=",">
		            #{item}
		    </foreach>
		</if>
		<include refid="include.pageOrder" />
		) T3
	</select>

	<!-- 심사청구 병합/병행 조회-->
	<select id="BADFRE211EMergeselect" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.bad.fre.dao.BADFRE211Mapper.BADFRE211EMergeselect */
		<![CDATA[
		SELECT A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || DECODE(A.ORG_ACP_SRNO, null, A.ACP_SRNO, A.ORG_ACP_SRNO) AS ACP_NO /* 분류번호 */
			     ,to_char(to_date(A.ACP_DT), 'YYYY-MM-DD') AS ACP_DT		/* 접수일 */
			     ,to_char(to_date(A.DSP_OFC_ACP_DT), 'YYYY-MM-DD') AS DSP_OFC_ACP_DT		/* 처분청접수일자 */
			     ,A.ORG_NM /* 처분청 */
			     ,A.DSP_OFC_UP_INSTT_CD /* 처분청상급기관코드 */
			     ,A.DSP_OFC_UP_INSTT_NAM  /* 처분청상급기관명 */
			     ,A.DSPTCH_INSTT_NAM /* 발신기관명 */
			     ,DECODE(A.AGT_NM, NULL, A.REQR_NM, A.REQR_NM || '(代:' || A.AGT_NM || ')' ) AS REQR_NM/* 청구인명 */
			     ,A.TIT_NM /* 청구내용 */
			     ,A.JDG_REQ_DVSN_CD /* 심사청구부분코드 */
			     ,F_CODE_NM('1000043', A.JDG_REQ_DVSN_CD) AS JDG_REQ_DVSN_NM /* 심사청구구분명 */
			     ,A.DPT_CD /* 부서코드 */
			     ,F_DPT_INFO (A.DPT_CD, '1') AS DPT_NM /* 처리과 */
			     ,A.HNDL_CHGR_NM /* 담당자 */
			     ,A.ACP_HNDL_STA_CD /* 진행단계 */
			     ,F_CODE_NM('1000807', A.ACP_HNDL_STA_CD) AS ACP_HNDL_STA_NM /* 진행단계명 */
			     ,A.VT_KND_CD /* 의결종류 */
			     ,F_CODE_NM('1000045', A.VT_KND_CD) AS VT_KND_NM /* 의결종류명 */
			     ,A.HNDL_OPNN_CD /* 처리의견 */
			     ,F_CODE_NM('1000045', A.HNDL_OPNN_CD) AS HNDL_OPNN_NM /* 처리의견 */
			     ,to_char(to_date(A.DCS_DT), 'YYYY-MM-DD') AS DCS_DT /* 결정일자 */
			     ,A.ACP_YR /* 접수년도 */
			     ,A.ACP_DVSN_CD /* 접수구분코드 */
			     ,A.ACP_SRNO /* 접수일련번호 */
			     ,A.ORG_ACP_SRNO /* 기존접수일련번호 */
			     ,A.MG_ACP_YR /* 병합접수년도 */
			     ,A.MG_ACP_DVSN_CD /* 병합접수구분코드 */
			     ,A.MG_ACP_SRNO /* 병합접수일련번호 */
			     ,A.MG_DPT_CD /* 병합부서코드 */
			     ,A.MG_DIV_CD /* 병합병행구분코드 */
			     ,A.DEL_YN
			     ,A.AMIT_AM /* 결정금액 */
			     ,CASE WHEN (A.ACP_YR = A.MG_ACP_YR AND A.ACP_DVSN_CD = A.MG_ACP_DVSN_CD AND A.ACP_SRNO = A.MG_ACP_SRNO) THEN '대표'
			             WHEN A.MG_DIV_CD IS NULL AND A.MG_ACP_YR IS NULL THEN '대표'
			             WHEN A.MG_DIV_CD IS NULL THEN '대표'
			             WHEN A.MG_DIV_CD = '10' THEN '병합'
			             WHEN A.MG_DIV_CD = '20' THEN '병행'
			      END AS MG_DIV_NM /* 병합병행구분명 */
			    ,(SELECT MAX(LINK_URL)
			       FROM TBBADFRE101M
			      WHERE ACP_YR = A.ACP_YR
			         AND ACP_DVSN_CD = A.ACP_DVSN_CD
			         AND ACP_SRNO = A.ACP_SRNO
			         AND STEP_CMPT_YN = 'P'
			         AND NECES_YN ='Y') AS LINK_URL
			    ,CASE WHEN B.ENF_DT IS NULL THEN to_char(TO_DATE(SYSDATE) - TO_DATE(ACP_DT))
			    	  WHEN B.ENF_DT IS NOT NULL THEN to_char(TO_DATE(B.ENF_DT) - TO_DATE(ACP_DT))
			      END AS PASS_DAY /* 경과일 */
			    ,DECODE(A.BAI_DSP_YN, 'Y', 'O', 'X') AS BAI_DSP_YN /* 감사원처분여부 */
			    ,to_char(to_date(A.HNDL_DDLN_DT), 'YYYY-MM-DD') AS HNDL_DDLN_DT /* 처리기한 */
			    ,A.REFER_ENT /* 부의위임여부 Y,N */
			    ,A.REFER_ENT_RSN /* 위임사유 */
			    ,to_char(to_date(B.ENFM_DT), 'YYYY-MM-DD') AS ENFM_DT		/* 집행일 */
			    ,B.ENFM_TXT /* 집행내용 */
			    ,B.LWS_YO /* 소송유무 */
			    ,B.FRTRL_EVT_NO_TXT /* 1심사건번호 */
			    ,B.FRTRL_CT_NM /* 1심법원명 */
			    ,(SELECT MAX(DOC_ID)
			       FROM TBFDMADM002M
			      WHERE AUD_DOC_CD = #{audDocCd}) AS T_DOC_ID /* 템플릿 문서 ID */
			    ,C.DOC_ID /* 문서 ID */
			    ,C.RPRT_CD
		]]>
		<![CDATA[
		      ,(SELECT CASE WHEN APV_STA_CD > 0 THEN 'N'
		  				END
			       FROM TBBADFRE103M
				      WHERE ACP_YR = C.ACP_YR
				         AND ACP_DVSN_CD = C.ACP_DVSN_CD
				         AND ACP_SRNO = C.ACP_SRNO
		]]>
				      <if test='acpStepCd != null and acpStepCd != ""'>
	        		     AND ACP_STEP_CD = #{acpStepCd}
					  </if>
		<![CDATA[
			         	 AND RPRT_CD = #{audDocSmryCd}
			         	 AND REF_ID = C.DOC_ID) AS DOC_DEL_YN 
			  ,C.RPRT_NM   /* 보고서명 */
			  , C.TEMPLATE_DOC_ID
			  , A.AUD_YR
              , A.AUD_NO
              , A.DSP_RQ_SNO
              , D.DOC_ID AS DOC_ID_2  /*결정서*/
              , D.APV_STA_CD AS APV_STA_CD_2
		      , E.DOC_ID AS DOC_ID_3  /*공개문*/
              , E.APV_STA_CD AS APV_STA_CD_3
              , F.DOC_ID AS DOC_ID_4  /*청구인시행문*/
              , F.APV_STA_CD AS APV_STA_CD_4
              , G.DOC_ID AS DOC_ID_5  /*중앙부처시행문*/
              , G.APV_STA_CD AS APV_STA_CD_5
			  , C.SHARE_YN
			  , F_CODE_NM('1000894', A.DOC_WRIT_KND_CD) AS DOC_TYPE  /* 편집기 구분  */ 
			  , A.WDW_RQS_STA_CD
			  , A.WT_VT_YN
		 FROM TBBADFRE012M A
		 LEFT OUTER JOIN TBBADFRE013D B ON (A.ACP_YR 		= B.ACP_YR
                                           AND A.ACP_DVSN_CD 	= B.ACP_DVSN_CD
                                           AND A.ACP_SRNO 		= B.ACP_SRNO)
         LEFT OUTER JOIN TBBADFRE103M C ON (A.ACP_YR 		= C.ACP_YR
                                           AND A.ACP_DVSN_CD 	= C.ACP_DVSN_CD
                                           AND A.ACP_SRNO 		= C.ACP_SRNO
                                           ]]>
                                           <if test='rprtNm != null and rprtNm != ""'>
						        		     	AND C.RPRT_NM = #{rprtNm}
										   </if>
										   <if test='acpStepCd != null and acpStepCd != ""'>
						        		     	AND C.ACP_STEP_CD = #{acpStepCd}
										   </if>
									         	AND C.RPRT_CD = #{audDocCd}
                                           )
        LEFT OUTER JOIN TBBADFRE103M D ON (A.ACP_YR 		= D.ACP_YR
                                           AND A.ACP_DVSN_CD 	= D.ACP_DVSN_CD
                                           AND A.ACP_SRNO 		= D.ACP_SRNO
						        		   AND D.ACP_STEP_CD IN ('D1040', 'E1060')
									       AND D.RPRT_CD IN ('D10400100', 'E10600050')  /*결정서*/
                                           )
         LEFT OUTER JOIN TBBADFRE103M E ON (A.ACP_YR 		= E.ACP_YR
                                           AND A.ACP_DVSN_CD 	= E.ACP_DVSN_CD
                                           AND A.ACP_SRNO 		= E.ACP_SRNO
						        		   AND E.ACP_STEP_CD IN ('D1040', 'E1060')
									       AND E.RPRT_CD IN ('D10400600', 'E10600300')  /*공개문*/
                                           )
         LEFT OUTER JOIN TBBADFRE103M F ON (A.ACP_YR 		= F.ACP_YR
                                           AND A.ACP_DVSN_CD 	= F.ACP_DVSN_CD
                                           AND A.ACP_SRNO 		= F.ACP_SRNO
						        		   AND F.ACP_STEP_CD IN ('D1040')
									       AND F.RPRT_CD IN ('D10400400')  /*청구인시행문*/
                                           )
         LEFT OUTER JOIN TBBADFRE103M G ON (A.ACP_YR 		= G.ACP_YR
                                           AND A.ACP_DVSN_CD 	= G.ACP_DVSN_CD
                                           AND A.ACP_SRNO 		= G.ACP_SRNO
						        		   AND G.ACP_STEP_CD IN ('D1040', 'E1060')
									       AND G.RPRT_CD IN ('D10400300', 'E10600200')  /*중앙부처시행문*/
                                           )
	    WHERE 1=1
		   --AND A.DEL_YN IS NULL
		<if test='acpYr != null and acpYr != ""'>
            AND A.ACP_YR = #{acpYr}
        </if>
        <if test='acpDvsnCd != null and acpDvsnCd != ""'>
            AND A.ACP_DVSN_CD = #{acpDvsnCd}
        </if>
        <if test='acpSrno != null and acpSrno != ""'>
            AND A.ACP_SRNO = #{acpSrno}
        </if>
        <if test='mgAcpYr != null and mgAcpYr != ""'>
		  AND A.MG_ACP_YR 		= #{mgAcpYr}
		</if>
		<if test='mgAcpDvsnCd != null and mgAcpDvsnCd != ""'>
		  AND A.MG_ACP_DVSN_CD 	= #{mgAcpDvsnCd}
		</if>
		<if test='mgAcpSrno != null and mgAcpSrno != ""'>
		  AND A.MG_ACP_SRNO 		= #{mgAcpSrno}
		</if>
		<if test='mgDptCd != null and mgDptCd != ""'>
		  AND A.MG_DPT_CD		= #{mgDptCd}
		</if>
       ORDER BY MG_DIV_NM, A.ACP_YR ASC, A.ACP_SRNO, A.ORG_ACP_SRNO ASC
	</select>
	
	<select id="selectProcessYnCheck" parameterType="paramMap" resultType="String">
		SELECT CASE WHEN COUNT(B.ACP_YR) = '0' THEN 'N' ELSE 'Y' END AS PRCS_YN
        FROM TBBADFRE012M A
        LEFT OUTER JOIN TBBADFRE101M B ON(A.ACP_YR = B.ACP_YR AND A.ACP_DVSN_CD = B.ACP_DVSN_CD AND A.ACP_SRNO = B.ACP_SRNO)
        WHERE A.ACP_YR = #{acpYr}
        AND A.ACP_DVSN_CD = #{acpDvsnCd}
        AND A.ACP_SRNO = #{acpSrno}
	</select>
	
	<select id="selectCmtInfo" parameterType="paramMap" resultType="egovMap">
		/*kr.go.bai.eip.bad.fre.dao.BADFRE211Mapper.selectCmtInfo*/
           SELECT CMT_DY, CMT_DVSN_CD, CMT_SQ
             FROM (
                     SELECT ST2.CMT_DY, ST2.CMT_DVSN_CD,  ST2.CMT_SQ
                       FROM TBBADFRE113M ST
                 INNER JOIN TBBADDED120M ST2 ON (ST2.CMT_DY = ST.SBCN_DY
                                             AND ST2.CMT_DVSN_CD = '10')
                      WHERE ST.ACP_YR = #{acpYr}
                        AND ST.ACP_DVSN_CD = #{acpDvsnCd}
                        AND ST.ACP_SRNO = #{acpSrno}
                 UNION
                SELECT ST2.CMT_DY, ST2.CMT_DVSN_CD,  ST2.CMT_SQ
                  FROM TBBADFRE114M ST
            INNER JOIN TBBADDED120M ST2 ON (ST2.CMT_DY = ST.SBMT_FIX_DT
                                       AND ST2.CMT_DVSN_CD = '20')
                 WHERE ST.ACP_YR = #{acpYr}
                   AND ST.ACP_DVSN_CD = #{acpDvsnCd}
                   AND ST.ACP_SRNO = #{acpSrno}
                 UNION
                SELECT CMT_DY, CMT_DVSN_CD, CMT_SQ
                  FROM TBBADDED121M
                 WHERE REL_AUD_YR = #{acpYr}
                   AND REL_AUD_NO = #{acpSrno}
                   AND DECODE(WORK_DVSN_CD, 'D10','1','E10','2','9') = #{acpDvsnCd}
             )
             ORDER BY CMT_DY DESC, CMT_SQ DESC
	</select>
	
	<select id="selectMainListForPopup" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.bad.fre.dao.BADFRE211Mapper.selectMainListForPopup */
        <![CDATA[
        	SELECT T1.ACP_NO                       /*접수번호*/
               , T1.HST_NA                     /*결재코드(국)*/
               , T1.HST_DE                     /*결재코드(과)*/
               , T1.ACP_HNDL_STA_CD            /*진행단계코드*/
               , T1.ACP_HNDL_STA_NM            /*진행단계명*/
               , T1.ACP_DT                     /*접수일*/
               , T1.DSP_OFC_ACP_DT             /*처분청접수일*/
               , T1.ORG_NM                     /*처분청*/
               , T1.DSPTCH_INSTT_NAM           /*발신기관명*/
               , T1.REQR_NM                    /*청구인명*/
               , T1.TIT_NM                     /*제목*/
               , T1.DPT_CD                     /*부서코드*/
               , T1.DPT_NM                     /*부서명*/
               , T1.HNDL_DDLN_DT               /*처리기한*/
               , T1.HNDL_CHGR_NM               /*담당자*/
               , T1.ENF_DT                     /*결정일*/
               , T1.ACP_YR                     /*접수년도*/
               , T1.ACP_DVSN_CD                /*접수구분*/    
               , T1.ACP_SRNO                   /*접수일련번호*/
               , T1.ORG_ACP_SRNO               /*접수일련번호(구)*/
               , T1.MG_ACP_YR                  /*대표건 접수년도*/
               , T1.MG_ACP_DVSN_CD             /*대표건 접수구분*/
               , T1.MG_ACP_SRNO                /*대표건 접수일련번호*/
               , T1.MG_DPT_CD                  /*병합부서코드*/
               , T1.MG_DIV_CD                  /*병행병합구분코드 10:병합, 20:병행*/
               , T1.MG_DIV_NM                  /*병행병합구분*/
               , DECODE(MG_COUNT,0,'',DECODE(MG_DIV_CD,'10','병합(' || MG_COUNT || ')', '병행(' || MG_COUNT || ')')) AS MG_COUNT                   /*병행병합 건수*/
               , DECODE(T2.LINK_URL, null, (
                 	SELECT ST1.LINK_URL
                    FROM TBBADFRE101M ST1
                   WHERE ST1.ACP_YR = T1.ACP_YR
                      AND ST1.ACP_DVSN_CD = T1.ACP_DVSN_CD
                      AND ST1.ACP_SRNO = T1.ACP_SRNO
                      AND ST1.NECES_YN ='Y'
                      AND ST1.ACP_STEP_CD = (SELECT MAX(ST2.ACP_STEP_CD)
                      						  FROM TBBADFRE101M ST2 
                      						  WHERE ST2.ACP_YR = ST1.ACP_YR
						                      AND ST2.ACP_DVSN_CD = ST1.ACP_DVSN_CD
						                      AND ST2.ACP_SRNO = ST1.ACP_SRNO
						                      AND ST2.NECES_YN ='Y')
                 ), T2.LINK_URL) AS LINK_URL /* 페이지 URL */
               , DECODE(T2.ACP_STEP_CD, null, (SELECT MAX(ACP_STEP_CD)
                                                        FROM TBBADFRE101M
                                                       WHERE ACP_YR = T1.ACP_YR
                                                          AND ACP_DVSN_CD = T1.ACP_DVSN_CD
                                                          AND ACP_SRNO = T1.ACP_SRNO
                                                          AND NECES_YN ='Y'), T2.ACP_STEP_CD) AS ACP_STEP_CD /* 프로세스 단계 코드 */
                 ,T2.ACP_STEP_NM /* 프로세스 단계명 */
               , PRC_CNT                    /*전자감사여부구분값*/
               , PRC_CNT2                   /*전자감사여부구분값*/
               , HNDL_DT                    /*경과일*/
               , ROWNUM
               , T1.DOC_TYPE   /* 편집기 구분  */ 
        FROM (
		    SELECT A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || DECODE(A.ORG_ACP_SRNO, null, A.ACP_SRNO, A.ORG_ACP_SRNO) AS ACP_NO /* 분류번호 */
		         ,(SELECT
		               APV_RQS_ID      /*결재ID*/
		          FROM TBBADFRE103M 
		          WHERE ACP_YR = A.ACP_YR
		             AND ACP_DVSN_CD = A.ACP_DVSN_CD
		             AND ACP_SRNO = A.ACP_SRNO
		             AND APV_RQS_ID IS NOT NULL
		             AND RPRT_CD = DECODE('1','1','D10100001','2','E10100001')) as HST_NA /* 결재이력-선람전 (국) */
		         ,(SELECT
		               APV_RQS_ID      
		          FROM TBBADFRE103M 
		          WHERE ACP_YR = A.ACP_YR
		             AND ACP_DVSN_CD = A.ACP_DVSN_CD
		             AND ACP_SRNO = A.ACP_SRNO
		             AND APV_RQS_ID IS NOT NULL
		             AND RPRT_CD = DECODE('1','1','D10100002','2','E10100002')) as HST_DE /* 결재이력-선람전 (과) */
		         ,A.ACP_HNDL_STA_CD /* 진행단계코드 */
			     ,F_CODE_NM('1000807', A.ACP_HNDL_STA_CD) AS ACP_HNDL_STA_NM /* 진행단계명 */
			     ,to_char(to_date(A.ACP_DT), 'YYYY-MM-DD') AS ACP_DT		/* 접수일 */
			     ,to_char(to_date(A.DSP_OFC_ACP_DT), 'YYYY-MM-DD') AS DSP_OFC_ACP_DT		/* 처분청접수일자 */
			     ,A.ORG_NM /* 처분청 */
			     ,A.DSPTCH_INSTT_NAM /* 발신기관명 */
			     ,DECODE(A.AGT_NM, NULL, A.REQR_NM, A.REQR_NM || '(代:' || A.AGT_NM || ')' ) AS REQR_NM/* 청구인명 */
			     ,A.TIT_NM /* 청구내용 */
			     ,A.DPT_CD /* 부서코드 */
			     ,(SELECT DPT_NM FROM TBDCMACM002M WHERE DPT_CD = A.DPT_CD) AS DPT_NM /* 처리과 */
			     ,to_char(to_date(A.HNDL_DDLN_DT), 'YYYY-MM-DD') AS HNDL_DDLN_DT /* 처리기한 */
			     ,A.HNDL_CHGR_NM /* 담당자 */
                 ,A.HNDL_CHGR_CD
			     ,to_char(to_date(B.ENF_DT), 'YYYY-MM-DD') AS ENF_DT /* 결정일자(시행일) */
			     ,A.ACP_YR /* 접수년도 */
			     ,A.ACP_DVSN_CD /* 접수구분코드 */
			     ,A.ACP_SRNO /* 접수일련번호 */
			     ,A.ORG_ACP_SRNO /* 기존접수일련번호 */
			     ,A.MG_ACP_YR /* 병합접수년도 */
			     ,A.MG_ACP_DVSN_CD /* 병합접수구분코드 */
			     ,A.MG_ACP_SRNO /* 병합접수일련번호 */
			     ,A.MG_DPT_CD /* 병합부서코드 */
			     ,A.MG_DIV_CD /* 병합병행구분코드 */
			     ,CASE WHEN (A.ACP_YR = A.MG_ACP_YR AND A.ACP_DVSN_CD = A.MG_ACP_DVSN_CD AND A.ACP_SRNO = A.MG_ACP_SRNO) THEN '대표'
			           WHEN A.MG_DIV_CD IS NULL AND A.MG_ACP_YR IS NULL THEN '대표'
			           WHEN A.MG_DIV_CD IS NULL THEN '대표'
			           WHEN A.MG_DIV_CD = '10' THEN '병합'
			           WHEN A.MG_DIV_CD = '20' THEN '병행'
			            END AS MG_DIV_NM /* 병합병행구분명 */
			     ,(SELECT COUNT(MG_ACP_YR)
                     FROM TBBADFRE012M
                    WHERE MG_ACP_YR = A.MG_ACP_YR
                      AND MG_ACP_DVSN_CD = A.MG_ACP_DVSN_CD
                      AND MG_ACP_SRNO = A.MG_ACP_SRNO) AS MG_COUNT
			     ,(SELECT COUNT(ACP_YR)
			       FROM TBBADFRE103M
			      WHERE ACP_YR = A.ACP_YR
			         AND ACP_DVSN_CD = A.ACP_DVSN_CD
			         AND ACP_SRNO = A.ACP_SRNO) AS PRC_CNT /* 프로세스 갯수 */
			     ,(SELECT COUNT(ACP_YR)
			       FROM TBBADFRE102M
			      WHERE ACP_YR = A.ACP_YR
			         AND ACP_DVSN_CD = A.ACP_DVSN_CD
			         AND ACP_SRNO = A.ACP_SRNO) AS PRC_CNT2  /* 프로세스 갯수 */
			    ,CASE WHEN B.ENF_DT IS NULL THEN to_char(TO_DATE(SYSDATE) - TO_DATE(ACP_DT))
			    	  WHEN B.ENF_DT IS NOT NULL THEN to_char(TO_DATE(B.ENF_DT) - TO_DATE(ACP_DT))
			      END AS HNDL_DT /* 경과일 */
			    , F_CODE_NM('1000894', A.DOC_WRIT_KND_CD) AS DOC_TYPE /* 편집기 구분  */ 
		 FROM TBBADFRE012M A
		 INNER JOIN TBBADFRE013D B ON (B.ACP_YR 		= A.ACP_YR
                                       AND B.ACP_DVSN_CD 	= A.ACP_DVSN_CD
                                       AND B.ACP_SRNO 		= A.ACP_SRNO)
	    WHERE 1=1
		]]>
		<!-- 접수년도 -->
		<if test='dptCd != null and dptCd != ""'>
			AND A.DPT_CD  = #{dptCd}
		</if>
		<if test='acpYr != null and acpYr != ""'>
			AND A.ACP_YR = #{acpYr}
		</if>
		<!-- 구분코드 -->
		<if test='acpDvsnCd != null and acpDvsnCd != ""'>
			AND A.ACP_DVSN_CD = #{acpDvsnCd}
		</if>
		<!-- 접수번호 -->
		<if test='acpSrno != null and acpSrno != ""'>
			AND (NVL(A.ORG_ACP_SRNO,A.ACP_SRNO) = #{acpSrno})
		</if>
		<!-- 접수일자 -->
		<if test='acpDhs != null and acpDhs != ""'>
			AND TO_CHAR(TO_DATE(A.ACP_DT),'YYYYMMDD') &gt;= #{acpDhs}
		</if>
		<if test='acpDhe != null and acpDhe != ""'>
			AND TO_CHAR(TO_DATE(A.ACP_DT),'YYYYMMDD') &lt;= #{acpDhe}
		</if>
		<if test='dcsDts != null and dcsDts != ""'>
			AND TO_CHAR(TO_DATE(A.DCS_DT),'YYYYMMDD') &gt;= #{dcsDts}
		</if>
		<if test='dcsDte != null and dcsDte != ""'>
			AND TO_CHAR(TO_DATE(A.DCS_DT),'YYYYMMDD') &lt;= #{dcsDte}
		</if>
		<if test='enfDts != null and enfDts != ""'>
			AND TO_CHAR(TO_DATE(B.ENF_DT),'YYYYMMDD') &gt;= #{enfDts}
		</if>
		<if test='enfDte != null and enfDte != ""'>
			AND TO_CHAR(TO_DATE(B.ENF_DT),'YYYYMMDD') &lt;= #{enfDte}
		</if>
		<!-- 처리기한 -->
		<if test='hndlDdlnDts != null and hndlDdlnDts != ""'>
			AND TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYYMMDD') &gt;= #{hndlDdlnDts}
		</if>
		<if test='hndlDdlnDte != null and hndlDdlnDte != ""'>
			AND TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYYMMDD') &lt;= #{hndlDdlnDte}
		</if>
		<!-- <if test='enfYn == "Y"'>
			처리과
			<if test='dptCd != null and dptCd != ""'>
				AND A.DPT_CD =#{dptCd}
			</if>
			담당자
			<if test='hndlChgrCd != null and hndlChgrCd != ""'>
				AND A.HNDL_CHGR_CD  =#{hndlChgrCd}
			</if>
		</if> -->
		
		<if test='hndlChgrCd != null and hndlChgrCd != ""'>
			AND A.HNDL_CHGR_CD  =#{hndlChgrCd}
		</if>
		<if test='hndlChgrNm != null and hndlChgrNm != ""'>
			AND A.HNDL_CHGR_NM  =#{hndlChgrNm}
		</if>
		<!-- 진행단계 -->
		<if test='acpHndlStaCd != null and acpHndlStaCd != ""'>
			AND A.ACP_HNDL_STA_CD  =#{acpHndlStaCd}
		</if>
		<!-- 처분청 -->
		<if test='rltnOrgCd != null and rltnOrgCd != ""'>
			AND A.ORG_CD	= #{rltnOrgCd}
		</if>
		<!-- 발신기관 -->
		<if test='dsptchInsttNam != null and dsptchInsttNam != ""'>
			AND A.DSPTCH_INSTT_NAM like '%' || #{dsptchInsttNam} || '%'
		</if>
		<!-- 청구인명 -->
		<if test='reqrNm != null and reqrNm != ""'>
			AND A.REQR_NM LIKE '%' || #{reqrNm} || '%'
		</if>
		<!-- 병행/병합 -->
		<if test='sType != null and sType != ""'>
			AND A.MG_ACP_YR IS NULL
		</if>
        <!-- 완결여부 -->
        <if test='cpltYn != null and cpltYn != ""'>
        	<if test='cpltYn == "1"'>
                AND (B.ENF_DT IS NULL OR A.ACP_HNDL_STA_CD NOT IN ('420') )
            </if>
        	<if test='cpltYn == "2"'>
                AND ((B.ENF_DT IS NOT NULL AND A.ACP_HNDL_STA_CD IN ('420') )
                	OR A.ACP_HNDL_STA_CD IS NULL AND B.ENF_DT IS NOT NULL)
            </if>
        </if>
		<!-- 의결종류 -->
		<if test="vtKndCd != null and vtKndCd != ''">
            AND A.VT_KND_CD = #{vtKndCd}
		</if>
		<if test='viewYn == null or viewYn == ""'>
			<if test='authDvsnCd == "1"'>
				AND A.DPT_CD  = #{sDptCd}
			</if>
			<if test='authDvsnCd == "2"'>
				AND A.HNDL_CHGR_CD  = #{sCnb}
			</if>
		</if>		
		<![CDATA[
		ORDER BY A.FRT_REGI_DH DESC
		) T1
		LEFT OUTER JOIN (SELECT ACP_YR
                               ,ACP_DVSN_CD
                               ,ACP_SRNO
                               ,LINK_URL
                               ,ACP_STEP_CD
                               ,ACP_STEP_NM
                         FROM TBBADFRE101M
                        WHERE STEP_CMPT_YN = 'P'
                           AND NECES_YN ='Y') T2 ON (T2.ACP_YR 		= T1.ACP_YR
                                                    AND T2.ACP_DVSN_CD 	= T1.ACP_DVSN_CD
                                                    AND T2.ACP_SRNO 		= T1.ACP_SRNO)
		WHERE 1=1
		   AND HNDL_CHGR_CD IS NOT NULL
		   AND ACP_HNDL_STA_CD >= 250
		   AND MG_DIV_NM  = '대표'
        ]]>
    </select>
    
    <select id="selectMergeString" parameterType="paramMap" resultType="String">
		/* kr.go.bai.eip.bad.fre.dao.BADFRE211Mapper.selectMergeString */
		SELECT AGGR_CONCAT(ACP_YR || '-' || DECODE(ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || DECODE(ORG_ACP_SRNO, null, ACP_SRNO, ORG_ACP_SRNO), ', ')
  		  FROM TBBADFRE012M 
 		 WHERE MG_ACP_YR = #{mgAcpYr}
   		   AND MG_ACP_DVSN_CD = #{mgAcpDvsnCd}
   		   AND MG_ACP_SRNO = #{mgAcpSrno}
		   AND ROWNUM <![CDATA[<]]> 200
	</select>
	
	<select id="selectPrcCnt" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.bad.fre.dao.BADFRE211Mapper.selectPrcCnt */
		SELECT (SELECT COUNT(ST.ACP_YR)
			      FROM TBBADFRE103M ST
			     WHERE ST.ACP_YR = A.ACP_YR
			       AND ST.ACP_DVSN_CD = A.ACP_DVSN_CD
			       AND ST.ACP_SRNO = A.ACP_SRNO) AS PRC_CNT /* 프로세스 갯수 */
			  ,(SELECT COUNT(ST.ACP_YR)
			      FROM TBBADFRE102M ST
			     WHERE ST.ACP_YR = A.ACP_YR
			       AND ST.ACP_DVSN_CD = A.ACP_DVSN_CD
			       AND ST.ACP_SRNO = A.ACP_SRNO) AS PRC_CNT2  /* 프로세스 갯수 */
         FROM TBBADFRE012M A  
        WHERE A.ACP_YR = #{acpYr}
          AND A.ACP_DVSN_CD = #{acpDvsnCd}
          AND A.ACP_SRNO = #{acpSrno}
	</select>
	
	<select id="selAthReRvwCnt" parameterType="paramMap" resultType="integer">
    /* kr.go.bai.eip.bad.fre.dao.BADFRE211Mapper.selAthReRvwCnt*/
            <![CDATA[
                    SELECT COUNT(*) AS CNT
					  FROM TBBADFRE012M A
					      ,TBDCMACM001M B
					 WHERE A.ATH_RE_RVW_YN = 'Y'
					   AND A.DPT_CD = B.DPT_CD
					   AND A.HNDL_CHGR_CD = B.CNB
					   AND A.HNDL_CHGR_CD = #{cnb}
            ]]>
    </select>
    
    <!-- 심사청구 소송제기 사실 및 결과 조회-->
	<select id="BADFRE211QMainselect2" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.bad.fre.dao.BADFRE211Mapper.BADFRE211QMainselect2 */
		SELECT   ACP_NO
               , ACP_NO_HD
               , WRTANS_SEN_YN
               , ACP_HNDL_STA_CD
               , ACP_DT
               , DSP_OFC_ACP_DT
               , ORG_NM
               , DSP_OFC_UP_INSTT_CD
               , DSP_OFC_UP_INSTT_NAM
               , DSPTCH_INSTT_NAM
               , REQR_NM
               , AGT_NM
               , TIT_NM
               , JDG_REQ_DVSN_CD
               , JDG_REQ_DVSN_NM
               , DPT_CD
               , DPT_NM
               , HNDL_DDLN_DT
               , HNDL_CHGR_NM
               , VT_KND_NM
               , ENF_DT
               , DCS_DT
               , ACP_YR
               , ACP_DVSN_CD
               , ACP_SRNO
               , ORG_ACP_SRNO
               , MG_ACP_YR
               , MG_ACP_DVSN_CD
               , MG_ACP_SRNO
               , MG_DPT_CD
               , MG_DIV_CD
               , ATH_RE_RVW_YN
               , ACP_HNDL_STA_NM
               , MG_DIV_NM
               , (CASE WHEN MG_ACP_YR IS NULL THEN ''
                        WHEN MG_DIV_CD = '10' THEN '병합(' || MG_COUNT || ')'
                        WHEN MG_DIV_CD = '20' THEN '병행(' || MG_COUNT || ')'
                   ELSE '' END) AS MG_COUNT
               , LINK_URL
               , ACP_STEP_CD
               , ACP_STEP_NM
               , ZCD
               , AD
               , DTL_AD
               , SEC_AUD_YN
               , HNDL_DT
               , ORG_DSP_KWA_OPIN_SRCH_DT
               , ORG_DSP_KWA_OPIN_RCPT_DT
               , DOC_ID
               , SOWI_RPRT_KWA
               , SOWI_RPRT_KUK
               , SOWI_RPRT_CHA
               , SOWI_RPRT_CHONG
               , SOWI_RPRT_WON
               , SOWI_APV
               , SBMT_FIX_DT
               , FRE_RPRT_KWA
               , FRE_RPRT_KUK
               , FRE_RPRT_CHA
               , FRE_RPRT_CHONG
               , FRE_RPRT_WON
               , WI_APV
               , SBCN_DY
               , GAKHA_RPRT_KWA
               , GAKHA_RPRT_KUK
               , CNCL_DT
               , GAKHA_DT
               , MG_ACP_HNDL_STA_NM
               , DMS_RSN_NM
               , DMS_RSN_NO
               , ACP_DOC_ID_1
               , ACP_DOC_ID_2
               , HST_NA
               , HST_DE
               , ETC_CMT_YN
               , ROWNUM
               , DOC_TYPE
               , DOC_TYPE2
               , ODOC_NO
               , AMIT_AM
               , FRT_DLY_RSN || CASE WHEN DLY_RSN_CNT > 1 THEN ' 외 ' || TO_CHAR(DLY_RSN_CNT - 1) || '건'
                                ELSE '' END AS  DLY_RSN_TXT
               , SUBSTR(DLY_RSN_ALL, 0, LENGTH(DLY_RSN_ALL)-2) AS DLY_RSN_ALL
               , DLY_RSN_DETAIL
               , TOT_CNT
               , ROWNUM AS NUM
               , DECODE(NVL(LWS_YO,'N'),'Y','유','무') AS LWS_YO
               , FNL_RSLT_TXT
               , LWS_INSTC_STEP_NM
               , LWS_INCDNT_NO_NM
               , LWS_CT_NM
               , LWS_SNTNC_YMD
               , LWS_RSLT_NM
               , LWS_EXEC_STTS_NM
               , LWS_RMK
        FROM (
        <![CDATA[
		SELECT A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || DECODE(A.ORG_ACP_SRNO, null, A.ACP_SRNO, A.ORG_ACP_SRNO) AS ACP_NO /* 분류번호 */
		         , A.ACP_YR || '-' || DECODE(A.ACP_DVSN_CD,'1','심사','2','재심','3','재심판정') || '-' || DECODE(A.ORG_ACP_SRNO, null, A.ACP_SRNO, A.ORG_ACP_SRNO) AS ACP_NO_HD
		         ,decode(A.WRTANS_SEN_YN,'Y','발송','N','미발송') as WRTANS_SEN_YN /* 부본 발송 여부 */    
		         ,A.ACP_HNDL_STA_CD /* 진행단계코드 */
			     ,to_char(to_date(A.ACP_DT), 'YYYY-MM-DD') AS ACP_DT		/* 접수일 */
			     ,to_char(to_date(A.DSP_OFC_ACP_DT), 'YYYY-MM-DD') AS DSP_OFC_ACP_DT		/* 처분청접수일자 */
			     ,A.ORG_NM /* 처분청 */ 
			     ,A.DSP_OFC_UP_INSTT_CD /* 처분청상급기관코드 */
			     ,A.DSP_OFC_UP_INSTT_NAM  /* 처분청상급기관명 */
			     ,A.DSPTCH_INSTT_NAM /* 발신기관명 */
			     ,DECODE(A.AGT_NM, NULL, A.REQR_NM, A.REQR_NM  ) AS REQR_NM/* 청구인명 */
			     ,A.AGT_NM /* 대리인명 */
			     ,A.TIT_NM /* 청구내용 */
			     ,A.JDG_REQ_DVSN_CD /* 심사청구부분코드 */
                 ,(SELECT ST.CD_NM FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = '1000043' AND ST.CD = A.JDG_REQ_DVSN_CD) AS JDG_REQ_DVSN_NM
			     ,A.DPT_CD /* 부서코드 */
			     ,(SELECT ST.DPT_NM FROM TBDCMACM002M ST WHERE ST.DPT_CD = A.DPT_CD) AS DPT_NM /* 처리과 */
			     ,to_char(to_date(A.HNDL_DDLN_DT), 'YYYY-MM-DD') AS HNDL_DDLN_DT /* 처리기한 */
			     ,A.HNDL_CHGR_NM /* 담당자 */
                 ,(SELECT ST.CD_NM FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = '1000045' AND ST.CD = A.VT_KND_CD) AS VT_KND_NM /* 의결종류명 */
			     ,to_char(to_date(A.ENF_DT), 'YYYY-MM-DD') AS ENF_DT /* 시행일 */
			     ,to_char(to_date(A.DCS_DT), 'YYYY-MM-DD') AS DCS_DT /*완결일(위임:결정문 결재완료일,부의:부의일)*/
			     ,A.ACP_YR /* 접수년도 */
			     ,A.ACP_DVSN_CD /* 접수구분코드 */
			     ,A.ACP_SRNO /* 접수일련번호 */
			     ,A.ORG_ACP_SRNO /* 기존접수일련번호 */
			     ,A.MG_ACP_YR /* 병합접수년도 */
			     ,A.MG_ACP_DVSN_CD /* 병합접수구분코드 */
			     ,A.MG_ACP_SRNO /* 병합접수일련번호 */
			     ,A.MG_DPT_CD /* 병합부서코드 */
			     ,A.MG_DIV_CD /* 병합병행구분코드 */
			     ,A.ATH_RE_RVW_YN /* 직권재심의 여부 */
                 ,(SELECT ST.CD_NM FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = '1000807' AND ST.CD = A.ACP_HNDL_STA_CD) AS ACP_HNDL_STA_NM
			     ,CASE WHEN (A.ACP_YR = A.MG_ACP_YR AND A.ACP_DVSN_CD = A.MG_ACP_DVSN_CD AND A.ACP_SRNO = A.MG_ACP_SRNO) THEN '대표'
			             WHEN A.MG_DIV_CD IS NULL AND A.MG_ACP_YR IS NULL THEN '대표'
			             WHEN A.MG_DIV_CD IS NULL THEN '대표'
			             WHEN A.MG_DIV_CD = '10' THEN '병합'
			             WHEN A.MG_DIV_CD = '20' THEN '병행'
			      END AS MG_DIV_NM /* 병합병행구분명 */
			     ,(SELECT COUNT(ST.MG_ACP_YR)
                     FROM TBBADFRE012M ST
                    WHERE ST.MG_ACP_YR = A.MG_ACP_YR
                      AND ST.MG_ACP_DVSN_CD = A.MG_ACP_DVSN_CD
                      AND ST.MG_ACP_SRNO = A.MG_ACP_SRNO) AS MG_COUNT
                 ,DECODE(A.LINK_URL, null, (
                 	SELECT ST1.LINK_URL
                    FROM TBBADFRE101M ST1
                   WHERE ST1.ACP_YR = A.ACP_YR
                      AND ST1.ACP_DVSN_CD = A.ACP_DVSN_CD
                      AND ST1.ACP_SRNO = A.ACP_SRNO
                      AND ST1.NECES_YN ='Y'
                      AND ST1.ACP_STEP_CD = DECODE(A.ACP_DVSN_CD, '1','D1010','E1010')
                 ), A.LINK_URL) AS LINK_URL /* 페이지 URL */
                 ,DECODE(A.ACP_STEP_CD, null, DECODE(A.ACP_DVSN_CD, '1','D1010','E1010'), A.ACP_STEP_CD) AS ACP_STEP_CD /* 프로세스 단계 코드 */
                ,A.ACP_STEP_NM /* 프로세스 단계명 */
				,A.ZCD
				,NVL(A.AGT_AD, A.AD) AS AD
				,NVL(A.AGT_DTL_AD, A.DTL_AD) AS DTL_AD
                , A.SEC_AUD_YN
			    ,CASE WHEN A.ENF_DT IS NULL THEN to_char(TO_DATE(SYSDATE) - TO_DATE(ACP_DT))
			    	  WHEN A.ENF_DT IS NOT NULL THEN to_char(TO_DATE(A.ENF_DT) - TO_DATE(ACP_DT))
			      END AS HNDL_DT /* 경과일 */
				, TO_CHAR(TO_DATE(A.ORG_DSP_KWA_OPIN_SRCH_DT),'YYYY-MM-DD') AS ORG_DSP_KWA_OPIN_SRCH_DT     /*원처분 의견조회일*/
                , TO_CHAR(TO_DATE(A.ORG_DSP_KWA_OPIN_RCPT_DT),'YYYY-MM-DD') AS ORG_DSP_KWA_OPIN_RCPT_DT   /*원처분 의견회신일*/
                , D.DOC_ID
                , D.SOWI_RPRT_KWA   /*소위원회 심의안 결재일*/
                , D.SOWI_RPRT_KUK
                , D.SOWI_RPRT_CHA
                , D.SOWI_RPRT_CHONG
                , D.SOWI_RPRT_WON
                , D.SOWI_APV
                , (SELECT TO_CHAR(TO_DATE(MAX(ST.SBMT_FIX_DT)),'YYYY-MM-DD')
                   FROM TBBADFRE114M ST
                   WHERE ST.ACP_YR = A.ACP_YR
                   AND ST.ACP_DVSN_CD = A.ACP_DVSN_CD
                   AND ST.ACP_SRNO = A.ACP_SRNO) AS SBMT_FIX_DT /*소위원회 확정일*/
                , NVL(D.FRE_RPRT_KWA, to_char(to_date(E.DVCHF_APV_DT), 'YYYY-MM-DD')) AS FRE_RPRT_KWA    /*결정문 결재일*/
                , NVL(D.FRE_RPRT_KUK, to_char(to_date(E.BRUCHF_APV_DT), 'YYYY-MM-DD')) AS FRE_RPRT_KUK
                , D.FRE_RPRT_CHA
                , NVL(D.FRE_RPRT_CHONG, to_char(to_date(E.OW_PSD_APV_DT), 'YYYY-MM-DD')) AS FRE_RPRT_CHONG
                , NVL(D.FRE_RPRT_WON, to_char(to_date(E.LEDG_APV_DT), 'YYYY-MM-DD'))  AS FRE_RPRT_WON
                , NVL(D.WI_APV, to_char(to_date(E.CMTR_APV_DT), 'YYYY-MM-DD')) AS WI_APV
                , NVL((SELECT TO_CHAR(TO_DATE(MAX(ST.SBCN_DY)),'YYYY-MM-DD')
                   FROM TBBADFRE113M ST
                   WHERE ST.ACP_YR = A.ACP_YR
                   AND ST.ACP_DVSN_CD = A.ACP_DVSN_CD
                   AND ST.ACP_SRNO = A.ACP_SRNO), to_char(to_date(E.SBCN_DT), 'YYYY-MM-DD')) AS SBCN_DY /*부의일*/
                , D.GAKHA_RPRT_KWA						/*각하검토보고서 결재일*/
                , D.GAKHA_RPRT_KUK
                , DECODE(A.VT_KND_CD, 7, to_char(to_date(A.ENF_DT), 'YYYY-MM-DD'), NULL) AS CNCL_DT /*취하(시행일)*/ 
                , DECODE(A.VT_KND_CD, 8, to_char(to_date(A.ENF_DT), 'YYYY-MM-DD'), NULL) AS GAKHA_DT /*각하(시행일)*/ 
                , (SELECT ST2.CD_NM
                     FROM TBBADFRE012M ST 
               INNER JOIN TBDCMACM013C ST2 ON (ST2.CMM_CD_DVSN_CD = '1000807' AND ST2.CD = ST.ACP_HNDL_STA_CD)
                    WHERE ST.ACP_YR = A.MG_ACP_YR 
                      AND ST.ACP_DVSN_CD = A.MG_ACP_DVSN_CD 
                      AND ST.ACP_SRNO = A.MG_ACP_SRNO) AS MG_ACP_HNDL_STA_NM
                 , (SELECT ST.CD_NM FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = DECODE(A.ACP_DVSN_CD, '1','1000873','1000874') AND ST.CD = A.DMS_RSN_CD) AS DMS_RSN_NM
                  , (SELECT ST.USR_DFN_TXT_1 FROM TBDCMACM013C ST WHERE ST.CMM_CD_DVSN_CD = DECODE(A.ACP_DVSN_CD, '1','1000873','1000874') AND ST.CD = A.DMS_RSN_CD) AS DMS_RSN_NO
                  , D.ACP_DOC_ID_1
                  , D.ACP_DOC_ID_2
                  , D.HST_NA /* 결재이력-선람전 (국) */
                  , D.HST_DE /* 결재이력-선람전 (과) */
                  , (SELECT CASE WHEN MAX(T2.CMT_DY) IS NOT NULL THEN 'Y' ELSE 'N' END
                       FROM TBBADDED121M T2
                      WHERE T2.REL_AUD_YR = A.ACP_YR AND DECODE(T2.WORK_DVSN_CD, 'D10','1','E10','2','9') = A.ACP_DVSN_CD 
                      AND T2.REL_AUD_NO = TO_CHAR(A.ACP_SRNO)
                    ) AS ETC_CMT_YN
                , F_CODE_NM('1000894', DOC_WRIT_KND_CD) AS DOC_TYPE
                , D.DOC_TYPE AS DOC_TYPE2  /* 편집기 구분  */ 
                , A.ODOC_NO			/*공문서번호*/
                , A.AMIT_AM         /*결정금액*/
                , DECODE(A.INVST_SUIT_YN,'Y',1,0) + DECODE(A.DMND_PRPS_CHNG_YN,'Y',1,0) + DECODE(A.EVI_MTRL_ADD_PRSN_YN,'Y',1,0) + DECODE(A.ETC_DLY_RSN_YN,'Y',1,0) AS DLY_RSN_CNT
                , DECODE(A.INVST_SUIT_YN,'Y','1항',DECODE(A.DMND_PRPS_CHNG_YN,'Y','2항',DECODE(A.EVI_MTRL_ADD_PRSN_YN,'Y','3항', DECODE(A.ETC_DLY_RSN_YN,'Y','4항','')))) AS FRT_DLY_RSN
                , DECODE(A.INVST_SUIT_YN,'Y','1. 수사 및 소송 관련, ','') || DECODE(A.DMND_PRPS_CHNG_YN,'Y','2. 청구 취지 변경, ','') || DECODE(A.EVI_MTRL_ADD_PRSN_YN,'Y','3. 증거자료 추가제출, ','') || DECODE(A.ETC_DLY_RSN_YN,'Y','4. 기타 지연사유, ','') AS DLY_RSN_ALL
                , A.DLY_RSN_DETAIL
                , A.TOT_CNT AS TOT_CNT
                , A.LWS_YO
                , A.FNL_RSLT_TXT
                , A.LWS_INSTC_STEP_NM
                , A.LWS_INCDNT_NO_NM
                , A.LWS_CT_NM
                , A.LWS_SNTNC_YMD
                , A.LWS_RSLT_NM
                , A.LWS_EXEC_STTS_NM
                , A.LWS_RMK
          FROM (
         ]]>
         <include refid="include.pageSelct" />
         <![CDATA[
         	SELECT A.*
         	      ,B.ENF_DT
                  ,B.DMS_RSN_CD
                  ,B.ODOC_NO
                  ,B.LWS_YO
                  ,B.FNL_RSLT_TXT
                  ,C.LINK_URL
                  ,C.ACP_STEP_CD
                  ,C.ACP_STEP_NM
                  ,D.LWS_INSTC_STEP_NM
                  ,D.LWS_INCDNT_NO_NM
                  ,D.LWS_CT_NM
                  ,TO_CHAR(TO_DATE(D.LWS_SNTNC_YMD), 'YYYY-MM-DD') AS LWS_SNTNC_YMD
                  ,D.LWS_RSLT_NM
                  ,D.LWS_EXEC_STTS_NM
                  ,D.RMK AS LWS_RMK
              FROM TBBADFRE012M A
              LEFT OUTER JOIN (SELECT ST.ACP_YR
                                     ,ST.ACP_DVSN_CD
                                     ,ST.ACP_SRNO
                                     ,ST.LINK_URL
                                     ,ST.ACP_STEP_CD
                                     ,ST.ACP_STEP_NM
                               FROM TBBADFRE101M ST
                              WHERE ST.STEP_CMPT_YN = 'P'
                                 AND ST.NECES_YN ='Y') C ON C.ACP_YR = A.ACP_YR AND C.ACP_DVSN_CD = A.ACP_DVSN_CD AND C.ACP_SRNO = A.ACP_SRNO
                  ,TBBADFRE013D B
                  ,TBBADFRE015M D
             WHERE A.ACP_DVSN_CD = #{acpDvsnCd}
               AND B.ACP_YR = A.ACP_YR
               AND B.ACP_DVSN_CD = A.ACP_DVSN_CD
               AND B.ACP_SRNO = A.ACP_SRNO
               AND A.ACP_YR = D.ACP_YR
               AND A.ACP_DVSN_CD = D.ACP_DVSN_CD
               AND A.ACP_SRNO = D.ACP_SRNO
         ]]>	  
         <!-- 접수년도 -->
		<if test='dptCd != null and dptCd != ""'>
			AND A.DPT_CD  = #{dptCd}
		</if>
		<if test='acpYr != null and acpYr != ""'>
			AND A.ACP_YR = #{acpYr}
		</if>
		<!-- 구분코드 -->
		<if test='acpDvsnCd != null and acpDvsnCd != ""'>
			AND A.ACP_DVSN_CD = #{acpDvsnCd}
		</if>
		<!-- 접수번호 -->
		<if test='acpSrno != null and acpSrno != ""'>
			AND (NVL(A.ORG_ACP_SRNO,A.ACP_SRNO) = #{acpSrno})
		</if>
		<!-- 접수일자 -->
		<if test='acpDhs != null and acpDhs != ""'>
			AND TO_CHAR(TO_DATE(A.ACP_DT),'YYYYMMDD') &gt;= #{acpDhs}
		</if>
		<if test='acpDhe != null and acpDhe != ""'>
			AND TO_CHAR(TO_DATE(A.ACP_DT),'YYYYMMDD') &lt;= #{acpDhe}
		</if>
		<if test='dcsDts != null and dcsDts != ""'>
			AND TO_CHAR(TO_DATE(A.DCS_DT),'YYYYMMDD') &gt;= #{dcsDts}
		</if>
		<if test='dcsDte != null and dcsDte != ""'>
			AND TO_CHAR(TO_DATE(A.DCS_DT),'YYYYMMDD') &lt;= #{dcsDte}
		</if>
		<if test='enfDts != null and enfDts != ""'>
			AND TO_CHAR(TO_DATE(B.ENF_DT),'YYYYMMDD') &gt;= #{enfDts}
		</if>
		<if test='enfDte != null and enfDte != ""'>
			AND TO_CHAR(TO_DATE(B.ENF_DT),'YYYYMMDD') &lt;= #{enfDte}
		</if>
		<!-- 처리기한 -->
		<if test='hndlDdlnDts != null and hndlDdlnDts != ""'>
			AND TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYYMMDD') &gt;= #{hndlDdlnDts}
		</if>
		<if test='hndlDdlnDte != null and hndlDdlnDte != ""'>
			AND TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYYMMDD') &lt;= #{hndlDdlnDte}
		</if>
		<!-- <if test='enfYn == "Y"'>
			처리과
			<if test='dptCd != null and dptCd != ""'>
				AND A.DPT_CD =#{dptCd}
			</if>
			담당자
			<if test='hndlChgrCd != null and hndlChgrCd != ""'>
				AND A.HNDL_CHGR_CD  =#{hndlChgrCd}
			</if>
		</if> -->
		
		<if test='hndlChgrCd != null and hndlChgrCd != ""'>
			AND A.HNDL_CHGR_CD  =#{hndlChgrCd}
		</if>
		<if test='hndlChgrNm != null and hndlChgrNm != ""'>
			AND A.HNDL_CHGR_NM  =#{hndlChgrNm}
		</if>
		<!-- 진행단계 -->
		<if test='acpHndlStaCd != null and acpHndlStaCd != ""'>
			AND A.ACP_HNDL_STA_CD  =#{acpHndlStaCd}
		</if>
		<if test='titNm != null and titNm != ""'>
			AND A.TIT_NM  LIKE '%' || #{titNm} || '%'
		</if>
		<!-- 처분청 -->
		<if test='rltnOrgCd != null and rltnOrgCd != ""'>
			AND A.ORG_CD	= #{rltnOrgCd}
		</if>
		<!-- 발신기관 -->
		<if test='dsptchInsttNam != null and dsptchInsttNam != ""'>
			AND A.DSPTCH_INSTT_NAM like '%' || #{dsptchInsttNam} || '%'
		</if>
		<!-- 청구인명 -->
		<if test='reqrNm != null and reqrNm != ""'>
			AND A.REQR_NM LIKE '%' || #{reqrNm} || '%'
		</if>
		<!-- 병행/병합 -->
		<if test='sType != null and sType != ""'>
			AND A.MG_ACP_YR IS NULL
		</if>
        <!-- 완결여부 -->
        <if test='cpltYn != null and cpltYn != ""'>
        	<if test='cpltYn == "1"'>
                AND (B.ENF_DT IS NULL OR A.ACP_HNDL_STA_CD NOT IN ('420') )
            </if>
        	<if test='cpltYn == "2"'>
                AND ((B.ENF_DT IS NOT NULL AND A.ACP_HNDL_STA_CD IN ('420') )
                	OR A.ACP_HNDL_STA_CD IS NULL AND B.ENF_DT IS NOT NULL)
            </if>
        </if>
		<!-- 의결종류 -->
		<if test="vtKndCd != null and vtKndCd != ''">
            AND A.VT_KND_CD = #{vtKndCd}
		</if>
		<if test='viewYn == null or viewYn == ""'>
			<if test='authDvsnCd == "1"'>
				AND A.DPT_CD  = #{sDptCd}
			</if>
			<if test='authDvsnCd == "2"'>
				AND A.HNDL_CHGR_CD  = #{sCnb}
			</if>
		</if>	
		<if test='invstSuitYn != null and invstSuitYn != "" and invstSuitYn eq "Y".toString()'>
			AND A.INVST_SUIT_YN = 'Y'
		</if>
		<if test='dmndPrpsChngYn != null and dmndPrpsChngYn != "" and dmndPrpsChngYn eq "Y".toString()'>
			AND A.DMND_PRPS_CHNG_YN = 'Y'
		</if>
		<if test='eviMtrlAddPrsnYn != null and eviMtrlAddPrsnYn != "" and eviMtrlAddPrsnYn eq "Y".toString()'>
			AND A.EVI_MTRL_ADD_PRSN_YN = 'Y'
		</if>
		<if test='etcDlyRsnYn != null and etcDlyRsnYn != "" and etcDlyRsnYn eq "Y".toString()'>
			AND A.ETC_DLY_RSN_YN = 'Y'
		</if>
		GROUP BY B.ENF_DT,B.DMS_RSN_CD,B.ODOC_NO,B.LWS_YO,B.FNL_RSLT_TXT,A.ACP_YR,A.ACP_DVSN_CD,A.ACP_SRNO,A.ORG_ACP_SRNO,A.DPT_CD,A.JDG_REQ_DVSN_SRNO
		        ,A.JDG_REQ_DVSN_CD,A.ACP_DT,D.LWS_INSTC_STEP_NM,D.LWS_INCDNT_NO_NM,D.LWS_CT_NM,D.LWS_SNTNC_YMD,D.LWS_RSLT_NM,D.LWS_EXEC_STTS_NM,D.RMK
                ,A.REQ_DT,A.TIT_NM,A.RPT_DT,A.HNDL_DDLN_DT,A.REL_AM,A.DFNT_CNT,A.ORG_CD,A.ORG_NM,A.REQR_NM,A.AGT_NM,A.PSN_CRP_DVSN_CD,A.EIN,A.BZN,A.ISU_TXT
                ,A.HNDL_CHGR_NM,A.AUD_YR,A.AUD_NO,A.DSP_RQ_SNO,A.HNDL_STT_TXT,A.OW_HNDL_RMK,A.EXTN_RSN,A.ZCD,A.AD,A.DTL_AD,A.TNB_1,A.TNB_2,A.TNB_3
                ,A.HP_TNB_1,A.HP_TNB_2,A.HP_TNB_3,A.HNDL_CHGR_TNB_1,A.HNDL_CHGR_TNB_2,A.HNDL_CHGR_TNB_3,A.BAI_DSP_DIV_CD,A.BAI_DSP_YN,A.CVPT_SEN_ACP_NO
                ,A.ACP_NO_SMS_SEN_YN,A.ACP_NO_SMS_SEN_DH,A.WRTANS_SEN_YN,A.STTC_CNT,A.MG_ACP_YR,A.MG_ACP_DVSN_CD,A.MG_ACP_SRNO,A.MG_DPT_CD
                ,A.DSP_OFC_ACP_DT,A.DSP_OFC_UP_INSTT_CD,A.DSP_OFC_UP_INSTT_NAM,A.DSP_OFC_UP_INSTT_ACP_DT,A.CNTR_ADMNSTMACH_CD,A.CNTR_ADMNSTMACH_NAM
                ,A.CNTR_ADMNSTMACH_ACP_DT,A.DSPTCH_INSTT_NAM,A.RMK,A.ORG_DSP_KWA_NAM,A.WRTANS_SEN_DT,A.MG_DIV_CD,A.ACP_HNDL_STA_CD,A.VT_KND_CD
                ,A.REFER_ENT,A.ORG_DSP_KWA_OPIN_SRCH_STEP_CD,A.ORG_DSP_KWA_OPIN_SRCH_DT,A.ORG_DSP_KWA_OPIN_RCPT_DT,A.REQR_OPM_SEN_DT,A.DEL_YN
                ,A.DCS_DT,A.DCS_SBJ,A.AMIT_AM,A.ATH_RE_RVW_YN,A.HNDL_CHGR_CD,A.INSTT_OPM_SEN_DT,A.DCS_DVSN_CD,A.DCS_YR,A.DCS_NO,A.DCS_DOC_NOC
                ,A.FRT_USR_ID,A.FNL_USR_ID,A.FNL_DEAL_DPT_CD,A.FNL_MNU_ID,A.FRT_REGI_DH,A.FNL_MDF_DH,A.AGT_ZCD,A.AGT_AD,A.AGT_DTL_AD,A.AGT_TNB_1,A.AGT_TNB_2
                ,A.AGT_TNB_3,A.AGT_HP_TNB_1,A.AGT_HP_TNB_2,A.AGT_HP_TNB_3,A.HNDL_OPNN_CD,A.SEC_AUD_YN,A.DOC_WRIT_KND_CD,A.INVST_SUIT_YN,A.DMND_PRPS_CHNG_YN
                ,A.EVI_MTRL_ADD_PRSN_YN,A.ETC_DLY_RSN_YN,A.DLY_RSN_DETAIL,A.ORG_DSP_KWA_OPIN_DDLN_DT,A.ORG_DSP_KWA_OPIN_PRSS_DT,A.REFER_ENT_RSN,A.PRE_REFER_ENT
                ,A.EX_YN,A.EX_RSN_TXT,C.LINK_URL,C.ACP_STEP_CD,C.ACP_STEP_NM
		ORDER BY A.FRT_REGI_DH DESC
		
         <include refid="include.pageOrder" />
         <![CDATA[
         ) A 
		  LEFT OUTER JOIN (SELECT A.ACP_YR
	                    , A.ACP_DVSN_CD
	                    , A.ACP_SRNO
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'30',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_KWA  /* 과장 결재일 */
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'20',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'25',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_KUK  /* 국장 결재일 */
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'14',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_CHA                   /* 차장 결재일 */
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'13',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_CHONG  /* 총장 결재일 */
	                    , MIN(DECODE(A.RPRT_CD,'E10200200',DECODE(C.USR_DFN_TXT_5,'11',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),''),'')) AS SOWI_RPRT_WON  /* 원장 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'30',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_KWA  /* 과장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'20',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'25',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_KUK  /* 국장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'14',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_CHA                   /* 차장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'13',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_CHONG  /* 총장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10200200', 'E10400200') THEN DECODE(C.USR_DFN_TXT_5,'11',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS FRE_RPRT_WON  /* 원장 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100200', 'E10100200') THEN DECODE(C.USR_DFN_TXT_5,'30',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS GAKHA_RPRT_KWA  /* 과장 결재일 */
	                    , MIN(CASE WHEN A.RPRT_CD IN ('D10100200', 'E10100200') THEN DECODE(C.USR_DFN_TXT_5,'20',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'25',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS GAKHA_RPRT_KUK  /* 국장 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100001', 'E10100001') THEN A.APV_RQS_ID ELSE '' END) AS HST_NA
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100002', 'E10100002') THEN A.APV_RQS_ID ELSE '' END) AS HST_DE
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100001', 'E10100001') THEN A.DOC_ID ELSE '' END) AS ACP_DOC_ID_1
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10100002', 'E10100002') THEN A.DOC_ID ELSE '' END) AS ACP_DOC_ID_2
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10300200', 'E10500200') THEN DECODE(C.USR_DFN_TXT_5,'12',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS WI_APV  /* 주심위원 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('E10300150') THEN DECODE(C.USR_DFN_TXT_5,'12',TO_CHAR(B.APV_DH, 'YYYY-MM-DD'),'')ELSE '' END) AS SOWI_APV  /* 주심위원 결재일 */
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10400600','E10600300') THEN A.DOC_ID ELSE '' END) AS DOC_ID
                        , MIN(CASE WHEN A.RPRT_CD IN ('D10400600','E10600300') THEN F_OPEN_EDIT(A.LINK_URL) ELSE '' END) AS DOC_TYPE
	             FROM TBBADFRE103M A
	             LEFT OUTER JOIN TBDCMACM023l B ON (A.APV_RQS_ID = B.APV_DOC_NO)
	             LEFT OUTER JOIN TBDCMACM013C C ON (C.USR_DFN_TXT_1 = B.APVR_PST_CD AND C.CMM_CD_DVSN_CD = '1000659' AND C.CD <> '24') 
	             WHERE A.RPRT_CD IN ('E10200200','D10200200', 'E10400200','D10100200', 'E10100200','D10100001', 'E10100001','D10100002', 'E10100002','D10300200', 'E10500200', 'E10300150', 'D10400600','E10600300')    /*소위원회 심의안, 결정문, 각하검토보고서*/
	             GROUP BY A.ACP_YR, A.ACP_DVSN_CD, A.ACP_SRNO) D ON D.ACP_YR = A.ACP_YR AND D.ACP_DVSN_CD = A.ACP_DVSN_CD AND D.ACP_SRNO = A.ACP_SRNO
	        LEFT OUTER JOIN TBBADFRE012D E ON (E.ACP_YR = A.ACP_YR AND E.ACP_DVSN_CD = A.ACP_DVSN_CD AND E.ACP_SRNO = A.ACP_SRNO)
                 WHERE A.DEL_YN IS NULL
		]]>
		
		ORDER BY A.FRT_REGI_DH DESC, A.ACP_YR DESC, A.ACP_SRNO DESC
		) T1
		WHERE 1=1
		<if test='popupCd != null and popupCd != ""'>
		   AND HNDL_CHGR_NM IS NOT NULL
		   AND ACP_HNDL_STA_CD >= 250
		</if>
		<if test='mgDivNm != null and mgDivNm != ""'>
		   AND MG_DIV_NM  = #{mgDivNm}
		</if>
		<if test='acpNo != null and acpNo != ""'>
		     AND ACP_NO NOT IN
			 <foreach item="item" index="index" collection="acpNo" open="(" close=")" separator=",">
		            #{item}
		    </foreach>
		</if>
		
	</select>
	
</mapper>
