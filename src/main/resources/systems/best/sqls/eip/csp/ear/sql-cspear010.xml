<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.csp.ear.dao.CSPEAR010Mapper">
	<select id="CSPEAR010ECmtSelect" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR010ECmtSelect */
		<![CDATA[
			SELECT  
                A.CMT_OEN_YE||'-'||DECODE(A.CMT_DVSN_CD, 1, '심사', 2, '자문')||'-'||A.CMT_DGE AS CMT_NO
                , A.CMT_DVSN_CD
                , A.CMT_OEN_YE
                , A.CMT_DGE
                , A.REQ_DVSN_CD
                , DECODE(A.CMT_DVSN_CD, 1, '심사위원회', 2, '자문위원회') AS CMT_DVSN_NM
                , A.ACP_YR
                , A.CVPT_ACP_NO
                , A.CMT_RSLT_CD
                , F_CODE_NM('1000380',A.CMT_RSLT_CD) AS CMT_RSLT_NM
                , TO_CHAR(TO_DATE(B.CMT_OEN_DT),'YYYY-MM-DD') AS CMT_OEN_DT
                , B.WT_VT_YN
                , B.DOC_ID
            FROM TBCSPEAR011M A
            INNER JOIN TBCSPEAR010M B ON (  A.CMT_DVSN_CD = B.CMT_DVSN_CD 
                                            AND A.CMT_OEN_YE = B.CMT_OEN_YE 
                                            AND A.CMT_DGE = B.CMT_DGE   )
   			WHERE	1=1
			AND	A.REQ_DVSN_CD = #{reqDvsnCd}
			AND A.ACP_YR = #{acpYr}
			AND A.CVPT_ACP_NO = #{cvptAcpNo}
			ORDER BY CMT_OEN_YE, CMT_DGE DESC
		]]>
	</select>
	
	
	<select id="CSPEAR010ECmtrSelect" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR010ECmtrSelect */
		<![CDATA[
			SELECT A.CMT_DVSN_CD
			    , A.CMT_OEN_YE
			    , A.CMT_DGE
			    , A.CMTR_CD
			    , B.INN_STF_DVSN_CD
			    , DECODE(B.INN_STF_DVSN_CD, '1', '내부직원', '외부직원') AS INN_STF_DVSN_NM 
			    , B.CNB
			    , B.CMTR_NM
			    , B.CMTR_PST_CD
			    , DECODE(B.CMTR_PST_CD, '1', '위원장', '위원') AS CMTR_PST_NM 
			    , TO_CHAR(TO_DATE(B.TERM_BGNDE), 'YYYY-MM-DD') AS TERM_BGNDE 
			    , TO_CHAR(TO_DATE(B.TERM_ENDDE), 'YYYY-MM-DD') AS TERM_ENDDE 
			    , B.PFL_DOC_ID    
			FROM TBCSPEAR013L A 
			INNER JOIN TBCSPEAR012M B ON (A.CMTR_CD = B.CMTR_CD)
			WHERE 1=1
			AND A.CMT_DVSN_CD = #{cmtDvsnCd}
			AND A.CMT_OEN_YE = #{cmtOenYe}
			AND	A.CMT_DGE = #{cmtDge}
		]]>
			<if test='useYn != null and useYn != ""'>
			AND	B.USE_YN = #{useYn}
			</if>
		<![CDATA[
			ORDER BY B.CMTR_PST_CD ASC
		]]>
	</select>
	
	<select id="CSPEAR010ESelectUpdateDt" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR010ESelectUpdateDt */
		<![CDATA[
			SELECT C.REQ_DVSN_CD, C.ACP_YR, C.CVPT_ACP_NO
                    , (CASE WHEN SUM(DECODE(C.CMT_RSLT_CD, '09','0','1')) > 0 THEN B.CMT_OEN_DT ELSE '' END) AS UPDATE_DT
            FROM tbcspdcp603m A
            INNER JOIN TBCSPEAR010M B ON (TO_NUMBER(A.REQ_DVSN_CD)-6 = B.CMT_DVSN_CD
                                            AND A.ACP_YR = B.CMT_OEN_YE
                                            AND A.CVPT_ACP_NO = B.CMT_DGE )
            INNER JOIN TBCSPEAR011M C ON (B.CMT_DVSN_CD = C.CMT_DVSN_CD
                                            AND B.CMT_OEN_YE = C.CMT_OEN_YE
                                            AND B.CMT_DGE = C.CMT_DGE )
            WHERE A.ACP_YR = #{acpYr}
			AND	A.CVPT_ACP_NO = #{cvptAcpNo}
			AND	A.REQ_DVSN_CD = #{reqDvsnCd}
            AND A.APV_RQS_ID = #{apvRqsId}
            GROUP BY C.REQ_DVSN_CD, C.ACP_YR, C.CVPT_ACP_NO
            , B.CMT_OEN_DT
		]]>
	</select>
	
	
	<select id="selectStaCd" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR010ESelectUpdateDt */
		<![CDATA[
			SELECT APV_STA_CD
			  FROM TBCSPDCP603M
			 WHERE ACP_YR = #{acpYr}
				AND	CVPT_ACP_NO = #{cvptAcpNo}
				AND  REQ_DVSN_CD = #{reqDvsnCd}
				AND  RPRT_NM = #{rprtNm} 
		]]>
	</select>
</mapper>