<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper">
 	<insert id="CSPEAR018EMainInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper."CSPEAR018EMainInsert" */
        <![CDATA[
        	INSERT INTO	TBCSPEAR010M
        				(	CMT_DVSN_CD
        					, CMT_OEN_YE
        					, CMT_DGE
        					, CMT_OEN_DT
        					, WT_VT_YN
        					, DOC_ID
        					, DOC_TYP_CD
        					, FRT_USR_ID
        					, FNL_USR_ID
        					, FNL_DEAL_DPT_CD
        					, FNL_MNU_ID
        					, FRT_REGI_DH
        					, FNL_MDF_DH
        				)
        		VALUES	(	#{cmtDvsnCd}
        					, #{cmtOenYe}
        					, #{cmtDge}
        					, #{cmtOenDt}
        					, #{wtVtYn}
        					, #{docId}
        					, #{docTypCd}
        					, F_USR_INFO(#{sCnb}, '1')
        					, #{fnlUsrId}
        					, #{fnlDealDptCd}
        					, #{fnlMnuId}
        					, SYSDATE
        					, SYSDATE
        				)
       	]]>
	</insert>
	
	<update id="CSPEAR018EMainUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR018EMainUpdate */
		<![CDATA[
			UPDATE	TBCSPEAR010M
			SET		CMT_OEN_DT = #{cmtOenDt}
					,WT_VT_YN = #{wtVtYn}
					,DOC_ID = #{docId}
					,DOC_TYP_CD = #{docTypCd}
					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
			WHERE	CMT_DVSN_CD = #{cmtDvsnCd}
			AND		CMT_OEN_YE = #{cmtOenYe}
			AND		CMT_DGE = #{cmtDge}
		]]>
	</update>
	
	<select id="CSPEAR018ESelectMaxCmtDge" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR018ESelectMaxCmtDge */
		<![CDATA[
			SELECT NVL(MAX(TO_NUMBER(CMT_DGE)),0)+1 AS CMT_DGE
			FROM TBCSPEAR010M
			WHERE	CMT_DVSN_CD = #{cmtDvsnCd}
			AND		CMT_OEN_YE = #{cmtOenYe}
		]]>
	</select>
	
	
	<select id="CSPEAR018ESelectDate" resultType="egovMap">
	/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR018ESelectDate */
		<![CDATA[
			SELECT 	YYYY AS CD, 
					YYYY AS CD_NM 
			FROM	(
				SELECT TO_CHAR(SYSDATE,'YYYY') - LEVEL + 1 YYYY 
				FROM DUAL 
				CONNECT BY TO_CHAR(SYSDATE,'YYYY') - LEVEL + 1 >= 1980
			)
		]]>
	</select>
	
	<select id="selectMainList" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.selectMainList */
		<![CDATA[
			SELECT A.CMT_OEN_YE||'-'||DECODE(A.CMT_DVSN_CD, 1, '심사', 2, '자문')||'-'||A.CMT_DGE AS CMT_NO
			        ,A.CMT_OEN_YE
			        ,A.CMT_DVSN_CD
			        ,A.CMT_DGE
   					,DECODE(A.CMT_DVSN_CD, 1, '심사위원회', 2, '자문위원회') AS CMT_DVSN_NM
   					,TO_CHAR(TO_DATE(A.CMT_OEN_DT),'YYYY-MM-DD') AS CMT_OEN_DT
   					,A.WT_VT_YN
   					,A.DOC_ID
   					,A.DOC_TYP_CD
   			FROM	TBCSPEAR010M A
   			WHERE	1=1
		]]>
		<if test='cmtDvsnCd != null and cmtDvsnCd != ""'>
			AND	A.CMT_DVSN_CD = #{cmtDvsnCd}
		</if>
		<if test='cmtOenYe != null and cmtOenYe != ""'>
			AND	A.CMT_OEN_YE = #{cmtOenYe}
		</if>
		<if test='cmtDge != null and cmtDge != ""'>
			AND	A.CMT_DGE = #{cmtDge}
		</if>
		<![CDATA[
			ORDER BY A.CMT_OEN_DT DESC
		]]>
	</select>
	
	<insert id="CSPEAR018ERltnEarInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR018ERltnEarInsert */
		<![CDATA[
		INSERT INTO	TBCSPEAR011M
   				(	CMT_DVSN_CD
   					, CMT_OEN_YE
   					, CMT_DGE
   					, REQ_DVSN_CD
   					, ACP_YR
   					, CVPT_ACP_NO
   					, CMT_RSLT_CD
   					, FRT_USR_ID
   					, FNL_USR_ID
   					, FNL_DEAL_DPT_CD
   					, FNL_MNU_ID
   					, FRT_REGI_DH
   					, FNL_MDF_DH
   				)
   		VALUES	(	#{cmtDvsnCd}
   					, #{cmtOenYe}
   					, #{cmtDge}
   					, #{reqDvsnCd}
   					, #{acpYr}
   					, #{cvptAcpNo}
   					, #{cmtRsltCd}
   					, F_USR_INFO(#{sCnb}, '1')
   					, #{fnlUsrId}
   					, #{fnlDealDptCd}
   					, #{fnlMnuId}
   					, SYSDATE
   					, SYSDATE
   				)
		]]>
	</insert>
	
	<update id="CSPEAR018ERltnEarUpdate" parameterType="paramMap">
	/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR018ERltnEarUpdate */
		<![CDATA[
		UPDATE	TBCSPEAR011M
		SET		CMT_RSLT_CD = #{cmtRsltCd}
				,FNL_USR_ID = #{fnlUsrId}
				,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
				,FNL_MNU_ID = #{fnlMnuId}
				,FNL_MDF_DH = SYSDATE
		WHERE	CMT_DVSN_CD = #{cmtDvsnCd}
		AND		CMT_OEN_YE = #{cmtOenYe}
		AND		CMT_DGE = #{cmtDge}
		AND		REQ_DVSN_CD = #{reqDvsnCd}
		AND 	ACP_YR = #{acpYr}
		AND 	CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>
	
	<delete id="CSPEAR018ERltnEarDelete" parameterType="paramMap">
	/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR018ERltnEarDelete */
		<![CDATA[
		DELETE	
   		FROM	TBCSPEAR011M
   		WHERE	CMT_DVSN_CD = #{cmtDvsnCd}
		AND		CMT_OEN_YE = #{cmtOenYe}
		AND		CMT_DGE = #{cmtDge}
		AND		REQ_DVSN_CD = #{reqDvsnCd}
		AND 	ACP_YR = #{acpYr}
		AND 	CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</delete>
	
	<insert id="CSPEAR018ECmtrInsert" parameterType="paramMap">
	/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR018ECmtrInsert */
		<![CDATA[
		INSERT INTO	TBCSPEAR013L
   				(	CMT_DVSN_CD
   					, CMT_OEN_YE
   					, CMT_DGE
   					, CMTR_CD
   					, FRT_USR_ID
   					, FNL_USR_ID
   					, FNL_DEAL_DPT_CD
   					, FNL_MNU_ID
   					, FRT_REGI_DH
   					, FNL_MDF_DH
   				)
   		VALUES	(	#{cmtDvsnCd}
   					, #{cmtOenYe}
   					, #{cmtDge}
   					, #{cmtrCd}
   					, F_USR_INFO(#{sCnb}, '1')
   					, #{fnlUsrId}
   					, #{fnlDealDptCd}
   					, #{fnlMnuId}
   					, SYSDATE
   					, SYSDATE
   				)
		]]>
	</insert>
	
	<delete id="CSPEAR018ECmtrDelete" parameterType="paramMap">
	/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR018ECmtrDelete */
		<![CDATA[
		DELETE	
   		FROM	TBCSPEAR013L
   		WHERE	CMT_DVSN_CD = #{cmtDvsnCd}
		AND		CMT_OEN_YE = #{cmtOenYe}
		AND		CMT_DGE = #{cmtDge}
		AND		CMTR_CD = #{cmtrCd}
		]]>
	</delete>
	
	<select id="CSPEAR018ECmtrSelect" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR018Mapper.CSPEAR018ECmtrSelect */
		<![CDATA[
			SELECT A.CMT_DVSN_CD
			    , A.CMT_OEN_YE
			    , A.CMT_DGE
			    , A.CMTR_CD
			    , B.INN_STF_DVSN_CD
			    , DECODE(B.INN_STF_DVSN_CD, '1', '내부직원', '외부직원') AS INN_STF_DVSN_NM 
			    , B.CNB
			    , B.CMTR_NM
			    , B.CMTR_PST_CD
			    , DECODE(B.CMTR_PST_CD, '1', '위원장', '위원') AS CMTR_PST_NM 
			    , TO_CHAR(TO_DATE(B.TERM_BGNDE), 'YYYY-MM-DD') AS TERM_BGNDE 
			    , TO_CHAR(TO_DATE(B.TERM_ENDDE), 'YYYY-MM-DD') AS TERM_ENDDE 
			    , B.PFL_DOC_ID    
			FROM TBCSPEAR013L A 
			INNER JOIN TBCSPEAR012M B ON (A.CMTR_CD = B.CMTR_CD)
			WHERE 1=1
			AND A.CMT_DVSN_CD = #{cmtDvsnCd}
			AND A.CMT_OEN_YE = #{cmtOenYe}
			AND	A.CMT_DGE = #{cmtDge}
		]]>
			<if test='useYn != null and useYn != ""'>
			AND	B.USE_YN = #{useYn}
			</if>
		<![CDATA[
			ORDER BY B.CMTR_PST_CD ASC
		]]>
	</select>
	
</mapper>