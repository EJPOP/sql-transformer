<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.csp.dcp.dao.CSPDCP417Mapper">
 	
 	<resultMap type="java.util.HashMap" id="cspdcp417Map">
 		<result property="ansDvsnCd" column="ANS_DVSN_CD"                   jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result property="srno" column="SRNO"                   jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result property="titNm" column="TIT_NM"                   jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result property="ansTxt" column="ANS_TXT"                   jdbcType="CLOB" javaType="java.lang.String" />
 		<result property="usrNam" column="USR_NAM"                   jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result property="usrId" column="USR_ID"                   jdbcType="VARCHAR" javaType="java.lang.String" />
 	</resultMap>
 	
 	<select id="CSPDCP417QMainSelect" parameterType="paramMap"
		resultMap="cspdcp417Map">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP417Mapper.CSPDCP417QMainSelect */
		<![CDATA[
		   SELECT D1.ANS_DVSN_CD
		         ,D1.SRNO
		         ,D1.TIT_NM
		         ,D1.ANS_TXT
		         ,D2.USR_NAM
		         ,D2.USR_ID
		     FROM TBCSPDCP001M D1
		         ,TBDCMACM001M D2
		    WHERE 1=1
		      AND D1.FRT_USR_ID = D2.USR_ID(+)
		      AND D1.ANS_DVSN_CD = #{ansDvsnCd}
		]]>		
		<if test='sTitNm != null and sTitNm != ""'>
		      AND D1.TIT_NM LIKE '%'||#{sTitNm}||'%'
		      </if>
		      ORDER BY D1.SRNO
		
		
	</select>
	
	<select id="CSPDCP417QMaxSrno" parameterType="paramMap"
		resultType="java.lang.String"> 
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP417Mapper.CSPDCP417QMaxSrno */
		
		SELECT NVL(MAX(SRNO), 0)+1  AS MAX_SRNO
          FROM TBCSPDCP001M
         WHERE 1=1
           AND ANS_DVSN_CD = #{ansDvsnCd}
		
	</select>
	
	<insert id="CSPDCP417QInsert" parameterType="paramMap">
	/* kr.go.bai.eip.csp.dcp.dao.CSPDCP417Mapper.CSPDCP417QInsert */
	<![CDATA[
	INSERT INTO TBCSPDCP001M(
                  ANS_DVSN_CD
                 ,SRNO
                 ,TIT_NM
                 ,ANS_TXT
                 ,FRT_USR_ID
                 ,FNL_USR_ID
                 ,FNL_DEAL_DPT_CD
                 ,FNL_MNU_ID
                 ,FRT_REGI_DH
                 ,FNL_MDF_DH
                 )
             VALUES(
                  #{ansDvsnCd}
                 ,#{srno}
                 ,#{titNm}
                 ,#{ansTxt}
                 ,#{frtUsrId}
                 ,#{fnlUsrId}
                 ,#{fnlDealDptCd}
                 ,#{fnlMnuId}
                 ,SYSDATE
                 ,SYSDATE
                 )
	]]>
	</insert>
	
	<update id="CSPDCP417QUpdate" parameterType="paramMap">
	/* kr.go.bai.eip.csp.dcp.dao.CSPDCP417Mapper.CSPDCP417QUpdate */
	<![CDATA[
	UPDATE TBCSPDCP001M
       SET FNL_USR_ID         = #{fnlUsrId}
    	  ,FNL_DEAL_DPT_CD    = #{fnlDealDptCd}
    	  ,FNL_MNU_ID         = #{fnlMnuId}
          ,FNL_MDF_DH         = SYSDATE
          ,TIT_NM = #{titNm}
          ,ANS_TXT= #{ansTxt}
     WHERE ANS_DVSN_CD = #{ansDvsnCd}
       AND SRNO        = #{srno}
	]]>
	</update>
	
	<delete id="CSPDCP417QDelete" parameterType="paramMap">
	/* kr.go.bai.eip.csp.dcp.dao.CSPDCP417Mapper.CSPDCP417QDelete */
	<![CDATA[
	
		      DELETE 
                FROM TBCSPDCP001M
               WHERE 1=1
                 AND ANS_DVSN_CD = #{ansDvsnCd}
                 AND SRNO        = #{srno}
	
	]]>
	</delete>
</mapper> 
