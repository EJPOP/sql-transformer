<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.csp.ear.dao.CSPEAR020Mapper">
 	<insert id="CSPEAR020EMainInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR020Mapper."CSPEAR020EMainInsert" */
        <![CDATA[
        	INSERT INTO	TBCSPEAR012M
        				(	CMTR_CD
        					, INN_STF_DVSN_CD
        					, CNB
        					, CMTR_NM
        					, CMTR_PST_CD
        					, TERM_BGNDE
        					, TERM_ENDDE
        					, PFL_DOC_ID
        					, FRT_USR_ID
        					, FNL_USR_ID
        					, FNL_DEAL_DPT_CD
        					, FNL_MNU_ID
        					, FRT_REGI_DH
        					, FNL_MDF_DH
        					, USE_YN
        				)
        		VALUES	(	(
        						SELECT	NVL(MAX(TO_NUMBER(CMTR_CD)),0)+1 AS RM_CVPT_ACP_NO
								FROM	TBCSPEAR012M
							)
        					, #{innStfDvsnCd}
        					, #{cnb}
        					, #{cmtrNm}
        					, #{cmtrPstCd}
        					, #{termBgnde}
        					, #{termEndde}
        					, #{pflDocId}
        					, F_USR_INFO(#{sCnb}, '1')
        					, #{fnlUsrId}
        					, #{fnlDealDptCd}
        					, #{fnlMnuId}
        					, SYSDATE
        					, SYSDATE
        					, 'Y'
        				)
       	]]>
	</insert>
	
	<update id="CSPEAR020EMainUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR020Mapper.CSPEAR020EMainUpdate */
		<![CDATA[
			UPDATE	TBCSPEAR012M
			SET		INN_STF_DVSN_CD = #{innStfDvsnCd}
					,CNB = #{cnb}
					,CMTR_NM = #{cmtrNm}
					,CMTR_PST_CD = #{cmtrPstCd}
					,TERM_BGNDE = #{termBgnde}
					,TERM_ENDDE = #{termEndde}
					,PFL_DOC_ID = #{docId}
					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
   					,USE_YN = #{useYn}
			WHERE	CMTR_CD = #{cmtrCd}
		]]>
	</update>
	
	<delete id="CSPEAR020EMainDelete" parameterType="paramMap">
	/* kr.go.bai.eip.csp.ear.dao.CSPEAR020Mapper.CSPEAR020EMainDelete */
		<![CDATA[
		DELETE	
   		FROM	TBCSPEAR012M
   		WHERE	CMTR_CD = #{cmtrCd}
		]]>
	</delete>

	<select id="selectMainList" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.ear.dao.CSPEAR020Mapper.selectMainList */
		<![CDATA[
			SELECT CMTR_CD
			        ,INN_STF_DVSN_CD
			        ,DECODE(INN_STF_DVSN_CD, '1', '내부직원', '외부직원') AS INN_STF_DVSN_NM
			        ,CNB
			        ,CMTR_NM
                    ,CMTR_PST_CD
   					,DECODE(CMTR_PST_CD, '1', '위원장', '위원') AS CMTR_PST_NM
   					,TO_CHAR(TO_DATE(TERM_BGNDE), 'YYYY-MM-DD') AS TERM_BGNDE
   					,TO_CHAR(TO_DATE(TERM_ENDDE), 'YYYY-MM-DD') AS TERM_ENDDE
   					,PFL_DOC_ID
   					,USE_YN
   			FROM	TBCSPEAR012M
   			WHERE	1=1
		]]>
		<if test='innStfDvsnCd != null and innStfDvsnCd != ""'>
			AND	INN_STF_DVSN_CD = #{innStfDvsnCd}
		</if>
		<if test='cmtrNm != null and cmtrNm != ""'>
			AND	(CMTR_NM LIKE #{cmtrNm} || '%' OR 
				CNB LIKE #{cmtrNm} || '%')
		</if>
		<if test='cmtrPstCd != null and cmtrPstCd != ""'>
			AND	CMTR_PST_CD = #{cmtrPstCd}
		</if>
		<if test='schTermBgnde != null and schTermBgnde != ""'>
			AND	TO_CHAR(TERM_BGNDE,'YYYYMMDD') &gt;= #{schTermBgnde}
		</if>
		<if test='schTermEndde != null and schTermEndde != ""'>
			AND	TO_CHAR(TERM_ENDDE,'YYYYMMDD') &lt;= #{schTermEndde}
		</if>
		<if test='useYn != null and useYn != ""'>
			AND USE_YN = #{useYn}
		</if>
		<![CDATA[
			ORDER BY TERM_ENDDE DESC
		]]>
	</select>
	
</mapper>