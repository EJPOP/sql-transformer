<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper">


 	<select id="CSPDCP412ECodeSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412ECodeSelect */
		<![CDATA[
			SELECT	CD, USR_DFN_TXT_1 AS CD_NM
			FROM	TBDCMACM013C
			WHERE	CMM_CD_DVSN_CD = '1000128'
			AND		CD <> '000000000'

		]]>
	</select>

	<select id="CSPDCP412EDptSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EDptSelect */
		<![CDATA[
			SELECT	DPT_CD
					,DPT_NM
					,HIRK_DPT_CD AS HST_DPT_CD
			FROM	TBDCMACM002M
			WHERE	DPT_CD NOT LIKE '%000'
			AND		USE_YN ='Y'
		]]>
	</select>

	<select id="CSPDCP412EHstDptSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EHstDptSelect */
		<![CDATA[
			SELECT	DPT_CD
					,DPT_NM
			FROM	TBDCMACM002M
			WHERE	DPT_CD <>  '000000'
			AND		DPT_CD LIKE '%000'
			AND		USE_YN ='Y'
		]]>
	</select>

 	<select id="CSPDCP411QMainSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP411QMainSelect */
		<include refid="include.pageSelct" />
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.RM_ACP_KND_CD
   					,A.RM_CVPT_ACP_NO
   					,A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,DECODE(A.PRE_RM_CVPT_ACP_NO,NULL,'-',A.ACP_YR||'-'|| F_CODE_NM('1000949', A.PRE_RM_ACP_KND_CD) ||'-'||A.PRE_RM_CVPT_ACP_NO) AS PRE_ACP_NO /* BEST20 이전접수번호 */
   					,A.CVPT_KND_CD
   					,F_CODE_NM('1000047',A.CVPT_KND_CD) AS CVPT_KND_NM
   					,CASE WHEN ( SELECT COUNT(*)
							       FROM TBCSPDCP105L S1
							      WHERE S1.REQ_DVSN_CD = A.REQ_DVSN_CD
							        AND S1.ACP_YR = A.ACP_YR
							        AND S1.CVPT_ACP_NO = A.CVPT_ACP_NO ) > 1 
						THEN A.TIT_NM||'(합건 : '||
						       ( SELECT S3.ACP_YR||'-'|| F_CODE_NM('1000949', S3.RM_ACP_KND_CD)||'-'||S3.RM_CVPT_ACP_NO
                                   FROM TBCSPDCP105L S2, TBCSPDCP101M S3
                                  WHERE A.REQ_DVSN_CD = S2.REQ_DVSN_CD
                                    AND A.ACP_YR = S2.ACP_YR
                                    AND A.CVPT_ACP_NO = S2.CVPT_ACP_NO
                                    AND S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
                                    AND S2.SUC_ACP_YR = S3.ACP_YR
                                    AND S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
                                    AND ROWNUM = 1)
                                   || ' 외 '
                                   || (SELECT COUNT(*)-1
                                        FROM TBCSPDCP105L S2, TBCSPDCP101M S3
                                       WHERE A.REQ_DVSN_CD     = S2.REQ_DVSN_CD
                                         AND A.ACP_YR          = S2.ACP_YR
                                         AND A.CVPT_ACP_NO     = S2.CVPT_ACP_NO
                                         AND S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
                                         AND S2.SUC_ACP_YR      = S3.ACP_YR
                                         AND S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO )
                                   ||'건 )'
						WHEN ( SELECT COUNT(*) 
						         FROM TBCSPDCP105L S1
						        WHERE S1.SUC_REQ_DVSN_CD = A.REQ_DVSN_CD
						          AND S1.SUC_ACP_YR = A.ACP_YR
						          AND S1.SUC_CVPT_ACP_NO = A.CVPT_ACP_NO) = 1
						THEN A.TIT_NM ||'(합건 : '|| 
						      ( SELECT S3.ACP_YR||'-'|| F_CODE_NM('1000949', S3.RM_ACP_KND_CD) ||'-'||S3.RM_CVPT_ACP_NO
						          FROM TBCSPDCP105L S2, TBCSPDCP101M S3
						         WHERE S2.REQ_DVSN_CD = S3.REQ_DVSN_CD
						           AND S2.ACP_YR = S3.ACP_YR
						           AND S2.CVPT_ACP_NO = S3.CVPT_ACP_NO
						           AND S2.SUC_REQ_DVSN_CD = A.REQ_DVSN_CD
						           AND S2.SUC_ACP_YR = A.ACP_YR
						           AND S2.SUC_CVPT_ACP_NO = A.CVPT_ACP_NO
						       )
						       || ')'
					ELSE A.TIT_NM END AS TIT_NM
   					,A.REQR_KND_CD
   					,A.ACP_RUT_CD
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,A.CVPT_HNDL_STA_CD
   					,F_CODE_NM('1000361',A.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
   					,TO_CHAR(C.FNL_HNDL_DH,'YYYY-MM-DD HH24:MI') AS FNL_HNDL_DH
   					,(	SELECT	TO_CHAR(TO_DATE(TO_CHAR(D.ONR_APV_CMPT_DH, 'YYYYMMDD'), 'YYYYMMDD') + NVL( S1.USR_DFN_TXT_2, 30), 'YYYY-MM-DD')
                    	FROM	TBDCMACM013C S1, TBCSPDCP205L D3
                    	WHERE	S1.CMM_CD_DVSN_CD = '1000754'
                    	AND		S1.CD <> '000000000'
                    	AND     S1.CD  = D3.CVPT_HNDL_DVSN_CD
                    	AND		A.REQ_DVSN_CD = D3.REQ_DVSN_CD
			   			AND		A.ACP_YR = D3.ACP_YR
			   			AND		A.CVPT_ACP_NO = D3.CVPT_ACP_NO
                    	AND (D3.REQ_DVSN_CD, D3.CVPT_ACP_NO, D3.ACP_YR, D3.SRNO ) IN (	SELECT	Z.REQ_DVSN_CD, Z.CVPT_ACP_NO, Z.ACP_YR, MIN(Z.SRNO)
			   																	FROM	TBCSPDCP205L Z
			   																	WHERE	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
			   																	AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
			   																	AND		A.ACP_YR = Z.ACP_YR
			   																	GROUP BY Z.REQ_DVSN_CD, Z.CVPT_ACP_NO, Z.ACP_YR
			   																)) AS HNDL_LIMIT__DT
			   		,TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYY-MM-DD')  AS HNDL_LIMIT_DT_PRCS
					,(	SELECT	S1.DPT_NM
   						FROM 	TBDCMACM002M S1
   						WHERE 	S1.DPT_CD = A.ACP_DPT_CD
   						) AS ACP_DPT_NM
                    ,F_CODE_NM('1000056',A.ACP_RUT_CD) AS ACP_RUT_NM
					,TO_CHAR(A.CVPT_WDW_DH,'YYYY-MM-DD HH24:MI') AS CVPT_WDW_DH
					,A.WDW_RQS_YN
					,(SELECT COUNT(CVPT_ACP_NO)
					   FROM TBCSPDCP601M
					  WHERE ACP_YR = A.ACP_YR
					     AND REQ_DVSN_CD = A.REQ_DVSN_CD
					     AND CVPT_ACP_NO = A.CVPT_ACP_NO) AS PRC_CNT
					
					,CASE WHEN (SELECT COUNT(AUD_STEP_SNO) FROM TBCSPDCP207L
                                  WHERE ACP_YR = A.ACP_YR
                                     AND REQ_DVSN_CD = A.REQ_DVSN_CD
                                     AND CVPT_ACP_NO = A.CVPT_ACP_NO) > 0
                          THEN 
                                (SELECT COUNT(AUD_STEP_SNO) FROM TBCSPDCP207L
                                  WHERE ACP_YR = A.ACP_YR
					                AND REQ_DVSN_CD = A.REQ_DVSN_CD
					                AND CVPT_ACP_NO = A.CVPT_ACP_NO) || '회' 
                          END AS BZT_CNT
               , F_CODE_NM('1000894', A.DOC_WRIT_KND_CD) AS DOC_TYPE /* 편집기 구분  */ 
   			FROM	TBCSPDCP101M A
   					,TBCSPDCP102M B
   					,TBCSPDCP201M C
   					,TBCSPDCP301M D
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = '1'
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
   			AND		A.ACP_YR = C.ACP_YR
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = D.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
   			AND		D.CVPT_IFM_DVSN_CD(+) = 'C'
   			AND		D.CVPT_OPM_APV_HNDL_STA_CD(+) = '30'

   			AND		(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO)
   					NOT IN (
   						SELECT	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
   						FROM	TBCSPDCP105L
   					)
		]]>

		<if test='enfYn == "Y"'>
			<if test='hndlUsrIdChk != "Y"'>
			AND		C.HNDL_DPT_CD = #{dptCd}
   			AND		C.HNDL_CHGR_ID = #{usrId}
   			</if>
		</if>
		<if test='resultYn == "Y" or resultYn ==""'>
		   <if test='searchChk != "Y"'>
		     AND (A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO)  NOT IN (SELECT A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO
                                                                                   FROM  TBCSPDCP205L D2
                                                                                   WHERE 1=1
                                                                                  AND A.REQ_DVSN_CD = '1'
			                                                                      AND A.REQ_DVSN_CD = D2.REQ_DVSN_CD
			                                                                      AND A.CVPT_ACP_NO = D2.CVPT_ACP_NO
			                                                                      AND A.ACP_YR      = D2.ACP_YR
                                                                                  AND D2.SRNO = 1
                                                                                  AND (D2.TRNF_DPT_CD IN ('100000','100100')
                                                                                  OR  D2.AUD_RFR_MTRL_TRNF_DPT_CD IN ('100000','100100'))
                                                                                  ) 
		    </if>
		</if>
		<if test='acpDhs != null and acpDhs != ""'>
				AND	TO_CHAR(A.ACP_DH,'YYYYMMDD') &gt;= #{acpDhs}
	    </if>
		<if test='acpDhe != null and acpDhe != ""'>
				AND	TO_CHAR(A.ACP_DH,'YYYYMMDD') &lt;= #{acpDhe}
			</if>
		<if test='cvptHndlStaCd != null and cvptHndlStaCd != ""'>
				AND	A.CVPT_HNDL_STA_CD = #{cvptHndlStaCd}
			</if>
		<if test='searchCd == "1"'>
			<if test='titNm != null and titNm != ""'>
					AND	A.TIT_NM LIKE '%'||#{titNm}||'%'
			</if>
		</if>
		<if test='searchCd == "2"'>
			<if test='titNm != null and titNm != ""'>
					AND	B.CVPT_SBT LIKE '%'||#{titNm}||'%'
			</if>
		</if>
		<if test='acpYr != null and acpYr != ""'>
				AND	A.ACP_YR = #{acpYr}
			</if>
		/* BEST20 이전접수번호 조회 */
		<choose>
			<when test='reqDvsnCd != null and reqDvsnCd != "" and rmCvptAcpNo != null and rmCvptAcpNo != ""'>
				 AND ((A.RM_ACP_KND_CD = #{reqDvsnCd} AND A.RM_CVPT_ACP_NO =  LPAD(#{rmCvptAcpNo}, 5, 0)) OR
				         (A.PRE_RM_ACP_KND_CD = #{reqDvsnCd}  AND A.PRE_RM_CVPT_ACP_NO = LPAD(#{rmCvptAcpNo}, 5, 0)))  
			</when>
			<otherwise>
				<if test='reqDvsnCd != null and reqDvsnCd != ""'>
					AND (A.RM_ACP_KND_CD = #{reqDvsnCd})  
				</if>
				
				
				
				
				<if test='rmCvptAcpNo != null and rmCvptAcpNo != ""'>
					<!--감사제보 접수/배부 > 제보처리에서 합건 목록 조회시 대표건 조회 되도록 변경 후 속도 개선을 위해 searchFlag로 분기-->
					<if test='searchFlag=="1"'>
							AND (       RM_CVPT_ACP_NO       = LPAD(#{rmCvptAcpNo}, 5, 0) 
								      OR PRE_RM_CVPT_ACP_NO = LPAD(#{rmCvptAcpNo}, 5, 0) 
								    )
					</if>
					<if test='searchFlag=="2"'>
							AND (A.CVPT_ACP_NO IN (SELECT S2.CVPT_ACP_NO
		                        							    FROM TBCSPDCP105L S2,
		                               									TBCSPDCP101M S3
									                           WHERE S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
									                              AND S2.SUC_ACP_YR = S3.ACP_YR
									                              AND S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
									                              AND S3.RM_CVPT_ACP_NO = #{rmCvptAcpNo})
									                   		      AND A.ACP_YR IN (SELECT S2.ACP_YR
																                          FROM TBCSPDCP105L S2,
																                                 TBCSPDCP101M S3
																                         WHERE S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
																                            AND S2.SUC_ACP_YR = S3.ACP_YR
																                            AND S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
																                            AND S3.RM_CVPT_ACP_NO = #{rmCvptAcpNo} ) )
						</if>																                             						    
				</if>
				
			</otherwise>
		</choose>
		<if test='smgCvptAplNo != null and smgCvptAplNo != ""'>
				AND	A.SMG_CVPT_APL_NO = #{smgCvptAplNo}
			</if>
		<if test='cvptrNm != null and cvptrNm != ""'>
				AND	(A.CVPTR_NM LIKE '%'||#{cvptrNm}||'%' OR A.RPST_PEN_NM LIKE '%'||#{cvptrNm}||'%')
			</if>
		<if test='cvptKndDvsnCd != null and cvptKndDvsnCd != ""'>
			  	AND C.CVPT_KND_DVSN_CD IN
			  		(SELECT 	SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
                     FROM 	DUAL A
                     CROSS JOIN(SELECT ','|| #{cvptKndDvsnCd} ||',' AS CODE FROM DUAL) B
                     CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )				
	    </if>			
			
		<if test='reqrKndCd != null and reqrKndCd != ""'>
			  	AND A.REQR_KND_CD IN
			  		(SELECT 	SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
                     FROM 	DUAL A
                     CROSS JOIN(SELECT ','|| #{reqrKndCd} ||',' AS CODE FROM DUAL) B
                     CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )
		</if>

		<if test='cvptKndCd != null and cvptKndCd != ""'>
			  	AND A.CVPT_KND_CD IN
			  		(SELECT 	SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
                     FROM 	DUAL A
                     CROSS JOIN(SELECT ','|| #{cvptKndCd} ||',' AS CODE FROM DUAL) B
                     CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )
			</if>

		<if test='acpRutCd != null and acpRutCd != ""'>
			  	AND A.ACP_RUT_CD IN
			  		(SELECT 	SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
                     FROM 	DUAL A
                     CROSS JOIN(SELECT ','|| #{acpRutCd} ||',' AS CODE FROM DUAL) B
                     CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )
			</if>

		<if test='mngTypCd != null and mngTypCd != ""'>
			  	AND A.MNG_TYP_CD IN
			  		(SELECT 	SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL) -1) merge_col
                     FROM 	DUAL A
                     CROSS JOIN(SELECT ','|| #{mngTypCd} ||',' AS CODE FROM DUAL) B
                     CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )
			</if>

		<if test='pasvAdmnYn == "Y"'>
				AND	C.PASV_ADMN_YN = 'Y'
			</if>
		<if test='pasvAdmnYn == "N"'>
				AND	( C.PASV_ADMN_YN = 'N' OR C.PASV_ADMN_YN IS NULL )
			</if>
		<if test='refYn == "Y"'>
				AND	C.REF_YN = 'Y'
			</if>
		<if test='refYn == "N"'>
				AND	( C.REF_YN = 'N' OR C.REF_YN IS NULL )
			</if>
		<if test='resultYn == "Y"'>
				AND	A.CVPT_HNDL_STA_CD IN ('50','60','70')
			</if>
		<if test='resultYn == "N"'>
				AND	A.CVPT_HNDL_STA_CD NOT IN ('50','60','70')
			</if>
		<if test='tgOrgCatCd1 != null and tgOrgCatCd1 != ""'>
			AND (SELECT AA.USR_DFN_TXT_1
			         FROM TBDCMACM013C AA
			        WHERE AA.CD = A.TG_ORG_CAT_CD
		               AND AA.CMM_CD_DVSN_CD = '1000948') = #{tgOrgCatCd1}
		</if>
		<if test='tgOrgCatCd2 != null and tgOrgCatCd2 != ""'>
			AND (SELECT AA.USR_DFN_TXT_2
			         FROM TBDCMACM013C AA
			        WHERE AA.CD = A.TG_ORG_CAT_CD
		               AND AA.CMM_CD_DVSN_CD = '1000948') = #{tgOrgCatCd2}
		</if>
		<if test='tgOrgCatCd3 != null and tgOrgCatCd3 != ""'>
			AND A.TG_ORG_CAT_CD = #{tgOrgCatCd3}
		</if>
		
		<if test='mainFuncCatCd != null and mainFuncCatCd != ""'>
			AND A.MAIN_FUNC_CAT_CD IN
			(SELECT
			SUBSTR(CODE,INSTR(CODE,',',1,LEVEL)+1,INSTR(CODE,',',1,LEVEL+1)-INSTR(CODE,',',1,LEVEL)
			-1) merge_col
			FROM DUAL A
			CROSS JOIN(SELECT ','|| #{mainFuncCatCd} ||',' AS CODE FROM DUAL) B
			CONNECT BY LEVEL&lt;=LENGTH(CODE)-LENGTH(REPLACE(CODE,','))-1 )
		</if>
		
		<![CDATA[
			ORDER BY A.ACP_YR DESC, A.CVPT_ACP_NO DESC
		]]>
		<include refid="include.pageOrder" />
	</select>


	<resultMap type="java.util.HashMap" id="cspdcpMap">
 		<result property="reqDvsnCd" column="REQ_DVSN_CD"                   jdbcType="VARCHAR" javaType="java.lang.String" />
		<result property="acpYr" column="ACP_YR"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptAcpNo" column="CVPT_ACP_NO"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="rmAcpKndCd" column="RM_ACP_KND_CD"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpNo" column="ACP_NO"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptKndNm" column="CVPT_KND_NM"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpNm" column="ACP_NM"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpDh" column="ACP_DH"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpRutNm" column="ACP_RUT_NM"             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpRutCd" column="ACP_RUT_CD"             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="reqrKndNm" column="REQR_KND_NM"                         jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptrNm" column="CVPTR_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="openYn" column="OPEN_YN"                               jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="widwYn" column="WIDW_YN"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ad" column="AD"                                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="tnb" column="TNB"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hpn" column="HPN"                                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="rsltNtfWayNm" column="RSLT_NTF_WAY_NM"                                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmNm" column="CLM_NM"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="wrkPlacNm" column="WRK_PLAC_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmTnb" column="CLM_TNB"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmAd" column="CLM_AD"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptTxt" column="CVPT_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="cvptHndlStaCd" column="CVPT_HNDL_STA_CD"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="docId" column="DOC_ID"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptKndCd" column="CVPT_KND_CD"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptKndDvsnCd" column="CVPT_KND_DVSN_CD"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptDocYn" column="CVPT_DOC_YN"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="titNm" column="TIT_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="pasvAdmnYn" column="PASV_ADMN_YN"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="refYn" column="REF_YN"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hndlYn" column="HNDL_YN"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptHndlStaNm" column="CVPT_HNDL_STA_NM"         jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="onrApvRqsDh" column="ONR_APV_RQS_DH"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="onrApvCmptDh" column="ONR_APV_CMPT_DH"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptWdwDh" column="CVPT_WDW_DH"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptWdwRsn" column="CVPT_WDW_RSN"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="atchYn" column="ATCH_YN"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="wdwRqsYn" column="WDW_RQS_YN"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hndlDdlnDt" column="HNDL_DDLN_DT"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="bkHndlDdlnDt" column="BK_HNDL_DDLN_DT"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="scenCfmExtnDcn" column="SCEN_CFM_EXTN_DCN"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ntfExtnDcn" column="NTF_EXTN_DCN"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="innerYn" column="INNER_YN"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="innerOrgNm" column="INNER_ORG_NM"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hRprtCd" column="H_RPRT_CD"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="kywdNm1" column="KYWD_NM_1"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="kywdNm2" column="KYWD_NM_2"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="kywdNm3" column="KYWD_NM_3"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="kywdNm4" column="KYWD_NM_4"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="kywdNm5" column="KYWD_NM_5"      jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="tgOrgCatCd1"		column="TG_ORG_CAT_CD1"		jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="tgOrgCatCd2"		column="TG_ORG_CAT_CD2"		jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="tgOrgCatCd3"		column="TG_ORG_CAT_CD3"		jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="mainFuncCatCd"		column="MAIN_FUNC_CAT_CD"		jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="tgOrgCatNm"		column="TG_ORG_CAT_NM"		jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="mainFuncCatNm"		column="MAIN_FUNC_CAT_NM"		jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="audTgOrgCd"		column="AUD_TG_ORG_CD"		jdbcType="VARCHAR" javaType="java.lang.String"/>
		<result property="rpetYn" column="RPET_YN"      jdbcType="VARCHAR"  javaType="java.lang.String" />
 	</resultMap>
 	
	<select id="CSPDCP412EMainSelect" parameterType="paramMap"
		resultMap="cspdcpMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EMainSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,A.RM_ACP_KND_CD
   					,F_CODE_NM('1000047',A.CVPT_KND_CD) AS CVPT_KND_NM
   					,(	SELECT	S1.DPT_NM
   						FROM 	TBDCMACM002M S1
   						WHERE 	S1.DPT_CD = A.ACP_DPT_CD
   						) ||'/'||F_USR_INFO_BY_ID(A.RCEP_ID,'2') AS ACP_NM
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,F_CODE_NM('1000056',A.ACP_RUT_CD) AS ACP_RUT_NM
   					,A.ACP_RUT_CD
   					,F_CODE_NM('1000358',A.REQR_KND_CD) AS REQR_KND_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,A.OPEN_YN
   					,DECODE(A.CVPT_WDW_DH,NULL,'N','Y') AS WIDW_YN
   					,DECODE(A.ZCD,NULL,'','(우)'||A.ZCD||' '||A.AD||' '||A.DTL_AD) AS AD
   					,A.TNB
   					,A.HPN
   					,CASE WHEN A.ACP_RUT_CD = '8' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						WHEN A.ACP_RUT_CD <> '8' AND A.RSLT_NTF_WAY_CD = '003' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						ELSE '홈페이지+'||F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)  END AS RSLT_NTF_WAY_NM
   					,C.CLM_NM
   					,C.WRK_PLAC_NM
   					,C.TNB AS CLM_TNB
   					,DECODE(C.ZCD,NULL,'','(우)'||C.ZCD||' '||C.AD||' '||C.DTL_AD) AS CLM_AD
   					,B.CVPT_TXT
   					,A.CVPT_HNDL_STA_CD
   					,A.DOC_ID
   					,A.CVPT_KND_CD
   					,D.CVPT_KND_DVSN_CD
   					,CASE WHEN E.ONR_DOC_MNG_CRD_ID IS NOT NULL THEN 'Y' ELSE 'N' END AS CVPT_DOC_YN
   					,A.TIT_NM
   					,D.PASV_ADMN_YN
   					,D.REF_YN
   					,CASE WHEN  E.CVPT_OPM_APV_HNDL_STA_CD <> '30' OR E.CVPT_OPM_APV_HNDL_STA_CD IS NULL THEN '1'
   							WHEN E.CVPT_OPM_APV_HNDL_STA_CD = '30' THEN '2'
   							ELSE '3' END AS HNDL_YN
   					,F_CODE_NM('1000361',A.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
   					,TO_CHAR(E.ONR_APV_RQS_DH,'YYYY-MM-DD HH24:MI') AS ONR_APV_RQS_DH
   					,TO_CHAR(E.ONR_APV_CMPT_DH,'YYYY-MM-DD HH24:MI') AS ONR_APV_CMPT_DH
   					,TO_CHAR(A.CVPT_WDW_DH,'YYYY-MM-DD HH24:MI') AS CVPT_WDW_DH
   					,A.CVPT_WDW_RSN
   					,A.RPET_YN AS RPET_YN
   					,CASE WHEN	(	SELECT	COUNT(FILE_ID)
  			 						FROM	ECM_FILE_LIST_VIEW2 X
   									WHERE	A.DOC_ID = X.DOC_ID
			   					) > 0 THEN '첨부파일 있음'
			   		ELSE '첨부파일 없음' END AS ATCH_YN
			   		,A.WDW_RQS_YN
			   		,F_CODE_NM('1000894', A.DOC_WRIT_KND_CD) AS DOC_TYPE
			   		,(SELECT S1.RPRT_CD
   					   FROM TBCSPDCP603M S1
   					  WHERE S1.REQ_DVSN_CD = A.REQ_DVSN_CD
   					    AND S1.ACP_YR = A.ACP_YR
   					    AND S1.CVPT_ACP_NO = A.CVPT_ACP_NO
   					    AND S1.RPRT_CD IN ('B10200400','B10200600')
   					) AS H_RPRT_CD
   			FROM	TBCSPDCP101M A
   					,TBCSPDCP102M B
   					,TBCSPDCP103M C
   					,TBCSPDCP201M D
   					,TBCSPDCP301M E
   					,TBCSPDCP205L F
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD ='1'
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = C.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO(+)
   			AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD
   			AND		A.ACP_YR = D.ACP_YR
   			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = F.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = F.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = F.CVPT_ACP_NO(+)
   			AND		( F.SRNO = (SELECT 	MIN(SRNO)
								FROM 	TBCSPDCP205L A
								WHERE 	A.REQ_DVSN_CD = #{reqDvsnCd}
								AND		A.ACP_YR = #{acpYr}
								AND		A.CVPT_ACP_NO = #{cvptAcpNo} ) OR F.SRNO IS NULL )
   			AND		A.REQ_DVSN_CD = E.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = E.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = E.CVPT_ACP_NO(+)
   			AND		E.CVPT_IFM_DVSN_CD(+) = 'C'
		]]>

	</select>

	<select id="CSPDCP412ESucSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412ESucSelect */
		<![CDATA[
			SELECT	B.REQ_DVSN_CD
					,B.ACP_YR
   					,B.CVPT_ACP_NO
   					,A.RM_CVPT_ACP_NO
   					,A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,A.CVPT_KND_CD
   					,F_CODE_NM('1000047',A.CVPT_KND_CD) AS CVPT_KND_NM
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,A.TIT_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,B.SUC_REQ_DVSN_CD
   					,B.SUC_ACP_YR
   					,B.SUC_CVPT_ACP_NO
   					,A.CVPT_HNDL_STA_CD
   			FROM	TBCSPDCP101M A, TBCSPDCP105L B
   			WHERE	B.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		B.ACP_YR = #{acpYr}
   			AND		B.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		B.SUC_REQ_DVSN_CD = A.REQ_DVSN_CD
   			AND		B.SUC_ACP_YR = A.ACP_YR
   			AND		B.SUC_CVPT_ACP_NO = A.CVPT_ACP_NO
   		]]>
   	</select>

   	<select id="CSPDCP412EOrgSelect" parameterType="paramMap"
		resultType="egovMap">
		/*kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EOrgSelect*/
		<![CDATA[
			SELECT	B.REQ_DVSN_CD
					,B.ACP_YR
   					,B.CVPT_ACP_NO
   					,B.HNDL_ORG_SRNO
   					,B.ORG_HIS_DVSN_CD
   					,B.SRNO
   					,B.ORG_CD
   					,B.PUB_DVSN_CD
   					,CASE 
                        WHEN F_CODE_NM('1000447',B.PUB_DVSN_CD) IS NULL THEN 
                            (SELECT	F_CODE_NM('1000447',Z.USR_DFN_TXT_1)
                            FROM	TBDCMACM013C Z
                            WHERE	Z.CMM_CD_DVSN_CD ='1000128'
                            AND		Z.CD =B.PUB_DVSN_CD) 
                        ELSE F_CODE_NM('1000447',B.PUB_DVSN_CD) 
                     END AS PUB_DVSN_NM
   					,B.COPT_SG_CD
   					,F_ORG_HRK_NM(B.COPT_SG_CD) AS COPT_SG_NM
   					,CASE WHEN B.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(B.ORG_CD,'1')
   						ELSE B.ORG_NM END AS ORG_NM
   					,B.OGN_ORG_DVSN_CD
   					,DECODE(B.OGN_ORG_DVSN_CD, '10','공공기관','기타') AS OGN_ORG_DVSN_NM
   			FROM	TBCSPDCP201M A, TBCSPDCP206L B
   			WHERE	A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		B.ORG_HIS_DVSN_CD ='1'
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   		]]>
   	</select>

   	<select id="CSPDCP412EHndlSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EHndlSelect */
		<![CDATA[
			SELECT	B.REQ_DVSN_CD
					,B.ACP_YR
   					,B.CVPT_ACP_NO
   					,B.SRNO
   					,B.CVPT_HNDL_DVSN_CD
   					,F_CODE_NM('1000754',B.CVPT_HNDL_DVSN_CD) AS CVPT_HNDL_DVSN_NM
   					,B.AUD_RFR_MTRL_TRNF_DPT_CD
   					,DECODE(B.AUD_RFR_MTRL_TRNF_DPT_CD,NULL,'',SUBSTR(B.AUD_RFR_MTRL_TRNF_DPT_CD,1,3)||'000') AS AUD_RFR_MTRL_TRNF_HST_DPT_CD
   					,B.TRNF_DPT_CD
   					,DECODE(B.TRNF_DPT_CD,NULL,'',SUBSTR(B.TRNF_DPT_CD,1,3)||'000') AS TRNF_HST_DPT_CD
   					/*,CASE WHEN A.CVPT_KND_DVSN_CD = '1' AND B.CVPT_HNDL_DVSN_CD IN ('11','12','13','14') THEN '10'
   							WHEN A.CVPT_KND_DVSN_CD = '1' THEN B.CVPT_HNDL_DVSN_CD
   							ELSE '' END AS CVPT_HNDL_DVSN_CD1
   					,CASE WHEN A.CVPT_KND_DVSN_CD = '2' AND B.CVPT_HNDL_DVSN_CD IN ('61','62','63') THEN '60'
   							WHEN A.CVPT_KND_DVSN_CD = '2' THEN B.CVPT_HNDL_DVSN_CD
   							ELSE '' END AS CVPT_HNDL_DVSN_CD2
   					,B.CVPT_HNDL_DVSN_CD AS CVPT_HNDL_DVSN_CD_S*/
   					,B.CVPT_HNDL_DVSN_CD AS OLD_CVPT_HNDL_DVSN_CD
   					,B.DOC_ID AS HNDL_DOC_ID
   					,'첨부파일보기' AS DOC_NM
   					,(SELECT S1.RPRT_CD
   					   FROM TBCSPDCP603M S1
   					  WHERE S1.REQ_DVSN_CD = A.REQ_DVSN_CD
   					    AND S1.ACP_YR = A.ACP_YR
   					    AND S1.CVPT_ACP_NO = A.CVPT_ACP_NO
   					    AND S1.RPRT_CD IN ('B10200400','B10200600')
   					    group by S1.RPRT_CD
   					) AS RPRT_CD
   			FROM	TBCSPDCP201M A, TBCSPDCP205L B
   			WHERE	A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			ORDER BY B.SRNO ASC
   		]]>
   	</select>

	<select id="CSPDCP416PMainSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416PMainSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,DECODE(A.PRE_RM_CVPT_ACP_NO,NULL,'-',A.ACP_YR||'-'|| F_CODE_NM('1000949', A.PRE_RM_ACP_KND_CD) ||'-'||A.PRE_RM_CVPT_ACP_NO) AS PRE_ACP_NO /* BEST20 이전접수번호 */
   					,A.CVPT_KND_CD
   					,F_CODE_NM('1000047',A.CVPT_KND_CD) AS CVPT_KND_NM
   					,A.TIT_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,A.CVPT_HNDL_STA_CD
   					,A.ACP_RUT_CD
   					,A.HPN
   					,A.RM_CVPT_ACP_NO
   			FROM	TBCSPDCP101M A
   					,TBCSPDCP102M B
   					,TBCSPDCP201M C
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = '1'
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
   			AND		A.ACP_YR = C.ACP_YR
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
   			AND		C.HNDL_DPT_CD = #{dptCd}
   			AND		C.HNDL_CHGR_ID = #{usrId}
   			AND		(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) NOT IN (	SELECT 	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
   																		FROM	TBCSPDCP203M)
   			AND		(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) NOT IN (	SELECT 	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
																		FROM	TBCSPDCP603M
																		WHERE ACP_STEP_CD = 'B1020'
																		AND RPRT_CD = 'B10200400')
   			AND		A.CVPT_HNDL_STA_CD IN ('30','40')
   			AND		(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) NOT IN (	SELECT	#{reqDvsnCd},#{acpYr},#{cvptAcpNo}
   																		FROM	DUAL )
   			AND		((A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) NOT IN (	SELECT 	REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO
   																		FROM	TBCSPDCP105L)
   					AND (A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO) NOT IN (	SELECT 	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
   																			FROM	TBCSPDCP105L) )
		]]>
		<if test='acpDhs != null and acpDhs != ""'>
				AND	A.ACP_DH &gt;= #{acpDhs}
			</if>
		<if test='acpDhe != null and acpDhe != ""'>
				AND	TO_CHAR(A.ACP_DH,'YYYYMMDD') &lt;= #{acpDhe}
			</if>
		<if test='titNm != null and titNm != ""'>
					AND	A.TIT_NM LIKE '%'||#{titNm}||'%'
		</if>
		<if test='schAcpYr != null and schAcpYr != ""'>
				AND	A.ACP_YR = #{schAcpYr}
			</if>
		
		<if test='cvptrNm != null and cvptrNm != ""'>
				AND	(A.CVPTR_NM LIKE '%'||#{cvptrNm}||'%' OR A.RPST_PEN_NM LIKE '%'||#{cvptrNm}||'%')
			</if>
			
		<if test='rmAcpKndCd != null and rmAcpKndCd != ""'>
				AND	A.RM_ACP_KND_CD = #{rmAcpKndCd}
			</if>
		/* BEST20 이전접수번호 조회 */
		<choose>
			<when test='srhReqDvsnCd != null and srhReqDvsnCd != "" and rmCvptAcpNo != null and rmCvptAcpNo != ""'>
				 AND ((A.RM_ACP_KND_CD = #{srhReqDvsnCd} AND A.RM_CVPT_ACP_NO = #{rmCvptAcpNo}) OR
				         (A.PRE_RM_ACP_KND_CD = #{srhReqDvsnCd}  AND A.PRE_RM_CVPT_ACP_NO = #{rmCvptAcpNo}))  
			</when>
			<otherwise>
				<if test='srhReqDvsnCd != null and srhReqDvsnCd != ""'>
					AND (A.RM_ACP_KND_CD = #{srhReqDvsnCd})  
				</if>
				<if test='rmCvptAcpNo != null and rmCvptAcpNo != ""'>
					AND (A.RM_CVPT_ACP_NO = #{rmCvptAcpNo} OR A.PRE_RM_CVPT_ACP_NO = #{rmCvptAcpNo})
				</if>
			</otherwise>
		</choose>
		
		
	</select>

	<select id="CSPDCP416PSucSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416PSucSelect */
		<![CDATA[
			SELECT	B.REQ_DVSN_CD
					,B.ACP_YR
   					,B.CVPT_ACP_NO
   					,A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,DECODE(A.PRE_RM_CVPT_ACP_NO,NULL,'-',A.ACP_YR||'-'|| F_CODE_NM('1000949', A.PRE_RM_ACP_KND_CD) ||'-'||A.PRE_RM_CVPT_ACP_NO) AS PRE_ACP_NO /* BEST20 이전접수번호 */
   					,A.CVPT_KND_CD
   					,F_CODE_NM('1000047',A.CVPT_KND_CD) AS CVPT_KND_NM
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,A.TIT_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,B.SUC_REQ_DVSN_CD
   					,B.SUC_ACP_YR
   					,B.SUC_CVPT_ACP_NO
   					,A.CVPT_HNDL_STA_CD
   					,A.ACP_RUT_CD
   					,A.HPN
   			FROM	TBCSPDCP101M A, TBCSPDCP105L B
   			WHERE	B.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		B.ACP_YR = #{acpYr}
   			AND		B.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		B.SUC_REQ_DVSN_CD = A.REQ_DVSN_CD
   			AND		B.SUC_ACP_YR = A.ACP_YR
   			AND		B.SUC_CVPT_ACP_NO = A.CVPT_ACP_NO
   		]]>
   	</select>

   	<insert id="CSPDCP416P105SucInsert" parameterType="paramMap">
   		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P105SucInsert */
   		<![CDATA[
   			INSERT INTO	TBCSPDCP105L
	   					(	REQ_DVSN_CD
	   						,ACP_YR
	   						,CVPT_ACP_NO
	   						,SUC_REQ_DVSN_CD
	   						,SUC_ACP_YR
	   						,SUC_CVPT_ACP_NO
	   						,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
       			VALUES	(	#{reqDvsnCd}
	   						,#{acpYr}
	   						,#{cvptAcpNo}
	   						,#{sucReqDvsnCd}
	   						,#{sucAcpYr}
	   						,#{sucCvptAcpNo}
	   						,#{frtUsrId}
	       					,#{fnlUsrId}
	       					,#{fnlDealDptCd}
	       					,#{fnlMnuId}
	       					,SYSDATE
	       					,SYSDATE
	       				)
   		]]>
   	</insert>

   	<update id="CSPDCP416P201SucUpdate" parameterType="paramMap">
   		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P201SucUpdate */
   		<![CDATA[
   			UPDATE	TBCSPDCP201M A
   			SET		A.CVPT_KND_DVSN_CD = (SELECT 	Z.CVPT_KND_DVSN_CD
   										FROM 	TBCSPDCP201M Z
   										WHERE 	Z.REQ_DVSN_CD = #{reqDvsnCd}
   										AND		Z.ACP_YR = #{acpYr}
   										AND		Z.CVPT_ACP_NO = #{cvptAcpNo})
   					,A.PASV_ADMN_YN = (SELECT 	Z.PASV_ADMN_YN
   										FROM 	TBCSPDCP201M Z
   										WHERE 	Z.REQ_DVSN_CD = #{reqDvsnCd}
   										AND		Z.ACP_YR = #{acpYr}
   										AND		Z.CVPT_ACP_NO = #{cvptAcpNo})
   					,A.REF_YN = (SELECT 	Z.REF_YN
   										FROM 	TBCSPDCP201M Z
   										WHERE 	Z.REQ_DVSN_CD = #{reqDvsnCd}
   										AND		Z.ACP_YR = #{acpYr}
   										AND		Z.CVPT_ACP_NO = #{cvptAcpNo})
   					,A.DOC_ID = (SELECT 	Z.DOC_ID
   										FROM 	TBCSPDCP201M Z
   										WHERE 	Z.REQ_DVSN_CD = #{reqDvsnCd}
   										AND		Z.ACP_YR = #{acpYr}
   										AND		Z.CVPT_ACP_NO = #{cvptAcpNo})
   					,A.DOC_TYP_CD = (SELECT 	Z.DOC_TYP_CD
   										FROM 	TBCSPDCP201M Z
   										WHERE 	Z.REQ_DVSN_CD = #{reqDvsnCd}
   										AND		Z.ACP_YR = #{acpYr}
   										AND		Z.CVPT_ACP_NO = #{cvptAcpNo})
   			WHERE	A.REQ_DVSN_CD = #{sucReqDvsnCd}
   			AND		A.ACP_YR = #{sucAcpYr}
   			AND		A.CVPT_ACP_NO = #{sucCvptAcpNo}
   		]]>
   	</update>
   	
   <!-- 재배부요청시 합건 목록들 처리자 null 업데이트  -->
	 <update id="CSPDCP416P201SucRedirectUpdate" parameterType="paramMap">
   		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P201SucRedirectUpdate */
   		<![CDATA[
   			UPDATE	TBCSPDCP201M 
   			SET		HNDL_CHGR_ID = #{hndlChgrId}
   			WHERE	REQ_DVSN_CD = #{sucReqDvsnCd}
   			AND		ACP_YR = #{sucAcpYr}
   			AND		CVPT_ACP_NO = #{sucCvptAcpNo}
   		]]>
   	</update> 
   	
   	<!-- 배부 확인시 재배부요청된 합건 처리자 업데이트  -->
   	 <update id="CSPDCP416P201SucConfirmUpdate" parameterType="paramMap">
   		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P201SucConfirmUpdate */
   		<![CDATA[
   			UPDATE	TBCSPDCP201M 
   			SET		HNDL_CHGR_ID = #{hndlChgrId}
   			       ,HNDL_DPT_CD = #{hndlDptCd}
   			       ,RAL_BLT_DIV_CD = (
   			       		SELECT RAL_BLT_DIV_CD
						  FROM TBDCMACM001M
						 WHERE USR_ID = #{hndlChgrId}
   			       )
   			WHERE	REQ_DVSN_CD = #{sucReqDvsnCd}
   			AND		ACP_YR = #{sucAcpYr}
   			AND		CVPT_ACP_NO = #{sucCvptAcpNo}
   		]]>
   	</update>
   	
   	<delete id="CSPDCP416P105SucDelete" parameterType="paramMap">
   		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P105SucDelete */
	   	<![CDATA[
	   		DELETE	/*CSPDCP416P105SucDelete*/
	   		FROM	TBCSPDCP105L
	   		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
	   		AND		ACP_YR = #{acpYr}
	   		AND		CVPT_ACP_NO = #{cvptAcpNo}
	   		AND		SUC_REQ_DVSN_CD = #{sucReqDvsnCd}
	   		AND		SUC_ACP_YR = #{sucAcpYr}
	   		AND		SUC_CVPT_ACP_NO = #{sucCvptAcpNo}
	   	]]>
   	</delete>

   	<update id="CSPDCP416P101Update" parameterType="paramMap">
   		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P101Update */
		<![CDATA[
			UPDATE	TBCSPDCP101M A
			SET		A.CVPT_HNDL_STA_CD = #{hndlStaCd}
					,A.CVPT_KND_CD = (SELECT	Z.CVPT_KND_CD
									FROM	TBCSPDCP101M Z
									WHERE 	Z.REQ_DVSN_CD = #{reqDvsnCd}
									AND		Z.ACP_YR = #{acpYr}
 									AND		Z.CVPT_ACP_NO = #{cvptAcpNo})
					,A.FNL_USR_ID = #{fnlUsrId}
   					,A.FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,A.FNL_MNU_ID = #{fnlMnuId}
   					,A.FNL_MDF_DH = SYSDATE
			WHERE	A.REQ_DVSN_CD = #{sucReqDvsnCd}
			AND		A.ACP_YR = #{sucAcpYr}
			AND		A.CVPT_ACP_NO = #{sucCvptAcpNo}
		]]>
	</update>

	<update id="CSPDCP416E202DtbInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416E202DtbInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,HNDL_DPT_CD
        					,HNDL_CHGR_ID
        					,RDTB_RQS_RSN
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#{sucReqDvsnCd}
							,#{sucAcpYr}
							,#{sucCvptAcpNo}
							,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
								  FROM TBCSPDCP202H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #{sucReqDvsnCd}
							       AND ACP_YR = #{sucAcpYr}
							       AND CVPT_ACP_NO = #{sucCvptAcpNo}
							 )
							,F_USR_INFO(#{sCnb},'5')
							,F_USR_INFO(#{sCnb},'1')
							,#{hndlStaCd}
							,#{hndlDptCd}
							,#{hndlChgrId}
							,#{rdtbRqsRsn}
							,F_USR_INFO(#{sCnb},'1')
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)
		]]>
	</update>

	<!-- 합건될때 배부확인 안한 감사제보는 SMS 발송한다. -->
	<insert id="CSPDCP416PMsgInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416PMsgInsert */
		<![CDATA[
			INSERT INTO MSG_DATA
				 	(	MSG_SEQ
				 		, CUR_STATE
				 		, REQ_DATE
				 		, CALL_TO
				 		, CALL_FROM
				 		, SMS_TXT
				 		, MSG_TYPE
				 		, CONT_SEQ
				 	)
			VALUES (	MSG_DATA_SEQ.NEXTVAL
						, 0
						, SYSDATE
						, REPLACE(#{hpn},'-','')
						, '01027766577'
						, ''
						, 6
						, #{contSeq}
					)
		]]>
	</insert>


	<insert id="CSPDCP416P304MsgInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P304MsgInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP304L
						(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_SMS_TRNM_HIS_SRNO
							,TRNM_HPN
							,RPL_TNB
							,SMS_TXT
							,TRNM_DH
							,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
       			VALUES	(	#{sucReqDvsnCd}
       						,#{sucAcpYr}
       						,#{sucCvptAcpNo}
							,(	SELECT NVL(MAX(CVPT_SMS_TRNM_HIS_SRNO),0)+1
								  FROM TBCSPDCP304L
								 WHERE 1=1
							       AND REQ_DVSN_CD = #{sucReqDvsnCd}
							       AND ACP_YR = #{sucAcpYr}
							       AND CVPT_ACP_NO = #{sucCvptAcpNo}
							 )
							,'010-1111-1111'
							,#{hpn}
							,#{smsTxt}
							,SYSDATE
							,F_USR_INFO(#{sCnb},'1')
							,F_USR_INFO(#{sCnb},'1')
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)

		]]>
	</insert>

	<delete id="CSPDCP416P205Delete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P205Delete */
		<![CDATA[
			DELETE	/*CSPDCP416P205Delete*/
			FROM	TBCSPDCP205L
			WHERE	REQ_DVSN_CD = #{sucReqDvsnCd}
			AND		ACP_YR = #{sucAcpYr}
			AND		CVPT_ACP_NO = #{sucCvptAcpNo}
		]]>
	</delete>

	<delete id="CSPDCP416P206Delete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P206Delete */
		<![CDATA[
			DELETE	/*CSPDCP416P206Delete*/
			FROM	TBCSPDCP206L
			WHERE	REQ_DVSN_CD = #{sucReqDvsnCd}
			AND		ACP_YR = #{sucAcpYr}
			AND		CVPT_ACP_NO = #{sucCvptAcpNo}
		]]>
	</delete>

	<!-- 민원 처리 내역 저장 시 처리기본 테이블 UPDATE -->
	<update id="CSPDCP412E201MainUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E201MainUpdate */
		<![CDATA[
			UPDATE	TBCSPDCP201M
			SET		CVPT_KND_DVSN_CD = #{cvptKndDvsnCd}
					,PASV_ADMN_YN = #{pasvAdmnYn}
					,REF_YN = #{refYn}
					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>

	<!-- 민원 처리 내역 저장 시 합건된 감사제보들 처리기본 테이블 UPDATE -->
	<update id="CSPDCP412E201SucUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E201SucUpdate */
		<![CDATA[
			UPDATE	TBCSPDCP201M
			SET		CVPT_KND_DVSN_CD = #{cvptKndDvsnCd}
					,PASV_ADMN_YN = #{pasvAdmnYn}
					,REF_YN = #{refYn}
					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
															)
		]]>
	</update>

	<!-- 민원 처리결과 저장시 민원 접수 테이블 update -->
	<update id="CSPDCP412E101Update" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E101Update */
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD = #{hndlStaCd}
					,CVPT_KND_CD = #{cvptKndCd}
					,RPET_YN = #{rpetYn}
					,KYWD_NM_1 = #{kywdNm1}
					,KYWD_NM_2 = #{kywdNm2}
					,KYWD_NM_3 = #{kywdNm3}
					,KYWD_NM_4 = #{kywdNm4}
					,KYWD_NM_5 = #{kywdNm5}
					,MAIN_FUNC_CAT_CD  = #{mainFuncCatCd}
					,TG_ORG_CAT_CD  = #{tgOrgCatCd3}
					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>

	<!-- 민원 처리결과 저장시 합건된 민원 접수 테이블 update -->
	<update id="CSPDCP412E101SucUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E101SucUpdate */
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD = #{hndlStaCd}
					,CVPT_KND_CD = #{cvptKndCd}
					,KYWD_NM_1 = #{kywdNm1}
					,KYWD_NM_2 = #{kywdNm2}
					,KYWD_NM_3 = #{kywdNm3}
					,KYWD_NM_4 = #{kywdNm4}
					,KYWD_NM_5 = #{kywdNm5}
					,TG_ORG_CAT_CD  = #{tgOrgCatCd3}
					,RPET_YN = #{rpetYn}
					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
															)
		]]>
	</update>

	<insert id="CSPDCP412E206Insert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E206Insert */
		<![CDATA[
			INSERT INTO	TBCSPDCP206L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,HNDL_ORG_SRNO
        					,ORG_HIS_DVSN_CD
        					,SRNO
        					,ORG_CD
        					,PUB_DVSN_CD
        					,COPT_SG_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        					,ORG_NM
        					,OGN_ORG_DVSN_CD
        				)
        		VALUES	(	#{reqDvsnCd}
        					,#{acpYr}
        					,#{cvptAcpNo}
        					,(	SELECT	NVL(MAX(HNDL_ORG_SRNO),0)+1
        						FROM	TBCSPDCP206L
        						WHERE	REQ_DVSN_CD = #{reqDvsnCd}
        						AND		ACP_YR = #{acpYr}
        						AND		CVPT_ACP_NO = #{cvptAcpNo}
        					)
        					,#{orgHisDvsnCd}
        					,#{srno}
        					,DECODE(#{ognOrgDvsnCd},'20','',#{orgCd})
        					,#{pubDvsnCd}
        					,#{coptSgCd}
        					,#{frtUsrId}
        					,#{fnlUsrId}
        					,#{fnlDealDptCd}
        					,#{fnlMnuId}
        					,SYSDATE
        					,SYSDATE
        					,DECODE(#{ognOrgDvsnCd},'20',#{orgNm},'')
        					,#{ognOrgDvsnCd}
        				)

		]]>
	</insert>

	<insert id="CSPDCP412E206SucInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E206SucInsert */
		<![CDATA[
			INSERT INTO	/*CSPDCP412E206SucInsert*/
						TBCSPDCP206L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,HNDL_ORG_SRNO
        					,ORG_HIS_DVSN_CD
        					,SRNO
        					,ORG_CD
        					,PUB_DVSN_CD
        					,COPT_SG_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        					,ORG_NM
        					,OGN_ORG_DVSN_CD
        				)
        	SELECT	SUC_REQ_DVSN_CD
        			,SUC_ACP_YR
        			,SUC_CVPT_ACP_NO
        			,(	SELECT	NVL(MAX(HNDL_ORG_SRNO),0)+1
        						FROM	TBCSPDCP206L
        						WHERE	REQ_DVSN_CD = SUC_REQ_DVSN_CD
        						AND		ACP_YR = SUC_ACP_YR
        						AND		CVPT_ACP_NO = SUC_CVPT_ACP_NO
        			)
        			,#{orgHisDvsnCd}
        			,#{srno}
  					,#{orgCd}
  					,#{pubDvsnCd}
  					,#{coptSgCd}
  					,#{frtUsrId}
  					,#{fnlUsrId}
  					,#{fnlDealDptCd}
  					,#{fnlMnuId}
  					,SYSDATE
  					,SYSDATE
  					,DECODE(#{ognOrgDvsnCd},'20',#{orgNm},'')
     				,#{ognOrgDvsnCd}
        	FROM	TBCSPDCP105L
        	WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN ( 	SELECT	#{reqDvsnCd},#{acpYr},#{cvptAcpNo}
        													FROM 	DUAL )
		]]>
	</insert>

	<delete id="CSPDCP412E206Delete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E206Delete */
		<![CDATA[
			DELETE
			FROM	TBCSPDCP206L
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		  	AND 	ACP_YR = #{acpYr}
		    AND 	CVPT_ACP_NO = #{cvptAcpNo}
		    AND		ORG_HIS_DVSN_CD = #{orgHisDvsnCd}
		    AND		HNDL_ORG_SRNO = #{hndlOrgSrno}
		]]>
	</delete>

	<delete id="CSPDCP412E206SucDelete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E206SucDelete */
		<![CDATA[
			DELETE
			FROM	TBCSPDCP206L
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
															)
		    AND		ORG_HIS_DVSN_CD = #{orgHisDvsnCd}
		    AND		HNDL_ORG_SRNO = #{hndlOrgSrno}
		]]>
	</delete>

	<select id="CSPDCP412E206HndlOrgSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E206HndlOrgSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.HNDL_ORG_SRNO
   					,A.ORG_HIS_DVSN_CD
   					,A.SRNO
   					,A.ORG_CD
   					,A.PUB_DVSN_CD
   					,F_CODE_NM('1000447',A.PUB_DVSN_CD) AS PUB_DVSN_NM
   					,A.COPT_SG_CD
   					,F_ORG_HRK_NM(A.COPT_SG_CD) AS COPT_SG_NM
   					, F_ORG_INFO(A.ORG_CD,'1') AS ORG_NM
   			FROM	TBCSPDCP206L A
   			WHERE	A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.SRNO = #{srno}
   			AND		A.ORG_HIS_DVSN_CD = #{orgHisDvsnCd}
   		]]>
   	</select>

   	<select id="CSPDCP412E205KeySelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E205KeySelect */
        <![CDATA[
			SELECT	TO_CHAR(NVL(MAX(SRNO),0)+1) AS SRNO
			FROM	TBCSPDCP205L A
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
			AND		A.ACP_YR = #{acpYr}
			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</select>

	<insert id="CSPDCP412E205Insert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E205Insert */
		<![CDATA[
			INSERT INTO	/*CSPDCP412E205Insert*/
						TBCSPDCP205L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,SRNO
        					,CVPT_HNDL_DVSN_CD
        					,AUD_RFR_MTRL_TRNF_DPT_CD
        					,TRNF_DPT_CD
        					,DOC_ID
        					,DOC_TYP_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#{reqDvsnCd}
        					,#{acpYr}
        					,#{cvptAcpNo}
        					,#{srno}
        					,#{cvptHndlDvsnCd}
        					,#{audRfrMtrlTrnfDptCd}
        					,#{trnfDptCd}
        					,#{hndlDocId}
        					,#{hndlDocTypCd}
        					,#{frtUsrId}
        					,#{fnlUsrId}
        					,#{fnlDealDptCd}
        					,#{fnlMnuId}
        					,SYSDATE
        					,SYSDATE
        				)
		]]>
	</insert>

	<insert id="CSPDCP412E205SucInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E205SucInsert */
		<![CDATA[
			INSERT INTO	/*CSPDCP412E205SucInsert*/
						TBCSPDCP205L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,SRNO
        					,CVPT_HNDL_DVSN_CD
        					,AUD_RFR_MTRL_TRNF_DPT_CD
        					,TRNF_DPT_CD
        					,DOC_ID
        					,DOC_TYP_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		SELECT	SUC_REQ_DVSN_CD
	        			,SUC_ACP_YR
	        			,SUC_CVPT_ACP_NO
       					,#{srno}
       					,#{cvptHndlDvsnCd}
       					,#{audRfrMtrlTrnfDptCd}
       					,#{trnfDptCd}
       					,#{hndlDocId}
       					,#{hndlDocTypCd}
       					,#{frtUsrId}
       					,#{fnlUsrId}
       					,#{fnlDealDptCd}
       					,#{fnlMnuId}
       					,SYSDATE
       					,SYSDATE
        		FROM	TBCSPDCP105L
        		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN ( 	SELECT	#{reqDvsnCd},#{acpYr},#{cvptAcpNo}
        														FROM 	DUAL )
		]]>
	</insert>

	<!-- 처리결과내역 수정 -->
	<update id="CSPDCP412E205Update" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E205Update */
		<![CDATA[
			UPDATE	/*CSPDCP412E205Update*/ TBCSPDCP205L
			SET		CVPT_HNDL_DVSN_CD = #{cvptHndlDvsnCd}
					,AUD_RFR_MTRL_TRNF_DPT_CD = #{audRfrMtrlTrnfDptCd}
					,TRNF_DPT_CD = #{trnfDptCd}
					,DOC_ID = #{hndlDocId}
					,DOC_TYP_CD = #{docTypCd}
					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
			AND		SRNO = #{srno}
		]]>
	</update>

	<!-- 합건자료 처리결과내역 수정 -->
	<update id="CSPDCP412E205SucUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E205SucUpdate */
		<![CDATA[
			UPDATE	/*CSPDCP412E205SucUpdate*/ TBCSPDCP205L
			SET		CVPT_HNDL_DVSN_CD = #{cvptHndlDvsnCd}
					,AUD_RFR_MTRL_TRNF_DPT_CD = #{audRfrMtrlTrnfDptCd}
					,TRNF_DPT_CD = #{trnfDptCd}
					,DOC_ID = #{hndlDocId}
					,DOC_TYP_CD = #{docTypCd}
					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
															)
			AND		SRNO = #{srno}
		]]>
	</update>

	<delete id="CSPDCP412E205Delete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E205Delete */
		<![CDATA[
			DELETE	/*CSPDCP412E205Delete*/
			FROM	TBCSPDCP205L
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		  	AND 	ACP_YR = #{acpYr}
		    AND 	CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</delete>

	<delete id="CSPDCP412E205SucDelete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E205SucDelete */
		<![CDATA[
			DELETE	/*"CSPDCP412E205SucDelete"*/
			FROM	TBCSPDCP205L
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
															)
		]]>
	</delete>

	<delete id="CSPDCP412E205206Delete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E205206Delete */
		<![CDATA[
			DELETE	/*CSPDCP412E205206Delete*/
			FROM	TBCSPDCP206L
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		  	AND 	ACP_YR = #{acpYr}
		    AND 	CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</delete>

	<delete id="CSPDCP412E205206SucDelete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E205206SucDelete */
		<![CDATA[
			DELETE	/*CSPDCP412E205206SucDelete*/
			FROM	TBCSPDCP206L
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (SELECT	SUC_REQ_DVSN_CD
																	,SUC_ACP_YR
																	,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
															)
		]]>
	</delete>

	<resultMap type="java.util.HashMap" id="cspdcpMap2">
 		<result property="reqDvsnCd" column="REQ_DVSN_CD"                   jdbcType="VARCHAR" javaType="java.lang.String" />
		<result property="acpYr" column="ACP_YR"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptAcpNo" column="CVPT_ACP_NO"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpNo" column="ACP_NO"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpDt" column="ACP_DT"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptrNm" column="CVPTR_NM"             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="reqrKndNm" column="REQR_KND_NM"                         jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ad" column="AD"                                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="tnb" column="TNB"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="titNm" column="TIT_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptDocDvsnCd" column="CVPT_DOC_DVSN_CD"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptDocDvsnCd2" column="CVPT_DOC_DVSN_CD2"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptDocDvsnCd3" column="CVPT_DOC_DVSN_CD3"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptDocDvsnCd4" column="CVPT_DOC_DVSN_CD4"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="orgNm" column="ORG_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="coptSgNm" column="COPT_SG_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="dge" column="DGE"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptDocTxt" column="CVPT_DOC_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="cvptDocTxt2" column="CVPT_DOC_TXT2"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="cvptDocTxt3" column="CVPT_DOC_TXT3"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="cvptDocTxt4" column="CVPT_DOC_TXT4"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="cvptOpmApvHndlStaCd" column="CVPT_OPM_APV_HNDL_STA_CD"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="opmTxt" column="OPM_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="cvptOpmSrno" column="CVPT_OPM_SRNO"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="flRutNm" column="FL_RUT_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="sysFlNm" column="SYS_FL_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="onrDocMngCrdId" column="ONR_DOC_MNG_CRD_ID"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="cvptHndlDvsnCd" column="CVPT_HNDL_DVSN_CD"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="onrApvCmptDh" column="ONR_APV_CMPT_DH"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="acpRutNm" column="ACP_RUT_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="acpDptNm" column="ACP_DPT_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="hndlDptNm" column="HNDL_DPT_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="rsltNtfWayNm" column="RSLT_NTF_WAY_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="trnfDptNm" column="TRNF_DPT_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="trnfOrgNm" column="TRNF_ORG_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="jebocnt" column="JEBOCNT"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="title" column="TITLE"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="rpetYn" column="RPET_YN"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="rpetYnCvptDocTxt" column="RPET_YN_CVPT_DOC_TXT"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="fnlHndlDh" column="FNL_HNDL_DH"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="rmAcpKndCd" column="RM_ACP_KND_CD"         jdbcType="VARCHAR"  javaType="java.lang.String" />
 	</resultMap>

	<select id="CSPDCP415PMainSelect" parameterType="paramMap"
		resultMap="cspdcpMap2">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP415PMainSelect */
        <![CDATA[
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, A.ACP_YR||'-'|| F_CODE_NM('1000949', C.RM_ACP_KND_CD) ||'-'||C.RM_CVPT_ACP_NO AS ACP_NO
					, TO_CHAR(C.ACP_DH,'YYYY.MM.DD') AS ACP_DT
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) AS CVPTR_NM
					, DECODE(C.REQR_KND_CD,'2','(기업)','') AS REQR_KND_NM
					, DECODE(C.ZCD,NULL,'','(우)'||C.ZCD||' '||C.AD||' '||C.DTL_AD) AS AD
   					, DECODE(C.TNB,NULL,C.HPN,C.TNB) AS TNB
   					, CASE WHEN	H.SUC_CNT > 0 AND H.SUC_CNT <= 5 THEN C.TIT_NM||(	SELECT	'(합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
							   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
							   								 						WHERE	C.REQ_DVSN_CD = S2.REQ_DVSN_CD
												   								 	AND		C.ACP_YR = S2.ACP_YR
												   								 	AND		C.CVPT_ACP_NO = S2.CVPT_ACP_NO
												   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
												   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
												   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
												   								 )
							WHEN H.SUC_CNT > 5 THEN C.TIT_NM||(	SELECT	'(합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' 외 '||(H.SUC_CNT-5)||'건)'
			   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
			   								 						WHERE	C.REQ_DVSN_CD = S2.REQ_DVSN_CD
								   								 	AND		C.ACP_YR = S2.ACP_YR
								   								 	AND		C.CVPT_ACP_NO = S2.CVPT_ACP_NO
								   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
								   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
								   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
								   								 	AND		ROWNUM <= 5
								   								 )
						ELSE C.TIT_NM END AS TIT_NM
   					, 'A1' AS CVPT_DOC_DVSN_CD
   					, 'A2' AS CVPT_DOC_DVSN_CD2
   					, 'A3' AS CVPT_DOC_DVSN_CD3
   					, 'A4' AS CVPT_DOC_DVSN_CD4
   					, Z.ORG_NM
   					, Z.COPT_SG_NM
   					, #{dge} AS DGE
   					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO
						AND		D1.CVPT_DOC_DVSN_CD = 'A1') AS CVPT_DOC_TXT
					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO
						AND		D1.CVPT_DOC_DVSN_CD = 'A2') AS CVPT_DOC_TXT2
					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO
						AND		D1.CVPT_DOC_DVSN_CD = 'A3') AS CVPT_DOC_TXT3
					, (	SELECT 	D1.CVPT_DOC_TXT
   						FROM	TBCSPDCP203M D1
   						WHERE	A.REQ_DVSN_CD = D1.REQ_DVSN_CD
						AND		A.ACP_YR = D1.ACP_YR
						AND		A.CVPT_ACP_NO = D1.CVPT_ACP_NO
						AND		D1.CVPT_DOC_DVSN_CD = 'A4') AS CVPT_DOC_TXT4
					, D.CVPT_OPM_APV_HNDL_STA_CD
					, E.OPM_TXT
					, D.CVPT_OPM_SRNO
					, F.FL_RUT_NM
					, F.SYS_FL_NM
					, D.ONR_DOC_MNG_CRD_ID
					, G.CVPT_HNDL_DVSN_CD
					, TO_CHAR(D.ONR_APV_CMPT_DH,'YYYY. MM. DD') AS ONR_APV_CMPT_DH
					, F_CODE_NM('1000056',C.ACP_RUT_CD) AS ACP_RUT_NM
					, (	SELECT	S1.DPT_NM
   						FROM 	TBDCMACM002M S1
   						WHERE 	S1.DPT_CD = C.ACP_DPT_CD
   						)  AS ACP_DPT_NM
					, (	SELECT	S1.DPT_NM
   						FROM 	TBDCMACM002M S1
   						WHERE 	S1.DPT_CD = A.HNDL_DPT_CD
   						) AS HNDL_DPT_NM
					,CASE WHEN C.ACP_RUT_CD = '8' THEN F_CODE_NM('1000089',C.RSLT_NTF_WAY_CD)
   						WHEN C.ACP_RUT_CD <> '8' AND C.RSLT_NTF_WAY_CD = '003' THEN F_CODE_NM('1000089',C.RSLT_NTF_WAY_CD)
   						ELSE '홈페이지+'||F_CODE_NM('1000089',C.RSLT_NTF_WAY_CD)  END AS RSLT_NTF_WAY_NM
   					,(	SELECT	S1.DPT_NM
   						FROM 	TBDCMACM002M S1
   						WHERE 	S1.DPT_CD = G.TRNF_DPT_CD
   						) AS TRNF_DPT_NM
   					,(	SELECT	F_ORG_INFO(MIN(S1.ORG_CD),'1') AS ORG_NM
   						FROM	TBCSPDCP206L S1
   						WHERE	G.REQ_DVSN_CD = S1.REQ_DVSN_CD
   						AND		G.ACP_YR = S1.ACP_YR
   						AND		G.CVPT_ACP_NO = S1.CVPT_ACP_NO
   						AND		G.SRNO = S1.SRNO
   						AND		S1.ORG_HIS_DVSN_CD IN ('2','3')
   					) AS TRNF_ORG_NM
   					,(	SELECT	COUNT(*)
   						FROM	TBCSPDCP101M S1
   						WHERE	S1.REQ_DVSN_CD = '1'
   						AND		S1.HPN IS NOT NULL
   						AND		S1.CVPTR_NM = C.CVPTR_NM
   						AND		S1.HPN = C.HPN
   					) AS JEBOCNT
   					,CASE WHEN	H.SUC_CNT > 0 AND H.SUC_CNT <= 5 THEN F_CODE_NM('1000370','C')||' (제'||C.ACP_YR||'-'|| F_CODE_NM('1000949', C.RM_ACP_KND_CD) ||'-'||C.RM_CVPT_ACP_NO||'호) 보고'||(	SELECT	' (합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
																								   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
																								   								 						WHERE	C.REQ_DVSN_CD = S2.REQ_DVSN_CD
																													   								 	AND		C.ACP_YR = S2.ACP_YR
																													   								 	AND		C.CVPT_ACP_NO = S2.CVPT_ACP_NO
																													   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
																													   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
																													   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
					   								 																								)
						WHEN H.SUC_CNT > 5 THEN F_CODE_NM('1000370','C')||' (제'||C.ACP_YR||'-'|| F_CODE_NM('1000949', C.RM_ACP_KND_CD) ||'-'||C.RM_CVPT_ACP_NO||'호) 보고'||(	SELECT	' (합건 : '||AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' 외 '||(H.SUC_CNT-5)||'건)'
																		   								 						FROM	TBCSPDCP105L S2, TBCSPDCP101M S3
																		   								 						WHERE	C.REQ_DVSN_CD = S2.REQ_DVSN_CD
																							   								 	AND		C.ACP_YR = S2.ACP_YR
																							   								 	AND		C.CVPT_ACP_NO = S2.CVPT_ACP_NO
																							   								 	AND		S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
																							   								 	AND		S2.SUC_ACP_YR = S3.ACP_YR
																							   								 	AND		S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
																							   								 	AND		ROWNUM <= 5
  								 																								)
						ELSE F_CODE_NM('1000370','C')||' (제'||C.ACP_YR||'-'|| F_CODE_NM('1000949', C.RM_ACP_KND_CD) ||'-'||C.RM_CVPT_ACP_NO||'호) 보고' END AS TITLE
					,C.RPET_YN AS RPET_YN
					,CASE WHEN RPET_YN = '101' THEN '회신하지 않음'
						WHEN RPET_YN = '102' THEN '회신하지 않음'
						WHEN RPET_YN = '103' THEN '회신하지 않음'
						WHEN RPET_YN = '104' THEN '회신하지 않음'
					ELSE NULL END AS RPET_YN_CVPT_DOC_TXT
					,TO_CHAR(A.FNL_HNDL_DH,'YYYY.MM.DD') AS FNL_HNDL_DH
			FROM	TBCSPDCP201M A
					, TBCSPDCP101M C
					,(	SELECT	Z.REQ_DVSN_CD, Z.ACP_YR, Z.CVPT_ACP_NO
								,CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_INFO(ORG_CD,'1')
								ELSE Z.ORG_NM END AS ORG_NM
								, CASE WHEN Z.OGN_ORG_DVSN_CD = '10' THEN F_ORG_HRK_NM(COPT_SG_CD)
								ELSE NULL END AS COPT_SG_NM
   						FROM	TBCSPDCP206L Z
   						WHERE	Z.REQ_DVSN_CD = #{reqDvsnCd}
   						AND		Z.ACP_YR = #{acpYr}
   						AND		Z.CVPT_ACP_NO = #{cvptAcpNo}
   						AND		Z.ORG_HIS_DVSN_CD ='1'
   						AND		Z.HNDL_ORG_SRNO = (SELECT	MIN(S1.HNDL_ORG_SRNO)
   													FROM	TBCSPDCP206L S1
   													WHERE	S1.REQ_DVSN_CD = #{reqDvsnCd}
							   						AND		S1.ACP_YR = #{acpYr}
							   						AND		S1.CVPT_ACP_NO = #{cvptAcpNo}
							   						AND		S1.ORG_HIS_DVSN_CD ='1'
							   						)
   					) Z
   					, TBCSPDCP301M D
   					, TBCSPDCP302M E
   					, TBDCMACM103L F
   					, TBCSPDCP205L G
   					, (SELECT	#{reqDvsnCd} REQ_DVSN_CD, #{acpYr} ACP_YR, #{cvptAcpNo} CVPT_ACP_NO, COUNT(*) AS SUC_CNT
						FROM	TBCSPDCP105L S1
						WHERE	S1.REQ_DVSN_CD = #{reqDvsnCd}
						AND		S1.ACP_YR = #{acpYr}
						AND		S1.CVPT_ACP_NO = #{cvptAcpNo}
						) H
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
			AND		A.ACP_YR = #{acpYr}
			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
			AND		A.ACP_YR = C.ACP_YR
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = Z.REQ_DVSN_CD(+)
			AND		A.ACP_YR = Z.ACP_YR(+)
			AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO(+)
			AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
			AND		A.ACP_YR = D.ACP_YR(+)
			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
			AND		D.REQ_DVSN_CD = E.REQ_DVSN_CD(+)
			AND		D.ACP_YR = E.ACP_YR(+)
			AND		D.CVPT_ACP_NO = E.CVPT_ACP_NO(+)
			AND		D.CVPT_OPM_SRNO = E.CVPT_OPM_SRNO(+)
			AND		D.CVPT_IFM_DVSN_CD(+) = 'C'
			AND		D.ONR_DOC_MNG_CRD_ID = F.ONR_DOC_MNG_CRD_ID(+)
			AND		F.ONR_APV_FL_DVSN_CD(+) = 'A'
			AND		A.REQ_DVSN_CD = G.REQ_DVSN_CD(+)
			AND		A.ACP_YR = G.ACP_YR(+)
			AND		A.CVPT_ACP_NO = G.CVPT_ACP_NO(+)
			AND G.SRNO(+) = 1
			/*AND		(G.REQ_DVSN_CD, G.ACP_YR, G.CVPT_ACP_NO, G.SRNO) IN (	SELECT	Z.REQ_DVSN_CD, Z.ACP_YR, Z.CVPT_ACP_NO, MIN(Z.SRNO) AS SRNO
																			FROM	TBCSPDCP205L Z
																			WHERE	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
																			AND		A.ACP_YR = Z.ACP_YR
																			AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
																			GROUP BY Z.REQ_DVSN_CD, Z.ACP_YR, Z.CVPT_ACP_NO
																		)*/
			AND		A.REQ_DVSN_CD = H.REQ_DVSN_CD(+)
			AND		A.ACP_YR = H.ACP_YR(+)
			AND		A.CVPT_ACP_NO = H.CVPT_ACP_NO(+)
		]]>
	</select>

	<insert id="CSPDCP415P203Merge" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP415P203Merge */
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,'A1' AS CVPT_DOC_DVSN_CD
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		CVPT_DOC_TXT = #{cvptDocTxt}
        					,FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#{reqDvsnCd}
									,#{acpYr}
									,#{cvptAcpNo}
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #{reqDvsnCd}
										AND		ACP_YR = #{acpYr}
										AND		CVPT_ACP_NO = #{cvptAcpNo}
									)
		        					,'A1'
		        					,#{cvptDocTxt}
		        					,#{dge}
									,#{frtUsrId}
									,#{fnlUsrId}
									,#{fnlDealDptCd}
									,#{fnlMnuId}
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>

	<insert id="CSPDCP415P203Merge2" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP415P203Merge2 */
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,'A2' AS CVPT_DOC_DVSN_CD
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		CVPT_DOC_TXT = #{cvptDocTxt2}
        					,FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#{reqDvsnCd}
									,#{acpYr}
									,#{cvptAcpNo}
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #{reqDvsnCd}
										AND		ACP_YR = #{acpYr}
										AND		CVPT_ACP_NO = #{cvptAcpNo}
									)
		        					,'A2'
		        					,#{cvptDocTxt2}
		        					,#{dge}
									,#{frtUsrId}
									,#{fnlUsrId}
									,#{fnlDealDptCd}
									,#{fnlMnuId}
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>

	<insert id="CSPDCP415P203Merge3" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP415P203Merge3 */
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,'A3' AS CVPT_DOC_DVSN_CD
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		CVPT_DOC_TXT = #{cvptDocTxt3}
        					,FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#{reqDvsnCd}
									,#{acpYr}
									,#{cvptAcpNo}
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #{reqDvsnCd}
										AND		ACP_YR = #{acpYr}
										AND		CVPT_ACP_NO = #{cvptAcpNo}
									)
		        					,'A3'
		        					,#{cvptDocTxt3}
		        					,#{dge}
									,#{frtUsrId}
									,#{fnlUsrId}
									,#{fnlDealDptCd}
									,#{fnlMnuId}
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>

	<insert id="CSPDCP415P203Merge4" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP415P203Merge4 */
        <![CDATA[
        	MERGE INTO 	TBCSPDCP203M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,'A4' AS CVPT_DOC_DVSN_CD
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_DOC_DVSN_CD = B.CVPT_DOC_DVSN_CD
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		CVPT_DOC_TXT = #{cvptDocTxt4}
        					,FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,DOC_SRNO
		        					,CVPT_DOC_DVSN_CD
		        					,CVPT_DOC_TXT
		        					,DGE
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#{reqDvsnCd}
									,#{acpYr}
									,#{cvptAcpNo}
									,(	SELECT	NVL(MAX(DOC_SRNO),0)+1
										FROM	TBCSPDCP203M
										WHERE	REQ_DVSN_CD = #{reqDvsnCd}
										AND		ACP_YR = #{acpYr}
										AND		CVPT_ACP_NO = #{cvptAcpNo}
									)
		        					,'A4'
		        					,#{cvptDocTxt4}
		        					,#{dge}
									,#{frtUsrId}
									,#{fnlUsrId}
									,#{fnlDealDptCd}
									,#{fnlMnuId}
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>
	
	<update id="CSPDCP415P201ANSTXTUPDATE" parameterType="paramMap">
	/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP415P201ANSTXTUPDATE */
	<![CDATA[
			UPDATE	TBCSPDCP201M
			SET		ANS_TXT = #{ansTxt}
		]]>
			<if test='ansTxt2 != null and ansTxt2 != ""'>
			   ,ANS_TXT2 = #{ansTxt2} /* BEST20 2020.09.23 이첩문 추가 */
			 </if>
	  <![CDATA[
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>

	<resultMap type="java.util.HashMap" id="ansMap">
 		<result property="reqDvsnCd" column="REQ_DVSN_CD"                   jdbcType="VARCHAR" javaType="java.lang.String" />
		<result property="acpYr" column="ACP_YR"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptAcpNo" column="CVPT_ACP_NO"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="smgCvptHndlDvsnCd" column="SMG_CVPT_HNDL_DVSN_CD"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="opmNtfDvsnCd" column="OPM_NTF_DVSN_CD"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ntfYn" column="NTF_YN"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptWdwDt" column="CVPT_WDW_DT"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptWdwYn" column="CVPT_WDW_YN"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptHndlStaCd" column="CVPT_HNDL_STA_CD"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ansTxt" column="ANS_TXT"       jdbcType="CLOB"  javaType="java.lang.String" />
		<result property="ansTxt2" column="ANS_TXT2"       jdbcType="CLOB"  javaType="java.lang.String" />
		<result property="acpRutCd" column="ACP_RUT_CD"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="rsltNtfWayCd" column="RSLT_NTF_WAY_CD"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptKndDvsnCd" column="CVPT_KND_DVSN_CD"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="sucCvptHndlStaCd" column="SUC_CVPT_HNDL_STA_CD"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="sucTxt" column="SUC_TXT"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="inspcYn" column="INSPC_YN"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ansDocId" column="ANS_DOC_ID"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="emlId" column="EML_ID"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptOpmApvHndlStaCd" column="CVPT_OPM_APV_HNDL_STA_CD"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hpn" column="HPN"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptOpmSrno" column="CVPT_OPM_SRNO"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="onrDocMngCrdId" column="ONR_DOC_MNG_CRD_ID"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="onrApvCmptDh" column="ONR_APV_CMPT_DH"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="wdwRqsYn" column="WDW_RQS_YN"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="rpetYn" column="RPET_YN"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptHndlDvsnCd" column="CVPT_HNDL_DVSN_CD"       jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hndlYn" column="HNDL_YN"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />

 	</resultMap>
	<select id="CSPDCP412EAnsSelect" parameterType="paramMap"
		resultMap="ansMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EAnsSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, B.SMG_CVPT_HNDL_DVSN_CD
					, NVL(B.OPM_NTF_DVSN_CD,'N') AS OPM_NTF_DVSN_CD
					, OPM_NTF_DVSN_CD AS NTF_YN
					, TO_CHAR(A.CVPT_WDW_DH,'YYYYMMDD') AS  CVPT_WDW_DT
					, DECODE(A.CVPT_WDW_DH,NULL,'N','Y') AS CVPT_WDW_YN
					, A.CVPT_HNDL_STA_CD
					, CASE WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '101' THEN TO_CLOB('회신하지 않음')
						WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '102'  THEN TO_CLOB('회신하지 않음')
						WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '103' THEN TO_CLOB('회신하지 않음')
						WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '104' THEN TO_CLOB('회신하지 않음')
						WHEN B.ANS_TXT IS NULL AND ( A.RPET_YN IS NULL OR A.RPET_YN ='N' ) THEN (SELECT  CVPT_DOC_TXT
																								FROM 	TBCSPDCP203M Z
																								WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
																								AND		A.ACP_YR = Z.ACP_YR
																								AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
																								AND		Z.CVPT_DOC_DVSN_CD = 'A3')
						ELSE B.ANS_TXT END AS ANS_TXT
			        , B.ANS_TXT2  /* BEST20 2020.09.23 이첩문 추가 */
					, A.ACP_RUT_CD
					, A.RSLT_NTF_WAY_CD
					, B.CVPT_KND_DVSN_CD
					, (	SELECT	Z.CVPT_HNDL_STA_CD
						FROM 	TBCSPDCP101M Z
						WHERE 	Z.REQ_DVSN_CD = #{sucReqDvsnCd}
						AND		Z.ACP_YR = #{sucAcpYr}
						AND		Z.CVPT_ACP_NO = #{sucCvptAcpNo}
					  ) AS SUC_CVPT_HNDL_STA_CD
					, '해당감사제보는 [ '||A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO||' ] 와 합건처리되었습니다.' AS SUC_TXT
					/*, (CASE WHEN CVPT_KND_DVSN_CD = '1' THEN ''
						WHEN	CVPT_KND_DVSN_CD = '2' AND (SELECT 	COUNT(*)
															FROM	TBCSPDCP205L Z
															WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
															AND		A.ACP_YR = Z.ACP_YR
															AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
															AND		CVPT_HNDL_DVSN_CD IN ('40')) > 0
								AND B.INSPC_RSLT_TG_YN <> 'Y'
								THEN 'Y' ELSE '' END ) AS INSPC_YN*/
					,''  AS INSPC_YN
					,B.DOC_ID AS ANS_DOC_ID
					,A.EML_ID
					,C.CVPT_OPM_APV_HNDL_STA_CD
					,A.HPN
					,C.CVPT_OPM_SRNO
					,C.ONR_DOC_MNG_CRD_ID
					,TO_CHAR(C.ONR_APV_CMPT_DH,'YYYY.MM.DD HH24:MI') AS ONR_APV_CMPT_DH
					,A.WDW_RQS_YN
					,A.RPET_YN AS RPET_YN
					,(SELECT  Z.CVPT_HNDL_DVSN_CD
					FROM 	TBCSPDCP205L Z
					WHERE	Z.REQ_DVSN_CD = #{reqDvsnCd}
					AND		Z.ACP_YR = #{acpYr}
					AND		Z.CVPT_ACP_NO = #{cvptAcpNo}
					AND     Z.SRNO = (	SELECT  MIN(SRNO)
										FROM 	TBCSPDCP205L X
										WHERE	X.REQ_DVSN_CD = #{reqDvsnCd}
										AND		X.ACP_YR = #{acpYr}
										AND		X.CVPT_ACP_NO = #{cvptAcpNo}
									  )
					) as CVPT_HNDL_DVSN_CD
					,'' as HNDL_YN
			FROM	TBCSPDCP101M A
					, TBCSPDCP201M B
					, TBCSPDCP301M C
			WHERE	A.REQ_DVSN_CD = B.REQ_DVSN_CD
			AND		A.ACP_YR = B.ACP_YR
			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD(+)
			AND		A.ACP_YR = C.ACP_YR(+)
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO(+)
			AND		C.CVPT_IFM_DVSN_CD(+) = 'A'
			
		]]>
	</select>

	<select id="CSPDCP412E603MAnsSelect" parameterType="paramMap"
		resultMap="ansMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E603MAnsSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, B.SMG_CVPT_HNDL_DVSN_CD
					, NVL(B.OPM_NTF_DVSN_CD,'N') AS OPM_NTF_DVSN_CD
					, OPM_NTF_DVSN_CD AS NTF_YN
					, TO_CHAR(A.CVPT_WDW_DH,'YYYYMMDD') AS  CVPT_WDW_DT
					, DECODE(A.CVPT_WDW_DH,NULL,'N','Y') AS CVPT_WDW_YN
					, A.CVPT_HNDL_STA_CD
					, CASE WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '101' THEN TO_CLOB('회신하지 않음')
						WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '102'  THEN TO_CLOB('회신하지 않음')
						WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '103' THEN TO_CLOB('회신하지 않음')
						WHEN B.ANS_TXT IS NULL AND A.RPET_YN = '104' THEN TO_CLOB('회신하지 않음')
						WHEN B.ANS_TXT IS NULL AND ( A.RPET_YN IS NULL OR A.RPET_YN ='N' ) THEN (SELECT  CVPT_DOC_TXT
																								FROM 	TBCSPDCP203M Z
																								WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
																								AND		A.ACP_YR = Z.ACP_YR
																								AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
																								AND		Z.CVPT_DOC_DVSN_CD = 'A3')
						ELSE B.ANS_TXT END AS ANS_TXT
			        , B.ANS_TXT2  /* BEST20 2020.09.23 이첩문 추가 */
					, A.ACP_RUT_CD
					, A.RSLT_NTF_WAY_CD
					, B.CVPT_KND_DVSN_CD
					, (	SELECT	Z.CVPT_HNDL_STA_CD
						FROM 	TBCSPDCP101M Z
						WHERE 	Z.REQ_DVSN_CD = #{sucReqDvsnCd}
						AND		Z.ACP_YR = #{sucAcpYr}
						AND		Z.CVPT_ACP_NO = #{sucCvptAcpNo}
					  ) AS SUC_CVPT_HNDL_STA_CD
					, '해당감사제보는 [ '||A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO||' ] 와 합건처리되었습니다.' AS SUC_TXT
					/*, (CASE WHEN CVPT_KND_DVSN_CD = '1' THEN ''
						WHEN	CVPT_KND_DVSN_CD = '2' AND (SELECT 	COUNT(*)
															FROM	TBCSPDCP205L Z
															WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
															AND		A.ACP_YR = Z.ACP_YR
															AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
															AND		CVPT_HNDL_DVSN_CD IN ('40')) > 0
								AND B.INSPC_RSLT_TG_YN <> 'Y'
								THEN 'Y' ELSE '' END ) AS INSPC_YN*/
					,''  AS INSPC_YN
					,B.DOC_ID AS ANS_DOC_ID
					,A.EML_ID
					,A.HPN
					,A.WDW_RQS_YN
					,A.RPET_YN AS RPET_YN
					,(SELECT  Z.CVPT_HNDL_DVSN_CD
					FROM 	TBCSPDCP205L Z
					WHERE	Z.REQ_DVSN_CD = #{reqDvsnCd}
					AND		Z.ACP_YR = #{acpYr}
					AND		Z.CVPT_ACP_NO = #{cvptAcpNo}
					AND     Z.SRNO = (	SELECT  MIN(SRNO)
										FROM 	TBCSPDCP205L X
										WHERE	X.REQ_DVSN_CD = #{reqDvsnCd}
										AND		X.ACP_YR = #{acpYr}
										AND		X.CVPT_ACP_NO = #{cvptAcpNo}
									  )
					) as CVPT_HNDL_DVSN_CD
					,C.APV_STA_CD AS CVPT_OPM_APV_HNDL_STA_CD
					,C.DOC_ID AS ONR_DOC_MNG_CRD_ID
					,(SELECT TO_CHAR(NVL(APV_DH,''), 'YYYY.MM.DD')
                        FROM TBDCMACM102L T1
                       WHERE T1.ONR_DOC_MNG_CRD_ID = C.APV_RQS_ID
                         AND T1.APV_HIS_SRNO = (SELECT MAX(APV_HIS_SRNO) 
                                                  FROM TBDCMACM102L
                                                 WHERE ONR_DOC_MNG_CRD_ID = C.APV_RQS_ID)) AS ONR_APV_CMPT_DH     
                    ,CASE WHEN G.APV_STA_CD = '3' THEN '2' ELSE '1' END AS HNDL_YN 
			FROM	TBCSPDCP101M A
			INNER JOIN TBCSPDCP201M B ON (A.REQ_DVSN_CD = B.REQ_DVSN_CD
                                            AND     A.ACP_YR = B.ACP_YR
                                            AND     A.CVPT_ACP_NO = B.CVPT_ACP_NO)
            LEFT OUTER JOIN TBCSPDCP603M C ON (B.REQ_DVSN_CD = C.REQ_DVSN_CD
                                            AND     B.ACP_YR = C.ACP_YR
                                            AND     B.CVPT_ACP_NO = C.CVPT_ACP_NO
                                            AND     C.RPRT_CD = 'B10300100' )
            LEFT OUTER JOIN TBCSPDCP603M E ON( A.REQ_DVSN_CD = E.REQ_DVSN_CD
                                                AND		A.ACP_YR = E.ACP_YR
                                                AND		A.CVPT_ACP_NO = E.CVPT_ACP_NO
                                                AND		E.RPRT_CD IN ('B10200400','B10200600')
                                            )
            LEFT OUTER JOIN TBDCMACM022L G ON (E.APV_RQS_ID = G.APV_DOC_NO)
            WHERE 1=1
			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
			
		]]>
	</select>
	
	<!-- 민원처리결과 답변탭 저장시 민원 기본 테이블 UPDATE (취하일시) -->
	<update id="CSPDCP412E101AnsUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E101AnsUpdate */
		<![CDATA[
			UPDATE	/*CSPDCP412E101AnsUpdate*/ TBCSPDCP101M
			SET		CVPT_WDW_DH = DECODE(#{cvptWdwYn},'Y',SYSDATE,NULL)
					,CVPT_HNDL_STA_CD = CASE WHEN #{cvptHndlStaCd} ='41' AND #{opmNtfDvsnCd} = 'N' THEN '40'
						ELSE CVPT_HNDL_STA_CD END
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>

	<!-- 민원처리결과 답변탭 저장시 민원 기본 테이블 UPDATE (취하일시) -->
	<update id="CSPDCP412E101AnsSucUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E101AnsSucUpdate */
		<![CDATA[
			UPDATE	/*CSPDCP412E101AnsSucUpdate*/ TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD = CASE WHEN #{cvptHndlStaCd} ='41' AND #{opmNtfDvsnCd} = 'N' THEN '40'
						ELSE CVPT_HNDL_STA_CD END
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
														)
		]]>
	</update>


	<!-- 처리결과 답변 탭 저장시 처리구분, 통보확인코드,처리결과답변 내용 저장  -->
	<update id="CSPDCP412E201AnsUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E201AnsUpdate */
		<![CDATA[
			UPDATE	/*CSPDCP412E201AnsUpdate*/ TBCSPDCP201M
			SET		SMG_CVPT_HNDL_DVSN_CD = #{smgCvptHndlDvsnCd}
					,OPM_NTF_DVSN_CD = #{opmNtfDvsnCd}
					,ANS_TXT = #{ansTxt}
			]]>		
					<if test='ansTxt2 != null and ansTxt2 != ""'>
			           ,ANS_TXT2 = #{ansTxt2} /* BEST20 2020.09.23 이첩문 추가 */
			       </if>
	     <![CDATA[
					,DOC_ID = #{ansDocId}
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>

	<!-- 처리결과 답변 탭 저장시 처리구분, 통보확인코드,처리결과답변 내용 저장  -->
	<update id="CSPDCP412E201AnsSucUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E201AnsSucUpdate */
		<![CDATA[
			UPDATE	/*CSPDCP412E201AnsSucUpdate*/ TBCSPDCP201M
			SET		SMG_CVPT_HNDL_DVSN_CD = #{smgCvptHndlDvsnCd}
					,OPM_NTF_DVSN_CD = #{opmNtfDvsnCd}
					,ANS_TXT = #{ansTxt}
				]]>		
					<if test='ansTxt2 != null and ansTxt2 != ""'>
			           ,ANS_TXT2 = #{ansTxt2} /* BEST20 2020.09.23 이첩문 추가 */
			       </if>
	     <![CDATA[
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
														)
		]]>
	</update>

	<!-- 처리결과 답변탭에서 취하시 합건된 목록을 삭제함으로써 합건 해지한다. -->
	<delete id="CSPDCP412EAnsSucDelete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EAnsSucDelete */
		<![CDATA[
			DELETE
			FROM	TBCSPDCP105L
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</delete>

	<update id="CSPDCP412E101NtfUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E101NtfUpdate */
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD = CASE WHEN #{cvptWdwYn} = 'Y' THEN '70'
										ELSE '60' END
				   ,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>

	<!-- 합건민원 처리결과 통보시 접수기본 테이블 상태값 UPDATE -->
	<update id="CSPDCP412E101NtfSucUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E101NtfSucUpdate */
		<![CDATA[
			UPDATE	/*CSPDCP412E101NtfSucUpdate*/ TBCSPDCP101M D1
			SET		D1.CVPT_HNDL_STA_CD = ( SELECT  CVPT_HNDL_STA_CD
											FROM	TBCSPDCP101M
											WHERE	REQ_DVSN_CD = #{reqDvsnCd}
											AND		ACP_YR = #{acpYr}
											AND		CVPT_ACP_NO = #{cvptAcpNo}
										  )
                ,   D1.RPET_YN = ( SELECT  RPET_YN
											FROM	TBCSPDCP101M
											WHERE	REQ_DVSN_CD = #{reqDvsnCd}
											AND		ACP_YR = #{acpYr}
											AND		CVPT_ACP_NO = #{cvptAcpNo}
										  )
				,   D1.FNL_MDF_DH = SYSDATE
			WHERE	(D1.REQ_DVSN_CD, D1.ACP_YR,D1.CVPT_ACP_NO ) IN (	SELECT 	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
														  )
		]]>
	</update>

	<insert id="CSPDCP412E202NtfInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E202NtfInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
								  FROM TBCSPDCP202H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #{reqDvsnCd}
							       AND ACP_YR = #{acpYr}
							       AND CVPT_ACP_NO = #{cvptAcpNo}
							 )
							,F_USR_INFO(#{sCnb},'5')
							,F_USR_INFO(#{sCnb},'1')
							,( SELECT  CVPT_HNDL_STA_CD
											FROM	TBCSPDCP101M
											WHERE	REQ_DVSN_CD = #{reqDvsnCd}
											AND		ACP_YR = #{acpYr}
											AND		CVPT_ACP_NO = #{cvptAcpNo}
										  )
							,F_USR_INFO(#{sCnb},'1')
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>

	<!-- 처리결과 통보시 합건자료 배부이력 INSERT -->
	<insert id="CSPDCP412E202NtfSucInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E202NtfSucInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		SELECT	A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO
        				,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
						  	FROM TBCSPDCP202H Z
							WHERE 1=1
					       	AND Z.REQ_DVSN_CD = A.REQ_DVSN_CD
					       	AND Z.ACP_YR = A.ACP_YR
					    	AND Z.CVPT_ACP_NO = A.CVPT_ACP_NO
					 	)
					 	,F_USR_INFO(#{sCnb},'5')
					 	,F_USR_INFO(#{sCnb},'1')
					 	,( SELECT  CVPT_HNDL_STA_CD
											FROM	TBCSPDCP101M
											WHERE	REQ_DVSN_CD = #{reqDvsnCd}
											AND		ACP_YR = #{acpYr}
											AND		CVPT_ACP_NO = #{cvptAcpNo}
										  )
					 	,F_USR_INFO(#{sCnb},'1')
					 	,#{fnlUsrId}
						,#{fnlDealDptCd}
						,#{fnlMnuId}
						,SYSDATE
						,SYSDATE
				FROM	TBCSPDCP101M A
				WHERE	(A.REQ_DVSN_CD, A.ACP_YR,A.CVPT_ACP_NO ) IN (	SELECT 	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
																FROM	TBCSPDCP105L
																WHERE	REQ_DVSN_CD = #{reqDvsnCd}
																AND		ACP_YR = #{acpYr}
																AND		CVPT_ACP_NO = #{cvptAcpNo}
															  )
		]]>
	</insert>

	<update id="CSPDCP412E201NtfUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E201NtfUpdate */
		<![CDATA[
			UPDATE	/*CSPDCP412E201NtfUpdate*/ TBCSPDCP201M D1
			SET		INSPC_RSLT_TG_YN = DECODE(#{opmNtfDvsnCd},'Y','',(DECODE(#{cvptKndDvsnCd},'1','','2','N')))
					,FNL_HNDL_DH = SYSDATE
					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>

	<!-- 처리결과 통보시 합건민원일 경우  사후관리등록 처리 로직-->
	<update id="CSPDCP412E201SucNtfUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E201SucNtfUpdate */
		<![CDATA[
			UPDATE	/*CSPDCP412E201SucNtfUpdate*/ TBCSPDCP201M D1
			SET		INSPC_RSLT_TG_YN = DECODE(#{opmNtfDvsnCd},'Y','',(DECODE(#{cvptKndDvsnCd},'1','','2','N')))
					,SMG_CVPT_HNDL_DVSN_CD = #{smgCvptHndlDvsnCd}
					,OPM_NTF_DVSN_CD = #{opmNtfDvsnCd}
					,FNL_HNDL_DH = SYSDATE
					,FNL_MDF_DH = SYSDATE
			WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO ) IN (	SELECT 	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
															FROM	TBCSPDCP105L
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}
														  )
		]]>
	</update>

	<!-- 처리결과 통보시  민원이메일 기본 테이블 insert-->
	<insert id="CSPDCP412E303NtfInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E303NtfInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP303M
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_EML_HIS_SRNO
        					,DGE
        					,SEN_DH
        					,EML_TXT
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,(	SELECT NVL(MAX(CVPT_EML_HIS_SRNO),0)+1
								  FROM TBCSPDCP303M
								 WHERE 1=1
							       AND REQ_DVSN_CD = #{reqDvsnCd}
							       AND ACP_YR = #{acpYr}
							       AND CVPT_ACP_NO = #{cvptAcpNo}
							 )
							,NULL
							,SYSDATE
							,#{ansTxt}
							,F_USR_INFO(#{sCnb},'1')
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>

	<!-- 처리결과 통보시 합건자료 민원이메일 기본 테이블 insert-->
	<insert id="CSPDCP412E303NtfSucInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E303NtfSucInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP303M
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_EML_HIS_SRNO
        					,DGE
        					,SEN_DH
        					,EML_TXT
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		SELECT	A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO
						,(	SELECT NVL(MAX(Z.CVPT_EML_HIS_SRNO),0)+1
							  FROM TBCSPDCP303M Z
							 WHERE 1=1
						       AND Z.REQ_DVSN_CD = A.REQ_DVSN_CD
						       AND Z.ACP_YR = A.ACP_YR
						       AND Z.CVPT_ACP_NO = A.CVPT_ACP_NO
						 )
						,NULL
						,SYSDATE
						,#{ansTxt}
						,F_USR_INFO(#{sCnb},'1')
						,#{fnlUsrId}
						,#{fnlDealDptCd}
						,#{fnlMnuId}
						,SYSDATE
						,SYSDATE
				FROM	TBCSPDCP101M A
				WHERE	(REQ_DVSN_CD, ACP_YR,CVPT_ACP_NO ) IN (	SELECT 	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
																FROM	TBCSPDCP105L
																WHERE	REQ_DVSN_CD = #{reqDvsnCd}
																AND		ACP_YR = #{acpYr}
																AND		CVPT_ACP_NO = #{cvptAcpNo}
															  )
				AND		RSLT_NTF_WAY_CD = '002'
				AND		EML_ID IS NOT NULL
		]]>
	</insert>

	<resultMap type="java.util.HashMap" id="cspdcp418">
 		<result property="reqDvsnCd" column="REQ_DVSN_CD"                   jdbcType="VARCHAR" javaType="java.lang.String" />
		<result property="acpYr" column="ACP_YR"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptAcpNo" column="CVPT_ACP_NO"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpNo" column="ACP_NO"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptrNm" column="CVPTR_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ad" column="AD"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="zcd" column="ZCD"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptOpmSrno" column="CVPT_OPM_SRNO"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="opmTxt" column="OPM_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="onrDocMngCrdId" column="ONR_DOC_MNG_CRD_ID"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="cvptIfmDvsnCd" column="CVPT_IFM_DVSN_CD"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="title" column="TITLE"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="dge" column="DGE"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="titNm" column="TIT_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="tel" column="TEL"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="flRutNm" column="FL_RUT_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="sysFlNm" column="SYS_FL_NM"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="receiver" column="RECEIVER"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
 	</resultMap>

	<select id="CSPDCP418PMainSelect" parameterType="paramMap"
		resultMap="cspdcp418">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP418PMainSelect */
        <![CDATA[
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, A.ACP_YR||'-'|| F_CODE_NM('1000949', C.RM_ACP_KND_CD) ||'-'||C.RM_CVPT_ACP_NO AS ACP_NO
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) AS CVPTR_NM
					, DECODE(C.ZCD,NULL,NULL,C.AD||' '||C.DTL_AD) AS AD
					, C.ZCD
					, B.CVPT_OPM_SRNO
					, CASE WHEN D.OPM_TXT IS NULL AND #{dge} IS NULL THEN (SELECT  CVPT_DOC_TXT
																			FROM 	TBCSPDCP203M Z
																			WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
																			AND		A.ACP_YR = Z.ACP_YR
																			AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
																			AND		Z.CVPT_DOC_DVSN_CD = 'A3')
						WHEN D.OPM_TXT IS NULL AND #{dge} IS NOT NULL THEN (SELECT  CVPT_DOC_TXT
																			FROM 	TBCSPDCP203M Z
																			WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
																			AND		A.ACP_YR = Z.ACP_YR
																			AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
																			AND		Z.CVPT_DOC_DVSN_CD = 'B4'
																			AND		Z.DGE = #{dge})
						ELSE D.OPM_TXT END AS OPM_TXT
					, B.ONR_DOC_MNG_CRD_ID
					, NVL(B.CVPT_IFM_DVSN_CD,#{cvptIfmDvsnCd}) AS CVPT_IFM_DVSN_CD
					, F_CODE_NM('1000370',NVL(B.CVPT_IFM_DVSN_CD,#{cvptIfmDvsnCd})) AS TITLE
					, #{dge} AS DGE
					, C.TIT_NM
					, DECODE(C.TNB,NULL,C.HPN,C.TNB) AS TEL
					, E.FL_RUT_NM
					, E.SYS_FL_NM
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) || ' 귀하 (우'||C.ZCD || ' ' || C.AD || ' ' || C.DTL_AD || ')' AS RECEIVER
			FROM	TBCSPDCP201M A
					, TBCSPDCP301M B
					, TBCSPDCP101M C
					, TBCSPDCP302M D
					, TBDCMACM103L E
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
			AND		A.ACP_YR = #{acpYr}
			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
			AND		A.ACP_YR = C.ACP_YR
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
			AND		A.ACP_YR = B.ACP_YR(+)
			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			AND		B.CVPT_IFM_DVSN_CD(+) = #{cvptIfmDvsnCd}
			AND		B.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
			AND		B.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
			AND		B.ACP_YR = D.ACP_YR(+)
			AND		B.CVPT_OPM_SRNO = D.CVPT_OPM_SRNO(+)
			AND		B.ONR_DOC_MNG_CRD_ID = E.ONR_DOC_MNG_CRD_ID(+)
		]]>
		<if test='dge != null and dge != ""'>
			AND		B.DGE(+) = #{dge}
		</if>
	</select>

	<select id="CSPDCP418P301KeySelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP418P301KeySelect */
        <![CDATA[
			SELECT 	TO_CHAR(NVL(MAX(TO_NUMBER(CVPT_OPM_SRNO)),0)+1) AS CVPT_OPM_SRNO
			FROM 	TBCSPDCP301M
			WHERE 	1=1
			AND 	REQ_DVSN_CD = #{reqDvsnCd}
			AND 	ACP_YR = #{acpYr}
			AND 	CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</select>


	<update id="CSPDCP418P101Update" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP418P101Update */
		<![CDATA[
			UPDATE	TBCSPDCP101M
			SET		CVPT_HNDL_STA_CD ='41'
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND 	ACP_YR = #{acpYr}
			AND 	CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>

	<insert id="CSPDCP418P301Merge" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP418P301Merge */
        <![CDATA[
        	MERGE INTO 	TBCSPDCP301M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,#{cvptOpmSrno} AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,CVPT_OPM_SRNO
		        					,DGE
		        					,CVPT_IFM_DVSN_CD
		        					,CVPT_OPM_APV_HNDL_STA_CD
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#{reqDvsnCd}
									,#{acpYr}
									,#{cvptAcpNo}
		        					,#{cvptOpmSrno}
		        					,#{dge}
		        					,#{cvptIfmDvsnCd}
		        					,'10'
									,#{frtUsrId}
									,#{fnlUsrId}
									,#{fnlDealDptCd}
									,#{fnlMnuId}
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>

	<insert id="CSPDCP418P302Merge" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP418P302Merge */
        <![CDATA[
        	MERGE INTO 	TBCSPDCP302M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,#{cvptOpmSrno} AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		OPM_TXT = #{opmTxt}
        					,FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,CVPT_OPM_SRNO
		        					,OPM_TXT
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#{reqDvsnCd}
									,#{acpYr}
									,#{cvptAcpNo}
		        					,#{cvptOpmSrno}
		        					,#{opmTxt}
									,#{frtUsrId}
									,#{fnlUsrId}
									,#{fnlDealDptCd}
									,#{fnlMnuId}
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>

	<insert id="CSPDCP412E202InspcInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E202InspcInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
								  FROM TBCSPDCP202H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #{reqDvsnCd}
							       AND ACP_YR = #{acpYr}
							       AND CVPT_ACP_NO = #{cvptAcpNo}
							 )
							,F_USR_INFO(#{sCnb},'5')
							,F_USR_INFO(#{sCnb},'1')
							,'50'
							,F_USR_INFO(#{sCnb},'1')
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>

	<update id="CSPDCP412E201InspcUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E201InspcUpdate */
		<![CDATA[
			UPDATE	TBCSPDCP201M
			SET		INSPC_RSLT_TG_YN = 'Y'
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</update>

	<insert id="CSPDCP412E403InspcInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E403InspcInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP404H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,TG_SEL_HST_SRNO
        					,TG_SEL_DH
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,(	SELECT NVL(MAX(TG_SEL_HST_SRNO),0)+1
								  FROM TBCSPDCP404H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #{reqDvsnCd}
							       AND ACP_YR = #{acpYr}
							       AND CVPT_ACP_NO = #{cvptAcpNo}
							 )
							,SYSDATE
							,F_USR_INFO(#{sCnb},'1')
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)
		]]>
	</insert>

	<select id="CSPDCP412E204LawSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E204LawSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, A.LAW_HIS_SRNO
					, (	SELECT	Z.LAW_NM
						FROM	TBBADCMR013M Z
						WHERE	A.LAW_LNK_ID = Z.LAW_LNK_ID) AS LAW_NM
					, A.LAW_DTL_TXT
					, A.LAW_LNK_ID
			FROM	TBCSPDCP204L A
			WHERE	A.REQ_DVSN_CD = #{reqDvsnCd}
			AND		A.ACP_YR = #{acpYr}
			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
			AND		A.DGE IS NULL
		]]>
	</select>

	<insert id="CSPDCP412E204LawInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E204LawInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP204L
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,LAW_HIS_SRNO
        					,LAW_LNK_ID
        					,DGE
        					,LAW_DTL_TXT
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,(	SELECT 	NVL(MAX(LAW_HIS_SRNO),0)+1
								FROM	TBCSPDCP204L
								WHERE	REQ_DVSN_CD = #{reqDvsnCd}
								AND		ACP_YR = #{acpYr}
								AND		CVPT_ACP_NO = #{cvptAcpNo}
							  )
							,#{lawLnkId}
							,NULL
							,#{lawDtlTxt}
							,F_USR_INFO(#{sCnb},'1')
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)
        ]]>
	</insert>

	<update id="CSPDCP412E204LawUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E204LawUpdate */
		<![CDATA[
			UPDATE	TBCSPDCP204L
			SET		LAW_DTL_TXT = #{lawDtlTxt}
					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
			AND		LAW_LNK_ID = #{lawLnkId}
			AND		LAW_HIS_SRNO = #{lawHisSrno}
		]]>
	</update>

	<delete id="CSPDCP412E204LawDelete" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E204LawDelete */
		<![CDATA[
			DELETE
			FROM	TBCSPDCP204L
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
			AND		LAW_LNK_ID = #{lawLnkId}
			AND		LAW_HIS_SRNO = #{lawHisSrno}
		]]>
	</delete>

	<resultMap type="java.util.HashMap" id="cspdcp414Map">
 		<result property="reqDvsnCd" column="REQ_DVSN_CD"                   jdbcType="VARCHAR" javaType="java.lang.String" />
		<result property="acpYr" column="ACP_YR"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptAcpNo" column="CVPT_ACP_NO"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpNo" column="ACP_NO"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpDh" column="ACP_DH"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpRutNm" column="ACP_RUT_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpRutCd" column="ACP_RUT_CD"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptrNm" column="CVPTR_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ad" column="AD"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="titNm" column="TIT_NM"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptTxt" column="CVPT_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="smgCvptAplNo" column="SMG_CVPT_APL_NO"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="tnb" column="TNB"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="hpn" column="HPN"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="atchYn" column="ATCH_YN"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="docId" column="DOC_ID"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="hndlDocId" column="HNDL_DOC_ID"                         jdbcType="VARCHAR"      javaType="java.lang.String" />
 	</resultMap>
	<select id="CSPDCP414PMainSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP414PMainSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,F_CODE_NM('1000056',A.ACP_RUT_CD) AS ACP_RUT_NM
   					,A.ACP_RUT_CD
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,A.TIT_NM
   					,'Y' AS MAIN_YN
   			FROM	TBCSPDCP101M A
   					,TBCSPDCP102M B
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			UNION
   			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,TO_CHAR(A.ACP_DH,'YYYY.MM.DD HH24:MI') AS ACP_DH
   					,F_CODE_NM('1000056',A.ACP_RUT_CD) AS ACP_RUT_NM
   					,A.ACP_RUT_CD
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,A.TIT_NM
   					,'N' AS MAIN_YN
   			FROM	TBCSPDCP101M D
   					,TBCSPDCP102M B
   					,TBCSPDCP105L C
   					,TBCSPDCP101M A
   			WHERE	1=1
   			AND		D.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		D.ACP_YR = #{acpYr}
   			AND		D.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		D.REQ_DVSN_CD = C.REQ_DVSN_CD
   			AND		D.ACP_YR = C.ACP_YR
   			AND		D.CVPT_ACP_NO = C.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.SUC_REQ_DVSN_CD
   			AND		A.ACP_YR = C.SUC_ACP_YR
   			AND		A.CVPT_ACP_NO = C.SUC_CVPT_ACP_NO
   			ORDER BY MAIN_YN DESC, ACP_DH 
		]]>

	</select>
	
	<select id="CSPDCP414PDetailSelect" parameterType="paramMap"
		resultMap="cspdcp414Map">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP414PDetailSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,F_CODE_NM('1000056',A.ACP_RUT_CD) AS ACP_RUT_NM
   					,A.ACP_RUT_CD
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,DECODE(A.ZCD,NULL,'','(우)'||A.ZCD||' '||A.AD||' '||A.DTL_AD) AS AD
   					,A.TIT_NM
   					,B.CVPT_TXT
   					,A.SMG_CVPT_APL_NO
   					,A.TNB
   					,A.HPN
   					,CASE WHEN	(	SELECT	COUNT(FILE_ID)
  			 						FROM	ECM_FILE_LIST_VIEW2 X
   									WHERE	A.DOC_ID = X.DOC_ID
			   					) > 0 THEN 'Y'
			   		ELSE 'N' END AS ATCH_YN
			   		,A.DOC_ID
                    ,(SELECT DOC_ID FROM TBCSPDCP205L C WHERE A.REQ_DVSN_CD = C.REQ_DVSN_CD
                                                        AND		A.ACP_YR = C.ACP_YR
                                                        AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
                                                        AND     C.SRNO = '1') AS HNDL_DOC_ID 
					,C.AUD_TG_ORG_CD AS AUD_TG_ORG_CD
   			FROM	TBCSPDCP101M A
   			LEFT OUTER JOIN TBCSPDCP104L C ON(   A.REQ_DVSN_CD = C.REQ_DVSN_CD
                                            AND		A.ACP_YR = C.ACP_YR
                                            AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
                                        )
   					,TBCSPDCP102M B
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
		]]>

	</select>
	

	<select id="CSPDCP412EMmsSeqSelect" parameterType="paramMap" resultType="int">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EMmsSeqSelect */
		<![CDATA[
			SELECT MMS_CONTENTS_INFO_SEQ.NEXTVAL AS CONT_SEQ FROM  DUAL
		]]>

	</select>

	<!-- BEST20 접수번호 쿼리 수정 -->
	<insert id="CSPDCP412EMmsMsgInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EMmsMsgInsert */
		<![CDATA[
			INSERT INTO MMS_CONTENTS_INFO
				 	(	CONT_SEQ
				 		, FILE_CNT
				 		, MMS_BODY
				 		, MMS_SUBJECT
				 	)
			VALUES (	#{contSeq}
						, 1
						, #{smsTxt}||'접수번호 : '||(	SELECT (CASE WHEN A.REQ_DVSN_CD = '1' THEN DECODE(A.RM_CVPT_ACP_NO,NULL,'-',A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO) 
																                                               ELSE ACP_YR||'-'||F_CODE_NM('1000740',REQ_DVSN_CD)||'-'||RM_CVPT_ACP_NO
																         END) 
													FROM	TBCSPDCP101M A
													WHERE	REQ_DVSN_CD = #{reqDvsnCd}
													AND		ACP_YR = #{acpYr}
													AND		CVPT_ACP_NO = #{cvptAcpNo})||#{smsTxt2}
						, '감사원 감사제보 문자통보'
					)
		]]>
	</insert>
	
	<!-- BEST20 접수시 접수번호 보내지않음 -->
	<insert id="CSPDCP412EMmsMsgInsert2" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EMmsMsgInsert2 */
		<![CDATA[
			INSERT INTO MMS_CONTENTS_INFO
				 	(	CONT_SEQ
				 		, FILE_CNT
				 		, MMS_BODY
				 		, MMS_SUBJECT
				 	)
			VALUES (	#{contSeq}
						, 1
						, #{smsTxt}
						, '감사원 감사제보 문자통보'
					)
		]]>
	</insert>
	
	<!-- BEST20 접수번호 중간에 삽입 -->
	<insert id="CSPDCP412EMmsMsgInsert3" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EMmsMsgInsert3 */
		<![CDATA[
			INSERT INTO MMS_CONTENTS_INFO
				 	(	CONT_SEQ
				 		, FILE_CNT
				 		, MMS_BODY
				 		, MMS_SUBJECT
				 	)
			VALUES (	#{contSeq}
						, 1
						, #{smsTxt}||'접수번호 : '||(	SELECT (CASE WHEN A.REQ_DVSN_CD = '1' THEN DECODE(A.RM_CVPT_ACP_NO,NULL,'-',A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO) 
																                                               ELSE ACP_YR||'-'||F_CODE_NM('1000740',REQ_DVSN_CD)||'-'||RM_CVPT_ACP_NO
																         END) 
													FROM	TBCSPDCP101M A
													WHERE	REQ_DVSN_CD = #{reqDvsnCd}
													AND		ACP_YR = #{acpYr}
													AND		CVPT_ACP_NO = #{cvptAcpNo}) || #{smsTxt2}
						, '감사원 감사제보 문자통보'
					)
		]]>
	</insert>
	
	<!-- BEST20 신규채번시 문자전송 -->
	<insert id="CSPDCP412EMmsMsgInsert4" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EMmsMsgInsert4 */
		<![CDATA[
			INSERT INTO MMS_CONTENTS_INFO
				 	(	CONT_SEQ
				 		, FILE_CNT
				 		, MMS_BODY
				 		, MMS_SUBJECT
				 	)
			VALUES (	#{contSeq}
						, 1
						, #{smsTxt}||'(구)접수번호 : '||(	SELECT DECODE(A.PRE_RM_CVPT_ACP_NO,NULL,'-',A.ACP_YR||'-'|| F_CODE_NM('1000949', A.PRE_RM_ACP_KND_CD) ||'-'||A.PRE_RM_CVPT_ACP_NO)
															FROM	TBCSPDCP101M A
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}) || CHR(10) || 
										'(신)접수번호 : '||(SELECT DECODE(A.RM_CVPT_ACP_NO,NULL,'-',A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO)
														  	FROM	TBCSPDCP101M A
															WHERE	REQ_DVSN_CD = #{reqDvsnCd}
															AND		ACP_YR = #{acpYr}
															AND		CVPT_ACP_NO = #{cvptAcpNo}) || #{smsTxt2}
						, '감사원 감사제보 문자통보'
					)
		]]>
	</insert>

	<insert id="CSPDCP412E416MmsMsgInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E416MmsMsgInsert */
		<![CDATA[
			INSERT INTO MMS_CONTENTS_INFO
				 	(	CONT_SEQ
				 		, FILE_CNT
				 		, MMS_BODY
				 		, MMS_SUBJECT
				 	)
			VALUES (	#{contSeq}
						, 1
						, #{smsTxt}||#{acpNo}
						, '감사원 감사제보 문자통보'
					)
		]]>
	</insert>

	<insert id="CSPDCP412EMsgInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EMsgInsert */
		<![CDATA[
			INSERT INTO MSG_DATA
				 	(	MSG_SEQ
				 		, CUR_STATE
				 		, REQ_DATE
				 		, CALL_TO
				 		, CALL_FROM
				 		, SMS_TXT
				 		, MSG_TYPE
				 		, CONT_SEQ
				 	)
			VALUES (	MSG_DATA_SEQ.NEXTVAL
						, 0
						, SYSDATE
						, REPLACE(#{hpn},'-','')
						, (
							SELECT CASE WHEN S1.USR_DFN_TXT_1 IS NULL THEN '02-2011-2191'
									        WHEN LENGTH(S1.USR_DFN_TXT_1) > 4 THEN S1.USR_DFN_TXT_1
										    ELSE '02-2011-' || S1.USR_DFN_TXT_1 END 
   								  FROM 	TBDCMACM013C S1
   								 WHERE S1.CMM_CD_DVSN_CD = '1000144'
   								   AND   S1.CD = ( SELECT S2.RAL_BLT_DIV_CD 
                                          			FROM TBDCMACM001M S2
                                         			WHERE USR_ID = #{fnlUsrId}
                                        		)
   						  )  
						, ''
						, 6
						, #{contSeq}
					)
		]]>
	</insert>

	<insert id="CSPDCP412E304MsgInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E304MsgInsert */
		<![CDATA[
			INSERT INTO	TBCSPDCP304L
						(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_SMS_TRNM_HIS_SRNO
							,TRNM_HPN
							,RPL_TNB
							,SMS_TXT
							,TRNM_DH
							,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
       			VALUES	(	#{reqDvsnCd}
       						,#{acpYr}
       						,#{cvptAcpNo}
							,(	SELECT NVL(MAX(CVPT_SMS_TRNM_HIS_SRNO),0)+1
								  FROM TBCSPDCP304L
								 WHERE 1=1
							       AND REQ_DVSN_CD = #{reqDvsnCd}
							       AND ACP_YR = #{acpYr}
							       AND CVPT_ACP_NO = #{cvptAcpNo}
							 )
							,(	SELECT	S1.TNB
   						FROM 	TBDCMACM002M S1
   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
   						)
							,#{hpn}
							,#{smsTxt}
							,SYSDATE
							,F_USR_INFO(#{sCnb},'1')
							,F_USR_INFO(#{sCnb},'1')
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)

		]]>
	</insert>

	<insert id="CSPDCP412ESmgInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412ESmgInsert */
		<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,'500'
							,'N'
							,(	SELECT	SUBSTR(STND_DPT_CD,9,7)
		   						FROM 	TBDCMACM002M S1
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						) 
							,(	SELECT	S2.ALL_ORG_NM
		   						FROM 	TBDCMACM002M S1
		   								,TBCSPIIT006M S2
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						AND		S2.GCC_ORG_CD = SUBSTR(S1.STND_DPT_CD,9,7)
		   						AND ROWNUM = 1
		   						)  
							,F_USR_INFO(#{sCnb},'2')
							,''
							,'02-2011-2191'
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M
				WHERE	REQ_DVSN_CD = #{reqDvsnCd}
				AND		ACP_YR = #{acpYr}
				AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</insert>

	<update id="CSPDCP411PDCP301ONRUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP411PDCP301ONRUpdate */
		<![CDATA[
			UPDATE	TBCSPDCP301M
			SET		ONR_DOC_MNG_CRD_ID = #{onrDocMngCrdId}
					,ONR_APV_RQS_DH = SYSDATE
					,ADMN_INF_HNDL_NO = #{admnInfHndlNo}
					,CVPT_OPM_APV_HNDL_STA_CD = '20'
					,FNL_USR_ID = #{fnlUsrId}
					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
					,FNL_MNU_ID = #{fnlMnuId}
					,FNL_MDF_DH = SYSDATE
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
			AND		CVPT_OPM_SRNO = #{cvptOpmSrno}
		]]>
	</update>

	<insert id="CSPDCP416ESmgInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416ESmgInsert */
		<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,'500'
							,'N'
							,(	SELECT	SUBSTR(STND_DPT_CD,9,7)
		   						FROM 	TBDCMACM002M S1
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						)  
							,(	SELECT	S2.ALL_ORG_NM
		   						FROM 	TBDCMACM002M S1
		   								,TBCSPIIT006M S2
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						AND		S2.GCC_ORG_CD = SUBSTR(S1.STND_DPT_CD,9,7)
		   						AND ROWNUM = 1
		   						) 
							,F_USR_INFO(#{sCnb},'2')
							,''
							,'02-2011-2191'
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M
				WHERE	REQ_DVSN_CD = #{sucReqDvsnCd}
				AND		ACP_YR = #{sucAcpYr}
				AND		CVPT_ACP_NO = #{sucCvptAcpNo}
		]]>
	</insert>


	<insert id="CSPDCP412ESmgNtfInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412ESmgNtfInsert */
		<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_CONTENTS		/*민원 처리결과 내용*/
							,PCD_REG_DATE		/*처리일자*/
							,PCD_CONTENTS_ATTACH_YN	/*민원처리결과첨부여부*/
							,PCD_GUBUN			/*신문고민원 처리구분코드*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,DECODE(SMG_FRT_HNDL_STA_CD, '161','181', '163','183')
							,'N'
							,(	SELECT	SUBSTR(STND_DPT_CD,9,7)
		   						FROM 	TBDCMACM002M S1
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						)  
							,(	SELECT	S2.ALL_ORG_NM
		   						FROM 	TBDCMACM002M S1
		   								,TBCSPIIT006M S2
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						AND		S2.GCC_ORG_CD = SUBSTR(S1.STND_DPT_CD,9,7)
		   						AND ROWNUM = 1
		   						) 
							,F_USR_INFO(#{sCnb},'2')
							,''
							, NVL((	SELECT S1.USR_DFN_TXT_1
   								  FROM 	TBDCMACM013C S1
   								 WHERE S1.CMM_CD_DVSN_CD = '1000144'
   								   AND   S1.CD = ( SELECT S2.RAL_BLT_DIV_CD 
                                          			FROM TBDCMACM001M S2
                                         			WHERE USR_ID = #{fnlUsrId}
                                        		)
   								) ,'02-2011-2191')   
							,CASE WHEN RPET_YN = '103' AND (#{ansTxt} IS NULL OR #{ansTxt} ='') THEN '회신하지 않음'
							      ELSE #{ansTxt}
							      END 
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'N'
							,#{smgCvptHndlDvsnCd}
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M
				WHERE	REQ_DVSN_CD = #{reqDvsnCd}
				AND		ACP_YR = #{acpYr}
				AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</insert>

	<insert id="CSPDCP412ESmgSucNtfInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412ESmgSucNtfInsert */
		<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_CONTENTS		/*민원 처리결과 내용*/
							,PCD_REG_DATE		/*처리일자*/
							,PCD_CONTENTS_ATTACH_YN	/*민원처리결과첨부여부*/
							,PCD_GUBUN			/*신문고민원 처리구분코드*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				SELECT	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
						,SMG_FRT_CVPT_APL_GCC_ORG_CD
							,SMG_CVPT_APL_NO
							,SMG_CAT_HST_SRNO
							,SMG_CVPT_ACP_NO
							,DECODE(SMG_FRT_HNDL_STA_CD, '161','181', '163','183')
							,'N'
							,(	SELECT	SUBSTR(STND_DPT_CD,9,7)
		   						FROM 	TBDCMACM002M S1
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						) 
							,(	SELECT	S2.ALL_ORG_NM
		   						FROM 	TBDCMACM002M S1
		   								,TBCSPIIT006M S2
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						AND		S2.GCC_ORG_CD = SUBSTR(S1.STND_DPT_CD,9,7)
		   						AND ROWNUM = 1
		   						)  
							,F_USR_INFO(#{sCnb},'2')
							,''
							, NVL((	SELECT S1.USR_DFN_TXT_1
   								  FROM 	TBDCMACM013C S1
   								 WHERE S1.CMM_CD_DVSN_CD = '1000144'
   								   AND   S1.CD = ( SELECT S2.RAL_BLT_DIV_CD 
                                          			FROM TBDCMACM001M S2
                                         			WHERE USR_ID = #{fnlUsrId}
                                        		)
   								) ,'02-2011-2191')   
							,CASE WHEN RPET_YN ='103' AND (#{ansTxt} IS NULL OR #{ansTxt} ='') 
								  THEN '회신하지 않음'
							      ELSE #{ansTxt}
							      END 
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'N'
							,#{smgCvptHndlDvsnCd}
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
				FROM	TBCSPDCP101M A
				WHERE	(REQ_DVSN_CD, ACP_YR, CVPT_ACP_NO) IN (	SELECT	SUC_REQ_DVSN_CD, SUC_ACP_YR, SUC_CVPT_ACP_NO
																FROM	TBCSPDCP105L
																WHERE 	REQ_DVSN_CD = #{reqDvsnCd}
																AND		ACP_YR = #{acpYr}
																AND		CVPT_ACP_NO = #{cvptAcpNo}
															  )
				AND		A.ACP_RUT_CD = '8'
		]]>
	</insert>

	<!-- 처리전 온나라 결재시 시행문 테이블 Merge -->
	<insert id="CSPDCP415POnr301Merge" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP415POnr301Merge */
		<![CDATA[
			MERGE INTO 	TBCSPDCP301M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,#{cvptOpmSrno} AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		CVPT_OPM_APV_HNDL_STA_CD = '10'
        					,ADMN_INF_HNDL_NO = #{admnInfHndlNo}
        					,ONR_DOC_MNG_CRD_ID = #{onrDocMngCrdId}
        					,FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
				INSERT 	(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_OPM_SRNO
							,DGE
							,CVPT_IFM_DVSN_CD
	       					,CVPT_OPM_APV_HNDL_STA_CD
	       					,ADMN_INF_HNDL_NO
	       					,ONR_DOC_MNG_CRD_ID
	       					,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
	       				)
	       		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,#{cvptOpmSrno}
							,NULL
							,'C'
	       					,'10'
	       					,#{admnInfHndlNo}
	       					,#{onrDocMngCrdId}
	       					,#{frtUsrId}
	       					,#{fnlUsrId}
	       					,#{fnlDealDptCd}
	       					,#{fnlMnuId}
	       					,SYSDATE
	       					,SYSDATE
	       				)
		]]>
	</insert>

	<insert id="CSPDCP415POnr302Merge" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP415POnr302Merge */
		<![CDATA[
			MERGE INTO 	TBCSPDCP302M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,#{cvptOpmSrno} AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		OPM_TXT = #{opmTxt}
        					,FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
				INSERT 	(	REQ_DVSN_CD
							,ACP_YR
							,CVPT_ACP_NO
							,CVPT_OPM_SRNO
	       					,OPM_TXT
	       					,FRT_USR_ID
	       					,FNL_USR_ID
	       					,FNL_DEAL_DPT_CD
	       					,FNL_MNU_ID
	       					,FRT_REGI_DH
	       					,FNL_MDF_DH
		       				)
		       		VALUES	(	#{reqDvsnCd}
								,#{acpYr}
								,#{cvptAcpNo}
								,#{cvptOpmSrno}
								,#{opmTxt}
		       					,#{frtUsrId}
		       					,#{fnlUsrId}
		       					,#{fnlDealDptCd}
		       					,#{fnlMnuId}
		       					,SYSDATE
		       					,SYSDATE
		       				)
		]]>
	</insert>

	<select id="CSPDCP412E206NtfSucCheckSelect" parameterType="paramMap" resultType="int">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E206NtfSucCheckSelect */
		<![CDATA[
			SELECT	/*CSPDCP412E206NtfSucCheckSelect*/
					COUNT(*) AS CNT
			FROM	TBCSPDCP105L D1
			WHERE	D1.REQ_DVSN_CD = #{reqDvsnCd}
			AND		D1.ACP_YR = #{acpYr}
			AND		D1.CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</select>

	<select id="CSPDCP418POnrUserInfoSelect" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP418POnrUserInfoSelect */
		<![CDATA[
			SELECT	/*CSPDCP418POnrUserInfoSelect*/
					D1.USR_ID,
					D1.EML_AD,
					(	SELECT	SUBSTR(STND_DPT_CD,9,7)
		   						FROM 	TBDCMACM002M S1
		   						WHERE 	S1.DPT_CD = D1.DPT_CD
		   						)  AS DEPT_CD,
					D2.FRML_DPT_NM AS DEPT_NM,
					'CSPDCP' AS BIZ_GUBUN,
					D1.USR_NAM,
					D1.RANK_NM_2 AS POSITION_NM
			FROM	TBDCMACM001M D1
					,TBDCMACM002M D2
			WHERE 	USR_ID = #{fnlUsrId}
			AND		D1.DPT_CD = D2.DPT_CD
		]]>
	</select>

	<resultMap type="java.util.HashMap" id="CSPDCP412E301OnnaraSelectMap">
 		<result property="reqDvsnCd"      column="REQ_DVSN_CD" jdbcType="VARCHAR" javaType="java.lang.String" />
		<result property="acpYr"           column="ACP_YR" jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptAcpNo"      column="CVPT_ACP_NO" jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpNo"           column="ACP_NO" jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptrNm"         column="CVPTR_NM" jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ad"               column="AD" jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="zcd" 				column="ZCD" jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptOpmSrno" 	column="CVPT_OPM_SRNO" jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="opmTxt" 				column="OPM_TXT" jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="onrDocMngCrdId" 	column="ONR_DOC_MNG_CRD_ID" jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="cvptIfmDvsnCd" 	column="CVPT_IFM_DVSN_CD" jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="title" 				column="TITLE" jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="dge" 					column="DGE" jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="titNm" 				column="TIT_NM" jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="tel" 					column="TEL" jdbcType="VARCHAR"      javaType="java.lang.String" />
		<result property="receiver" 			column="RECEIVER" jdbcType="VARCHAR"      javaType="java.lang.String" />
 	</resultMap>

	<select id="CSPDCP412E301OnnaraSelect" parameterType="paramMap"
		resultMap="CSPDCP412E301OnnaraSelectMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E301OnnaraSelect */
        <![CDATA[
			SELECT	A.REQ_DVSN_CD
					, A.ACP_YR
					, A.CVPT_ACP_NO
					, A.ACP_YR||'-'|| F_CODE_NM('1000949', C.RM_ACP_KND_CD) ||'-'||C.RM_CVPT_ACP_NO AS ACP_NO
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) AS CVPTR_NM
					, DECODE(C.ZCD,NULL,NULL,C.AD||' '||C.DTL_AD) AS AD
					, C.ZCD
					, B.CVPT_OPM_SRNO
					, CASE WHEN #{dge} IS NULL THEN A.ANS_TXT
						WHEN #{dge} IS NOT NULL THEN (SELECT  Z.ANS_TXT
														FROM 	TBCSPDCP401H Z
														WHERE 	A.REQ_DVSN_CD = Z.REQ_DVSN_CD
														AND		A.ACP_YR = Z.ACP_YR
														AND		A.CVPT_ACP_NO = Z.CVPT_ACP_NO
														AND		Z.DGE = #{dge})
						ELSE NULL END AS OPM_TXT
					, B.ONR_DOC_MNG_CRD_ID
					, NVL(B.CVPT_IFM_DVSN_CD,#{cvptIfmDvsnCd}) AS CVPT_IFM_DVSN_CD
					, F_CODE_NM('1000370',NVL(B.CVPT_IFM_DVSN_CD,#{cvptIfmDvsnCd}))||' (제'||A.ACP_YR||'-'|| F_CODE_NM('1000949', C.RM_ACP_KND_CD) ||'-'||C.RM_CVPT_ACP_NO||'호)' AS TITLE
					, #{dge} AS DGE
					, C.TIT_NM
					, DECODE(C.TNB,NULL,C.HPN,C.TNB) AS TEL
					, DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) || ' 귀하 (우'||C.ZCD || ' ' || C.AD || ' ' || C.DTL_AD || ')' AS RECEIVER
			FROM	TBCSPDCP201M A
					, TBCSPDCP301M B
					, TBCSPDCP101M C
					, TBCSPDCP302M D
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
			AND		A.ACP_YR = #{acpYr}
			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
			AND		A.ACP_YR = C.ACP_YR
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
			AND		A.ACP_YR = B.ACP_YR(+)
			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			AND		B.CVPT_IFM_DVSN_CD(+) = #{cvptIfmDvsnCd}
			AND		B.REQ_DVSN_CD = D.REQ_DVSN_CD(+)
			AND		B.CVPT_ACP_NO = D.CVPT_ACP_NO(+)
			AND		B.ACP_YR = D.ACP_YR(+)
			AND		B.CVPT_OPM_SRNO = D.CVPT_OPM_SRNO(+)
		]]>
		<if test='dge != null and dge != ""'>
			AND		B.DGE(+) = #{dge}
		</if>
	</select>
	
	<select id="CSPDCP412EOnnaraSelect" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EOnnaraSelect */
        <![CDATA[
			SELECT  DECODE(C.REQR_KND_CD,'1',C.CVPTR_NM,'2',C.RPST_PEN_NM,'3',C.RPST_PEN_NM,'4',C.CVPTR_NM) AS CVPTR_NM
					, DECODE(C.ZCD,NULL,NULL,C.AD||' '||C.DTL_AD) AS AD
					, C.ZCD
					, DECODE(C.TNB,NULL,C.HPN,C.TNB) AS TEL
			FROM	TBCSPDCP201M A
					, TBCSPDCP101M C
			WHERE	1=1
			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
			AND		A.ACP_YR = #{acpYr}
			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD
			AND		A.ACP_YR = C.ACP_YR
			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
		]]>
	</select>

	<!-- 시행문 작성 온나라결재 -->
	<insert id="CSPDCP412E301OnnaraMerge" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412E301OnnaraMerge */
        <![CDATA[
        	MERGE INTO 	TBCSPDCP301M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,#{cvptOpmSrno} AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		ONR_DOC_MNG_CRD_ID = #{onrDocMngCrdId}
        					,ADMN_INF_HNDL_NO = #{admnInfHndlNo}
        					,FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,CVPT_OPM_SRNO
		        					,DGE
		        					,CVPT_IFM_DVSN_CD
		        					,CVPT_OPM_APV_HNDL_STA_CD
		        					,ADMN_INF_HNDL_NO
		        					,ONR_DOC_MNG_CRD_ID
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        				)
		        		VALUES	(	#{reqDvsnCd}
									,#{acpYr}
									,#{cvptAcpNo}
		        					,#{cvptOpmSrno}
		        					,#{dge}
		        					,#{cvptIfmDvsnCd}
		        					,'10'
		        					,#{admnInfHndlNo}
		        					,#{onrDocMngCrdId}
									,#{frtUsrId}
									,#{fnlUsrId}
									,#{fnlDealDptCd}
									,#{fnlMnuId}
									,SYSDATE
									,SYSDATE
								)
        ]]>
	</insert>

	<insert id="CSPDCP416P205SucInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P205SucInsert */
		<![CDATA[
			INSERT INTO	/*CSPDCP412E205SucInsert*/
						TBCSPDCP205L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,SRNO
        					,CVPT_HNDL_DVSN_CD
        					,AUD_RFR_MTRL_TRNF_DPT_CD
        					,TRNF_DPT_CD
        					,DOC_ID
        					,DOC_TYP_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		SELECT	#{sucReqDvsnCd}
	        			,#{sucAcpYr}
	        			,#{sucCvptAcpNo}
       					,SRNO
       					,CVPT_HNDL_DVSN_CD
       					,AUD_RFR_MTRL_TRNF_DPT_CD
       					,TRNF_DPT_CD
       					,DOC_ID
       					,DOC_TYP_CD
       					,FRT_USR_ID
       					,FNL_USR_ID
       					,FNL_DEAL_DPT_CD
       					,FNL_MNU_ID
       					,SYSDATE
       					,SYSDATE
        		FROM	TBCSPDCP205L
        		WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN ( 	SELECT	#{reqDvsnCd},#{acpYr},#{cvptAcpNo}
        														FROM 	DUAL )
		]]>
	</insert>

	<insert id="CSPDCP416P206SucInsert" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416P206SucInsert */
		<![CDATA[
			INSERT INTO	/*CSPDCP416P206SucInsert*/
						TBCSPDCP206L
						(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,HNDL_ORG_SRNO
        					,ORG_HIS_DVSN_CD
        					,SRNO
        					,ORG_CD
        					,PUB_DVSN_CD
        					,COPT_SG_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        					,ORG_NM
        					,OGN_ORG_DVSN_CD
        				)
        	SELECT	#{sucReqDvsnCd}
        			,#{sucAcpYr}
        			,#{sucCvptAcpNo}
        			,HNDL_ORG_SRNO
        			,ORG_HIS_DVSN_CD
        			,SRNO
  					,ORG_CD
  					,PUB_DVSN_CD
  					,COPT_SG_CD
  					,FRT_USR_ID
  					,FNL_USR_ID
  					,FNL_DEAL_DPT_CD
  					,FNL_MNU_ID
  					,SYSDATE
  					,SYSDATE
  					,ORG_NM
  					,OGN_ORG_DVSN_CD
        	FROM	TBCSPDCP206L
        	WHERE	(REQ_DVSN_CD,ACP_YR,CVPT_ACP_NO) IN ( 	SELECT	#{reqDvsnCd},#{acpYr},#{cvptAcpNo}
        													FROM 	DUAL )
		]]>
	</insert>

	<select id="CSPDCP412EAudInfTrfDvsnCdCheckSelect" parameterType="paramMap" resultType="int">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EAudInfTrfDvsnCdCheckSelect */
		<![CDATA[
			SELECT	/*CSPDCP412EAudInfTrfDvsnCdCheckSelect*/
					COUNT(*) AS CNT
			FROM	TBCSPDCP205L D1
			WHERE	D1.REQ_DVSN_CD = #{reqDvsnCd}
			AND		D1.ACP_YR = #{acpYr}
			AND		D1.CVPT_ACP_NO = #{cvptAcpNo}
			AND		D1.SRNO = (SELECT	MIN(SRNO)
								FROM	TBCSPDCP205L S1
								WHERE	D1.REQ_DVSN_CD = #{reqDvsnCd}
								AND		D1.ACP_YR = #{acpYr}
								AND		D1.CVPT_ACP_NO = #{cvptAcpNo})
			AND		D1.CVPT_HNDL_DVSN_CD = '50'
		]]>
	</select>



	<select id="CSPDCP412EWdwCheckSelect" parameterType="paramMap" resultType="int">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EWdwCheckSelect */
		<![CDATA[
			SELECT	COUNT(*) AS CNT
			FROM	TBCSPDCP105L
			WHERE	REQ_DVSN_CD	= #{reqDvsnCd}
			AND		ACP_YR	= #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>

	</select>

	<select id="CSPDCP412ESucCount" parameterType="paramMap" resultType="int">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412ESucCount */
		<![CDATA[
			SELECT	COUNT(*) AS CNT
			FROM	TBCSPDCP105L
			WHERE	REQ_DVSN_CD	= #{reqDvsnCd}
			AND		ACP_YR	= #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</select>

	<select id="CSPDCP412EOnrSucSelect" parameterType="paramMap" resultType="egovMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EOnrSucSelect */
		<![CDATA[
			SELECT	SUC_REQ_DVSN_CD AS REQ_DVSN_CD , SUC_ACP_YR AS ACP_YR, SUC_CVPT_ACP_NO AS CVPT_ACP_NO
			FROM	TBCSPDCP105L
			WHERE	REQ_DVSN_CD	= #{reqDvsnCd}
			AND		ACP_YR	= #{acpYr}
			AND		CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	</select>

	<!-- 강제 취하 처리 한다. -->
	<update id="CSPDCP412EWdwOkSaveUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EWdwOkSaveUpdate */
		UPDATE	TBCSPDCP101M D1
		SET		D1.CVPT_HNDL_STA_CD ='70'
				,D1.FNL_MDF_DH = SYSDATE
				,D1.FNL_USR_ID = #{fnlUsrId}
				,D1.FNL_DEAL_DPT_CD = #{fnlDealDptCd}
				,D1.FNL_MNU_ID = #{fnlMnuId}
		WHERE	D1.REQ_DVSN_CD = #{reqDvsnCd}
 		AND		D1.ACP_YR = #{acpYr}
 		AND		D1.CVPT_ACP_NO = #{cvptAcpNo}
	</update>

	<select id="CSPDCP412EMsgCheckYn" parameterType="paramMap" resultType="String">
		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412EMsgCheckYn */
		SELECT	RPET_YN AS RPET_YN
		FROM	TBCSPDCP101M
		WHERE	REQ_DVSN_CD = #{reqDvsnCd}
		AND		ACP_YR = #{acpYr}
		AND		CVPT_ACP_NO = #{cvptAcpNo}
	</select>

	<update id="CSPDCP412ECvptDocUpdate" parameterType="paramMap">
	/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412ECvptDocUpdate */
		MERGE INTO 	TBCSPDCP301M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        						,'1' AS CVPT_OPM_SRNO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        				AND A.CVPT_OPM_SRNO = B.CVPT_OPM_SRNO
        			)
       	WHEN MATCHED THEN

		UPDATE
			SET		ONR_DOC_MNG_CRD_ID = 'testDocId1'
	    			,CVPT_OPM_APV_HNDL_STA_CD = '30'
	    			,CVPT_IFM_DVSN_CD = 'C'
					,FNL_MDF_DH = SYSDATE
					,FNL_USR_ID = #{fnlUsrId}
					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
					,FNL_MNU_ID = #{fnlMnuId}
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
	 		AND		ACP_YR = #{acpYr}
	 		AND		CVPT_ACP_NO = #{cvptAcpNo}

 		WHEN NOT MATCHED THEN
	 		INSERT
				(	REQ_DVSN_CD
					,ACP_YR
					,CVPT_ACP_NO
					,CVPT_OPM_SRNO
					,ONR_DOC_MNG_CRD_ID
					,CVPT_OPM_APV_HNDL_STA_CD
					,FNL_MDF_DH
					,FNL_USR_ID
					,FNL_DEAL_DPT_CD
					,FNL_MNU_ID
					,FRT_USR_ID
					,FRT_REGI_DH
					,CVPT_IFM_DVSN_CD
				)
	       	VALUES	(	#{reqDvsnCd}
	       			,#{acpYr}
	       			,#{cvptAcpNo}
	       			,'1'
	       			,'testDocId1'
	       			,'30'
	       			,SYSDATE
	       			,#{fnlUsrId}
	       			,#{fnlDealDptCd}
	       			,#{fnlMnuId}
	       			,#{fnlUsrId}
	       			,SYSDATE
	       			,'C'
	       			)
	</update>

	<select id="CSPDCP422ESelectHndlDvsnCd" parameterType="paramMap" resultType="egovMap">
		SELECT SRNO
		    , CVPT_HNDL_DVSN_CD
		    , MAX(DECODE(RID, 1, ACP_STEP_CD)) ACP_STEP_CD1
		    , MAX(DECODE(RID, 2, ACP_STEP_CD)) ACP_STEP_CD2
		FROM(
		    SELECT 
		        SRNO
		        , CVPT_HNDL_DVSN_CD
		        , ROW_NUMBER() OVER(PARTITION BY SRNO, CVPT_HNDL_DVSN_CD ORDER BY ACP_STEP_CD) RID, ACP_STEP_CD
		    FROM (
		        SELECT 
		            MAX(C.SRNO)             AS SRNO
		            , C.CVPT_HNDL_DVSN_CD   AS CVPT_HNDL_DVSN_CD
		            , SUBSTR(A.ACP_STEP_CD, 1, 2) AS ACP_STEP_CD
		        FROM TBCSPDCP601M A
		        INNER JOIN TBCSPDCP201M B on(   A.ACP_YR = B.ACP_YR 
		                                        AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
		                                        AND A.CVPT_ACP_NO = B.CVPT_ACP_NO   )
		        LEFT OUTER JOIN TBCSPDCP205L C ON (A.REQ_DVSN_CD = C.REQ_DVSN_CD
                                            AND		A.ACP_YR = C.ACP_YR
                                            AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
                                            AND (C.SRNO = (SELECT 	MIN(D.SRNO)
                                                            FROM 	TBCSPDCP205L D
                                                            WHERE 	D.REQ_DVSN_CD = #{reqDvsnCd}
                                                            AND		D.ACP_YR = #{acpYr}
                                                            AND		D.CVPT_ACP_NO = #{cvptAcpNo} ) OR C.SRNO IS NULL ))
		        WHERE A.ACP_YR = #{acpYr}
		        AND A.REQ_DVSN_CD = #{reqDvsnCd}
		        AND A.CVPT_ACP_NO = #{cvptAcpNo}
		        GROUP BY C.CVPT_HNDL_DVSN_CD, SUBSTR(A.ACP_STEP_CD, 1, 2)
		    )
		) GROUP BY SRNO, CVPT_HNDL_DVSN_CD
	</select>
	
	<select id="selectDtilAudDocNo" parameterType="paramMap" resultType="string">
	/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.selectDtilAudDocNo */
		SELECT DTIL_AUD_DOC_NO 
        FROM (
            SELECT MAX(C.SRNO)
                , CASE WHEN C.CVPT_HNDL_DVSN_CD = '10' THEN '289'
                        WHEN C.CVPT_HNDL_DVSN_CD = '20' THEN '290'
                        WHEN C.CVPT_HNDL_DVSN_CD = '30' THEN '291'
                        WHEN C.CVPT_HNDL_DVSN_CD = '40' THEN '291'
                        WHEN C.CVPT_HNDL_DVSN_CD = '50' THEN '293'
                        WHEN C.CVPT_HNDL_DVSN_CD = '60' THEN '292'
                        WHEN C.CVPT_HNDL_DVSN_CD = '70' THEN '292'
                        WHEN C.CVPT_HNDL_DVSN_CD = '80' THEN '292'
                        WHEN C.CVPT_HNDL_DVSN_CD = '90' THEN '291'
                        ELSE '288' END AS DTIL_AUD_DOC_NO
                FROM TBCSPDCP205L C
                LEFT OUTER JOIN TBCSPDCP602M D 
                ON(
                    C.ACP_YR = D.ACP_YR 
                    AND C.REQ_DVSN_CD = D.REQ_DVSN_CD 
                    AND C.CVPT_ACP_NO = D.CVPT_ACP_NO
                    AND C.SRNO = D.SRNO
                ) 
                WHERE C.ACP_YR = #{acpYr}
                AND C.REQ_DVSN_CD = #{reqDvsnCd}
                AND C.CVPT_ACP_NO = #{cvptAcpNo}
                AND (C.ACP_YR , C.REQ_DVSN_CD, C.CVPT_ACP_NO, C.SRNO)
                                                        	IN ( SELECT S1.ACP_YR, S1.REQ_DVSN_CD, S1.CVPT_ACP_NO, MIN(S1.SRNO)  
                                                        	       FROM TBCSPDCP205L S1
                                                        	      WHERE S1.ACP_YR = #{acpYr}
                                                        	        AND S1.REQ_DVSN_CD = #{reqDvsnCd}
                                                        	        AND S1.CVPT_ACP_NO = #{cvptAcpNo}
                                                        	        GROUP BY S1.ACP_YR, S1.REQ_DVSN_CD, S1.CVPT_ACP_NO
                                                        	    ) 
                GROUP BY (CASE WHEN C.CVPT_HNDL_DVSN_CD = '10' THEN '289'
                               WHEN C.CVPT_HNDL_DVSN_CD = '20' THEN '290'
                               WHEN C.CVPT_HNDL_DVSN_CD = '30' THEN '291'
                               WHEN C.CVPT_HNDL_DVSN_CD = '40' THEN '291'
                               WHEN C.CVPT_HNDL_DVSN_CD = '50' THEN '293'
                               WHEN C.CVPT_HNDL_DVSN_CD = '60' THEN '292'
                               WHEN C.CVPT_HNDL_DVSN_CD = '70' THEN '292'
                               WHEN C.CVPT_HNDL_DVSN_CD = '80' THEN '292'
                               WHEN C.CVPT_HNDL_DVSN_CD = '90' THEN '291'
                               ELSE '288' END)
          ) 
	</select>
	
	<select id="selectMainListPrcs" parameterType="paramMap" resultMap="cspdcpMap">
	/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.selectMainListPrcs */
	<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
					,A.RM_ACP_KND_CD
   					,A.CVPT_ACP_NO
   					,A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
   					,F_CODE_NM('1000047',A.CVPT_KND_CD) AS CVPT_KND_NM
   					,(	SELECT	S1.DPT_NM
   						FROM 	TBDCMACM002M S1
   						WHERE 	S1.DPT_CD = A.ACP_DPT_CD
   						) ||'/'||F_USR_INFO_BY_ID(A.RCEP_ID,'2') AS ACP_NM
   					,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
   					,NVL2(A.ACP_RUT_DTL_CD,F_CODE_NM('1000056',A.ACP_RUT_CD) || '(' || F_CODE_NM('1000359',A.ACP_RUT_DTL_CD) || ')',F_CODE_NM('1000056',A.ACP_RUT_CD)) AS ACP_RUT_NM
   					,A.ACP_RUT_CD
   					,F_CODE_NM('1000358',A.REQR_KND_CD) AS REQR_KND_NM
   					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
   					,A.OPEN_YN
   					,DECODE(A.CVPT_WDW_DH,NULL,'N','Y') AS WIDW_YN
   					,DECODE(A.ZCD,NULL,'','(우)'||A.ZCD||' '||A.AD||' '||A.DTL_AD) AS AD
   					,A.TNB
   					,A.HPN
   					,CASE WHEN A.ACP_RUT_CD = '8' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						WHEN A.ACP_RUT_CD <> '8' AND A.RSLT_NTF_WAY_CD = '003' THEN F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)
   						ELSE '홈페이지+'||F_CODE_NM('1000089',A.RSLT_NTF_WAY_CD)  END AS RSLT_NTF_WAY_NM
   					,C.CLM_NM
   					,C.WRK_PLAC_NM
   					,C.TNB AS CLM_TNB
   					,DECODE(C.ZCD,NULL,'','(우)'||C.ZCD||' '||C.AD||' '||C.DTL_AD) AS CLM_AD
   					,B.CVPT_TXT
   					,A.CVPT_HNDL_STA_CD
   					,A.DOC_ID
   					,A.CVPT_KND_CD
   					,NVL(A.CVPT_KND_DVSN_CD,NVL(D.CVPT_KND_DVSN_CD,DECODE(A.CVPT_KND_CD,'카','2','1'))) AS CVPT_KND_DVSN_CD
   					,A.TIT_NM
   					,D.PASV_ADMN_YN
   					,D.REF_YN
   					/*,CASE WHEN  E.CVPT_OPM_APV_HNDL_STA_CD <> '30' OR E.CVPT_OPM_APV_HNDL_STA_CD IS NULL THEN '1'
   							WHEN E.CVPT_OPM_APV_HNDL_STA_CD = '30' THEN '2'
   							ELSE '3' END AS HNDL_YN*/
   					,F_CODE_NM('1000361',A.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
   					,CASE WHEN	(	SELECT	COUNT(FILE_ID)
  			 						FROM	ECM_FILE_LIST_VIEW2 X
   									WHERE	A.DOC_ID = X.DOC_ID
			   					) > 0 THEN '첨부파일 있음'
			   		ELSE '첨부파일 없음' END AS ATCH_YN
   					,TO_CHAR(A.CVPT_WDW_DH,'YYYY-MM-DD HH24:MI') AS CVPT_WDW_DH
   					,A.CVPT_WDW_RSN
   					,A.RPET_YN AS RPET_YN
			   		,A.WDW_RQS_YN
                    ,CASE WHEN NVL(E.APV_STA_CD,'10') = '10' THEN 'N' ELSE 'Y' END AS CVPT_DOC_YN    /*문서 작성여부*/
                    ,CASE WHEN G.APV_STA_CD = '3' THEN '2' ELSE '1' END AS HNDL_YN      /*결재완료여부 2: 완료*/
                    ,TO_CHAR(G.SBM_DH,'YYYY-MM-DD HH24:MI') AS ONR_APV_RQS_DH           /*결재상신일시*/
                    ,CASE WHEN G.APV_STA_CD = '3' THEN TO_CHAR(G.FNL_APV_DH,'YYYY-MM-DD HH24:MI') ELSE '' END AS ONR_APV_CMPT_DH    /*결재완료일시*/
                    ,TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYY-MM-DD') AS HNDL_DDLN_DT
                    ,TO_CHAR(TO_DATE(A.BK_HNDL_DDLN_DT),'YYYY-MM-DD') AS BK_HNDL_DDLN_DT
                    ,NVL(A.SCEN_CFM_EXTN_DCN,0) AS SCEN_CFM_EXTN_DCN
                    ,NVL(A.NTF_EXTN_DCN,0) AS NTF_EXTN_DCN
                    ,NVL(A.INNER_YN,'N') AS INNER_YN
                    ,A.INNER_ORG_NM
                    ,F_CODE_NM('1000894', A.DOC_WRIT_KND_CD) AS DOC_TYPE  
                    ,KYWD_NM_1
                    ,KYWD_NM_2
                    ,KYWD_NM_3
                    ,KYWD_NM_4
                    ,KYWD_NM_5
                    ,(SELECT	Z.USR_DFN_TXT_1
   						FROM	TBDCMACM013C Z
   						WHERE	Z.CMM_CD_DVSN_CD ='1000948'
   						AND		Z.CD = A.TG_ORG_CAT_CD) AS TG_ORG_CAT_CD1
   					,(SELECT	Z.USR_DFN_TXT_2
   						FROM	TBDCMACM013C Z
   						WHERE	Z.CMM_CD_DVSN_CD ='1000948'
   						AND		Z.CD = A.TG_ORG_CAT_CD) AS TG_ORG_CAT_CD2
   					,A.TG_ORG_CAT_CD  AS TG_ORG_CAT_CD3
   					,(SELECT	F_CODE_NM('1000946',Z.USR_DFN_TXT_1) || '/' || F_CODE_NM('1000947',Z.USR_DFN_TXT_2) || '/' || Z.CD_NM     
   						FROM	TBDCMACM013C Z
   						WHERE	Z.CMM_CD_DVSN_CD ='1000948'
   						AND		Z.CD = A.TG_ORG_CAT_CD) AS TG_ORG_CAT_NM
                    ,A.MAIN_FUNC_CAT_CD
                    ,F_CODE_NM('1000950',A.MAIN_FUNC_CAT_CD) AS MAIN_FUNC_CAT_NM
                    ,H.AUD_TG_ORG_CD AS AUD_TG_ORG_CD
                    ,A.RPET_YN
   			FROM	TBCSPDCP101M A
   			INNER JOIN TBCSPDCP102M B ON(   A.REQ_DVSN_CD = B.REQ_DVSN_CD
                                            AND		A.ACP_YR = B.ACP_YR
                                            AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
                                        )
   			LEFT OUTER JOIN TBCSPDCP103M C ON(   A.REQ_DVSN_CD = C.REQ_DVSN_CD
                                            AND		A.ACP_YR = C.ACP_YR
                                            AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO
                                        )
   			INNER JOIN TBCSPDCP201M D ON (A.REQ_DVSN_CD = D.REQ_DVSN_CD
                                            AND		A.ACP_YR = D.ACP_YR
                                            AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO
                                        )
   			LEFT OUTER JOIN TBCSPDCP205L F ON (A.REQ_DVSN_CD = F.REQ_DVSN_CD
                                            AND		A.ACP_YR = F.ACP_YR
                                            AND		A.CVPT_ACP_NO = F.CVPT_ACP_NO
                                            AND (F.SRNO = (SELECT 	MIN(SRNO)
                                                            FROM 	TBCSPDCP205L A
                                                            WHERE 	A.REQ_DVSN_CD = #{reqDvsnCd}
                                                            AND		A.ACP_YR = #{acpYr}
                                                            AND		A.CVPT_ACP_NO = #{cvptAcpNo} ) OR F.SRNO IS NULL )
                                        )
            LEFT OUTER JOIN TBCSPDCP603M E ON( A.REQ_DVSN_CD = E.REQ_DVSN_CD
                                                AND		A.ACP_YR = E.ACP_YR
                                                AND		A.CVPT_ACP_NO = E.CVPT_ACP_NO
                                                AND		E.RPRT_CD IN ('B10200400','B10200600')
                                            )
			LEFT OUTER JOIN TBCSPDCP104L H ON(   A.REQ_DVSN_CD = H.REQ_DVSN_CD
                                            AND		A.ACP_YR = H.ACP_YR
                                            AND		A.CVPT_ACP_NO = H.CVPT_ACP_NO
                                        )
            LEFT OUTER JOIN TBDCMACM022L G ON (E.APV_RQS_ID = G.APV_DOC_NO)
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
		]]>
	
	</select>
	
	<select id="selectAudBztList" parameterType="paramMap" resultType="egovMap">
		SELECT        
              F_MNG_KND_AUDYRNO(A.AUD_YR, A.AUD_NO, B.AUD_KND_CD, '-')||'(' ||C.AUD_STEP_SNO || ')'  AS AUD_YR_NO  /*감사번호*/
              ,C.BZT_SNO /*출장순번*/
              ,C.AUD_BZT_KND_CD /*출장종류코드*/
              ,F_CODE_NM ('1000030', C.AUD_BZT_KND_CD) AS AUD_BZT_KND_NM /*감사출장종류코드*/
              ,C.TIT_TXT /*출장제목*/
              ,to_char(to_date(C.AUD_STR_DT,'YYYY.MM.DD'),'YYYY-MM-DD') AS AUD_STR_DT /*출장시작일*/
              ,to_char(to_date(C.AUD_END_DT,'YYYY.MM.DD'),'YYYY-MM-DD') AS AUD_END_DT /*출장종료일*/
              ,to_char(to_date(C.AUD_STR_DT,'YYYY.MM.DD'),'YYYY-MM-DD') || ' ~ ' || to_char(to_date(C.AUD_END_DT,'YYYY.MM.DD'),'YYYY-MM-DD') as AUD_DT
              ,C.BZT_BRDV_CD  /*출장부서코드*/
              ,(	SELECT	S1.DPT_NM
					FROM 	TBDCMACM002M S1
					WHERE 	S1.DPT_CD = C.BZT_BRDV_CD
					)  AS SPV_BRDV_NM  /*출장부서명*/
              ,A.AUD_YR
              ,A.AUD_NO 
              ,C.AUD_STEP_SNO
              ,A.ACP_YR
              ,A.CVPT_ACP_NO
              ,A.REQ_DVSN_CD
        FROM  TBCSPDCP207L A
        INNER JOIN TBBADDED002M C ON (A.AUD_YR = C.REL_AUD_YR
                                     AND A.AUD_NO = C.REL_AUD_NO
                                     AND A.AUD_STEP_SNO = C.AUD_STEP_SNO)
        INNER JOIN TBBADDED001M B ON (B.AUD_YR = A.AUD_YR
                                     AND B.AUD_NO = A.AUD_NO)
        WHERE 1=1
          AND A.ACP_YR = #{acpYr}
          AND A.REQ_DVSN_CD = #{reqDvsnCd}
          AND A.CVPT_ACP_NO = #{cvptAcpNo}
	</select>
	
	<select id="selectDocCmptCheck" parameterType="paramMap" resultType="egovMap">
	SELECT DOC_ID, RPRT_CD
	  FROM TBCSPDCP603M
	 WHERE ACP_YR = #{acpYr}
	   AND CVPT_ACP_NO = #{cvptAcpNo}
	   AND REQ_DVSN_CD = #{reqDvsnCd}
	   <if test='apvStaCd != null and apvStaCd != ""'>
	   AND APV_STA_CD = #{apvStaCd}
	   </if>
	</select>
	
	<select id="selectSucNo" parameterType="paramMap" resultType="String">
		 SELECT NVL2(T1.TXT, '합건:'||T1.TXT , '') 
		 FROM (
				 SELECT CASE WHEN COUNT(*) > 10 THEN MIN(B3.RM_CVPT_ACP_NO)||' 외 '||(COUNT(*)-1)||'건' ELSE AGGR_CONCAT(B3.RM_CVPT_ACP_NO , ',') END AS TXT
				 FROM TBCSPDCP105L B2,
		               TBCSPDCP101M B3
		         WHERE B2.SUC_ACP_YR = B3.ACP_YR
		           AND B2.SUC_CVPT_ACP_NO = B3.CVPT_ACP_NO
		           AND B2.SUC_REQ_DVSN_CD = B3.REQ_DVSN_CD
                  AND B2.REQ_DVSN_CD = #{reqDvsnCd}
                  AND B2.ACP_YR = #{acpYr}
                  AND B2.CVPT_ACP_NO = #{cvptAcpNo} ) T1
	</select>
	
	<select id="selectSubSucNo" parameterType="paramMap" resultType="String">
		 SELECT NVL2(T1.TXT, '합건(처리과):'||T1.TXT , '') 
		 FROM (
				 SELECT CASE WHEN COUNT(*) > 10 THEN MIN(B3.RM_CVPT_ACP_NO)||' 외 '||(COUNT(*)-1)||'건' ELSE AGGR_CONCAT(B3.RM_CVPT_ACP_NO , ',') END AS TXT
				 FROM TBCSPDCP953L B2,
		               TBCSPDCP101M B3
		         WHERE B2.SUC_ACP_YR = B3.ACP_YR
		           AND B2.SUC_CVPT_ACP_NO = B3.CVPT_ACP_NO
		           AND B2.SUC_REQ_DVSN_CD = B3.REQ_DVSN_CD
                  AND B2.REQ_DVSN_CD = #{reqDvsnCd}
                  AND B2.ACP_YR = #{acpYr}
                  AND B2.CVPT_ACP_NO = #{cvptAcpNo} ) T1
	</select>
	
	<select id="selectSucMsgList" parameterType="paramMap" resultType="egovMap">
	SELECT T2.HPN, T2.REQ_DVSN_CD, T2.ACP_YR, T2.CVPT_ACP_NO
	  FROM TBCSPDCP105L T1, TBCSPDCP101M T2
	 WHERE 1=1
	   AND T1.REQ_DVSN_CD = #{reqDvsnCd}
	   AND T1.ACP_YR = #{acpYr}
	   AND T1.CVPT_ACP_NO = #{cvptAcpNo}
	   AND T1.SUC_REQ_DVSN_CD = T2.REQ_DVSN_CD
	   AND T1.SUC_ACP_YR = T2.ACP_YR
	   AND T1.SUC_CVPT_ACP_NO = T2.CVPT_ACP_NO
	   AND HPN IS NOT NULL
	</select>
	
	
	<update id="CSPDCP416PSucHndlDdlnDtUpdate" parameterType="paramMap">
   		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416PSucHndlDdlnDtUpdate */
	   	<![CDATA[
	   		UPDATE TBCSPDCP101M
	   		   SET HNDL_DDLN_DT = F_GET_NEXT_WORK_DT(TO_CHAR(ACP_DH,'YYYYMMDD'),30+NVL(NTF_EXTN_DCN,0)+NVL(SCEN_CFM_EXTN_DCN,0))
	   		      ,BK_HNDL_DDLN_DT = HNDL_DDLN_DT
	   		 WHERE REQ_DVSN_CD = #{sucReqDvsnCd}
	   		   AND ACP_YR = #{sucAcpYr}
	   		   AND CVPT_ACP_NO = #{sucCvptAcpNo}
	   	]]>
   	</update>
   	
   	<!-- 접수일자 + 30일 -->
   	<select id="CSPDCP416PSelectMaxAcpDh" parameterType="paramMap" resultType="String">
   		<![CDATA[
   			/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416PSelectMaxAcpDh */
   			SELECT F_GET_NEXT_WORK_DT(TO_CHAR(MAX(ACP_DH),'YYYYMMDD'),30)  FROM (
					SELECT ACP_DH
					  FROM TBCSPDCP101M T1, TBCSPDCP105L T2
					 WHERE T1.REQ_DVSN_CD = T2.SUC_REQ_DVSN_CD
					   AND T1.ACP_YR = T2.SUC_ACP_YR
					   AND T1.CVPT_ACP_NO = T2.SUC_CVPT_ACP_NO
					   AND T2.REQ_DVSN_CD = #{reqDvsnCd}
					   AND T2.ACP_YR = #{acpYr}
					   AND T2.CVPT_ACP_NO = #{cvptAcpNo}
					UNION ALL
					SELECT ACP_DH
					  FROM TBCSPDCP101M T1
					 WHERE T1.REQ_DVSN_CD =#{reqDvsnCd}
					   AND T1.ACP_YR = #{acpYr}
					   AND T1.CVPT_ACP_NO =#{cvptAcpNo}
				)   
   		]]>
   	</select>
   	
   	<update id="CSPDCP416PHndlDdlnDtUpdate" parameterType="paramMap">
   		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416PHndlDdlnDtUpdate */
	   	<![CDATA[
	   		UPDATE TBCSPDCP101M T1
	   		   SET HNDL_DDLN_DT = #{acpDh}
                  , SCEN_CFM_EXTN_DCN = 0
                  , NTF_EXTN_DCN = 0
	   		   	  ,BK_HNDL_DDLN_DT = #{acpDh}
	   		 WHERE T1.REQ_DVSN_CD =#{reqDvsnCd}
			   AND T1.ACP_YR = #{acpYr}
			   AND T1.CVPT_ACP_NO =#{cvptAcpNo}
	   	]]>
   	</update>
   	
   	<!-- 기존 CSPDCP416PHndlDdlnDtUpdate 백업 -->
   	<update id="CSPDCP416PHndlDdlnDtUpdate2" parameterType="paramMap">
   		/* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP416PHndlDdlnDtUpdate */
	   	<![CDATA[
	   		UPDATE TBCSPDCP101M T1
	   		   SET HNDL_DDLN_DT = F_GET_NEXT_WORK_DT(#{acpDh}, (
                                       CASE
                                         WHEN NVL(NTF_EXTN_DCN, 0) != 0
                   and NVL(SCEN_CFM_EXTN_DCN, 0) = 0 THEN TO_CHAR(NVL(NTF_EXTN_DCN, 0)+1)
                                         WHEN NVL(SCEN_CFM_EXTN_DCN, 0) != 0
                   and NVL(NTF_EXTN_DCN, 0) = 0 THEN TO_CHAR(NVL(SCEN_CFM_EXTN_DCN, 0)+1)
                                         ELSE TO_CHAR(NVL(NTF_EXTN_DCN, 0)+NVL(SCEN_CFM_EXTN_DCN, 0)+1)
                                       end ) )
	   		   	  ,BK_HNDL_DDLN_DT = #{acpDh}
	   		 WHERE T1.REQ_DVSN_CD =#{reqDvsnCd}
			   AND T1.ACP_YR = #{acpYr}
			   AND T1.CVPT_ACP_NO =#{cvptAcpNo}
	   	]]>
   	</update>
   	
   	<select id="CSPDCP416PSelectHndlDdlDt" parameterType="paramMap" resultType="String">
   		<![CDATA[
   			SELECT HNDL_DDLN_DT
   			  FROM TBCSPDCP101M T1
   			 WHERE 1=1
   			   AND T1.REQ_DVSN_CD = #{reqDvsnCd}
			   AND T1.ACP_YR = #{acpYr}
			   AND T1.CVPT_ACP_NO = #{cvptAcpNo}
   		]]>
   	</select>
   	
   	<update id="CSPDCP416PSucAllHndlDdlnDtUpdate" parameterType="paramMap">
   		<![CDATA[
   			UPDATE TBCSPDCP101M T1
   			   SET HNDL_DDLN_DT = #{hndlDdlnDt}
   			      ,BK_HNDL_DDLN_DT = HNDL_DDLN_DT
   			 WHERE 1=1
   			   AND (T1.REQ_DVSN_CD, T1.ACP_YR, T1.CVPT_ACP_NO) 
   			      IN (SELECT S1.SUC_REQ_DVSN_CD, S1.SUC_ACP_YR, S1.SUC_CVPT_ACP_NO
   			            FROM TBCSPDCP105L S1
   			           WHERE S1.REQ_DVSN_CD = #{reqDvsnCd} 
   			             AND S1.ACP_YR = #{acpYr}
   			             AND S1.CVPT_ACP_NO = #{cvptAcpNo}
   			        )
   		]]>
   	</update>
   	
   	<!-- BEST20 2020.09.15 이송(대내)시 배부부서 조회 -->
   	<select id="selectTrnfDptList" parameterType="paramMap" resultType="egovMap">
   		<![CDATA[
   			SELECT T1.SRNO
				    , T1.TRNF_DPT_CD
				    , T2.DPT_NM                          AS TRNF_DPT_NM
				    , F_DPT_INFO(T2.HIRK_DPT_CD,'1') AS HIRK_DPT_NM/*상위부서명*/
			  FROM TBCSPDCP205L T1
		        LEFT OUTER JOIN
			          TBDCMACM002M T2
			     ON T2.DPT_CD = T1.TRNF_DPT_CD
   			 WHERE 1=1
   			   AND T1.REQ_DVSN_CD = #{reqDvsnCd}
			   AND T1.ACP_YR = #{acpYr}
			   AND T1.CVPT_ACP_NO = #{cvptAcpNo}
			   /*2025.03.07 추가*/
			   AND T1.CVPT_HNDL_DVSN_CD = '70'
			   AND T1.TRNF_DPT_CD IS NOT NULL
		    ORDER BY
		             T1.SRNO
   		]]>
   	</select>
   	
   	<!-- BEST20 감사원 기관정보 조회 -->
   	<select id="selectBaiOrgInfo" parameterType="paramMap" resultType="egovMap">
   		<![CDATA[
   			SELECT CASE
	          WHEN USE_DVSN_NO='N' THEN '(*)'||ORG_CD
	           ELSE  ORG_CD
	           END AS ORG_CD_YN
	            , ORG_CD
	            , ORG_NM
	            , RGN_CD
	            , F_CODE_NM('1000001',RGN_CD) AS RGN_NM
	            , ORG_DVSN_CD
	            , F_CODE_NM('1000119',ORG_DVSN_CD) AS ORG_DVSN_NM
	            , ORG_DGE_CD
	            , F_CODE_NM('1000346',ORG_DGE_CD) AS ORG_DGE_NM
	            , COPT_SG_CD
	            , F_ORG_HRK_NM(COPT_SG_CD) AS COPT_SG_NM
	            , TNB
	            , ZCD
	            , AD
	            , DTL_AD
				, ROAD_NM_AD
	            , ROAD_NM_DTL_AD
	            , USE_DVSN_NO
	            , ENFM_DPT_CD
	            , ORG_CAT_CD
	            , PUB_DVSN_CD
	            , (SELECT	F_CODE_NM('1000447',Z.USR_DFN_TXT_1)
	   						FROM	TBDCMACM013C Z
	   						WHERE	Z.CMM_CD_DVSN_CD ='1000128'
	   						AND		Z.CD =PUB_DVSN_CD) AS PUB_DVSN_NM
	         FROM TBDCMACM015M
	        WHERE ORG_CD = '011000000000' /* 감사원 */
		      AND USE_DVSN_NO = 'Y'
   		]]>
   	</select>
   	
   	<select id="callusrInfo" parameterType="paramMap" resultType="egovMap">
		SELECT USR_ID,RAL_BLT_DIV_CD,TNB
		  FROM TBDCMACM001M
		 WHERE USR_ID = #{usrId}
	</select>
	
	<select id="CSPDCP412ESubSelect" parameterType="paramMap"
        resultType="egovMap">
        /* kr.go.bai.eip.csp.dcp.dao.CSPDCP411Mapper.CSPDCP412ESubSelect */
        <![CDATA[
	        SELECT AA.*
	        FROM
	            (SELECT  A.REQ_DVSN_CD
	                    ,A.ACP_YR
	                    ,A.CVPT_ACP_NO
	                    ,A.RM_CVPT_ACP_NO
	                    ,DECODE(A.RM_CVPT_ACP_NO,NULL,'',A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO) AS ACP_NO
	                    ,A.CVPT_KND_CD
	                    ,F_CODE_NM('1000047', A.CVPT_KND_CD) AS CVPT_KND_NM
	                    ,A.TIT_NM
	                    ,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
	                    ,TO_CHAR(A.ACP_DH,'YYYY-MM-DD HH24:MI') AS ACP_DH
	                    ,(  SELECT S1.CD_NM
							  FROM TBDCMACM013C S1
							 WHERE S1.CMM_CD_DVSN_CD = '1000144'
							   AND S1.CD = B.RAL_BLT_DIV_CD  
	                        )  AS HNDL_DPT_NM
	                    ,B.HNDL_DPT_CD
	                    ,F_USR_INFO_BY_ID(B.HNDL_CHGR_ID,'2') AS HNDL_CHGR_NM
	                    ,B.HNDL_CHGR_ID
	                    ,A.CVPT_HNDL_STA_CD
	                    ,F_CODE_NM('1000361',A.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
	                    ,(  SELECT  S1.DPT_NM
	                        FROM    TBDCMACM002M S1
	                        WHERE   S1.DPT_CD = A.ACP_DPT_CD
	                        )  AS ACP_DPT_NM
	                    , F_CODE_NM('1000894', A.DOC_WRIT_KND_CD) AS DOC_TYPE /* 편집기 구분  */
	                    , COUNT(1) OVER() AS TOT_CNT
	            FROM    TBCSPDCP101M A
	                    ,TBCSPDCP201M B
	                    ,(  SELECT  A.CVPTR_NM, A.RPST_PEN_NM, A.HPN, A.TNB
	                        FROM    TBCSPDCP101M A
	                        WHERE   A.REQ_DVSN_CD = #{reqDvsnCd}
	                        AND     A.ACP_YR = #{acpYr}
	                        AND     A.CVPT_ACP_NO = #{cvptAcpNo}
	                    ) C
	            WHERE   1=1
	            AND     A.REQ_DVSN_CD = '1'
	            AND     A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
	            AND     A.ACP_YR = B.ACP_YR(+)
	            AND     A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
	            AND     A.REQR_KND_CD <> '4'
	            AND     NOT EXISTS (
	                        SELECT  ''
	                        FROM    TBCSPDCP101M Z
	                        WHERE   Z.REQ_DVSN_CD = #{reqDvsnCd}
	                        AND     Z.ACP_YR = #{acpYr}
	                        AND     Z.CVPT_ACP_NO = #{cvptAcpNo}
	                        AND     Z.REQ_DVSN_CD = A.REQ_DVSN_CD
	                        AND     Z.ACP_YR = A.ACP_YR
	                        AND     Z.CVPT_ACP_NO = A.CVPT_ACP_NO
	                    )
	        ]]>
	               <if test='reqrKndCd == "4"'>
	                AND ( A.HPN = C.HPN 
	                OR A.TNB =  C.TNB
	                OR A.HPN = C.TNB
	                 OR A.TNB = C.HPN
	                ) 
	            </if> 
	            <![CDATA[
	                AND(
	                       (A.CVPTR_NM = C.CVPTR_NM AND A.HPN = C.HPN )
	                     OR(A.CVPTR_NM = C.CVPTR_NM AND A.TNB = C.TNB)
	                     OR(A.RPST_PEN_NM = C.RPST_PEN_NM AND A.HPN = C.HPN )
	                     OR(A.RPST_PEN_NM = C.RPST_PEN_NM AND A.TNB = C.TNB )
	                 )
	                ORDER BY A.ACP_YR DESC, A.CVPT_ACP_NO DESC
	                ) AA
	           WHERE ROWNUM BETWEEN 1 AND 40
      ]]>
    </select>
   	
</mapper>
