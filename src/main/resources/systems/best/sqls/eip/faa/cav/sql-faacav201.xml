<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.go.bai.eip.faa.cav.dao.FAACAV201QMapper">
    
    <select id="selectLoadSttcList1" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV201QMapper.selectLoadSttcList1 */
        <![CDATA[
			SELECT CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) 
							 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-1) 
					END																	AS AUD_YR
				   ,'1'																	AS ROW_KND_CD
				   ,'Y'                                                                 AS VIEW_YN 
				   ,'Y'                                                                 AS CHART_VIEW_YN 
				   ,(SELECT ORG_NM 
		               FROM TBDCMACM015M 
		              WHERE ORG_CD = A.ORG_CD)                       AS STTC_TIT1
		           ,COUNT(1)                                         AS STTC_COL1
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-4)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-5) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL2
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-3)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-4) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL3
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-2)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-3) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL4
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-1)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-2) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL5
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4))
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-1) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL6
		       FROM (
		                SELECT TTO.ORG_CD
		                      ,SUBSTR(TTO.AUD_STR_DT,0,4) AS STD_YR
		                  FROM TBBADDED006L PTD
		                      ,TBBADDED008L TTO
		                      ,TBBADDED002M T1
		                      ,TBBADDED001M T2
		                      ,TBDCMACM015M T3
		                 WHERE 1=1
		                   AND TTO.AUD_STR_DT    BETWEEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01') AND TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -12), 'YYYY')||'-12-31')
		                   AND PTD.BZT_YR          = TTO.BZT_YR
		                   AND PTD.BZT_SNO         = TTO.BZT_SNO
		                   AND PTD.TEAM_SNO        = TTO.TEAM_SNO
		                   AND PTD.BGRP_TG_ORG_SNO = TTO.BGRP_TG_ORG_SNO
		                   AND TTO.BZT_YR          = T1.BZT_YR
		                   AND TTO.BZT_SNO         = T1.BZT_SNO
		                   AND T1.REL_AUD_YR       = T2.AUD_YR
		                   AND T1.REL_AUD_NO       = T2.AUD_NO
		                   AND TTO.ORG_CD          = T3.ORG_CD 
		                   
		                   /* 공공기관별*/
		                  AND T3.ORG_DVSN_CD      NOT IN ('10','21','22')

		
		                   AND SUBSTR(T2.AUD_KND_CD, -1) IN ('1','4')              /* 기관, 재무 */
		                   AND T1.AUD_BZT_KND_CD         IN ('01','02','03','04')  /* 예비, 실지, 실지연장, 추가 */
		                 GROUP BY TTO.ORG_CD
		                         ,SUBSTR(TTO.AUD_STR_DT,0,4)
		            ) A
		       GROUP BY ORG_CD
		       ORDER BY STTC_TIT1 
        ]]>
    </select>
    
        <select id="selectLoadSttcList2" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV201QMapper.selectLoadSttcList2 */
        <![CDATA[
				SELECT CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) 
							 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-1) 
						END	 																AS AUD_YR
					   ,'2'																	AS ROW_KND_CD
					   ,'Y'                                                                 AS VIEW_YN 
					   ,'Y'                                                                 AS CHART_VIEW_YN 
					   ,(SELECT ORG_NM 
			               FROM TBDCMACM015M 
			              WHERE ORG_CD = A.ORG_CD)                       AS STTC_TIT1
			           ,COUNT(1)                                         AS STTC_COL1
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-4)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-5) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL2
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-3)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-4) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL3
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-2)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-3) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL4
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-1)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-2) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL5
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4))
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-1) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL6
			       FROM (
			                SELECT TTO.ORG_CD
			                      ,SUBSTR(TTO.AUD_STR_DT,0,4) AS STD_YR
			                  FROM TBBADDED006L PTD
			                      ,TBBADDED008L TTO
			                      ,TBBADDED002M T1
			                      ,TBBADDED001M T2
			                      ,TBDCMACM015M T3
			                 WHERE 1=1
			                   AND TTO.AUD_STR_DT    BETWEEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01') AND TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -12), 'YYYY')||'-12-31')
			                   AND PTD.BZT_YR          = TTO.BZT_YR
			                   AND PTD.BZT_SNO         = TTO.BZT_SNO
			                   AND PTD.TEAM_SNO        = TTO.TEAM_SNO
			                   AND PTD.BGRP_TG_ORG_SNO = TTO.BGRP_TG_ORG_SNO
			                   AND TTO.BZT_YR          = T1.BZT_YR
			                   AND TTO.BZT_SNO         = T1.BZT_SNO
			                   AND T1.REL_AUD_YR       = T2.AUD_YR
			                   AND T1.REL_AUD_NO       = T2.AUD_NO
			                   AND TTO.ORG_CD          = T3.ORG_CD 
			
			                   /* 국가기관별*/
			                   AND T3.ORG_DVSN_CD      = '10'
			
			                   AND SUBSTR(T2.AUD_KND_CD, -1) IN ('1','4')              /* 기관, 재무 */
			                   AND T1.AUD_BZT_KND_CD         IN ('01','02','03','04')  /* 예비, 실지, 실지연장, 추가 */
			                 GROUP BY TTO.ORG_CD
			                         ,SUBSTR(TTO.AUD_STR_DT,0,4)
			            ) A
			       GROUP BY ORG_CD
			       ORDER BY STTC_TIT1 
        ]]>
    </select>
    
    <select id="selectLoadSttcList3" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV201QMapper.selectLoadSttcList3 */
        <![CDATA[
				SELECT CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) 
							 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-1) 
						END	 																AS AUD_YR
					   ,'3'																	AS ROW_KND_CD
					   ,'Y'                                                                 AS VIEW_YN 
					   ,'Y'                                                                 AS CHART_VIEW_YN 
					   ,(SELECT ORG_NM 
			               FROM TBDCMACM015M 
			              WHERE ORG_CD = A.ORG_CD)                       AS STTC_TIT1
			           ,COUNT(1)                                         AS STTC_COL1
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-4)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-5) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL2
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-3)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-4) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL3
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-2)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-3) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL4
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-1)
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-2) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL5
		           ,SUM(CASE WHEN STD_YR = (SELECT (CASE WHEN SUBSTR(ADD_MONTHS(#{proStadDt}, -1),6,2) = '12' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4))
														 ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)-1) 
													END) FROM DUAL) THEN 1 ELSE 0 END) AS STTC_COL6
			       FROM (
			                SELECT TTO.ORG_CD
			                      ,SUBSTR(TTO.AUD_STR_DT,0,4) AS STD_YR
			                  FROM TBBADDED006L PTD
			                      ,TBBADDED008L TTO
			                      ,TBBADDED002M T1
			                      ,TBBADDED001M T2
			                      ,TBDCMACM015M T3
			                 WHERE 1=1
			                   AND TTO.AUD_STR_DT    BETWEEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01') AND TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -12), 'YYYY')||'-12-31')
			                   AND PTD.BZT_YR          = TTO.BZT_YR
			                   AND PTD.BZT_SNO         = TTO.BZT_SNO
			                   AND PTD.TEAM_SNO        = TTO.TEAM_SNO
			                   AND PTD.BGRP_TG_ORG_SNO = TTO.BGRP_TG_ORG_SNO
			                   AND TTO.BZT_YR          = T1.BZT_YR
			                   AND TTO.BZT_SNO         = T1.BZT_SNO
			                   AND T1.REL_AUD_YR       = T2.AUD_YR
			                   AND T1.REL_AUD_NO       = T2.AUD_NO
			                   AND TTO.ORG_CD          = T3.ORG_CD 
			
			                   /* 지방자치단체별*/
			                   AND T3.ORG_DVSN_CD      IN ('21','22')
			
			                   AND SUBSTR(T2.AUD_KND_CD, -1) IN ('1','4')              /* 기관, 재무 */
			                   AND T1.AUD_BZT_KND_CD         IN ('01','02','03','04')  /* 예비, 실지, 실지연장, 추가 */
			                 GROUP BY TTO.ORG_CD
			                         ,SUBSTR(TTO.AUD_STR_DT,0,4)
			            ) A
			       GROUP BY ORG_CD
			       ORDER BY STTC_TIT1 
        ]]>
    </select>
    
    <select id="selectComboList" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.aep.arp.dao.FAACAV201QMapper.selectAffComboList */
            SELECT STTC_TYP_SEQ AS CD,
                   STTC_YR || '년 ' || STTC_STR_MON || '월' || DECODE(STTC_END_MON, '01', '', ' ~ ' || STTC_END_MON || '월') AS CD_NM
              FROM TWFAACAV200M 
             WHERE STTC_TYP_CD = '20'
               AND STTC_CLSF_CD = '201'
        ]]>
        <if test='mngDptYn != "Y"'>
               AND STTC_DTM_DY IS NOT NULL
        </if>
        <![CDATA[
        	ORDER BY STTC_TYP_SEQ DESC
        ]]>
    </select>
    
    <select id="selectSttcList1" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.aep.arp.dao.FAACAV201QMapper.selectSttcList */
            SELECT T1.RMK
                  ,T1.ADM_OPIN
                  ,TO_CHAR(T1.STTC_PROD_STAD_DY,'YYYY-MM-DD') AS STTC_PROD_STAD_DY
                  ,CASE WHEN T1.STTC_DTM_DY IS NULL THEN 'N'
                        ELSE 'Y'
                   END AS STTC_DTM_YN
                  ,T2.STTC_TYP_CD
                  ,T2.STTC_CLSF_CD
                  ,T2.STTC_TYP_SEQ
                  ,T2.STTC_DATA_SNO
                  ,T2.STTC_TIT1
                  ,T2.STTC_COL1
                  ,T2.STTC_COL2
                  ,T2.STTC_COL3
                  ,T2.STTC_COL4
                  ,T2.STTC_COL5
                  ,T2.STTC_COL6
                  ,CASE WHEN T1.STTC_YR - 1 > T2.AUD_YR THEN 'N'
                  		WHEN AUD_YR IS NULL THEN 'N'
                        ELSE 'Y'
                   END VIEW_YN
                  ,CASE WHEN T1.STTC_YR = T2.AUD_YR AND T1.STTC_END_MON <> '12' THEN 'N'
                        WHEN AUD_YR IS NULL THEN 'N'
                        WHEN T1.STTC_YR - 5 = T2.AUD_YR AND T1.STTC_END_MON = '12'THEN 'N'
                        ELSE 'Y'
                   END CHART_VIEW_YN
                  ,T2.AUD_YR
                  ,T2.ROW_KND_CD
                  ,NVL(TO_CHAR(T1.STTC_DTM_DY,'YYYY"-"MM"-"DD'),'미확정') AS STTC_DTM_DY
              FROM TWFAACAV200M T1
             INNER JOIN TWFAACAV200D T2 ON (
                        T1.STTC_TYP_CD = T2.STTC_TYP_CD
                    AND T1.STTC_CLSF_CD = T2.STTC_CLSF_CD
                    AND T1.STTC_TYP_SEQ = T2.STTC_TYP_SEQ )
             WHERE T1.STTC_CLSF_CD = '201'
               AND T1.STTC_TYP_SEQ = #{sttcTypSeq}
               AND T2.ROW_KND_CD = '1'
             ORDER BY STTC_DATA_SNO
        ]]>
    </select>
    
    <select id="selectSttcList2" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.aep.arp.dao.FAACAV201QMapper.selectSttcList2 */
            SELECT T1.RMK
                  ,T1.ADM_OPIN
                  ,TO_CHAR(T1.STTC_PROD_STAD_DY,'YYYY-MM-DD') AS STTC_PROD_STAD_DY
                  ,CASE WHEN T1.STTC_DTM_DY IS NULL THEN 'N'
                        ELSE 'Y'
                   END AS STTC_DTM_YN
                  ,T2.STTC_TYP_CD
                  ,T2.STTC_CLSF_CD
                  ,T2.STTC_TYP_SEQ
                  ,T2.STTC_DATA_SNO
                  ,T2.STTC_TIT1
                  ,T2.STTC_COL1
                  ,T2.STTC_COL2
                  ,T2.STTC_COL3
                  ,T2.STTC_COL4
                  ,T2.STTC_COL5
                  ,T2.STTC_COL6
                  ,CASE WHEN T1.STTC_YR - 1 > T2.AUD_YR THEN 'N'
                  		WHEN AUD_YR IS NULL THEN 'N'
                        ELSE 'Y'
                   END VIEW_YN
                  ,CASE WHEN T1.STTC_YR = T2.AUD_YR AND T1.STTC_END_MON <> '12' THEN 'N'
                        WHEN AUD_YR IS NULL THEN 'N'
                        WHEN T1.STTC_YR - 5 = T2.AUD_YR AND T1.STTC_END_MON = '12'THEN 'N'
                        ELSE 'Y'
                   END CHART_VIEW_YN
                  ,T2.AUD_YR
                  ,T2.ROW_KND_CD
                  ,NVL(TO_CHAR(T1.STTC_DTM_DY,'YYYY"-"MM"-"DD'),'미확정') AS STTC_DTM_DY
              FROM TWFAACAV200M T1
             INNER JOIN TWFAACAV200D T2 ON (
                        T1.STTC_TYP_CD = T2.STTC_TYP_CD
                    AND T1.STTC_CLSF_CD = T2.STTC_CLSF_CD
                    AND T1.STTC_TYP_SEQ = T2.STTC_TYP_SEQ )
             WHERE T1.STTC_CLSF_CD = '201'
               AND T1.STTC_TYP_SEQ = #{sttcTypSeq}
               AND T2.ROW_KND_CD = '2'
             ORDER BY STTC_DATA_SNO
        ]]>
    </select>
    
    <select id="selectSttcList3" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.aep.arp.dao.FAACAV201QMapper.selectSttcList3 */
            SELECT T1.RMK
                  ,T1.ADM_OPIN
                  ,TO_CHAR(T1.STTC_PROD_STAD_DY,'YYYY-MM-DD') AS STTC_PROD_STAD_DY
                  ,CASE WHEN T1.STTC_DTM_DY IS NULL THEN 'N'
                        ELSE 'Y'
                   END AS STTC_DTM_YN
                  ,T2.STTC_TYP_CD
                  ,T2.STTC_CLSF_CD
                  ,T2.STTC_TYP_SEQ
                  ,T2.STTC_DATA_SNO
                  ,T2.STTC_TIT1
                  ,T2.STTC_COL1
                  ,T2.STTC_COL2
                  ,T2.STTC_COL3
                  ,T2.STTC_COL4
                  ,T2.STTC_COL5
                  ,T2.STTC_COL6
                  ,CASE WHEN T1.STTC_YR - 1 > T2.AUD_YR THEN 'N'
                  		WHEN AUD_YR IS NULL THEN 'N'
                        ELSE 'Y'
                   END VIEW_YN
                  ,CASE WHEN T1.STTC_YR = T2.AUD_YR AND T1.STTC_END_MON <> '12' THEN 'N'
                        WHEN AUD_YR IS NULL THEN 'N'
                        WHEN T1.STTC_YR - 5 = T2.AUD_YR AND T1.STTC_END_MON = '12'THEN 'N'
                        ELSE 'Y'
                   END CHART_VIEW_YN
                  ,T2.AUD_YR
                  ,T2.ROW_KND_CD
                  ,NVL(TO_CHAR(T1.STTC_DTM_DY,'YYYY"-"MM"-"DD'),'미확정') AS STTC_DTM_DY
              FROM TWFAACAV200M T1
             INNER JOIN TWFAACAV200D T2 ON (
                        T1.STTC_TYP_CD = T2.STTC_TYP_CD
                    AND T1.STTC_CLSF_CD = T2.STTC_CLSF_CD
                    AND T1.STTC_TYP_SEQ = T2.STTC_TYP_SEQ )
             WHERE T1.STTC_CLSF_CD = '201'
               AND T1.STTC_TYP_SEQ = #{sttcTypSeq}
               AND T2.ROW_KND_CD = '3'
             ORDER BY STTC_DATA_SNO
        ]]>
    </select>    
    
    <insert id="insertMaster">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV201QMapper.insertMaster */
        <![CDATA[
            INSERT INTO TWFAACAV200M (
                 STTC_TYP_CD
                ,STTC_CLSF_CD
                ,STTC_TYP_SEQ
                ,STTC_YR
                ,STTC_STR_MON
                ,STTC_END_MON
                ,STTC_PROD_STAD_DY
                ,STTC_DTM_DY
                ,RMK
                ,ADM_OPIN
                ,FRT_USR_ID
                ,FNL_USR_ID
                ,FNL_DEAL_DPT_CD
                ,FNL_MNU_ID
                ,FRT_REGI_DH
                ,FNL_MDF_DH )
            VALUES (
                 '20'
                ,'201'
                ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0) + 1
                     FROM TWFAACAV200M
                    WHERE STTC_TYP_CD = '20'
                      AND STTC_CLSF_CD = '201' )
                ,SUBSTR(ADD_MONTHS(#{proStadDt}, -12), 0, 4)
                ,'01'
                ,'12'
                ,#{proStadDt}
                ,''
                ,#{rmk}
                ,#{admOpin}
                ,#{usrId}
                ,#{usrId}
                ,#{dptCd}
                ,#{mnuId}
                ,SYSDATE
                ,SYSDATE )
        ]]>
    </insert>
    
    <insert id="insertDetail">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV201QMapper.insertDetail */
        <![CDATA[
            INSERT INTO TWFAACAV200D (
                 STTC_TYP_CD
                ,STTC_CLSF_CD
                ,STTC_TYP_SEQ
                ,STTC_DATA_SNO
                ,STTC_TIT1
                ,STTC_COL1
                ,STTC_COL2
                ,STTC_COL3
                ,STTC_COL4
                ,STTC_COL5
                ,STTC_COL6
                ,AUD_YR
                ,ROW_KND_CD
                ,FRT_USR_ID
                ,FNL_USR_ID
                ,FNL_DEAL_DPT_CD
                ,FNL_MNU_ID
                ,FRT_REGI_DH
                ,FNL_MDF_DH )
            VALUES (
                 '20'
                ,'201'
                ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
                     FROM TWFAACAV200M
                    WHERE STTC_TYP_CD = '20'
                      AND STTC_CLSF_CD = '201' )
                ,( SELECT NVL(MAX(STTC_DATA_SNO), 0) + 1
                     FROM TWFAACAV200D
                    WHERE STTC_TYP_CD = '20'
                      AND STTC_CLSF_CD = '201' 
                      AND STTC_TYP_SEQ = ( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
                                             FROM TWFAACAV200M
                                            WHERE STTC_TYP_CD = '20'
                                              AND STTC_CLSF_CD = '201' ))
                ,#{sttcTit1}
                ,#{sttcCol1}
                ,#{sttcCol2}
                ,#{sttcCol3}
                ,#{sttcCol4}
                ,#{sttcCol5}
                ,#{sttcCol6}
                ,#{audYr}
                ,#{rowKndCd}
                ,#{usrId}
                ,#{usrId}
                ,#{dptCd}
                ,#{mnuId}
                ,SYSDATE
                ,SYSDATE )
        ]]>
    </insert>
    
    <insert id="updateMaster">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV201QMapper.updateMaster */
        <![CDATA[
            UPDATE TWFAACAV200M
               SET RMK = #{rmk}
                  ,ADM_OPIN = #{admOpin}
                  ,FNL_USR_ID = #{usrId}
                  ,FNL_DEAL_DPT_CD = #{dptCd}
                  ,FNL_MDF_DH = SYSDATE
             WHERE STTC_TYP_CD = #{sttcTypCd}
               AND STTC_CLSF_CD = #{sttcClsfCd}
               AND STTC_TYP_SEQ = #{sttcTypSeq}
        ]]>
    </insert>
    
    <insert id="updateDetail">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV201QMapper.updateDetail */
        <![CDATA[
            UPDATE TWFAACAV200D
               SET STTC_COL1 = #{sttcCol1}
                  ,STTC_COL2 = #{sttcCol2}
                  ,STTC_COL3 = #{sttcCol3}
                  ,STTC_COL4 = #{sttcCol4}
                  ,STTC_COL5 = #{sttcCol5}
                  ,STTC_COL6 = #{sttcCol6}
                  ,FNL_USR_ID = #{usrId}
                  ,FNL_DEAL_DPT_CD = #{dptCd}
                  ,FNL_MDF_DH = SYSDATE
             WHERE STTC_TYP_CD = #{sttcTypCd}
               AND STTC_CLSF_CD = #{sttcClsfCd}
               AND STTC_TYP_SEQ = #{sttcTypSeq}
               AND STTC_DATA_SNO = #{sttcDataSno}
        ]]>
    </insert>
    
    <insert id="updateMasterDtmDy">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV201QMapper.updateMasterDtmDy */
        <![CDATA[
            UPDATE TWFAACAV200M
               SET STTC_DTM_DY = SYSDATE
                  ,FNL_USR_ID = #{usrId}
                  ,FNL_DEAL_DPT_CD = #{dptCd}
                  ,FNL_MDF_DH = SYSDATE
             WHERE STTC_TYP_CD = #{sttcTypCd}
               AND STTC_CLSF_CD = #{sttcClsfCd}
               AND STTC_TYP_SEQ = #{sttcTypSeq}
        ]]>
    </insert>
    
</mapper>