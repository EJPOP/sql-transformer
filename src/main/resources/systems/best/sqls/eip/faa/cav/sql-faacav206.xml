<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.go.bai.eip.faa.cav.dao.FAACAV206QMapper">
    
    <select id="selectLoadSttcList" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV206QMapper.selectLoadSttcList */
        <![CDATA[
				SELECT  TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						,'0' AS ROW_KND_CD
						,'Y' AS VIEW_YN 
						,DECODE(#{mngDptCd},NULL,'계', F_DPT_INFO(#{mngDptCd},'1')) AS MNG_DPT_NM
						,'계' AS STTC_TIT1
						,'건수' AS STTC_TIT2
						,#{mngDptCd} AS STTC_TIT3
						,'0' AS STTC_COL1
						,'0' AS STTC_COL2
						,'0' AS STTC_COL3
						,'0' AS STTC_COL4
						,'0' AS STTC_COL5
						,'0' AS STTC_COL6
						,'0' AS STTC_COL7
					FROM DUAL
			UNION ALL
				SELECT  TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						,'1' AS ROW_KND_CD
						,'Y' AS VIEW_YN 
						,DECODE(#{mngDptCd},NULL,'계',F_DPT_INFO(#{mngDptCd},'1')) AS MNG_DPT_NM
						,'계' AS STTC_TIT1
						,'금액' AS STTC_TIT2
						,#{mngDptCd} AS STTC_TIT3
						,'0' AS STTC_COL1
						,'0' AS STTC_COL2
						,'0' AS STTC_COL3
						,'0' AS STTC_COL4
						,'0' AS STTC_COL5
						,'0' AS STTC_COL6
						,'0' AS STTC_COL7
					FROM DUAL
			UNION ALL
				SELECT  TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						,'2' AS ROW_KND_CD
						,'Y' AS VIEW_YN 
						,DECODE(#{mngDptCd},NULL,'변상판정',F_DPT_INFO(#{mngDptCd},'1')) AS MNG_DPT_NM
						,'변상판정' AS STTC_TIT1
						,'건수' AS STTC_TIT2
						,#{mngDptCd} AS STTC_TIT3
						,'0' AS STTC_COL1
						,'0' AS STTC_COL2
						,'0' AS STTC_COL3
						,'0' AS STTC_COL4
						,'0' AS STTC_COL5
						,'0' AS STTC_COL6
						,'0' AS STTC_COL7
					FROM DUAL	
			UNION ALL
				SELECT  TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						,'3' AS ROW_KND_CD
						,'Y' AS VIEW_YN 
						,DECODE(#{mngDptCd},NULL,'변상판정',F_DPT_INFO(#{mngDptCd},'1')) AS MNG_DPT_NM
						,'변상판정' AS STTC_TIT1
						,'금액' AS STTC_TIT2
						,#{mngDptCd} AS STTC_TIT3
						,'0' AS STTC_COL1
						,'0' AS STTC_COL2
						,'0' AS STTC_COL3
						,'0' AS STTC_COL4
						,'0' AS STTC_COL5
						,'0' AS STTC_COL6
						,'0' AS STTC_COL7
					FROM DUAL		
			UNION ALL
				SELECT  TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						,'4' AS ROW_KND_CD
						,'Y' AS VIEW_YN 
						,DECODE(#{mngDptCd},NULL,'시정',F_DPT_INFO(#{mngDptCd},'1')) AS MNG_DPT_NM
						,'시정' AS STTC_TIT1
						,'건수' AS STTC_TIT2
						,#{mngDptCd} AS STTC_TIT3
						,'0' AS STTC_COL1
						,'0' AS STTC_COL2
						,'0' AS STTC_COL3
						,'0' AS STTC_COL4
						,'0' AS STTC_COL5
						,'0' AS STTC_COL6
						,'0' AS STTC_COL7
					FROM DUAL
			UNION ALL
				SELECT  TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						,'5' AS ROW_KND_CD
						,'Y' AS VIEW_YN 
						,DECODE(#{mngDptCd},NULL,'시정',F_DPT_INFO(#{mngDptCd},'1')) AS MNG_DPT_NM
						,'시정' AS STTC_TIT1
						,'금액' AS STTC_TIT2
						,#{mngDptCd} AS STTC_TIT3
						,'0' AS STTC_COL1
						,'0' AS STTC_COL2
						,'0' AS STTC_COL3
						,'0' AS STTC_COL4
						,'0' AS STTC_COL5
						,'0' AS STTC_COL6
						,'0' AS STTC_COL7						
					FROM DUAL 																											
        ]]>
    </select>
    
    <select id="selectComboList" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.aep.arp.dao.FAACAV206QMapper.selectAffComboList */
            SELECT STTC_TYP_SEQ AS CD,
                   STTC_YR || '년 ' || STTC_STR_MON || '월' || DECODE(STTC_END_MON, '01', '', ' ~ ' || STTC_END_MON || '월') AS CD_NM
              FROM TWFAACAV200M 
             WHERE STTC_TYP_CD = '20'
               AND STTC_CLSF_CD = '206'
        ]]>
        <if test='mngDptYn != "Y"'>
               AND STTC_DTM_DY IS NOT NULL
        </if>
        <![CDATA[
        	ORDER BY STTC_TYP_SEQ DESC
        ]]>
    </select>
    
    <select id="selectSttcList" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.aep.arp.dao.FAACAV206QMapper.selectSttcList */
            SELECT T1.RMK
                  ,T1.ADM_OPIN
                  ,TO_CHAR(T1.STTC_PROD_STAD_DY,'YYYY-MM-DD') AS STTC_PROD_STAD_DY
                  ,CASE WHEN T1.STTC_DTM_DY IS NULL THEN 'N'
                        ELSE 'Y'
                   END AS STTC_DTM_YN
                  ,T2.STTC_TYP_CD
                  ,T2.STTC_CLSF_CD
                  ,T2.STTC_TYP_SEQ
                  ,T2.STTC_DATA_SNO
                  ,DECODE(T2.STTC_TIT3 ,NULL,T2.STTC_TIT1,F_DPT_INFO(T2.STTC_TIT3,'1')) AS MNG_DPT_NM
                  ,T2.STTC_TIT1
                  ,T2.STTC_TIT2
                  ,T2.STTC_TIT3
                  ,T2.STTC_COL1
                  ,T2.STTC_COL2
                  ,T2.STTC_COL3
                  ,T2.STTC_COL4
                  ,T2.STTC_COL5   
                  ,T2.STTC_COL6
                  ,T2.STTC_COL7                              
                  ,CASE WHEN T1.STTC_YR - 5 > T2.AUD_YR THEN 'N'
                        ELSE 'Y'
                   END VIEW_YN
                   ,CASE WHEN T1.STTC_YR - 4 > T2.AUD_YR THEN 'N'
                        ELSE 'Y'
                   END CHART_VIEW_YN
                  ,T2.AUD_YR
                  ,T2.ROW_KND_CD
                  ,NVL(TO_CHAR(T1.STTC_DTM_DY,'YYYY"-"MM"-"DD'),'미확정') AS STTC_DTM_DY
              FROM TWFAACAV200M T1
             INNER JOIN TWFAACAV200D T2 ON (
                        T1.STTC_TYP_CD = T2.STTC_TYP_CD
                    AND T1.STTC_CLSF_CD = T2.STTC_CLSF_CD
                    AND T1.STTC_TYP_SEQ = T2.STTC_TYP_SEQ )
             WHERE T1.STTC_CLSF_CD = '206'
               AND T1.STTC_TYP_SEQ = #{sttcTypSeq}
        ]]>
               <if test="mngDptCd != null and mngDptCd != '' and mngDptCd != 'null'">
               AND T2.STTC_TIT3 = #{mngDptCd}
               </if>
                <if test="mngDptCd == null or mngDptCd == '' or mngDptCd == 'null'">
               AND T2.STTC_TIT3 IS NULL
               </if>
        <![CDATA[
             ORDER BY T2.ROW_KND_CD
        ]]>
    </select>
    
        <select id="selectSttcExcelList" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.aep.arp.dao.FAACAV206QMapper.selectSttcExcelList */
            SELECT T1.RMK
                  ,T1.ADM_OPIN
                  ,TO_CHAR(T1.STTC_PROD_STAD_DY,'YYYY-MM-DD') AS STTC_PROD_STAD_DY
                  ,CASE WHEN T1.STTC_DTM_DY IS NULL THEN 'N'
                        ELSE 'Y'
                   END AS STTC_DTM_YN
                  ,T2.STTC_TYP_CD
                  ,T2.STTC_CLSF_CD
                  ,T2.STTC_TYP_SEQ
                  ,T2.STTC_DATA_SNO
                  ,DECODE(T2.STTC_TIT3 ,NULL,T2.STTC_TIT1,F_DPT_INFO(T2.STTC_TIT3,'1')) AS MNG_DPT_NM
                  ,T2.STTC_TIT1
                  ,T2.STTC_TIT2
                  ,NVL(T2.STTC_TIT3,0) AS STTC_TIT3
                  ,T2.STTC_COL1
                  ,T2.STTC_COL2
                  ,T2.STTC_COL3
                  ,T2.STTC_COL4
                  ,T2.STTC_COL5   
                  ,T2.STTC_COL6
                  ,T2.STTC_COL7                              
                  ,T2.AUD_YR
                  ,T2.ROW_KND_CD
                  ,NVL(TO_CHAR(T1.STTC_DTM_DY,'YYYY"-"MM"-"DD'),'미확정') AS STTC_DTM_DY
              FROM TWFAACAV200M T1
             INNER JOIN TWFAACAV200D T2 ON (
                        T1.STTC_TYP_CD = T2.STTC_TYP_CD
                    AND T1.STTC_CLSF_CD = T2.STTC_CLSF_CD
                    AND T1.STTC_TYP_SEQ = T2.STTC_TYP_SEQ )
             WHERE T1.STTC_CLSF_CD = '206'
               AND T1.STTC_TYP_SEQ = #{sttcTypSeq}
             ORDER BY STTC_TIT3, ROW_KND_CD
        ]]>
    </select>
    <insert id="insertMaster">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV206QMapper.insertMaster */
        <![CDATA[
            INSERT INTO TWFAACAV200M (
                 STTC_TYP_CD
                ,STTC_CLSF_CD
                ,STTC_TYP_SEQ
                ,STTC_YR
                ,STTC_STR_MON
                ,STTC_END_MON
                ,STTC_PROD_STAD_DY
                ,STTC_DTM_DY
                ,RMK
                ,ADM_OPIN
                ,FRT_USR_ID
                ,FNL_USR_ID
                ,FNL_DEAL_DPT_CD
                ,FNL_MNU_ID
                ,FRT_REGI_DH
                ,FNL_MDF_DH )
            VALUES (
                 '20'
                ,'206'
                ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0) + 1
                     FROM TWFAACAV200M
                    WHERE STTC_TYP_CD = '20'
                      AND STTC_CLSF_CD = '206' )
                ,SUBSTR(ADD_MONTHS(#{proStadDt}, -1), 0, 4)
                ,'01'
                ,TO_CHAR(TO_DATE(ADD_MONTHS(#{proStadDt}, -1)), 'MM')
                ,#{proStadDt}
                ,''
                ,#{rmk}
                ,#{admOpin}
                ,#{usrId}
                ,#{usrId}
                ,#{dptCd}
                ,#{mnuId}
                ,SYSDATE
                ,SYSDATE )
        ]]>
    </insert>
    
    <insert id="insertDetail">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV206QMapper.insertDetail */
        <![CDATA[
            INSERT INTO TWFAACAV200D (
                 STTC_TYP_CD
                ,STTC_CLSF_CD
                ,STTC_TYP_SEQ
                ,STTC_DATA_SNO
                ,STTC_TIT1
                ,STTC_TIT2
                ,STTC_TIT3
                ,STTC_COL1
                ,STTC_COL2
                ,STTC_COL3
                ,STTC_COL4
                ,STTC_COL5
                ,STTC_COL6
                ,STTC_COL7
                ,AUD_YR
                ,ROW_KND_CD
                ,FRT_USR_ID
                ,FNL_USR_ID
                ,FNL_DEAL_DPT_CD
                ,FNL_MNU_ID
                ,FRT_REGI_DH
                ,FNL_MDF_DH )
            VALUES (
                 '20'
                ,'206'
                ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
                     FROM TWFAACAV200M
                    WHERE STTC_TYP_CD = '20'
                      AND STTC_CLSF_CD = '206' )
                ,( SELECT NVL(MAX(STTC_DATA_SNO), 0)
                     FROM TWFAACAV200D
                    WHERE STTC_TYP_CD = '20'
                      AND STTC_CLSF_CD = '206' 
                      AND STTC_TYP_SEQ = ( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
                                             FROM TWFAACAV200M
                                            WHERE STTC_TYP_CD = '20'
                                              AND STTC_CLSF_CD = '206' ))
                ,#{sttcTit1}
                ,#{sttcTit2}
                ,#{sttcTit3}
                ,#{sttcCol1}
                ,#{sttcCol2}
                ,#{sttcCol3}
                ,#{sttcCol4}
                ,#{sttcCol5}
                ,#{sttcCol6}
                ,#{sttcCol7}                           
                ,#{audYr}
                ,#{rowKndCd}
                ,#{usrId}
                ,#{usrId}
                ,#{dptCd}
                ,#{mnuId}
                ,SYSDATE
                ,SYSDATE )
        ]]>
    </insert>

   <insert id="insertDetailInfo">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV206QMapper.insertDetailInfo */
        <![CDATA[
    INSERT INTO TWFAACAV200D (
                 STTC_TYP_CD
                ,STTC_CLSF_CD
                ,STTC_TYP_SEQ
                ,STTC_DATA_SNO
                ,STTC_TIT1
                ,STTC_TIT2
                ,STTC_TIT3
                ,STTC_COL1
                ,STTC_COL2
                ,STTC_COL3
                ,STTC_COL4
                ,STTC_COL5
                ,STTC_COL6
                ,STTC_COL7
                ,AUD_YR
                ,ROW_KND_CD
                ,FRT_USR_ID
                ,FNL_USR_ID
                ,FNL_DEAL_DPT_CD
                ,FNL_MNU_ID
                ,FRT_REGI_DH
                ,FNL_MDF_DH )

				  SELECT   '20' AS STTC_TYP_CD
		                  ,'206' AS STTC_CLSF_CD
		                  ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                       FROM TWFAACAV200M
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' ) AS STTC_TYP_SEQ
		                  ,( SELECT NVL(MAX(STTC_DATA_SNO), 0) + 1
		                       FROM TWFAACAV200D
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' 
		                        AND STTC_TYP_SEQ = ( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                                               FROM TWFAACAV200M
		                                              WHERE STTC_TYP_CD = '20'
		                                                AND STTC_CLSF_CD = '206' )) AS STTC_DATA_SNO
			              ,'계' AS STTC_TIT1
					      ,'건수' AS STTC_TIT2
						  ,#{mngDptCd} AS STTC_TIT3
						  ,'0' AS STTC_COL1
						  ,'0' AS STTC_COL2
						  ,'0' AS STTC_COL3
						  ,'0' AS STTC_COL4
						  ,'0' AS STTC_COL5
						  ,'0' AS STTC_COL6
						  ,'0' AS STTC_COL7
						  ,TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						  ,'0' AS ROW_KND_CD
                          ,#{usrId}
                          ,#{usrId}
                          ,#{dptCd}
                          ,#{mnuId}
                          ,SYSDATE
                          ,SYSDATE
                     FROM DUAL
			UNION ALL
				  SELECT   '20' AS STTC_TYP_CD
		                  ,'206' AS STTC_CLSF_CD
		                  ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                       FROM TWFAACAV200M
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' ) AS STTC_TYP_SEQ
		                  ,( SELECT NVL(MAX(STTC_DATA_SNO), 0) + 1
		                       FROM TWFAACAV200D
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' 
		                        AND STTC_TYP_SEQ = ( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                                               FROM TWFAACAV200M
		                                              WHERE STTC_TYP_CD = '20'
		                                                AND STTC_CLSF_CD = '206' )) AS STTC_DATA_SNO
						  ,'계' AS STTC_TIT1
						  ,'금액' AS STTC_TIT2
						  ,#{mngDptCd} AS STTC_TIT3
						  ,'0' AS STTC_COL1
						  ,'0' AS STTC_COL2
						  ,'0' AS STTC_COL3
						  ,'0' AS STTC_COL4
						  ,'0' AS STTC_COL5
						  ,'0' AS STTC_COL6
						  ,'0' AS STTC_COL7
						  ,TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						  ,'1' AS ROW_KND_CD
                          ,#{usrId}
                          ,#{usrId}
                          ,#{dptCd}
                          ,#{mnuId}
                          ,SYSDATE
                          ,SYSDATE
					FROM DUAL
			UNION ALL
				  SELECT   '20' AS STTC_TYP_CD
		                  ,'206' AS STTC_CLSF_CD
		                  ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                       FROM TWFAACAV200M
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' ) AS STTC_TYP_SEQ
		                  ,( SELECT NVL(MAX(STTC_DATA_SNO), 0) + 1
		                       FROM TWFAACAV200D
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' 
		                        AND STTC_TYP_SEQ = ( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                                               FROM TWFAACAV200M
		                                              WHERE STTC_TYP_CD = '20'
		                                                AND STTC_CLSF_CD = '206' )) AS STTC_DATA_SNO
						  ,'변상판정' AS STTC_TIT1
						  ,'건수' AS STTC_TIT2
						  ,#{mngDptCd} AS STTC_TIT3
						  ,'0' AS STTC_COL1
						  ,'0' AS STTC_COL2
						  ,'0' AS STTC_COL3
						  ,'0' AS STTC_COL4
						  ,'0' AS STTC_COL5
						  ,'0' AS STTC_COL6
						  ,'0' AS STTC_COL7
						  ,TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						  ,'2' AS ROW_KND_CD
                          ,#{usrId}
                          ,#{usrId}
                          ,#{dptCd}
                          ,#{mnuId}
                          ,SYSDATE
                          ,SYSDATE
					FROM DUAL	
			UNION ALL
				  SELECT   '20' AS STTC_TYP_CD
		                  ,'206' AS STTC_CLSF_CD
		                  ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                       FROM TWFAACAV200M
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' ) AS STTC_TYP_SEQ
		                  ,( SELECT NVL(MAX(STTC_DATA_SNO), 0) + 1
		                       FROM TWFAACAV200D
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' 
		                        AND STTC_TYP_SEQ = ( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                                               FROM TWFAACAV200M
		                                              WHERE STTC_TYP_CD = '20'
		                                                AND STTC_CLSF_CD = '206' )) AS STTC_DATA_SNO
						  ,'변상판정' AS STTC_TIT1
						  ,'금액' AS STTC_TIT2
					      ,#{mngDptCd} AS STTC_TIT3
						  ,'0' AS STTC_COL1
						  ,'0' AS STTC_COL2
						  ,'0' AS STTC_COL3
						  ,'0' AS STTC_COL4
						  ,'0' AS STTC_COL5
						  ,'0' AS STTC_COL6
						  ,'0' AS STTC_COL7
						  ,TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						  ,'3' AS ROW_KND_CD
                          ,#{usrId}
                          ,#{usrId}
                          ,#{dptCd}
                          ,#{mnuId}
                          ,SYSDATE
                          ,SYSDATE
					FROM DUAL		
			UNION ALL
				  SELECT   '20' AS STTC_TYP_CD
		                  ,'206' AS STTC_CLSF_CD
		                  ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                       FROM TWFAACAV200M
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' ) AS STTC_TYP_SEQ
		                  ,( SELECT NVL(MAX(STTC_DATA_SNO), 0) + 1
		                       FROM TWFAACAV200D
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' 
		                        AND STTC_TYP_SEQ = ( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                                               FROM TWFAACAV200M
		                                              WHERE STTC_TYP_CD = '20'
		                                                AND STTC_CLSF_CD = '206' )) AS STTC_DATA_SNO
						  ,'시정' AS STTC_TIT1
						  ,'건수' AS STTC_TIT2
						  ,#{mngDptCd} AS STTC_TIT3
						  ,'0' AS STTC_COL1
						  ,'0' AS STTC_COL2
						  ,'0' AS STTC_COL3
						  ,'0' AS STTC_COL4
						  ,'0' AS STTC_COL5
						  ,'0' AS STTC_COL6
						  ,'0' AS STTC_COL7
						  ,TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						  ,'4' AS ROW_KND_CD
                          ,#{usrId}
                          ,#{usrId}
                          ,#{dptCd}
                          ,#{mnuId}
                          ,SYSDATE
                          ,SYSDATE
					FROM DUAL
			UNION ALL
				  SELECT   '20' AS STTC_TYP_CD
		                  ,'206' AS STTC_CLSF_CD
		                  ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                       FROM TWFAACAV200M
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' ) AS STTC_TYP_SEQ
		                  ,( SELECT NVL(MAX(STTC_DATA_SNO), 0) + 1
		                       FROM TWFAACAV200D
		                      WHERE STTC_TYP_CD = '20'
		                        AND STTC_CLSF_CD = '206' 
		                        AND STTC_TYP_SEQ = ( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
		                                               FROM TWFAACAV200M
		                                              WHERE STTC_TYP_CD = '20'
		                                                AND STTC_CLSF_CD = '206' )) AS STTC_DATA_SNO
						  ,'시정' AS STTC_TIT1
						  ,'금액' AS STTC_TIT2
						  ,#{mngDptCd} AS STTC_TIT3
						  ,'0' AS STTC_COL1
						  ,'0' AS STTC_COL2
						  ,'0' AS STTC_COL3
						  ,'0' AS STTC_COL4
						  ,'0' AS STTC_COL5
						  ,'0' AS STTC_COL6
						  ,'0' AS STTC_COL7
						  ,TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4)) AS AUD_YR
						  ,'5' AS ROW_KND_CD
                          ,#{usrId}
                          ,#{usrId}
                          ,#{dptCd}
                          ,#{mnuId}
                          ,SYSDATE
                          ,SYSDATE						
					FROM DUAL 
        ]]>
    </insert>
    
    <insert id="updateMaster">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV206QMapper.updateMaster */
        <![CDATA[
            UPDATE TWFAACAV200M
               SET RMK = #{rmk}
                  ,ADM_OPIN = #{admOpin}
                  ,FNL_USR_ID = #{usrId}
                  ,FNL_DEAL_DPT_CD = #{dptCd}
                  ,FNL_MDF_DH = SYSDATE
             WHERE STTC_TYP_CD = #{sttcTypCd}
               AND STTC_CLSF_CD = #{sttcClsfCd}
               AND STTC_TYP_SEQ = #{sttcTypSeq}
        ]]>
    </insert>
    
    <insert id="updateDetail">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV206QMapper.updateDetail */
        <![CDATA[
            UPDATE TWFAACAV200D
               SET STTC_COL1 = #{sttcCol1}
                  ,STTC_COL2 = #{sttcCol2}
                  ,STTC_COL3 = #{sttcCol3}
                  ,STTC_COL4 = #{sttcCol4}
                  ,STTC_COL5 = #{sttcCol5}
                  ,STTC_COL6 = #{sttcCol6}
                  ,STTC_COL7 = #{sttcCol7}
                  ,FNL_USR_ID = #{usrId}
                  ,FNL_DEAL_DPT_CD = #{dptCd}
                  ,FNL_MDF_DH = SYSDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
             WHERE STTC_TYP_CD = #{sttcTypCd}
               AND STTC_CLSF_CD = #{sttcClsfCd}
               AND STTC_TYP_SEQ = #{sttcTypSeq}
               AND ROW_KND_CD = #{rowKndCd}
               
        ]]>
          <if test="mngDptCd != null and mngDptCd != '' and mngDptCd != 'null'">
               AND STTC_TIT3 = #{mngDptCd}
          </if>
         <if test="mngDptCd == null or mngDptCd == '' or mngDptCd == 'null'">
               AND STTC_TIT3 IS NULL
         </if>

    </insert>
    
    <insert id="updateMasterDtmDy">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV206QMapper.updateMasterDtmDy */
        <![CDATA[
            UPDATE TWFAACAV200M
               SET STTC_DTM_DY = SYSDATE
                  ,FNL_USR_ID = #{usrId}
                  ,FNL_DEAL_DPT_CD = #{dptCd}
                  ,FNL_MDF_DH = SYSDATE
             WHERE STTC_TYP_CD = #{sttcTypCd}
               AND STTC_CLSF_CD = #{sttcClsfCd}
               AND STTC_TYP_SEQ = #{sttcTypSeq}
        ]]>
    </insert>
     <select id="selectDeptBureauList" parameterType="paramMap" resultType="java.util.HashMap">
    /*kr.go.bai.eip.com.dao.FAACAV206QMapper.selectDeptBureauList*/
        <![CDATA[
                SELECT
                       DPT_CD AS CD
                      ,DPT_NM AS CD_NM
                      ,HIRK_DPT_CD
                  FROM TBDCMACM002M S1
                 WHERE USE_YN         = 'Y'
                   AND IMD_CD         = 'Y'
                   AND ORZT_DVSN_CD   = '20'
                   AND DPT_CD NOT IN('070000','0H0000','0L0000','081000','180000','150000','100000')
         ]]>
        
            <if test="mngDptCd != null and mngDptCd != ''">
                   AND DPT_CD != #{mngDptCd}
            </if>
        <![CDATA[
                 ORDER BY SRT_SNO
        ]]>

    </select>
    
        <select id="selectDeptList" parameterType="paramMap" resultType="java.util.HashMap">
    /*kr.go.bai.eip.com.dao.FAACAV206QMapper.selectDeptList*/
        <![CDATA[
             SELECT DPT_CD AS CD, DPT_NM AS CD_NM, HIRK_DPT_CD
               FROM TBDCMACM002M
              WHERE 1=1
        ]]>
            <if test="strHrkDptCd != null and strHrkDptCd != ''">
               <if test="strDptCd == null or strDptCd == ''">
                   AND SUBSTR(DPT_CD, 0, 3) = SUBSTR(#{strHrkDptCd}, 0, 3)
               </if>
               <if test="strDptCd != null and strDptCd != ''">
                   OR SUBSTR(DPT_CD, 0, 3) = SUBSTR(#{strHrkDptCd}, 0, 3)
               </if>
            </if>
             <if test="mngDptCd != null and mngDptCd != ''">
                   AND DPT_CD != #{mngDptCd}
            </if>
        <![CDATA[
                AND DPT_CD NOT LIKE '%000'
                AND USE_YN = 'Y'
                AND IMD_CD         = 'Y'
                AND ORZT_DVSN_CD   = '30'
                AND HIRK_DPT_CD NOT IN('070000','0H0000','0L0000','081000','180000','150000','100000','400000')
              ORDER BY CD, DPT_SNO    
        ]]>

    </select>
</mapper>