<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.go.bai.eip.faa.cav.dao.FAACAV207QMapper">
    
    <select id="selectLoadSttcList" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV207QMapper.selectLoadSttcList */
        <![CDATA[
			WITH BASE AS ( 
			    SELECT T2.AUD_YR 
			          ,T2.AUD_NO
			          ,T2.DSP_RQ_SNO
			          ,SUBSTR(T2.ENF_DT,0,4)                                                  AS END_DT_YR
			          
			          -- 이행완료
			          ,CASE WHEN DSP_RQ_KND_CD = '110'                      AND ((ENFM_WHLS_DTM_DT  BETWEEN (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01')
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -61), 'YYYY')||'-01-01')
																											END) 
																										AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																											END)) OR (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL))
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_DTM_1    /* 변상 건수*/
			          ,CASE WHEN DSP_RQ_KND_CD = '110'                      AND ((ENFM_WHLS_DTM_DT BETWEEN (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01')
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -61), 'YYYY')||'-01-01')
																											END) 
																										AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																											END)) OR (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL))
			                     THEN NVL(T2.PNL_DRIN_PSVT_AM,0) + NVL(T2.RSR_AM,0) + NVL(T2.SPLP_AM,0) ELSE 0 END 
			                                                                                  AS AM_DTM_1     /* 변상 금액 */          
			          ,CASE WHEN DSP_RQ_KND_CD = '210'                      AND ((ENFM_WHLS_DTM_DT BETWEEN(CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01')
																											 ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -61), 'YYYY')||'-01-01')
																											END) 
																										AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																											END)) OR (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL))
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_DTM_2    /* 징계 */                    
			          ,CASE WHEN DSP_RQ_KND_CD IN ('310','320','390','391','395','396') AND ((ENFM_WHLS_DTM_DT BETWEEN (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01')
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -61), 'YYYY')||'-01-01')
																											END) 
																										AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																											END)) OR (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL))
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_DTM_3    /* 시정 건수 */    
			          ,CASE WHEN DSP_RQ_KND_CD IN ('310','320','390','391','395','396') AND ((ENFM_WHLS_DTM_DT BETWEEN (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01')
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -61), 'YYYY')||'-01-01')
																											END) 
																										AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																											END)) OR (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL))
			                     THEN NVL(T2.PNL_DRIN_PSVT_AM,0) + NVL(T2.RSR_AM,0) + NVL(T2.SPLP_AM,0) ELSE 0 END 
			                                                                                  AS AM_DTM_3     /* 시정 금액 */    
			          ,CASE WHEN DSP_RQ_KND_CD IN ('410','490','495')             AND ((ENFM_WHLS_DTM_DT BETWEEN (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01')
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -61), 'YYYY')||'-01-01')
																											END) 
																										AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																											END)) OR (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL))
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_DTM_4    /* 주의 */           
			          ,CASE WHEN DSP_RQ_KND_CD IN ('510','520','530')       AND ((ENFM_WHLS_DTM_DT BETWEEN (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01')
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -61), 'YYYY')||'-01-01')
																											END) 
																										AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																											END)) OR (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL))
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_DTM_5    /* 개선 */ 
			          ,CASE WHEN DSP_RQ_KND_CD = '611'                      AND ((ENFM_WHLS_DTM_DT BETWEEN (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01')
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -61), 'YYYY')||'-01-01')
																											END) 
																										AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																											END)) OR (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL))
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_DTM_6    /* 권고 */ 
			          ,CASE WHEN DSP_RQ_KND_CD IN ('610','630','904','905','620','621','623','810','820','830','840','850','625') AND ((ENFM_WHLS_DTM_DT 
			          																				BETWEEN (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -49), 'YYYY')||'-01-01')
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -61), 'YYYY')||'-01-01')
																											END) 
																										AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																												ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																											END)) OR (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL))
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_DTM_7    /* 통보 */  
			          
			          -- 이행중
			          ,CASE WHEN DSP_RQ_KND_CD = '110'                      AND (ENFM_WHLS_DTM_DT IS NULL OR ENFM_WHLS_DTM_DT > CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																																	ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																																END) 
																																AND (CASE WHEN (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL) THEN 1 ELSE 0 END = 0) 
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_ING_1    /* 변상 건수*/
			          ,CASE WHEN DSP_RQ_KND_CD = '110'                      AND (ENFM_WHLS_DTM_DT IS NULL OR ENFM_WHLS_DTM_DT > CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																																	ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																																END) 
																																AND (CASE WHEN (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL) THEN 1 ELSE 0 END = 0) 
			                     THEN NVL(T2.PNL_DRIN_PSVT_AM,0) + NVL(T2.RSR_AM,0) + NVL(T2.SPLP_AM,0) ELSE 0 END 
			                                                                                  AS AM_ING_1     /* 변상 금액 */          
			          ,CASE WHEN DSP_RQ_KND_CD = '210'                      AND (ENFM_WHLS_DTM_DT IS NULL OR ENFM_WHLS_DTM_DT > CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																																	ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																																END) 
																																AND (CASE WHEN (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL) THEN 1 ELSE 0 END = 0) 
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_ING_2    /* 징계 */                    
			          ,CASE WHEN DSP_RQ_KND_CD IN ('310','320','390','391','395','396') AND (ENFM_WHLS_DTM_DT IS NULL OR ENFM_WHLS_DTM_DT > CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																																	ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																																END) 
																																AND (CASE WHEN (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL) THEN 1 ELSE 0 END = 0) 
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_ING_3    /* 시정 건수 */    
			          ,CASE WHEN DSP_RQ_KND_CD IN ('310','320','390','391','395','396') AND (ENFM_WHLS_DTM_DT IS NULL OR ENFM_WHLS_DTM_DT > CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																																	ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																																END) 
																																AND (CASE WHEN (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL) THEN 1 ELSE 0 END = 0) 
			                     THEN NVL(T2.PNL_DRIN_PSVT_AM,0) + NVL(T2.RSR_AM,0) + NVL(T2.SPLP_AM,0) ELSE 0 END 
			                                                                                  AS AM_ING_3     /* 시정 금액 */    
			          ,CASE WHEN DSP_RQ_KND_CD IN ('410','490','495')             AND (ENFM_WHLS_DTM_DT IS NULL OR ENFM_WHLS_DTM_DT > CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																																	ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																																END) 
																																AND (CASE WHEN (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL) THEN 1 ELSE 0 END = 0) 
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_ING_4    /* 주의 */           
			          ,CASE WHEN DSP_RQ_KND_CD IN ('510','520','530')       AND (ENFM_WHLS_DTM_DT IS NULL OR ENFM_WHLS_DTM_DT > CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																																	ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																																END) 
																																AND (CASE WHEN (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL) THEN 1 ELSE 0 END = 0) 
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_ING_5    /* 개선 */ 
			          ,CASE WHEN DSP_RQ_KND_CD = '611'                      AND (ENFM_WHLS_DTM_DT IS NULL OR ENFM_WHLS_DTM_DT > CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN LAST_DAY(ADD_MONTHS(#{proStadDt}, -1))
																																	ELSE TO_DATE(TO_CHAR(ADD_MONTHS(#{proStadDt}, -13), 'YYYY')||'-12-31')
																																END) 
																																AND (CASE WHEN (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL) THEN 1 ELSE 0 END = 0) 
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_ING_6    /* 권고 */ 
			          ,CASE WHEN DSP_RQ_KND_CD IN ('610','630','904','905','620','621','623','810','820','830','840','850','625') AND (ENFM_WHLS_DTM_DT IS NULL OR ENFM_WHLS_DTM_DT > '20170731') AND (CASE WHEN (T2.DTM_STA_CD = '2' AND T2.ENFM_WHLS_DTM_DT IS NULL) THEN 1 ELSE 0 END = 0) 
			                     THEN 1 ELSE 0 END 
			                                                                                  AS CNT_ING_7    /* 통보 */ 
			          
			          
			      FROM TBBADEAR001M T1
			          ,TBBADEAR002D T2
			     WHERE 1=1
			       AND T1.AUD_YR      = T2.AUD_YR
			       AND T1.AUD_NO      = T2.AUD_NO
			       AND T1.DSP_RQ_SNO  = T2.DSP_RQ_SNO
			       AND T2.DTM_STA_CD    IN ('1','2')  
					AND T2.ENF_DT        BETWEEN (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -49),0,4))
													ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -61),0,4))
												END) 
											AND (CASE WHEN SUBSTR(#{proStadDt},6,2) = '01' THEN TO_CHAR(SUBSTR(#{proStadDt},0,4))
													ELSE TO_CHAR(SUBSTR(ADD_MONTHS(#{proStadDt}, -1),0,4))
												END)
			       AND T2.ENFM_MNG_BRDV_CD IS NOT NULL  
			)  
				SELECT   CASE WHEN AUD_YR = '계' THEN '9999'
							ELSE AUD_YR
						END 								AS AUD_YR 
				        ,ROW_KND_CD
				        ,'Y' 								AS VIEW_YN 
						,CASE WHEN AUD_YR = '계' AND ROW_KND_CD = '0' THEN '계'
							WHEN AUD_YR = '계' AND ROW_KND_CD = '1' THEN '이행완료' 
							WHEN AUD_YR = '계' AND ROW_KND_CD = '2' THEN '이행중'
							WHEN AUD_YR = '계 ' AND ROW_KND_CD = '3' THEN '이행률(%)' 
							ELSE AUD_YR || '년 시행'
						END 								AS STTC_TIT1	  	        
				        ,CASE WHEN AUD_YR = '계' THEN '계' 
				        	ELSE '소계' 
				        END 								AS STTC_TIT2
				        ,CNT_DTM_SUM_TOTAL + CNT_ING_SUM_TOTAL 		AS STTC_COL1 --소계_건수_계    
				        ,CNT_DTM_SUM_1 + CNT_INF_SUM_1 		AS STTC_COL2 --변상_건수_계
				        ,AM_DTM_SUM_1 + AM_ING_SUM_1		AS STTC_COL3 --변상_금액_계
				        ,CNT_DTM_SUM_2 + CNT_ING_SUM_2		AS STTC_COL4 --징계_건수_계
				        ,CNT_STM_SUM_3 + CNT_ING_SUM_3		AS STTC_COL5 --시정_건수_계
				        ,AM_DTM_SUM_3 + AM_ING_SUM_3		AS STTC_COL6 --시정_금액_계
				        ,CNT_DTM_SUM_4 + CNT_ING_SUM_4		AS STTC_COL7 --주의_건수_계
				        ,CNT_DTM_SUM_5 + CNT_ING_SUM_5		AS STTC_COL8 --개선_건수_계
				        ,CNT_DTM_SUM_6 + CNT_ING_SUM_6		AS STTC_COL9 --권고_건수_계
				        ,CNT_DTM_SUM_7 + CNT_ING_SUM_7		AS STTC_COL10 --통보_건수_계
				        ,(CNT_DTM_SUM_TOTAL - CNT_DTM_SUM_6 - CNT_DTM_SUM_7) + (CNT_ING_SUM_TOTAL - CNT_ING_SUM_6 - CNT_ING_SUM_7)   AS STTC_COL11 --권고통보제외시_건수_계       
				  FROM (      
				        SELECT  NVL(END_DT_YR,'계')        AS AUD_YR --연도
				        		,'0' AS ROW_KND_CD
				              ,SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7)
				                                AS CNT_DTM_SUM_TOTAL --이행완료_건수_계
				              ,SUM(CNT_ING_1) + SUM(CNT_ING_2) + SUM(CNT_ING_3) + SUM(CNT_ING_4) + SUM(CNT_ING_5) + SUM(CNT_ING_6) + SUM(CNT_ING_7)
				                                AS CNT_ING_SUM_TOTAL --이행중_건수_계
				              ,ROUND(
				                        (SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7))   /
				                        
				                        (SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7) + 
				                         SUM(CNT_ING_1) + SUM(CNT_ING_2) + SUM(CNT_ING_3) + SUM(CNT_ING_4) + SUM(CNT_ING_5) + SUM(CNT_ING_6) + SUM(CNT_ING_7)) * 100
				                   ,1)                                                            AS CNT_ING_RATE_TOTAL --이행중_계_이행률
				                                
				              ,SUM(CNT_DTM_1)                                                     AS CNT_DTM_SUM_1 --변상_이행완료_건수
				              ,SUM(CNT_ING_1)                                                     AS CNT_INF_SUM_1 --변상_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_1) + SUM(CNT_ING_1) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_1) / (SUM(CNT_DTM_1) + SUM(CNT_ING_1)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_1 --변상_건수_이행률
				              
				              ,TRUNC(SUM(AM_DTM_1)/1000000)                                       AS AM_DTM_SUM_1 --변상_이행완료_금액
				              ,TRUNC(SUM(AM_ING_1)/1000000)                                       AS AM_ING_SUM_1 --변상_이행중_금액 
				              ,CASE WHEN SUM(AM_DTM_1) + SUM(AM_ING_1) = 0 THEN 0
				                    ELSE ROUND(SUM(AM_DTM_1) / (SUM(AM_DTM_1) + SUM(AM_ING_1)) * 100,1)     
				                END                                                               AS AM_DTM_RATE --변상_금액_이행률
				              
				              ,SUM(CNT_DTM_2)                                                     AS CNT_DTM_SUM_2 --징계_이행완료_건수
				              ,SUM(CNT_ING_2)                                                     AS CNT_ING_SUM_2 --징계_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_2) + SUM(CNT_ING_2) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_2) / (SUM(CNT_DTM_2) + SUM(CNT_ING_2)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_2 --징계_건수_이행률              
				              
				              ,SUM(CNT_DTM_3)                                                     AS CNT_STM_SUM_3 --시정_이행완료_건수
				              ,SUM(CNT_ING_3)                                                     AS CNT_ING_SUM_3 --시정_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_3) + SUM(CNT_ING_3) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_3) / (SUM(CNT_DTM_3) + SUM(CNT_ING_3)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_3 --시정_건수_이행률                
				              
				              ,TRUNC(SUM(AM_DTM_3)/1000000)                                       AS AM_DTM_SUM_3 --시정_이행완료_금액
				              ,TRUNC(SUM(AM_ING_3)/1000000)                                       AS AM_ING_SUM_3 --시정_이행중_금액 
				              ,CASE WHEN SUM(AM_DTM_3) + SUM(AM_ING_3) = 0 THEN 0 
				                    ELSE ROUND(SUM(AM_DTM_3) / (SUM(AM_DTM_3) + SUM(AM_ING_3)) * 100,1)     
				                END                                                               AS AM_DTM_RATE_3 --시정_금액_이행률              
				              
				              ,SUM(CNT_DTM_4)                                                     AS CNT_DTM_SUM_4 --주의_이행완료_건수
				              ,SUM(CNT_ING_4)                                                     AS CNT_ING_SUM_4 --주의_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_4) + SUM(CNT_ING_4) = 0 THEN 0 
				                    ELSE ROUND(SUM(CNT_DTM_4) / (SUM(CNT_DTM_4) + SUM(CNT_ING_4)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_4 --주의_건수_이행률 
				              
				              ,SUM(CNT_DTM_5)                                                     AS CNT_DTM_SUM_5 --개선_이행완료_건수
				              ,SUM(CNT_ING_5)                                                     AS CNT_ING_SUM_5 --개선_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_5) + SUM(CNT_ING_5) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_5) / (SUM(CNT_DTM_5) + SUM(CNT_ING_5)) * 100,1)  
				                 END                                                              AS CNT_DTM_RATE_5 --개선_건수_이행률 
				              
				              ,SUM(CNT_DTM_6)                                                     AS CNT_DTM_SUM_6 --권고_이행완료_건수
				              ,SUM(CNT_ING_6)                                                     AS CNT_ING_SUM_6 --권고_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_6) + SUM(CNT_ING_6) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_6) / (SUM(CNT_DTM_6) + SUM(CNT_ING_6)) * 100,1)  
				                 END                                                              AS CNT_DTM_RATE_6 --권고_건수_이행률 
				              
				              ,SUM(CNT_DTM_7)                                                     AS CNT_DTM_SUM_7 --통보_이행완료_건수          
				              ,SUM(CNT_ING_7)                                                     AS CNT_ING_SUM_7 --통보_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_6) + SUM(CNT_ING_6) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_7) / (SUM(CNT_DTM_7) + SUM(CNT_ING_7)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_7 --통보_건수_이행률 
				              
				          FROM BASE
				          GROUP BY ROLLUP(END_DT_YR)
				)
			UNION ALL
				SELECT   CASE WHEN AUD_YR = '계' THEN '9999'
							ELSE AUD_YR
						END 								AS AUD_YR 
				        ,ROW_KND_CD
				        ,'Y' 								AS VIEW_YN 
						,CASE WHEN AUD_YR = '계' AND ROW_KND_CD = '0' THEN '계'
							WHEN AUD_YR = '계' AND ROW_KND_CD = '1' THEN '이행완료' 
							WHEN AUD_YR = '계' AND ROW_KND_CD = '2' THEN '이행중'
							WHEN AUD_YR = '계 ' AND ROW_KND_CD = '3' THEN '이행률(%)' 
							ELSE AUD_YR || '년 시행'
						END 				AS STTC_TIT1	         
				        ,'이행완료'			AS STTC_TIT2	        
				        ,CNT_DTM_SUM_TOTAL	AS STTC_COL1
				        ,CNT_DTM_SUM_1		AS STTC_COL2
				        ,AM_DTM_SUM_1		AS STTC_COL3
				        ,CNT_DTM_SUM_2		AS STTC_COL4
				        ,CNT_STM_SUM_3		AS STTC_COL5
				        ,AM_DTM_SUM_3		AS STTC_COL6
				        ,CNT_DTM_SUM_4		AS STTC_COL7
				        ,CNT_DTM_SUM_5		AS STTC_COL8
				        ,CNT_DTM_SUM_6		AS STTC_COL9
				        ,CNT_DTM_SUM_7		AS STTC_COL10
				        ,CNT_DTM_SUM_TOTAL - CNT_DTM_SUM_6 - CNT_DTM_SUM_7 AS STTC_COL11      
				  FROM (      
				        SELECT  NVL(END_DT_YR,'계')        AS AUD_YR --연도
				        		,'1' AS ROW_KND_CD
				              ,SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7)
				                                AS CNT_DTM_SUM_TOTAL --이행완료_건수_계
				              ,SUM(CNT_ING_1) + SUM(CNT_ING_2) + SUM(CNT_ING_3) + SUM(CNT_ING_4) + SUM(CNT_ING_5) + SUM(CNT_ING_6) + SUM(CNT_ING_7)
				                                AS CNT_ING_SUM_TOTAL --이행중_건수_계
				              ,ROUND(
				                        (SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7))   /
				                        
				                        (SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7) + 
				                         SUM(CNT_ING_1) + SUM(CNT_ING_2) + SUM(CNT_ING_3) + SUM(CNT_ING_4) + SUM(CNT_ING_5) + SUM(CNT_ING_6) + SUM(CNT_ING_7)) * 100
				                   ,1)                                                            AS CNT_ING_RATE_TOTAL --이행중_계_이행률
				                                
				              ,SUM(CNT_DTM_1)                                                     AS CNT_DTM_SUM_1 --변상_이행완료_건수
				              ,SUM(CNT_ING_1)                                                     AS CNT_INF_SUM_1 --변상_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_1) + SUM(CNT_ING_1) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_1) / (SUM(CNT_DTM_1) + SUM(CNT_ING_1)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_1 --변상_건수_이행률
				              
				              ,TRUNC(SUM(AM_DTM_1)/1000000)                                       AS AM_DTM_SUM_1 --변상_이행완료_금액
				              ,TRUNC(SUM(AM_ING_1)/1000000)                                       AS AM_ING_SUM_1 --변상_이행중_금액 
				              ,CASE WHEN SUM(AM_DTM_1) + SUM(AM_ING_1) = 0 THEN 0
				                    ELSE ROUND(SUM(AM_DTM_1) / (SUM(AM_DTM_1) + SUM(AM_ING_1)) * 100,1)     
				                END                                                               AS AM_DTM_RATE --변상_금액_이행률
				              
				              ,SUM(CNT_DTM_2)                                                     AS CNT_DTM_SUM_2 --징계_이행완료_건수
				              ,SUM(CNT_ING_2)                                                     AS CNT_ING_SUM_2 --징계_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_2) + SUM(CNT_ING_2) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_2) / (SUM(CNT_DTM_2) + SUM(CNT_ING_2)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_2 --징계_건수_이행률              
				              
				              ,SUM(CNT_DTM_3)                                                     AS CNT_STM_SUM_3 --시정_이행완료_건수
				              ,SUM(CNT_ING_3)                                                     AS CNT_ING_SUM_3 --시정_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_3) + SUM(CNT_ING_3) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_3) / (SUM(CNT_DTM_3) + SUM(CNT_ING_3)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_3 --시정_건수_이행률                
				              
				              ,TRUNC(SUM(AM_DTM_3)/1000000)                                       AS AM_DTM_SUM_3 --시정_이행완료_금액
				              ,TRUNC(SUM(AM_ING_3)/1000000)                                       AS AM_ING_SUM_3 --시정_이행중_금액 
				              ,CASE WHEN SUM(AM_DTM_3) + SUM(AM_ING_3) = 0 THEN 0 
				                    ELSE ROUND(SUM(AM_DTM_3) / (SUM(AM_DTM_3) + SUM(AM_ING_3)) * 100,1)     
				                END                                                               AS AM_DTM_RATE_3 --시정_금액_이행률              
				              
				              ,SUM(CNT_DTM_4)                                                     AS CNT_DTM_SUM_4 --주의_이행완료_건수
				              ,SUM(CNT_ING_4)                                                     AS CNT_ING_SUM_4 --주의_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_4) + SUM(CNT_ING_4) = 0 THEN 0 
				                    ELSE ROUND(SUM(CNT_DTM_4) / (SUM(CNT_DTM_4) + SUM(CNT_ING_4)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_4 --주의_건수_이행률 
				              
				              ,SUM(CNT_DTM_5)                                                     AS CNT_DTM_SUM_5 --개선_이행완료_건수
				              ,SUM(CNT_ING_5)                                                     AS CNT_ING_SUM_5 --개선_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_5) + SUM(CNT_ING_5) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_5) / (SUM(CNT_DTM_5) + SUM(CNT_ING_5)) * 100,1)  
				                 END                                                              AS CNT_DTM_RATE_5 --개선_건수_이행률 
				              
				              ,SUM(CNT_DTM_6)                                                     AS CNT_DTM_SUM_6 --권고_이행완료_건수
				              ,SUM(CNT_ING_6)                                                     AS CNT_ING_SUM_6 --권고_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_6) + SUM(CNT_ING_6) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_6) / (SUM(CNT_DTM_6) + SUM(CNT_ING_6)) * 100,1)  
				                 END                                                              AS CNT_DTM_RATE_6 --권고_건수_이행률 
				              
				              ,SUM(CNT_DTM_7)                                                     AS CNT_DTM_SUM_7 --통보_이행완료_건수          
				              ,SUM(CNT_ING_7)                                                     AS CNT_ING_SUM_7 --통보_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_6) + SUM(CNT_ING_6) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_7) / (SUM(CNT_DTM_7) + SUM(CNT_ING_7)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_7 --통보_건수_이행률 
				              
				          FROM BASE
				          GROUP BY ROLLUP(END_DT_YR)
				)
			UNION ALL
				SELECT   CASE WHEN AUD_YR = '계' THEN '9999'
							ELSE AUD_YR
						END 								AS AUD_YR 
				        ,ROW_KND_CD
				        ,'Y' 								AS VIEW_YN 
						,CASE WHEN AUD_YR = '계' AND ROW_KND_CD = '0' THEN '계'
							WHEN AUD_YR = '계' AND ROW_KND_CD = '1' THEN '이행완료' 
							WHEN AUD_YR = '계' AND ROW_KND_CD = '2' THEN '이행중'
							WHEN AUD_YR = '계 ' AND ROW_KND_CD = '3' THEN '이행률(%)' 
							ELSE AUD_YR || '년 시행'
						END 				AS STTC_TIT1	  
				        ,'이행중'				AS STTC_TIT2	        
				        ,CNT_ING_SUM_TOTAL	AS STTC_COL1
				        ,CNT_INF_SUM_1	 	AS STTC_COL2
				        ,AM_ING_SUM_1 	 	AS STTC_COL3
				        ,CNT_ING_SUM_2 	 	AS STTC_COL4
				        ,CNT_ING_SUM_3 	 	AS STTC_COL5
				        ,AM_ING_SUM_3 	 	AS STTC_COL6
				        ,CNT_ING_SUM_4 	 	AS STTC_COL7
				        ,CNT_ING_SUM_5 	 	AS STTC_COL8
				        ,CNT_ING_SUM_6 	 	AS STTC_COL9
				        ,CNT_ING_SUM_7 	 	AS STTC_COL10
				        ,(CNT_ING_SUM_TOTAL - CNT_ING_SUM_6 - CNT_ING_SUM_7)   AS STTC_COL11
				  FROM (      
				        SELECT  NVL(END_DT_YR,'계')        AS AUD_YR --연도
				        		,'2' AS ROW_KND_CD
				              ,SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7)
				                                AS CNT_DTM_SUM_TOTAL --이행완료_건수_계
				              ,SUM(CNT_ING_1) + SUM(CNT_ING_2) + SUM(CNT_ING_3) + SUM(CNT_ING_4) + SUM(CNT_ING_5) + SUM(CNT_ING_6) + SUM(CNT_ING_7)
				                                AS CNT_ING_SUM_TOTAL --이행중_건수_계
				              ,ROUND(
				                        (SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7))   /
				                        
				                        (SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7) + 
				                         SUM(CNT_ING_1) + SUM(CNT_ING_2) + SUM(CNT_ING_3) + SUM(CNT_ING_4) + SUM(CNT_ING_5) + SUM(CNT_ING_6) + SUM(CNT_ING_7)) * 100
				                   ,1)                                                            AS CNT_ING_RATE_TOTAL --이행중_계_이행률
				                                
				              ,SUM(CNT_DTM_1)                                                     AS CNT_DTM_SUM_1 --변상_이행완료_건수
				              ,SUM(CNT_ING_1)                                                     AS CNT_INF_SUM_1 --변상_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_1) + SUM(CNT_ING_1) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_1) / (SUM(CNT_DTM_1) + SUM(CNT_ING_1)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_1 --변상_건수_이행률
				              ,TRUNC(SUM(AM_DTM_1)/1000000)                                       AS AM_DTM_SUM_1 --변상_이행완료_금액
				              ,TRUNC(SUM(AM_ING_1)/1000000)                                       AS AM_ING_SUM_1 --변상_이행중_금액 
				              ,CASE WHEN SUM(AM_DTM_1) + SUM(AM_ING_1) = 0 THEN 0
				                    ELSE ROUND(SUM(AM_DTM_1) / (SUM(AM_DTM_1) + SUM(AM_ING_1)) * 100,1)     
				                END                                                               AS AM_DTM_RATE --변상_금액_이행률
				              
				              ,SUM(CNT_DTM_2)                                                     AS CNT_DTM_SUM_2 --징계_이행완료_건수
				              ,SUM(CNT_ING_2)                                                     AS CNT_ING_SUM_2 --징계_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_2) + SUM(CNT_ING_2) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_2) / (SUM(CNT_DTM_2) + SUM(CNT_ING_2)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_2 --징계_건수_이행률              
				              
				              ,SUM(CNT_DTM_3)                                                     AS CNT_STM_SUM_3 --시정_이행완료_건수
				              ,SUM(CNT_ING_3)                                                     AS CNT_ING_SUM_3 --시정_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_3) + SUM(CNT_ING_3) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_3) / (SUM(CNT_DTM_3) + SUM(CNT_ING_3)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_3 --시정_건수_이행률                
				              
				              ,TRUNC(SUM(AM_DTM_3)/1000000)                                       AS AM_DTM_SUM_3 --시정_이행완료_금액
				              ,TRUNC(SUM(AM_ING_3)/1000000)                                       AS AM_ING_SUM_3 --시정_이행중_금액 
				              ,CASE WHEN SUM(AM_DTM_3) + SUM(AM_ING_3) = 0 THEN 0 
				                    ELSE ROUND(SUM(AM_DTM_3) / (SUM(AM_DTM_3) + SUM(AM_ING_3)) * 100,1)     
				                END                                                               AS AM_DTM_RATE_3 --시정_금액_이행률              
				              
				              ,SUM(CNT_DTM_4)                                                     AS CNT_DTM_SUM_4 --주의_이행완료_건수
				              ,SUM(CNT_ING_4)                                                     AS CNT_ING_SUM_4 --주의_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_4) + SUM(CNT_ING_4) = 0 THEN 0 
				                    ELSE ROUND(SUM(CNT_DTM_4) / (SUM(CNT_DTM_4) + SUM(CNT_ING_4)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_4 --주의_건수_이행률 
				              
				              ,SUM(CNT_DTM_5)                                                     AS CNT_DTM_SUM_5 --개선_이행완료_건수
				              ,SUM(CNT_ING_5)                                                     AS CNT_ING_SUM_5 --개선_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_5) + SUM(CNT_ING_5) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_5) / (SUM(CNT_DTM_5) + SUM(CNT_ING_5)) * 100,1)  
				                 END                                                              AS CNT_DTM_RATE_5 --개선_건수_이행률 
				              
				              ,SUM(CNT_DTM_6)                                                     AS CNT_DTM_SUM_6 --권고_이행완료_건수
				              ,SUM(CNT_ING_6)                                                     AS CNT_ING_SUM_6 --권고_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_6) + SUM(CNT_ING_6) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_6) / (SUM(CNT_DTM_6) + SUM(CNT_ING_6)) * 100,1)  
				                 END                                                              AS CNT_DTM_RATE_6 --권고_건수_이행률 
				              
				              ,SUM(CNT_DTM_7)                                                     AS CNT_DTM_SUM_7 --통보_이행완료_건수          
				              ,SUM(CNT_ING_7)                                                     AS CNT_ING_SUM_7 --통보_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_6) + SUM(CNT_ING_6) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_7) / (SUM(CNT_DTM_7) + SUM(CNT_ING_7)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_7 --통보_건수_이행률 
				              
				          FROM BASE
				          GROUP BY ROLLUP(END_DT_YR)
				)
			UNION ALL
				SELECT   CASE WHEN AUD_YR = '계' THEN '9999'
							ELSE AUD_YR
						END 								AS AUD_YR 
				        ,ROW_KND_CD
				        ,'Y' 								AS VIEW_YN 
						,CASE WHEN AUD_YR = '계' AND ROW_KND_CD = '0' THEN '계'
							WHEN AUD_YR = '계' AND ROW_KND_CD = '1' THEN '이행완료' 
							WHEN AUD_YR = '계' AND ROW_KND_CD = '2' THEN '이행중'
							WHEN AUD_YR = '계' AND ROW_KND_CD = '3' THEN '이행률(%)' 
							ELSE AUD_YR || '년 시행'
						END 				AS STTC_TIT1	  
				        ,'이행률(%)'				AS STTC_TIT2		
				        ,CNT_ING_RATE_TOTAL 	AS STTC_COL1
				        ,CNT_DTM_RATE_1 		AS STTC_COL2
				        ,AM_DTM_RATE 			AS STTC_COL3
				        ,CNT_DTM_RATE_2   		AS STTC_COL4            
				        ,CNT_DTM_RATE_3  		AS STTC_COL5               
				        ,AM_DTM_RATE_3   		AS STTC_COL6            
				        ,CNT_DTM_RATE_4  		AS STTC_COL7
				        ,CNT_DTM_RATE_5  		AS STTC_COL8
				        ,CNT_DTM_RATE_6  		AS STTC_COL9
				        ,CNT_DTM_RATE_7  		AS STTC_COL10
				        ,ROUND(
				                (CNT_DTM_SUM_TOTAL - CNT_DTM_SUM_6 - CNT_DTM_SUM_7) / 
				                ((CNT_DTM_SUM_TOTAL - CNT_DTM_SUM_6 - CNT_DTM_SUM_7) + (CNT_ING_SUM_TOTAL   - CNT_ING_SUM_6   - CNT_ING_SUM_7)) * 100
				               ,1)								  		AS STTC_COL11
				  FROM (      
				        SELECT  NVL(END_DT_YR,'계')        AS AUD_YR --연도
				        		,'3' AS ROW_KND_CD
				              ,SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7)
				                                AS CNT_DTM_SUM_TOTAL --이행완료_건수_계
				              ,SUM(CNT_ING_1) + SUM(CNT_ING_2) + SUM(CNT_ING_3) + SUM(CNT_ING_4) + SUM(CNT_ING_5) + SUM(CNT_ING_6) + SUM(CNT_ING_7)
				                                AS CNT_ING_SUM_TOTAL --이행중_건수_계
				              ,ROUND(
				                        (SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7))   /
				                        
				                        (SUM(CNT_DTM_1) + SUM(CNT_DTM_2) + SUM(CNT_DTM_3) + SUM(CNT_DTM_4) + SUM(CNT_DTM_5) + SUM(CNT_DTM_6) + SUM(CNT_DTM_7) + 
				                         SUM(CNT_ING_1) + SUM(CNT_ING_2) + SUM(CNT_ING_3) + SUM(CNT_ING_4) + SUM(CNT_ING_5) + SUM(CNT_ING_6) + SUM(CNT_ING_7)) * 100
				                   ,1)                                                            AS CNT_ING_RATE_TOTAL --이행중_계_이행률
				                                
				              ,SUM(CNT_DTM_1)                                                     AS CNT_DTM_SUM_1 --변상_이행완료_건수
				              ,SUM(CNT_ING_1)                                                     AS CNT_INF_SUM_1 --변상_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_1) + SUM(CNT_ING_1) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_1) / (SUM(CNT_DTM_1) + SUM(CNT_ING_1)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_1 --변상_건수_이행률
				              
				              ,TRUNC(SUM(AM_DTM_1)/1000000)                                       AS AM_DTM_SUM_1 --변상_이행완료_금액
				              ,TRUNC(SUM(AM_ING_1)/1000000)                                       AS AM_ING_SUM_1 --변상_이행중_금액 
				              ,CASE WHEN SUM(AM_DTM_1) + SUM(AM_ING_1) = 0 THEN 0
				                    ELSE ROUND(SUM(AM_DTM_1) / (SUM(AM_DTM_1) + SUM(AM_ING_1)) * 100,1)     
				                END                                                               AS AM_DTM_RATE --변상_금액_이행률
				              
				              ,SUM(CNT_DTM_2)                                                     AS CNT_DTM_SUM_2 --징계_이행완료_건수
				              ,SUM(CNT_ING_2)                                                     AS CNT_ING_SUM_2 --징계_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_2) + SUM(CNT_ING_2) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_2) / (SUM(CNT_DTM_2) + SUM(CNT_ING_2)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_2 --징계_건수_이행률              
				              
				              ,SUM(CNT_DTM_3)                                                     AS CNT_STM_SUM_3 --시정_이행완료_건수
				              ,SUM(CNT_ING_3)                                                     AS CNT_ING_SUM_3 --시정_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_3) + SUM(CNT_ING_3) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_3) / (SUM(CNT_DTM_3) + SUM(CNT_ING_3)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_3 --시정_건수_이행률                
				              
				              ,TRUNC(SUM(AM_DTM_3)/1000000)                                       AS AM_DTM_SUM_3 --시정_이행완료_금액
				              ,TRUNC(SUM(AM_ING_3)/1000000)                                       AS AM_ING_SUM_3 --시정_이행중_금액 
				              ,CASE WHEN SUM(AM_DTM_3) + SUM(AM_ING_3) = 0 THEN 0 
				                    ELSE ROUND(SUM(AM_DTM_3) / (SUM(AM_DTM_3) + SUM(AM_ING_3)) * 100,1)     
				                END                                                               AS AM_DTM_RATE_3 --시정_금액_이행률              
				              
				              ,SUM(CNT_DTM_4)                                                     AS CNT_DTM_SUM_4 --주의_이행완료_건수
				              ,SUM(CNT_ING_4)                                                     AS CNT_ING_SUM_4 --주의_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_4) + SUM(CNT_ING_4) = 0 THEN 0 
				                    ELSE ROUND(SUM(CNT_DTM_4) / (SUM(CNT_DTM_4) + SUM(CNT_ING_4)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_4 --주의_건수_이행률 
				              
				              ,SUM(CNT_DTM_5)                                                     AS CNT_DTM_SUM_5 --개선_이행완료_건수
				              ,SUM(CNT_ING_5)                                                     AS CNT_ING_SUM_5 --개선_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_5) + SUM(CNT_ING_5) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_5) / (SUM(CNT_DTM_5) + SUM(CNT_ING_5)) * 100,1)  
				                 END                                                              AS CNT_DTM_RATE_5 --개선_건수_이행률 
				              
				              ,SUM(CNT_DTM_6)                                                     AS CNT_DTM_SUM_6 --권고_이행완료_건수
				              ,SUM(CNT_ING_6)                                                     AS CNT_ING_SUM_6 --권고_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_6) + SUM(CNT_ING_6) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_6) / (SUM(CNT_DTM_6) + SUM(CNT_ING_6)) * 100,1)  
				                 END                                                              AS CNT_DTM_RATE_6 --권고_건수_이행률 
				              
				              ,SUM(CNT_DTM_7)                                                     AS CNT_DTM_SUM_7 --통보_이행완료_건수          
				              ,SUM(CNT_ING_7)                                                     AS CNT_ING_SUM_7 --통보_이행중_건수 
				              ,CASE WHEN SUM(CNT_DTM_6) + SUM(CNT_ING_6) = 0 THEN 0
				                    ELSE ROUND(SUM(CNT_DTM_7) / (SUM(CNT_DTM_7) + SUM(CNT_ING_7)) * 100,1)  
				                END                                                               AS CNT_DTM_RATE_7 --통보_건수_이행률 
				              
				          FROM BASE
				          GROUP BY ROLLUP(END_DT_YR)
				)
			ORDER BY AUD_YR DESC, ROW_KND_CD 
        ]]>
    </select>
    
    <select id="selectComboList" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.aep.arp.dao.FAACAV207QMapper.selectAffComboList */
            SELECT STTC_TYP_SEQ AS CD,
                   STTC_YR || '년 ' || STTC_STR_MON || '월' || DECODE(STTC_END_MON, '01', '', ' ~ ' || STTC_END_MON || '월') AS CD_NM
              FROM TWFAACAV200M 
             WHERE STTC_TYP_CD = '20'
               AND STTC_CLSF_CD = '207'
        ]]>
        <if test='mngDptYn != "Y"'>
               AND STTC_DTM_DY IS NOT NULL
        </if>
        <![CDATA[
        	ORDER BY STTC_TYP_SEQ DESC
        ]]>
    </select>
    
    <select id="selectSttcList" parameterType="paramMap" resultType="egovMap">
        <![CDATA[
        /* kr.go.bai.eip.aep.arp.dao.FAACAV207QMapper.selectSttcList */
            SELECT T1.RMK
                  ,T1.ADM_OPIN
                  ,TO_CHAR(T1.STTC_PROD_STAD_DY,'YYYY-MM-DD') AS STTC_PROD_STAD_DY
                  ,CASE WHEN T1.STTC_DTM_DY IS NULL THEN 'N'
                        ELSE 'Y'
                   END AS STTC_DTM_YN
                  ,T2.STTC_TYP_CD
                  ,T2.STTC_CLSF_CD
                  ,T2.STTC_TYP_SEQ
                  ,T2.STTC_DATA_SNO
                  ,T2.STTC_TIT1
                  ,T2.STTC_TIT2
                  ,T2.STTC_COL1
                  ,T2.STTC_COL2
                  ,T2.STTC_COL3
                  ,T2.STTC_COL4
                  ,T2.STTC_COL5
                  ,T2.STTC_COL6
                  ,T2.STTC_COL7
                  ,T2.STTC_COL8
                  ,T2.STTC_COL9
                  ,T2.STTC_COL10
                  ,T2.STTC_COL11                  
                  ,CASE WHEN T1.STTC_YR - 5 > T2.AUD_YR THEN 'N'
                        ELSE 'Y'
                   END VIEW_YN
                  ,T2.AUD_YR
                  ,T2.ROW_KND_CD
                  ,NVL(TO_CHAR(T1.STTC_DTM_DY,'YYYY"-"MM"-"DD'),'미확정') AS STTC_DTM_DY
              FROM TWFAACAV200M T1
             INNER JOIN TWFAACAV200D T2 ON (
                        T1.STTC_TYP_CD = T2.STTC_TYP_CD
                    AND T1.STTC_CLSF_CD = T2.STTC_CLSF_CD
                    AND T1.STTC_TYP_SEQ = T2.STTC_TYP_SEQ )
             WHERE T1.STTC_CLSF_CD = '207'
               AND T1.STTC_TYP_SEQ = #{sttcTypSeq}
             ORDER BY STTC_DATA_SNO
        ]]>
    </select>
    
    <insert id="insertMaster">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV207QMapper.insertMaster */
        <![CDATA[
            INSERT INTO TWFAACAV200M (
                 STTC_TYP_CD
                ,STTC_CLSF_CD
                ,STTC_TYP_SEQ
                ,STTC_YR
                ,STTC_STR_MON
                ,STTC_END_MON
                ,STTC_PROD_STAD_DY
                ,STTC_DTM_DY
                ,RMK
                ,ADM_OPIN
                ,FRT_USR_ID
                ,FNL_USR_ID
                ,FNL_DEAL_DPT_CD
                ,FNL_MNU_ID
                ,FRT_REGI_DH
                ,FNL_MDF_DH )
            VALUES (
                 '20'
                ,'207'
                ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0) + 1
                     FROM TWFAACAV200M
                    WHERE STTC_TYP_CD = '20'
                      AND STTC_CLSF_CD = '207' )
                ,SUBSTR(ADD_MONTHS(#{proStadDt}, -1), 0, 4)
                ,'01'
                ,TO_CHAR(TO_DATE(ADD_MONTHS(#{proStadDt}, -1)), 'MM')
                ,#{proStadDt}
                ,''
                ,#{rmk}
                ,#{admOpin}
                ,#{usrId}
                ,#{usrId}
                ,#{dptCd}
                ,#{mnuId}
                ,SYSDATE
                ,SYSDATE )
        ]]>
    </insert>
    
    <insert id="insertDetail">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV207QMapper.insertDetail */
        <![CDATA[
            INSERT INTO TWFAACAV200D (
                 STTC_TYP_CD
                ,STTC_CLSF_CD
                ,STTC_TYP_SEQ
                ,STTC_DATA_SNO
                ,STTC_TIT1
                ,STTC_TIT2
                ,STTC_COL1
                ,STTC_COL2
                ,STTC_COL3
                ,STTC_COL4
                ,STTC_COL5
                ,STTC_COL6
                ,STTC_COL7
                ,STTC_COL8
                ,STTC_COL9
                ,STTC_COL10
				,STTC_COL11
                ,AUD_YR
                ,ROW_KND_CD
                ,FRT_USR_ID
                ,FNL_USR_ID
                ,FNL_DEAL_DPT_CD
                ,FNL_MNU_ID
                ,FRT_REGI_DH
                ,FNL_MDF_DH )
            VALUES (
                 '20'
                ,'207'
                ,( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
                     FROM TWFAACAV200M
                    WHERE STTC_TYP_CD = '20'
                      AND STTC_CLSF_CD = '207' )
                ,( SELECT NVL(MAX(STTC_DATA_SNO), 0) + 1
                     FROM TWFAACAV200D
                    WHERE STTC_TYP_CD = '20'
                      AND STTC_CLSF_CD = '207' 
                      AND STTC_TYP_SEQ = ( SELECT NVL(MAX(STTC_TYP_SEQ), 0)
                                             FROM TWFAACAV200M
                                            WHERE STTC_TYP_CD = '20'
                                              AND STTC_CLSF_CD = '207' ))
                ,#{sttcTit1}
                ,#{sttcTit2}
                ,#{sttcCol1}
                ,#{sttcCol2}
                ,#{sttcCol3}
                ,#{sttcCol4}
                ,#{sttcCol5}
                ,#{sttcCol6}
                ,#{sttcCol7}
                ,#{sttcCol8}
                ,#{sttcCol9}
                ,#{sttcCol10}
                ,#{sttcCol11}  
                ,#{audYr}
                ,#{rowKndCd}
                ,#{usrId}
                ,#{usrId}
                ,#{dptCd}
                ,#{mnuId}
                ,SYSDATE
                ,SYSDATE )
        ]]>
    </insert>
    
    <insert id="updateMaster">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV207QMapper.updateMaster */
        <![CDATA[
            UPDATE TWFAACAV200M
               SET RMK = #{rmk}
                  ,ADM_OPIN = #{admOpin}
                  ,FNL_USR_ID = #{usrId}
                  ,FNL_DEAL_DPT_CD = #{dptCd}
                  ,FNL_MDF_DH = SYSDATE
             WHERE STTC_TYP_CD = #{sttcTypCd}
               AND STTC_CLSF_CD = #{sttcClsfCd}
               AND STTC_TYP_SEQ = #{sttcTypSeq}
        ]]>
    </insert>
    
    <insert id="updateDetail">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV207QMapper.updateDetail */
        <![CDATA[
            UPDATE TWFAACAV200D
               SET STTC_COL1 = #{sttcCol1}
                  ,STTC_COL2 = #{sttcCol2}
                  ,STTC_COL3 = #{sttcCol3}
                  ,STTC_COL4 = #{sttcCol4}
                  ,STTC_COL5 = #{sttcCol5}
                  ,STTC_COL6 = #{sttcCol6}
                  ,STTC_COL7 = #{sttcCol7}
                  ,STTC_COL8 = #{sttcCol8}
                  ,STTC_COL9 = #{sttcCol9}
                  ,STTC_COL10 = #{sttcCol10}
                  ,STTC_COL11 = #{sttcCol11}
                  ,FNL_USR_ID = #{usrId}
                  ,FNL_DEAL_DPT_CD = #{dptCd}
                  ,FNL_MDF_DH = SYSDATE
             WHERE STTC_TYP_CD = #{sttcTypCd}
               AND STTC_CLSF_CD = #{sttcClsfCd}
               AND STTC_TYP_SEQ = #{sttcTypSeq}
               AND STTC_DATA_SNO = #{sttcDataSno}
        ]]>
    </insert>
    
    <insert id="updateMasterDtmDy">
        /* kr.go.bai.eip.faa.cav.dao.FAACAV207QMapper.updateMasterDtmDy */
        <![CDATA[
            UPDATE TWFAACAV200M
               SET STTC_DTM_DY = SYSDATE
                  ,FNL_USR_ID = #{usrId}
                  ,FNL_DEAL_DPT_CD = #{dptCd}
                  ,FNL_MDF_DH = SYSDATE
             WHERE STTC_TYP_CD = #{sttcTypCd}
               AND STTC_CLSF_CD = #{sttcClsfCd}
               AND STTC_TYP_SEQ = #{sttcTypSeq}
        ]]>
    </insert>
    
</mapper>