<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.cor.cor.dao.COR002002EMapper">
 	<resultMap type="java.util.HashMap" id="cspdcpMap">
 		<result property="ein1" column="EIN1"                   jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result property="ein2" column="EIN2"                   jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result property="reqDvsnCd" column="REQ_DVSN_CD"                   jdbcType="VARCHAR" javaType="java.lang.String" />
		<result property="acpYr" column="ACP_YR"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptAcpNo" column="CVPT_ACP_NO"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpNo" column="ACP_NO"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="rmCvptAcpNo" column="RM_CVPT_ACP_NO"              jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptKndCd" column="CVPT_KND_CD"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="reqrKndCd" column="REQR_KND_CD"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpRutCd" column="ACP_RUT_CD"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpRutDtlCd" column="ACP_RUT_DTL_CD"             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptrNm" column="CVPTR_NM"                         jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="btdt" column="BTDT"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="jbNm" column="JB_NM"                               jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="rpstPenNm" column="RPST_PEN_NM"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="bzn" column="BZN"                                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cpnmNm" column="CPNM_NM"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="zcd" column="ZCD"                                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="ad" column="AD"                                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="dtlAd" column="DTL_AD"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="tnb1" column="TNB1"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="tnb2" column="TNB2"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="tnb3" column="TNB3"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="tnb" column="TNB"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hpn1" column="HPN1"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hpn2" column="HPN2"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hpn3" column="HPN3"                                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hpn" column="HPN"                                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="emlId" column="EML_ID"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="emlDmiNm" column="EML_DMI_NM"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="openYn" column="OPEN_YN"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="mngTypCd" column="MNG_TYP_CD"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="rsltNtfWayCd" column="RSLT_NTF_WAY_CD"           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="titNm" column="TIT_NM"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpDptCd" column="ACP_DPT_CD"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpDptNm" column="ACP_DPT_NM"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="rcepId" column="RCEP_ID"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="rcepNm" column="RCEP_NM"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="acpDh" column="ACP_DH"                             jdbcType="VARCHAR" javaType="java.lang.String" />
		<result property="cvptHndlStaCd" column="CVPT_HNDL_STA_CD"         jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="audInfTgYn" column="AUD_INF_TG_YN"               jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="smgCvptAplNo" column="SMG_CVPT_APL_NO"           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="smgCvptAcpNo" column="SMG_CVPT_ACP_NO"           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="smgFnlHndlStaCd" column="SMG_FNL_HNDL_STA_CD"   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="smgCvptAplDh" column="SMG_CVPT_APL_DH"           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="smgFrtCvptAplGccOrgCd" column="SMG_FRT_CVPT_APL_GCC_ORG_CD"           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="smgCatHstSrno" column="SMG_CAT_HST_SRNO"           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptWdwDh" column="CVPT_WDW_DH"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptWdwRsn" column="CVPT_WDW_RSN"                 jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptTxt" column="CVPT_TXT"                         jdbcType="CLOB"      javaType="java.lang.String" />
		<result property="cvptSbt" column="CVPT_SBT"                         jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmNm" column="CLM_NM"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="wrkPlacNm" column="WRK_PLAC_NM"                   jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmTnb1" column="CLM_TNB1"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmTnb2" column="CLM_TNB2"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmTnb3" column="CLM_TNB3"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmZcd" column="CLM_ZCD"                           jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmAd" column="CLM_AD"                             jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="clmDtlAd" column="CLM_DTL_AD"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="docId" column="DOC_ID"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="cvptHndlStaNm" column="CVPT_HNDL_STA_NM"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hmpAplNo" column="HMP_APL_NO"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="hmpSmgAplNo" column="HMP_SMG_APL_NO"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="innerYn" column="INNER_YN"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="peropenAgrYn" column="PEROPEN_AGR_YN"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="otherSubYn" column="OTHER_SUB_YN"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="otherSubTxt" column="OTHER_SUB_TXT"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="adminiYn" column="ADMINI_YN"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="dtyYn" column="DTY_YN"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="dtyTxt" column="DTY_TXT"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="innerOrgNm" column="INNER_ORG_NM"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="pos" column="POS"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
		<result property="kiwCvptAplNo" column="KIW_CVPT_APL_NO"                     jdbcType="VARCHAR"  javaType="java.lang.String" />
 	</resultMap>

 	<select id="COR002002ERmCvptAcpNoSelect" parameterType="paramMap" resultType="String">
 		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002ERmCvptAcpNoSelect */
 		<![CDATA[
 			SELECT	(NVL(MAX(TO_NUMBER(RM_CVPT_ACP_NO)),0)+1) AS RM_CVPT_ACP_NO
			FROM	TBCORCOR101M
			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
			AND		ACP_YR = #{acpYr}
 		]]>
 	</select>

 	<select id="COR002002EMainSelect" parameterType="paramMap"
		resultMap="cspdcpMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EMainSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,DECODE(A.RM_CVPT_ACP_NO,NULL,NULL,A.ACP_YR||'-'||F_CODE_NM('1000740',A.REQ_DVSN_CD)||'-'||A.RM_CVPT_ACP_NO) AS ACP_NO
   					,A.RM_CVPT_ACP_NO
   					,A.CVPT_KND_CD
   					,A.REQR_KND_CD
   					,A.ACP_RUT_CD
   					,A.ACP_RUT_DTL_CD
   					,A.CVPTR_NM
   					,A.BTDT
   					,A.JB_NM
   					,A.RPST_PEN_NM
   					,A.BZN
   					,A.CPNM_NM
   					,A.ZCD
   					,A.AD
   					,A.DTL_AD
   					,A.KIW_CVPT_APL_NO
   					,CASE
				         WHEN A.TNB like ('%-%') THEN DECODE(A.TNB, NULL, '', SUBSTR(A.TNB, 1, INSTR(A.TNB, '-', 1, 1)-1))
				         ELSE SUBSTR(A.TNB, 0 , 3)
				       END AS TNB1 ,
				       CASE
				         WHEN LENGTH(A.TNB) = '10' THEN
				         CASE
				           WHEN A.TNB like ('%-%') THEN DECODE(A.TNB, NULL, '', SUBSTR(A.TNB, INSTR(A.TNB, '-', 1, 1)+1, INSTR(A.TNB, '-', 1, 2)-INSTR(A.TNB, '-', 1, 1)-1))
				           ELSE SUBSTR(A.TNB, 4 , 3)
				         END
				         ELSE
				         CASE
				           WHEN A.TNB like ('%-%') THEN DECODE(A.TNB, NULL, '', SUBSTR(A.TNB, INSTR(A.TNB, '-', 1, 1)+1, INSTR(A.TNB, '-', 1, 2)-INSTR(A.TNB, '-', 1, 1)-1))
				           ELSE SUBSTR(A.TNB, 4 , 4)
				         END
				       END AS TNB2,
				       CASE
				         WHEN LENGTH(A.TNB) = '10' THEN
				         CASE
				           WHEN A.TNB like ('%-%') THEN DECODE(A.TNB, NULL, '', SUBSTR(A.TNB, INSTR(A.TNB, '-', 1, 2)+1))
				           ELSE SUBSTR(A.TNB, 7)
				         END
				         ELSE
				         CASE
				           WHEN A.TNB like ('%-%') THEN DECODE(A.TNB, NULL, '', SUBSTR(A.TNB, INSTR(A.TNB, '-', 1, 2)+1))
				           ELSE SUBSTR(A.TNB, 8)
				         END
				       END AS TNB3 ,
				       CASE
				         WHEN A.HPN like ('%-%') THEN DECODE(A.HPN, NULL, '', SUBSTR(A.HPN, 1, INSTR(A.HPN, '-', 1, 1)-1))
				         ELSE SUBSTR(A.HPN, 0 , 3)
				       END AS HPN1 ,
				       CASE
				         WHEN LENGTH(A.HPN) = '10' THEN
				         CASE
				           WHEN A.HPN like ('%-%') THEN DECODE(A.HPN, NULL, '', SUBSTR(A.HPN, INSTR(A.HPN, '-', 1, 1)+1, INSTR(A.HPN, '-', 1, 2)-INSTR(A.HPN, '-', 1, 1)-1))
				           ELSE SUBSTR(A.HPN, 4 , 3)
				         END
				         ELSE
				         CASE
				           WHEN A.HPN like ('%-%') THEN DECODE(A.HPN, NULL, '', SUBSTR(A.HPN, INSTR(A.HPN, '-', 1, 1)+1, INSTR(A.HPN, '-', 1, 2)-INSTR(A.HPN, '-', 1, 1)-1))
				           ELSE SUBSTR(A.HPN, 4 , 4)
				         END
				       END AS HPN2 ,
				       CASE
				         WHEN LENGTH(A.HPN) = '10' THEN
				         CASE
				           WHEN A.HPN like ('%-%') THEN DECODE(A.HPN, NULL, '', SUBSTR(A.HPN, INSTR(A.HPN, '-', 1, 2)+1))
				           ELSE SUBSTR(A.HPN, 7)
				         END
				         ELSE
				         CASE
				           WHEN A.HPN like ('%-%') THEN DECODE(A.HPN, NULL, '', SUBSTR(A.HPN, INSTR(A.HPN, '-', 1, 2)+1))
				           ELSE SUBSTR(A.HPN, 8)
				         END
				       END AS HPN3 
   					/*
   					,DECODE(A.TNB,NULL,'',SUBSTR(A.TNB,1,INSTR(A.TNB,'-',1,1)-1)) TNB1
   					,DECODE(A.TNB,NULL,'',SUBSTR(A.TNB,INSTR(A.TNB,'-',1,1)+1,INSTR(A.TNB,'-',1,2)-INSTR(A.TNB,'-',1,1)-1)) AS TNB2
   					,DECODE(A.TNB,NULL,'',SUBSTR(A.TNB,INSTR(A.TNB,'-',1,2)+1)) TNB3
   					,DECODE(A.HPN,NULL,'',SUBSTR(HPN,1,INSTR(HPN,'-',1,1)-1)) HPN1
   					,DECODE(A.HPN,NULL,'',SUBSTR(A.HPN,INSTR(A.HPN,'-',1,1)+1,INSTR(A.HPN,'-',1,2)-INSTR(A.HPN,'-',1,1)-1)) AS HPN2
   					,DECODE(A.HPN,NULL,'',SUBSTR(A.HPN,INSTR(A.HPN,'-',1,2)+1)) HPN3
   					*/
   					,A.HPN
   					,A.TNB
   					,A.EML_ID
   					,A.EML_DMI_NM
   					,A.OPEN_YN
   					,A.MNG_TYP_CD
   					,A.RSLT_NTF_WAY_CD
   					,A.TIT_NM
   					,A.ACP_DPT_CD
   					,(	SELECT	S1.DPT_NM
   						FROM 	TBDCMACM002M S1
   						WHERE 	S1.DPT_CD = A.ACP_DPT_CD
   						) AS ACP_DPT_NM
   					,A.RCEP_ID
   					,F_USR_INFO_BY_ID(A.RCEP_ID,'2') AS RCEP_NM
   					,TO_CHAR(A.ACP_DH,'YYYY.MM.DD HH24:MI') AS ACP_DH
   					,A.CVPT_HNDL_STA_CD
   					,A.AUD_INF_TG_YN
   					,A.SMG_CVPT_APL_NO
   					,A.SMG_CVPT_ACP_NO
   					,A.SMG_FNL_HNDL_STA_CD
   					,A.SMG_CVPT_APL_DH
   					,A.SMG_FRT_CVPT_APL_GCC_ORG_CD
   					,A.SMG_CAT_HST_SRNO
   					,TO_CHAR(A.CVPT_WDW_DH,'YYYY.MM.DD HH24:MI') AS CVPT_WDW_DH
   					,A.CVPT_WDW_RSN
   					,B.CVPT_TXT
   					,B.CVPT_SBT
   					,C.CLM_NM
   					,C.WRK_PLAC_NM
   					,CASE
			         WHEN C.TNB like ('%-%') THEN DECODE(C.TNB, NULL, '', SUBSTR(C.TNB, 1, INSTR(C.TNB, '-', 1, 1)-1))
			         ELSE SUBSTR(C.TNB, 0 , 3)
			       END AS CLM_TNB1 ,
			       CASE
			         WHEN LENGTH(C.TNB) = '10' THEN
			         CASE
			           WHEN C.TNB like ('%-%') THEN DECODE(C.TNB, NULL, '', SUBSTR(C.TNB, INSTR(C.TNB, '-', 1, 1)+1, INSTR(C.TNB, '-', 1, 2)-INSTR(C.TNB, '-', 1, 1)-1))
			           ELSE SUBSTR(C.TNB, 4 , 3)
			         END
			         ELSE
			         CASE
			           WHEN C.TNB like ('%-%') THEN DECODE(C.TNB, NULL, '', SUBSTR(C.TNB, INSTR(C.TNB, '-', 1, 1)+1, INSTR(C.TNB, '-', 1, 2)-INSTR(C.TNB, '-', 1, 1)-1))
			           ELSE SUBSTR(C.TNB, 4 , 4)
			         END
			       END AS CLM_TNB2,
			       CASE
			         WHEN LENGTH(C.TNB) = '10' THEN
			         CASE
			           WHEN C.TNB like ('%-%') THEN DECODE(C.TNB, NULL, '', SUBSTR(C.TNB, INSTR(C.TNB, '-', 1, 2)+1))
			           ELSE SUBSTR(C.TNB, 7)
			         END
			         ELSE
			         CASE
			           WHEN C.TNB like ('%-%') THEN DECODE(C.TNB, NULL, '', SUBSTR(C.TNB, INSTR(C.TNB, '-', 1, 2)+1))
			           ELSE SUBSTR(C.TNB, 8)
			         END
			       END AS CLM_TNB3 
   					/*
   					,DECODE(C.TNB,NULL,'',SUBSTR(C.TNB,1,INSTR(C.TNB,'-',1,1)-1)) CLM_TNB1
   					,DECODE(C.TNB,NULL,'',SUBSTR(C.TNB,INSTR(C.TNB,'-',1,1)+1,INSTR(C.TNB,'-',1,2)-INSTR(C.TNB,'-',1,1)-1)) AS CLM_TNB2
   					,DECODE(C.TNB,NULL,'',SUBSTR(C.TNB,INSTR(C.TNB,'-',1,2)+1)) CLM_TNB3
   					*/
   					,C.ZCD AS CLM_ZCD
   					,C.AD AS CLM_AD
   					,C.DTL_AD AS CLM_DTL_AD
   					,A.DOC_ID
   					,F_CODE_NM('1000933',A.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
   					,A.HMP_APL_NO
   					,NVL(A.HMP_APL_NO,A.SMG_CVPT_APL_NO) AS HMP_SMG_APL_NO
   					,TO_CHAR(A.CVPT_WDW_DH,'YYYY.MM.DD HH24:MI') AS CVPT_WDW_DH
   					,NVL(A.INNER_YN,'N') AS INNER_YN
   					,A.INNER_ORG_NM
   					,B.DTY_TXT
					,B.DTY_YN
					,B.ADMINI_YN
					,B.OTHER_SUB_TXT
					,B.OTHER_SUB_YN
					,B.PEROPEN_AGR_YN
					, SUBSTR(DGUARD.DECRYPT('TB_ENC','EIN',A.EIN),0,6)  AS EIN1
					, SUBSTR(DGUARD.DECRYPT('TB_ENC','EIN',A.EIN),7,1)||'******' AS EIN2
					,C.POS
   					,A.KIW_CVPT_APL_NO
   			FROM	TBCORCOR101M A
   					,TBCORCOR102M B
   					,TBCORCOR103M C
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
   			AND		A.ACP_YR = B.ACP_YR
   			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
   			AND		A.REQ_DVSN_CD = C.REQ_DVSN_CD(+)
   			AND		A.ACP_YR = C.ACP_YR(+)
   			AND		A.CVPT_ACP_NO = C.CVPT_ACP_NO(+)
		]]>
		<if test='rmCvptAcpNo == null or rmCvptAcpNo == ""'>
				AND	A.CVPT_ACP_NO = #{cvptAcpNo}
			</if>
		<if test='rmCvptAcpNo != null and rmCvptAcpNo != ""'>
				AND	A.RM_CVPT_ACP_NO = #{rmCvptAcpNo}
			</if>

	</select>

	<select id="COR002002EOrgSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EOrgSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.ACP_YR
   					,A.CVPT_ACP_NO
   					,A.AUD_TG_ORG_CD
   					,B.ORG_NM
                    ,B.ORG_DVSN_CD
   					,(	SELECT	Z.CD_NM
   						FROM	TBDCMACM013C Z
   						WHERE	Z.CMM_CD_DVSN_CD ='1000119'
   						AND		Z.CD = B.ORG_DVSN_CD) AS ORG_DVSN_NM
   					,F_ORG_HRK_NM(B.COPT_SG_CD) AS COPT_SG_NM
   			FROM	TBCORCOR104L A
   					,TBDCMACM015M B
   					,TBCORCOR101M C
   			WHERE	1=1
   			AND		C.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		C.ACP_YR = #{acpYr}
   			AND		C.REQ_DVSN_CD = A.REQ_DVSN_CD
   			AND		C.ACP_YR = A.ACP_YR
   			AND		C.CVPT_ACP_NO = A.CVPT_ACP_NO
   			AND		A.AUD_TG_ORG_CD = B.ORG_CD
		]]>
		<if test='rmCvptAcpNo == null or rmCvptAcpNo == ""'>
				AND	C.CVPT_ACP_NO = #{cvptAcpNo}
			</if>
		<if test='rmCvptAcpNo != null and rmCvptAcpNo != ""'>
				AND	C.RM_CVPT_ACP_NO = #{rmCvptAcpNo}
			</if>

	</select>

	<insert id="COR002002EMainInsert" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EMainInsert */
        <![CDATA[
        	INSERT INTO	 TBCORCOR101M
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_KND_CD
        					,REQR_KND_CD
        					,ACP_RUT_CD
        					,ACP_RUT_DTL_CD
        					,CVPTR_NM
        					,BTDT
        					,RPST_PEN_NM
        					,BZN
        					,CPNM_NM
        					,ZCD
        					,AD
        					,DTL_AD
        					,TNB
        					,HPN
        					,EML_ID
        					,EML_DMI_NM
        					,OPEN_YN
        					,MNG_TYP_CD
        					,RSLT_NTF_WAY_CD
        					,TIT_NM
        					,ACP_DPT_CD
        					,RCEP_ID
        					,ACP_DH
        					,CVPT_HNDL_STA_CD
        					,AUD_INF_TG_YN
        					,SMG_CVPT_APL_NO
        					,SMG_CVPT_ACP_NO
        					,SMG_FNL_HNDL_STA_CD
        					,SMG_CVPT_APL_DH
        					,CVPT_WDW_DH
        					,CVPT_WDW_RSN
        					,DOC_ID
        					,DOC_TYP_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        					,RM_CVPT_ACP_NO
        					,HNDL_DDLN_DT
        					,SCEN_CFM_EXTN_DCN
        					,NTF_EXTN_DCN
        					,INNER_YN
        					,INNER_ORG_NM
        					,EIN
        					,KIW_CVPT_APL_NO
        				)
        		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,#{cvptKndCd}
							,#{reqrKndCd}
							,#{acpRutCd}
							,#{acpRutDtlCd}
							,#{cvptrNm}
							,#{btdt}
							,#{rpstPenNm}
							,#{bzn}
							,#{cpnmNm}
							,#{zcd}
							,#{ad}
							,#{dtlAd}
							,DECODE(#{tnb1},NULL,'',#{tnb1}||'-'||#{tnb2}||'-'||#{tnb3})
							,DECODE(#{hpn1},NULL,'',#{hpn1}||'-'||#{hpn2}||'-'||#{hpn3})
							,#{emlId}
							,#{emlDmiNm}
							,#{openYn}
							,#{mngTypCd}
							,NVL(#{rsltNtfWayCd},'003')
							,#{titNm}
							,#{acpDptCd}
							,#{rcepId}
							,SYSDATE
							,DECODE(#{reqDvsnCd},'5','20','10')
							,#{audInfTgYn}
							,#{smgCvptAplNo}
							,#{smgCvptAcpNo}
							,#{smgFnlHndlStaCd}
							,#{smgCvptAplDh}
							,#{cvptWdwDh}
							,#{cvptWdwRsn}
							,#{docId}
							,#{docTypCd}
							,#{frtUsrId}
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
							,#{rmCvptAcpNo}
							,F_GET_NEXT_WORK_DT(TO_CHAR(SYSDATE,'YYYYMMDD'),30)
							,0
							,0
							,#{innerYn}
        					,#{innerOrgNm}
        					,(DGUARD.ENCRYPT('TB_ENC','EIN',#{ein1}||#{ein2}))
        					,#{kiwCvptAplNo}
        				)
		]]>
	</insert>

	<insert id="COR002002EDCP102Insert" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EDCP102Insert */
        <![CDATA[
        	INSERT INTO	 TBCORCOR102M
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_TXT
        					,CVPT_SBT
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        					,PEROPEN_AGR_YN
							,OTHER_SUB_YN
							,OTHER_SUB_TXT
							,ADMINI_YN
							,DTY_YN
							,DTY_TXT
        				)
        		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,#{cvptTxt}
							,#{cvptSbt}
							,#{frtUsrId}
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
							,#{peropenAgrYn}
							,#{otherSubYn}
							,#{otherSubTxt}
							,#{adminiYn}
							,#{dtyYn}
							,#{dtyTxt}
						)
        ]]>
	</insert>

	<insert id="COR002002EDCP103Insert" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EDCP103Insert */
        <![CDATA[
        	MERGE INTO 	TBCORCOR103M A
        	USING 	(	SELECT 	#{reqDvsnCd} AS REQ_DVSN_CD
        						,#{acpYr} AS ACP_YR
        						,#{cvptAcpNo} AS CVPT_ACP_NO
        				FROM DUAL
        			) B
        	ON		(	A.REQ_DVSN_CD = B.REQ_DVSN_CD
        				AND	A.ACP_YR = B.ACP_YR
        				AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
        			)
        	WHEN MATCHED THEN
        			UPDATE
        			SET		CLM_NM = #{clmNm}
        					,WRK_PLAC_NM = #{wrkPlacNm}
        					,TNB = DECODE(#{clmTnb1},NULL,'',#{clmTnb1}||'-'||#{clmTnb2}||'-'||#{clmTnb3})
        					,ZCD = #{clmZcd}
        					,AD = #{clmAd}
        					,DTL_AD = #{clmDtlAd}
        					,FNL_USR_ID = #{fnlUsrId}
        					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
        					,FNL_MNU_ID = #{fnlMnuId}
        					,FNL_MDF_DH = SYSDATE
        					,POS = #{pos}
        	WHEN NOT MATCHED THEN
		        	INSERT 		(	REQ_DVSN_CD
		        					,ACP_YR
		        					,CVPT_ACP_NO
		        					,CLM_NM
		        					,WRK_PLAC_NM
		        					,TNB
		        					,ZCD
		        					,AD
		        					,DTL_AD
		        					,FRT_USR_ID
		        					,FNL_USR_ID
		        					,FNL_DEAL_DPT_CD
		        					,FNL_MNU_ID
		        					,FRT_REGI_DH
		        					,FNL_MDF_DH
		        					,POS
		        				)
		        		VALUES	(	#{reqDvsnCd}
									,#{acpYr}
									,#{cvptAcpNo}
									,#{clmNm}
		        					,#{wrkPlacNm}
		        					,DECODE(#{clmTnb1},NULL,'',#{clmTnb1}||'-'||#{clmTnb2}||'-'||#{clmTnb3})
		        					,#{clmZcd}
		        					,#{clmAd}
		        					,#{clmDtlAd}
									,NVL(#{frtUsrId},#{fnlUsrId})
									,#{fnlUsrId}
									,#{fnlDealDptCd}
									,#{fnlMnuId}
									,SYSDATE
									,SYSDATE
									,#{pos}
								)
        ]]>
	</insert>

	<insert id="COR002002EDCP104Insert" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EDCP104Insert */
        <![CDATA[
        	INSERT INTO	TBCORCOR104L
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,AUD_TG_ORG_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,#{audTgOrgCd}
							,#{frtUsrId}
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)
        ]]>
	</insert>

	<select id="COR002002EKeySelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EKeySelect */
        <![CDATA[
			    SELECT (NVL(MAX(TO_NUMBER(CVPT_ACP_NO)), 0)+1) AS CVPT_ACP_NO
				  FROM TBCORCOR101M
				 WHERE 1=1
			       AND REQ_DVSN_CD = #{reqDvsnCd}
			       AND ACP_YR = #{acpYr}
		]]>
	</select>


	<update id="COR002002EMainUpdate" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EMainUpdate */
        <![CDATA[
        	UPDATE	TBCORCOR101M A
        	SET		A.CVPT_KND_CD = #{cvptKndCd}
   					,A.REQR_KND_CD =#{reqrKndCd}
   					,A.KIW_CVPT_APL_NO = #{kiwCvptAplNo}
   					,A.ACP_RUT_CD =#{acpRutCd}
   					,A.ACP_RUT_DTL_CD = #{acpRutDtlCd}
   					,A.CVPTR_NM = #{cvptrNm}
   					,A.BTDT = #{btdt}
   					,A.JB_NM = #{jbNm}
   					,A.RPST_PEN_NM = #{rpstPenNm}
   					,A.BZN = #{bzn}
   					,A.CPNM_NM = #{cpnmNm}
   					,A.ZCD = #{zcd}
   					,A.AD = #{ad}
   					,A.DTL_AD = #{dtlAd}
   					,A.TNB = DECODE(#{tnb1},NULL,'',#{tnb1}||'-'||#{tnb2}||'-'||#{tnb3})
   					,A.HPN = DECODE(#{hpn1},NULL,'',#{hpn1}||'-'||#{hpn2}||'-'||#{hpn3})
   					,A.EML_ID = #{emlId}
   					,A.EML_DMI_NM = #{emlDmiNm}
   					,A.OPEN_YN = #{openYn}
   					,A.MNG_TYP_CD = #{mngTypCd}
   					,A.RSLT_NTF_WAY_CD = NVL(#{rsltNtfWayCd},'003')
   					,A.TIT_NM = #{titNm}
   					,A.CVPT_HNDL_STA_CD = DECODE(#{reqDvsnCd},'2','10','3','10',DECODE(#{cvptHndlStaCd},'20','20','21','20','10','20',CVPT_HNDL_STA_CD))
   					,A.AUD_INF_TG_YN = #{audInfTgYn}
   					,A.DOC_ID = #{docId}
   					,A.DOC_TYP_CD = #{docTypCd}
   					,A.FNL_USR_ID = #{fnlUsrId}
   					,A.FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,A.FNL_MNU_ID = #{fnlMnuId}
   					,A.FNL_MDF_DH = SYSDATE
   					,A.INNER_YN = #{innerYn}
   					,A.INNER_ORG_NM = #{innerOrgNm}
   		]]>
   		<if test='acpRutCd == "1"'>
			<if test='cvptHndlStaCd == "10"'>
   					,A.RCEP_ID = F_USR_INFO(#{sCnb},'1')
                    ,A.ACP_DPT_CD = #{fnlDealDptCd}
                    ,A.ACP_DH = SYSDATE
                    ,A.RM_CVPT_ACP_NO = #{rmCvptAcpNo}
                    ,A.HNDL_DDLN_DT = F_GET_NEXT_WORK_DT(TO_CHAR(SYSDATE,'YYYYMMDD'),30)
                    ,A.SCEN_CFM_EXTN_DCN = 0
                    ,A.NTF_EXTN_DCN = 0
   			</if>
   		</if>
   		
		<if test='acpRutCd == "8"'>
		<if test='cvptHndlStaCd == "10"'>
   					,A.RCEP_ID = F_USR_INFO(#{sCnb},'1')
	   				,A.ACP_DPT_CD = #{fnlDealDptCd}
	   				,A.ACP_DH = SYSDATE
	   				,A.RM_CVPT_ACP_NO = #{rmCvptAcpNo}
	   				,A.HNDL_DDLN_DT = F_GET_NEXT_WORK_DT(TO_CHAR(SYSDATE,'YYYYMMDD'),30)
	   				,A.SCEN_CFM_EXTN_DCN = 0
	   				,A.NTF_EXTN_DCN = 0
   				</if>
		<if test='cvptHndlStaCd == "21"'>
   					,A.RCEP_ID = F_USR_INFO(#{sCnb},'1')
	   				,A.ACP_DPT_CD = #{fnlDealDptCd}
   				</if>
   			</if>
		<if test='acpRutCd == "7"'>
		<if test='cvptHndlStaCd == "10"'>
   					,A.RCEP_ID = F_USR_INFO(#{sCnb},'1')
	   				,A.ACP_DPT_CD = #{fnlDealDptCd}
	   				,A.ACP_DH = SYSDATE
	   				,A.RM_CVPT_ACP_NO = #{rmCvptAcpNo}
	   				,A.HNDL_DDLN_DT = F_GET_NEXT_WORK_DT(TO_CHAR(SYSDATE,'YYYYMMDD'),30)
	   				,A.SCEN_CFM_EXTN_DCN = 0
	   				,A.NTF_EXTN_DCN = 0
   				</if>
		<if test='cvptHndlStaCd == "21"'>
   					,A.RCEP_ID = F_USR_INFO(#{sCnb},'1')
	   				,A.ACP_DPT_CD = #{fnlDealDptCd}
   				</if>
   			</if>
   		<![CDATA[
   			WHERE	A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   			AND		A.CVPT_ACP_NO = #{cvptAcpNo}
       	]]>
	</update>

	<update id="COR002002EDCP102Update" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002ECP102Update */
        <![CDATA[
        	UPDATE	TBCORCOR102M
        	SET		CVPT_TXT = #{cvptTxt}
   					,CVPT_SBT =#{cvptSbt}
   					,FNL_USR_ID = #{fnlUsrId}
   					,FNL_DEAL_DPT_CD = #{fnlDealDptCd}
   					,FNL_MNU_ID = #{fnlMnuId}
   					,FNL_MDF_DH = SYSDATE
   					,PEROPEN_AGR_YN = #{peropenAgrYn}
					,OTHER_SUB_YN = #{otherSubYn}
					,OTHER_SUB_TXT = #{otherSubTxt}
					,ADMINI_YN = #{adminiYn}
					,DTY_YN = #{dtyYn}
					,DTY_TXT = #{dtyTxt}
   			WHERE	REQ_DVSN_CD = #{reqDvsnCd}
   			AND		ACP_YR = #{acpYr}
   			AND		CVPT_ACP_NO = #{cvptAcpNo}
       	]]>
	</update>

	<delete id="COR002002EDCP104Delete" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EDCP104Delete */
        <![CDATA[
        	DELETE
        	FROM	TBCORCOR104L
        	WHERE	REQ_DVSN_CD = #{reqDvsnCd}
   			AND		ACP_YR = #{acpYr}
   			AND		CVPT_ACP_NO = #{cvptAcpNo}
   			AND		AUD_TG_ORG_CD = #{audTgOrgCd}
       	]]>
	</delete>

	<insert id="COR002002EDCP202Insert" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EDCP202Insert */
        <![CDATA[
        	INSERT INTO	TBCORCOR202H
        				(	REQ_DVSN_CD
        					,ACP_YR
        					,CVPT_ACP_NO
        					,CVPT_DTB_HST_SRNO
        					,DTB_DPT_CD
        					,DTB_PEN_ID
        					,CVPT_HNDL_STA_CD
        					,FRT_USR_ID
        					,FNL_USR_ID
        					,FNL_DEAL_DPT_CD
        					,FNL_MNU_ID
        					,FRT_REGI_DH
        					,FNL_MDF_DH
        				)
        		VALUES	(	#{reqDvsnCd}
							,#{acpYr}
							,#{cvptAcpNo}
							,(	SELECT NVL(MAX(CVPT_DTB_HST_SRNO),0)+1
								  FROM TBCORCOR202H
								 WHERE 1=1
							       AND REQ_DVSN_CD = #{reqDvsnCd}
							       AND ACP_YR = #{acpYr}
							       AND CVPT_ACP_NO = #{cvptAcpNo}
							 )
							,#{fnlDealDptCd}
							,F_USR_INFO(#{sCnb},'1')
							,DECODE(#{reqDvsnCd},'1','20','10')
							,F_USR_INFO(#{sCnb},'1')
							,#{fnlUsrId}
							,#{fnlDealDptCd}
							,#{fnlMnuId}
							,SYSDATE
							,SYSDATE
						)
        ]]>
	</insert>


	<select id="COR002002EReportSelect" parameterType="paramMap"
		resultType="egovMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EReportSelect */
		<![CDATA[
			SELECT	A.REQ_DVSN_CD
					,A.TIT_NM
					,A.ACP_YR||'-'||F_CODE_NM('1000740',A.REQ_DVSN_CD)||'-'||A.RM_CVPT_ACP_NO AS ACP_NO
					,TO_CHAR(A.ACP_DH,'YYYY.MM.DD') AS ACP_DH
					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
					,CASE WHEN A.ACP_DPT_CD = '0L0100'
						 THEN '감사원 종합상담실'
						ELSE (	SELECT	S1.DPT_NM
		   						FROM 	TBDCMACM002M S1
		   						WHERE 	S1.DPT_CD = A.ACP_DPT_CD
		   						)||' 종합상담실' END AS ACP_DPT_NM
   			FROM	TBCORCOR101M A
   			WHERE	1=1
   			AND		A.REQ_DVSN_CD = #{reqDvsnCd}
   			AND		A.ACP_YR = #{acpYr}
   		]]>
		<if test='rmCvptAcpNo == null or rmCvptAcpNo == ""'>
			AND	A.CVPT_ACP_NO = #{cvptAcpNo}
		</if>
		<if test='rmCvptAcpNo != null and rmCvptAcpNo != ""'>
			AND	A.RM_CVPT_ACP_NO = #{rmCvptAcpNo}
		</if>
	</select>



	<insert id="COR002002ESMGInsert" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002ESMGInsert */
		<![CDATA[
			INSERT INTO	T_IC_TARGET_SRC_INTERFACE
						(	INTERFACE_KEY
							,APP_ORGAN_CODE		/*최초 민원 신청 기관코드(GCC)*/
							,PETI_NO			/*민원신청번호*/
							,REC_SEQ			/*분류이력일련번호*/
							,CIVIL_NO			/*민원접수번호*/
							,PETI_GUBUN			/*민원구분 (500고정,담당자부서지정) */
							,CANCEL_STATUS		/*민원취하여부(Default N)*/
							,PCD_DEPT			/*GCC 부서코드 (접수부서코드)*/
							,PCD_DEPT_NM		/*GCC 부서명 (접수부서명)*/
							,PCD_DUTY_ID		/*접수자명*/
							,PCD_EMAIL			/*접수 이메일 (대표이메일 사용, 감청국, 센터 로 분류)*/
							,PCD_TEL			/*접수자 전화번호 (대표전화 사용: 감청국, 센터로 분류)*/
							,PCD_ORGAN_CODE 	/*실처리기관코드 (감사원 GCC 코드로 고정)*/
							,SRCORGCD			/*소스기관코드 (감사원 GCC 코드로 고정)*/
							,TGTORGCD			/*타겟기관코드 (신문고 GCC 코드로 고정)*/
							,WRITE_TIME			/*등록일자*/
							,SND_RCV_GUBUN		/*송수신구분 (1:송신, 2:수신)*/
							,SND_RCV_TIME		/*송수신일자*/
							,SEND_YN			/*송신여부 (N DEFAULT, EAI 가 송신후 Y로 변경함)*/
						)
				VALUES	(	TO_CHAR(SYSTIMESTAMP, 'YYYYMMDDHH24MISSFF2') || LPAD(ROUND(DBMS_RANDOM.VALUE(1, 999999999)), 9, '0')
							,#{smgFrtCvptAplGccOrgCd}
							,#{smgCvptAplNo}
							,#{smgCatHstSrno}
							,#{smgCvptAcpNo}
							,'500'
							,'N'
							,(	SELECT	SUBSTR(STND_DPT_CD,9,7)
		   						FROM 	TBDCMACM002M S1
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						) 
							,(	SELECT	S2.ALL_ORG_NM
		   						FROM 	TBDCMACM002M S1
		   								,TBCSPIIT006M S2
		   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
		   						AND		S2.GCC_ORG_CD = SUBSTR(S1.STND_DPT_CD,9,7)
		   						AND ROWNUM = 1
		   						) 
							,F_USR_INFO(#{sCnb},'2')
							,''
							,'02-2011-2191'
							,'1040000'
							,'1040000'
							,'1140100'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS' )
							,'1'
							,TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
							,'N'
						)
		]]>
	</insert>

	<insert id="COR002002EMsg206Insert" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EMsg206Insert */
		<![CDATA[
			INSERT INTO
			TBDCMACM026L
			(
			  MSG_SNO
			, TSK_CAT_CD
			, FUNC_CAT_CD
			, SEND_ID
	        , MSG_TP_YN

	        , MSG_TXT_2
	        , RCNT_CNT
	        , RCNT_HIS
	        , MSG_REGI_DH

			, FRT_USR_ID
			, FNL_USR_ID
			, FNL_DEAL_DPT_CD
			, FNL_MNU_ID
			, FRT_REGI_DH
			,
			FNL_MDF_DH

			)
			VALUES
			(
			  (SELECT NVL(MAX(MSG_SNO),0)+1 FROM TBDCMACM026L)
			, 'SP'
			, 'AR'
			, #{fnlUsrId}
	        , '0'

	        , '공익감사청구사항이 신규 신청되었습니다.'
	        , 1
	        , #{rcntHis}
	        , SYSDATE


			, #{fnlUsrId}
			, #{fnlUsrId}
			, #{fnlDealDptCd}
			, #{fnlMnuId}
			, SYSDATE
			, SYSDATE

			);

		]]>
	</insert>


	<insert id="COR002002EMsgInsert" parameterType="paramMap">
		/* kr.go.bai.eip.cor.cor.dao.COR002002EMapper.COR002002EMsgInsert */
		<![CDATA[
			INSERT INTO MSG_DATA
				 	(	MSG_SEQ
				 		, CUR_STATE
				 		, REQ_DATE
				 		, CALL_TO
				 		, CALL_FROM
				 		, SMS_TXT
				 		, MSG_TYPE
				 		, CONT_SEQ
				 		, USERDATA
				 	)
			VALUES (	MSG_DATA_SEQ.NEXTVAL
						, 0
						, SYSDATE
						, REPLACE(#{hpn},'-','')
						, NVL((	SELECT	S1.TNB
   						FROM 	TBDCMACM002M S1
   						WHERE 	S1.DPT_CD = #{fnlDealDptCd}
   						) ,'0220112191')
						, ''
						, 6
						, #{contSeq}
						, #{reqDvsnCd}||#{acpYr}||#{cvptAcpNo}
					)
		]]>
	</insert>

</mapper>
