<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.go.bai.eip.dashBoard.dao.DashBoardMapper">

	<!-- 오아시스 결재 정보 -->
	<select id="dashBoardOasisApvCntSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardOasisApvCntSelect*/
		SELECT
        
        /*********************** 결재대기함 ************************/
                (
                SELECT COUNT(DISTINCT DT.APV_DOC_NO) AS APV_MY_LAG_BF_CNT
					  FROM (
							SELECT T22.APV_DOC_NO  AS APV_DOC_NO 
							  FROM TBDCMACM022L T22,
							       TBDCMACM023L T23,
							       TBDCMACM021M T21
							 WHERE 1=1
							   AND T22.APV_DOC_NO = T23.APV_DOC_NO
							   AND T22.APV_DVSN_CD = T23.APV_DVSN_CD
							   /* 공석일경우 미열람건 카운트 추가 */
							   AND ( T23.APVR_STA_CD IN ('102','103','104','105','106','107') OR (T23.APVR_KND_CD = '9' AND T23.APVR_STA_CD = '202' AND NVL(T23.READ_YN,'N') = 'N' ) )
							   AND T23.APVR_CNB = #{cnb}
							   AND T22.APV_DVSN_CD = T21.APV_DVSN_CD
							 --  AND T22.APV_DVSN_CD IN ('fieldAudit','badear001','AudExecPlanMng','fieldAuditMain')
							   AND T22.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
							UNION ALL
							SELECT /*실지감사, 심의요청 대시보드의 결재대기함 건수 조회 시 소위원회 결과보고서 보고서를 포함하여 조회 되도록 추가*/
							       T22.APV_DOC_NO  AS APV_DOC_NO  
							  FROM TBDCMACM022L T22,
							  	   TBDCMACM023L T23,
							       TBDCMACM021M T21,
							       TBBADFRE103M T103M
							 WHERE T22.APV_DOC_NO = T23.APV_DOC_NO
							   AND T22.APV_DVSN_CD = T23.APV_DVSN_CD
							   AND T22.APV_DOC_NO = T103M.APV_RQS_ID
							   AND T22.APV_DVSN_CD = T21.APV_DVSN_CD
							   /* 공석일경우 미열람건 카운트 추가 */
							   AND ( T23.APVR_STA_CD IN ('102','103','104','105','106','107') OR (T23.APVR_KND_CD = '9' AND T23.APVR_STA_CD = '202' AND NVL(T23.READ_YN,'N') = 'N' ) )
							   AND T23.APVR_CNB = #{cnb}
							   AND T22.APV_DVSN_CD IN ('requestAudit5', 'requestAudit6')
							   AND T103M.RPRT_CD IN ('D10300200','D10300600','D10300700','E10200200','E10300150','E10300400','E10500200','D10200700','E10400500')   
							   AND T22.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
			       		   ) AS DT
			   ) AS APV_MY_LAG_BF_CNT
               
        /*********************** 진행문서함 ************************/
               , (
	            SELECT COUNT(DISTINCT DT.APV_DOC_NO) AS APV_MY_PRSS_DOC_CNT
	       		  FROM (
	       		  		SELECT T22.APV_DOC_NO AS APV_DOC_NO
					        FROM (
				                SELECT DISTINCT D3.APV_DOC_NO
				                     , D3.APV_DVSN_CD
				                  FROM (
				                           SELECT APV_DOC_NO,  /*기안한 문서는 반려, 상신취소, 상신완료*/
	                                              APV_DVSN_CD
		                                     FROM TBDCMACM023L
		                                    WHERE APVR_CNB = #{cnb}
		                                      AND APVR_SEQ = '1'
		                                      AND APVR_STA_CD IN ('101','201','301')
		                                   UNION
		                                   SELECT APV_DOC_NO,  /*기안자가 아닌경우 결재처리(반려포함)한 문서 기준으로 조회, 협조는 진행문서함에 조회 하지 않는다.*/
		                                          APV_DVSN_CD
		                                     FROM TBDCMACM023L
		                                    WHERE APVR_CNB = #{cnb}
		                             ]]>
		                                      AND APVR_SEQ <![CDATA[ <> ]]> '1'
		                                <if test="cnb != '2381'" >
		                                      AND APVR_KND_CD <![CDATA[ <> ]]> '4'
		                                </if>      
		                                      AND SUBSTR(APVR_STA_CD,0,1) ='2'
		                                   UNION
		                                    SELECT L.APV_DOC_NO,  /*기안자가 아닌경우 결재한 이력이 있는 경우 문서를 볼수 있게 조회*/
		                                          L.APV_DVSN_CD
		                                     FROM TBDCMACM023L L
		                                             ,TBDCMACM023H H
		                                    WHERE L.APV_DOC_NO = H.APV_DOC_NO
		                                      AND L.APVR_CNB = H.APVR_CNB
		                                      AND L.APVR_CNB = #{cnb}
		                                      AND L.APVR_SEQ <![CDATA[ <> ]]> '1'
		                                <if test="cnb != '2381'" >
		                                      AND L.APVR_KND_CD <![CDATA[ <> ]]>'4' /*임시 조치*/
		                                </if>        
		                                      AND SUBSTR(H.APVR_STA_CD,0,1) ='2'
				                      ) D3
					              ) T23
					       , TBDCMACM022L T22
					       WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
					        AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD
					      --  AND   T22.APV_DVSN_CD IN ('fieldAudit','badear001','AudExecPlanMng','fieldAuditMain')
					<![CDATA[AND T22.APV_STA_CD NOT IN  ('3', '4','5') /*진행중인 문서만 조회하도록 추가*/]]>
					        AND T22.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
			            UNION ALL
						SELECT /*실지감사, 심의요청 대시보드의 결재대기함 건수 조회 시 소위원회 결과보고서 보고서를 포함하여 조회 되도록 추가*/
						       T22.APV_DOC_NO AS APV_DOC_NO 
						  FROM TBDCMACM022L T22,
						  	   (
				                SELECT DISTINCT D3.APV_DOC_NO
				                     , D3.APV_DVSN_CD
				                  FROM (
				                           SELECT APV_DOC_NO,  /*기안한 문서는 반려, 상신취소, 상신완료*/
	                                              APV_DVSN_CD
		                                     FROM TBDCMACM023L
		                                    WHERE APVR_CNB = #{cnb}
		                                      AND APVR_SEQ = '1'
		                                      AND APVR_STA_CD IN ('101','201','301')
		                                   UNION ALL
		                                   SELECT APV_DOC_NO,  /*기안자가 아닌경우 결재처리(반려포함)한 문서 기준으로 조회, 협조는 진행문서함에 조회 하지 않는다.*/
		                                          APV_DVSN_CD
		                                     FROM TBDCMACM023L
		                                    WHERE APVR_CNB = #{cnb}
		                                      AND APVR_SEQ <![CDATA[ <> ]]> '1'
		                                <if test="cnb != '2381'" >
		                                      AND APVR_KND_CD <![CDATA[ <> ]]> '4'
		                                </if>      
		                                      AND SUBSTR(APVR_STA_CD,0,1) IN ('2','4') 
		                                   UNION
		                                    SELECT L.APV_DOC_NO,  /*기안자가 아닌경우 결재한 이력이 있는 경우 문서를 볼수 있게 조회*/
		                                          L.APV_DVSN_CD
		                                     FROM TBDCMACM023L L
		                                             ,TBDCMACM023H H
		                                    WHERE L.APV_DOC_NO = H.APV_DOC_NO
		                                      AND L.APVR_CNB = H.APVR_CNB
		                                      AND L.APVR_CNB = #{cnb}
		                                      AND L.APVR_SEQ <![CDATA[ <> ]]> '1'
		                                <if test="cnb != '2381'" >
		                                      AND L.APVR_KND_CD <![CDATA[ <> ]]>'4' /*임시 조치*/
		                                </if>        
		                                      AND SUBSTR(H.APVR_STA_CD,0,1) ='2'
				                      ) D3
					              ) T23,
						       TBBADFRE103M T103M
						 WHERE T22.APV_DOC_NO = T23.APV_DOC_NO
						   AND T22.APV_DVSN_CD = T23.APV_DVSN_CD
						   AND T22.APV_DOC_NO = T103M.APV_RQS_ID
						   AND T22.APV_DVSN_CD IN ('requestAudit5', 'requestAudit6')
					<![CDATA[AND T22.APV_STA_CD NOT IN  ('3', '4','5') /*진행중인 문서만 조회하도록 추가*/]]>
						   AND T103M.RPRT_CD IN ('D10300200','D10300600','D10300700','E10200200','E10300150','E10300400','E10500200','D10200700','E10400500')   
						   AND T22.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
	       		  		) DT
				       
                 ) AS APV_MY_PRSS_DOC_CNT /* 진행문서함 건수*/
                 
        /*********************** 결재완료함 ************************/
                 , (
                 SELECT SUM(DT.CNT) AS APV_MY_APV_DOC_CNT
	         	   FROM (
			         	SELECT COUNT(1) AS CNT
			            	FROM (
			                    SELECT DISTINCT D3.APV_DOC_NO
			                         , D3.APV_DVSN_CD
			                      FROM (SELECT APV_DOC_NO
			                                  , APV_DVSN_CD
			                              FROM TBDCMACM023L
			                             WHERE APVR_CNB = #{cnb}
	                                 <if test="cnb != '2381'" >
	                                       AND APVR_KND_CD <![CDATA[ <> ]]> '4' /*협조한 문서는 보이지 않도록*/
	                                 </if>   
			                          ) D3
			                  ) T23
			               , TBDCMACM022L T22
			               WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
			                AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD
			                AND   T22.APV_DVSN_CD IN ('fieldAudit','badear001','AudExecPlanMng','fieldAuditMain')
			                AND T22.APV_STA_CD = '3' /*승인된 문서만 조회하도록 추가*/
        		<![CDATA[  AND T22.SBM_CNB <> #{cnb} ]]>
			                AND T22.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
			            UNION ALL
		                SELECT /*실지감사, 심의요청 대시보드의 결재대기함 건수 조회 시 소위원회 결과보고서 보고서를 포함하여 조회 되도록 추가*/
						       COUNT(1) AS CNT 
						  FROM TBDCMACM022L T22,
						  	   (
			                    SELECT DISTINCT D3.APV_DOC_NO
			                         , D3.APV_DVSN_CD
			                      FROM (SELECT APV_DOC_NO
			                                  , APV_DVSN_CD
			                              FROM TBDCMACM023L
			                             WHERE APVR_CNB = #{cnb}
	                                 <if test="cnb != '2381'" >
	                                       AND APVR_KND_CD <![CDATA[ <> ]]> '4' /*협조한 문서는 보이지 않도록*/
	                                 </if>   
			                          ) D3
			                   ) T23,
						       TBBADFRE103M T103M
						 WHERE T22.APV_DOC_NO = T23.APV_DOC_NO
						   AND T22.APV_DVSN_CD = T23.APV_DVSN_CD
						   AND T22.APV_DOC_NO = T103M.APV_RQS_ID
						   AND T22.APV_DVSN_CD IN ('requestAudit5', 'requestAudit6')
						   AND T103M.RPRT_CD IN ('D10300200','D10300600','D10300700','E10200200','E10300150','E10300400','E10500200','D10200700','E10400500')   
						   AND T22.APV_STA_CD = '3' /*승인된 문서만 조회하도록 추가*/
       		   <![CDATA[  AND T22.SBM_CNB <> #{cnb} ]]>
						   AND T22.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
					   ) DT
               ) AS APV_MY_APV_DOC_CNT 
		  FROM DUAL
	</select>

	<select id="dashBoardOasisApvCntSelect2" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardOasisApvCntSelect2*/
		SELECT (
				SELECT COUNT(A.APV_DOC_NO) AS APV_MY_UP_DOC_CNT /* 내가 올린문서 건수 */
				  FROM TBDCMACM022L A /* 결재문서내역 */
				       , (
				       	SELECT   S1.APV_RQS_ID
						  FROM   TBCSPDCP603M S1	/* 문서함 */
						       , TBFDMADM002M S2	/* 감사문서파일관리기본 */
						       , TBCSPDCP101M S3	/* 감사사항 기본*/
						 WHERE S1.RPRT_CD = S2.AUD_DOC_CD(+)
					 	    AND S1.ACP_YR = S3.ACP_YR(+)
                            AND S1.REQ_DVSN_CD = S3.REQ_DVSN_CD(+)
						    AND S1.CVPT_ACP_NO = S3.CVPT_ACP_NO(+)
				       ) B
				 WHERE A.APV_DOC_NO = B.APV_RQS_ID
				   AND A.SBM_CNB = #{cnb}
				   AND A.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
				   AND A.APV_DVSN_CD IN(#{apvDvsnCd})	/* 전자감사 */
				   /*AND A.APV_STA_CD IN ('1', '2')*/	/* 상신전, 결재중 */
			   ) AS APV_MY_UP_DOC_CNT /* 내가 올린문서 건수 */
			   , (
			   	SELECT COUNT(A.APV_DOC_NO) AS APV_MY_LAG_BF_CNT /* 결재대기 건수*/
				  FROM   TBDCMACM022L A /* 결재문서내역 */
				  	   , TBDCMACM023L B /* 결재문서별결재자내역 */
				 WHERE A.APV_DOC_NO = B.APV_DOC_NO
				   AND A.APV_DVSN_CD = B.APV_DVSN_CD
				   AND A.APV_DVSN_CD IN(#{apvDvsnCd})	/* 전자감사 */
				   /* 공석일경우 미열람건 카운트 추가 */
				   AND ( B.APVR_STA_CD IN ('102','103','104','105','106','107') OR (B.APVR_KND_CD = '9' AND B.APVR_STA_CD = '202' AND NVL(B.READ_YN,'N') = 'N' ) )
				   AND B.APVR_CNB = #{cnb}
				   AND A.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
			   ) AS APV_MY_LAG_BF_CNT /* 결재대기 건수*/
               , (
               SELECT COUNT(T23.APV_DOC_NO) AS APV_MY_PRSS_DOC_CNT
                  FROM (SELECT DISTINCT D3.APV_DOC_NO ,
                               D3.APV_DVSN_CD
                          FROM (SELECT APV_DOC_NO,  /*기안한 문서는 반려, 상신취소, 상신완료*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
			                    WHERE APVR_CNB = #{cnb}
			                      AND APVR_SEQ = '1'
			                      AND APVR_STA_CD IN ('101','201','301')
			            	   UNION
			            	   SELECT APV_DOC_NO,  /*기안자가 아닌경우 결재처리한 문서 기준으로 조회, 협조는 진행문서함에 조회 하지 않는다.*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
			                    WHERE APVR_CNB = #{cnb}
			                      AND APVR_SEQ <> '1'
    ]]>
			                      <if test="cnb != '2381'">
			                      AND APVR_KND_CD <![CDATA[<>]]> '4'
			                      </if>
    <![CDATA[
			                      AND SUBSTR(APVR_STA_CD,0,1) = '2'
                               UNION
                               SELECT L.APV_DOC_NO,
                                      /*기안자가 아닌경우 결재한 이력이 있는 경우 문서를 볼수 있게 조회*/ L.APV_DVSN_CD
                                 FROM TBDCMACM023L L,
                                      TBDCMACM023H H
                                WHERE L.APV_DOC_NO = H.APV_DOC_NO
                                  AND L.APVR_CNB = H.APVR_CNB
                                  AND L.APVR_CNB = #{cnb}
                                  AND L.APVR_SEQ <> '1' /*임시 조치*/
                                  ]]>
                                  <if test="cnb != '2381'">
                                  AND L.APVR_KND_CD <![CDATA[<>]]> '4'
                                  </if>
				 <![CDATA[
                                  AND SUBSTR(H.APVR_STA_CD,0,1) IN('2','4') ) D3 ) T23 ,
                       TBDCMACM022L T22
                 WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
                   AND T22.APV_DVSN_CD = T23.APV_DVSN_CD
                   AND T22.APV_DVSN_CD IN (#{apvDvsnCd})
                   AND T22.APV_STA_CD NOT IN ('3','4','5') /*진행중인 문서만 조회하도록 추가*/
                   AND T22.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
                 ) AS APV_MY_PRSS_DOC_CNT /* 진행문서함 건수*/
                 ]]>
                 /*********************** 결재완료함 ************************/
                 , (
                 SELECT COUNT(1) AS APV_MY_APV_DOC_CNT
                    FROM (
                            SELECT DISTINCT D3.APV_DOC_NO
                                 , D3.APV_DVSN_CD
                              FROM (SELECT APV_DOC_NO
                                          , APV_DVSN_CD
                                      FROM TBDCMACM023L
                                     WHERE APVR_CNB = #{cnb}
                                     <if test="cnb != '2381'" >
                                       AND APVR_KND_CD <![CDATA[ <> ]]> '4' /*협조한 문서는 보이지 않도록*/
                                 	 </if>   
                                  ) D3
                          ) T23
                       , TBDCMACM022L T22
                       WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
                        AND  T22.APV_DVSN_CD = T23.APV_DVSN_CD
                        AND   T22.APV_DVSN_CD = #{apvDvsnCd}
                        AND T22.APV_STA_CD = '3' /*승인된 문서만 조회하도록 추가*/
                        <![CDATA[  AND T22.SBM_CNB <> #{cnb} ]]>
                        AND T22.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
               ) AS APV_MY_APV_DOC_CNT 
		  FROM DUAL
	</select>

	<select id="dashBoardOasisApvCntSelect3" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardOasisApvCntSelect3*/
		SELECT (
				SELECT COUNT(A.APV_DOC_NO) AS APV_MY_UP_DOC_CNT /* 내가 올린문서 건수 */
				  FROM TBDCMACM022L A /* 결재문서내역 */
				       , (
				       	SELECT   S1.APV_RQS_ID
						  FROM   TBBADFRE103M S1	/* 문서함 */
						       , TBFDMADM002M S2	/* 감사문서파일관리기본 */
						       , TBBADFRE012M S3	/* 감사사항 기본*/
						 WHERE S1.RPRT_CD = S2.AUD_DOC_CD(+)
					 	    AND S1.ACP_YR = S3.ACP_YR(+)
                            AND S1.ACP_DVSN_CD = S3.ACP_DVSN_CD(+)
						    AND S1.ACP_SRNO = S3.ACP_SRNO(+)
				       ) B
				 WHERE A.APV_DOC_NO = B.APV_RQS_ID
				   AND A.SBM_CNB = #{cnb}
				   AND A.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
				   AND A.APV_DVSN_CD IN(#{apvDvsnCd})	/* 전자감사 */
				   /*AND A.APV_STA_CD IN ('1', '2')*/	/* 상신전, 결재중 */
			   ) AS APV_MY_UP_DOC_CNT /* 내가 올린문서 건수 */
			   , (
			   	SELECT COUNT(A.APV_DOC_NO) AS APV_MY_LAG_BF_CNT /* 결재대기 건수*/
				  FROM   TBDCMACM022L A /* 결재문서내역 */
				  	   , TBDCMACM023L B /* 결재문서별결재자내역 */
				 WHERE A.APV_DOC_NO = B.APV_DOC_NO
				   AND A.APV_DVSN_CD = B.APV_DVSN_CD
				   AND A.APV_DVSN_CD IN(#{apvDvsnCd})	/* 전자감사 */
				   /* 공석일경우 미열람건 카운트 추가 */
				   AND ( B.APVR_STA_CD IN ('102','103','104','105','106','107') OR (B.APVR_KND_CD = '9' AND B.APVR_STA_CD = '202' AND NVL(B.READ_YN,'N') = 'N' ) )
				   AND B.APVR_CNB = #{cnb}
				   AND A.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
			   ) AS APV_MY_LAG_BF_CNT /* 결재대기 건수*/
               , (
               SELECT COUNT(T23.APV_DOC_NO) AS APV_MY_PRSS_DOC_CNT
                  FROM (SELECT DISTINCT D3.APV_DOC_NO ,
                               D3.APV_DVSN_CD
                          FROM (SELECT APV_DOC_NO,  /*기안한 문서는 반려, 상신취소, 상신완료*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
			                    WHERE APVR_CNB = #{cnb}
			                      AND APVR_SEQ = '1'
			                      AND APVR_STA_CD IN ('101','201','301')
			            	   UNION
			            	   SELECT APV_DOC_NO,  /*기안자가 아닌경우 결재처리한 문서 기준으로 조회, 협조는 진행문서함에 조회 하지 않는다.*/
			                          APV_DVSN_CD
			                     FROM TBDCMACM023L
			                    WHERE APVR_CNB = #{cnb}
			                      AND APVR_SEQ <> '1'
    ]]>
			                      <if test="cnb != '2381'">
			                      AND APVR_KND_CD <![CDATA[<>]]> '4'
			                      </if>
    <![CDATA[
			                      AND SUBSTR(APVR_STA_CD,0,1) ='2'
                               UNION
                               SELECT L.APV_DOC_NO,
                                      /*기안자가 아닌경우 결재한 이력이 있는 경우 문서를 볼수 있게 조회*/ L.APV_DVSN_CD
                                 FROM TBDCMACM023L L,
                                      TBDCMACM023H H
                                WHERE L.APV_DOC_NO = H.APV_DOC_NO
                                  AND L.APVR_CNB = H.APVR_CNB
                                  AND L.APVR_CNB = #{cnb}
                                  AND L.APVR_SEQ <> '1' /*임시 조치*/
                                  ]]>
                                  <if test="cnb != '2381'">
                                  AND L.APVR_KND_CD <![CDATA[<>]]> '4'
                                  </if>
 <![CDATA[
                                  AND SUBSTR(H.APVR_STA_CD,0,1) = '2' ) D3 ) T23 ,
                       TBDCMACM022L T22
                 WHERE T22.APV_DOC_NO =T23.APV_DOC_NO
                   AND T22.APV_DVSN_CD = T23.APV_DVSN_CD
                   AND T22.APV_DVSN_CD IN (#{apvDvsnCd})
                   AND T22.APV_STA_CD NOT IN (  '3', '4','5') /*진행중인 문서만 조회하도록 추가*/
                   AND T22.SBM_DH BETWEEN TO_CHAR(SYSDATE, 'YYYY')-1 || '0101' || '000000'  AND TO_CHAR(SYSDATE, 'YYYYMMDD') || '235959'
                 ) AS APV_MY_PRSS_DOC_CNT /* 진행문서함 건수*/
		  FROM DUAL
	]]>
	</select>
    
    <!-- 문서편집기 버전 조회 -->
    <select id="selectEdtVer" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectEdtVer*/
         SELECT EDT_VER
           FROM TBBADDED125M
          WHERE ODT_SNO = (SELECT MAX(ODT_SNO) 
                             FROM TBBADDED125M
                            WHERE EDIT_FLAG = 'HWP')
            AND EDIT_FLAG = 'HWP'
    </select>

    <!-- 주요감사문서 요청 카운트 -->
    <select id="selectMajorAudDocReqCnt" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectMajorAudDocReqCnt*/
		 SELECT COUNT(ROWNUM)  AS CNT
		  FROM TBAEPMAR001M A
   INNER JOIN TBBADDED001M B
	  		ON A.AUD_YR = B.AUD_YR
		   AND A.AUD_NO = B.AUD_NO
		 WHERE A.PRSS_CD = '10'
		   AND B.MNG_DPT_CD = #{dptCd}
    </select>    
    
    
	<!-- 부서알림창 조회 -->
	<select id="dashBoardDptMessageSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardDptMessageSelect*/
		SELECT   SEQ_NO
		       , CNB
		       , F_USR_INFO(CNB,'2') AS USER_NM
		       , DPT_CD
		       , CONTENT
		       , REGI_DT
		       , REGI_ID
		       , MODI_DT
		       , MODI_ID
		  FROM TBAEPBPS001M
		 WHERE DPT_CD = #{dptCd}
		   AND TO_CHAR(REGI_DT,'YYYY-MM-DD') = TO_CHAR(SYSDATE,'YYYY-MM-DD')
		 ORDER BY REGI_DT ASC
	]]>
	</select>

	<!-- 부서알림창 등록 -->
	<insert id="dashBoardDptMessageInsert" parameterType="paramMap">
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardDptMessageInsert*/
		 INSERT INTO TBAEPBPS001M
		 	   (
		 		"SEQ_NO",
		        "CNB",
		 		"DPT_CD",
		 		"CONTENT",
		 		"REGI_DT",
		 		"REGI_ID",
		 		"MODI_DT",
		 		"MODI_ID"
		       )
		 VALUES
		 	   (
		 		(SELECT NVL(MAX(SEQ_NO+1), 1)FROM TBAEPBPS001M),
		 		#{cnb},
		 		#{dptCd},
		 		#{content},
		 		SYSDATE,
		 		#{usrId},
		 		SYSDATE,
		 		#{usrId}
		       )
    </insert>

	<!-- 감사진행현황 -->
	<select id="dashBoardDptAudPrssSituListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardDptAudPrssSituListSelect*/
		SELECT   E.DPT_CD
			   , DECODE( E.DPT_CD, NULL, '계', E.DPT_NM) AS DPT_NM
			   , E.DPT_SNO
			   , COUNT(F.AUD_NO) AS AUD_TOT_CNT
			   , NVL(SUM( CASE WHEN F.PRSS_STEP_CD = 'A1010' THEN 1
                                           WHEN F.PRSS_STEP_CD = 'A1019' THEN 1 ELSE 0 END ), 0) AS MTRL_CLC_CNT		/* 자료수집 */
			   , NVL(SUM( CASE WHEN F.PRSS_STEP_CD = 'A1020' THEN 1 ELSE 0 END ), 0) AS RSV_INSPC_CNT		/* 예비조사 */
			   , NVL(SUM( CASE WHEN F.PRSS_STEP_CD = 'A1030' THEN 1 ELSE 0 END ), 0) AS AUD_EXEC_PLN_CNT	/* 감사실시계획 */
			   , NVL(SUM( CASE WHEN F.PRSS_STEP_CD = 'A1040' THEN 1 ELSE 0 END ), 0) AS AUD_EXEC_CNT		/* 감사실시 */
			   , NVL(SUM( CASE WHEN F.PRSS_STEP_CD = 'A1050' THEN 1 ELSE 0 END ), 0) AS AUD_RSLT_RPT_CNT	/* 감사결과보고 */
			   , NVL(SUM( CASE WHEN F.PRSS_STEP_CD = 'A1060' THEN 1 ELSE 0 END ), 0) AS AUD_RSLT_HNDL_CNT	/* 감사결과처리 */
			   , NVL(SUM( CASE WHEN F.PRSS_STEP_CD = 'A1070' THEN 1 ELSE 0 END ), 0) AS AUD_SBCN_CNT		/* 감사위원회 부의 */
		  FROM (
		 		SELECT   A.DPT_CD
					   , A.DPT_NM
					   , A.DPT_SNO
				  FROM TBDCMACM002M A /* 부서 */
				 WHERE A.USE_YN = 'Y'
				   AND A.IMD_CD = 'Y'
				   AND A.ORZT_DVSN_CD = '20'
				   AND ( A.DPT_TP_CD_2 = 'A' OR A.DPT_CD IN ( '0L0000','180000') ) /* 민원조사단, 공공감사운영단 구분 불가로 예외처리 */
		  	   ) E
		  	   , (
			    /* TO-BE */
				SELECT   A.AUD_YR
					   , A.AUD_NO
					   , A.AUD_SBJ_NM
					   , A.AUD_KND_CD
					   , SUBSTR(A.MNG_DPT_CD, 1, 3) || '000' AS DPT_CD
					   , A.MNG_DPT_CD
					   , A.SPV_BRDV_CD
					   , A.PRSS_STEP_CD
				  FROM TBBADDED001M A
                            INNER JOIN TBBADDED003M B
                            ON (A.AUD_YR = B.AUD_YR AND A.AUD_NO = B.AUD_NO)
				 WHERE A.PRSS_STEP_CD NOT IN ( 'A1080', 'A1090', 'A1000' ,'A1019' )	/* 감사결과시행, 집행전말 조회, 감사계획관리 */
				   /* AND SUBSTRING(A.MNG_DPT_CD, 1, 1) = '0' */
				   AND A.BZT_BGT_DVSN_CD = '1'	/* 원배정인것만 */
                   AND A.AUD_YR > '2016'    /* 2017년도 감사사항부터 가져오도록 수정 신민준 */
                   AND A.AUD_CTRL_CD = '2' /* 통제된 건만 가져오도록 수정 MJ */
                   AND B.AUD_EXEC_HNDL_STA_CD != '9' /* 종료되지 않은 감사사항만 가져오도록 수정 MJ */
				   /* 전자감사인 것만 가져오도록 */
				   AND EXISTS (
				   		SELECT 'X'
				   		  FROM TBBADDED101M S /* 실지감사단계 */
				   		 WHERE S.AUD_YR = A.AUD_YR
				   		   AND S.AUD_NO = A.AUD_NO
					   )
			   ) F
		 WHERE E.DPT_CD = F.DPT_CD(+)
		 GROUP BY ROLLUP (
		 		(
		 		   E.DPT_CD
			     , E.DPT_NM
			     , E.DPT_SNO
		 		)
		 	   )
		 ORDER BY DPT_SNO NULLS FIRST
	]]>
	</select>

	<!-- 감사 처리현황 -->
	<select id="dashBoardAudRsltTrtmSituListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardAudRsltTrtmSituListSelect*/
		SELECT   H.DPT_CD
			   , DECODE( H.DPT_CD, NULL, '계', H.DPT_NM ) AS DPT_NM
			   , H.DPT_SNO
			   , SUM(NVL(I.TOT_CNT, 0)) AS TOT_CNT
			   , DECODE( H.DPT_CD, NULL, TO_CHAR(SUM(NVL(I.AUD_END_RPT_CNT, 0))) , MIN(I.AUD_END_RPT))  AS AUD_END_RPT
			   , DECODE( H.DPT_CD, NULL, TO_CHAR(SUM(NVL(I.AUD_DVCHF_CNT, 0)))   , MIN(I.AUD_DVCHF))    AS AUD_DVCHF
--			   , DECODE( H.DPT_CD, NULL, TO_CHAR(SUM(NVL(I.AUD_QLT_CNT, 0))), MIN(I.AUD_QLT)) AS AUD_QLT
			   , DECODE( H.DPT_CD, NULL, TO_CHAR(SUM(NVL(I.AUD_BRUCHF_CNT, 0)))  , MIN(I.AUD_BRUCHF))   AS AUD_BRUCHF
			   , DECODE( H.DPT_CD, NULL, TO_CHAR(SUM(NVL(I.AUD_DHD_CNT, 0)))     , MIN(I.AUD_DHD))      AS AUD_DHD
			   , DECODE( H.DPT_CD, NULL, TO_CHAR(SUM(NVL(I.AUD_PSD_CNT, 0)))     , MIN(I.AUD_PSD))      AS AUD_PSD
			   , DECODE( H.DPT_CD, NULL, TO_CHAR(SUM(NVL(I.AUD_CHF_CMTR_CNT, 0))), MIN(I.AUD_CHF_CMTR)) AS AUD_CHF_CMTR
			   , DECODE( H.DPT_CD, NULL, TO_CHAR(SUM(NVL(I.AUD_SBCN_CNT, 0)))    , MIN(I.AUD_SBCN))     AS AUD_SBCN
		  FROM (
		  		SELECT   S.DPT_CD
		  			   , S.DPT_NM
		  			   , S.DPT_SNO
				  FROM TBDCMACM002M S /* 부서 */
				 WHERE S.USE_YN = 'Y'
				   AND S.IMD_CD = 'Y'
				   AND S.ORZT_DVSN_CD = '20'
				   AND ( S.DPT_TP_CD_2 = 'A' OR S.DPT_CD IN ( '0L0000','180000') ) /* 민원조사단, 공공감사운영단 구분 불가로 예외처리 */
		  	   ) H
		  	   , (
		  	   	SELECT   G.DPT_CD
		  	   		   , COUNT(G.DPT_CD) AS TOT_CNT
		  	   		   , SUM( CASE WHEN G.PRSS_STEP_CD = '05'                   THEN 1 ELSE 0 END ) AS AUD_END_RPT_CNT  --종료보고
		  	   		   , SUM( CASE WHEN G.PRSS_STEP_CD = '06' 		 			THEN 1 ELSE 0 END ) AS AUD_DVCHF_CNT    --과장
--		  	   		   , SUM( CASE WHEN G.PRSS_STEP_CD IN ('05', '06') 			THEN 1 ELSE 0 END ) AS AUD_QLT_CNT
		  	   		   , SUM( CASE WHEN G.PRSS_STEP_CD = '08' 		 			THEN 1 ELSE 0 END ) AS AUD_BRUCHF_CNT   --국장
		  	   		   , SUM( CASE WHEN G.PRSS_STEP_CD = '09'                   THEN 1 ELSE 0 END ) AS AUD_DHD_CNT      --차장
		  	   		   , SUM( CASE WHEN G.PRSS_STEP_CD = '10'                   THEN 1 ELSE 0 END ) AS AUD_PSD_CNT      --총장
		  	   		   , SUM( CASE WHEN G.PRSS_STEP_CD = '11' 					THEN 1 ELSE 0 END ) AS AUD_CHF_CMTR_CNT --위원심의
		  	   		   , SUM( CASE WHEN G.PRSS_STEP_CD = '12' 					THEN 1 ELSE 0 END ) AS AUD_SBCN_CNT     --부의
		  	   		   , AGGR_CONCAT(( CASE WHEN G.PRSS_STEP_CD = '05' 			THEN G.DELAY_GUBUN END ), '|') AS AUD_END_RPT   --종료보고
		  	   		   , AGGR_CONCAT(( CASE WHEN G.PRSS_STEP_CD = '06' 			THEN G.DELAY_GUBUN END ), '|') AS AUD_DVCHF     --과장
--		  	   		   , AGGR_CONCAT(( CASE WHEN G.PRSS_STEP_CD IN ('05', '06') THEN G.DELAY_GUBUN END ), '|') AS AUD_QLT       
		  	   		   , AGGR_CONCAT(( CASE WHEN G.PRSS_STEP_CD = '08'			THEN G.DELAY_GUBUN END ), '|') AS AUD_BRUCHF    --국장
		  	   		   , AGGR_CONCAT(( CASE WHEN G.PRSS_STEP_CD = '09'          THEN G.DELAY_GUBUN END ), '|') AS AUD_DHD       --차장
		  	   		   , AGGR_CONCAT(( CASE WHEN G.PRSS_STEP_CD = '10'          THEN G.DELAY_GUBUN END ), '|') AS AUD_PSD       --총장
		  	   		   , AGGR_CONCAT(( CASE WHEN G.PRSS_STEP_CD = '11' 			THEN G.DELAY_GUBUN END ), '|') AS AUD_CHF_CMTR  --위원심의
		  	   		   , AGGR_CONCAT(( CASE WHEN G.PRSS_STEP_CD = '12' 			THEN G.DELAY_GUBUN END ), '|') AS AUD_SBCN      --부의
				  FROM (
						SELECT   F.DPT_CD
							   , F.PRSS_STEP_CD
							   , F.OW_DHD_APV_DT
							   , (
		                       	  CASE
		                       		 WHEN TOT_DHD_DVS_CD IS NOT NULL
		                             THEN
									   	CASE
									   		WHEN F.PRSS_STEP_CD = '05' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RPT_DDLN_DT)) > 0	            THEN 'R'    --종료보고
									   		WHEN F.PRSS_STEP_CD = '06' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.BRDV_HNDL_DDLN_DT)) > 0       THEN 'R'    --과장
--									   		WHEN F.PRSS_STEP_CD = '05' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_CHGR_APV_DDLN_DT)) > 0    THEN 'R'    /* 조장담당자1 - 품질 */
--									   		WHEN F.PRSS_STEP_CD = '06' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_OFER_APV_DDLN_DT)) > 0	THEN 'R'    /* 조장담당자2 - 품질 */
									   		WHEN F.PRSS_STEP_CD = '08' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RVW_RM_APV_DDLN_DT)) > 0      THEN 'R'    --국장
									   		WHEN F.PRSS_STEP_CD = '09' AND F.OW_DHD_APV_DT IS     NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.DHD_APV_DDLN_DT)) > 0 THEN 'R' --차	(2019.04.18 LSR 수정)
									   		WHEN F.PRSS_STEP_CD = '10' AND F.OW_DHD_APV_DT IS NOT NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.PSD_APV_DDLN_DT)) > 0 THEN 'R' --총	(2019.04.18 LSR 수정)
									   		WHEN F.PRSS_STEP_CD = '11' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.CHF_CMTR_APV_DDLN_DT)) > 0		                        THEN 'R' --위
									   		ELSE 'G'
									   	 END
									ELSE
									   	CASE
									   		WHEN F.PRSS_STEP_CD = '05' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RPT_DDLN_DT)) > 0	            THEN 'R'    --종료보고
									   		WHEN F.PRSS_STEP_CD = '06' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.BRDV_HNDL_DDLN_DT)) > 0       THEN 'R'    --과장
--									   		WHEN F.PRSS_STEP_CD = '05' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_CHGR_APV_DDLN_DT)) > 0    THEN 'R'    /* 조장담당자1 - 품질 */
--									   		WHEN F.PRSS_STEP_CD = '06' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_OFER_APV_DDLN_DT)) > 0	THEN 'R'    /* 조장담당자2 - 품질 */
									   		WHEN F.PRSS_STEP_CD = '08' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RVW_RM_APV_DDLN_DT)) > 0      THEN 'R'    --국장
									   		WHEN F.PRSS_STEP_CD = '09' AND F.OW_DHD_APV_DT IS     NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.TOT_DHD_APV_DDLN_DT)) > 0 THEN 'R' --차
									   		WHEN F.PRSS_STEP_CD = '10' AND F.OW_DHD_APV_DT IS NOT NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.TOT_DHD_APV_DDLN_DT)) > 0 THEN 'R' --총
									   		WHEN F.PRSS_STEP_CD = '11' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.CHF_CMTR_APV_DDLN_DT)) > 0		                        THEN 'R' --위
									   		ELSE 'G'
									   	 END
								END
								) || '$' || F.AUD_YR_NO AS DELAY_GUBUN /* G: 지연없음, R: 지연 */
						  FROM (
								/* AS-IS (TO-BE 삭제, 전자감사에 맞게 수정. 원본쿼리 : 17.01.06 Svn Revision 3444) */
								SELECT   A.AUD_YR
									   , A.AUD_NO
									   , A.AUD_YR || '_' || A.AUD_NO AS AUD_YR_NO
									   , A.AUD_KND_CD
									   , A.AUD_GRN_NO
									   , SUBSTR(A.MNG_DPT_CD, 1, 3) || '000' AS DPT_CD
                                      -- 01:자료수집 02:예비조사 03:감사계획 04:실지감사 05:감사결과보고 06:과장 07:품질 08:국장 09:차장 10:총장 11:위원 12:부의
                                      , CASE
                                           WHEN A.PRSS_STEP_CD = 'A1070' AND B.CHF_CMTR_APV_DT IS NOT NULL    THEN '12' --부의
                                           WHEN A.PRSS_STEP_CD = 'A1070' AND B.CHF_CMTR_APV_DT IS NULL        THEN '11' --주심위원심의
                                           WHEN A.PRSS_STEP_CD = 'A1060' AND B.OW_DHD_APV_DT IS NOT NULL      THEN '10' --총장
                                           WHEN A.PRSS_STEP_CD = 'A1060' AND B.JA_JDG_SSEC_APV_DT IS NOT NULL THEN '09' --차장
                                           WHEN A.PRSS_STEP_CD = 'A1060' AND B.AUD_BRDV_APV_DT IS NOT NULL    THEN '08' --국장
                                           WHEN A.PRSS_STEP_CD = 'A1060' AND B.AUD_BRDV_APV_DT IS NULL        THEN '06' --과장
                                           WHEN A.PRSS_STEP_CD = 'A1050'                                      THEN '05' --종료보고
                                           ELSE A.PRSS_STEP_CD
                                       END AS PRSS_STEP_CD       /* 전자감사와 호환되도록 수정 17.01.16 신민준 */
--								       , TO_CHAR(TO_DATE(B.RPT_DDLN_DT) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RPT_DDLN_DT           /* 보고기한일 */
                                       , NVL(B.EXTN_RPT_DDLN_DT, B.RPT_DDLN_DT) AS RPT_DDLN_DT	-- 2019.04.05 LSR 수정
								       , B.RTN_RPT_DT             /* 귀청보고일 */
--								       , TO_CHAR(TO_DATE(B.BRDV_HNDL_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS BRDV_HNDL_DDLN_DT      /* 국과처리기한일 - 과장 */
                                       , NVL(B.EXTN_BRDV_HNDL_DDLN_DT, B.BRDV_HNDL_DDLN_DT) AS BRDV_HNDL_DDLN_DT	-- 2019.04.05 LSR 수정
								       , B.AUD_BRDV_APV_DT        /* 감사국과결재일 - 과장*/
--								       , TO_CHAR(TO_DATE(B.MDT_CHGR_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS MDT_CHGR_APV_DDLN_DT   /* 조정담당자결재기한일 - 품질 05*/
                                       , NVL(B.EXTN_MDT_CHGR_APV_DDLN_DT, B.MDT_CHGR_APV_DDLN_DT) AS MDT_CHGR_APV_DDLN_DT	-- 2019.04.05 LSR 수정
--								       , TO_CHAR(TO_DATE(B.MDT_OFER_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS MDT_OFER_APV_DDLN_DT   /* 조정담당관결재기한일 - 품질 06*/
                                       , NVL(B.EXTN_MDT_OFER_APV_DDLN_DT, B.MDT_OFER_APV_DDLN_DT) AS MDT_OFER_APV_DDLN_DT	-- 2019.04.05 LSR 수정
								       , B.MDT_OFER_APV_DT        /* 조정담당관결재일 */
								       , B.MDT_DDG_APV_DT         /* 조정심의관결재일 - 품질 */
--								       , TO_CHAR(TO_DATE(B.RVW_RM_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RVW_RM_APV_DDLN_DT	  /* 심의실결재기한일 - 국장 */
                                       , NVL(B.EXTN_RVW_RM_APV_DDLN_DT, B.RVW_RM_APV_DDLN_DT) AS RVW_RM_APV_DDLN_DT	-- 2019.04.05 LSR 수정
								       , B.JA_JDG_SSEC_APV_DT     /* 법무심사관결재일 - 국장 */
--								       , TO_CHAR(TO_DATE(B.TOT_DHD_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS TOT_DHD_APV_DDLN_DT    /* 총차장결재기한일 */
                                       , NVL(B.EXTN_TOT_DHD_APV_DDLN_DT, B.TOT_DHD_APV_DDLN_DT) AS TOT_DHD_APV_DDLN_DT	-- 2019.04.18 LSR 수정
                                       , NVL(B.EXTN_DHD_APV_DDLN_DT, B.DHD_APV_DDLN_DT) AS DHD_APV_DDLN_DT	-- 2019.04.18 LSR 수정
                                       , NVL(B.EXTN_PSD_APV_DDLN_DT, B.PSD_APV_DDLN_DT) AS PSD_APV_DDLN_DT	-- 2019.04.18 LSR 수정
								       , B.OW_DHD_APV_DT          /* 사무차장결재일 - 차장 */
								       , B.OW_PSD_APV_DT          /* 사무총장결재일 - 총장 */
--								       , TO_CHAR(TO_DATE(B.CHF_CMTR_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS CHF_CMTR_APV_DDLN_DT   /* 주심위원결재기한일 */
                                       , NVL(B.EXTN_CHF_CMTR_APV_DDLN_DT, B.CHF_CMTR_APV_DDLN_DT) AS CHF_CMTR_APV_DDLN_DT	-- 2019.04.05 LSR 수정
								       , B.CHF_CMTR_APV_DT        /* 주심위원결재일 */
								       , B.PSD_APV_DDLN_DT AS TOT_DHD_DVS_CD
								  FROM   TBBADDED001M A	/* 감사사항기본 */
								  	   , TBBADDED003M B	/* 국과별감사처리상황기본 */
								 WHERE A.AUD_YR = B.AUD_YR(+)
								   AND A.AUD_NO = B.AUD_NO(+)
								   AND B.AUD_EXEC_HNDL_STA_CD != '9'	/* 종료가 아닌 것 */
								   /* AND SUBSTRING(A.MNG_DPT_CD, 1, 1) = '0' */
								   AND A.BZT_BGT_DVSN_CD = '1'	/* 원배정인것만 */
								   AND PRSS_STEP_CD IN ('04','05','06','07','08', '09', '11', 'A1050', 'A1060', 'A1070') /* 처리중, 감사결과보고 중인 것만 가져오기 */
--                                   AND A.PRSS_STEP_CD = 'A1050'
                                                                                                                                                                  /* 전자감사와 호환되도록 수정 17.01.16 신민준 */
                                   AND A.AUD_YR > '2016'    /* 2017년도 감사사항부터 가져오도록 수정 신민준 */
								   AND EXISTS (
								   		SELECT 'X'
								   		  FROM TBDCMACM002M S
								   		 WHERE S.DPT_CD = A.MNG_DPT_CD
								   		   AND S.USE_YN = 'Y'
								   	   )
							   ) F
					   ) G
				 GROUP BY G.DPT_CD
			   ) I
		 WHERE H.DPT_CD = I.DPT_CD(+)
		 GROUP BY ROLLUP (
		 		(
		 			 H.DPT_CD
				   , H.DPT_NM
				   , H.DPT_SNO
		 		)
		 	   )
		 ORDER BY DPT_SNO NULLS FIRST 
	]]>
	</select>

	<!-- 보류사항 목록 -->
	<select id="dashBoardDfSbjListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
         /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardDfSbjListSelect*/
        SELECT D3.AUD_YR
                                 ,D3.AUD_NO
                                 ,D3.AUD_RPRT_DVSN_CD      AS AUD_RPRT_DVSN_CD
                                 ,D3.DOC_ID                AS DOC_ID
                                 ,F_DPT_INFO(D4.MNG_DPT_CD, '1') AS SPV_BRDV_NM
                                 ,F_MNG_KND_AUDYRNO(D3.AUD_YR, D3.AUD_NO, '' , '-') AS CLASSIFY_NO
                                 ,D4.AUD_SBJ_NM
                                 ,D3.TITLE_NM 
                                 ,D3.DSP_RQ_SNO
                                 ,D3.DSP_RQ_CD
                                 ,F_CODE_NM('1000002',D3.DSP_RQ_CD) AS DSP_RQ_NM
                                 ,D3.COPT_OFI_NM
                                 ,MIN(D3.GWA_APV)          AS GWA_APV
                                 ,MIN(D3.GUK_APP)          AS GUK_APP
                                 ,MIN(D3.GUK_APV)          AS GUK_APV
                                 ,MIN(D3.CHA_APP)          AS CHA_APP
                                 ,MIN(D3.CHA_APV)          AS CHA_APV
                                 ,MIN(D3.CHONG_APP)        AS CHONG_APP
                                 ,MIN(D3.CHONG_APV)        AS CHONG_APV
                                 ,MAX(D3.FNL_APV)          AS FNL_APV
                                 ,MIN(D3.WI_APP)           AS WI_APP
                                 ,MIN(D3.WI_APV)           AS WI_APV
                                 ,MAX(D3.SYT_TRTM_DVSN_YN) AS SYT_TRTM_DVSN_YN
                                 ,MAX(D3.USE_YN)           AS USE_YN
                                 ,MAX(D3.AUD_RPRT_STA_CD)  AS AUD_RPRT_STA_CD
                                 ,MAX(D3.WI_RPRT_STA_CD)   AS WI_RPRT_STA_CD
                                 ,DECODE(D3.RE_DOC_ID,NULL,'3','1') AS GUBN
                                 ,TO_CHAR(TO_DATE(MIN(D3.SBCN_DY)),'YYYY-MM-DD') AS SBCN_DY
                                 ,D3.RE_DOC_ID AS RE_DOC_ID
                                 ,(SELECT COUNT(1) 
                                     FROM TBBADDED113M ST1
                                    WHERE ST1.AUD_YR = D3.AUD_YR
                                      AND ST1.AUD_NO = D3.AUD_NO
                                      AND ST1.SBCN_VT_CD = '90') AS SBCN_CNT
                             FROM (
                                   SELECT D3.AUD_YR
                                         ,D3.AUD_NO
                                         ,D3.TITLE_NM
                                         ,D3.AFF_SNO
                                         ,D3.DSP_RQ_SNO
                                         ,D3.DSP_RQ_CD
                                         ,D3.COPT_OFI_NM
                                         ,NVL(D1.AUD_RPRT_DVSN_CD,'40') AS AUD_RPRT_DVSN_CD
                                         ,CASE WHEN D1.RPRT_CD = 'A10600200' THEN D1.DOC_ID
                                               ELSE D1.REF_ID
                                                END AS DOC_ID
                                         ,CASE WHEN D1.RPRT_CD = 'A10600200' AND (D2.APVR_PST_CD = '0013600' OR D2.APVR_PST_CD = '0057400' OR D2.APVR_PST_CD = '0035400') AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
			                                               ELSE NULL
			                                                END AS GWA_APV   --과장결재일
                                         ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0015800' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                               WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0035100' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                               WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0058100' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                               ELSE NULL
                                                END AS GUK_APP   --국단실장접수일
                                         ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0015800' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                               WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0035100' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                               WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0058100' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                               ELSE NULL
                                                END AS GUK_APV   --국단실장결재일
                                         ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055600' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                               WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0045900' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                               ELSE NULL
                                                END AS CHA_APP   --차장,본부장 접수일
                                         ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055600' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                               WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0045900' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                               ELSE NULL
                                                END AS CHA_APV   --차장,본부장 결재일
                                         ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055700' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                               ELSE NULL
                                                END AS CHONG_APP --사무총장접수일
                                         ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055700' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                               ELSE NULL
                                                END AS CHONG_APV --사무총장결재일
                                         ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D1.APV_STA_CD = '30' THEN D2.APV_DH
                                               ELSE NULL
                                                END AS FNL_APV   --최종결재일
                                         ,CASE WHEN D1.RPRT_CD = 'A10700100' AND D2.APVR_PST_CD = '0010600' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ,D2.APV_DH DESC)
                                               ELSE NULL
                                                END AS WI_APP    --주심위원접수일
                                         ,CASE WHEN D1.RPRT_CD = 'A10700100' AND D2.APVR_PST_CD = '0010600' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                               ELSE NULL
                                                END AS WI_APV    --주심위원결재일
                                         ,D1.SYT_TRTM_DVSN_YN
                                         ,D1.USE_YN
                                         ,DECODE(D1.RPRT_CD,'A10600200',D1.APV_STA_CD ) AS AUD_RPRT_STA_CD
                                         ,DECODE(D1.RPRT_CD,'A10700100',D1.APV_STA_CD ) AS WI_RPRT_STA_CD
                                         ,D3.REFER_DVSN_D10
                                         ,D3.REFER_DVSN_E10
                                         ,D3.SBCN_DY
                                         ,D3.RE_SBCN_DY
                                         ,D3.RE_WI_APV
                                         ,D3.RE_DOC_ID
                                     FROM (SELECT 
                                                T1.AUD_YR
                                                , T1.AUD_NO
                                                , T1.DOC_ID AS DOC_ID
                                                , T2.DOC_ID AS RE_DOC_ID
                                                , T8.TITLE_NM 
                                                , T1.DSP_RQ_CD
                                                , T1.AFF_SNO
                                                , T1.DSP_RQ_SNO
                                                , CASE WHEN T7.RLTN_ORG_CD IS NOT NULL THEN F_ORG_INFO(T7.RLTN_ORG_CD,'1')ELSE '' END COPT_OFI_NM
                                                , SUM(CASE WHEN T3.REFER_DVSN_CD = 'D10' THEN 1 ELSE 0 END) AS REFER_DVSN_D10   --부의
                                                , SUM(CASE WHEN T3.REFER_DVSN_CD = 'E10' THEN 1 ELSE 0 END) AS REFER_DVSN_E10   --위임
                                                , MIN(T1.SBCN_DY) AS SBCN_DY    -- 부의 일자
                                                , MIN(T4.SBCN_DY) AS RE_SBCN_DY -- 재부의 일자
                                                , MAX(T5.APV_STA_CD) 
                                                , MIN(T6.APV_DH) AS RE_WI_APV      -- 재부의 주심위원설명자료 결재일자
                                              FROM TBBADDED113M T1                                                   
                                                   LEFT OUTER JOIN TBBADDED146M T2
                                                   ON (T1.AUD_YR = T2.AUD_YR AND T1.AUD_NO = T2.AUD_NO
                                                       AND T1.DOC_ID = T2.HD_DOC_ID AND T2.HD_APVR_CD = 'A107001'
                                                       AND T1.AFF_SNO = T2.HD_AFF_SNO AND T1.DSP_RQ_SNO = T2.HD_DSP_RQ_SNO)
                                                   LEFT OUTER JOIN TBBADDED145M T3
                                                   ON (T2.AUD_YR = T3.AUD_YR AND T2.AUD_NO = T3.AUD_NO
                                                       AND T2.AUD_STEP_CD = T3.AUD_STEP_CD AND T2.DOC_ID = T3.DOC_ID 
                                                       AND T2.APVR_CD = T3.APVR_CD AND T2.AFF_SNO = T3.AFF_SNO)
                                                   LEFT OUTER JOIN TBBADDED113M T4
                                                   ON (T2.AUD_YR = T4.AUD_YR AND T2.AUD_NO = T4.AUD_NO
                                                       AND T2.DOC_ID = T4.DOC_ID AND  T4.APVR_CD = '0010600'
                                                       AND T2.AFF_SNO = T4.AFF_SNO AND T2.DSP_RQ_SNO = T4.DSP_RQ_SNO)
                                                   LEFT OUTER JOIN TBBADDED103M T5
                                                   ON (T5.REF_ID = T4.DOC_ID AND T5.RPRT_CD = 'A10700100')
                                                   LEFT OUTER JOIN TBDCMACM023H T6
                                                   ON (T5.APV_RQS_ID = T6.APV_DOC_NO AND T6.APVR_PST_CD = '0010600')
                                                   LEFT OUTER JOIN TBBADDED146M T7 -- 원 부의 처분요구
                                                       ON (T7.AUD_YR = T1.AUD_YR AND T7.AUD_NO = T1.AUD_NO
                                                           AND T7.DOC_ID = T1.DOC_ID   AND  T7.APVR_CD = 'A107001'
                                                           AND T7.AFF_SNO = T1.AFF_SNO AND T7.DSP_RQ_SNO = T1.DSP_RQ_SNO)
                                                   LEFT OUTER JOIN TBBADDED145M T8 -- 원 부의 처분요구
                                                       ON (T8.AUD_YR = T1.AUD_YR AND T8.AUD_NO = T1.AUD_NO
                                                           AND T8.DOC_ID = T1.DOC_ID   AND  T8.APVR_CD =  T1.APVR_CD
                                                           AND T8.AFF_SNO = T1.AFF_SNO )
                                             WHERE T1.SBCN_VT_CD = '90'
                                                AND EXISTS (SELECT 1 FROM TBBADDED103M A WHERE A.AUD_YR = T1.AUD_YR AND A.AUD_NO = T1.AUD_NO AND T1.DOC_ID = A.DOC_ID AND  NVL(A.USE_YN,'Y') <> 'N')
                                                 AND ((T2.HD_DOC_ID IS NULL AND T7.DF_DOC_ID IS NULL)
                                                          OR (T2.HD_DOC_ID IS NOT NULL AND T7.DF_DOC_ID IS NOT NULL))
                                             GROUP BY T1.AUD_YR, T1.AUD_NO, T1.DOC_ID, T1.AFF_SNO, T1.DSP_RQ_SNO,  T2.DOC_ID , T8.TITLE_NM, T1.DSP_RQ_CD,T7.RLTN_ORG_CD) D3
                                         LEFT OUTER JOIN TBBADDED103M D1
                                         ON (D3.AUD_YR = D1.AUD_YR AND D3.AUD_NO = D1.AUD_NO 
                                            AND (D3.DOC_ID = D1.DOC_ID OR D3.DOC_ID = D1.REF_ID)
                                            AND D1.RPRT_CD IN ('A10600200','A10700100')
                                            AND NVL(D1.FNL_BAI_RPRT_YN,'N') != 'Y'
                                            )
                                         LEFT OUTER JOIN (SELECT A.SEQ
                                                              ,A.APV_DOC_NO
                                                              ,A.APVR_PST_CD
                                                              ,A.APVR_KND_CD
                                                              ,A.APVR_STA_CD
                                                              ,A.APV_DH
                                                              ,A.APV_DVSN_CD
                                                              ,A.APVR_CNB
                                                          FROM TBDCMACM023H A
                                                        UNION ALL
                                                        SELECT 9999999999 AS SEQ
                                                              ,B.APV_DOC_NO
                                                              ,B.APVR_PST_CD
                                                              ,B.APVR_KND_CD
                                                              ,B.APVR_STA_CD
                                                              ,B.APV_DH
                                                              ,B.APV_DVSN_CD
                                                              ,B.APVR_CNB
                                                          FROM TBDCMACM023L B
                                                         WHERE B.APVR_STA_CD IN ('102','103')
                                                           AND NOT EXISTS (SELECT 'X'
                                                                             FROM TBDCMACM023H S
                                                                            WHERE S.APV_DOC_NO  = B.APV_DOC_NO 
                                                                              AND S.APV_DVSN_CD = B.APV_DVSN_CD
                                                                              AND S.APVR_CNB    = B.APVR_CNB   
                                                                      )
                                                         ORDER BY SEQ) D2
                                         ON (D1.APV_RQS_ID = D2.APV_DOC_NO AND D2.APVR_KND_CD IN ('2','3','9'))
                                    WHERE 1=1

                                    ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ  /*D2.APV_SNO,D2.APVR_SEQ*/
                                   ) D3 INNER JOIN TBBADDED001M D4
                                                ON D3.AUD_YR = D4.AUD_YR
                                               AND D3.AUD_NO = D4.AUD_NO
                            WHERE (CASE WHEN D3.REFER_DVSN_D10 =  0 THEN NVL(D3.RE_WI_APV,TO_DATE('99991231'))    --부의건수가 없으면 위원결재일
                                        WHEN D3.REFER_DVSN_D10 <> 0 THEN TO_DATE(NVL(D3.RE_SBCN_DY,'99991231'))   --부의건수가 있으면 부의일
                                        ELSE TO_DATE('99991231')
                                        END) > SYSDATE
                                  AND NVL(D4.SEC_AUD_YN,'N') <> 'Y'
                               AND  EXISTS (SELECT 1 FROM TBBADDED003M A WHERE A.AUD_YR = D4.AUD_YR AND A.AUD_NO = D4.AUD_NO AND A.AUD_END_RSN IS NULL)
                            GROUP BY D3.AUD_YR,D3.AUD_NO,D3.AUD_RPRT_DVSN_CD,D3.DOC_ID, D3.RE_DOC_ID, D4.MNG_DPT_CD,D4.AUD_SBJ_NM,D3.TITLE_NM ,D3.DSP_RQ_CD ,D3.COPT_OFI_NM,D3.DSP_RQ_SNO
                             ORDER BY MIN(D3.SBCN_DY), D3.DSP_RQ_SNO 
	]]>
	</select>

	<!-- 주심위원 목록 -->
	<select id="dashBoardChfCmtrListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardChfCmtrListSelect*/
		SELECT   A.CNB AS CHF_CMTR_CNB
			   , A.USR_NAM
			   , A.RAL_BLT_DIV_CD	/* 실소속과코드 */
		  FROM TBDCMACM001M A
		 WHERE A.DPT_CD = '510000'	/* 감사위원 */
		   AND A.USR_DVSN_CD = 1	/* 일반사용자 */
		 ORDER BY RAL_BLT_DIV_CD, SRT_KY_NO
	]]>
	</select>

	<!-- 주심위원별 처리상황 -->
	<select id="dashBoardChfCmtrHndlSituListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardChfCmtrHndlSituListSelect*/
		 WITH BASIS_INFO AS (/* 기본정보AA : BASIS_INFO */
                            SELECT A1.AUD_YR                                                    AS AUD_YR       --감사년도
                                  ,A1.AUD_NO                                                    AS AUD_NO       --감사번호
                                  ,A1.AUD_KND_CD                                                AS AUD_KND_CD   --감사종류코드(1:재무,2:특정,3:성과,4:기관,5:확인,9:서면)
                                  ,F_MNG_KND_AUDYRNO(A1.AUD_YR, A1.AUD_NO, A1.AUD_KND_CD, '-')  AS AUD_YR_NO    --분류번호   
                                  ,(SELECT T4.ABR_DPT_NM_1
                                         FROM TBDCMACM002M T4
                                        WHERE T4.DPT_CD = (SELECT A2.HIRK_DPT_CD
                                                             FROM TBDCMACM002M A2
                                                            WHERE A2.DPT_CD =  A1.MNG_DPT_CD)
                                           AND T4.USE_YN = 'Y'
                                           AND ROWNUM = 1)                                  AS HIRK_DPT_NM  --국
                                  ,  (SELECT A2.HIRK_DPT_CD
                                                             FROM TBDCMACM002M A2
                                                            WHERE A2.DPT_CD =  A1.SPV_BRDV_CD) AS HIRK_DPT_CD
                                  ,F_DPT_INFO(A1.MNG_DPT_CD, 1)                             AS AUD_DPT_NM   --과
                                  ,A1.AUD_SBJ_NM                                                AS AUD_SBJ_NM   --감사사항명
                                  ,F_CODE_NM('1000739', A1.AUD_KND_CD)  AS AUD_KND_NM   --종류코드2(1:민원2:국민3:공익4:국회5:심사6:재심8:손망9:판청)
                                  ,(SELECT A6.DVSN_CD
                                      FROM TBBADDED030L A6
                                     WHERE A6.AUD_YR = A1.AUD_YR
                                       AND A6.AUD_NO = A1.AUD_NO
                                       AND A6.SRNO   = 1)                                       AS AUD_KND_CD2  --종류코드2
                                  ,(SELECT TO_DATE(A5.REQ_NTAS_DCS_DT)
                                      FROM TBBADDED003M A5
                                     WHERE A5.AUD_YR = A1.AUD_YR
                                       AND A5.AUD_NO = A1.AUD_NO)                               AS REQ_NTAS_DCS_DT  --청구국회결정일
                                  ,(SELECT NVL(A7.EXTN_PRD_COFM_DT,0)
                                      FROM TBBADDED003M A7
                                     WHERE A7.AUD_YR = A1.AUD_YR
                                       AND A7.AUD_NO = A1.AUD_NO)                               AS EXTN_PRD_COFM_DT  --연장승인일
                                  ,B.DPT_SNO
                                  ,(SELECT T1.DPT_SNO FROM TBDCMACM002M T1 WHERE T1.DPT_CD = A1.MNG_DPT_CD) AS R_DPT_SNO
                                  ,B.DPT_CD
                                  ,B.DPT_NM
                                  ,(SELECT MAX(TO_CHAR(TO_DATE(A8.EXAM_RPT_APV_DT),'YYYY-MM-DD')) AS EXAM_RPT_APV_DT
                                      FROM TBCSPEAR001M A8
                                          ,(SELECT TSK_KEY1 AS ACP_YR
                                                  ,TSK_KEY2 AS REQ_DVSN_CD
                                                  ,TSK_KEY3 AS CVPT_ACP_NO
                                                  ,AUD_YR
                                                  ,AUD_NO
                                              FROM TBBADDED030L) A9
                                          ,TBBADDED001M A10
                                     WHERE A8.ACP_YR      = A9.ACP_YR(+)
                                       AND A8.REQ_DVSN_CD = A9.REQ_DVSN_CD(+)
                                       AND A8.CVPT_ACP_NO = A9.CVPT_ACP_NO(+)     
                                       AND A9.AUD_YR      = A10.AUD_YR 
                                       AND A9.AUD_NO      = A10.AUD_NO
                                       AND A10.AUD_YR     = A1.AUD_YR
                                       AND A10.AUD_NO     = A1.AUD_NO
                                   ) AS EXAM_RPT_APV_DT --감사실시여부검토일
                                  ,(SELECT MAX(
                                           CASE WHEN A8.REQ_DVSN_CD IN ('2','3') AND (A8.EXAM_RPT_APV_DT IS NULL OR A8.REQ_EXAM_RSLT_CD <> '01') THEN ''
                                                WHEN A8.REQ_DVSN_CD = '2' AND (A8.EXAM_RPT_APV_DT IS NOT NULL AND A8.REQ_EXAM_RSLT_CD = '01') THEN TO_CHAR(TO_DATE(A8.EXAM_RPT_APV_DT)+60, 'YYYY-MM-DD')
                                                WHEN A8.REQ_DVSN_CD = '3' AND (A8.EXAM_RPT_APV_DT IS NOT NULL AND A8.REQ_EXAM_RSLT_CD = '01') THEN TO_CHAR(ADD_MONTHS(TO_DATE(A8.EXAM_RPT_APV_DT) , 6), 'YYYY-MM-DD')
                                                ELSE '' END) AS HNDL_DDLN_DT2
                                      FROM TBCSPEAR001M A8
                                          ,(SELECT TSK_KEY1 AS ACP_YR
                                                  ,TSK_KEY2 AS REQ_DVSN_CD
                                                  ,TSK_KEY3 AS CVPT_ACP_NO
                                                  ,AUD_YR
                                                  ,AUD_NO
                                              FROM TBBADDED030L) A9
                                          ,TBBADDED001M A10
                                     WHERE A8.ACP_YR      = A9.ACP_YR(+)
                                       AND A8.REQ_DVSN_CD = A9.REQ_DVSN_CD(+)
                                       AND A8.CVPT_ACP_NO = A9.CVPT_ACP_NO(+)     
                                       AND A9.AUD_YR      = A10.AUD_YR 
                                       AND A9.AUD_NO      = A10.AUD_NO
                                       AND A10.AUD_YR     = A1.AUD_YR
                                       AND A10.AUD_NO     = A1.AUD_NO
                                   ) AS HNDL_DDLN_DT2 --감사처리기한
                                   , C.AUD_EXEC_HNDL_STA_CD
                              FROM TBBADDED001M A1
                                  ,(SELECT S1.DPT_SNO
                                          ,S1.DPT_CD
                                          ,S1.DPT_NM
                                      FROM TBDCMACM002M S1
                                     WHERE S1.USE_YN         = 'Y'
                                       AND S1.IMD_CD         = 'Y'
                                       AND S1.ORZT_DVSN_CD   = '20'
                                       --AND S1.DPT_CD NOT IN ('100000','150000')
                                     ORDER BY S1.DPT_SNO
                                   ) B
                                   , TBBADDED003M C
                             WHERE 1=1
                               AND SUBSTR(A1.MNG_DPT_CD, 1, 3) || '000' = B.DPT_CD(+)
                               AND SUBSTR(A1.AUD_KND_CD,3,1) <> '5' --확인출장제외
                               AND A1.AUD_YR = C.AUD_YR
                               AND A1.AUD_NO = C.AUD_NO
                               AND NVL(A1.SEC_AUD_YN, 'N') <> 'Y'
                               AND C.AUD_END_RSN IS NULL
                           ),
             BSRP_INFO AS (/* 출장정보BB : BSRP_INFO */
                            SELECT B2.REL_AUD_YR AS AUD_YR
                                  ,B2.REL_AUD_NO AS AUD_NO
                                  ,MIN(B2.AUD_STR_DT00) AS AUD_STR_DT00 --자료수집 시작일
                                  ,MAX(B2.AUD_END_DT00) AS AUD_END_DT00 --자료수집 종료일
                                  ,SUM(B2.AUD_DCN00)    AS AUD_DCN00    --자료수집 출장일수
                                  ,MIN(B2.AUD_STR_DT01) AS AUD_STR_DT01 --예비조사 시작일
                                  ,MAX(B2.AUD_END_DT01) AS AUD_END_DT01 --예비조사 종료일
                                  ,SUM(B2.AUD_DCN01)    AS AUD_DCN01    --예비조사 출장일수
                                  ,MIN(B2.AUD_STR_DT02) AS AUD_STR_DT02 --실지감사 시작일
                                  ,MAX(B2.AUD_END_DT02) AS AUD_END_DT02 --실지감사 종료일
                                  ,SUM(B2.AUD_DCN02)    AS AUD_DCN02    --실지감사 출장일수
                                  ,MIN(B2.AUD_STR_DT03) AS AUD_STR_DT03 --실지감사연장 시작일
                                  ,MAX(B2.AUD_END_DT03) AS AUD_END_DT03 --실지감사연장 종료일
                                  ,SUM(B2.AUD_DCN03)    AS AUD_DCN03    --실지감사연장 출장일수
                                  ,DECODE(MAX(B2.AUD_END_DT03),NULL,MAX(B2.AUD_END_DT02)+1,MAX(B2.AUD_END_DT03)+1) AS RETURN_DT  --귀청일
                                  ,(SELECT SUM((NVL(TRUNC((TO_DATE(TO_CHAR(TO_DATE(B3.AUD_END_DT), 'YYYYMMDD'))- TO_DATE(TO_CHAR(TO_DATE(B3.AUD_STR_DT) , 'YYYYMMDD'))) +1,0),0)))
                                      FROM TBBADDED002M B3
                                     WHERE B3.REL_AUD_YR = B2.REL_AUD_YR
                                       AND B3.REL_AUD_NO = B2.REL_AUD_NO
                                       AND B3.AUD_BZT_KND_CD IN ('02','03')) AS AUD_BSRP_SUM
                              FROM (SELECT B1.REL_AUD_YR,B1.REL_AUD_NO
                                          ,DECODE(B1.AUD_BZT_KND_CD,'00',TO_DATE(AUD_STR_DT)) AS AUD_STR_DT00
                                          ,DECODE(B1.AUD_BZT_KND_CD,'00',TO_DATE(AUD_END_DT)) AS AUD_END_DT00
                                          ,DECODE(B1.AUD_BZT_KND_CD,'00',AUD_DCN            ) AS AUD_DCN00
                                          ,DECODE(B1.AUD_BZT_KND_CD,'01',TO_DATE(AUD_STR_DT)) AS AUD_STR_DT01
                                          ,DECODE(B1.AUD_BZT_KND_CD,'01',TO_DATE(AUD_END_DT)) AS AUD_END_DT01
                                          ,DECODE(B1.AUD_BZT_KND_CD,'01',AUD_DCN            ) AS AUD_DCN01
                                          ,DECODE(B1.AUD_BZT_KND_CD,'02',TO_DATE(AUD_STR_DT)) AS AUD_STR_DT02
                                          ,DECODE(B1.AUD_BZT_KND_CD,'02',TO_DATE(AUD_END_DT)) AS AUD_END_DT02
                                          ,DECODE(B1.AUD_BZT_KND_CD,'02',AUD_DCN            ) AS AUD_DCN02
                                          ,DECODE(B1.AUD_BZT_KND_CD,'03',TO_DATE(AUD_STR_DT)) AS AUD_STR_DT03
                                          ,DECODE(B1.AUD_BZT_KND_CD,'03',TO_DATE(AUD_END_DT)) AS AUD_END_DT03
                                          ,DECODE(B1.AUD_BZT_KND_CD,'03',AUD_DCN            ) AS AUD_DCN03
                                      FROM TBBADDED002M B1
                                               INNER JOIN TBBADDED001M B2
                                                          ON B1.REL_AUD_YR = B2.AUD_YR
                                                         AND B1.REL_AUD_NO = B2.AUD_NO
                                     WHERE 1=1
                                         AND B2.AUD_KND_CD NOT LIKE '5%'
                                   ) B2
                             GROUP BY B2.REL_AUD_YR,B2.REL_AUD_NO
                            ),
             AUD_RPRT_APV_INFO AS (/* 감사보고서(위원) 결재정보DD : AUD_RPRT_APV_INFO */
                                   SELECT D3.AUD_YR
                                         ,D3.AUD_NO
                                         ,D3.AUD_RPRT_DVSN_CD      AS AUD_RPRT_DVSN_CD
                                         ,D3.DOC_ID                AS DOC_ID
                                         ,MIN(D3.GWA_APV)          AS GWA_APV
                                         ,MIN(D3.GUK_APP)          AS GUK_APP
                                         ,MIN(D3.GUK_APV)          AS GUK_APV
                                         ,MIN(D3.CHA_APP)          AS CHA_APP
                                         ,MIN(D3.CHA_APV)          AS CHA_APV
                                         ,MIN(D3.CHONG_APP)        AS CHONG_APP
                                         ,MIN(D3.CHONG_APV)        AS CHONG_APV
                                         ,MAX(D3.FNL_APV)          AS FNL_APV
                                         ,MIN(D3.WI_APP)           AS WI_APP
                                         ,MIN(D3.WI_APV)           AS WI_APV
                                         ,MAX(D3.SYT_TRTM_DVSN_YN) AS SYT_TRTM_DVSN_YN
                                         ,MAX(D3.USE_YN)           AS USE_YN
                                         ,MAX(D3.AUD_RPRT_STA_CD)  AS AUD_RPRT_STA_CD
                                         ,MAX(D3.WI_RPRT_STA_CD)   AS WI_RPRT_STA_CD
                                         ,'SBCN'                AS SBCN_GUBN
                                     FROM (
                                           SELECT D1.AUD_YR
                                                 ,D1.AUD_NO
                                                 ,D1.AUD_RPRT_DVSN_CD
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' THEN D1.DOC_ID
                                                       ELSE D1.REF_ID
                                                        END AS DOC_ID
                                                ,CASE WHEN D1.RPRT_CD = 'A10600200' AND (D2.APVR_PST_CD = '0013600' OR D2.APVR_PST_CD = '0057400' OR D2.APVR_PST_CD = '0035400') AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
			                                               ELSE NULL
			                                                END AS GWA_APV   --과장결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0015800' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0035100' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0058100' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       ELSE NULL
                                                        END AS GUK_APP   --국단실장접수일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0015800' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0035100' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0058100' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS GUK_APV   --국단실장결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055600' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0045900' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       ELSE NULL
                                                        END AS CHA_APP   --차장,본부장 접수일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055600' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0045900' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS CHA_APV   --차장,본부장 결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055700' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       ELSE NULL
                                                        END AS CHONG_APP --사무총장접수일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055700' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS CHONG_APV --사무총장결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D1.APV_STA_CD = '30' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS FNL_APV   --최종결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10700100' AND D2.APVR_PST_CD = '0010600' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ,D2.APV_DH DESC)
                                                       ELSE NULL
                                                        END AS WI_APP    --주심위원접수일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10700100' AND D2.APVR_PST_CD = '0010600' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS WI_APV    --주심위원결재일
                                                 ,D1.SYT_TRTM_DVSN_YN
                                                 ,D1.USE_YN
                                                 ,DECODE(D1.RPRT_CD,'A10600200',D1.APV_STA_CD ) AS AUD_RPRT_STA_CD
                                                 ,DECODE(D1.RPRT_CD,'A10700100',D1.APV_STA_CD ) AS WI_RPRT_STA_CD
                                             FROM TBBADDED103M D1
                                                 ,(SELECT A.SEQ
                                                              ,A.APV_DOC_NO
                                                              ,A.APVR_PST_CD
                                                              ,A.APVR_KND_CD
                                                              ,A.APVR_STA_CD
                                                              ,A.APV_DH
                                                              ,A.APV_DVSN_CD
                                                              ,A.APVR_CNB
                                                          FROM TBDCMACM023H A
                                                        UNION ALL
                                                        SELECT 9999999999 AS SEQ
                                                              ,B.APV_DOC_NO
                                                              ,B.APVR_PST_CD
                                                              ,B.APVR_KND_CD
                                                              ,B.APVR_STA_CD
                                                              ,B.APV_DH
                                                              ,B.APV_DVSN_CD
                                                              ,B.APVR_CNB
                                                          FROM TBDCMACM023L B
                                                         WHERE B.APVR_STA_CD IN ('102','103')
                                                           AND NOT EXISTS (SELECT 'X'
                                                                             FROM TBDCMACM023H S
                                                                            WHERE S.APV_DOC_NO  = B.APV_DOC_NO 
                                                                              AND S.APV_DVSN_CD = B.APV_DVSN_CD
                                                                              AND S.APVR_CNB    = B.APVR_CNB   
                                                                      )
                                                         ORDER BY SEQ) D2
                                            WHERE D1.APV_RQS_ID = D2.APV_DOC_NO
                                              AND D1.AUD_RPRT_DVSN_CD IN ('10','20','30') --재부의 제외
                                              AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
                                              AND D2.APVR_KND_CD      IN ('2','3','9')   --공석추가
                                            ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ/*D2.APV_SNO,D2.APVR_SEQ*/
                                           ) D3
                                    GROUP BY D3.AUD_YR,D3.AUD_NO,D3.AUD_RPRT_DVSN_CD,D3.DOC_ID
                                    UNION
                                    SELECT D3.AUD_YR
                                         ,D3.AUD_NO
                                         ,D3.AUD_RPRT_DVSN_CD      AS AUD_RPRT_DVSN_CD
                                         ,D3.DOC_ID                AS DOC_ID
                                         ,MIN(D3.GWA_APV)          AS GWA_APV
                                         ,MIN(D3.GUK_APP)          AS GUK_APP
                                         ,MIN(D3.GUK_APV)          AS GUK_APV
                                         ,MIN(D3.CHA_APP)          AS CHA_APP
                                         ,MIN(D3.CHA_APV)          AS CHA_APV
                                         ,MIN(D3.CHONG_APP)        AS CHONG_APP
                                         ,MIN(D3.CHONG_APV)        AS CHONG_APV
                                         ,MAX(D3.FNL_APV)          AS FNL_APV
                                         ,MIN(D3.WI_APP)           AS WI_APP
                                         ,MIN(D3.WI_APV)           AS WI_APV
                                         ,MAX(D3.SYT_TRTM_DVSN_YN) AS SYT_TRTM_DVSN_YN
                                         ,MAX(D3.USE_YN)           AS USE_YN
                                         ,MAX(D3.AUD_RPRT_STA_CD)  AS AUD_RPRT_STA_CD
                                         ,MAX(D3.WI_RPRT_STA_CD)   AS WI_RPRT_STA_CD
                                         ,'RE_SBCN'                AS SBCN_GUBN
                                     FROM (
                                           SELECT D3.AUD_YR
                                                 ,D3.AUD_NO
                                                 ,NVL(D1.AUD_RPRT_DVSN_CD,'40') AS AUD_RPRT_DVSN_CD
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' THEN D1.DOC_ID
                                                       ELSE D1.REF_ID
                                                        END AS DOC_ID
                                                ,CASE WHEN D1.RPRT_CD = 'A10600200' AND (D2.APVR_PST_CD = '0013600' OR D2.APVR_PST_CD = '0057400' OR D2.APVR_PST_CD = '0035400') AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
			                                               ELSE NULL
			                                                END AS GWA_APV   --과장결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0015800' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0035100' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0058100' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       ELSE NULL
                                                        END AS GUK_APP   --국단실장접수일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0015800' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0035100' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0058100' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS GUK_APV   --국단실장결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055600' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0045900' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       ELSE NULL
                                                        END AS CHA_APP   --차장,본부장 접수일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055600' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0045900' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS CHA_APV   --차장,본부장 결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055700' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ)
                                                       ELSE NULL
                                                        END AS CHONG_APP --사무총장접수일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D2.APVR_PST_CD = '0055700' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS CHONG_APV --사무총장결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10600200' AND D1.APV_STA_CD = '30' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS FNL_APV   --최종결재일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10700100' AND D2.APVR_PST_CD = '0010600' THEN LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ,D2.APV_DH DESC)
                                                       ELSE NULL
                                                        END AS WI_APP    --주심위원접수일
                                                 ,CASE WHEN D1.RPRT_CD = 'A10700100' AND D2.APVR_PST_CD = '0010600' AND D2.APVR_STA_CD <> '401' THEN D2.APV_DH
                                                       ELSE NULL
                                                        END AS WI_APV    --주심위원결재일
                                                 ,D1.SYT_TRTM_DVSN_YN
                                                 ,D1.USE_YN
                                                 ,DECODE(D1.RPRT_CD,'A10600200',D1.APV_STA_CD ) AS AUD_RPRT_STA_CD
                                                 ,DECODE(D1.RPRT_CD,'A10700100',D1.APV_STA_CD ) AS WI_RPRT_STA_CD
                                                 ,D3.REFER_DVSN_D10
                                                 ,D3.REFER_DVSN_E10
                                                 ,D3.SBCN_DY
                                                 ,D3.RE_SBCN_DY
                                                 ,D3.RE_WI_APV
                                                 ,D3.RE_DOC_ID
                                                 ,D3.RE_SBCN_CNT
                                             FROM (SELECT 
                                                T1.AUD_YR
                                                , T1.AUD_NO
                                                , T1.DOC_ID AS DOC_ID
                                                , T2.DOC_ID AS RE_DOC_ID
                                                , SUM(CASE WHEN T3.REFER_DVSN_CD = 'D10' THEN 1 ELSE 0 END) AS REFER_DVSN_D10   --부의
                                                , SUM(CASE WHEN T3.REFER_DVSN_CD = 'E10' THEN 1 ELSE 0 END) AS REFER_DVSN_E10   --위임
                                                , MIN(T1.SBCN_DY) AS SBCN_DY
                                                , MIN(T4.SBCN_DY) AS RE_SBCN_DY
                                                , MAX(T5.APV_STA_CD)
                                                , MIN(T6.APV_DH) AS RE_WI_APV      -- 재부의 주심위원설명자료 결재일자
                                                , COUNT(DISTINCT T4.DSP_RQ_SNO) AS RE_SBCN_CNT
                                               FROM TBBADDED113M T1 -- 원 부의
                                                       LEFT OUTER JOIN TBBADDED146M T2 -- 재부의 처분요구
                                                       ON (T1.AUD_YR = T2.AUD_YR AND T1.AUD_NO = T2.AUD_NO
                                                       AND T1.DOC_ID = T2.HD_DOC_ID AND T2.HD_APVR_CD = 'A107001'
                                                           AND T1.AFF_SNO = T2.HD_AFF_SNO AND T1.DSP_RQ_SNO = T2.HD_DSP_RQ_SNO)
                                                       LEFT OUTER JOIN TBBADDED145M T3 -- 재부의 사건
                                                       ON (T2.AUD_YR = T3.AUD_YR AND T2.AUD_NO = T3.AUD_NO
                                                           AND T2.AUD_STEP_CD = T3.AUD_STEP_CD AND T2.DOC_ID = T3.DOC_ID 
                                                           AND T2.APVR_CD = T3.APVR_CD AND T2.AFF_SNO = T3.AFF_SNO)
                                                       LEFT OUTER JOIN TBBADDED113M T4 -- 재부의 부의
                                                       ON (T2.AUD_YR = T4.AUD_YR AND T2.AUD_NO = T4.AUD_NO
                                                           AND T2.DOC_ID = T4.DOC_ID 
                                                           AND T4.APVR_CD = '0010600' )
                                                       LEFT OUTER JOIN TBBADDED103M T5 -- 재부의 주심위원 설명자료
                                                       ON (T5.REF_ID = T4.DOC_ID AND T5.RPRT_CD = 'A10700100')
                                                       LEFT OUTER JOIN TBDCMACM023H T6 -- 재부의 결재정보
                                                       ON (T5.APV_RQS_ID = T6.APV_DOC_NO AND T6.APVR_PST_CD = '0010600')
                                                       LEFT OUTER JOIN TBBADDED146M T7 -- 원 부의 처분요구
                                                       ON (T7.AUD_YR = T1.AUD_YR AND T7.AUD_NO = T1.AUD_NO
                                                           AND T7.DOC_ID = T1.DOC_ID AND T7.APVR_CD = 'A107001' 
                                                           AND T7.AFF_SNO = T1.AFF_SNO AND T7.DSP_RQ_SNO = T1.DSP_RQ_SNO)
                                             WHERE T1.SBCN_VT_CD = '90'
                                                     GROUP BY T1.AUD_YR, T1.AUD_NO, T1.DOC_ID, T2.DOC_ID) D3
                                                 LEFT OUTER JOIN TBBADDED103M D1
                                                 ON (D3.AUD_YR = D1.AUD_YR AND D3.AUD_NO = D1.AUD_NO 
                                                    AND (D3.RE_DOC_ID = D1.DOC_ID OR D3.RE_DOC_ID = D1.REF_ID)
                                                    AND D1.AUD_RPRT_DVSN_CD = '40'
                                                    AND D1.RPRT_CD          IN ('A10600200','A10700100'))
                                                 LEFT OUTER JOIN (SELECT A.SEQ
                                                              ,A.APV_DOC_NO
                                                              ,A.APVR_PST_CD
                                                              ,A.APVR_KND_CD
                                                              ,A.APVR_STA_CD
                                                              ,A.APV_DH
                                                              ,A.APV_DVSN_CD
                                                              ,A.APVR_CNB
                                                          FROM TBDCMACM023H A
                                                        UNION ALL
                                                        SELECT 9999999999 AS SEQ
                                                              ,B.APV_DOC_NO
                                                              ,B.APVR_PST_CD
                                                              ,B.APVR_KND_CD
                                                              ,B.APVR_STA_CD
                                                              ,B.APV_DH
                                                              ,B.APV_DVSN_CD
                                                              ,B.APVR_CNB
                                                          FROM TBDCMACM023L B
                                                         WHERE B.APVR_STA_CD IN ('102','103')
                                                           AND NOT EXISTS (SELECT 'X'
                                                                             FROM TBDCMACM023H S
                                                                            WHERE S.APV_DOC_NO  = B.APV_DOC_NO 
                                                                              AND S.APV_DVSN_CD = B.APV_DVSN_CD
                                                                              AND S.APVR_CNB    = B.APVR_CNB   
                                                                      )
                                                         ORDER BY SEQ) D2
                                                 ON (D1.APV_RQS_ID = D2.APV_DOC_NO AND D2.APVR_KND_CD      IN ('2','3','9'))
                                            WHERE 1=1
                                            ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D1.AUD_RPRT_DVSN_CD,D2.SEQ
                                           ) D3
                                    WHERE (CASE WHEN D3.REFER_DVSN_D10 =  0 THEN NVL(D3.RE_WI_APV,TO_DATE('99991231'))    --부의건수가 없으면 위원결재일
                                                WHEN D3.REFER_DVSN_D10 <> 0 THEN TO_DATE(NVL(D3.RE_SBCN_DY,'99991231'))   --부의건수가 있으면 부의일
                                                ELSE TO_DATE('99991231')
                                                END) > SYSDATE
                                    GROUP BY D3.AUD_YR,D3.AUD_NO,D3.AUD_RPRT_DVSN_CD,D3.DOC_ID, D3.RE_DOC_ID
                                    
                                   ),
             CHF_CMTR_INFO AS (/* 주심위원FF : CHF_CMTR_INFO */
                                SELECT A.AUD_YR
                                      ,A.AUD_NO
                                      ,A.DOC_ID
                                      ,F_USR_INFO(A.CHF_CMTR_CNB,'2') AS CHF_CMTR_NM
                                      ,B.RAL_BLT_DIV_CD -- 실소속 부서코드
                                  FROM TBBADDED116L A
                                       INNER JOIN TBDCMACM001M B
                                       ON (A.CHF_CMTR_CNB = B.CNB)
                                 WHERE 1=1
                                   AND A.TASK_DVSN_CD = '9'
                                   AND B.DPT_CD <> '880880'
                                   AND A.SRNO = (SELECT MAX(C.SRNO) FROM TBBADDED116L C
                                                  WHERE C.AUD_YR = A.AUD_YR
                                                    AND C.AUD_NO = A.AUD_NO
                                                    AND C.DOC_ID = A.DOC_ID
                               AND      (A.CHF_CMTR_CNB = #{chfCmtrCnb}
                               OR A.CHF_CMTR1_CNB = #{chfCmtrCnb}
                               OR A.CHF_CMTR2_CNB = #{chfCmtrCnb}
                               OR A.CHF_CMTR3_CNB = #{chfCmtrCnb}
                               OR A.CHF_CMTR4_CNB = #{chfCmtrCnb}
                               OR A.CHF_CMTR5_CNB = #{chfCmtrCnb})
                                                )
                              ),
             AFF_CNT_INFO AS (/* 사건정보GG : AFF_CNT_INFO */
                              SELECT A.AUD_YR
                                    ,A.AUD_NO
                                    ,A.DOC_ID
                                    ,SUM(CASE WHEN A.FNL_YN= 'Y' AND A.REFER_DVSN_CD = 'D10' THEN 1 ELSE 0 END) AS REFER_DVSN_D10   --부의
                                    ,SUM(CASE WHEN A.FNL_YN= 'Y' AND A.REFER_DVSN_CD = 'E10' THEN 1 ELSE 0 END) AS REFER_DVSN_E10   --위임
                                    ,MIN(C.SBCN_DY) AS SBCN_DY  --최초부의일
                                    ,MIN(E.ENF_DT)  AS ENF_DT   --최초시행일
                                FROM TBBADDED145M A
                                    ,TBBADDED146M B
                                    ,TBBADDED113M C
                                    ,(SELECT A7.AUD_YR
                                            ,A7.AUD_NO
                                            ,'A1070' AS APVR_CD
                                            ,A7.AUD_DSP_RQ_SNO
                                            ,A3.ENF_DT
                                        FROM TBBADEAR001M A7
                                            ,TBBADEAR002D A3
                                       WHERE A7.AUD_YR      = A3.AUD_YR
                                         AND A7.AUD_NO      = A3.AUD_NO
                                         AND A7.DSP_RQ_SNO  = A3.DSP_RQ_SNO
                                     ) E
                               WHERE 1=1
                                 AND A.AUD_YR      = B.AUD_YR
                                 AND A.AUD_NO      = B.AUD_NO
                                 AND A.AUD_STEP_CD = B.AUD_STEP_CD
                                 AND A.DOC_ID      = B.DOC_ID
                                 AND A.APVR_CD     = B.APVR_CD
                                 AND A.AFF_SNO     = B.AFF_SNO
                                 AND B.DSP_RQ_CD NOT IN ('390','391','395','396','490','495','730')
                                 AND B.AUD_YR      = C.AUD_YR(+)
                                 AND B.AUD_NO      = C.AUD_NO(+)
                                 AND B.DOC_ID      = C.DOC_ID(+)
                                 AND B.APVR_CD     = C.APVR_CD(+)
                                 AND B.AFF_SNO     = C.AFF_SNO(+)
                                 AND B.DSP_RQ_SNO  = C.DSP_RQ_SNO(+)
                                 AND B.AUD_YR      = E.AUD_YR(+)
                                 AND B.AUD_NO      = E.AUD_NO(+)
                                 AND B.APVR_CD     = E.APVR_CD(+)
                                 AND B.DSP_RQ_SNO  = E.AUD_DSP_RQ_SNO(+)
                               GROUP BY A.AUD_YR,A.AUD_NO,A.DOC_ID
                               ORDER BY A.AUD_YR,A.AUD_NO,A.DOC_ID
                             )
        /***************************** 주심위원별 처리상황 ***********************************/
        
        SELECT AA.AUD_YR
			 , AA.AUD_NO
             , FF.CHF_CMTR_NM
             , AA.AUD_DPT_NM AS SPV_BRDV_NM
            , AA.AUD_YR_NO AS CLASSIFY_NO
            , AA.AUD_SBJ_NM||'(' ||AUD_KND_NM|| DECODE(AUD_KND_CD2,NULL, '' ,'/'||F_CODE_NM('1000742',AUD_KND_CD2))||DECODE(DD.AUD_RPRT_DVSN_CD,'10', '' ,'/'||F_CODE_NM('1000788', DD.AUD_RPRT_DVSN_CD))||   ')' AS AUD_SBJ_NM
           , CHR(39) || NVL(TO_CHAR(DECODE(BB.AUD_END_DT03,NULL,BB.AUD_END_DT02+1,BB.AUD_END_DT03+1),'YY. MM. DD') ,'서면감사'||CHR(39)) AS RTN_DT
           , CASE WHEN DD.WI_APP IS NOT NULL THEN CHR(39) ||TO_CHAR(DD.WI_APP,'YY. MM. DD')  ELSE '접수전'  END AS WI_APP
            , DECODE(GG.REFER_DVSN_D10, 0, '위임',GG.REFER_DVSN_D10||'건') AS TRTM_SBCN_NOC
            , (SELECT DECODE(MIN(ST1.SBCN_DY),NULL,'미 정',CHR(39) || TO_CHAR(TO_DATE(MIN(ST1.SBCN_DY)),'YY. MM. DD')) 
                 FROM TBBADDED113M ST1
                WHERE ST1.AUD_YR = AA.AUD_YR 
                  AND ST1.AUD_NO = AA.AUD_NO
                  AND ST1.DOC_ID = GG.DOC_ID) AS SBCN_DT
            , (SELECT DECODE(COUNT(1),0,'N','Y')
                FROM TBBADDED120M T1
                     INNER JOIN TBBADDED113M T2
                     ON (T1.CMT_DY = T2.SBCN_DY)
               WHERE T1.CMT_DVSN_CD = '10'
                 AND T1.CMT_END_YN = 'N'
                 AND T1.CMT_SQ = (SELECT MIN(CMT_SQ)
                                    FROM TBBADDED120M T1
                                   WHERE T1.CMT_DVSN_CD = '10'
                                     AND T1.CMT_END_YN = 'N') -- 차회 부의 회차
                 AND T2.AUD_YR = DD.AUD_YR
                 AND T2.AUD_NO = DD.AUD_NO
                 AND T2.DOC_ID = DD.DOC_ID) AS NEXT_SBCN_YN
            , F_CODE_NM('1000788', DD.AUD_RPRT_DVSN_CD) AS AUD_RPRT_DVSN_NM
          FROM BASIS_INFO        AA --기본정보AA
              ,BSRP_INFO         BB --출장정보BB
              ,AUD_RPRT_APV_INFO DD --감사보고서(위원) 결재정보DD
              ,CHF_CMTR_INFO     FF --주심위원FF
              ,AFF_CNT_INFO      GG --사건수GG
         WHERE AA.AUD_YR = BB.AUD_YR(+) AND AA.AUD_NO = BB.AUD_NO(+)
           AND AA.AUD_YR = DD.AUD_YR(+) AND AA.AUD_NO = DD.AUD_NO(+)
           AND DD.AUD_YR = FF.AUD_YR(+) AND DD.AUD_NO = FF.AUD_NO(+) AND DD.DOC_ID = FF.DOC_ID(+)
           AND DD.AUD_YR = GG.AUD_YR(+) AND DD.AUD_NO = GG.AUD_NO(+) AND DD.DOC_ID = GG.DOC_ID(+)
           AND (BB.AUD_STR_DT02 IS NOT NULL OR (BB.AUD_STR_DT02 IS NULL AND SUBSTR(AA.AUD_KND_CD, 3, 1)  = '9'  ))    --실지감사 출장정보가 있는 감사(서면감사이면서 출장정보가 없고 종료보고서가 없을때 추가 2018.05.25 CJLEE)
           AND (CASE WHEN GG.REFER_DVSN_D10 =  0 THEN NVL(DD.WI_APV,TO_DATE('99991231'))    -- 부의건수가 없으면 위원결재일
                     WHEN GG.REFER_DVSN_D10 <> 0 THEN TO_DATE(NVL(GG.SBCN_DY,'99991231'))   -- 부의건수가 있으면 부의일
                     WHEN DD.SBCN_GUBN = 'RE_SBCN' THEN TO_DATE('99991231')                 -- 재부의는 AUD_RPRT_APV_INFO에 조건 포함
                     ELSE TO_DATE('99991231')
                      END) > SYSDATE
           AND NVL(DD.USE_YN,'Y') <> 'N'
           AND (DD.DOC_ID IS NOT NULL 
                OR (DD.DOC_ID IS NULL AND AA.AUD_EXEC_HNDL_STA_CD != '9')) -- 감사보고서가 있을경우 감사보고서의 USE_YN, 없을경우 감사사항의 종료여부
           --AND AA.DPT_SNO NOT IN ('530','640') --국방,첨단,감찰 제외
           AND AA.AUD_EXEC_HNDL_STA_CD <> '9'
            AND (TO_DATE(DECODE(BB.AUD_END_DT03,NULL,BB.AUD_END_DT02,BB.AUD_END_DT03)) < NEXT_DAY(NEXT_DAY(SYSDATE,'2'),'4') 
                OR (BB.AUD_STR_DT02 IS NULL 
                    AND BB.AUD_END_DT03 IS NULL
                    AND SUBSTR(AA.AUD_KND_CD, 3, 1)  = '9'  )
           )-- 조회일기준 다음주 수요일 이전 귀청건만 조회
       --    AND DD.WI_APP IS NOT NULL    -- 위원접수건만 조회
            AND FF.CHF_CMTR_NM IS NOT NULL
         ORDER BY DD.WI_APP, FF.RAL_BLT_DIV_CD, AA.DPT_SNO, AA.R_DPT_SNO
	]]>
	</select>

	<!-- 감사부서목록을 조회한다. -->
	<select id="dashBoardAudDptListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardAudDptListSelect*/
		SELECT   A.DPT_CD
			   , A.DPT_NM
			   , A.DPT_SNO
		  FROM TBDCMACM002M A /* 부서 */
		 WHERE A.USE_YN = 'Y'
		   AND A.IMD_CD = 'Y'
		   AND A.ORZT_DVSN_CD = '20'
		   AND A.DPT_TP_CD_2 = 'A' /*부서구분(감사) : 실제 감사 수행여부에 따른 구분, 운영지원과는 운영부서*/
		 ORDER BY DPT_SNO
	]]>
	</select>

	<!-- 연도목록 -->
	<select id="dashBoardYearListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardYearListSelect*/
		SELECT TO_CHAR(TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY'))-1) AS "YEAR"
		  FROM DUAL
		UNION ALL
		SELECT TO_CHAR(SYSDATE, 'YYYY') AS "YEAR"
		  FROM DUAL
	]]>
	</select>

	<!-- 감사종류별 감사 처리기간 -->
	<select id="dashBoardAudHndlPrdListSelect" parameterType="paramMap" resultType="egovMap">
    /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardAudHndlPrdListSelect*/
     <![CDATA[
    SELECT  DECODE(X.DPT_CD, NULL, '0', X.DPT_CD) AS DPT_CD
             , DECODE(X.DPT_CD, NULL, '원평균', X.DPT_NM) AS DPT_NM
             , X.DPT_SNO
             , ${resultCdList.size}  AS AUD_KND_SIZE
             ]]>
             <foreach collection="resultCdList"   item="items"  index="index"  >
             , SUM(X.VAL_SUM_${items.CD}) AS VAL_${index}
             </foreach>
      <![CDATA[
     FROM(
          SELECT  F_DPT_INFO(D.DPT_CD, 1) AS DPT_NM
                  , D.DPT_CD AS DPT_CD
                  , D.DPT_SNO
                  ]]>
                   <foreach collection="resultCdList"   item="items"  index="index"  >
                  , FLOOR(SUM(CASE WHEN D.AUD_KND_${items.CD}_CD = ${items.CD} THEN TO_DATE(D.ENF_APV_DT,'YYYYMMDD') - TO_DATE(D.RSV_INSPC_LUNH_DT,'YYYYMMDD') ELSE 0 END)/(CASE WHEN SUM(CASE WHEN D.AUD_KND_${items.CD}_CD = ${items.CD} THEN 1 ELSE 0 END) = 0 THEN 1 ELSE SUM(CASE WHEN D.AUD_KND_${items.CD}_CD = ${items.CD} THEN 1 ELSE 0 END) END)) AS VAL_SUM_${items.CD}
                  </foreach>
             <![CDATA[
          FROM (
                SELECT T2.AUD_YR
                      ,T2.AUD_NO
                      ,T2.AUD_KND_CD
                      ,T1.DPT_CD
                      ,T2.HIRK_MNG_DPT_CD AS MNG_DPT_CD
                      ,T2.ENF_APV_DT
                      ,T2.RSV_INSPC_LUNH_DT
                      ,T1.DPT_SNO
                FROM TBDCMACM002M T1
                     LEFT OUTER JOIN (SELECT   A.AUD_YR
                               , A.AUD_NO
                               , A.AUD_KND_CD
                               , A.MNG_DPT_CD
                                             , SUBSTR(A.MNG_DPT_CD, 1, 3) || '000' AS HIRK_MNG_DPT_CD
                               , B.ENF_APV_DT     /* 시행결재일 - 시행 */
                               , B.RSV_INSPC_LUNH_DT  /* 예비조사착수일 */
                            FROM TBBADDED001M A
                                 INNER JOIN TBBADDED003M B
                                         ON A.AUD_YR = B.AUD_YR
                                        AND A.AUD_NO = B.AUD_NO
                                       WHERE A.PRSS_STEP_CD IN ('10','A1080', 'A1090') /* 종료 */
                            AND A.AUD_YR =  #{year}) T2
                     ON T1.DPT_CD = T2.HIRK_MNG_DPT_CD
        WHERE T1.ORZT_DVSN_CD = '20'
          AND T1.IMD_CD = 'Y'
          AND T1.USE_YN = 'Y'
          AND (T1.DPT_TP_CD = 'A' OR T1.DPT_CD IN ( '0L0000','180000')) 
          )
          PIVOT (MAX(AUD_KND_CD) FOR AUD_KND_CD IN 
          ]]>
          <foreach collection="resultCdList"   item="items"  index="index" open="(" separator=","  close=")" >
                ${items.CD} AS AUD_KND_${items.CD}_CD
           </foreach>
          <![CDATA[
           ) D
          GROUP BY ROLLUP (( D.DPT_CD, D.DPT_SNO))) X
          GROUP BY  ( X.DPT_CD, X.DPT_NM, X.DPT_SNO)
          ORDER BY DPT_CD NULLS FIRST
	]]>
	</select>
	
	
	<select id="dashSelectCode" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashSelectCode*/
	   <![CDATA[
	            SELECT CMM_CD_DVSN_CD
                 , CD
                 , CD_NM
                 , #{year} AS YEAR
                 , SUBSTR(CD, 3, 5) AS EMPTY_CD
              FROM TBDCMACM013C
             WHERE 1=1
               AND CMM_CD_DVSN_CD = '1000739'
               AND SUBSTR(CD,1,2)  LIKE SUBSTR(#{year},3,2)||'%' 
               AND SUBSTR(CD,3,5) NOT IN ('5','9')
             ORDER BY  OTPT_SEQ
         ]]>    
	</select>

	<!-- 감사 처분요구 수 -->
	<select id="dashBoardAudDspRqCntListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.audDspRqCntListSelect*/
		SELECT   X.DPT_CD
			   , X.DPT_NM
			   , X.DPT_SNO
			   , NVL(Y.VAL_PSC, 0) AS VAL_PSC
			   , NVL(Y.VAL_PNSH, 0) AS VAL_PNSH
			   , NVL(Y.VAL_NTF_HRA, 0) AS VAL_NTF_HRA
			   , NVL(Y.VAL_CPS, 0) AS VAL_CPS
			   , NVL(Y.VAL_CRCT, 0) AS VAL_CRCT
			   , NVL(Y.VAL_ATNT, 0) AS VAL_ATNT
			   , NVL(Y.VAL_NTF, 0) AS VAL_NTF
		  FROM (
		  		SELECT   A.DPT_CD
					   , A.DPT_NM
					   , A.DPT_SNO
				  FROM TBDCMACM002M A /* 부서 */
				 WHERE A.USE_YN = 'Y'
				   AND A.IMD_CD = 'Y'
				   AND A.ORZT_DVSN_CD = '20'
				   AND ( A.DPT_TP_CD = 'A' OR A.DPT_CD IN ( '0L0000','180000') ) /* 민원조사단, 공공감사운영단 구분 불가로 예외처리 */
		  	   ) X
		  	   , (
				SELECT   B.DPT_CD
					   , B.VAL_PSC 			/* 고발 */
					   , B.VAL_PNSH 		/* 징계문책 */
					   , B.VAL_NTF_HRA 		/* 통보(인사) */
					   , B.VAL_CPS 			/* 변상 */
					   , B.VAL_CRCT 		/* 시정 */
					   , B.VAL_ATNT 		/* 주의 */
					   , B.VAL_NTF 			/* 통보 등 */
				  FROM (
						SELECT   SUBSTR(D.MNG_DPT_CD, 1, 3) || '000' AS DPT_CD
							   , SUM( CASE WHEN D.DSP_RQ_KND_CD IN ('710', '720', '730') THEN 1 ELSE 0 END ) AS VAL_PSC 			/* 고발 */
							   , SUM( CASE WHEN D.DSP_RQ_KND_CD IN ('210') THEN 1 ELSE 0 END ) AS VAL_PNSH 							/* 징계문책 */
							   , SUM( CASE WHEN D.DSP_RQ_KND_CD IN ('620') THEN 1 ELSE 0 END ) AS VAL_NTF_HRA 							/* 통보(인사) */
							   , SUM( CASE WHEN D.DSP_RQ_KND_CD IN ('110') THEN 1 ELSE 0 END ) AS VAL_CPS 							/* 변상 */
							   , SUM( CASE WHEN D.DSP_RQ_KND_CD IN ('310', '320', '390', '391', '395', '396') THEN 1 ELSE 0 END ) AS VAL_CRCT 	/* 시정 */
							   , SUM( CASE WHEN D.DSP_RQ_KND_CD IN ('410', '490', '495') THEN 1 ELSE 0 END ) AS VAL_ATNT 					/* 주의 */
							   , SUM( CASE WHEN D.DSP_RQ_KND_CD IN ('610', '621') THEN 1 ELSE 0 END ) AS VAL_NTF 					/* 통보 등 */
						  FROM (
								/* AS-IS */
								SELECT   A.AUD_YR
									   , A.AUD_NO
									   , A.MNG_DPT_CD
									   , C.DSP_RQ_KND_CD
								  FROM   TBBADDED001M A
								  	   , TBBADDED003M B
								  	   , TBBADEAR001M C
								 WHERE A.AUD_YR = B.AUD_YR
								   AND A.AUD_NO = B.AUD_NO
								   AND A.AUD_YR = C.AUD_YR
								   AND A.AUD_NO = C.AUD_NO
								   AND SUBSTR(A.AUD_KND_CD,3) IN ( '1', '2', '3', '4' )
								   AND A.AUD_YR = #{year}
								   --AND B.AUD_EXEC_HNDL_STA_CD = '9' /* 완료 */
								   AND A.PRSS_STEP_CD IN ('10','A1080','A1090') /* 종료, 시행 */
							   ) D
						 GROUP BY SUBSTR(D.MNG_DPT_CD, 1, 3) || '000'
					   ) B
			   ) Y
		 WHERE X.DPT_CD = Y.DPT_CD(+)
		 ORDER BY DPT_SNO
	]]>
	</select>

	<!-- 과 목록 -->
	<select id="dashBoardDptListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardDptListSelect*/
		SELECT   A.DPT_CD
			   , A.DPT_NM
		  FROM TBDCMACM002M A
		 WHERE A.USE_YN = 'Y'
	]]>
		<if test="(dptCd == null or dptCd neq '0L0000'.toString()) and gubunCd eq '1'">
			AND A.ORZT_DVSN_CD = '30' /* 과 - 민원조사과 제외*/
		</if>

		<choose>
			<when test="gubunCd != null and gubunCd eq '1'.toString()">
			   AND A.HIRK_DPT_CD = SUBSTR(#{dptCd}, 1, 3) || '000' /* 국전체 */
			</when>
			<otherwise>
			   AND A.DPT_CD IN ( SELECT DPT_CD FROM TABLE(F_AUTH_DEPT(#{cnb}, '', 'Y', #{dptCd})) )	/* 전체과 */
			   AND A.DPT_CD != SUBSTR(#{dptCd}, 1, 3) || '000'     	/* 국제외 */
			</otherwise>
		</choose>
	<![CDATA[
		 ORDER BY SRT_SNO
	]]>
	</select>

	<!-- 국과 감사진행현황 -->
	<select id="dashBoardAudPrssSituListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardAudPrssSituListSelect*/
		SELECT   D.AUD_YR
			   , D.AUD_NO
			   , D.AUD_SBJ_NM
			   , D.AUD_KND_CD
			   , D.DPT_CD
			   , D.MNG_DPT_CD
			   , D.SPV_BRDV_CD
			   , '10' AS AUD_RPRT_DVSN_CD	/* 본안으로 셋팅 */
			   , '감사보고서<br/>' || '(' || ( SELECT F_CODE_NM ('1000788', '10') FROM DUAL ) || ')' AS AUD_RPRT_DVSN_NM
			   , (
			   	CASE
			   		WHEN D.PRSS_STEP_CD = '02' /* 출장 */
			   		THEN (
			   				CASE
			   					WHEN D.AUD_BZT_KND_CD = '01' 					THEN 'A1020'	/* 예비조사 */
			   					WHEN D.AUD_BZT_KND_CD IN ( '02', '03', '04' ) 	THEN 'A1040'	/* 감사실시 */
			   					ELSE 'A1010'	/* 자료수집 */
			   				END
			   			 )
			   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NULL 		THEN '081'		/* 차장 */
			   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NOT NULL 	THEN '082'		/* 총장 */
			   		WHEN D.PRSS_STEP_CD IN ('03','11')
			   		THEN 'A1050' /* 감사결과보고 */
			   		ELSE D.PRSS_STEP_CD
			   	END
			   ) AS AUD_STEP_CD
			   , (
			   	CASE
			   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NULL THEN '081'		/* 차장 */
			   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NOT NULL THEN '082'	/* 총장 */
			   		ELSE D.PRSS_STEP_CD
			   	END
			   ) AS PRSS_STEP_CD
--			   , (
--				   	CASE
--				   		WHEN D.PRSS_STEP_CD IN ('03', '11') AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.RPT_DDLN_DT)) > 0	/* 실지감사종료보고 */
--				   		THEN 'R'
--				   		WHEN D.PRSS_STEP_CD = '04' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.BRDV_HNDL_DDLN_DT)) > 0		/* 과장 */
--				   		THEN 'R'
--				   		WHEN D.PRSS_STEP_CD = '05' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.MDT_CHGR_APV_DDLN_DT)) > 0	/* 조장담당자1 - 품질 */
--				   		THEN 'R'
--				   		WHEN D.PRSS_STEP_CD = '06' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.MDT_OFER_APV_DDLN_DT)) > 0	/* 조장담당자2 - 품질 */
--				   		THEN 'R'
--				   		WHEN D.PRSS_STEP_CD = '07' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.RVW_RM_APV_DDLN_DT)) > 0		/* 국장 */
--				   		THEN 'R'
--				   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.TOT_DHD_APV_DDLN_DT)) > 0			/* 차장 */
--				   		THEN 'R'
--				   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NOT NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.TOT_DHD_APV_DDLN_DT)) > 0		/* 총장 */
--				   		THEN 'R'
--				   		WHEN D.PRSS_STEP_CD = '09' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.CHF_CMTR_APV_DDLN_DT)) > 0		/* 주심위원 */
--				   		THEN 'R'
--				   		ELSE 'G'
--				   	 END
--			   ) AS DELAY_GUBUN /* G: 지연없음, R: 지연 */
               , CASE
               		 WHEN TOT_DHD_DVS_CD IS NOT NULL
                     THEN
					   	CASE
					   		WHEN D.PRSS_STEP_CD IN ('03', '11') AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.RPT_DDLN_DT)) > 0	/* 실지감사종료보고 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '04' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.BRDV_HNDL_DDLN_DT)) > 0		/* 과장 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '05' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.MDT_CHGR_APV_DDLN_DT)) > 0	/* 조장담당자1 - 품질 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '06' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.MDT_OFER_APV_DDLN_DT)) > 0	/* 조장담당자2 - 품질 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '07' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.RVW_RM_APV_DDLN_DT)) > 0		/* 국장 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.DHD_APV_DDLN_DT)) > 0			/* 차장	2019.04.18 LSR 수정 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NOT NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.PSD_APV_DDLN_DT)) > 0		/* 총장 2019.04.18 LSR 수정 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '09' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.CHF_CMTR_APV_DDLN_DT)) > 0		/* 주심위원 */
					   		THEN 'R'
					   		ELSE 'G'
					   	 END
                     ELSE               
					   	CASE
					   		WHEN D.PRSS_STEP_CD IN ('03', '11') AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.RPT_DDLN_DT)) > 0	/* 실지감사종료보고 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '04' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.BRDV_HNDL_DDLN_DT)) > 0		/* 과장 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '05' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.MDT_CHGR_APV_DDLN_DT)) > 0	/* 조장담당자1 - 품질 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '06' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.MDT_OFER_APV_DDLN_DT)) > 0	/* 조장담당자2 - 품질 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '07' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.RVW_RM_APV_DDLN_DT)) > 0		/* 국장 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.TOT_DHD_APV_DDLN_DT)) > 0			/* 차장 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '08' AND D.OW_DHD_APV_DT IS NOT NULL AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.TOT_DHD_APV_DDLN_DT)) > 0		/* 총장 */
					   		THEN 'R'
					   		WHEN D.PRSS_STEP_CD = '09' AND TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(D.CHF_CMTR_APV_DDLN_DT)) > 0		/* 주심위원 */
					   		THEN 'R'
					   		ELSE 'G'
					   	 END
               END AS DELAY_GUBUN /* G: 지연없음, R: 지연 */
			   ,NVL(TO_CHAR(TO_DATE(D.MTRL_CLC_LUNH_DT, 'YYYYMMDD'), '''YY.MM.DD') , 
			                          (  SELECT  TO_CHAR(TO_DATE(MIN(T2.AUD_STR_DT), 'YYYYMMDD'), '''YY.MM.DD')
			                                       FROM TBBADDED101L T1 
			                                                INNER JOIN TBBADDED002M T2
			                                                           ON T1.REL_AUD_YR = T2.REL_AUD_YR
			                                                         AND T1.REL_AUD_NO = T2.REL_AUD_NO
			                                    WHERE T1.AUD_YR = D.AUD_YR
			                                       AND T1.AUD_NO  = D.AUD_NO) ) AS MTRL_CLC_LUNH_DT		  /* 자료수집착수일 */
			   , DECODE(D.RSV_INSPC_LUNH_DT,DECODE(D.FLD_AUD_STR_DT, NULL, D.FLD_EXTN_STR_DT, D.FLD_AUD_STR_DT),NULL,
                        TO_CHAR(TO_DATE(DECODE(D.RSV_INSPC_LUNH_DT, '29991231',NULL,D.RSV_INSPC_LUNH_DT), 'YYYYMMDD'), '''YY.MM.DD')) AS RSV_INSPC_LUNH_DT     /* 예비조사착수일 */
		       , TO_CHAR(TO_DATE(D.HNDL_DDLN_DT, 'YYYYMMDD'), '''YY.MM.DD') AS HNDL_DDLN_DT           /* 처리기한일 */
			   , TO_CHAR(TO_DATE(DECODE( D.FLD_AUD_STR_DT, NULL, D.FLD_EXTN_STR_DT, D.FLD_AUD_STR_DT), 'YYYYMMDD'), '''YY.MM.DD') AS FLD_EXTN_END_DT 	/* 실지감사 착수일 */
		       , TO_CHAR(TO_DATE(D.RTN_RPT_DT, 'YYYYMMDD'), '''YY.MM.DD') AS RTN_RPT_DT              /* 귀청보고일 - 실지감사종료보고일 */
		       , TO_CHAR(TO_DATE(D.AUD_BRDV_APV_DT, 'YYYYMMDD'), '''YY.MM.DD') AS AUD_BRDV_APV_DT        /* 감사국과결재일 - 과장*/
		       , TO_CHAR(TO_DATE(D.JA_JDG_SSEC_APV_DT, 'YYYYMMDD'), '''YY.MM.DD') AS JA_JDG_SSEC_APV_DT     /* 법무심사관결재일 - 국장 */
		       , TO_CHAR(TO_DATE(D.OW_DHD_APV_DT, 'YYYYMMDD'), '''YY.MM.DD') AS OW_DHD_APV_DT          /* 사무차장결재일 - 차장 */
		       , TO_CHAR(TO_DATE(D.OW_PSD_APV_DT, 'YYYYMMDD'), '''YY.MM.DD') AS OW_PSD_APV_DT          /* 사무총장결재일 - 총장 */
		       , TO_CHAR(TO_DATE(D.CHF_CMTR_APV_DT, 'YYYYMMDD'), '''YY.MM.DD') AS CHF_CMTR_APV_DT        /* 주심위원결재일 */
		       , TO_CHAR(TO_DATE(D.SBCN_DT, 'YYYYMMDD'), '''YY.MM.DD') AS SBCN_DT                /* 부의일 - 감사위원 회의*/
		       , TO_CHAR(TO_DATE(D.ENF_APV_DT, 'YYYYMMDD'), '''YY.MM.DD') AS ENF_APV_DT             /* 시행결재일 - 시행*/
		       , D.TRTM_SBCN_NOC          /* 처리안부의건수 */
		       , D.TRTM_DLG_NOC           /* 처리안위임건수 */
               , D.AUD_EXEC_HNDL_STA_CD
               , D.AUD_EXEC_DT
		  FROM (
				SELECT   A.AUD_YR
					   , A.AUD_NO
					   , A.AUD_KND_CD
					   , '('||F_MNG_KND_AUDYRNO(A.AUD_YR, A.AUD_NO, A.AUD_KND_CD, '-') ||')'||A.AUD_SBJ_NM AS AUD_SBJ_NM
					   , SUBSTR(A.MNG_DPT_CD, 1, 3) || '000' AS DPT_CD
					   , A.MNG_DPT_CD
					   , A.SPV_BRDV_CD
					   , D.AUD_BZT_KND_CD
					   , CASE
                            WHEN A.PRSS_STEP_CD = 'A1010'
                                 OR A.PRSS_STEP_CD = 'A1019'
                                 OR A.PRSS_STEP_CD = 'A1020'
                                 OR A.PRSS_STEP_CD = 'A1030'
                                 OR A.PRSS_STEP_CD = 'A1040' THEN '02'                                      /* 자료수집, 확인출장, 감사실시 */
                            WHEN A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NULL THEN '03'                                         /* 종료보고 */
                            WHEN A.PRSS_STEP_CD = 'A1060' AND B.OW_DHD_APV_DT IS NOT NULL THEN '08'         /* 총장 */
                            WHEN A.PRSS_STEP_CD = 'A1060' AND B.JA_JDG_SSEC_APV_DT IS NOT NULL THEN '08'         /* 차장 */
                            WHEN A.PRSS_STEP_CD = 'A1060' AND B.AUD_BRDV_APV_DT IS NOT NULL THEN '07'    /* 국장 */
                            WHEN A.PRSS_STEP_CD = 'A1060' OR (A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NOT NULL) THEN '04'       /* 과장 */
                            WHEN A.PRSS_STEP_CD = 'A1070' AND B.SBCN_DT IS NULL AND B.CHF_CMTR_APV_DT IS NULL THEN '09'       /* 주심위원 */
                            WHEN A.PRSS_STEP_CD = 'A1070' AND B.CHF_CMTR_APV_DT IS NOT NULL THEN 'A1070'            /* 부의 */
                            ELSE A.PRSS_STEP_CD
                        END AS PRSS_STEP_CD     /* PRSS_STEP_CD 전자감사시스템과 호환되도록 수정 17.01.16 신민준 */
					   , RANK() OVER(PARTITION BY A.AUD_YR, A.AUD_NO ORDER BY C.BZT_YR, C.BZT_SNO ) AS RN	/* 자료수집 착수일을 가져오기 위해 */
					   , C.AUD_STR_DT AS MTRL_CLC_LUNH_DT	/* 자료수집 착수일 */
					   , B.RSV_INSPC_LUNH_DT      /* 예비조사착수일 */
--				       , B.HNDL_DDLN_DT           /* 처리기한일 */
				       , NVL(B.EXTN_HNDL_DDLN_DT, B.HNDL_DDLN_DT) AS HNDL_DDLN_DT           /* 처리기한일 2019.04.05 LSR 수정 */
				       , B.RTN_DT                 /* 귀청일 */
				       , DECODE(B.FLD_AUD_STR_DT,'29991231',NULL,B.FLD_AUD_STR_DT) AS FLD_AUD_STR_DT         /* 실지감사시작일 */
				       , B.FLD_AUD_END_DT         /* 실지감사종료일 */
				       , B.FLD_AUD_EXEC_DCN       /* 실지감사실시일수 */
				       , DECODE(B.FLD_EXTN_STR_DT,'29991231',NULL,B.FLD_EXTN_STR_DT) AS FLD_EXTN_STR_DT        /* 실지연장시작일 */
				       , B.FLD_EXTN_END_DT        /* 실지연장종료일 */
--                       , TO_CHAR(TO_DATE(B.RPT_DDLN_DT) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RPT_DDLN_DT     /* 보고기한일 */
                       , NVL(B.EXTN_RPT_DDLN_DT, B.RPT_DDLN_DT) AS RPT_DDLN_DT	-- 2019.04.05 LSR 수정
				       , B.RTN_RPT_DT             /* 귀청보고일 */
--                       , TO_CHAR(TO_DATE(B.BRDV_HNDL_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS BRDV_HNDL_DDLN_DT     /* 국과처리기한일 - 과장 */
                       , NVL(B.EXTN_BRDV_HNDL_DDLN_DT, B.BRDV_HNDL_DDLN_DT) AS BRDV_HNDL_DDLN_DT	-- 2019.04.05 LSR 수정
				       , B.AUD_BRDV_APV_DT        /* 감사국과결재일 - 과장*/
--                       , TO_CHAR(TO_DATE(B.MDT_CHGR_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS MDT_CHGR_APV_DDLN_DT     /* 조정담당자결재기한일 - 품질 05*/
                       , NVL(B.EXTN_MDT_CHGR_APV_DDLN_DT, B.MDT_CHGR_APV_DDLN_DT) AS MDT_CHGR_APV_DDLN_DT	-- 2019.04.05 LSR 수정
--                       , TO_CHAR(TO_DATE(B.MDT_OFER_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS MDT_OFER_APV_DDLN_DT     /* 조정담당관결재기한일 - 품질 06*/
                       , NVL(B.EXTN_MDT_OFER_APV_DDLN_DT, B.MDT_OFER_APV_DDLN_DT) AS MDT_OFER_APV_DDLN_DT	-- 2019.04.05 LSR 수정
				       , B.MDT_OFER_APV_DT        /* 조정담당관결재일 */
				       , B.MDT_DDG_APV_DT         /* 조정심의관결재일 - 품질 */
--                       , TO_CHAR(TO_DATE(B.RVW_RM_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RVW_RM_APV_DDLN_DT     /* 심의실결재기한일 - 국장 */
                       , NVL(B.EXTN_RVW_RM_APV_DDLN_DT, B.RVW_RM_APV_DDLN_DT) AS RVW_RM_APV_DDLN_DT	-- 2019.04.05 LSR 수정
				       , B.JA_JDG_SSEC_APV_DT     /* 법무심사관결재일 - 국장 */
--                       , TO_CHAR(TO_DATE(B.TOT_DHD_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS TOT_DHD_APV_DDLN_DT     /* 총차장결재기한일 */
                       , NVL(B.EXTN_TOT_DHD_APV_DDLN_DT, B.TOT_DHD_APV_DDLN_DT) AS TOT_DHD_APV_DDLN_DT	-- 2019.04.18 LSR 수정
                       , NVL(B.EXTN_DHD_APV_DDLN_DT, B.DHD_APV_DDLN_DT) AS DHD_APV_DDLN_DT	-- 2019.04.18 LSR 수정
                       , NVL(B.EXTN_PSD_APV_DDLN_DT, B.PSD_APV_DDLN_DT) AS PSD_APV_DDLN_DT	-- 2019.04.18 LSR 수정
				       , B.OW_DHD_APV_DT          /* 사무차장결재일 - 차장 */
				       , B.OW_PSD_APV_DT          /* 사무총장결재일 - 총장 */
--                       , TO_CHAR(TO_DATE(B.CHF_CMTR_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS CHF_CMTR_APV_DDLN_DT     /* 주심위원결재기한일 */
                       , NVL(B.EXTN_CHF_CMTR_APV_DDLN_DT, B.CHF_CMTR_APV_DDLN_DT) AS CHF_CMTR_APV_DDLN_DT	-- 2019.04.05 LSR 수정
				       , B.CHF_CMTR_APV_DT        /* 주심위원결재일 */
				       , B.SBCN_DT                /* 부의일 - 감사위원 회의*/
--                       , TO_CHAR(TO_DATE(B.ENF_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS ENF_APV_DDLN_DT     /* 시행결재기한일 - 시행 */
                       , NVL(B.EXTN_ENF_APV_DDLN_DT, B.ENF_APV_DDLN_DT) AS ENF_APV_DDLN_DT	-- 2019.04.05 LSR 수정
				       , B.ENF_APV_DT AS ENF_APV_DT /* 시행결재일     - 시행*/
				       , B.CHF_CMTR_CNB           /* 주심위원전산번호 */
				       , B.TRTM_SBCN_NOC          /* 처리안부의건수 */
				       , B.AUD_EXEC_HNDL_STA_CD   /* 감사실시처리상태코드 */
				       , B.HNDL_SITU_HIS          /* 처리현황내역 */
				       , B.RTN_RPT_NOC            /* 귀청보고건수 */
				       , B.TRTM_DLG_NOC           /* 처리안위임건수 */
				       , B.CMT_SBCN_NOC           /* 위원회부의건수 */
				       , B.STT_RMK                /* 상황비고 */
				       , B.MDF_YN                 /* 수정여부 */
				       , B.INDC_NOC               /* 지적건수 */
				       , B.GNR_HNDL_PLAN_YN       /* 종합처리방안여부 */
				       , B.EXTN_PRD_COFM_DT       /* 연장기간승인일 */
				       , B.AUD_OW_HNDL_SU_SRNO    /* 감사사무처리부일련번호 */
				       , B.AUD_EXEC_DT /*감사종료 일자*/
					   , B.PSD_APV_DDLN_DT AS TOT_DHD_DVS_CD			-- 총,차장 단계 분리 코드 (2019.04.18 LSR 수정)
				  FROM   TBBADDED001M A	/* 감사사항기본 */
				  	   , TBBADDED003M B	/* 국과별감사처리상황기본 */
				  	   , (
				  	   		SELECT   S.REL_AUD_YR
				  	   			   , S.REL_AUD_NO
				  	   			   , S.BZT_YR
								   , S.BZT_SNO
								   , S.AUD_BZT_KND_CD
								   , S.AUD_STR_DT
				  	   		  FROM TBBADDED002M S /* 출장상황기본 */
				  	   		 WHERE S.AUD_BZT_KND_CD NOT IN ( '01', '02', '03', '04' )	/* 자료수집 */
				  	   ) C
				  	   , (
						SELECT   S.AUD_YR
							   , S.AUD_NO
							   , S.AUD_BZT_KND_CD
						  FROM (
						  	   	SELECT   A.AUD_YR
						  	   		   , A.AUD_NO
						  	   		   , RANK() OVER(PARTITION BY A.AUD_YR, A.AUD_NO ORDER BY B.BZT_YR, B.BZT_SNO DESC) AS RN	/* 자료수집 착수일을 가져오기 위해 */
						  	   		   , B.AUD_BZT_KND_CD
						  	   	  FROM   TBBADDED001M A	/* 감사사항기본 */
						  	   	  	   , TBBADDED002M B /* 출장상황기본 */
						  	   	 WHERE A.AUD_YR = B.REL_AUD_YR
						  	   	   AND A.AUD_NO = B.REL_AUD_NO
						  	   	   AND B.AUD_BZT_KND_CD IN ( '01', '02', '03', '04' ) /* 예비조사, 실지조사 */
							   ) S
						 WHERE S.RN = 1
				  	   ) D
				 WHERE A.AUD_YR = B.AUD_YR(+)
				   AND A.AUD_NO = B.AUD_NO(+)
				   AND A.AUD_YR = C.REL_AUD_YR(+)
				   AND A.AUD_NO = C.REL_AUD_NO(+)
				   AND A.AUD_YR = D.AUD_YR(+)
				   AND A.AUD_NO = D.AUD_NO(+)
				   AND A.PRSS_STEP_CD NOT IN ( 'A1000','A1019') /* 종료, 확인출장이 아닌 것 */
				   /* AND SUBSTRING(A.MNG_DPT_CD, 1, 1) = '0' */
                   AND (A.BZT_BGT_DVSN_CD = '1'	 OR (SUBSTR(A.AUD_KND_CD, 3, 1) = '9')) /* 원배정과 서면 감사인 경우 */
                   AND A.AUD_YR > '2016'    /* 2017년도 감사사항부터 가져오도록 수정 신민준 */
				   AND EXISTS (
				   		SELECT 'X'
				   		  FROM TBDCMACM002M S
				   		 WHERE S.DPT_CD = A.MNG_DPT_CD
				   		   AND S.USE_YN = 'Y'
				   		   AND S.DPT_CD IN (#{dptCd}, (SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{dptCd}))
				   	   )
		  	   ) D
		 WHERE D.RN = 1 ]]>
		 <if test="devYn == 'Y'.toString()  ">
              ORDER BY  D.AUD_NO
         </if>
         <if test="devYn == 'N'.toString() ">
        <![CDATA[
         ORDER BY  D.AUD_EXEC_HNDL_STA_CD, D.AUD_EXEC_HNDL_STA_CD
                   , TO_DATE(NVL(D.FLD_AUD_STR_DT,NVL(D.FLD_EXTN_STR_DT, NVL(D.RTN_RPT_DT,D.ENF_APV_DT))), 'YYYYMMDD') DESC 
                   , TO_DATE(NVL(D.RTN_RPT_DT,D.ENF_APV_DT), 'YYYYMMDD') DESC
          ]]>
          </if>
	</select>

	<!-- 처분요규 종류별 현황 -->
	<select id="dashBoardDspKndSituListSelect" parameterType="paramMap" resultType="egovMap" >
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardDspKndSituListSelect*/
		WITH
		DSP_RQ_DATA AS (
           SELECT A.DSP_RQ_CD AS DSP_RQ_KND_CD
              FROM TBBADDED146M A
             WHERE A.AUD_YR = #{audYr}
               AND A.AUD_NO = #{audNo}
               AND A.AUD_YR > '2016'    /* 2017년도 감사사항부터 가져오도록 수정 신민준 */
               AND A.FNL_YN = 'Y'
		)
		SELECT   X.DSP_RQ_KND_NM
			   , X.NOC
			   , SUM(X.NOC) OVER( ORDER BY X.ORD ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) AS TOT_NOC
		  FROM (
				SELECT   '고발' AS DSP_RQ_KND_NM
					   , NVL(SUM( CASE WHEN A.DSP_RQ_KND_CD IN ('710', '720', '730') THEN 1 ELSE 0 END ), 0) AS NOC 		/* 고발 */
					   , 1 AS ORD
				  FROM DSP_RQ_DATA A
				 UNION ALL
				SELECT   '징계문책' AS DSP_RQ_KND_NM
					   , NVL(SUM( CASE WHEN A.DSP_RQ_KND_CD IN ('210') THEN 1 ELSE 0 END ), 0) AS NOC						/* 징계문책 */
					   , 2 AS ORD
				  FROM DSP_RQ_DATA A
				 UNION ALL
				SELECT   '통보(인사)' AS DSP_RQ_KND_NM
					   , NVL(SUM( CASE WHEN A.DSP_RQ_KND_CD IN ('620') THEN 1 ELSE 0 END ), 0) AS NOC						/* 통보(인사) */
					   , 3 AS ORD
				  FROM DSP_RQ_DATA A
				 UNION ALL
				SELECT   '변상' AS DSP_RQ_KND_NM
					   , NVL(SUM( CASE WHEN A.DSP_RQ_KND_CD IN ('110') THEN 1 ELSE 0 END ), 0) AS NOC						/* 변상 */
					   , 4 AS ORD
				  FROM DSP_RQ_DATA A
				 UNION ALL
				SELECT   '시정' AS DSP_RQ_KND_NM
					   , NVL(SUM( CASE WHEN A.DSP_RQ_KND_CD IN ('310', '320', '390', '391', '395', '396') THEN 1 ELSE 0 END ), 0) AS NOC	/* 시정 */
					   , 5 AS ORD
				  FROM DSP_RQ_DATA A
				 UNION ALL
				SELECT   '주의' AS DSP_RQ_KND_NM
					   , NVL(SUM( CASE WHEN A.DSP_RQ_KND_CD IN ('410', '490', '495') THEN 1 ELSE 0 END ), 0) AS NOC				/* 주의 */
					   , 6 AS ORD
				  FROM DSP_RQ_DATA A
				 UNION ALL
				SELECT   '통보 등' AS DSP_RQ_KND_NM
					   , NVL(SUM( CASE WHEN A.DSP_RQ_KND_CD IN ('610', '621') THEN 1 ELSE 0 END ), 0) AS NOC				/* 통보 등 */
					   , 7 AS ORD
				  FROM DSP_RQ_DATA A
			   ) X
		 ORDER BY X.ORD
	]]>
	</select>

	<!-- 감사보고서 처리기간 -->
	<select id="dashBoardAudRprtHndlPrdListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardAudRprtHndlPrdListSelect*/
		WITH
		DNC_DATA AS (
			SELECT   X.AUD_YR
				   , X.AUD_NO
				   , X.STAD_RPT_DNC
				   , X.STAD_AUD_BRDV_APV_DNC
				   , X.STAD_RVW_RM_APV_DNC
				   , X.STAD_TOT_DHD_APV_DNC
				   , X.STAD_DHD_APV_DNC			-- 2019.04.18 LSR 추가
				   , X.STAD_PSD_APV_DNC			-- 2019.04.18 LSR 추가
				   , X.STAD_CHF_CMTR_APV_DNC
				   , X.STAD_ENF_APV_DNC
				   , Y.RPT_DNC
				   , Y.AUD_BRDV_APV_DNC
				   , Y.RVW_RM_APV_DNC
				   , Y.TOT_DHD_APV_DNC
				   , Y.DHD_APV_DNC				-- 2019.04.18 LSR 추가
				   , Y.PSD_APV_DNC				-- 2019.04.18 LSR 추가
				   , Y.CHF_CMTR_APV_DNC
				   , Y.ENF_APV_DNC
				   , X.PSD_APV_DDLN_DT			-- 2019.04.18 LSR 추가
			  FROM (
					/* 기준일 2019-04-12 LSR 수정 */
					SELECT
						T1.AUD_YR
						, T1.AUD_NO
						, SUM(CASE WHEN  AUD_HNDL_STEP_SNO = 1 THEN DDLN_DCN END) AS STAD_RPT_DNC         /* 귀청 ~ 보고 일수 */
						, SUM(CASE WHEN  AUD_HNDL_STEP_SNO = 2 THEN DDLN_DCN END) AS STAD_AUD_BRDV_APV_DNC  /* 국과처리 일수 */
						, SUM(CASE WHEN  AUD_HNDL_STEP_SNO BETWEEN 3 AND 5 THEN DDLN_DCN END) AS STAD_RVW_RM_APV_DNC    /* 품질~국장 일수 */
						, SUM(CASE WHEN  AUD_HNDL_STEP_SNO BETWEEN 6 AND 7 THEN DDLN_DCN END) AS STAD_TOT_DHD_APV_DNC   /* 총차장일수 */
						, SUM(CASE WHEN  AUD_HNDL_STEP_SNO = 6 THEN DDLN_DCN END) AS STAD_DHD_APV_DNC   /* 차장일수 */
						, SUM(CASE WHEN  AUD_HNDL_STEP_SNO = 7 THEN DDLN_DCN END) AS STAD_PSD_APV_DNC   /* 총장일수 */
						, SUM(CASE WHEN  AUD_HNDL_STEP_SNO = 8 THEN DDLN_DCN END) AS STAD_CHF_CMTR_APV_DNC  /* 주심위원일수 */
						, SUM(CASE WHEN  AUD_HNDL_STEP_SNO = 9 THEN DDLN_DCN END) AS STAD_ENF_APV_DNC      /* 시행 일수 */
						, T2.PSD_APV_DDLN_DT
					FROM TBBADDED001M T1
						INNER JOIN TBBADDED003M T2
						ON T1.AUD_YR = T2.AUD_YR
						AND T1.AUD_NO = T2.AUD_NO
						INNER JOIN TBBADDED024B T3
						ON SUBSTR(T1.AUD_KND_CD, -1) = T3.AUD_KND_CD
						AND DECODE(T1.REQ_DVSN_CD, NULL, '0', '2', '2', '3', '3', '4', '4', '0') = T3.REQ_DVSN_CD
						INNER JOIN TBBADDED023B T4
						ON T4.RULE_SRNO = T3.RULE_SRNO
						INNER JOIN
						(SELECT
							REL_AUD_YR
							, REL_AUD_NO
							, TO_DATE(MIN(AUD_STR_DT)) AS STR_DT
						FROM
						TBBADDED002M A
						WHERE A.BZT_DVSN_CD = '1' --감사출장
				        AND A.AUD_BZT_KND_CD IN ('02')				  -- 실지감사
				        GROUP BY A.REL_AUD_YR, A.REL_AUD_NO
				        ) T5
				        ON T1.AUD_YR = T5.REL_AUD_YR
						AND T1.AUD_NO = T5.REL_AUD_NO
					WHERE T1.AUD_YR = #{audYr}
					AND T1.AUD_NO = #{audNo}
				    AND T5.STR_DT BETWEEN T4.RULE_APC_STR_DH AND T4.RULE_APC_END_DH		/* 실지감사 시작일 */
					GROUP BY T1.AUD_YR, T1.AUD_NO, T2.PSD_APV_DDLN_DT
				   ) X
				   , (
					/* AS-IS */
					SELECT   D.AUD_YR
						   , D.AUD_NO
--						   , DECODE( D.RTN_RPT_DT, NULL, 0, ( TO_DATE(D.RTN_RPT_DT) - TO_DATE(D.RTN_DT) - (SELECT COUNT(1)
--                                                                                         FROM TBBADDED013B
--                                                                                        WHERE YE||MD <= D.RTN_RPT_DT
--                                                                                          AND YE||MD >= D.RTN_DT))) AS RPT_DNC           /* 귀청 ~ 보고 일수 */
-- 처리기간 휴일포함 조건 추가 및 총,차장 단계 분리 (2019.04.18 LSR 수정)
						   , DECODE( D.RTN_RPT_DT, NULL, 0, F_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, TO_CHAR(TO_DATE(D.RTN_DT)-1, 'YYYYMMDD'), NVL(D.RTN_RPT_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '1', '1')) AS RPT_DNC           /* 귀청 ~ 보고 일수 */
--						   , DECODE( D.AUD_BRDV_APV_DT, NULL, 0, ( TO_DATE(D.AUD_BRDV_APV_DT) - TO_DATE(D.RTN_DT) )) AS AUD_BRDV_APV_DNC  /* 국과처리 일수 */
	                       , CASE
	                       		 WHEN NVL(D.EXTN_PRD_COFM_DT, 0) > 0 OR NVL(D.GNR_HNDL_PLAN_YN, 'N') = 'Y'
	                             THEN
	                             	DECODE( D.AUD_BRDV_APV_DT, NULL, 0, F_EXTN_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, TO_CHAR(TO_DATE(D.RTN_DT)-1, 'YYYYMMDD'), NVL(D.AUD_BRDV_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '0', '0', 'T'))
	                             ELSE
	                             	DECODE( D.AUD_BRDV_APV_DT, NULL, 0, F_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, TO_CHAR(TO_DATE(D.RTN_DT)-1, 'YYYYMMDD'), NVL(D.AUD_BRDV_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '2', '9'))
	                       END AS AUD_BRDV_APV_DNC  /* 국과처리 일수 2019.04.18 LSR 수정 */
--						   , DECODE( D.JA_JDG_SSEC_APV_DT, NULL, 0, ( TO_DATE(D.JA_JDG_SSEC_APV_DT) - TO_DATE(D.AUD_BRDV_APV_DT) )) AS RVW_RM_APV_DNC    /* 품질~국장 일수 */
	                       , CASE
	                       		 WHEN NVL(D.EXTN_PRD_COFM_DT, 0) > 0 OR NVL(D.GNR_HNDL_PLAN_YN, 'N') = 'Y'
	                             THEN
	                             	DECODE( D.JA_JDG_SSEC_APV_DT, NULL, 0, F_EXTN_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, EXTN_BRDV_HNDL_DDLN_DT, NVL(D.JA_JDG_SSEC_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '5', '5', 'P'))
	                             ELSE
	                             	DECODE( D.JA_JDG_SSEC_APV_DT, NULL, 0, F_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, BRDV_HNDL_DDLN_DT, NVL(D.JA_JDG_SSEC_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '5', '9'))
	                       END AS RVW_RM_APV_DNC    /* 품질~국장 일수 2019.04.18 LSR 수정 */
--						   , DECODE( D.OW_PSD_APV_DT, NULL, DECODE( D.OW_DHD_APV_DT, NULL, 0, ( TO_DATE(D.OW_DHD_APV_DT) - TO_DATE(D.JA_JDG_SSEC_APV_DT) ))
--                                                          , ( TO_DATE(D.OW_PSD_APV_DT) - TO_DATE(D.JA_JDG_SSEC_APV_DT) ) ) AS TOT_DHD_APV_DNC   /* 총차장일수 */
	                       , CASE
	                       		 WHEN NVL(D.EXTN_PRD_COFM_DT, 0) > 0 OR NVL(D.GNR_HNDL_PLAN_YN, 'N') = 'Y'
	                             THEN
	                             	DECODE( D.OW_PSD_APV_DT, NULL, DECODE( D.OW_DHD_APV_DT, NULL, 0, F_EXTN_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, EXTN_RVW_RM_APV_DDLN_DT, NVL(D.OW_DHD_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '6', '7', 'P') )
	                             							 , F_EXTN_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, EXTN_RVW_RM_APV_DDLN_DT, NVL(D.OW_PSD_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '6', '7', 'P') )
	                             ELSE
	                             	DECODE( D.OW_PSD_APV_DT, NULL, DECODE( D.OW_DHD_APV_DT, NULL, 0, F_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, RVW_RM_APV_DDLN_DT, NVL(D.OW_DHD_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '6', '9') )
	                             							 , F_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, RVW_RM_APV_DDLN_DT, NVL(D.OW_PSD_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '6', '9') )
	                       END AS TOT_DHD_APV_DNC   /* 총차장일수 2019.04.18 LSR 수정 */
	                       , CASE
	                       		 WHEN NVL(D.EXTN_PRD_COFM_DT, 0) > 0 OR NVL(D.GNR_HNDL_PLAN_YN, 'N') = 'Y'
	                             THEN
	                             	DECODE( D.OW_DHD_APV_DT, NULL, 0, F_EXTN_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, EXTN_RVW_RM_APV_DDLN_DT, NVL(D.OW_DHD_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '6', '6', 'P'))
	                             ELSE
	                             	DECODE( D.OW_DHD_APV_DT, NULL, 0, F_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, RVW_RM_APV_DDLN_DT, NVL(D.OW_DHD_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '6', '9'))
	                       END AS DHD_APV_DNC   /* 차장일수 2019.04.18 LSR 추가 */
	                       , CASE
	                       		 WHEN NVL(D.EXTN_PRD_COFM_DT, 0) > 0 OR NVL(D.GNR_HNDL_PLAN_YN, 'N') = 'Y'
	                             THEN
	                             	DECODE( D.OW_PSD_APV_DT, NULL, 0, F_EXTN_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, EXTN_DHD_APV_DDLN_DT, NVL(D.OW_PSD_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '7', '7', 'P'))
	                             ELSE
	                             	DECODE( D.OW_PSD_APV_DT, NULL, 0, F_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, DHD_APV_DDLN_DT, NVL(D.OW_PSD_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '7', '9'))
	                       END AS PSD_APV_DNC   /* 총장일수 2019.04.18 LSR 추가 */
--						   , DECODE( D.CHF_CMTR_APV_DT, NULL, 0, ( TO_DATE(D.CHF_CMTR_APV_DT) - DECODE( D.OW_PSD_APV_DT, NULL, TO_DATE(D.OW_DHD_APV_DT), TO_DATE(D.OW_PSD_APV_DT) ) )) AS CHF_CMTR_APV_DNC  /* 주심위원일수 */
	                       , CASE
	                       		 WHEN NVL(D.EXTN_PRD_COFM_DT, 0) > 0 OR NVL(D.GNR_HNDL_PLAN_YN, 'N') = 'Y'
	                             THEN
	                             	DECODE( D.CHF_CMTR_APV_DT, NULL, 0, F_EXTN_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, DECODE(EXTN_PSD_APV_DDLN_DT, NULL, EXTN_TOT_DHD_APV_DDLN_DT, EXTN_PSD_APV_DDLN_DT), NVL(D.CHF_CMTR_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '8', '8', 'P'))
	                             ELSE
	                             	DECODE( D.CHF_CMTR_APV_DT, NULL, 0, F_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, DECODE(PSD_APV_DDLN_DT, NULL, TOT_DHD_APV_DDLN_DT, PSD_APV_DDLN_DT), NVL(D.CHF_CMTR_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '8', '9'))
	                       END AS CHF_CMTR_APV_DNC  /* 주심위원일수 2019.04.18 LSR 수정 */
--						   , DECODE( D.ENF_APV_DT, NULL, 0, TO_DATE(D.ENF_APV_DT) - NVL(TO_DATE(D.SBCN_DT), TO_DATE(D.CHF_CMTR_APV_DT))  ) AS ENF_APV_DNC      /* 시행 일수 */
	                       , CASE
	                       		 WHEN NVL(D.EXTN_PRD_COFM_DT, 0) > 0 OR NVL(D.GNR_HNDL_PLAN_YN, 'N') = 'Y'
	                             THEN
	                             	DECODE( D.ENF_APV_DT, NULL, 0, F_EXTN_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, EXTN_CHF_CMTR_APV_DDLN_DT, NVL(D.ENF_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '9', '9', 'P'))
	                             ELSE
	                             	DECODE( D.ENF_APV_DT, NULL, 0, F_HNDL_DT_CNT(D.AUD_YR, D.AUD_NO, CHF_CMTR_APV_DDLN_DT, NVL(D.ENF_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '9', '9'))
	                       END AS ENF_APV_DNC      /* 시행 일수 2019.04.18 LSR 수정 */
					  FROM (
							SELECT   A.AUD_YR
								   , A.AUD_NO
								   , A.AUD_KND_CD
								   , A.AUD_SBJ_NM
								   , B.FLD_AUD_STR_DT         /* 실지감사시작일 */
							       , B.FLD_AUD_END_DT         /* 실지감사종료일 */
							       , B.FLD_AUD_EXEC_DCN       /* 실지감사실시일수 */
							       , B.FLD_EXTN_STR_DT        /* 실지연장시작일 */
							       , B.FLD_EXTN_END_DT        /* 실지연장종료일 */
                                   , B.RTN_DT                 /* 귀청일 */
							       ,
									(SELECT
										TO_CHAR(MAX(DECODE(D2.APVR_PST_CD,'0055600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
															,DECODE(D2.APVR_PST_CD,'0045900',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),''))), 'YYYYMMDD') -- 사무차장, 본부장 결재일로 변경 2019.05.23 LSR
									FROM TBBADDED103M D1
									,TBDCMACM023L D2
									WHERE 1=1
									AND D1.APV_RQS_ID  = D2.APV_DOC_NO
									AND D1.RPRT_CD     = 'A10500200' --종료보고서
									AND D1.AUD_YR = A.AUD_YR
									AND D1.AUD_NO = A.AUD_NO
									GROUP BY D1.AUD_YR, D1.AUD_NO) AS RTN_RPT_DT
                               	   ,
									(SELECT
									    TO_CHAR(MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0013600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'') END), 'YYYYMMDD')	--과장결재일
									FROM TBBADDED103M D1
									     ,TBDCMACM023L D2
									WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
									  AND D1.AUD_YR           = A.AUD_YR
									  AND D1.AUD_NO           = A.AUD_NO
									  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
									  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
									  AND D2.APVR_KND_CD IN ('1','2','3','4')) AS AUD_BRDV_APV_DT        /* 감사국과결재일 - 과장*/
                                   ,
									(SELECT
									    TO_CHAR(MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0015800',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
									                              ,DECODE(D2.APVR_PST_CD,'0035100',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
									                              ,DECODE(D2.APVR_PST_CD,'0058100',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),''))) END), 'YYYYMMDD')	--국단실장결재일
									FROM TBBADDED103M D1
									     ,TBDCMACM023L D2
									WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
									  AND D1.AUD_YR           = A.AUD_YR
									  AND D1.AUD_NO           = A.AUD_NO
									  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
									  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
									  AND D2.APVR_KND_CD IN ('1','2','3','4')) AS JA_JDG_SSEC_APV_DT     /* 법무심사관결재일 - 국장 */
                                   ,
									(SELECT
									    TO_CHAR(MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0055700',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'') END), 'YYYYMMDD')	--사무총장결재일
									FROM TBBADDED103M D1
									     ,TBDCMACM023L D2
									WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
									  AND D1.AUD_YR           = A.AUD_YR
									  AND D1.AUD_NO           = A.AUD_NO
									  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
									  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
									  AND D2.APVR_KND_CD IN ('1','2','3','4')) AS OW_PSD_APV_DT          /* 사무총장결재일 - 총장 */
									,
									(SELECT
									    TO_CHAR(MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN DECODE(D2.APVR_PST_CD,'0045900',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB)
									                              ,DECODE(D2.APVR_PST_CD,'0055600',F_GET_FIRST_APVR_DH(D1.DOC_ID,D2.APVR_CNB),'')) END), 'YYYYMMDD')	--사무차장결재일
									FROM TBBADDED103M D1
									     ,TBDCMACM023L D2
									WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
									  AND D1.AUD_YR           = A.AUD_YR
									  AND D1.AUD_NO           = A.AUD_NO
									  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
									  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
									  AND D2.APVR_KND_CD IN ('1','2','3','4')) AS OW_DHD_APV_DT          /* 사무차장결재일 - 차장 */
                                   ,
									(SELECT
									    TO_CHAR(MAX(CASE WHEN D2.APVR_KND_CD IN ('2','3','4') AND D1.RPRT_CD = 'A10600200' THEN (SELECT NVL(MIN(D6.APV_DH), SYSDATE)
									                                                FROM TBDCMACM023H D6 
									                                                    ,TBBADDED103M D7
									                                               WHERE D6.APV_DOC_NO = D7.APV_RQS_ID
									                                                 AND D6.APVR_KND_CD IN ('2','3','4')
									                                                 AND D7.RPRT_CD = 'A10700100'
									                                                 AND D7.APV_STA_CD = '30'
									                                                 AND D6.APVR_PST_CD = '0010600'
									                                                 AND REF_ID = D1.DOC_ID) END), 'YYYYMMDD')	--주심위원결재일
									FROM TBBADDED103M D1
									     ,TBDCMACM023L D2
									WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
									  AND D1.AUD_YR           = A.AUD_YR
									  AND D1.AUD_NO           = A.AUD_NO
									  AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
									  AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
									  AND D2.APVR_KND_CD IN ('1','2','3','4')) AS CHF_CMTR_APV_DT        /* 주심위원결재일 */
							       , B.ENF_APV_DT             /* 시행결재일     - 시행*/
                                   , B.SBCN_DT
			                       , B.RPT_DDLN_DT   	          /* 2019.04.18 LSR 추가 */
			                       , B.BRDV_HNDL_DDLN_DT   	      /* 2019.04.18 LSR 추가 */
			                       , B.RVW_RM_APV_DDLN_DT   	  /* 2019.04.18 LSR 추가 */
			                       , B.TOT_DHD_APV_DDLN_DT   	  /* 2019.04.18 LSR 추가 */
			                       , B.DHD_APV_DDLN_DT   	      /* 2019.04.18 LSR 추가 */
			                       , B.PSD_APV_DDLN_DT   	      /* 2019.04.18 LSR 추가 */
			                       , B.CHF_CMTR_APV_DDLN_DT   	  /* 2019.04.18 LSR 추가 */
			                       , B.EXTN_RPT_DDLN_DT   	  	  /* 2019.04.18 LSR 추가 */
			                       , B.EXTN_BRDV_HNDL_DDLN_DT     /* 2019.04.18 LSR 추가 */
			                       , B.EXTN_RVW_RM_APV_DDLN_DT    /* 2019.04.18 LSR 추가 */
			                       , B.EXTN_TOT_DHD_APV_DDLN_DT   /* 2019.04.18 LSR 추가 */
			                       , B.EXTN_DHD_APV_DDLN_DT   	  /* 2019.04.18 LSR 추가 */
			                       , B.EXTN_PSD_APV_DDLN_DT   	  /* 2019.04.18 LSR 추가 */
			                       , B.EXTN_CHF_CMTR_APV_DDLN_DT  /* 2019.04.18 LSR 추가 */
			                       , B.EXTN_PRD_COFM_DT   	  	  /* 2019.04.18 LSR 추가 */
			                       , B.GNR_HNDL_PLAN_YN   	  	  /* 2019.04.18 LSR 추가 */
							  FROM   TBBADDED001M A	/* 감사사항기본 */
							  	   , TBBADDED003M B	/* 국과별감사처리상황기본 */
							 WHERE A.AUD_YR = B.AUD_YR
							   AND A.AUD_NO = B.AUD_NO
							   AND A.AUD_YR = #{audYr}
							   AND A.AUD_NO = #{audNo}
					  	   ) D
				   ) Y
			 WHERE X.AUD_YR = Y.AUD_YR
			   AND X.AUD_NO = Y.AUD_NO
		)
		SELECT
			STEP_NM
			, STAD_DNC
			, DNC
		FROM
		(
				SELECT   '종료보고' AS STEP_NM
					   , STAD_RPT_DNC AS STAD_DNC
					   , RPT_DNC AS DNC
					   , 'A' AS TOT_DHD_DVS_CD
					   , PSD_APV_DDLN_DT
				  FROM DNC_DATA
				 UNION ALL
				SELECT   '과장' AS STEP_NM
					   , STAD_AUD_BRDV_APV_DNC AS STAD_DNC
					   , AUD_BRDV_APV_DNC AS DNC
					   , 'A' AS TOT_DHD_DVS_CD
					   , PSD_APV_DDLN_DT
				  FROM DNC_DATA
				 UNION ALL
				SELECT   '국장' AS STEP_NM
					   , STAD_RVW_RM_APV_DNC AS STAD_DNC
					   , RVW_RM_APV_DNC AS DNC
					   , 'A' AS TOT_DHD_DVS_CD
					   , PSD_APV_DDLN_DT
				  FROM DNC_DATA
				 UNION ALL
				SELECT   '차총장' AS STEP_NM
					   , STAD_TOT_DHD_APV_DNC AS STAD_DNC
					   , TOT_DHD_APV_DNC AS DNC
					   , 'N' AS TOT_DHD_DVS_CD
					   , PSD_APV_DDLN_DT
				  FROM DNC_DATA
				 UNION ALL
				SELECT   '차장' AS STEP_NM
					   , STAD_DHD_APV_DNC AS STAD_DNC
					   , DHD_APV_DNC AS DNC
					   , 'Y' AS TOT_DHD_DVS_CD
					   , PSD_APV_DDLN_DT
				  FROM DNC_DATA
				 UNION ALL
				SELECT   '총장' AS STEP_NM
					   , STAD_PSD_APV_DNC AS STAD_DNC
					   , PSD_APV_DNC AS DNC
					   , 'Y' AS TOT_DHD_DVS_CD
					   , PSD_APV_DDLN_DT
				  FROM DNC_DATA
				 UNION ALL
				SELECT   '주심위원' AS STEP_NM
					   , STAD_CHF_CMTR_APV_DNC AS STAD_DNC
					   , CHF_CMTR_APV_DNC AS DNC
					   , 'A' AS TOT_DHD_DVS_CD
					   , PSD_APV_DDLN_DT
				  FROM DNC_DATA
				 UNION ALL
				SELECT   '시행' AS STEP_NM
					   , STAD_ENF_APV_DNC AS STAD_DNC
					   , ENF_APV_DNC AS DNC
					   , 'A' AS TOT_DHD_DVS_CD
					   , PSD_APV_DDLN_DT
				  FROM DNC_DATA 
		) WHERE (TOT_DHD_DVS_CD = DECODE(PSD_APV_DDLN_DT, NULL, 'N', 'Y') OR TOT_DHD_DVS_CD = 'A')
	]]>
	</select>

	<!-- 감사진행현황 상세 팝업 목록 -->
	<select id="dashBoardAudPrssDetailListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardAudPrssDetailListSelect*/
		SELECT   F.AUD_YR
			   , F.AUD_NO
			   , F.AUD_KND_CD
			   , ( SELECT F_MNG_KND_AUDYRNO(F.AUD_YR, F.AUD_NO, F.AUD_KND_CD, '-') FROM DUAL ) AS AUD_YR_NO
			   , F.AUD_SBJ_NM
			   , ( SELECT F_CODE_NM( '1000007', F.AUD_KND_CD ) FROM DUAL ) AS AUD_KND_NM
			   , F.AUD_GRN_NO
			   , F.DPT_CD
			   , E.DPT_NM
			   , F.MNG_DPT_CD
			   , ( SELECT F_DPT_INFO( F.MNG_DPT_CD, '1' ) FROM DUAL ) AS SPV_BRDV_NM
			   , F.SPV_BRDV_CD
			   , F.PRSS_STEP_CD
			   , ( SELECT F_CODE_NM( '1000785', F.AUD_STEP_CD ) FROM DUAL ) AS AUD_STEP_NM
--			   , (
--			   	CASE
--                    WHEN F.PRSS_STEP_CD ='A1070' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.ENF_APV_DDLN_DT))
--                    WHEN F.PRSS_STEP_CD ='09' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.CHF_CMTR_APV_DDLN_DT))
--                    WHEN F.PRSS_STEP_CD ='08' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.TOT_DHD_APV_DDLN_DT))
--                    WHEN F.PRSS_STEP_CD ='07' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RVW_RM_APV_DDLN_DT))
--                    WHEN F.PRSS_STEP_CD ='06' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_OFER_APV_DDLN_DT))
--                    WHEN F.PRSS_STEP_CD ='05' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_CHGR_APV_DDLN_DT))
--                    WHEN F.PRSS_STEP_CD ='04' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.BRDV_HNDL_DDLN_DT))
--                    WHEN F.PRSS_STEP_CD = '03' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RPT_DDLN_DT))
--		            ELSE '-'
--				END
--			   ) AS DELAY_DAY
-- 총,차장 단계 분리로 인하여 코드 재정의 (2019.04.18 LSR 수정)
			   , (
                CASE
               		 WHEN TOT_DHD_DVS_CD IS NOT NULL
                     THEN
                     	CASE
		                    WHEN F.PRSS_STEP_CD ='A1070' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.ENF_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='10' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.CHF_CMTR_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='09' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.PSD_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='08' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.DHD_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='07' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RVW_RM_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='06' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_OFER_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='05' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_CHGR_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='04' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.BRDV_HNDL_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD = '03' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RPT_DDLN_DT))
				            ELSE '-'
				     	END
                     ELSE
                     	CASE
		                    WHEN F.PRSS_STEP_CD ='A1070' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.ENF_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='09' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.CHF_CMTR_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='08' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.TOT_DHD_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='07' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RVW_RM_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='06' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_OFER_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='05' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.MDT_CHGR_APV_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD ='04' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.BRDV_HNDL_DDLN_DT))
		                    WHEN F.PRSS_STEP_CD = '03' THEN TO_CHAR(TO_DATE(SYSDATE)-TO_DATE(F.RPT_DDLN_DT))
				            ELSE '-'
				       END
                END
			   ) AS DELAY_DAY
		  FROM (
		  		SELECT   S.DPT_CD
		  			   , S.DPT_NM
		  			   , S.DPT_SNO
				  FROM TBDCMACM002M S /* 부서 */
				 WHERE S.USE_YN = 'Y'
				   AND S.IMD_CD = 'Y'
				   AND S.ORZT_DVSN_CD = '20'
				   AND ( S.DPT_TP_CD = 'A' OR S.DPT_CD IN ( '0L0000','180000') ) /* 민원조사단, 공공감사운영단 구분 불가로 예외처리 */
		  	   ) E
		  	   , (
				/* AS-IS */
				SELECT   D.AUD_YR
					   , D.AUD_NO
					   , D.AUD_SBJ_NM
					   , D.AUD_KND_CD
					   , D.AUD_GRN_NO
					   , D.DPT_CD
					   , D.MNG_DPT_CD
					   , D.SPV_BRDV_CD
					   , (
					   	CASE
					   		WHEN D.PRSS_STEP_CD = '02' /* 출장 */
					   		THEN (
					   				CASE
					   					WHEN D.AUD_BZT_KND_CD = '01' 					THEN 'A1020'	/* 예비조사 */
					   					WHEN D.AUD_BZT_KND_CD IN ( '02', '03', '04' ) 	THEN 'A1040'	/* 감사실시 */
					   					ELSE 'A1010'	/* 자료수집 */
					   				END
					   			 )
					   		WHEN D.PRSS_STEP_CD IN ('04','05','06','07','08', '09')
					   		THEN 'A1060' /* 감사결과 처리 */
					   		WHEN D.PRSS_STEP_CD IN ('03','11')
					   		THEN 'A1050' /* 감사결과보고 */
                            ELSE D.PRSS_STEP_CD
					   	END
					   ) AS AUD_STEP_CD
					   , D.PRSS_STEP_CD
					   , D.ENF_APV_DDLN_DT
					   , D.CHF_CMTR_APV_DDLN_DT
					   , D.TOT_DHD_APV_DDLN_DT
					   , D.DHD_APV_DDLN_DT	-- 2019.04.18 LSR 추가
					   , D.PSD_APV_DDLN_DT	-- 2019.04.18 LSR 추가
					   , D.RVW_RM_APV_DDLN_DT
					   , D.MDT_OFER_APV_DDLN_DT
					   , D.MDT_CHGR_APV_DDLN_DT
					   , D.BRDV_HNDL_DDLN_DT
					   , D.RPT_DDLN_DT
					   , D.TOT_DHD_DVS_CD
				  FROM (
						SELECT   A.AUD_YR
							   , A.AUD_NO
							   , A.AUD_KND_CD
							   , A.AUD_GRN_NO
							   , A.AUD_SBJ_NM
							   , SUBSTR(A.MNG_DPT_CD, 1, 3) || '000' AS DPT_CD
							   , A.MNG_DPT_CD
							   , A.SPV_BRDV_CD
							   , C.BZT_YR
							   , C.BZT_SNO
							   , C.AUD_BZT_KND_CD
--                               , CASE
--                                    WHEN A.PRSS_STEP_CD = 'A1070' AND B.CHF_CMTR_APV_DT IS NOT NULL THEN 'A1070'    /* 부의 (A1070, 주심위원 결재 후) */
--                                    WHEN A.PRSS_STEP_CD = 'A1070' THEN '09'                                                                         /* A1070 단계 - 주심위원 */
--                                    WHEN A.PRSS_STEP_CD = 'A1060' AND B.OW_DHD_APV_DT IS NOT NULL THEN '08'            /* 총장 (A1060, 차장 결재 후) */
--                                    WHEN A.PRSS_STEP_CD = 'A1060' AND B.JA_JDG_SSEC_APV_DT IS NOT NULL THEN '08'    /* 차장 (A1060, 국장 결재 후) */
--                                    WHEN A.PRSS_STEP_CD = 'A1060' AND B.AUD_BRDV_APV_DT IS NOT NULL THEN '07'         /* 국장 (A1060, 과장 결재 후) */
--                                    WHEN A.PRSS_STEP_CD = 'A1060' OR (A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NOT NULL)THEN '04'                                                                        /* 과장 */
--                                    WHEN A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NULL THEN '03'                                                                        /* 종료보고 */
--                                    ELSE A.PRSS_STEP_CD
--                                END AS PRSS_STEP_CD
-- 총,차장 단계 분리로 인하여 코드 재정의 (2019.04.18 LSR 수정)
		                       , CASE
		                       		WHEN PSD_APV_DDLN_DT IS NOT NULL
		                            THEN
		                                CASE
		                                    WHEN A.PRSS_STEP_CD = 'A1070' AND B.CHF_CMTR_APV_DT IS NOT NULL THEN 'A1070'    /* 부의 (A1070, 주심위원 결재 후) */
		                                    WHEN A.PRSS_STEP_CD = 'A1070' THEN '10'                                                                         /* A1070 단계 - 주심위원 */
		                                    WHEN A.PRSS_STEP_CD = 'A1060' AND B.OW_DHD_APV_DT IS NOT NULL THEN '09'            /* 총장 (A1060, 차장 결재 후) */
		                                    WHEN A.PRSS_STEP_CD = 'A1060' AND B.JA_JDG_SSEC_APV_DT IS NOT NULL THEN '08'    /* 차장 (A1060, 국장 결재 후) */
		                                    WHEN A.PRSS_STEP_CD = 'A1060' AND B.AUD_BRDV_APV_DT IS NOT NULL THEN '07'         /* 국장 (A1060, 과장 결재 후) */
		                                    WHEN A.PRSS_STEP_CD = 'A1060' OR (A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NOT NULL)THEN '04'                                                                        /* 과장 */
		                                    WHEN A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NULL THEN '03'                                                                        /* 종료보고 */
		                                    ELSE A.PRSS_STEP_CD
		                                END
		                            ELSE
		                                CASE
		                                    WHEN A.PRSS_STEP_CD = 'A1070' AND B.CHF_CMTR_APV_DT IS NOT NULL THEN 'A1070'    /* 부의 (A1070, 주심위원 결재 후) */
		                                    WHEN A.PRSS_STEP_CD = 'A1070' THEN '09'                                                                         /* A1070 단계 - 주심위원 */
		                                    WHEN A.PRSS_STEP_CD = 'A1060' AND B.OW_DHD_APV_DT IS NOT NULL THEN '08'            /* 총장 (A1060, 차장 결재 후) */
		                                    WHEN A.PRSS_STEP_CD = 'A1060' AND B.JA_JDG_SSEC_APV_DT IS NOT NULL THEN '08'    /* 차장 (A1060, 국장 결재 후) */
		                                    WHEN A.PRSS_STEP_CD = 'A1060' AND B.AUD_BRDV_APV_DT IS NOT NULL THEN '07'         /* 국장 (A1060, 과장 결재 후) */
		                                    WHEN A.PRSS_STEP_CD = 'A1060' OR (A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NOT NULL)THEN '04'                                                                        /* 과장 */
		                                    WHEN A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NULL THEN '03'                                                                        /* 종료보고 */
		                                    ELSE A.PRSS_STEP_CD
		                                END
                                END AS PRSS_STEP_CD
							   , B.AUD_EXEC_HNDL_STA_CD
							   , RANK() OVER(PARTITION BY A.AUD_YR, A.AUD_NO ORDER BY C.BZT_YR, C.BZT_SNO DESC) AS RN
--                               , TO_CHAR(TO_DATE(B.ENF_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS ENF_APV_DDLN_DT
                               , NVL(B.EXTN_ENF_APV_DDLN_DT, B.ENF_APV_DDLN_DT) AS ENF_APV_DDLN_DT	-- 2019.04.05 LSR 수정
--                               , TO_CHAR(TO_DATE(B.CHF_CMTR_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS CHF_CMTR_APV_DDLN_DT
                               , NVL(B.EXTN_CHF_CMTR_APV_DDLN_DT, B.CHF_CMTR_APV_DDLN_DT) AS CHF_CMTR_APV_DDLN_DT	-- 2019.04.05 LSR 수정
--                               , TO_CHAR(TO_DATE(B.TOT_DHD_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS TOT_DHD_APV_DDLN_DT
                               , NVL(B.EXTN_TOT_DHD_APV_DDLN_DT, B.TOT_DHD_APV_DDLN_DT) AS TOT_DHD_APV_DDLN_DT	-- 2019.04.18 LSR 수정
                               , NVL(B.EXTN_DHD_APV_DDLN_DT, B.DHD_APV_DDLN_DT) AS DHD_APV_DDLN_DT	-- 2019.04.18 LSR 수정
                               , NVL(B.EXTN_PSD_APV_DDLN_DT, B.PSD_APV_DDLN_DT) AS PSD_APV_DDLN_DT	-- 2019.04.18 LSR 수정
--                               , TO_CHAR(TO_DATE(B.RVW_RM_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RVW_RM_APV_DDLN_DT
                               , NVL(B.EXTN_RVW_RM_APV_DDLN_DT, B.RVW_RM_APV_DDLN_DT) AS RVW_RM_APV_DDLN_DT	-- 2019.04.05 LSR 수정
--                               , TO_CHAR(TO_DATE(B.MDT_OFER_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS MDT_OFER_APV_DDLN_DT
                               , NVL(B.EXTN_MDT_OFER_APV_DDLN_DT, B.MDT_OFER_APV_DDLN_DT) AS MDT_OFER_APV_DDLN_DT	-- 2019.04.05 LSR 수정
--                               , TO_CHAR(TO_DATE(B.MDT_CHGR_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS MDT_CHGR_APV_DDLN_DT
                               , NVL(B.EXTN_MDT_CHGR_APV_DDLN_DT, B.MDT_CHGR_APV_DDLN_DT) AS MDT_CHGR_APV_DDLN_DT	-- 2019.04.05 LSR 수정
--                               , TO_CHAR(TO_DATE(B.BRDV_HNDL_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS BRDV_HNDL_DDLN_DT
                               , NVL(B.EXTN_BRDV_HNDL_DDLN_DT, B.BRDV_HNDL_DDLN_DT) AS BRDV_HNDL_DDLN_DT	-- 2019.04.05 LSR 수정
--                               , TO_CHAR(TO_DATE(B.RPT_DDLN_DT) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RPT_DDLN_DT
                               , NVL(B.EXTN_RPT_DDLN_DT, B.RPT_DDLN_DT) AS RPT_DDLN_DT	-- 2019.04.05 LSR 수정
                               , B.PSD_APV_DDLN_DT AS TOT_DHD_DVS_CD
						  FROM   TBBADDED001M A	/* 감사사항기본 */
						  	   , TBBADDED003M B	/* 국과별감사처리상황기본 */
						  	   , TBBADDED002M C /* 출장상황기본 */
						 WHERE A.AUD_YR = B.AUD_YR(+)
						   AND A.AUD_NO = B.AUD_NO(+)
						   AND A.AUD_YR = C.REL_AUD_YR(+)
						   AND A.AUD_NO = C.REL_AUD_NO(+)
						   AND B.AUD_EXEC_HNDL_STA_CD != '9'	/* 종료가 아닌 것 */
                           AND A.PRSS_STEP_CD NOT IN ( 'A1080', 'A1090', 'A1000' ,'A1019', '10' ) /* 감사결과시행, 집행전말 조회, 감사계획관리, 확인출장, 종료 제외 */
						   /* AND SUBSTRING(A.MNG_DPT_CD, 1, 1) = '0' */
						   AND A.BZT_BGT_DVSN_CD = '1'	/* 원배정인것만 */
                           AND A.AUD_YR > '2016'    /* 2017년도 감사사항부터 가져오도록 수정 신민준 */
                            ]]>
                           <if test="audStepCd != null and audStepCd != ''">
                           AND A.PRSS_STEP_CD = #{audStepCd}
                            </if>
						   AND EXISTS (
						   		SELECT 'X'
						   		  FROM TBDCMACM002M S
						   		 WHERE S.DPT_CD = A.MNG_DPT_CD
						   		   AND S.USE_YN = 'Y'
    		              <if test="dptCd != null and dptCd != ''">
        						   AND S.HIRK_DPT_CD = #{dptCd}
    		              </if>
						   	   )
					   ) D
				 WHERE D.RN = 1
           ) F
           WHERE F.DPT_CD = E.DPT_CD
	<![CDATA[
		 ORDER BY DPT_SNO, AUD_YR_NO
	]]>
	</select>

	<!-- 감사처리현황 팝업 상세 목록 -->
	<select id="dashBoardAudRsltTrtmSituDetailListSelect" parameterType="paramMap" resultType="egovMap">
	<![CDATA[
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.dashBoardAudRsltTrtmSituDetailListSelect*/
		WITH
		W_AUD_DATA AS (
		SELECT   ( SELECT F_MNG_KND_AUDYRNO(F.AUD_YR, F.AUD_NO, F.AUD_KND_CD, '-') FROM DUAL ) AS AUD_YR_NO
			   , F.AUD_SBJ_NM
			   , F.DPT_CD
			   , F.PRSS_STEP_CD
			   , F.RPT_DDLN_DT            /* 보고기한일 */
		       , F.RTN_RPT_DT             /* 귀청보고일 */
		       , F.BRDV_HNDL_DDLN_DT      /* 국과처리기한일 - 과장 */
		       , F.AUD_BRDV_APV_DT        /* 감사국과결재일 - 과장*/
		       , F.MDT_CHGR_APV_DDLN_DT   /* 조정담당자결재기한일 - 품질 05*/
		       , F.MDT_OFER_APV_DDLN_DT   /* 조정담당관결재기한일 - 품질 06*/
		       , F.MDT_OFER_APV_DT        /* 조정담당관결재일 */
		       , F.MDT_DDG_APV_DT         /* 조정심의관결재일 - 품질 */
		       , F.RVW_RM_APV_DDLN_DT     /* 심의실결재기한일 - 국장 */
		       , F.JA_JDG_SSEC_APV_DT     /* 법무심사관결재일 - 국장 */
		       , F.TOT_DHD_APV_DDLN_DT    /* 총차장결재기한일 */
		       , F.DHD_APV_DDLN_DT    	  /* 차장결재기한일 2019.04.18 LSR 추가 */
		       , F.PSD_APV_DDLN_DT    	  /* 총장결재기한일 2019.04.18 LSR 추가 */
		       , F.OW_DHD_APV_DT          /* 사무차장결재일 - 차장 */
		       , F.OW_PSD_APV_DT          /* 사무총장결재일 - 총장 */
		       , F.CHF_CMTR_APV_DDLN_DT   /* 주심위원결재기한일 */
		       , F.CHF_CMTR_APV_DT        /* 주심위원결재일 */
		       , F.ENF_APV_DDLN_DT        /* 시행결재기한일 - 시행 */
			   , F.ENF_APV_DT             /* 시행결재일     - 시행*/
			   , F.TOT_DHD_DVS_CD
-- 사용안함
--			   , (
--			   	CASE
--			   		WHEN F.PRSS_STEP_CD IN ('03', '11')
--			   		THEN TO_DATE(SYSDATE)-TO_DATE(F.RPT_DDLN_DT)					/* 실지감사종료보고 */
--			   		WHEN F.PRSS_STEP_CD = '04'
--			   		THEN TO_DATE(SYSDATE)-TO_DATE(F.BRDV_HNDL_DDLN_DT)				/* 과장 */
--			   		WHEN F.PRSS_STEP_CD = '05'
--			   		THEN TO_DATE(SYSDATE)-TO_DATE(F.MDT_CHGR_APV_DDLN_DT)			/* 조장담당자1 - 품질 */
--			   		WHEN F.PRSS_STEP_CD = '06'
--			   		THEN TO_DATE(SYSDATE)-TO_DATE(F.MDT_OFER_APV_DDLN_DT)			/* 조장담당자2 - 품질 */
--			   		WHEN F.PRSS_STEP_CD = '07'
--			   		THEN TO_DATE(SYSDATE)-TO_DATE(F.RVW_RM_APV_DDLN_DT)				/* 국장 */
--			   		WHEN F.PRSS_STEP_CD = '08' AND F.OW_DHD_APV_DT IS NULL
--			   		THEN TO_DATE(SYSDATE)-TO_DATE(F.TOT_DHD_APV_DDLN_DT)			/* 차장 */
--			   		WHEN F.PRSS_STEP_CD = '08' AND F.OW_DHD_APV_DT IS NOT NULL
--			   		THEN TO_DATE(SYSDATE)-TO_DATE(F.TOT_DHD_APV_DDLN_DT)			/* 총장 */
--			   		WHEN F.PRSS_STEP_CD = '09'
--			   		THEN TO_DATE(SYSDATE)-TO_DATE(F.CHF_CMTR_APV_DDLN_DT)			/* 주심위원 */
--			   		ELSE 0
--			   	 END
--			   ) AS DELAY_DAY
		  FROM (
		  		/* AS-IS */
				SELECT   A.AUD_YR
					   , A.AUD_NO
					   , A.AUD_YR || '_' || A.AUD_NO AS AUD_YR_NO
					   , A.AUD_KND_CD
					   , A.AUD_GRN_NO
					   , A.AUD_SBJ_NM
					   , SUBSTR(A.MNG_DPT_CD, 1, 3) || '000' AS DPT_CD
                       , CASE
                            WHEN A.PRSS_STEP_CD = 'A1070' AND B.CHF_CMTR_APV_DT IS NOT NULL THEN 'A1070'    /* 부의 (A1070, 주심위원 결재 후) */
                            WHEN A.PRSS_STEP_CD = 'A1070' THEN '09'                                                                         /* A1070 단계 - 주심위원 */
                            WHEN A.PRSS_STEP_CD = 'A1060' AND B.OW_DHD_APV_DT IS NOT NULL THEN '08'            /* 총장 (A1060, 차장 결재 후) */
                            WHEN A.PRSS_STEP_CD = 'A1060' AND B.JA_JDG_SSEC_APV_DT IS NOT NULL THEN '08'    /* 차장 (A1060, 국장 결재 후) */
                            WHEN A.PRSS_STEP_CD = 'A1060' AND B.AUD_BRDV_APV_DT IS NOT NULL THEN '07'         /* 국장 (A1060, 과장 결재 후) */
                            WHEN A.PRSS_STEP_CD = 'A1060' OR (A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NOT NULL)THEN '04'                                                                        /* 과장 */
                            WHEN A.PRSS_STEP_CD = 'A1050' AND B.RTN_RPT_DT IS NULL THEN '03'                                                                        /* 종료보고 */
                            ELSE A.PRSS_STEP_CD
                        END AS PRSS_STEP_CD
--                       , TO_CHAR(TO_DATE(B.RPT_DDLN_DT) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RPT_DDLN_DT             /* 보고기한일 */
                       , NVL(B.EXTN_RPT_DDLN_DT, B.RPT_DDLN_DT) AS RPT_DDLN_DT             /* 보고기한일  2019.04.05 LSR 수정 */
				       , B.RTN_RPT_DT             /* 귀청보고일 */
--                       , TO_CHAR(TO_DATE(B.BRDV_HNDL_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS BRDV_HNDL_DDLN_DT      /* 국과처리기한일 - 과장 */
                       , NVL(B.EXTN_BRDV_HNDL_DDLN_DT, B.BRDV_HNDL_DDLN_DT) AS BRDV_HNDL_DDLN_DT      /* 국과처리기한일 - 과장  2019.04.05 LSR 수정 */
				       , B.AUD_BRDV_APV_DT        /* 감사국과결재일 - 과장*/
--                       , TO_CHAR(TO_DATE(B.MDT_CHGR_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS MDT_CHGR_APV_DDLN_DT   /* 조정담당자결재기한일 - 품질 05*/
                       , NVL(B.EXTN_MDT_CHGR_APV_DDLN_DT, B.MDT_CHGR_APV_DDLN_DT) AS MDT_CHGR_APV_DDLN_DT   /* 조정담당자결재기한일 - 품질 05 2019.04.05 LSR 수정 */
--                       , TO_CHAR(TO_DATE(B.MDT_OFER_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS MDT_OFER_APV_DDLN_DT   /* 조정담당관결재기한일 - 품질 06*/
                       , NVL(B.EXTN_MDT_OFER_APV_DDLN_DT, B.MDT_OFER_APV_DDLN_DT) AS MDT_OFER_APV_DDLN_DT   /* 조정담당관결재기한일 - 품질 06 2019.04.05 LSR 수정 */
				       , B.MDT_OFER_APV_DT        /* 조정담당관결재일 */
				       , B.MDT_DDG_APV_DT         /* 조정심의관결재일 - 품질 */
--                       , TO_CHAR(TO_DATE(B.RVW_RM_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS RVW_RM_APV_DDLN_DT     /* 심의실결재기한일 - 국장 */
                       , NVL(B.EXTN_RVW_RM_APV_DDLN_DT, B.RVW_RM_APV_DDLN_DT) AS RVW_RM_APV_DDLN_DT     /* 심의실결재기한일 - 국장  2019.04.05 LSR 수정 */
				       , B.JA_JDG_SSEC_APV_DT     /* 법무심사관결재일 - 국장 */
--                       , TO_CHAR(TO_DATE(B.TOT_DHD_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS TOT_DHD_APV_DDLN_DT    /* 총차장결재기한일 */
                       , NVL(B.EXTN_TOT_DHD_APV_DDLN_DT, B.TOT_DHD_APV_DDLN_DT) AS TOT_DHD_APV_DDLN_DT    /* 총차장결재기한일  2019.04.18 LSR 수정 */
                       , NVL(B.EXTN_DHD_APV_DDLN_DT, B.DHD_APV_DDLN_DT) AS DHD_APV_DDLN_DT    /* 차장결재기한일  2019.04.18 LSR 수정 */
                       , NVL(B.EXTN_PSD_APV_DDLN_DT, B.PSD_APV_DDLN_DT) AS PSD_APV_DDLN_DT    /* 총장결재기한일  2019.04.18 LSR 수정 */
				       , B.OW_DHD_APV_DT          /* 사무차장결재일 - 차장 */
				       , B.OW_PSD_APV_DT          /* 사무총장결재일 - 총장 */
--                       , TO_CHAR(TO_DATE(B.CHF_CMTR_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS CHF_CMTR_APV_DDLN_DT   /* 주심위원결재기한일 */
                       , NVL(B.EXTN_CHF_CMTR_APV_DDLN_DT, B.CHF_CMTR_APV_DDLN_DT) AS CHF_CMTR_APV_DDLN_DT   /* 주심위원결재기한일  2019.04.05 LSR 수정 */
				       , B.CHF_CMTR_APV_DT        /* 주심위원결재일 */
--                       , TO_CHAR(TO_DATE(B.ENF_APV_DDLN_DT) + DECODE(B.GNR_HNDL_PLAN_YN,'Y',5,0) + NVL(B.EXTN_PRD_COFM_DT,0),'YYYYMMDD') AS ENF_APV_DDLN_DT        /* 시행결재기한일 - 시행 */
                       , NVL(B.EXTN_ENF_APV_DDLN_DT, B.ENF_APV_DDLN_DT) AS ENF_APV_DDLN_DT        /* 시행결재기한일 - 시행  2019.04.05 LSR 수정 */
				       , B.ENF_APV_DT             /* 시행결재일     - 시행*/
                       , B.PSD_APV_DDLN_DT AS TOT_DHD_DVS_CD
				  FROM   TBBADDED001M A	/* 감사사항기본 */
				  	   , TBBADDED003M B	/* 국과별감사처리상황기본 */
				 WHERE A.AUD_YR = B.AUD_YR(+)
				   AND A.AUD_NO = B.AUD_NO(+)
				   AND B.AUD_EXEC_HNDL_STA_CD != '9'	/* 종료가 아닌 것 */
				   AND A.AUD_YR = #{audYr}	/* 파라미터 */
				   AND A.AUD_NO = #{audNo}	/* 파라미터 */
				   /* AND SUBSTRING(A.MNG_DPT_CD, 1, 1) = '0' */
				   AND A.BZT_BGT_DVSN_CD = '1'	/* 원배정인것만 */
				   AND A.PRSS_STEP_CD IN ('A1050','A1060','A1070') /* 처리중, 감사결과보고 중인 것만 가져오기 */
				   AND EXISTS (
				   		SELECT 'X'
				   		  FROM TBDCMACM002M S
				   		 WHERE S.DPT_CD = A.MNG_DPT_CD
				   		   AND S.USE_YN = 'Y'
				   	   )
			   ) F
		)
		SELECT   '기준일' AS GUBUN
			   , AUD_YR_NO
			   , AUD_SBJ_NM
			   , TO_CHAR(TO_DATE(A.RPT_DDLN_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_END_RPT
			   , TO_CHAR(TO_DATE(A.BRDV_HNDL_DDLN_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_DVCHF
			   , TO_CHAR(TO_DATE(A.RVW_RM_APV_DDLN_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_BRUCHF
			   , TO_CHAR(TO_DATE(A.TOT_DHD_APV_DDLN_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_TOT_DHD
			   , TO_CHAR(TO_DATE(A.DHD_APV_DDLN_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_DHD	-- 2019.04.18 LSR 수정
			   , TO_CHAR(TO_DATE(A.PSD_APV_DDLN_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_PSD	-- 2019.04.18 LSR 수정
			   , TO_CHAR(TO_DATE(A.CHF_CMTR_APV_DDLN_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_CHF_CMTR
			   , TO_CHAR(TO_DATE(A.ENF_APV_DDLN_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS ENF
--			   , A.DELAY_DAY
			   , A.TOT_DHD_DVS_CD
		  FROM W_AUD_DATA A
		 UNION ALL
		SELECT   '처리일' AS GUBUN
			   , AUD_YR_NO
			   , AUD_SBJ_NM
			   , TO_CHAR(TO_DATE(A.RTN_RPT_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_END_RPT
			   , TO_CHAR(TO_DATE(A.AUD_BRDV_APV_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_DVCHF
			   , TO_CHAR(TO_DATE(A.JA_JDG_SSEC_APV_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_BRUCHF
			   , TO_CHAR(TO_DATE(A.OW_PSD_APV_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_TOT_DHD
			   , TO_CHAR(TO_DATE(A.OW_DHD_APV_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_DHD	-- 2019.04.18 LSR 수정
			   , TO_CHAR(TO_DATE(A.OW_PSD_APV_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_PSD	-- 2019.04.18 LSR 수정
			   , TO_CHAR(TO_DATE(A.CHF_CMTR_APV_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS AUD_CHF_CMTR
			   , TO_CHAR(TO_DATE(A.ENF_APV_DT, 'YYYY-MM-DD'),'YYYY-MM-DD') AS ENF
--			   , A.DELAY_DAY
			   , A.TOT_DHD_DVS_CD
		  FROM W_AUD_DATA A
	]]>
	</select>


	<select id="selectDcpSituList" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectDcpSituList*/
	<![CDATA[
		SELECT T1.DPT_CD
     , NVL(F_DPT_INFO(T1.DPT_CD,'1'),'합계') AS DPT_NM
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD ='1' THEN CNT1 ELSE 0 END),'999,999,999,999')) AS CNT1
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1' THEN CNT1_1 ELSE 0 END),'999,999,999,999')) AS CNT2
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1' THEN CNT1_2 ELSE 0 END),'999,999,999,999')) AS CNT3
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1' THEN CNT2 ELSE 0 END),'999,999,999,999')) AS CNT4
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2' THEN CNT3 ELSE 0 END),'999,999,999,999')) AS CNT5
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2' THEN CNT3_1 ELSE 0 END),'999,999,999,999')) AS CNT6
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2' THEN CNT3_2 ELSE 0 END),'999,999,999,999')) AS CNT7
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2' THEN CNT3_3 ELSE 0 END),'999,999,999,999')) AS CNT8
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2' THEN CNT3_4 ELSE 0 END),'999,999,999,999')) AS CNT9
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2' THEN CNT4 ELSE 0 END),'999,999,999,999')) AS CNT10
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2' THEN CNT4_1 ELSE 0 END),'999,999,999,999'))||' ('||TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2' THEN CNT4_3 ELSE 0 END),'999,999,999,999'))||')' AS CNT11
     , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2' THEN CNT4_2 ELSE 0 END),'999,999,999,999')) AS CNT12
     
  FROM (
   SELECT '1' AS DVSN_CD
       ,T1.ACP_DPT_CD  AS DPT_CD
       ,1 AS CNT1
       ,CASE WHEN TO_CHAR(T1.ACP_DH,'YYYYMM') = '201901' THEN 1 ELSE 0 END AS CNT1_1
       ,CASE WHEN TO_CHAR(T1.ACP_DH,'YYYY') = '2019' THEN 1 ELSE 0 END AS CNT1_2
       ,CASE WHEN T1.CVPT_HNDL_STA_CD IN ('20','30','31') AND T2.HNDL_CHGR_ID IS NULL THEN 1 ELSE 0 END CNT2
       ,0 AS CNT3 
       ,0 AS CNT3_1
       ,0 AS CNT3_2
       ,0 AS CNT3_3
       ,0 AS CNT3_4
       ,0 AS CNT4
       ,0 AS CNT4_1
       ,0 AS CNT4_2
       ,0 AS CNT4_3
  FROM TBCSPDCP101M T1
      ,TBCSPDCP201M T2
 WHERE T1.REQ_DVSN_CD = '1'
   AND T1.RM_CVPT_ACP_NO IS NOT NULL
   AND T1.REQ_DVSN_CD = T2.REQ_DVSN_CD(+)
   AND T1.ACP_YR = T2.ACP_YR(+)
   AND T1.CVPT_ACP_NO = T2.CVPT_ACP_NO(+)
   AND T1.ACP_DPT_CD IS NOT NULL
   AND T1.ACP_DH IS NOT NULL 
   
   UNION ALL
   
   SELECT '2' AS DVSN_CD
       ,NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD)  AS DPT_CD
       ,0 AS CNT1
       ,0 AS CNT1_1
       ,0 AS CNT1_2
       ,0 AS CNT2
       ,CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40','41','30','31') AND T2.HNDL_CHGR_ID IS NOT NULL THEN 1 ELSE 0 END CNT3
       ,CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40','41','30','31') AND T2.HNDL_CHGR_ID IS NOT NULL 
       AND TRUNC(SYSDATE-ACP_DH-(SELECT COUNT(*) FROM TBBADDED013B S1 WHERE S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH,'YYYYMMDD') AND TO_CHAR(SYSDATE,'YYYYMMDD') ))+1 <=20 THEN 1 ELSE 0 END
       AS CNT3_1
       ,CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40','41','30','31') AND T2.HNDL_CHGR_ID IS NOT NULL 
       AND TRUNC(SYSDATE-ACP_DH-(SELECT COUNT(*) FROM TBBADDED013B S1 WHERE S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH,'YYYYMMDD') AND TO_CHAR(SYSDATE,'YYYYMMDD') ))+1 BETWEEN 21 AND 30 THEN 1 ELSE 0 END
       AS CNT3_2
       ,CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40','41','30','31') AND T2.HNDL_CHGR_ID IS NOT NULL 
       AND TRUNC(SYSDATE-ACP_DH-(SELECT COUNT(*) FROM TBBADDED013B S1 WHERE S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH,'YYYYMMDD') AND TO_CHAR(SYSDATE,'YYYYMMDD') ))+1 BETWEEN 31 AND 40 THEN 1 ELSE 0 END
       AS CNT3_3
       ,CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40','41','30','31') AND T2.HNDL_CHGR_ID IS NOT NULL 
       AND TRUNC(SYSDATE-ACP_DH-(SELECT COUNT(*) FROM TBBADDED013B S1 WHERE S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH,'YYYYMMDD') AND TO_CHAR(SYSDATE,'YYYYMMDD') ))+1 > 40 THEN 1 ELSE 0 END
       AS CNT3_4
       ,CASE WHEN T1.CVPT_HNDL_STA_CD IN ('50','60','80','21','70') THEN 1 ELSE 0 END AS CNT4
       ,CASE WHEN T1.CVPT_HNDL_STA_CD IN ('50','60','80') THEN 1 ELSE 0 END AS CNT4_1
       ,CASE WHEN T1.CVPT_HNDL_STA_CD IN ('70','21') THEN 1 ELSE 0 END AS CNT4_2
       ,CASE WHEN T1.CVPT_HNDL_STA_CD = '60' AND TO_CHAR(T2.FNL_HNDL_DH) = '2019' THEN 1 ELSE 0 END AS CNT4_3
  FROM TBCSPDCP101M T1
      ,TBCSPDCP201M T2
 WHERE T1.REQ_DVSN_CD = '1'
   AND T1.RM_CVPT_ACP_NO IS NOT NULL
   AND T1.REQ_DVSN_CD = T2.REQ_DVSN_CD(+)
   AND T1.ACP_YR = T2.ACP_YR(+)
   AND T1.CVPT_ACP_NO = T2.CVPT_ACP_NO(+)
   AND T1.ACP_DH IS NOT NULL 
   
   ) T1
   
   GROUP BY ROLLUP(T1.DPT_CD)
   ORDER BY CASE WHEN T1.DPT_CD = '0L0100' THEN 1 
              WHEN T1.DPT_CD ='071110' THEN 2 
              WHEN T1.DPT_CD = '0L0200' THEN 3
              WHEN T1.DPT_CD = '0L0300' THEN 4
              WHEN T1.DPT_CD = '062600' THEN 5
              WHEN T1.DPT_CD = '062700' THEN 6
              WHEN T1.DPT_CD = '062800' THEN 7
              ELSE 0 END
              ASC
	]]>
	</select>


	<select id="selectDcpSituList2" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectDcpSituList2*/
	<![CDATA[
		SELECT CASE WHEN CVPT_HNDL_DVSN_CD = '990' THEN '반송' 
            WHEN CVPT_HNDL_DVSN_CD = '991' THEN '취하'
            WHEN CVPT_HNDL_DVSN_CD IS NULL THEN '합계'
            ELSE F_CODE_NM('1000754',CVPT_HNDL_DVSN_CD) END AS TITL
      , SUM(CNT1) AS SUM1
      , SUM(CNT2) AS TITL1
      , SUM(CNT3) AS TITL2
      , SUM(CNT4) AS TITL3
      , SUM(CNT5) AS TITL4
      , SUM(CNT6) AS TITL5
      , SUM(CNT7) AS TITL6
      , SUM(CNT8) AS TITL7 
 FROM (
    SELECT CASE WHEN T1.CVPT_HNDL_STA_CD = '80' THEN '990'
                WHEN T1.CVPT_HNDL_STA_CD IN ('70','21') THEN '991'
                WHEN T3.CVPT_HNDL_DVSN_CD IN ('30','40') THEN '90'
                ELSE T3.CVPT_HNDL_DVSN_CD END  AS CVPT_HNDL_DVSN_CD
         ,1 CNT1
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '0L0100' THEN 1 ELSE 0 END   AS CNT2 
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '071110' THEN 1 ELSE 0 END   AS CNT3
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '0L0200' THEN 1 ELSE 0 END   AS CNT4
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '0L0300' THEN 1 ELSE 0 END   AS CNT5
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '062600' THEN 1 ELSE 0 END   AS CNT6
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '062700' THEN 1 ELSE 0 END   AS CNT7
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '062800' THEN 1 ELSE 0 END   AS CNT8
      FROM TBCSPDCP101M T1 
          ,TBCSPDCP201M T2
          ,(SELECT * 
              FROM TBCSPDCP205L T3
             WHERE (T3.REQ_DVSN_CD, T3.ACP_YR, T3.CVPT_ACP_NO, T3.SRNO) IN (SELECT S1.REQ_DVSN_CD, S1.ACP_YR, S1.CVPT_ACP_NO, MIN(S1.SRNO)
                                                                              FROM TBCSPDCP205L S1
                                                                             GROUP BY S1.REQ_DVSN_CD, S1.ACP_YR, S1.CVPT_ACP_NO)
           ) T3
          
     WHERE T1.REQ_DVSN_CD = '1'
       AND T1.REQ_DVSN_CD = T2.REQ_DVSN_CD(+)
       AND T1.ACP_YR = T2.ACP_YR(+)
       AND T1.CVPT_ACP_NO = T2.CVPT_ACP_NO(+)
       AND T1.REQ_DVSN_CD = T3.REQ_DVSN_CD(+)
       AND T1.ACP_YR = T3.ACP_YR(+)
       AND T1.CVPT_ACP_NO = T3.CVPT_ACP_NO(+)
       AND T1.RM_CVPT_ACP_NO IS NOT NULL
       AND T1.ACP_DH IS NOT NULL
       AND T1.CVPT_HNDL_STA_CD IN ('21','60','70','80','50')
      )
   GROUP BY ROLLUP(CVPT_HNDL_DVSN_CD)
   ORDER BY TO_NUMBER(CASE WHEN CVPT_HNDL_DVSN_CD = '90' THEN '30'
            WHEN CVPT_HNDL_DVSN_CD = '70' THEN '101'
            WHEN CVPT_HNDL_DVSN_CD IS NULL THEN '00'
            ELSE CVPT_HNDL_DVSN_CD END )
         ]]>
	</select>

	<select id="selectDcpSituList3" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectDcpSituList3*/
		<![CDATA[
		SELECT ROWNUM AS ROW_NUM
				, REQ_DVSN_CD
				, ACP_YR
				, CVPT_ACP_NO
				, ACP_NO_NM, ACP_DH
				, TIT_NM, CVPT_SBT
				, CVPTR_NM
				, HNDL_CHGR_NM
				, CASE WHEN HNDL_LIMIT_CNT < 0 THEN HNDL_LIMIT_DT||' (기한초과:'||HNDL_LIMIT_CNT||'일)' ELSE HNDL_LIMIT_DT||' (D-'||HNDL_LIMIT_CNT||'일)' END HNDL_LIMIT_DT  
       			, CASE WHEN HNDL_LIMIT_CNT < 0 THEN HNDL_LIMIT_DT_PRCS||' (기한초과:'||HNDL_LIMIT_CNT||'일)' ELSE HNDL_LIMIT_DT_PRCS||' (D-'||HNDL_LIMIT_CNT||'일)' END HNDL_LIMIT_DT_PRCS
				, PRC_CNT, AUD_YN, DELAY_YN, WDW_RQS_YN
				, CVPT_HNDL_STA_CD,CVPT_HNDL_STA_NM
				, DOC_TYPE
				, HNDL_LIMIT_CNT
		FROM (
			SELECT 	A.REQ_DVSN_CD
					,A.ACP_YR
					,A.CVPT_ACP_NO
					,DECODE(A.RM_ACP_KND_CD, NULL, '-', A.ACP_YR||'-'|| F_CODE_NM('1000949', A.RM_ACP_KND_CD) ||'-'||A.RM_CVPT_ACP_NO) AS ACP_NO_NM -- BEST20 제보,민원 구분 추가
					,TO_CHAR(A.ACP_DH, 'YYYY-MM-DD HH24:MM') AS ACP_DH
					,CASE WHEN ( SELECT COUNT(*)
							       FROM TBCSPDCP105L S1
							      WHERE S1.REQ_DVSN_CD = A.REQ_DVSN_CD
							        AND S1.ACP_YR = A.ACP_YR
							        AND S1.CVPT_ACP_NO = A.CVPT_ACP_NO ) > 1 
						THEN A.TIT_NM||'(합건 : '||
						       ( SELECT S3.ACP_YR||'-'|| F_CODE_NM('1000949', S3.RM_ACP_KND_CD)||'-'||S3.RM_CVPT_ACP_NO
                                   FROM TBCSPDCP105L S2, TBCSPDCP101M S3
                                  WHERE A.REQ_DVSN_CD = S2.REQ_DVSN_CD
                                    AND A.ACP_YR = S2.ACP_YR
                                    AND A.CVPT_ACP_NO = S2.CVPT_ACP_NO
                                    AND S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
                                    AND S2.SUC_ACP_YR = S3.ACP_YR
                                    AND S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO
                                    AND ROWNUM = 1)
                                   || ' 외 '
                                   || (SELECT COUNT(*)-1
                                        FROM TBCSPDCP105L S2, TBCSPDCP101M S3
                                       WHERE A.REQ_DVSN_CD     = S2.REQ_DVSN_CD
                                         AND A.ACP_YR          = S2.ACP_YR
                                         AND A.CVPT_ACP_NO     = S2.CVPT_ACP_NO
                                         AND S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
                                         AND S2.SUC_ACP_YR      = S3.ACP_YR
                                         AND S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO )
                                   ||'건 )'
						WHEN ( SELECT COUNT(*) 
						         FROM TBCSPDCP105L S1
						        WHERE S1.SUC_REQ_DVSN_CD = A.REQ_DVSN_CD
						          AND S1.SUC_ACP_YR = A.ACP_YR
						          AND S1.SUC_CVPT_ACP_NO = A.CVPT_ACP_NO) = 1
						THEN A.TIT_NM ||'(합건 : '|| 
						      ( SELECT S3.ACP_YR||'-'|| F_CODE_NM('1000949', S3.RM_ACP_KND_CD) ||'-'||S3.RM_CVPT_ACP_NO
						          FROM TBCSPDCP105L S2, TBCSPDCP101M S3
						         WHERE S2.REQ_DVSN_CD = S3.REQ_DVSN_CD
						           AND S2.ACP_YR = S3.ACP_YR
						           AND S2.CVPT_ACP_NO = S3.CVPT_ACP_NO
						           AND S2.SUC_REQ_DVSN_CD = A.REQ_DVSN_CD
						           AND S2.SUC_ACP_YR = A.ACP_YR
						           AND S2.SUC_CVPT_ACP_NO = A.CVPT_ACP_NO
						       )
						       || ')'
					ELSE A.TIT_NM END AS TIT_NM
					,D.CVPT_SBT
					,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
                    ,F_USR_INFO_BY_ID(B.HNDL_CHGR_ID,'2') AS HNDL_CHGR_NM
                    ,TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYY-MM-DD') AS HNDL_LIMIT_DT
                     ,TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYY-MM-DD') AS HNDL_LIMIT_DT_PRCS
                     ,(SELECT COUNT(CVPT_ACP_NO)
					   FROM TBCSPDCP601M
					  WHERE ACP_YR = A.ACP_YR
					     AND REQ_DVSN_CD = A.REQ_DVSN_CD
					     AND CVPT_ACP_NO = A.CVPT_ACP_NO) AS PRC_CNT
					 , DECODE((SELECT
                                  SUM(to_date(Z2.AUD_END_DT) - to_date(Z2.AUD_STR_DT) + 1) AS EDT /*출장종료일*/
                            FROM  TBCSPDCP207L Z1
                            INNER JOIN TBBADDED002M Z2 ON (Z1.AUD_YR = Z2.REL_AUD_YR
                                                         AND Z1.AUD_NO = Z2.REL_AUD_NO
                                                         AND Z1.AUD_STEP_SNO = Z2.AUD_STEP_SNO)
                            WHERE Z1.ACP_YR = A.ACP_YR
                            AND Z1.REQ_DVSN_CD = A.REQ_DVSN_CD
                            AND Z1.CVPT_ACP_NO = A.CVPT_ACP_NO),NULL,'N','Y') AS AUD_YN
                     ,DECODE((
                            SELECT NVL(SUM(DECODE(NVL(Z3.APV_STA_CD,'0'), '30', '1', '0')),0)
                             FROM TBCSPDCP603M Z3
                             WHERE Z3.ACP_YR = A.ACP_YR
                               AND Z3.REQ_DVSN_CD = A.REQ_DVSN_CD
                               AND Z3.CVPT_ACP_NO = A.CVPT_ACP_NO
                               AND Z3.RPRT_CD = 'B10200100'),0,'N','Y') AS DELAY_YN
                    /* ,DECODE(A.BK_HNDL_DDLN_DT, NULL, 'N', 'Y') AS DELAY_YN*/
                     ,A.WDW_RQS_YN
                     ,A.CVPT_HNDL_STA_CD
                     ,F_CODE_NM('1000361',A.CVPT_HNDL_STA_CD) ||( 
                     CASE WHEN ( SELECT COUNT(1)
							       FROM TBCSPDCP603M S1
							      WHERE S1.REQ_DVSN_CD = A.REQ_DVSN_CD
							        AND S1.ACP_YR = A.ACP_YR
							        AND S1.CVPT_ACP_NO = A.CVPT_ACP_NO 
							        AND S1.ACP_STEP_CD = 'B1020'
							        AND A.CVPT_HNDL_STA_CD ='40'
							        AND S1.RPRT_CD = 'B10200400') > 0
						  THEN '('||( SELECT F_CODE_NM('1000773',S2.APV_STA_CD)
							       		FROM TBCSPDCP603M S2
							      		WHERE S2.REQ_DVSN_CD = A.REQ_DVSN_CD
							        	AND S2.ACP_YR = A.ACP_YR
							        	AND S2.CVPT_ACP_NO = A.CVPT_ACP_NO 
						  				AND S2.ACP_STEP_CD = 'B1020'
						  				AND S2.RPRT_CD = 'B10200400'
						  				AND ROWNUM = 1
						  			)
						  		  || ')'
                          ELSE '' END
                     ) AS CVPT_HNDL_STA_NM
                     ,F_CODE_NM('1000894', DOC_WRIT_KND_CD) AS DOC_TYPE
                     ,TRUNC((TO_DATE(A.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))) AS HNDL_LIMIT_CNT
			FROM 	TBCSPDCP101M A
					,TBCSPDCP201M B
					,TBCSPDCP102M D
			WHERE	1=1
			AND		A.REQ_DVSN_CD = B.REQ_DVSN_CD
			AND		A.ACP_YR = B.ACP_YR
			AND		A.CVPT_ACP_NO = B.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = D.REQ_DVSN_CD
			AND		A.ACP_YR = D.ACP_YR
			AND		A.CVPT_ACP_NO = D.CVPT_ACP_NO
			AND		A.REQ_DVSN_CD = '1'
            AND		A.CVPT_HNDL_STA_CD IN ('30','40','41')
            AND		(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO)
   					NOT IN (
   						SELECT	SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
   						FROM	TBCSPDCP105L
   					)
			]]>
			<if test="hndlChgrId != null and hndlChgrId != ''">
			AND B.HNDL_CHGR_ID = #{hndlChgrId}
			</if>
			ORDER BY ACP_YR DESC, CVPT_ACP_NO DESC
		)
		</select>


		<select id="selectDcpUsrList" parameterType="paramMap" resultType="egovMap">
		/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectDcpUsrList*/
		<![CDATA[
		SELECT 	A.CNB
				, A.USR_ID
				, A.USR_NAM
				, A.DPT_CD
				, F_CODE_NM('1000173', A.RANK_CD)
				, A.RANK_CD
		FROM TBDCMACM001M A
		WHERE   RAL_BLT_DIV_CD = #{dptCd}
		AND 	RSG_DT IS NULL
		AND 	PST_CD IS NULL
		AND		RQS_STA_CD = '3'
		AND		BAI_USR_YN = 'Y'
        AND (A.RANK_CD <> '014' OR A.RANK_CD IS NULL)

        ORDER BY A.RAL_BLT_DIV_CD, NVL(A.INN_RANK_CD,'50') ASC , A.RANK_SRT_SEQ_NM, A.CRNT_RANK_APM_DT, A.SRT_KY_NO, A.CRNT_DPT_APM_DT, A.EIN
        ]]>
        </select>

        <select id="selectEarUsrList" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectEarUsrList*/
       <![CDATA[
        SELECT 	A.CNB
				, A.USR_ID
				, A.USR_NAM
				, A.DPT_CD
				, F_CODE_NM('1000173', A.RANK_CD)
				, A.RANK_CD
		FROM TBDCMACM001M A
		WHERE (A.DPT_CD = #{dptCd} OR A.SUB_DPT_CD = #{dptCd})
		AND 	RSG_DT IS NULL
		AND 	PST_CD IS NULL
		AND		RQS_STA_CD = '3'
		AND		BAI_USR_YN = 'Y'
        AND (A.RANK_CD <> '014' OR A.RANK_CD IS NULL)

        ORDER BY A.RAL_BLT_DIV_CD, NVL(A.INN_RANK_CD,'50') ASC , A.RANK_SRT_SEQ_NM, A.CRNT_RANK_APM_DT, A.SRT_KY_NO, A.CRNT_DPT_APM_DT, A.EIN
        ]]>
        </select>

        <select id="selectEarSituList" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectEarSituList*/
        <![CDATA[
				WITH BASE AS (SELECT 
					 DVSN_CD,
					-- DVSN_NM,
					 이월+신규접수 AS ACP_CNT_ALL /* 공익 계 */
					 ,이월 AS L_ACP_CNT
					 ,신규접수 AS N_ACP_CNT
					

					,입건+불문+기각+각하+기각각하+취하+이첩 AS COM_CNT_ALL /* 처리완료계 */
					,입건 AS CNT11
					,불문 AS CNT12
					,기각 AS CNT13
					,각하 AS CNT14
					,기각각하 AS CNT15
					,취하 AS CNT16
					,이첩 AS CNT17
					,계 AS EXAM_CNT
					FROM (
					
					    SELECT
					
					    '2' AS DVSN_CD, --'국민' AS DVSN_NM,
						/* 국민 이월 */
						(SELECT COUNT(*)
					      FROM TBCSPDCP101M A , 
					           TBCSPEAR001M B 
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)     
					       AND A.ACP_YR = B.ACP_YR(+)
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
					       AND A.REQ_DVSN_CD IN ('2')          
					       AND A.ACP_YR < TO_CHAR(SYSDATE, 'YYYY') 
					       AND (    A.CVPT_HNDL_STA_CD != '170'               
					            OR                                             
					                (B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')    
					                 OR B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')   
					                 OR TO_CHAR(A.CVPT_WDW_DH, 'YYYY') = TO_CHAR(SYSDATE, 'YYYY')
					                )
					            )
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
						) AS 이월,
					
					    /* 국민 신규접수 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B 
						        WHERE A.REQ_DVSN_CD IN ('2') 
						           AND A.ACP_YR = TO_CHAR(SYSDATE, 'YYYY') 
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
						           AND A.ACP_YR = B.ACP_YR
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[				    
					    ) AS 신규접수,
					
					    /* 국민 처리중 합계 */
					    (SELECT COUNT(*) 
                            FROM TBCSPDCP101M A , 
                                   TBCSPEAR001M B  
                            WHERE 1=1
                                AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+) 
                                AND A.ACP_YR = B.ACP_YR(+)
                                AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
                                AND A.REQ_DVSN_CD = '2'
                                AND A.CVPT_HNDL_STA_CD != '170'
                                AND A.CVPT_WDW_DH IS NULL
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					               ) AS 계,
					
					    /* 국민 입건 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						       WHERE 1=1
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						           AND A.ACP_YR = B.ACP_YR(+)
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						           AND A.REQ_DVSN_CD IN ('2')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '06'     
						            THEN 1 
						            ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '06' 
						                        THEN 1 ELSE 0 END
						            END = 1
						            AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 입건 ,
					
					    /* 국민 불문 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B                                                                          
						        WHERE 1=1 
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
						           AND A.ACP_YR = B.ACP_YR
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
						           AND A.REQ_DVSN_CD IN ('2')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '07'     
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '07' 
						                            THEN 1 ELSE 0 END
						                END = 1 
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 불문 ,
					
					    /* 국민 기각 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						       WHERE 1=1
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						           AND A.ACP_YR = B.ACP_YR(+)
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						           AND A.REQ_DVSN_CD IN ('2')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '02'     
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '02' 
						                            THEN 1 ELSE 0 END
						                END = 1
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 기각 ,
					
					    /* 국민 각하 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						       WHERE 1=1
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						           AND A.ACP_YR = B.ACP_YR(+)
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						           AND A.REQ_DVSN_CD IN ('2')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '03'      
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '03' 
						                            THEN 1 ELSE 0 END
						                END = 1
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 각하 ,
					
					    /* 국민 기각/각하 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						       WHERE 1=1
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						           AND A.ACP_YR = B.ACP_YR(+)
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						           AND A.REQ_DVSN_CD IN ('2')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '04'     
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '04'  
						                            THEN 1 ELSE 0 END
						                END = 1
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 기각각하 ,
					
					    /* 국민 취하 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						        WHERE 1=1
						          AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						          AND A.ACP_YR = B.ACP_YR(+)
						          AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						          AND A.REQ_DVSN_CD IN ('2')
						          AND (A.CVPT_WDW_DH IS NOT NULL OR AUD_RSLT_CD = '08') 
						          AND TO_CHAR(A.CVPT_WDW_DH, 'YYYY') = TO_CHAR(SYSDATE, 'YYYY')
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 취하 ,
					
					    /* 국민 이첩 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						        WHERE 1=1
						          AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
						          AND A.ACP_YR = B.ACP_YR
						          AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
						           AND A.REQ_DVSN_CD IN ('2')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '05'     
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '05'
						                            THEN 1 ELSE 0 END
						                END = 1
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 이첩
					
					
					    FROM DUAL
					
					    UNION ALL                  
					
					    SELECT
					
					    '3' AS DVSN_CD,--'공익' AS DVSN_NM,
						/* 공익 이월 */
						(SELECT COUNT(*)
					      FROM TBCSPDCP101M A ,
					           TBCSPEAR001M B 
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)     
					       AND A.ACP_YR = B.ACP_YR(+)
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
					       AND A.REQ_DVSN_CD IN ('3')          
					       AND A.ACP_YR < TO_CHAR(SYSDATE, 'YYYY')  
					       AND (    A.CVPT_HNDL_STA_CD != '170'                
					            OR                                             
					                (B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')      
					                 OR B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')    
					                 OR TO_CHAR(A.CVPT_WDW_DH, 'YYYY') = TO_CHAR(SYSDATE, 'YYYY') 
					                )
					            )
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
						) AS 이월,
					
					    /* 공익 신규접수 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B 
						        WHERE A.REQ_DVSN_CD IN ('3') 
						           AND A.ACP_YR = TO_CHAR(SYSDATE, 'YYYY') 
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
						           AND A.ACP_YR = B.ACP_YR
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 신규접수,
					
					    /* 공익 처리중 합계 */
					    (SELECT COUNT(*) 
                            FROM TBCSPDCP101M A , 
                                   TBCSPEAR001M B  
                            WHERE 1=1
                                AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+) 
                                AND A.ACP_YR = B.ACP_YR(+)
                                AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
                                AND A.REQ_DVSN_CD IN ('3') 
                                AND A.CVPT_HNDL_STA_CD != '170'
                                AND A.CVPT_WDW_DH IS NULL
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					               ) AS 계,
					
					    /* 공익 입건 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						       WHERE 1=1
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						           AND A.ACP_YR = B.ACP_YR(+)
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						           AND A.REQ_DVSN_CD IN ('3')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '06'     
						            THEN 1 
						            ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '06' 
						                        THEN 1 ELSE 0 END
						            END = 1
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 입건 ,
					
					    /* 공익 불문 */
					
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B                                                                          
						        WHERE 1=1 
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
						           AND A.ACP_YR = B.ACP_YR
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
						           AND A.REQ_DVSN_CD IN ('3')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '07'     
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '07' 
						                            THEN 1 ELSE 0 END
						                END = 1 
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 불문 ,
					
					    /* 공익 기각 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						       WHERE 1=1
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						           AND A.ACP_YR = B.ACP_YR(+)
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						           AND A.REQ_DVSN_CD IN ('3')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '02'     
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '02' 
						                            THEN 1 ELSE 0 END
						                END = 1
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 기각 ,
					
					    /* 공익 각하 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						       WHERE 1=1
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						           AND A.ACP_YR = B.ACP_YR(+)
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						           AND A.REQ_DVSN_CD IN ('3')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '03'      
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '03' 
						                            THEN 1 ELSE 0 END
						                END = 1
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 각하 ,
					
					    /* 공익 기각/각하 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						       WHERE 1=1
						           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						           AND A.ACP_YR = B.ACP_YR(+)
						           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						           AND A.REQ_DVSN_CD IN ('3')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '04'     
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '04'  
						                            THEN 1 ELSE 0 END
						                END = 1
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 기각각하 ,
					
					    /* 공익 취하 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						        WHERE 1=1
						          AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
						          AND A.ACP_YR = B.ACP_YR(+)
						          AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						          AND A.REQ_DVSN_CD IN ('3')
						          AND (A.CVPT_WDW_DH IS NOT NULL OR AUD_RSLT_CD = '08') 
						          AND TO_CHAR(A.CVPT_WDW_DH, 'YYYY') = TO_CHAR(SYSDATE, 'YYYY')
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 취하 ,
					
					    /* 공익 이첩 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B
						        WHERE 1=1
						          AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
						          AND A.ACP_YR = B.ACP_YR
						          AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
						           AND A.REQ_DVSN_CD IN ('3')
						           AND CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.AUD_RSLT_CD = '05'     
						                THEN 1 
						                ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND B.REQ_EXAM_RSLT_CD = '05'
						                            THEN 1 ELSE 0 END
						                END = 1
					               AND A.CVPT_HNDL_STA_CD = '170'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 이첩
					
					    FROM DUAL
					
					    )
					) 
					SELECT NVL(DVSN_CD,0) AS DVSN_CD,DECODE(DVSN_CD,'2','국민','3','공익','계') AS DVSN_NM, SUM(ACP_CNT_ALL) AS ACP_CNT_ALL,SUM(L_ACP_CNT) AS L_ACP_CNT,SUM(N_ACP_CNT) AS N_ACP_CNT,SUM(EXAM_CNT) AS EXAM_CNT
					,SUM(COM_CNT_ALL) AS COM_CNT_ALL 
					,SUM(CNT11) AS CNT11,SUM(CNT12) AS CNT12,SUM(CNT13) AS CNT13,SUM(CNT14) AS CNT14,SUM(CNT15) AS CNT15,SUM(CNT16) AS CNT16,SUM(CNT17) AS CNT17 FROM BASE GROUP BY ROLLUP(DVSN_CD)
					
					ORDER BY DVSN_CD ASC
				

			   ]]>
        </select>

        <select id="selectEarSituExamList" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectEarSituExamList*/
        <![CDATA[
				WITH BASE AS (SELECT 
					 DVSN_CD
					-- DVSN_NM,
					 ,실시여부검토 AS CNT2
					 ,감사실시확정 AS CNT3
					 ,실지감사 AS CNT4
					 ,종료보고 AS CNT5
					 ,과장 AS CNT6
					 ,국장 AS CNT7
					 ,본부장 AS CNT8
					 ,총장 AS CNT9
					 ,부의대기등 AS CNT10
					 ,실시여부검토+감사실시확정+실지감사+종료보고+과장+국장+총장+본부장+부의대기등 AS EXAM_CNT /*계*/
					FROM (
					
					    SELECT
					
					    '2' AS DVSN_CD, --'국민' AS DVSN_NM,
						
					
					    /* 국민 처리중 합계 */
					    (SELECT COUNT(*) 
                            FROM TBCSPDCP101M A , 
                                   TBCSPEAR001M B  
                            WHERE 1=1
                                AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+) 
                                AND A.ACP_YR = B.ACP_YR(+)
                                AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
                                AND A.REQ_DVSN_CD = '2'
                                AND A.CVPT_HNDL_STA_CD != '170'
                                AND A.CVPT_WDW_DH IS NULL
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					               ) AS 계,
					
					    /* 국민 실시여부검토 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A , 
						           TBCSPEAR001M B   
						    WHERE 1=1
						        AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+) 
						        AND A.ACP_YR = B.ACP_YR(+)
						        AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						        AND A.REQ_DVSN_CD IN ('2') 
						        AND A.CVPT_HNDL_STA_CD != '170'
						        AND A.CVPT_WDW_DH IS NULL   
						        AND (B.PREI_APV_DT IS NULL OR B.EXAM_RPT_APV_DT IS NULL OR (B.REQ_EXAM_RSLT_CD IS NULL OR B.REQ_EXAM_RSLT_CD != '01')
						                  OR (SELECT COUNT(*) FROM TBCSPDCP603M                                         
						                                        WHERE REQ_DVSN_CD = A.REQ_DVSN_CD AND ACP_YR = A.ACP_YR AND CVPT_ACP_NO = A.CVPT_ACP_NO 
						                                            AND RPRT_CD IN ('C10220100','C10330100','A10300100') AND APV_STA_CD = '30') < 1 )
						        AND (
						               CASE WHEN (SELECT COUNT(*)
						                      FROM TBBADDED030L D2, 
						                           TBBADDED001M D3,
						                           TBBADDED003M D4
						                     WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD
						                       AND D2.TSK_KEY1 = A.ACP_YR
						                       AND D2.TSK_KEY3 = A.CVPT_ACP_NO
						                       AND D3.AUD_YR = D2.AUD_YR
						                       AND D3.AUD_NO = D2.AUD_NO
						                       AND D3.AUD_YR = D4.AUD_YR
						                       AND D3.AUD_NO = D4.AUD_NO
						                       AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5') < 1 
						               THEN 1
						               ELSE CASE WHEN (SELECT COUNT(*) FROM TBBADDED030L C, TBBADDED103M D
			                                                   WHERE C.TSK_KEY2 = A.REQ_DVSN_CD
			                                                   AND C.TSK_KEY1 = A.ACP_YR
			                                                   AND C.TSK_KEY3 = A.CVPT_ACP_NO
			                                                   AND D.AUD_YR = C.AUD_YR
			                                                   AND D.AUD_NO = C.AUD_NO
			                                                   AND D.AUD_STEP_CD = 'A1030' 
			                                                   AND D.RPRT_CD = 'A10300100'
			                                                   AND D.APV_STA_CD = '30') < 1
						                          THEN 1 ELSE 0 END
						               END = 1
						            )
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 실시여부검토,
					
					    /* 국민 감사실시확정 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A ,
					           TBCSPEAR001M B 
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+) 
					       AND A.ACP_YR = B.ACP_YR(+)
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
					       AND A.REQ_DVSN_CD IN ('2')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND B.AUD_RSLT_RPL_DT IS NULL    
					       AND (B.REQ_EXAM_RSLT_CD = '01' OR B.EXAM_RPT_APV_DT IS NOT NULL)
					       AND (CASE WHEN 
					                (SELECT COUNT(*)
					                  FROM TBBADDED030L D2,
					                       TBBADDED001M D3, 
					                       TBBADDED003M D4  
					                 WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD 
					                   AND D2.TSK_KEY1 = A.ACP_YR
					                   AND D2.TSK_KEY3 = A.CVPT_ACP_NO
					                   AND D3.AUD_YR = D2.AUD_YR
					                   AND D3.AUD_NO = D2.AUD_NO
					                   AND D3.AUD_YR = D4.AUD_YR
					                   AND D3.AUD_NO = D4.AUD_NO
					                   AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5'
					               ) < 1  
					            THEN CASE WHEN B.REQ_EXAM_RSLT_CD = '01'      
					                       AND (SELECT COUNT(*) FROM TBCSPDCP603M                                         
					                                        WHERE REQ_DVSN_CD = A.REQ_DVSN_CD AND ACP_YR = A.ACP_YR AND CVPT_ACP_NO = A.CVPT_ACP_NO 
					                                            AND RPRT_CD IN ('C10220100','C10330100','A10300100') AND APV_STA_CD = '30') > 0
					                    THEN 1 ELSE 0 END 
					            ELSE CASE WHEN (TO_CHAR(SYSDATE, 'YYYYMMDD') < (SELECT MAX(FLD_AUD_STR_DT)
					                                                              FROM TBBADDED030L D2, 
					                                                                   TBBADDED001M D3,
					                                                                   TBBADDED003M D4  
					                                                             WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD 
					                                                               AND D2.TSK_KEY1 = A.ACP_YR
					                                                               AND D2.TSK_KEY3 = A.CVPT_ACP_NO
					                                                               AND D3.AUD_YR = D2.AUD_YR
					                                                               AND D3.AUD_NO = D2.AUD_NO
					                                                               AND D3.AUD_YR = D4.AUD_YR
					                                                               AND D3.AUD_NO = D4.AUD_NO
					                                                               AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5'
					                                                           )
					                               OR (SELECT COUNT(*) FROM TBBADDED030L C, TBBADDED103M D
					                                   WHERE C.TSK_KEY2 = A.REQ_DVSN_CD
					                                   AND C.TSK_KEY1 = A.ACP_YR
					                                   AND C.TSK_KEY3 = A.CVPT_ACP_NO
					                                   AND D.AUD_YR = C.AUD_YR
					                                   AND D.AUD_NO = C.AUD_NO
					                                   AND D.AUD_STEP_CD = 'A1030' 
					                                   AND D.RPRT_CD = 'A10300100'
					                                   AND D.APV_STA_CD = '30') = 0
					                              )
					                    THEN 1 ELSE 0 END
					            END = 1 
					        )
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 감사실시확정,
					
					    /* 국민 실지감사 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A , 
					           TBCSPEAR001M B , 
					           TBBADDED030L C , 
					           TBBADDED001M D , 
					           TBBADDED003M E   
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD    
					       AND A.ACP_YR = B.ACP_YR
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
					       AND C.TSK_KEY2 = A.REQ_DVSN_CD   
					       AND C.TSK_KEY1 = A.ACP_YR
					       AND C.TSK_KEY3 = A.CVPT_ACP_NO
					       AND D.AUD_YR = C.AUD_YR
					       AND D.AUD_NO = C.AUD_NO
					       AND D.AUD_YR = E.AUD_YR 
					       AND D.AUD_NO = E.AUD_NO           
					       AND A.REQ_DVSN_CD IN ('2')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL       
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'
					       AND E.FLD_AUD_STR_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD')
					       AND (SELECT COUNT(DOC_ID) FROM TBBADDED103M WHERE AUD_YR = D.AUD_YR AND AUD_NO = D.AUD_NO AND RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050' AND (RPRT_NM LIKE '%종료%' OR RPRT_CD IN ('A10500200', 'A10500210'))) = 0
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					         ) AS 실지감사,
					
					    /* 국민 종료보고 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A , 
					           TBCSPEAR001M B , 
					           TBBADDED030L C , 
					           TBBADDED001M D , 
					           TBBADDED003M E   
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
					       AND A.ACP_YR = B.ACP_YR
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
					       AND C.TSK_KEY2 = A.REQ_DVSN_CD
					       AND C.TSK_KEY1 = A.ACP_YR
					       AND C.TSK_KEY3 = A.CVPT_ACP_NO
					       AND D.AUD_YR = C.AUD_YR
					       AND D.AUD_NO = C.AUD_NO
					       AND D.AUD_YR = E.AUD_YR
					       AND D.AUD_NO = E.AUD_NO
					       AND A.REQ_DVSN_CD IN ('2')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'                                           
					       AND E.FLD_AUD_STR_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD')                         
					       AND ((SELECT COUNT(*) FROM TBBADDED103M WHERE AUD_YR = D.AUD_YR AND AUD_NO = D.AUD_NO                
					           AND RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050' AND (RPRT_NM LIKE '%종료%' OR RPRT_CD IN ('A10500200', 'A10500210')) AND APV_STA_CD != '30'
					        ) > 0 
					       )
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 종료보고,
					
					    /* 국민 과장 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
						      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050') F 
						      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') G
						     WHERE 1=1
						       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
						       AND A.ACP_YR = B.ACP_YR
						       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
						       AND C.TSK_KEY2 = A.REQ_DVSN_CD
						       AND C.TSK_KEY1 = A.ACP_YR
						       AND C.TSK_KEY3 = A.CVPT_ACP_NO
						       AND D.AUD_YR = C.AUD_YR
						       AND D.AUD_NO = C.AUD_NO
						       AND D.AUD_YR = E.AUD_YR(+)
						       AND D.AUD_NO = E.AUD_NO(+)
						       AND E.AUD_YR = F.AUD_YR(+)
						       AND E.AUD_NO = F.AUD_NO(+)
						       AND E.AUD_YR = G.AUD_YR(+)                   
						       AND E.AUD_NO = G.AUD_NO(+)
						       AND A.REQ_DVSN_CD IN ('2')  
						       AND A.CVPT_HNDL_STA_CD != '170'
						       AND A.CVPT_WDW_DH IS NULL        
						       AND B.AUD_RSLT_CD IS NULL                   
						       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'    
						       AND D.PRSS_STEP_CD = 'A1060'                                        
						       AND ((SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = G.APV_RQS_ID AND APV_DH IS NULL) = '0013600' 
						            OR (
						                G.APV_RQS_ID IS NULL                                                                                  
						                AND (SELECT COUNT(*) FROM TBDCMACM023L WHERE APV_DOC_NO = F.APV_RQS_ID                                
						                            AND APVR_PST_CD IN ('0045900','0055600') AND APVR_STA_CD = '203') < 1 
						                AND D.PRSS_STEP_CD = 'A1060'  
						               )            
						           )
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					     ) AS 과장,
					
					    /* 국민 국장 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
						      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') F 
						     WHERE 1=1
						       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
						       AND A.ACP_YR = B.ACP_YR
						       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
						       AND C.TSK_KEY2 = A.REQ_DVSN_CD
						       AND C.TSK_KEY1 = A.ACP_YR
						       AND C.TSK_KEY3 = A.CVPT_ACP_NO
						       AND D.AUD_YR = C.AUD_YR
						       AND D.AUD_NO = C.AUD_NO
						       AND D.AUD_YR = E.AUD_YR
						       AND D.AUD_NO = E.AUD_NO
						       AND E.AUD_YR = F.AUD_YR
						       AND E.AUD_NO = F.AUD_NO
						       AND A.REQ_DVSN_CD IN ('2')  
						       AND A.CVPT_HNDL_STA_CD != '170'
						       AND A.CVPT_WDW_DH IS NULL        
						       AND B.AUD_RSLT_CD IS NULL    
						       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5' 
						       AND (SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = F.APV_RQS_ID AND APV_DH IS NULL) = '0015800' 
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					     ) AS 국장,   
					
					    /* 국민 본부장 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
					      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') F 
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
					       AND A.ACP_YR = B.ACP_YR
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
					       AND C.TSK_KEY2 = A.REQ_DVSN_CD
					       AND C.TSK_KEY1 = A.ACP_YR
					       AND C.TSK_KEY3 = A.CVPT_ACP_NO
					       AND D.AUD_YR = C.AUD_YR
					       AND D.AUD_NO = C.AUD_NO
					       AND D.AUD_YR = E.AUD_YR
					       AND D.AUD_NO = E.AUD_NO
					       AND E.AUD_YR = F.AUD_YR
					       AND E.AUD_NO = F.AUD_NO
					       AND A.REQ_DVSN_CD IN ('2')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND B.AUD_RSLT_CD IS NULL       
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5' 
					       AND (SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = F.APV_RQS_ID AND APV_DH IS NULL) IN ('0045900','0055600') 
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 본부장,
					
					    /* 국민 총장 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
					      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') F 
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
					       AND A.ACP_YR = B.ACP_YR
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
					       AND C.TSK_KEY2 = A.REQ_DVSN_CD
					       AND C.TSK_KEY1 = A.ACP_YR
					       AND C.TSK_KEY3 = A.CVPT_ACP_NO
					       AND D.AUD_YR = C.AUD_YR
					       AND D.AUD_NO = C.AUD_NO
					       AND D.AUD_YR = E.AUD_YR
					       AND D.AUD_NO = E.AUD_NO
					       AND E.AUD_YR = F.AUD_YR
					       AND E.AUD_NO = F.AUD_NO
					       AND A.REQ_DVSN_CD IN ('2')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND B.AUD_RSLT_CD IS NULL    
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5' 
					       AND (SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = F.APV_RQS_ID AND APV_DH IS NULL) = '0055700' 
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 총장,
					                       
					    /* 국민 부의대기등 */
					    (SELECT COUNT(*)
						  FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
						     WHERE 1=1
						       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
						       AND A.ACP_YR = B.ACP_YR
						       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
						       AND C.TSK_KEY2 = A.REQ_DVSN_CD
						       AND C.TSK_KEY1 = A.ACP_YR
						       AND C.TSK_KEY3 = A.CVPT_ACP_NO
						       AND D.AUD_YR = C.AUD_YR
						       AND D.AUD_NO = C.AUD_NO
						       AND D.AUD_YR = E.AUD_YR
						       AND D.AUD_NO = E.AUD_NO
						       AND A.REQ_DVSN_CD IN ('2') 
						       AND A.CVPT_HNDL_STA_CD != '170'
						       AND A.CVPT_WDW_DH IS NULL        
						       AND (B.AUD_RSLT_CD IS NULL OR B.AUD_RSLT_RPL_DT IS NULL)
						       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5' 
						       AND D.PRSS_STEP_CD IN ('A1070','A1080')   
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 부의대기등
					
					
					    FROM DUAL
					
					    UNION ALL                  
					
					    SELECT
					
					    '3' AS DVSN_CD,--'공익' AS DVSN_NM,
					
					    /* 공익 처리중 합계 */
					    (SELECT COUNT(*) 
                            FROM TBCSPDCP101M A , 
                                   TBCSPEAR001M B  
                            WHERE 1=1
                                AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+) 
                                AND A.ACP_YR = B.ACP_YR(+)
                                AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
                                AND A.REQ_DVSN_CD IN ('3') 
                                AND A.CVPT_HNDL_STA_CD != '170'
                                AND A.CVPT_WDW_DH IS NULL
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					               ) AS 계,
					
					    /* 공익 실시여부검토 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A , 
						           TBCSPEAR001M B   
						    WHERE 1=1
						        AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+) 
						        AND A.ACP_YR = B.ACP_YR(+)
						        AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
						        AND A.REQ_DVSN_CD IN ('3') 
						        AND A.CVPT_HNDL_STA_CD != '170'
						        AND A.CVPT_WDW_DH IS NULL   
						        AND (B.PREI_APV_DT IS NULL OR B.EXAM_RPT_APV_DT IS NULL OR (B.REQ_EXAM_RSLT_CD IS NULL OR B.REQ_EXAM_RSLT_CD != '01')
						                  OR (SELECT COUNT(*) FROM TBCSPDCP603M                                         
						                                        WHERE REQ_DVSN_CD = A.REQ_DVSN_CD AND ACP_YR = A.ACP_YR AND CVPT_ACP_NO = A.CVPT_ACP_NO 
						                                            AND RPRT_CD IN ('C10220100','C10330100','A10300100') AND APV_STA_CD = '30') < 1 )
						        AND (
						               CASE WHEN (SELECT COUNT(*)
						                      FROM TBBADDED030L D2, 
						                           TBBADDED001M D3,
						                           TBBADDED003M D4
						                     WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD
						                       AND D2.TSK_KEY1 = A.ACP_YR
						                       AND D2.TSK_KEY3 = A.CVPT_ACP_NO
						                       AND D3.AUD_YR = D2.AUD_YR
						                       AND D3.AUD_NO = D2.AUD_NO
						                       AND D3.AUD_YR = D4.AUD_YR
						                       AND D3.AUD_NO = D4.AUD_NO
						                       AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5') < 1 
						               THEN 1
						               ELSE CASE WHEN (SELECT COUNT(*) FROM TBBADDED030L C, TBBADDED103M D
			                                                   WHERE C.TSK_KEY2 = A.REQ_DVSN_CD
			                                                   AND C.TSK_KEY1 = A.ACP_YR
			                                                   AND C.TSK_KEY3 = A.CVPT_ACP_NO
			                                                   AND D.AUD_YR = C.AUD_YR
			                                                   AND D.AUD_NO = C.AUD_NO
			                                                   AND D.AUD_STEP_CD = 'A1030' 
			                                                   AND D.RPRT_CD = 'A10300100'
			                                                   AND D.APV_STA_CD = '30') < 1
						                          THEN 1 ELSE 0 END
						               END = 1
						            ) 
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[				               
					    ) AS 실시여부검토,
					
					    /* 공익 감사실시확정 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A ,
					           TBCSPEAR001M B 
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+) 
					       AND A.ACP_YR = B.ACP_YR(+)
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
					       AND A.REQ_DVSN_CD IN ('3')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND B.AUD_RSLT_RPL_DT IS NULL    
					       AND (B.REQ_EXAM_RSLT_CD = '01' OR B.EXAM_RPT_APV_DT IS NOT NULL)
					       AND (CASE WHEN 
					                (SELECT COUNT(*)
					                  FROM TBBADDED030L D2,
					                       TBBADDED001M D3, 
					                       TBBADDED003M D4  
					                 WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD 
					                   AND D2.TSK_KEY1 = A.ACP_YR
					                   AND D2.TSK_KEY3 = A.CVPT_ACP_NO
					                   AND D3.AUD_YR = D2.AUD_YR
					                   AND D3.AUD_NO = D2.AUD_NO
					                   AND D3.AUD_YR = D4.AUD_YR
					                   AND D3.AUD_NO = D4.AUD_NO
					                   AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5'
					               ) < 1  
					            THEN CASE WHEN B.REQ_EXAM_RSLT_CD = '01'      
					                       AND (SELECT COUNT(*) FROM TBCSPDCP603M                                         
					                                        WHERE REQ_DVSN_CD = A.REQ_DVSN_CD AND ACP_YR = A.ACP_YR AND CVPT_ACP_NO = A.CVPT_ACP_NO 
					                                            AND RPRT_CD IN ('C10220100','C10330100','A10300100') AND APV_STA_CD = '30') > 0
					                    THEN 1 ELSE 0 END 
					            ELSE CASE WHEN (TO_CHAR(SYSDATE, 'YYYYMMDD') < (SELECT MAX(FLD_AUD_STR_DT)
					                                                              FROM TBBADDED030L D2, 
					                                                                   TBBADDED001M D3,
					                                                                   TBBADDED003M D4  
					                                                             WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD 
					                                                               AND D2.TSK_KEY1 = A.ACP_YR
					                                                               AND D2.TSK_KEY3 = A.CVPT_ACP_NO
					                                                               AND D3.AUD_YR = D2.AUD_YR
					                                                               AND D3.AUD_NO = D2.AUD_NO
					                                                               AND D3.AUD_YR = D4.AUD_YR
					                                                               AND D3.AUD_NO = D4.AUD_NO
					                                                               AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5'
					                                                           )
					                               OR (SELECT COUNT(*) FROM TBBADDED030L C, TBBADDED103M D
					                                   WHERE C.TSK_KEY2 = A.REQ_DVSN_CD
					                                   AND C.TSK_KEY1 = A.ACP_YR
					                                   AND C.TSK_KEY3 = A.CVPT_ACP_NO
					                                   AND D.AUD_YR = C.AUD_YR
					                                   AND D.AUD_NO = C.AUD_NO
					                                   AND D.AUD_STEP_CD = 'A1030' 
					                                   AND D.RPRT_CD = 'A10300100'
					                                   AND D.APV_STA_CD = '30') = 0
					                              )
					                    THEN 1 ELSE 0 END
					            END = 1 
					        )   
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[				               
					    ) AS 감사실시확정,
					
					    /* 공익 실지감사 */
					    (SELECT COUNT(*)
      FROM TBCSPDCP101M A , 
           TBCSPEAR001M B , 
           TBBADDED030L C , 
           TBBADDED001M D , 
           TBBADDED003M E   
     WHERE 1=1
       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD    
       AND A.ACP_YR = B.ACP_YR
       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
       AND C.TSK_KEY2 = A.REQ_DVSN_CD   
       AND C.TSK_KEY1 = A.ACP_YR
       AND C.TSK_KEY3 = A.CVPT_ACP_NO
       AND D.AUD_YR = C.AUD_YR
       AND D.AUD_NO = C.AUD_NO
       AND D.AUD_YR = E.AUD_YR 
       AND D.AUD_NO = E.AUD_NO           
       AND A.REQ_DVSN_CD IN ('3')  
       AND A.CVPT_HNDL_STA_CD != '170'
       AND A.CVPT_WDW_DH IS NULL       
       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'
       AND E.FLD_AUD_STR_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD')
       AND (SELECT COUNT(DOC_ID) FROM TBBADDED103M WHERE AUD_YR = D.AUD_YR AND AUD_NO = D.AUD_NO AND RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050' 
       			AND (RPRT_NM LIKE '%종료%' OR RPRT_CD IN ('A10500200', 'A10500210'))) = 0
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					         ) AS 실지감사,
					
					    /* 공익 종료보고 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A , 
					           TBCSPEAR001M B , 
					           TBBADDED030L C , 
					           TBBADDED001M D , 
					           TBBADDED003M E   
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
					       AND A.ACP_YR = B.ACP_YR
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
					       AND C.TSK_KEY2 = A.REQ_DVSN_CD
					       AND C.TSK_KEY1 = A.ACP_YR
					       AND C.TSK_KEY3 = A.CVPT_ACP_NO
					       AND D.AUD_YR = C.AUD_YR
					       AND D.AUD_NO = C.AUD_NO
					       AND D.AUD_YR = E.AUD_YR
					       AND D.AUD_NO = E.AUD_NO
					       AND A.REQ_DVSN_CD IN ('3')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'                                           
					       AND E.FLD_AUD_STR_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD')                         
					       AND ((SELECT COUNT(*) FROM TBBADDED103M WHERE AUD_YR = D.AUD_YR AND AUD_NO = D.AUD_NO                
					           AND RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050' AND (RPRT_NM LIKE '%종료%' OR RPRT_CD IN ('A10500200', 'A10500210')) AND APV_STA_CD != '30'
					        ) > 0 
					       )  
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 종료보고,
					
					    /* 공익 과장 */
					    (SELECT COUNT(*)
						    FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
						      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050') F 
						      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') G
						     WHERE 1=1
						       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
						       AND A.ACP_YR = B.ACP_YR
						       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
						       AND C.TSK_KEY2 = A.REQ_DVSN_CD
						       AND C.TSK_KEY1 = A.ACP_YR
						       AND C.TSK_KEY3 = A.CVPT_ACP_NO
						       AND D.AUD_YR = C.AUD_YR
						       AND D.AUD_NO = C.AUD_NO
						       AND D.AUD_YR = E.AUD_YR(+)
						       AND D.AUD_NO = E.AUD_NO(+)
						       AND E.AUD_YR = F.AUD_YR(+)
						       AND E.AUD_NO = F.AUD_NO(+)
						       AND E.AUD_YR = G.AUD_YR(+)                   
						       AND E.AUD_NO = G.AUD_NO(+)
						       AND A.REQ_DVSN_CD IN ('3')  
						       AND A.CVPT_HNDL_STA_CD != '170'
						       AND A.CVPT_WDW_DH IS NULL        
						       AND B.AUD_RSLT_CD IS NULL                   
						       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'    
						       AND D.PRSS_STEP_CD = 'A1060'                                        
						       AND ((SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = G.APV_RQS_ID AND APV_DH IS NULL) = '0013600' 
						            OR (
						                G.APV_RQS_ID IS NULL                                                                                  
						                AND (SELECT COUNT(*) FROM TBDCMACM023L WHERE APV_DOC_NO = F.APV_RQS_ID                                
						                            AND APVR_PST_CD IN ('0045900','0055600') AND APVR_STA_CD = '203') < 1 
						                AND D.PRSS_STEP_CD = 'A1060'  
						               )            
						           )
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					     ) AS 과장,
					                       
					    /* 공익 국장 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
					      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') F 
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
					       AND A.ACP_YR = B.ACP_YR
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
					       AND C.TSK_KEY2 = A.REQ_DVSN_CD
					       AND C.TSK_KEY1 = A.ACP_YR
					       AND C.TSK_KEY3 = A.CVPT_ACP_NO
					       AND D.AUD_YR = C.AUD_YR
					       AND D.AUD_NO = C.AUD_NO
					       AND D.AUD_YR = E.AUD_YR
					       AND D.AUD_NO = E.AUD_NO
					       AND E.AUD_YR = F.AUD_YR
					       AND E.AUD_NO = F.AUD_NO
					       AND A.REQ_DVSN_CD IN ('3')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND B.AUD_RSLT_CD IS NULL    
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5' 
					       AND (SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = F.APV_RQS_ID AND APV_DH IS NULL) = '0015800'
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					     ) AS 국장,                   
					
					    /* 공익 본부장 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
					      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') F 
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
					       AND A.ACP_YR = B.ACP_YR
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
					       AND C.TSK_KEY2 = A.REQ_DVSN_CD
					       AND C.TSK_KEY1 = A.ACP_YR
					       AND C.TSK_KEY3 = A.CVPT_ACP_NO
					       AND D.AUD_YR = C.AUD_YR
					       AND D.AUD_NO = C.AUD_NO
					       AND D.AUD_YR = E.AUD_YR
					       AND D.AUD_NO = E.AUD_NO
					       AND E.AUD_YR = F.AUD_YR
					       AND E.AUD_NO = F.AUD_NO
					       AND A.REQ_DVSN_CD IN ('3')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND B.AUD_RSLT_CD IS NULL       
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5' 
					       AND (SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = F.APV_RQS_ID AND APV_DH IS NULL) IN ('0045900','0055600')
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 본부장,
					
					    /* 공익 총장 */
					    (SELECT COUNT(*)
					      FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
					      , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') F 
					     WHERE 1=1
					       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
					       AND A.ACP_YR = B.ACP_YR
					       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
					       AND C.TSK_KEY2 = A.REQ_DVSN_CD
					       AND C.TSK_KEY1 = A.ACP_YR
					       AND C.TSK_KEY3 = A.CVPT_ACP_NO
					       AND D.AUD_YR = C.AUD_YR
					       AND D.AUD_NO = C.AUD_NO
					       AND D.AUD_YR = E.AUD_YR
					       AND D.AUD_NO = E.AUD_NO
					       AND E.AUD_YR = F.AUD_YR
					       AND E.AUD_NO = F.AUD_NO
					       AND A.REQ_DVSN_CD IN ('3')  
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND B.AUD_RSLT_CD IS NULL    
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5' 
					       AND (SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = F.APV_RQS_ID AND APV_DH IS NULL) = '0055700' 
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 총장,
					
					    /* 공익 부의대기등 */
					    (SELECT COUNT(*)
						  FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E 
						     WHERE 1=1
						       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
						       AND A.ACP_YR = B.ACP_YR
						       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
						       AND C.TSK_KEY2 = A.REQ_DVSN_CD
						       AND C.TSK_KEY1 = A.ACP_YR
						       AND C.TSK_KEY3 = A.CVPT_ACP_NO
						       AND D.AUD_YR = C.AUD_YR
						       AND D.AUD_NO = C.AUD_NO
						       AND D.AUD_YR = E.AUD_YR
						       AND D.AUD_NO = E.AUD_NO
						       AND A.REQ_DVSN_CD IN ('3') 
						       AND A.CVPT_HNDL_STA_CD != '170'
						       AND A.CVPT_WDW_DH IS NULL        
						       AND (B.AUD_RSLT_CD IS NULL OR B.AUD_RSLT_RPL_DT IS NULL)
						       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5' 
						       AND D.PRSS_STEP_CD IN ('A1070','A1080')   
	 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
	 			<![CDATA[
					    ) AS 부의대기등
					
					
					
					    FROM DUAL
					
					    )
					)
					SELECT NVL(DVSN_CD,0) AS DVSN_CD,DECODE(DVSN_CD,'2','국민','3','공익','계') AS DVSN_NM,SUM(EXAM_CNT) AS EXAM_CNT
					,SUM(CNT2) AS CNT2,SUM(CNT3) AS CNT3,SUM(CNT4) AS CNT4,SUM(CNT5) AS CNT5,SUM(CNT6) AS CNT6,SUM(CNT7) AS CNT7,SUM(CNT8) AS CNT8,SUM(CNT9) AS CNT9,SUM(CNT10) AS CNT10
					FROM BASE GROUP BY ROLLUP(DVSN_CD)
					
					ORDER BY DVSN_CD ASC
				

			   ]]>
        </select>

        <select id="selectEarSituList2" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectEarSituList2*/
	<![CDATA[
		WITH BASE AS 
							(
							
							    SELECT	 A.REQ_DVSN_CD
							            ,TO_CHAR(B.ACP_DH, 'YYYY-MM-DD')                                  AS ACP_DH
							            ,TO_CHAR(SYSDATE,'YYYY-MM-DD')                                    AS CURENT_DT
							            ,TO_CHAR(TO_DATE(A.EXAM_RPT_APV_DT),'YYYY-MM-DD')               AS PRC_DT
							            ,CASE WHEN A.AUD_RSLT_RPL_DT IS NOT NULL THEN A.AUD_RSLT_RPL_DT
							                  ELSE TO_CHAR(B.CVPT_WDW_DH,'YYYY-MM-DD')
							              END                                                           AS PRC_DT2
							            ,CASE WHEN A.REQ_DVSN_CD = '2'
				                            THEN TO_CHAR(B.ACP_DH+30+ F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YYYY-MM-DD')
				                        	ELSE TO_CHAR(ADD_MONTHS(B.ACP_DH ,1)+ F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YYYY-MM-DD') 
							            END AS RULE_ST_DT
                                        ,A.FNL_MDF_DH 
                                        ,TO_CHAR(TO_DATE(A.AUD_RSLT_RPL_DT),'YYYY') AS AUD_RSLT_RPL_DT
							        FROM TBCSPEAR001M A
							            ,TBCSPDCP101M B
							            ,(SELECT sum(nvl(AUD_DCN,0)) BZT_DCN, D.TSK_KEY1 , D.TSK_KEY2, D.TSK_KEY3
							                    FROM TBBADDED001M A
							                    LEFT OUTER JOIN TBBADDED101L B
							                            ON A.AUD_YR = B.AUD_YR
							                           AND A.AUD_NO = B.AUD_NO
							                           AND B.AUD_STEP_CD != 'A1030'                          
							                    INNER JOIN TBBADDED002M C
							                            ON A.AUD_YR  = C.REL_AUD_YR
							                           AND A.AUD_NO = C.REL_AUD_NO
							                    INNER JOIN TBBADDED030L D ON A.AUD_YR = D.AUD_YR AND A.AUD_NO = D.AUD_NO  
							                    LEFT OUTER JOIN TBCSPDCP101M E
                                ON D.TSK_KEY1 = E.ACP_YR
                                AND D.TSK_KEY2 = E.REQ_DVSN_CD
                                AND D.TSK_KEY3 = E.CVPT_ACP_NO
                        LEFT OUTER JOIN TBCSPEAR001M F
                                ON E.ACP_YR = F.ACP_YR
                                AND E.REQ_DVSN_CD = F.REQ_DVSN_CD
                                AND E.CVPT_ACP_NO = F.CVPT_ACP_NO
                        WHERE 
                             NVL(CASE WHEN F.AUD_RSLT_CD = '08' THEN TO_CHAR(E.CVPT_WDW_DH,'YYYY-MM-DD')        
                                ELSE  
                                    CASE WHEN E.REQ_DVSN_CD = '3' 
                                         THEN NVL(TO_CHAR(TO_DATE(F.EXAM_RPT_APV_DT),'YYYY-MM-DD'),( 
                                            SELECT TO_CHAR(MAX(C1.APV_DH),'YYYY-MM-DD') 
                                                FROM TBBADDED030L A1,TBBADDED103M B1, TBDCMACM023L C1
                                                 WHERE A1.TSK_KEY1(+)=E.ACP_YR 
                                                    AND A1.TSK_KEY2(+)=E.REQ_DVSN_CD 
                                                    AND A1.TSK_KEY3(+) =E.CVPT_ACP_NO
                                                    AND A1.AUD_YR=B1.AUD_YR 
                                                    AND A1.AUD_NO=B1.AUD_NO 
                                                    AND B1.APV_RQS_ID = C1.APV_DOC_NO 
                                                    AND B1.RPRT_CD = 'A10300100' 
                                                    AND B1.APV_STA_CD ='30' 
                                            )
                                         )    
                                     ELSE (SELECT TO_CHAR(TO_DATE(MAX(B.CMT_OEN_DT)),'YYYY-MM-DD') 
                                                FROM TBCSPEAR011M A , TBCSPEAR010M B 
                                                    WHERE A.ACP_YR(+) = E.ACP_YR 
                                                        AND A.REQ_DVSN_CD(+) = E.REQ_DVSN_CD  
                                                        AND A.CVPT_ACP_NO(+) = E.CVPT_ACP_NO 
                                                        AND A.CMT_DVSN_CD = B.CMT_DVSN_CD 
                                                        AND A.CMT_OEN_YE = B.CMT_OEN_YE 
                                                        AND A.CMT_DGE = B.CMT_DGE
                                                        AND A.CMT_RSLT_CD != '09'
                                                        )  
                                    END
                                END,'9999-99-99') > TO_CHAR(TO_DATE(C.AUD_STR_DT),'YYYY-MM-DD')
							                    GROUP BY D.TSK_KEY1, D.TSK_KEY2, D.TSK_KEY3 
							                    ) DDD
							       WHERE A.ACP_YR = B.ACP_YR 
							         AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
							         AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
							         AND A.ACP_YR      = DDD.TSK_KEY1(+) 
							         AND A.CVPT_ACP_NO = DDD.TSK_KEY3(+) 
							         AND A.REQ_DVSN_CD = DDD.TSK_KEY2(+) 
							         AND TO_CHAR(TO_DATE(NVL(A.AUD_RSLT_RPL_DT,A.EXAM_RSLT_RPL_DT)),'YYYY') = TO_CHAR(SYSDATE,'YYYY')
							         AND B.CVPT_HNDL_STA_CD = '170'
				 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
				 			<![CDATA[
							), 
							DVSN_T AS 
							    (
							          SELECT '0' AS REQ_DVSN_CD, '계' AS REQ_DVSN_NM FROM DUAL
							          UNION ALL
							          SELECT '2' AS REQ_DVSN_CD, '국민' AS REQ_DVSN_NM  FROM DUAL
							          UNION ALL
							          SELECT '3' AS REQ_DVSN_CD, '공익' AS REQ_DVSN_NM  FROM DUAL  
							    )
							
							SELECT A.REQ_DVSN_NM     AS REQ_DVSN_NM
							      ,NVL(TOT,0)        AS TOT
							      ,NVL(B.DAY_30,0)   AS DAY_30
							      ,NVL(B.RULE_U,0)   AS RULE_U
							      ,NVL(B.RULE_O,0)   AS RULE_O
							      ,NVL(B.AVR,0)      AS AVR
							      ,NVL(B.MAX_DT,0)   AS MAX_DT
							      ,NVL(B.AVR2,0)     AS AVR2
							      ,NVL(B.MAX_DT2,0)  AS MAX_DT2
							  FROM  DVSN_T A 
							       ,(
							           SELECT NVL(REQ_DVSN_CD,0) AS REQ_DVSN_CD
							                  ,SUM(CASE WHEN  (TO_DATE(PRC_DT) - TO_DATE(ACP_DH))  < 30 THEN 1 ELSE 0 END) + 
							                   SUM(CASE WHEN  PRC_DT <= RULE_ST_DT                      THEN 1 ELSE 0 END) + 
							                   SUM(CASE WHEN  PRC_DT >  RULE_ST_DT                      THEN 1 ELSE 0 END)   AS TOT
							                  ,SUM(CASE WHEN  (TO_DATE(PRC_DT) - TO_DATE(ACP_DH))  < 30 THEN 1 ELSE 0 END)   AS DAY_30
							                  ,SUM(CASE WHEN  PRC_DT <= RULE_ST_DT                      THEN 1 ELSE 0 END)   AS RULE_U
							                  ,SUM(CASE WHEN  PRC_DT >  RULE_ST_DT                      THEN 1 ELSE 0 END)   AS RULE_O 
							                  ,ROUND(SUM(TO_DATE(PRC_DT) - TO_DATE(ACP_DH))/COUNT(1))                       AS AVR
							                  ,MAX(TO_DATE(PRC_DT) - TO_DATE(ACP_DH))                                       AS MAX_DT
							                  ,ROUND(SUM(TO_DATE(PRC_DT2) - TO_DATE(ACP_DH))/COUNT(1))                      AS AVR2
							                  ,MAX(TO_DATE(PRC_DT2) - TO_DATE(ACP_DH))                                      AS MAX_DT2
							              FROM BASE A
							             WHERE PRC_DT IS NOT NULL
							             GROUP BY ROLLUP(REQ_DVSN_CD)
							       ) B
							 WHERE 1=1
							   AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
							 ORDER BY A.REQ_DVSN_CD 
         ]]>
	</select>
	
	<select id="selectEarSituList3" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectEarSituList3*/
        <if test= 'AFlag=="5" '>
	 			<![CDATA[
			SELECT * FROM (
				 ]]>
		 </if>
	<![CDATA[
				SELECT DISTINCT A.REQ_DVSN_CD AS DVSN_CD                                            /*구분코드*/
					   
					   ,A.ACP_YR AS ACP_YR
					   ,A.CVPT_ACP_NO AS CVPT_ACP_NO
                       ,(SELECT COUNT(CVPT_ACP_NO)
								   FROM TBCSPDCP601M
								  WHERE ACP_YR = A.ACP_YR
								     AND REQ_DVSN_CD = A.REQ_DVSN_CD
								     AND CVPT_ACP_NO = A.CVPT_ACP_NO) AS PRC_CNT
								     ,F_CODE_NM('1000894', A.DOC_WRIT_KND_CD) AS DOC_TYPE
						,A.CVPT_HNDL_STA_CD AS CVPT_HNDL_STA_CD
						
				       ,F_CODE_NM('1000740',A.REQ_DVSN_CD) AS DVSN_NM                                                            /*구분O*/
				       ,A.ACP_YR ||'-'|| F_CODE_NM('1000740',A.REQ_DVSN_CD) ||'-'|| SUBSTR(A.CVPT_ACP_NO,'3',3) AS ACP_NO   /*청구 접수번호O*/
				       ,(SELECT D.AUD_SBJ_NM ||'('|| F_MNG_KND_AUDYRNO(D.AUD_YR, D.AUD_NO, '', '-') ||')'
				                                      FROM TBBADDED001M
				                                     WHERE AUD_YR = D.AUD_YR
				                                       AND AUD_NO = D.AUD_NO) AS TIT_NM                                     /*제목(감사사항명+감사 접수번호)O*/
				       ,A.TIT_NM AS TIT_NM2                                             /*청구제목*/
       				   ,(SELECT D.AUD_SBJ_NM ||'('|| F_MNG_KND_AUDYRNO(D.AUD_YR, D.AUD_NO, '', '-') ||')'
                                      FROM TBBADDED001M
                                     WHERE AUD_YR = D.AUD_YR
                                       AND AUD_NO = D.AUD_NO) AS ORI_TIT_NM                                                                              /*감사사항명O*/
				       ,F_DPT_INFO(B.HNDL_DPT_CD,'1') AS HNDL_DPT_NM                                                        /*청구담당부서O*/
				       ,B.HNDL_DPT_CD AS HNDL_DPT_CD                                                                        /*담당부서코드O*/       
				       ,F_USR_INFO_BY_ID(B.HNDL_CHGR_ID,'2') AS HNDL_CHGR_NM                                                /*청구담당자O*/
				       
				       ,TO_CHAR(A.ACP_DH,'YY. MM. DD') AS ACP_DH                                                            /*접수일O*/ 
				       , TO_CHAR(TO_DATE(B.EXAM_RPT_APV_DT, 'YYYYMMDD'), 'YY. MM. DD')  AS STR_DT                           /*감사실시결정일O*/ 
				                                                                                   
				                                                                                   
				       ,( 
				       SELECT CASE WHEN REL_AUD_YR || REL_AUD_NO IS NOT NULL
				                            THEN TO_CHAR(TO_DATE(MIN(AUD_STR_DT)), 'YY. MM. DD')||' ~ '||TO_CHAR(TO_DATE(MAX(AUD_END_DT)), 'YY. MM. DD')
				                        ELSE ''
				                    END
				              FROM TBBADDED002M
				             WHERE AUD_BZT_KND_CD = '02'
				               AND REL_AUD_YR || REL_AUD_NO = D.AUD_YR|| D.AUD_NO 
				               GROUP BY REL_AUD_YR || REL_AUD_NO
				            )                                  AS STR_TO_END_DT                                         /*감사실시 기간O*/ 
				      , CASE WHEN (
				                     SELECT COUNT(AUD_TG_ORG_CD)
				                       FROM TBCSPDCP104L 
				                      WHERE 1=1 
				                        AND ACP_YR      = A.ACP_YR
				                        AND REQ_DVSN_CD = A.REQ_DVSN_CD
				                        AND CVPT_ACP_NO = A.CVPT_ACP_NO
				                  ) = 1
				             THEN F_ORG_INFO(F.AUD_TG_ORG_CD , '1') 
				             ELSE (
				                     SELECT LISTAGG(F_ORG_INFO(AUD_TG_ORG_CD, '1'),', ') WITHIN GROUP (ORDER BY AUD_TG_ORG_CD)
				                       FROM TBCSPDCP104L
				                      WHERE 1=1
				                        AND ACP_YR      = A.ACP_YR
				                        AND REQ_DVSN_CD = A.REQ_DVSN_CD
				                        AND CVPT_ACP_NO = A.CVPT_ACP_NO
				                     
				                  ) 
				              END                                                                                  AS AUD_TG_ORG_NM /*관계기관O*/ 
				              
				      ,CASE
				             WHEN A.REQ_DVSN_CD IN ('2','3') AND EXAM_RPT_APV_DT IS NULL  
				             THEN 
				                    CASE WHEN A.REQ_DVSN_CD = '2'
				                            THEN TO_CHAR(A.ACP_DH+30+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(G.AUD_DCN,0),'YY. MM. DD')
				                        ELSE TO_CHAR(ADD_MONTHS(A.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(G.AUD_DCN,0),'YY. MM. DD') 
				                    END
				             WHEN A.REQ_DVSN_CD = '2' THEN TO_CHAR(TO_DATE(EXAM_RPT_APV_DT)+60, 'YY. MM. DD')
				             ELSE TO_CHAR(ADD_MONTHS(TO_DATE(EXAM_RPT_APV_DT) , 6), 'YY. MM. DD')
				           END                                                                                     AS HNDL_DDLN_DT  /*처리기한O*/ 
				           
				      ,CASE WHEN (
				                    TO_DATE(CASE
				                             WHEN A.REQ_DVSN_CD IN ('2','3') AND EXAM_RPT_APV_DT IS NULL  
				                                THEN 
				                                    CASE WHEN A.REQ_DVSN_CD = '2'
				                                            THEN TO_CHAR(A.ACP_DH+30+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(G.AUD_DCN,0),'YYYY. MM. DD')
				                                        ELSE TO_CHAR(ADD_MONTHS(A.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(G.AUD_DCN,0),'YYYY. MM. DD') 
				                                    END
				                             WHEN A.REQ_DVSN_CD = '2' THEN TO_CHAR(TO_DATE(EXAM_RPT_APV_DT)+60, 'YYYY. MM. DD')
				                                ELSE TO_CHAR(ADD_MONTHS(TO_DATE(EXAM_RPT_APV_DT) , 6), 'YYYY. MM. DD')
				                             END,'YYYY/MM/DD')) < TO_DATE(SYSDATE)
				                 THEN ROUND( TO_DATE(SYSDATE) - TO_DATE(CASE WHEN A.REQ_DVSN_CD IN ('2','3') AND EXAM_RPT_APV_DT IS NULL  
				                                                    THEN 
				                                                        CASE WHEN A.REQ_DVSN_CD = '2'
				                                                                THEN TO_CHAR(A.ACP_DH+30+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO)+NVL(G.AUD_DCN,0),'YYYY. MM. DD')
				                                                            ELSE TO_CHAR(ADD_MONTHS(A.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO)+NVL(G.AUD_DCN,0),'YYYY. MM. DD') 
				                                                        END
				                                                 WHEN A.REQ_DVSN_CD = '2' THEN TO_CHAR(TO_DATE(EXAM_RPT_APV_DT)+60, 'YYYY. MM. DD')
				                                                    ELSE TO_CHAR(ADD_MONTHS(TO_DATE(EXAM_RPT_APV_DT) , 6), 'YYYY. MM. DD')
				                                                 END,'YYYY/MM/DD'))
				                 ELSE NULL
				                 END
				            AS DLAY_CNT                                                        /*기한초과(일)O*/                                                                              
				                                                                                                                             
				       ,D.AUD_YR AS AUD_YR                                                                                      /*O*/
				       ,D.AUD_NO AS AUD_NO                                                                                      /*O*/

				          FROM TBCSPDCP101M A,TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E, TBCSPDCP104L F         
									,( SELECT sum(nvl(AUD_DCN,0)) AUD_DCN, C.REL_AUD_YR,	C.REL_AUD_NO, C.AUD_BZT_KND_CD
						FROM TBBADDED001M A
					    LEFT OUTER JOIN TBBADDED101L B
					            ON A.AUD_YR = B.AUD_YR
					           AND A.AUD_NO = B.AUD_NO
					           AND B.AUD_STEP_CD != 'A1030'                          
					    INNER JOIN TBBADDED002M C
					            ON A.AUD_YR  = C.REL_AUD_YR
					           AND A.AUD_NO = C.REL_AUD_NO
					    INNER JOIN TBBADDED030L D ON A.AUD_YR = D.AUD_YR AND A.AUD_NO = D.AUD_NO  
					    LEFT OUTER JOIN TBCSPDCP101M E
                                ON D.TSK_KEY1 = E.ACP_YR
                                AND D.TSK_KEY2 = E.REQ_DVSN_CD
                                AND D.TSK_KEY3 = E.CVPT_ACP_NO
                        LEFT OUTER JOIN TBCSPEAR001M F
                                ON E.ACP_YR = F.ACP_YR
                                AND E.REQ_DVSN_CD = F.REQ_DVSN_CD
                                AND E.CVPT_ACP_NO = F.CVPT_ACP_NO
                        WHERE 
                             NVL(CASE WHEN F.AUD_RSLT_CD = '08' THEN TO_CHAR(E.CVPT_WDW_DH,'YYYY-MM-DD')        
                                ELSE  
                                    CASE WHEN E.REQ_DVSN_CD = '3' 
                                         THEN NVL(TO_CHAR(TO_DATE(F.EXAM_RPT_APV_DT),'YYYY-MM-DD'),( 
                                            SELECT TO_CHAR(MAX(C1.APV_DH),'YYYY-MM-DD') 
                                                FROM TBBADDED030L A1,TBBADDED103M B1, TBDCMACM023L C1
                                                 WHERE A1.TSK_KEY1(+)=E.ACP_YR 
                                                    AND A1.TSK_KEY2(+)=E.REQ_DVSN_CD 
                                                    AND A1.TSK_KEY3(+) =E.CVPT_ACP_NO
                                                    AND A1.AUD_YR=B1.AUD_YR 
                                                    AND A1.AUD_NO=B1.AUD_NO 
                                                    AND B1.APV_RQS_ID = C1.APV_DOC_NO 
                                                    AND B1.RPRT_CD = 'A10300100' 
                                                    AND B1.APV_STA_CD ='30' 
                                            )
                                         )    
                                     ELSE (SELECT TO_CHAR(TO_DATE(MAX(B.CMT_OEN_DT)),'YYYY-MM-DD') 
                                                FROM TBCSPEAR011M A , TBCSPEAR010M B 
                                                    WHERE A.ACP_YR(+) = E.ACP_YR 
                                                        AND A.REQ_DVSN_CD(+) = E.REQ_DVSN_CD  
                                                        AND A.CVPT_ACP_NO(+) = E.CVPT_ACP_NO 
                                                        AND A.CMT_DVSN_CD = B.CMT_DVSN_CD 
                                                        AND A.CMT_OEN_YE = B.CMT_OEN_YE 
                                                        AND A.CMT_DGE = B.CMT_DGE
                                                        AND A.CMT_RSLT_CD != '09'
                                                        )  
                                    END
                                END,'9999-99-99') > TO_CHAR(TO_DATE(C.AUD_STR_DT),'YYYY-MM-DD')
					    GROUP BY C.REL_AUD_YR,	C.REL_AUD_NO, C.AUD_BZT_KND_CD ) G  
       ]]>
		               <if test= 'AFlag == "2" '>
	<![CDATA[
		               		, (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050') J2
		               		, (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') J3
       ]]>
					   </if>
	<![CDATA[
				         WHERE 1=1
				           AND A.REQ_DVSN_CD(+) = F.REQ_DVSN_CD 
				           AND A.ACP_YR(+)     = F.ACP_YR
				           AND A.CVPT_ACP_NO(+) = F.CVPT_ACP_NO
				           AND G.REL_AUD_YR(+) = C.AUD_YR
				           AND G.REL_AUD_NO(+) = C.AUD_NO
				           AND G.AUD_BZT_KND_CD(+) ='02'
				           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				           AND A.ACP_YR = B.ACP_YR
				           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				           AND A.REQ_DVSN_CD IN ('2','3')
	 ]]>
			    <choose>
			    	<when test="schDeptCd != null and schDeptCd != '' ">
						<![CDATA[
							AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
						]]>
			    	</when>
			    	<otherwise>
						<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
							<![CDATA[
			 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
							]]>
		   				</if>
			    	</otherwise>
			    </choose>
       				   <if test="hndlChgrId != null and hndlChgrId != '' ">
							<![CDATA[
						       		AND B.HNDL_CHGR_ID = #{hndlChgrId}
						       ]]>
       				   </if>
		               <if test= 'AFlag != "5" '>
	 			<![CDATA[
				           AND C.TSK_KEY2 = A.REQ_DVSN_CD
				           AND C.TSK_KEY1 = A.ACP_YR
				           AND C.TSK_KEY3 = A.CVPT_ACP_NO
				           AND D.AUD_YR = C.AUD_YR
				           AND D.AUD_NO = C.AUD_NO
				           AND D.AUD_YR = E.AUD_YR
				           AND D.AUD_NO = E.AUD_NO
	 ]]>
			           </if>
		               <if test= 'AFlag == "1" '>
	<![CDATA[
                           AND A.CVPT_HNDL_STA_CD != '170'
                           AND A.CVPT_WDW_DH IS NULL        
                           AND (B.AUD_RSLT_CD IS NULL OR B.AUD_RSLT_RPL_DT IS NULL)
                           AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5' 
                           AND D.PRSS_STEP_CD IN ('A1070','A1080')   
	 ]]>
		               </if>
		               <if test= 'AFlag=="2" '>
	<![CDATA[
				           AND E.AUD_YR = J2.AUD_YR(+)
				           AND E.AUD_NO = J2.AUD_NO(+)
				           AND E.AUD_YR = J3.AUD_YR(+)
				           AND E.AUD_NO = J3.AUD_NO(+)
                           AND A.REQ_DVSN_CD IN ('2','3')  
                           AND A.CVPT_HNDL_STA_CD != '170'
                           AND A.CVPT_WDW_DH IS NULL        
                           AND B.AUD_RSLT_CD IS NULL                   
                           AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'    
                           AND D.PRSS_STEP_CD = 'A1060'                                        
                           AND ((SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = J3.APV_RQS_ID AND APV_DH IS NULL) IN ('0013600','0015800','0055700','0045900','0055600') 
                                OR (
                                    J3.APV_RQS_ID IS NULL                                                                                  
                                    AND (SELECT COUNT(*) FROM TBDCMACM023L WHERE APV_DOC_NO = J2.APV_RQS_ID                                
                                                AND APVR_PST_CD IN ('0045900','0055600') AND APVR_STA_CD = '203') < 1 
                                    AND D.PRSS_STEP_CD = 'A1060'  
                                   )            
                               )
	 ]]>
		               </if>
		               <if test= 'AFlag=="3"  '>
	<![CDATA[
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'                                           
					       AND E.FLD_AUD_STR_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD')                         
					       AND ((SELECT COUNT(*) FROM TBBADDED103M WHERE AUD_YR = D.AUD_YR AND AUD_NO = D.AUD_NO                
					           AND RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050' AND (RPRT_NM LIKE '%종료%' OR RPRT_CD IN ('A10500200', 'A10500210')) AND APV_STA_CD != '30'
					        ) > 0 
					       )
	 ]]>
		               </if>
		               <if test= 'AFlag=="4" '>
	<![CDATA[
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL       
					       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'
					       AND E.FLD_AUD_STR_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD')
					       AND (SELECT COUNT(DOC_ID) FROM TBBADDED103M WHERE AUD_YR = D.AUD_YR AND AUD_NO = D.AUD_NO AND RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050' 
							       AND (RPRT_NM LIKE '%종료%' OR RPRT_CD IN ('A10500200', 'A10500210'))) = 0
	 ]]>
		               </if>
		               <if test= 'AFlag=="5" '>
	<![CDATA[
							AND C.TSK_KEY2(+) = A.REQ_DVSN_CD
				           AND C.TSK_KEY1(+) = A.ACP_YR
				           AND C.TSK_KEY3(+) = A.CVPT_ACP_NO
				           AND D.AUD_YR(+) = C.AUD_YR
				           AND D.AUD_NO(+) = C.AUD_NO
				           AND D.AUD_YR = E.AUD_YR(+)
				           AND D.AUD_NO = E.AUD_NO(+)
					       AND A.CVPT_HNDL_STA_CD != '170'
					       AND A.CVPT_WDW_DH IS NULL        
					       AND B.AUD_RSLT_RPL_DT IS NULL    
					       AND (B.REQ_EXAM_RSLT_CD = '01' OR B.EXAM_RPT_APV_DT IS NOT NULL)
					       AND (CASE WHEN 
					                (SELECT COUNT(*)
					                  FROM TBBADDED030L D2,
					                       TBBADDED001M D3, 
					                       TBBADDED003M D4  
					                 WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD 
					                   AND D2.TSK_KEY1 = A.ACP_YR
					                   AND D2.TSK_KEY3 = A.CVPT_ACP_NO
					                   AND D3.AUD_YR = D2.AUD_YR
					                   AND D3.AUD_NO = D2.AUD_NO
					                   AND D3.AUD_YR = D4.AUD_YR
					                   AND D3.AUD_NO = D4.AUD_NO
					                   AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5'
					               ) < 1  
					            THEN CASE WHEN B.REQ_EXAM_RSLT_CD = '01'      
					                       AND (SELECT COUNT(*) FROM TBCSPDCP603M                                         
					                                        WHERE REQ_DVSN_CD = A.REQ_DVSN_CD AND ACP_YR = A.ACP_YR AND CVPT_ACP_NO = A.CVPT_ACP_NO 
					                                            AND RPRT_CD IN ('C10220100','C10330100','A10300100') AND APV_STA_CD = '30') > 0
					                    THEN 1 ELSE 0 END 
					            ELSE CASE WHEN (TO_CHAR(SYSDATE, 'YYYYMMDD') < (SELECT MAX(FLD_AUD_STR_DT)
					                                                              FROM TBBADDED030L D2, 
					                                                                   TBBADDED001M D3,
					                                                                   TBBADDED003M D4  
					                                                             WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD 
					                                                               AND D2.TSK_KEY1 = A.ACP_YR
					                                                               AND D2.TSK_KEY3 = A.CVPT_ACP_NO
					                                                               AND D3.AUD_YR = D2.AUD_YR
					                                                               AND D3.AUD_NO = D2.AUD_NO
					                                                               AND D3.AUD_YR = D4.AUD_YR
					                                                               AND D3.AUD_NO = D4.AUD_NO
					                                                               AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5'
					                                                           )
					                               OR (SELECT COUNT(*) FROM TBBADDED030L C, TBBADDED103M D
					                                   WHERE C.TSK_KEY2 = A.REQ_DVSN_CD
					                                   AND C.TSK_KEY1 = A.ACP_YR
					                                   AND C.TSK_KEY3 = A.CVPT_ACP_NO
					                                   AND D.AUD_YR = C.AUD_YR
					                                   AND D.AUD_NO = C.AUD_NO
					                                   AND D.AUD_STEP_CD = 'A1030' 
					                                   AND D.RPRT_CD = 'A10300100'
					                                   AND D.APV_STA_CD = '30') = 0
					                              )
					                    THEN 1 ELSE 0 END
					            END = 1 
					        )
				        ) WHERE CASE WHEN DVSN_CD = '2' THEN 1 ELSE CASE WHEN STR_TO_END_DT IS NOT NULL THEN 1 ELSE 0 END END =1
	 ]]>
			           </if>
							ORDER BY ACP_DH DESC
	</select>
	
	<select id="selectEarSituList4" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectEarSituList4*/
        <![CDATA[
			SELECT 
			        DISTINCT A.REQ_DVSN_CD AS DVSN_CD                                            /*구분코드*/
			       ,F_CODE_NM('1000740',A.REQ_DVSN_CD) AS DVSN_NM                                                            /*구분O*/
			       ,A.ACP_YR ||'-'|| F_CODE_NM('1000740',A.REQ_DVSN_CD) ||'-'|| SUBSTR(A.CVPT_ACP_NO,'3',3) AS ACP_NO   /*청구 접수번호O*/
			       ,A.TIT_NM||'('||A.ACP_YR||'-'||F_CODE_NM('1000740',A.REQ_DVSN_CD) || '-'||A.RM_CVPT_ACP_NO||')'  AS TIT_NM    /*제목(감사사항명+감사 접수번호)O*/
			       ,A.TIT_NM||'('||A.ACP_YR||'-'||F_CODE_NM('1000740',A.REQ_DVSN_CD) || '-'||A.RM_CVPT_ACP_NO||')' AS ORI_TIT_NM   /*제목(감사사항명+감사 접수번호)O*/
			       ,A.TIT_NM AS TIT_NM2                                             /*청구제목*/
			       ,F_DPT_INFO(B.HNDL_DPT_CD,'1') AS HNDL_DPT_NM                                                        /*청구담당부서O*/
			       ,B.HNDL_DPT_CD AS HNDL_DPT_CD                                                                        /*담당부서코드O*/       
			       ,F_USR_INFO_BY_ID(B.HNDL_CHGR_ID,'2') AS HNDL_CHGR_NM                                                /*청구담당자O*/ 
			       ,TO_CHAR(A.ACP_DH,'YY. MM. DD') AS ACP_DH                                                            /*접수일O*/ 
			       , TO_CHAR(TO_DATE(B.EXAM_RPT_APV_DT, 'YYYYMMDD'), 'YY. MM. DD')  AS STR_DT                           /*감사실시결정일O*/ 
			       ,( 
			       SELECT CASE WHEN REL_AUD_YR || REL_AUD_NO IS NOT NULL
			                            THEN TO_CHAR(TO_DATE(MIN(AUD_STR_DT)), 'YY. MM. DD')||' ~ '||TO_CHAR(TO_DATE(MAX(AUD_END_DT)), 'YY. MM. DD')
			                        ELSE ''
			                    END
			              FROM TBBADDED002M
			             WHERE AUD_BZT_KND_CD = '02'
			               AND REL_AUD_YR || REL_AUD_NO = D.AUD_YR|| D.AUD_NO 
			               GROUP BY REL_AUD_YR || REL_AUD_NO
			            )                                  AS STR_TO_END_DT                                         /*감사실시 기간O*/ 
			      , CASE WHEN (
			                     SELECT COUNT(AUD_TG_ORG_CD)
			                       FROM TBCSPDCP104L 
			                      WHERE 1=1 
			                        AND ACP_YR      = A.ACP_YR
			                        AND REQ_DVSN_CD = A.REQ_DVSN_CD
			                        AND CVPT_ACP_NO = A.CVPT_ACP_NO
			                  ) = 1
			             THEN F_ORG_INFO(F.AUD_TG_ORG_CD , '1') 
			             ELSE (
			                     SELECT LISTAGG(F_ORG_INFO(AUD_TG_ORG_CD, '1'),', ') WITHIN GROUP (ORDER BY AUD_TG_ORG_CD)
			                       FROM TBCSPDCP104L
			                      WHERE 1=1
			                        AND ACP_YR      = A.ACP_YR
			                        AND REQ_DVSN_CD = A.REQ_DVSN_CD
			                        AND CVPT_ACP_NO = A.CVPT_ACP_NO
			                     
			                  ) 
			              END                                                                                  AS ORG_NM /*관계기관O*/                                                                                   
			       ,D.AUD_YR AS AUD_YR                                                                                      /*O*/
			       ,D.AUD_NO AS AUD_NO 
			
						     ,CASE WHEN A.REQ_DVSN_CD ='2'
						     	THEN TO_CHAR(A.ACP_DH+30+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YY. MM. DD')
						     	ELSE TO_CHAR(ADD_MONTHS(A.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YY. MM. DD')
						     	END AS HNDL_DDLN_DT
						     ,CASE WHEN B.AUD_RSLT_CD = '08' THEN NULL ELSE
						                        CASE WHEN
						                             CASE
						                                 WHEN A.REQ_DVSN_CD IN ('2','3') AND EXAM_RPT_APV_DT IS NULL  
						                                 THEN 
						                                        CASE WHEN A.REQ_DVSN_CD = '2'
						                                                THEN A.ACP_DH+30+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0)
						                                            ELSE ADD_MONTHS(A.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0)
						                                        END
						                                 WHEN A.REQ_DVSN_CD = '2' THEN TO_DATE(EXAM_RPT_APV_DT)+60
						                                 ELSE ADD_MONTHS(TO_DATE(EXAM_RPT_APV_DT) , 6)
						                             END < NVL(TO_DATE(B.AUD_RSLT_RPL_DT), SYSDATE)
						                         THEN 
						                            ROUND(
						                                 NVL(TO_DATE(B.AUD_RSLT_RPL_DT), SYSDATE) - 
						                                 CASE
						                                 WHEN A.REQ_DVSN_CD IN ('2','3') AND EXAM_RPT_APV_DT IS NULL  
						                                 THEN 
						                                        CASE WHEN A.REQ_DVSN_CD = '2'
						                                                THEN A.ACP_DH+30+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0)
						                                            ELSE ADD_MONTHS(A.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0)
						                                        END
						                                 WHEN A.REQ_DVSN_CD = '2' THEN TO_DATE(EXAM_RPT_APV_DT)+60
						                                 ELSE ADD_MONTHS(TO_DATE(EXAM_RPT_APV_DT) , 6)
						                                END)
						                         ELSE NULL END 
						                     END AS DLAY_CNT
						     ,''                                                               AS ETC
						    ,(SELECT COUNT(CVPT_ACP_NO)
								   FROM TBCSPDCP601M
								  WHERE ACP_YR = A.ACP_YR
								     AND REQ_DVSN_CD = A.REQ_DVSN_CD
								     AND CVPT_ACP_NO = A.CVPT_ACP_NO) AS PRC_CNT
						     ,F_CODE_NM('1000894', A.DOC_WRIT_KND_CD) AS DOC_TYPE /* 편집기 구분  */
						     ,A.ACP_YR AS ACP_YR
						     ,A.REQ_DVSN_CD AS REQ_DVSN_CD
						     ,A.CVPT_ACP_NO AS CVPT_ACP_NO
						     ,A.CVPT_HNDL_STA_CD AS CVPT_HNDL_STA_CD
			          FROM TBCSPDCP101M A ,
			               TBCSPEAR001M B 
			               ,TBBADDED030L C 
			              , TBBADDED001M D 
			              , TBBADDED003M E 
			              ,TBCSPDCP104L F , TBBADDED002M G,(SELECT D.TSK_KEY1 , D.TSK_KEY2, D.TSK_KEY3, sum(nvl(AUD_DCN,0)) BZT_DCN
						          FROM TBBADDED001M A
						          LEFT OUTER JOIN TBBADDED101L B
						                ON A.AUD_YR = B.AUD_YR
						               AND A.AUD_NO = B.AUD_NO
						               AND B.AUD_STEP_CD != 'A1030'                          
						          INNER JOIN TBBADDED002M C
						                ON A.AUD_YR  = C.REL_AUD_YR
						               AND A.AUD_NO = C.REL_AUD_NO
						          INNER JOIN TBBADDED030L D ON A.AUD_YR = D.AUD_YR AND A.AUD_NO = D.AUD_NO  
						          LEFT OUTER JOIN TBCSPDCP101M E
                                ON D.TSK_KEY1 = E.ACP_YR
                                AND D.TSK_KEY2 = E.REQ_DVSN_CD
                                AND D.TSK_KEY3 = E.CVPT_ACP_NO
                        LEFT OUTER JOIN TBCSPEAR001M F
                                ON E.ACP_YR = F.ACP_YR
                                AND E.REQ_DVSN_CD = F.REQ_DVSN_CD
                                AND E.CVPT_ACP_NO = F.CVPT_ACP_NO
                        WHERE 
                             NVL(CASE WHEN F.AUD_RSLT_CD = '08' THEN TO_CHAR(E.CVPT_WDW_DH,'YYYY-MM-DD')        
                                ELSE  
                                    CASE WHEN E.REQ_DVSN_CD = '3' 
                                         THEN NVL(TO_CHAR(TO_DATE(F.EXAM_RPT_APV_DT),'YYYY-MM-DD'),( 
                                            SELECT TO_CHAR(MAX(C1.APV_DH),'YYYY-MM-DD') 
                                                FROM TBBADDED030L A1,TBBADDED103M B1, TBDCMACM023L C1
                                                 WHERE A1.TSK_KEY1(+)=E.ACP_YR 
                                                    AND A1.TSK_KEY2(+)=E.REQ_DVSN_CD 
                                                    AND A1.TSK_KEY3(+) =E.CVPT_ACP_NO
                                                    AND A1.AUD_YR=B1.AUD_YR 
                                                    AND A1.AUD_NO=B1.AUD_NO 
                                                    AND B1.APV_RQS_ID = C1.APV_DOC_NO 
                                                    AND B1.RPRT_CD = 'A10300100' 
                                                    AND B1.APV_STA_CD ='30' 
                                            )
                                         )    
                                     ELSE (SELECT TO_CHAR(TO_DATE(MAX(B.CMT_OEN_DT)),'YYYY-MM-DD') 
                                                FROM TBCSPEAR011M A , TBCSPEAR010M B 
                                                    WHERE A.ACP_YR(+) = E.ACP_YR 
                                                        AND A.REQ_DVSN_CD(+) = E.REQ_DVSN_CD  
                                                        AND A.CVPT_ACP_NO(+) = E.CVPT_ACP_NO 
                                                        AND A.CMT_DVSN_CD = B.CMT_DVSN_CD 
                                                        AND A.CMT_OEN_YE = B.CMT_OEN_YE 
                                                        AND A.CMT_DGE = B.CMT_DGE
                                                        AND A.CMT_RSLT_CD != '09'
                                                        )  
                                    END
                                END,'9999-99-99') > TO_CHAR(TO_DATE(C.AUD_STR_DT),'YYYY-MM-DD')
						          GROUP BY D.TSK_KEY1, D.TSK_KEY2, D.TSK_KEY3
						        ) DDD
			         WHERE 1=1
			           AND A.REQ_DVSN_CD = F.REQ_DVSN_CD(+)
			           AND A.ACP_YR     = F.ACP_YR(+)
			           AND A.CVPT_ACP_NO = F.CVPT_ACP_NO(+)
			           AND G.REL_AUD_YR(+) = C.AUD_YR
			           AND G.REL_AUD_NO(+) = C.AUD_NO
			           AND G.AUD_BZT_KND_CD(+) ='02'              
			           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
			           AND A.ACP_YR = B.ACP_YR(+)
			           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			           AND B.CVPT_ACP_NO = D.CVPT_ACP_NO(+)        
			           AND D.AUD_YR = C.AUD_YR(+)
			           AND D.AUD_NO = C.AUD_NO(+)
			           AND D.AUD_YR = E.AUD_YR(+)
			           AND D.AUD_NO = E.AUD_NO(+)       
					   AND A.ACP_YR      = DDD.TSK_KEY1(+) 
					   AND A.CVPT_ACP_NO = DDD.TSK_KEY3(+) 
					   AND A.REQ_DVSN_CD = DDD.TSK_KEY2(+)
			           AND A.REQ_DVSN_CD IN ('2','3') 
                       AND A.CVPT_HNDL_STA_CD != '170'
                       AND A.CVPT_WDW_DH IS NULL   
                       AND (B.PREI_APV_DT IS NULL OR B.EXAM_RPT_APV_DT IS NULL OR (B.REQ_EXAM_RSLT_CD IS NULL OR B.REQ_EXAM_RSLT_CD != '01')
                                 OR (SELECT COUNT(*) FROM TBCSPDCP603M                                         
                                        WHERE REQ_DVSN_CD = A.REQ_DVSN_CD AND ACP_YR = A.ACP_YR AND CVPT_ACP_NO = A.CVPT_ACP_NO 
                                            AND RPRT_CD IN ('C10220100','C10330100','A10300100') AND APV_STA_CD = '30') < 1 )
                       AND (
                              CASE WHEN (SELECT COUNT(*)
                                     FROM TBBADDED030L D2, 
                                          TBBADDED001M D3,
                                          TBBADDED003M D4
                                    WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD
                                      AND D2.TSK_KEY1 = A.ACP_YR
                                      AND D2.TSK_KEY3 = A.CVPT_ACP_NO
                                      AND D3.AUD_YR = D2.AUD_YR
                                      AND D3.AUD_NO = D2.AUD_NO
                                      AND D3.AUD_YR = D4.AUD_YR
                                      AND D3.AUD_NO = D4.AUD_NO
                                      AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5') < 1 
                              THEN 1
                              ELSE CASE WHEN (SELECT COUNT(*) FROM TBBADDED030L C, TBBADDED103M D
                                                   WHERE C.TSK_KEY2 = A.REQ_DVSN_CD
                                                   AND C.TSK_KEY1 = A.ACP_YR
                                                   AND C.TSK_KEY3 = A.CVPT_ACP_NO
                                                   AND D.AUD_YR = C.AUD_YR
                                                   AND D.AUD_NO = C.AUD_NO
                                                   AND D.AUD_STEP_CD = 'A1030' 
                                                   AND D.RPRT_CD = 'A10300100'
                                                   AND D.APV_STA_CD = '30') < 1
                                         THEN 1 ELSE 0 END
                              END = 1
                           )
			    ]]>
			    <choose>
			    	<when test="schDeptCd != null and schDeptCd != '' ">
						<![CDATA[
							AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
						]]>
			    	</when>
			    	<otherwise>
						<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
							<![CDATA[
			 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
							]]>
		   				</if>
			    	</otherwise>
			    </choose>
			    
				<if test="hndlChgrId != null and hndlChgrId != '' ">
					<![CDATA[
				       		AND B.HNDL_CHGR_ID = #{hndlChgrId}
					]]>
   				</if>
   				ORDER BY ACP_DH DESC
	</select>
	
	<select id="selectEarSituList5" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectEarSituList5*/
		<![CDATA[
    	SELECT A.REQ_DVSN_CD
               , A.ACP_YR
               , A.CVPT_ACP_NO
               , A.ACP_NO
               , A.HNDL_CHGR_ID
               , A.HNDL_DPT_CD
               , CASE WHEN A.ACP_STEP_NM IS NOT NULL AND CVPT_HNDL_STA_CD <> '170' THEN A.ACP_STEP_NM ELSE CVPT_HNDL_STA_NM END AS ACP_STEP_NM
               , A.CVPT_HNDL_STA_CD
   			   , F_CODE_NM('1000361',A.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
               , A.TIT_NM
               , A.ACP_DH
               , A.PREI_APV_DT
               , A.CMT_LIST
               , NVL(A.TON_DT, A.TRNF_DT) AS TRNF_DT
               , A.EXAM_RPT_APV_DT
               , A.EXAM_RSLT_RPL_DT		/*감사실시여부 결정일(구:검토보고서 결재일)*/
               , A.AUD_YN
               , A.CVPT_WDW_DH
               , (CASE WHEN A.PRC_CNT > 0 THEN A.EXAM_APV_DT ELSE A.EXAM_RPT_APV_DT END) AS EXAM_APV_DT      /*603table 검토보고서 결재일*/
               , TO_DATE(A.EXAM_RPT_APV_DT, 'YYYY-MM-DD') - TO_DATE(A.HNDL_DDLN_DT1, 'YYYY-MM-DD') AS DELAY_CNT1
               , TO_DATE(A.AUD_RSLT_RPL_DT, 'YYYY-MM-DD') - TO_DATE(A.HNDL_DDLN_DT2, 'YYYY-MM-DD') AS DELAY_CNT2
               , A.HNDL_DDLN_DT1
               , A.HNDL_DDLN_DT2
               , C.AUD_STR_DT02       --실지감사 시작일
               , C.RETURN_DT            --귀청일
               , C.E_FNL_APV          --종료보고 최종결재일
               , C.GWA_APV            --과장결재일
               , C.GUK_APV            --국단실장결재일
               , C.CHA_APV            --사무차장결재일
               , C.CHONG_APV          --사무총장결재일
               , C.WI_APV             --주심위원결재일
               , C.SBCN_DY            --최초부의일
               , C.ENF_DT             --최초시행일
               , C.AUD_KND_CD
               , A.AUD_RSLT_RPL_DT    --회신일
               , A.PRC_CNT
               , A.DOC_TYPE
        FROM (SELECT	A.REQ_DVSN_CD
					,F_CODE_NM('1000740',A.REQ_DVSN_CD) AS REQ_DVSN_NM
					,A.ACP_YR
   					,A.CVPT_ACP_NO
                    ,A.HNDL_CHGR_ID AS HNDL_CHGR_ID
   					,B.ACP_YR||'-'||F_CODE_NM('1000740',A.REQ_DVSN_CD)||'-'||substring(A.CVPT_ACP_NO, 3, 3) AS ACP_NO
   					,B.TIT_NM
   					,TO_CHAR(B.ACP_DH,'YYYY-MM-DD') AS ACP_DH
   					,B.CVPT_HNDL_STA_CD
   					, (	SELECT	ACP_STEP_NM
			      		FROM	TBCSPDCP601M S3
			      		WHERE	(S3.REQ_DVSN_CD, S3.ACP_YR, S3.CVPT_ACP_NO, ACP_STEP_CD ) IN (	SELECT	S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO,MAX(ACP_STEP_CD)
			      																		FROM	TBCSPDCP601M S4
			      																		WHERE	A.REQ_DVSN_CD = S4.REQ_DVSN_CD
			      																		AND		A.ACP_YR = S4.ACP_YR
			      																		AND		A.CVPT_ACP_NO = S4.CVPT_ACP_NO
                                                                                        AND     S4.STEP_CMPT_YN = 'P'
			      																		GROUP BY S4.REQ_DVSN_CD,S4.ACP_YR,S4.CVPT_ACP_NO
			      																	))  AS    ACP_STEP_NM
   					,F_CODE_NM('1000361',B.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
   					,F_USR_INFO_BY_ID(A.HNDL_CHGR_ID,'2') AS HNDL_CHGR_NM
   					,(	SELECT	S1.DPT_NM
   						FROM	TBDCMACM002M S1
   						WHERE	S1.DPT_CD = A.HNDL_DPT_CD
   					) AS HNDL_DPT_NM
   					,A.HNDL_DPT_CD
                    ,TO_CHAR(TO_DATE(A.PREI_APV_DT),'YYYY-MM-DD') AS    PREI_APV_DT      /*선람전 결재일*/
                    ,TO_CHAR(TO_DATE(A.TRNF_DT),'YYYY-MM-DD') AS  TRNF_DT           /*선람-이송문 결재일*/
                    , (SELECT AGGR_CONCAT(CASE WHEN T2.APV_STA_CD='3' THEN TO_CHAR(FNL_APV_DH,'YYYY-MM-DD') ELSE NULL END, ', ') FROM TBCSPDCP603M T1 INNER JOIN TBDCMACM022L T2 ON(T1.APV_RQS_ID = T2.APV_DOC_NO) WHERE RPRT_CD IN ('C10220100', 'C10330100') AND T1.ACP_YR = A.ACP_YR AND T1.REQ_DVSN_CD = A.REQ_DVSN_CD AND T1.CVPT_ACP_NO = A.CVPT_ACP_NO) AS EXAM_APV_DT
                    , (SELECT AGGR_CONCAT(CMT_OEN_YE||'-'||DECODE(CMT_DVSN_CD,1,'심사','자문')||'-'||CMT_DGE, ', ') FROM TBCSPEAR011M WHERE ACP_YR=A.ACP_YR AND REQ_DVSN_CD=A.REQ_DVSN_CD AND CVPT_ACP_NO=A.CVPT_ACP_NO) AS CMT_LIST
                    ,TO_CHAR(TO_DATE(A.EXAM_RPT_APV_DT),'YYYY-MM-DD') AS  EXAM_RPT_APV_DT    /*감사실시여부검토일*/
                    ,TO_CHAR(TO_DATE(A.EXAM_RSLT_RPL_DT),'YYYY-MM-DD') AS EXAM_RSLT_RPL_DT  /*감사실시여부회신일*/
                    ,CASE WHEN A.REQ_DVSN_CD IN ('2','3') AND (A.EXAM_RPT_APV_DT IS NOT NULL AND A.REQ_EXAM_RSLT_CD = '01') THEN 'O'
                          WHEN A.REQ_DVSN_CD IN ('2','3') AND (A.EXAM_RPT_APV_DT IS NOT NULL AND A.REQ_EXAM_RSLT_CD <> '01') THEN 'X'
                          ELSE NULL END AUD_YN
                    ,TO_CHAR(TO_DATE(A.TON_DT),'YYYY-MM-DD') AS TON_DT
                    ,TO_CHAR(B.CVPT_WDW_DH,'YYYY-MM-DD') AS CVPT_WDW_DH           /*취하일*/
                    ,TO_CHAR(TO_DATE(A.AUD_RSLT_RPL_DT),'YYYY-MM-DD') AS AUD_RSLT_RPL_DT
                    ,CASE WHEN A.REQ_DVSN_CD = '2' THEN TO_CHAR(B.ACP_DH+30+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YYYY-MM-DD')
                            ELSE TO_CHAR(ADD_MONTHS(B.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YYYY-MM-DD') END
                            AS HNDL_DDLN_DT1    /*검토처리기한*/
   					,CASE
				         WHEN A.REQ_DVSN_CD IN ('2','3') AND (A.EXAM_RPT_APV_DT IS NULL OR A.REQ_EXAM_RSLT_CD <> '01') THEN ''
				         WHEN A.REQ_DVSN_CD = '2' AND (A.EXAM_RPT_APV_DT IS NOT NULL AND A.REQ_EXAM_RSLT_CD = '01') THEN TO_CHAR(TO_DATE(A.EXAM_RPT_APV_DT)+60, 'YYYY-MM-DD')
				         WHEN A.REQ_DVSN_CD = '3' AND (A.EXAM_RPT_APV_DT IS NOT NULL AND A.REQ_EXAM_RSLT_CD = '01') THEN TO_CHAR(ADD_MONTHS(TO_DATE(A.EXAM_RPT_APV_DT) , 6), 'YYYY-MM-DD')
                         ELSE '' END AS HNDL_DDLN_DT2     /*감사처리기한*/
   					,CASE WHEN A.AUD_RSLT_CD = '08' THEN NULL ELSE
                        CASE WHEN
                             CASE
                                 WHEN A.REQ_DVSN_CD IN ('2','3') AND A.EXAM_RPT_APV_DT IS NULL  
                                 THEN 
                                        CASE WHEN A.REQ_DVSN_CD = '2'
                                                THEN B.ACP_DH+30+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0)
                                            ELSE ADD_MONTHS(B.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0)
                                        END
                                 WHEN A.REQ_DVSN_CD = '2' THEN TO_DATE(A.EXAM_RPT_APV_DT)+60
                                 ELSE ADD_MONTHS(TO_DATE(A.EXAM_RPT_APV_DT) , 6)
                             END < NVL(TO_DATE(A.AUD_RSLT_RPL_DT), SYSDATE)
                         THEN 
                            ROUND(
                                 NVL(TO_DATE(A.AUD_RSLT_RPL_DT), SYSDATE) - 
                                 CASE
                                 WHEN A.REQ_DVSN_CD IN ('2','3') AND EXAM_RPT_APV_DT IS NULL  
                                 THEN 
                                        CASE WHEN A.REQ_DVSN_CD = '2'
                                                THEN B.ACP_DH+30+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0)
                                            ELSE ADD_MONTHS(B.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0)
                                        END
                                 WHEN A.REQ_DVSN_CD = '2' THEN TO_DATE(A.EXAM_RPT_APV_DT)+60
                                 ELSE ADD_MONTHS(TO_DATE(A.EXAM_RPT_APV_DT) , 6)
                                END)
                         ELSE NULL END 
                     END AS DLAY_CNT
                    ,(SELECT COUNT(A.CVPT_ACP_NO)
					   FROM TBCSPDCP601M
					  WHERE ACP_YR = A.ACP_YR
					     AND REQ_DVSN_CD = A.REQ_DVSN_CD
					     AND CVPT_ACP_NO = A.CVPT_ACP_NO) AS PRC_CNT
			   , F_CODE_NM('1000894', A.DOC_WRIT_KND_CD) AS DOC_TYPE
   			FROM TBCSPEAR001M A
		    LEFT OUTER JOIN TBCSPDCP101M B ON(A.ACP_YR = B.ACP_YR AND A.CVPT_ACP_NO = B.CVPT_ACP_NO AND A.REQ_DVSN_CD = B.REQ_DVSN_CD)
			LEFT OUTER JOIN ( SELECT sum(nvl(AUD_DCN,0)) BZT_DCN, D.TSK_KEY1, D.TSK_KEY2, D.TSK_KEY3
						FROM TBBADDED001M A
					    LEFT OUTER JOIN TBBADDED101L B
					            ON A.AUD_YR = B.AUD_YR
					           AND A.AUD_NO = B.AUD_NO
					           AND B.AUD_STEP_CD != 'A1030'                          
					    INNER JOIN TBBADDED002M C
					            ON A.AUD_YR  = C.REL_AUD_YR
					           AND A.AUD_NO = C.REL_AUD_NO
					    INNER JOIN TBBADDED030L D ON A.AUD_YR = D.AUD_YR AND A.AUD_NO = D.AUD_NO  
					    LEFT OUTER JOIN TBCSPDCP101M E
                                ON D.TSK_KEY1 = E.ACP_YR
                                AND D.TSK_KEY2 = E.REQ_DVSN_CD
                                AND D.TSK_KEY3 = E.CVPT_ACP_NO
                        LEFT OUTER JOIN TBCSPEAR001M F
                                ON E.ACP_YR = F.ACP_YR
                                AND E.REQ_DVSN_CD = F.REQ_DVSN_CD
                                AND E.CVPT_ACP_NO = F.CVPT_ACP_NO
                        WHERE 
                             NVL(CASE WHEN F.AUD_RSLT_CD = '08' THEN TO_CHAR(E.CVPT_WDW_DH,'YYYY-MM-DD')        
                                ELSE  
                                    CASE WHEN E.REQ_DVSN_CD = '3' 
                                         THEN NVL(TO_CHAR(TO_DATE(F.EXAM_RPT_APV_DT),'YYYY-MM-DD'),( 
                                            SELECT TO_CHAR(MAX(C1.APV_DH),'YYYY-MM-DD') 
                                                FROM TBBADDED030L A1,TBBADDED103M B1, TBDCMACM023L C1
                                                 WHERE A1.TSK_KEY1(+)=E.ACP_YR 
                                                    AND A1.TSK_KEY2(+)=E.REQ_DVSN_CD 
                                                    AND A1.TSK_KEY3(+) =E.CVPT_ACP_NO
                                                    AND A1.AUD_YR=B1.AUD_YR 
                                                    AND A1.AUD_NO=B1.AUD_NO 
                                                    AND B1.APV_RQS_ID = C1.APV_DOC_NO 
                                                    AND B1.RPRT_CD = 'A10300100' 
                                                    AND B1.APV_STA_CD ='30' 
                                            )
                                         )    
                                     ELSE (SELECT TO_CHAR(TO_DATE(MAX(B.CMT_OEN_DT)),'YYYY-MM-DD') 
                                                FROM TBCSPEAR011M A , TBCSPEAR010M B 
                                                    WHERE A.ACP_YR(+) = E.ACP_YR 
                                                        AND A.REQ_DVSN_CD(+) = E.REQ_DVSN_CD  
                                                        AND A.CVPT_ACP_NO(+) = E.CVPT_ACP_NO 
                                                        AND A.CMT_DVSN_CD = B.CMT_DVSN_CD 
                                                        AND A.CMT_OEN_YE = B.CMT_OEN_YE 
                                                        AND A.CMT_DGE = B.CMT_DGE
                                                        AND A.CMT_RSLT_CD != '09'
                                                        )  
                                    END
                                END,'9999-99-99') > TO_CHAR(TO_DATE(C.AUD_STR_DT),'YYYY-MM-DD')
					    GROUP BY D.TSK_KEY1, D.TSK_KEY2, D.TSK_KEY3 ) DDD ON (A.ACP_YR = DDD.TSK_KEY1 AND A.CVPT_ACP_NO = DDD.TSK_KEY3 AND A.REQ_DVSN_CD = DDD.TSK_KEY2)
            
            
			ORDER BY A.ACP_YR DESC, A.CVPT_ACP_NO DESC) A
        LEFT OUTER JOIN (
        SELECT ROW_NUMBER() OVER(ORDER BY PD.AUD_YR,PD.AUD_NO) AS ROW_NUM
             , PD.AUD_YR             --감사년도
             , PD.AUD_NO             --감사번호
             , PD.HIRK_DPT_NM     -- 국
             , PD.AUD_DPT_NM     -- 과
             , PD.AUD_DPT_FULL_NM         --주관국과명
             , TO_CHAR(TO_DATE(PD.AUD_STR_DT02),'YY"-"MM"-"DD') AS AUD_STR_DT02       --실지감사 시작일
             , TO_CHAR(TO_DATE(PD.RETURN_DT),'YY"-"MM"-"DD')    AS RETURN_DT            --귀청일
             , TO_CHAR(PD.E_FNL_APV,'YY"-"MM"-"DD')    AS E_FNL_APV          --종료보고 최종결재일
             , TO_CHAR(PD.GWA_APV,'YY"-"MM"-"DD')      AS GWA_APV            --과장결재일
             , TO_CHAR(PD.GUK_APV,'YY"-"MM"-"DD')      AS GUK_APV            --국단실장결재일
             , TO_CHAR(PD.CHA_APV,'YY"-"MM"-"DD')      AS CHA_APV            --사무차장결재일
             , TO_CHAR(PD.CHONG_APV,'YY"-"MM"-"DD')    AS CHONG_APV          --사무총장결재일
             , TO_CHAR(PD.WI_APV,'YY"-"MM"-"DD')       AS WI_APV             --주심위원결재일
             , TO_CHAR(PD.SBCN_DY,'YY"-"MM"-"DD')      AS SBCN_DY            --최초부의일
             , TO_CHAR(PD.ENF_DT,'YY"-"MM"-"DD')      AS ENF_DT               --최초시행일     
             , PD.AUD_KND_CD
             , PE.TSK_KEY1 AS ACP_YR
             , PE.TSK_KEY2 AS REQ_DVSN_CD
             , PE.TSK_KEY3 AS CVPT_ACP_NO
          FROM (
                   SELECT AA.AUD_YR         --감사년도
                         ,AA.AUD_NO         --감사번호
                         ,AA.HIRK_DPT_NM -- 국
                         ,AA.AUD_DPT_NM     --주관국과명
                         ,AA.AUD_DPT_FULL_NM     --주관국과명
                         ,AA.AUD_SBJ_NM     --감사사항명
                         ,AA.AUD_YR_NO      --감사번호
                         ,AA.AUD_KND_NM     --감사종류코드
                         ,AA.AUD_KND_CD
                         ,F_CODE_NM('1000742', AA.AUD_KND_CD2) AS AUD_DVSN_NM
                         ,AA.AUD_SCL_CD     --감사규모코드
                         ,AA.ENF_DT         --최초시행일
                         ,AA.REQ_NTAS_DCS_DT--청구국회결정일
                         ,BB.AUD_STR_DT00   --자료수집 시작일
                         ,BB.AUD_END_DT00   --자료수집 종료일
                         ,BB.AUD_STR_DT01   --예비조사 시작일
                         ,BB.AUD_END_DT01   --예비조사 종료일
                         ,BB.AUD_STR_DT02   --실지감사 시작일
                         ,BB.AUD_END_DT02   --실지감사 종료일
                         ,BB.AUD_STR_DT03   --실지감사연장 시작일
                         ,BB.AUD_END_DT03   --실지감사연장 종료일
                         ,BB.RETURN_DT      --귀청일
                         ,CC.E_CHA_APV      --종료보고 차장결재일
                         ,CC.E_CHONG_APV    --종료보고 총장결재일
                         ,CC.E_FNL_APV      --종료보고 최종결재일
                         ,DD.GWA_APV        --과장결재일
                         ,EE.RCPT_DH        --수신일시(접수)
                         ,EE.SND_DH         --송신일시(발신)
                         ,DD.GUK_APP        --국단실장접수일
                         ,DD.GUK_APV        --국단실장결재일
                         ,DD.CHA_APP        --사무차장접수일
                         ,DD.CHA_APV        --사무차장결재일
                         ,DD.CHONG_APP      --사무총장접수일
                         ,DD.CHONG_APV      --사무총장결재일
                         ,DD.WI_APP         --주심위원접수일
                         ,DD.WI_APV         --주심위원결재일
                         ,AA.SBCN_DY        --최초부의일
--                         ,F_GET_NUMBER_DAY(BB.RETURN_DT, NVL(AA.ENF_DT, TO_DATE(TO_CHAR(SYSDATE, 'YYYYMMDD')))) AS PROC_DY_CNT       --실제처리일수
			      		 , AA.REAL_HNDL_DT AS PROC_DY_CNT			--실제처리일수 (2019.04.05 LSR 수정)
--                         ,DECODE(DD.SYT_TRTM_DVSN_YN,'Y','종합','') AS SYT_TRTM_DVSN    --처리안구분
                         ,DECODE(AA.GNR_HNDL_PLAN_YN,'Y','종합','') AS SYT_TRTM_DVSN    --처리안구분 (2019.04.05 LSR 수정)
                         ,AA.EXTN_PRD_COFM_DT                                           --연장기간승인일
--                         ,AA.STAN_PROC_DAY                                              --기준처리일
                         ,AA.STAN_PROC_DAY+DECODE(AA.GNR_HNDL_PLAN_YN,'Y',AA.GNR_HNDL_PLAN_EXTN_DCN,0)+DECODE(AA.EXTN_PRD_COFM_DT,'',0,AA.EXTN_PRD_COFM_DT) AS STAN_PROC_DAY  --기준처리일 (2019.04.05 LSR 수정)
--                         ,(BB.RETURN_DT + AA.STAN_PROC_DAY) - 1 AS STAN_PROC_DT         --기준처리기한
                         , NVL(TO_DATE(AA.EXTN_HNDL_DDLN_DT), TO_DATE(AA.HNDL_DDLN_DT)) AS STAN_PROC_DT   --기준처리기한 (2019.04.05 LSR 수정)
--                         ,F_GET_NUMBER_DAY(BB.RETURN_DT,AA.ENF_DT) - AA.STAN_PROC_DAY AS STAN_EXCE_DAY    --기준초과일
			      		 ,(NVL(TRUNC((NVL(TO_DATE(TO_CHAR(AA.ENF_DT, 'YYYYMMDD')), TO_DATE(TO_CHAR(SYSDATE, 'YYYYMMDD'))) - TO_DATE(TO_CHAR(BB.RETURN_DT , 'YYYYMMDD'))) +1,0),0)) - (AA.STAN_PROC_DAY+DECODE(AA.GNR_HNDL_PLAN_YN,'Y',AA.GNR_HNDL_PLAN_EXTN_DCN,0)+DECODE(AA.EXTN_PRD_COFM_DT,'',0,AA.EXTN_PRD_COFM_DT)) AS STAN_EXCE_DAY    --기준초과일 (2019.04.05 LSR 수정)
                         ,DECODE(AA.AUD_KND_CD2,'2',AA.REQ_NTAS_DCS_DT+59,
                          DECODE(AA.AUD_KND_CD2,'3',ADD_MONTHS(AA.REQ_NTAS_DCS_DT,6),
                          DECODE(AA.AUD_KND_CD2,'4',ADD_MONTHS(AA.REQ_NTAS_DCS_DT,5),''))) AS AUD_DVSN_PROC_DT                --청구국회처리기한(2:국민3:공익4:국회)
                         ,AA.ENF_DT-(DECODE(AA.AUD_KND_CD2,'2',AA.REQ_NTAS_DCS_DT+59,
                                     DECODE(AA.AUD_KND_CD2,'3',ADD_MONTHS(AA.REQ_NTAS_DCS_DT,6),
                                     DECODE(AA.AUD_KND_CD2,'4',ADD_MONTHS(AA.REQ_NTAS_DCS_DT,5),'')))) AS AUD_DVSN_EXCE_DAY   --청구국회초과일수

                         /****************************** 출장일수계산 ******************************/
                         ,(AA.ENF_DT - DECODE(BB.AUD_STR_DT01,'',BB.AUD_STR_DT02,BB.AUD_STR_DT01))+1 AS AUD_TOT_DAY --감사전체일수(예비조사시작OR실지감사시작~시행일)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT00,BB.RETURN_DT)    AS AUD_READY_00                         --감사준비1         (자료수집시작~귀청일)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT00,BB.AUD_STR_DT01) AS AUD_PERIO_00                         --자료수집_총기간   (자료수집시작~예비조사시작)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT00,BB.AUD_END_DT00) AS AUD_BSRP_00                          --자료수집_실시     (자료수집시작~자료수집끝)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT00,BB.AUD_STR_DT01) - F_GET_NUMBER_DAY(BB.AUD_STR_DT00,BB.AUD_END_DT00) AS AUD_WAIT_00  --자료수집_대기(총기간-실시)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT01,BB.RETURN_DT)    AS AUD_READY_11                         --감사준비2         (예비조사시작~귀청일)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT01,BB.AUD_STR_DT02) AS AUD_PERIO_11                         --예비조사_총기간   (예비조사시작~실지감사시작)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT01,BB.AUD_END_DT01) AS AUD_BSRP_11                          --예비조사_실시     (예비조사시작~예비조사끝)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT01,BB.AUD_STR_DT02) - F_GET_NUMBER_DAY(BB.AUD_STR_DT01,BB.AUD_END_DT01) AS AUD_WAIT_11  --예비조사_대기(??기간-실시)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT02,BB.RETURN_DT)    AS AUD_PERIO_22                         --실지감사_총기간   (실지감사시작~귀청일)
                         --,AUD_BSRP_SUM_22             --◆SUM◆실지감사_합계(실지감사_실시+실지감사_연장)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT02,BB.AUD_END_DT02) AS AUD_BSRP_22                          --실지감사_실시     (실지감사시작~실지감사끝)
                         ,F_GET_NUMBER_DAY(BB.AUD_STR_DT03,BB.AUD_END_DT03) AS AUD_BSRP_33                          --실지감사_연장     (실지연장시작~실지연장끝)
                         --,AUD_WAIT_22                 --◆SUM◆실지감사_대기(실지감사_총기간-실지감사_합계)

                         /****************************** 보고서일수계산 ******************************/
                          --,PROC_TOT_NDAY              --◆SUM◆처리전체기간 (처리_결재기간+처리_부의기간)
                          --,PROC_APVR_NDAY             --◆SUM◆처리_결재기간(과장_합계기간+국장_결재기간+총차장_합계기간)
                          --,GWA_APVR_SUM_NDAY          --◆SUM◆과장_합계기간(과장_종료보고기간+과장_결재기간+과장_접수대기기간)
                         ,F_GET_NUMBER_DAY(BB.RETURN_DT,CC.E_FNL_APV)   AS GWA_END_RPT_NDAY --과장_종료보고기간(귀청일~종료보고최종결재)
                         ,F_GET_NUMBER_DAY(CC.E_FNL_APV,DD.GWA_APV)     AS GWA_APV_NDAY     --과장_결재기간(종료보고최종결재~과장결재)
                          --,GWA_APP_WAIT_NDAY          --◆SUM◆과장_접수대기기간(귀청일~시행일)-(과장_종료보고기간+과장_결재기간+국장_결재기간+총차장_합계기간+처리_부의기간)
                         ,CASE WHEN TO_CHAR(DD.GUK_APP,'YYYYMMDD') > TO_CHAR(DD.GWA_APV,'YYYYMMDD') THEN F_GET_NUMBER_DAY(DD.GUK_APP,DD.GUK_APV)
                               ELSE F_GET_NUMBER_DAY(DD.GUK_APP,DD.GUK_APV)-1
                               END AS GUK_APV_NDAY      --국장_결재기간(국장접수~국장종결)
                         ,F_GET_NUMBER_DAY(EE.RCPT_DH,EE.SND_DH)        AS PUM_APV_NDAY     --품질_결재기간(품질접수~품질종결)
                          --,CHONG_CHA_APV_SUM_NDAY     --◆SUM◆총차장_합계기간(차장_결재기간+총장_결재기간)
                         ,CASE WHEN TO_CHAR(DD.CHA_APP,'YYYYMMDD') > TO_CHAR(DD.GUK_APV,'YYYYMMDD') THEN F_GET_NUMBER_DAY(DD.CHA_APP,DD.CHA_APV)
                               ELSE F_GET_NUMBER_DAY(DD.CHA_APP,DD.CHA_APV)-1
                               END AS CHA_APV_NDAY      --차장_결재기간(차장접수~차장종결)
                         ,CASE WHEN TO_CHAR(DD.CHONG_APP,'YYYYMMDD') > TO_CHAR(DD.CHA_APV,'YYYYMMDD') THEN F_GET_NUMBER_DAY(DD.CHONG_APP,DD.CHONG_APV)
                               ELSE F_GET_NUMBER_DAY(DD.CHONG_APP,DD.CHONG_APV)-1
                               END AS CHONG_APV_NDAY    --총장_결재기간(총장접수~총장종결)
                          --,PROC_SBCN_NDAY             --◆SUM◆처리_부의기간(위원_결재기간+위원_회의+시행)
                          --,WI_APV_SUM_NDAY            --◆SUM◆위원_합계(위원_결재기간+위원_회의)
                         ,CASE WHEN TO_CHAR(DD.CHONG_APV,'YYYYMMDD') = ''
                               THEN (CASE WHEN TO_CHAR(DD.WI_APP,'YYYYMMDD') > TO_CHAR(DD.CHA_APV,'YYYYMMDD') THEN F_GET_NUMBER_DAY(DD.WI_APP,DD.WI_APV)
                                          ELSE F_GET_NUMBER_DAY(DD.WI_APP,DD.WI_APV)-1
                                           END)
                               ELSE (CASE WHEN TO_CHAR(DD.WI_APP,'YYYYMMDD') > TO_CHAR(DD.CHONG_APV,'YYYYMMDD') THEN F_GET_NUMBER_DAY(DD.WI_APP,DD.WI_APV)
                                          ELSE F_GET_NUMBER_DAY(DD.WI_APP,DD.WI_APV)-1
                                           END)
                               END AS WI_APV_NDAY       --위원_결재기간(위원접수~위원종결)
                         ,CASE WHEN TO_CHAR(AA.SBCN_DY,'YYYYMMDD') > TO_CHAR(DD.WI_APV,'YYYYMMDD') THEN F_GET_NUMBER_DAY(DD.WI_APV,AA.SBCN_DY)
                               ELSE 0
                               END AS WI_SBCN_NDAY      --위원_회의(위원종결~위원회의)
                         ,CASE WHEN TO_CHAR(AA.SBCN_DY,'YYYYMMDD') = ''
                               THEN (CASE WHEN TO_CHAR(AA.ENF_DT,'YYYYMMDD') > TO_CHAR(DD.WI_APV,'YYYYMMDD') THEN F_GET_NUMBER_DAY(DD.WI_APV,AA.ENF_DT)-1
                                          ELSE 0
                                           END)
                               ELSE (CASE WHEN TO_CHAR(AA.ENF_DT,'YYYYMMDD') > TO_CHAR(AA.SBCN_DY,'YYYYMMDD') THEN F_GET_NUMBER_DAY(AA.SBCN_DY,AA.ENF_DT)-1
                                          ELSE 0
                                           END)
                               END AS ENF_NDAY          --시행(위원회의~시행일)
                         ,(SELECT -- F1.AUD_YR
                                  --,F1.AUD_NO
                                  --,COUNT(F1.REFER_DVSN_CD) --부의구분코드(D10:부의,D11:분리부의,D12:재부의,E10:위임)
                                  --,SUM(DECODE(F1.REFER_DVSN_CD,'E10',1,0))
                                  DECODE(COUNT(F1.REFER_DVSN_CD),SUM(DECODE(F1.REFER_DVSN_CD,'E10',1,0)),'전부위임','')
                             FROM TBBADDED145M F1
                            WHERE F1.AUD_NO         = AA.AUD_NO
                              AND F1.AUD_STEP_CD    = 'A1070' --감사부의
                            GROUP BY F1.AUD_YR,F1.AUD_NO) AS REMARK --특이사항
                         ,(SELECT CASE WHEN G4.TRTM_EXAMER_CNT > 1
                                       THEN F_USR_INFO(G5.CNB, '2') || ' 등 ' || G4.TRTM_EXAMER_CNT
                                       ELSE F_USR_INFO(G5.CNB, '2')
                                   END AS USR_TRTM_EXAMER_CNT
                             FROM (SELECT G2.AUD_YR
                                         ,G2.AUD_NO
                                         --,G2.DOC_ID
                                         ,COUNT(DISTINCT(G2.TRTM_EXAMER_CNB)) AS TRTM_EXAMER_CNT
                                         ,MIN(G3.RNUM) AS RNUM
                                     FROM TBBADDED145M G2
                                         ,(SELECT ROWNUM AS RNUM ,CNB
                                          FROM (SELECT G1.CNB
                                                  FROM TBDCMACM001M G1
                                                 ORDER BY G1.RAL_BLT_DIV_CD              --실소속과코드
                                                     , NVL(G1.INN_RANK_CD,'50') ASC   --내부직급코드
                                                     , G1.RANK_SRT_SEQ_NM             --직급정렬순서명
                                                     , G1.CRNT_RANK_APM_DT            --현직급임용일
                                                     , G1.SRT_KY_NO                   --정렬키번호
                                                     , G1.CRNT_DPT_APM_DT             --현부서임용일
                                               )) AS G3
                                    WHERE 1=1
                                      AND G2.AUD_STEP_CD        = 'A1060'   --감사결과처리
                                      AND G2.APVR_CD            = '0013600' --과장
                                      AND G2.TRTM_EXAMER_CNB    = G3.CNB
                                      AND G2.TRTM_EXAMER_CNB IS NOT NULL
                                    GROUP BY G2.AUD_YR,G2.AUD_NO--,G2.DOC_ID
                                   ) AS G4
                                 ,(SELECT ROWNUM AS RNUM ,CNB
                                  FROM (SELECT G1.CNB
                                          FROM TBDCMACM001M G1
                                         ORDER BY G1.RAL_BLT_DIV_CD              --실소속과코드
                                             , NVL(G1.INN_RANK_CD,'50') ASC   --내부직급코드
                                             , G1.RANK_SRT_SEQ_NM             --직급정렬순서명
                                             , G1.CRNT_RANK_APM_DT            --현직급임용일
                                             , G1.SRT_KY_NO                   --정렬키번호
                                             , G1.CRNT_DPT_APM_DT             --현부서임용일
                                       )) AS G5
                              WHERE G4.RNUM     = G5.RNUM
                                AND G4.AUD_YR   = AA.AUD_YR
                                AND G4.AUD_NO   = AA.AUD_NO
                          ) AS IN_CHARGE_NM         --담당조정관(보고서전체)
                         --,() AS PROC_NDAY_VERI    --처리일수검증--◆SUM◆
                         ,F_GET_NUMBER_DAY(BB.RETURN_DT,CC.E_CHA_APV) AS END_RPT_PROC_CNT --실지감사종료보고소요기간
                         ,(SELECT COUNT(*)
                            FROM TBBADDED013B
                           WHERE YE||MD BETWEEN BB.RETURN_DT AND CC.E_CHA_APV) AS HLDY_CNT

                     FROM (SELECT A1.AUD_YR         --감사년도
                                 , A1.AUD_NO         --감사번호
                                 , A1.AUD_KND_CD     --감사종류코드(1:재무,2:특정,3:성과,4:기관,5:확인,9:서면)
                                 , A1.SPV_BRDV_CD    --주관국과코드
                                 , NVL((	SELECT	S1.ABR_DPT_NM_1
						   						FROM	TBDCMACM002M S1
						   						WHERE	S1.DPT_CD = (SELECT A2.HIRK_DPT_CD
				                                                     FROM TBDCMACM002M A2
				                                                    WHERE A2.DPT_CD =  A1.SPV_BRDV_CD)
						   					)   ,  (	SELECT	S1.ABR_DPT_NM_1
																			   						FROM	TBDCMACM002M S1
																			   						WHERE	S1.DPT_CD = A1.SPV_BRDV_CD
																			   					)    ) AS HIRK_DPT_NM    /* 국 */
                                                   ,(SELECT A2.DPT_NM
                                                       FROM TBDCMACM002M A2
                                                      WHERE A2.DPT_CD = A1.SPV_BRDV_CD) AS AUD_DPT_FULL_NM    --주관국과명
                                                      , (	SELECT	S1.ABR_DPT_NM_1
										   						FROM	TBDCMACM002M S1
										   						WHERE	S1.DPT_CD = A1.SPV_BRDV_CD
										   					) AS AUD_DPT_NM    /* 과 */
                                                      ,A1.AUD_SBJ_NM    --감사사항명
                                                      ,F_MNG_KND_AUDYRNO(A1.AUD_YR, A1.AUD_NO, A1.AUD_KND_CD, '-') AS AUD_YR_NO --감사번호
                                                      ,F_CODE_NM('1000007',A1.AUD_KND_CD) AS AUD_KND_NM     --감사종류코드
                                                      ,F_CODE_NM('1000027',A1.AUD_SCL_CD) AS AUD_SCL_CD     --감사규모코드
                                                      ,TO_DATE(A5.ENF_APV_DT) AS ENF_DT   --최초시행일
                                                      ,(SELECT A6.DVSN_CD FROM TBBADDED030L A6
                                                         WHERE A6.AUD_YR = A1.AUD_YR
                                                           AND A6.AUD_NO = A1.AUD_NO
                                                           AND A6.SRNO = 1) AS AUD_KND_CD2  --종류코드2(1:민원2:국민3:공익4:국회5:심사6:재심8:손망9:판청)
                                                      ,(SELECT MIN(TO_DATE(A4.SBCN_DY))
                                                          FROM TBBADDED113M A4
                                                         WHERE A4.AUD_YR = A1.AUD_YR
                                                           AND A4.AUD_NO = A1.AUD_NO
                                                         GROUP BY A4.AUD_YR,A4.AUD_NO) AS SBCN_DY   --최초부의일
                                                      ,A5.EXTN_PRD_COFM_DT  --연장기간승인일
                                                      /****************************** 청구국회결정일,기준처리일 가져와야함 ******************************/
                                                      ,TO_DATE(A5.REQ_NTAS_DCS_DT) AS REQ_NTAS_DCS_DT   --청구국회결정일
                                                      ,STAD_HNDL_DCN AS STAN_PROC_DAY                   --기준처리일
                                                      , GNR_HNDL_PLAN_YN											-- (2019.04.05 LSR 추가)
			                                          , HNDL_DDLN_DT												-- (2019.04.05 LSR 추가)
			                                          , EXTN_HNDL_DDLN_DT											-- (2019.04.05 LSR 추가)
			                                          , RTN_DT														-- (2019.04.05 LSR 추가)
			                                          , ENF_APV_DT													-- (2019.04.05 LSR 추가)
                                      				  , NVL(F_GNR_HNDL_PLAN_EXTN_DCN(A1.AUD_YR, A1.AUD_NO), 0) AS GNR_HNDL_PLAN_EXTN_DCN			-- (2019.04.05 LSR 추가)
			                                          , NVL(CASE WHEN NVL(A5.EXTN_PRD_COFM_DT, 0) > 0 OR NVL(A5.GNR_HNDL_PLAN_YN, 'N') = 'Y'
						                         			THEN F_EXTN_HNDL_DT_CNT(A5.AUD_YR, A5.AUD_NO, TO_CHAR(TO_DATE(A5.RTN_DT)-1, 'YYYYMMDD'), NVL(A5.ENF_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '5', '9', 'T')
						                         			ELSE F_HNDL_DT_CNT(A5.AUD_YR, A5.AUD_NO, TO_CHAR(TO_DATE(A5.RTN_DT)-1, 'YYYYMMDD'), NVL(A5.ENF_APV_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), '2', '9')
						                         		END, 0) AS REAL_HNDL_DT										-- (2019.04.18 LSR 추가)
                              FROM TBBADDED001M A1
                                  ,TBBADDED003M A5
                             WHERE A1.AUD_YR = A5.AUD_YR(+)
                               AND A1.AUD_NO = A5.AUD_NO(+)
                               )  AA /* 기본정보 : BASIS_INFO */
                         ,(SELECT B2.REL_AUD_YR AS AUD_YR
                                  ,B2.REL_AUD_NO AS AUD_NO
                                  ,MIN(B2.AUD_STR_DT00) AS AUD_STR_DT00 --자료수집 시작일
                                  ,MAX(B2.AUD_END_DT00) AS AUD_END_DT00 --자료수집 종료일
                                  ,MIN(B2.AUD_STR_DT01) AS AUD_STR_DT01 --예비조사 시작일
                                  ,MAX(B2.AUD_END_DT01) AS AUD_END_DT01 --예비조사 종료일
                                  ,MIN(B2.AUD_STR_DT02) AS AUD_STR_DT02 --실지감사 시작일
                                  ,MAX(B2.AUD_END_DT02) AS AUD_END_DT02 --실지감사 종료일
                                  ,MIN(B2.AUD_STR_DT03) AS AUD_STR_DT03 --실지감사연장 시작일
                                  ,MAX(B2.AUD_END_DT03) AS AUD_END_DT03 --실지감사연장 종료일
                                  ,MAX(B2.AUD_END_DT02)+1 AS RETURN_DT  --귀청일
                              FROM (SELECT B1.REL_AUD_YR,B1.REL_AUD_NO
                                          ,DECODE(B1.AUD_BZT_KND_CD,'00',TO_DATE(AUD_STR_DT)) AS AUD_STR_DT00
                                          ,DECODE(B1.AUD_BZT_KND_CD,'00',TO_DATE(AUD_END_DT)) AS AUD_END_DT00
                                          ,DECODE(B1.AUD_BZT_KND_CD,'01',TO_DATE(AUD_STR_DT)) AS AUD_STR_DT01
                                          ,DECODE(B1.AUD_BZT_KND_CD,'01',TO_DATE(AUD_END_DT)) AS AUD_END_DT01
                                          ,DECODE(B1.AUD_BZT_KND_CD,'02',TO_DATE(AUD_STR_DT)) AS AUD_STR_DT02
                                          ,DECODE(B1.AUD_BZT_KND_CD,'02',TO_DATE(AUD_END_DT)) AS AUD_END_DT02
                                          ,DECODE(B1.AUD_BZT_KND_CD,'03',TO_DATE(AUD_STR_DT)) AS AUD_STR_DT03
                                          ,DECODE(B1.AUD_BZT_KND_CD,'03',TO_DATE(AUD_END_DT)) AS AUD_END_DT03
                                      FROM TBBADDED002M B1
                                   ) B2
                             GROUP BY B2.REL_AUD_YR,B2.REL_AUD_NO) BB /* 출장정보 : BSRP_INFO */
                         ,(SELECT C1.AUD_YR
                                ,C1.AUD_NO
                                --,C2.APV_SNO        --결재순번
                                --,C1.RPRT_CD        --보고서코드
                                --,C2.APVR_PST_CD    --결재자직위코드
                                --,F_CODE_NM('1000176', C2.APVR_PST_CD) AS PST_NM                --결재자직위명
                                --,C2.APVR_CNB       --결재자전산번호
                                --,F_USR_INFO(C2.APVR_CNB, '2') AS APVR_NM                       --결재자명
                                --,TO_CHAR(C2.APV_DH, 'YYYY-MM-DD') AS APV_DH                    --결재일
                                ,MAX(DECODE(C2.APVR_PST_CD,'0013600',C2.APV_DH,'')) AS E_GWA_APV   --과장결재일
                                ,MAX(DECODE(C2.APVR_PST_CD,'0015800',C2.APV_DH
                                    ,DECODE(C2.APVR_PST_CD,'0035100',C2.APV_DH
                                    ,DECODE(C2.APVR_PST_CD,'0058100',C2.APV_DH,'')))) AS E_GUK_APV --국장결재일(국장:0015800,단장:0035100,실장:0058100)
                                ,MAX(DECODE(C2.APVR_PST_CD,'0055600',C2.APV_DH,DECODE(C2.APVR_PST_CD,'0045900',C2.APV_DH,''))) AS E_CHA_APV   --차장결재일   /* 0045900 : 본부장 추가 */
                                ,MAX(DECODE(C2.APVR_PST_CD,'0055700',C2.APV_DH,'')) AS E_CHONG_APV --총장결재일
                                ,MAX(DECODE(C2.APVR_PST_CD,'0067400',C2.APV_DH,'')) AS E_WON_APV   --원장결재일
                                ,MAX(DECODE(C1.APV_STA_CD,'30',C2.APV_DH,''))       AS E_FNL_APV   --최종결재일
                            FROM TBBADDED103M C1
                                ,TBDCMACM023L C2
                           WHERE 1=1
                             AND C1.APV_RQS_ID  = C2.APV_DOC_NO
                             --AND C1.AUD_NO      = '797'  --TEST
                             AND C1.RPRT_CD     = 'A10500200' --종료보고서
                           --ORDER BY C2.APV_SNO
                           GROUP BY C1.AUD_YR,C1.AUD_NO)      CC	/* 종료보고 결재정보 : END_APV_INFO */
                         ,(SELECT D3.AUD_YR
                                 ,D3.AUD_NO
                                 ,MAX(D3.GWA_APV)          AS GWA_APV
                                 ,MAX(D3.GUK_APP)          AS GUK_APP
                                 ,MAX(D3.GUK_APV)          AS GUK_APV
                                 ,MAX(D3.CHA_APP)          AS CHA_APP
                                 ,MAX(D3.CHA_APV)          AS CHA_APV
                                 ,MAX(D3.CHONG_APP)        AS CHONG_APP
                                 ,MAX(D3.CHONG_APV)        AS CHONG_APV
                                 ,MAX(D3.FNL_APV)          AS FNL_APV
                                 ,MAX(D3.WI_APP)           AS WI_APP
                                 ,MAX(D3.WI_APV)           AS WI_APV
                                 ,MAX(D3.SYT_TRTM_DVSN_YN) AS SYT_TRTM_DVSN_YN
                             FROM (
                                   SELECT D1.AUD_YR
                                         ,D1.AUD_NO
                                   --      ,D2.APV_SNO        --결재순번
                                   --      ,D2.APVR_SEQ       --결재SEQ
                                   --      ,D1.RPRT_CD        --보고서코드
                                   --      ,D1.APV_RQS_ID     --결재요청ID
                                   --      ,D2.APVR_KND_CD    --결재자종류코드(1:기안자,2:검토자,3:결재자,4:협조자,5:전결자,6:대결자,7:제출자)
                                   --      ,D2.APVR_PST_CD    --결재자직위코드
                                   --      ,F_CODE_NM('1000176', D2.APVR_PST_CD) AS PST_NM            --결재자직위명
                                   --      ,D2.APVR_CNB                                               --결재자전산번호
                                   --      ,F_USR_INFO(D2.APVR_CNB, '2') AS APVR_NM                   --결재자명
                                   --      ,TO_CHAR(D2.APV_DH, 'YYYY-MM-DD') AS APV_DH                --결재일
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D2.APVR_PST_CD,'0013600',D2.APV_DH,''),'')                                 AS GWA_APV   --과장결재일
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D2.APVR_PST_CD,'0015800',LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D2.APV_SNO,D2.APVR_SEQ)
                                                                  ,DECODE(D2.APVR_PST_CD,'0035100',LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D2.APV_SNO,D2.APVR_SEQ)
                                                                  ,DECODE(D2.APVR_PST_CD,'0058100',LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D2.APV_SNO,D2.APVR_SEQ),''))),'') AS GUK_APP   --국단실장접수일
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D2.APVR_PST_CD,'0015800',D2.APV_DH
                                                                  ,DECODE(D2.APVR_PST_CD,'0035100',D2.APV_DH
                                                                  ,DECODE(D2.APVR_PST_CD,'0058100',D2.APV_DH,''))),'')                               AS GUK_APV   --국단실장결재일
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D2.APVR_PST_CD,'0055600',LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D2.APV_SNO,D2.APVR_SEQ),
                                                                                          DECODE(D2.APVR_PST_CD,'0045900',LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D2.APV_SNO,D2.APVR_SEQ),'')),'')   AS CHA_APP   --사무차장접수일    /* 0045900 : 본부장 추가 */
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D2.APVR_PST_CD,'0055600',D2.APV_DH,DECODE(D2.APVR_PST_CD,'0045900',D2.APV_DH,'')),'')                                 AS CHA_APV   --사무차장결재일 /* 0045900 : 본부장 추가 */
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D2.APVR_PST_CD,'0055700',LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D2.APV_SNO,D2.APVR_SEQ),''),'')   AS CHONG_APP --사무총장접수일
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D2.APVR_PST_CD,'0055700',D2.APV_DH,''),'')                                 AS CHONG_APV --사무총장결재일
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D1.APV_STA_CD,'30',D2.APV_DH,''),'')                                       AS FNL_APV   --최종결재일
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D2.APVR_PST_CD,'0010600',LAG(D2.APV_DH) OVER (ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D2.APV_SNO,D2.APVR_SEQ),''),'')   AS WI_APP    --주심위원접수일
                                         ,DECODE(D2.APVR_KND_CD,'3',DECODE(D2.APVR_PST_CD,'0010600',D2.APV_DH,''),'')                                 AS WI_APV    --주심위원결재일
                                         ,D1.SYT_TRTM_DVSN_YN
                                     FROM TBBADDED103M D1
                                         ,TBDCMACM023L D2
                                    WHERE D1.APV_RQS_ID       = D2.APV_DOC_NO
                                      AND D1.RPRT_CD          IN ('A10600200','A10700100') --감사보고서,주심위원설명자료
                                      AND D1.AUD_RPRT_DVSN_CD = '10'   --TEST (10:본안,20:우선,30:별도,40:재부의)
                                    ORDER BY D1.AUD_YR,D1.AUD_NO,D1.RPRT_CD,D2.APV_SNO,D2.APVR_SEQ
                                   ) D3
                            GROUP BY D3.AUD_YR,D3.AUD_NO) DD  /* 감사보고서(위원) 결재정보 : AUD_RPRT_APV_INFO */
                         ,(SELECT E1.AUD_YR
                                ,E1.AUD_NO
                                ,MAX(DECODE(E1.RPRT_CD,'A10600200',E1.RCPT_DH)) AS RCPT_DH --수신일시(접수)
                                ,MAX(DECODE(E1.RPRT_CD,'A10600400',E1.SND_DH))  AS SND_DH  --송신일시(발신)
                            FROM TBBADDED111M E1
                           WHERE E1.AUD_RPRT_DVSN_CD = '10'        --감사보고서구분코드(10:본안,20:우선,30:별도,40:재부의)
                             /* 감사보고서&수신부서(품질) OR 처리안검토의견서취합&발신부서(품질) */
                             AND ((E1.RPRT_CD = 'A10600200' AND E1.RCPT_DPT_CD = '160200') OR (E1.RPRT_CD = 'A10600400' AND E1.SND_DPT_CD  = '160200'))
                             AND E1.DOC_STA_CD       = '20'        --문서상태(10:발신,11:발신취소,20:접수,30:서면의결,90:반려)
                           GROUP BY E1.AUD_YR,E1.AUD_NO)  EE	/* 감사보고서 품질접수발신일 : AUD_RPRT_SR_INFO */
                    WHERE AA.AUD_YR = BB.AUD_YR(+) AND AA.AUD_NO = BB.AUD_NO(+)
                      AND AA.AUD_YR = CC.AUD_YR(+) AND AA.AUD_NO = CC.AUD_NO(+)
                      AND AA.AUD_YR = DD.AUD_YR(+) AND AA.AUD_NO = DD.AUD_NO(+)
                      AND AA.AUD_YR = EE.AUD_YR(+) AND AA.AUD_NO = EE.AUD_NO(+)
                    ORDER BY AA.AUD_YR,AA.AUD_NO
               ) PD
               INNER JOIN TBBADDED030L PE ON(PE.AUD_YR = PD.AUD_YR AND PE.AUD_NO = PD.AUD_NO)
        ORDER BY PD.AUD_YR,PD.AUD_NO) C ON(A.REQ_DVSN_CD = C.REQ_DVSN_CD AND A.ACP_YR = C.ACP_YR AND A.CVPT_ACP_NO = C.CVPT_ACP_NO AND SUBSTR(C.AUD_KND_CD,3,1) <> '5')
        WHERE 1=1
		]]>
		<if test="hndlChgrId != null and hndlChgrId != ''">
		AND A.HNDL_CHGR_ID = #{hndlChgrId}
		</if>
		
		
		ORDER BY A.ACP_DH DESC
		
	</select>

	<select id="selectSttcChartList" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectSttcChartList*/
		<![CDATA[
    	WITH BASE AS (SELECT 
				REQ_DVSN_NM,
				입건 AS CNT5
				,불문 AS CNT3
				,기각 AS CNT1
				,각하 AS CNT2
				,기각각하 AS CNT6
				,취하 AS CNT7
				,이첩 AS CNT4
				FROM (
				
				    SELECT
				
				    '국민' AS REQ_DVSN_NM, --'국민' AS DVSN_NM,
				    /* 국민 입건 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E
				
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND C.TSK_KEY2 = A.REQ_DVSN_CD
				               AND C.TSK_KEY1 = A.ACP_YR
				               AND C.TSK_KEY3 = A.CVPT_ACP_NO
				               AND D.AUD_YR = C.AUD_YR
				               AND D.AUD_NO = C.AUD_NO
				               AND D.AUD_YR = E.AUD_YR
				               AND D.AUD_NO = E.AUD_NO
				               AND A.REQ_DVSN_CD = '2'
				               AND SUBSTR(D.AUD_KND_CD,'3','1') <> '5'
				               AND E.ENF_APV_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')
					]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
		 			<![CDATA[
				    ) AS 입건 ,
				
				    /* 국민 불문 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E,
				    (SELECT AUD_YR, AUD_NO, APV_RQS_ID FROM TBBADDED103M WHERE RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050'
				                     AND RPRT_NM LIKE '%종료%') F,
				    (SELECT APV_DOC_NO, APVR_PST_CD, APVR_STA_CD, APV_DH FROM TBDCMACM023L WHERE APVR_PST_CD IN ('0045900','0055600') AND APVR_STA_CD = '203') G,
				    (SELECT AUD_YR, AUD_NO, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10951400' AND AUD_STEP_CD = 'A1060'
				                     AND RPRT_NM LIKE '%불문%' AND APV_STA_CD = '30') H
				
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND C.TSK_KEY2 = A.REQ_DVSN_CD
				               AND C.TSK_KEY1 = A.ACP_YR
				               AND C.TSK_KEY3 = A.CVPT_ACP_NO
				               AND D.AUD_YR = C.AUD_YR
				               AND D.AUD_NO = C.AUD_NO
				               AND D.AUD_YR = E.AUD_YR
				               AND D.AUD_NO = E.AUD_NO
				               AND E.AUD_YR = F.AUD_YR
				               AND E.AUD_NO = F.AUD_NO
				               AND F.APV_RQS_ID = G.APV_DOC_NO(+)
				               AND E.AUD_YR = H.AUD_YR(+)
				               AND E.AUD_NO = H.AUD_NO(+)        
				               AND A.REQ_DVSN_CD = '2' 
				               
				               
				               
				               AND (((TO_CHAR(G.APV_DH,'YYYY') >= TO_CHAR(SYSDATE, 'YYYY') OR TO_CHAR(H.FNL_MDF_DH,'YYYY') >= TO_CHAR(SYSDATE, 'YYYY')) AND B.AUD_RSLT_CD IS NULL) 
				                    OR (B.AUD_RSLT_CD = '07'
				                       AND B.AUD_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'))
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 불문 ,
				
				    /* 국민 기각 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, 
				    (SELECT T2.AUD_YR , T2.AUD_NO, T1.TSK_KEY1, T1.TSK_KEY2, T1.TSK_KEY3  FROM TBBADDED030L T1, TBBADDED001M T2 WHERE T1.AUD_YR = T2.AUD_YR 
				                          AND T1.AUD_NO = T2.AUD_NO AND SUBSTR(T2.AUD_KND_CD,'3','1') <> '5') C ,
				
				    TBBADDED003M D
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND A.REQ_DVSN_CD = C.TSK_KEY2(+)
				               AND A.ACP_YR      = C.TSK_KEY1(+)
				               AND A.CVPT_ACP_NO = C.TSK_KEY3(+)
				               AND C.AUD_YR = D.AUD_YR(+)
				               AND C.AUD_NO = D.AUD_NO(+)
				               AND A.REQ_DVSN_CD = '2' 
				               
				                      AND CASE WHEN B.AUD_RSLT_CD IS NULL AND B.REQ_EXAM_RSLT_CD = '02'
				                             AND C.AUD_YR IS NULL
				                            AND 
				                     ((SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO AND D1.RPRT_CD = 'C10220100' AND D1.APV_STA_CD = '30')
				                                                         >= TO_CHAR(SYSDATE, 'YYYY') OR (B.EXAM_RPT_APV_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'))
				
				                      
				                      THEN 1
				                               WHEN B.AUD_RSLT_CD IS NOT NULL AND B.AUD_RSLT_CD = '02' AND B.AUD_RSLT_RPL_DT IS NOT NULL THEN 1
				                                ELSE 0
				                                END = 1
				                                        AND (B.EXAM_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR B.AUD_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'
				                           OR B.EXAM_RPT_APV_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR 
				                           (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO AND D1.RPRT_CD = 'C10220300' AND D1.APV_STA_CD = '30')
				                           >= TO_CHAR(SYSDATE, 'YYYY')
				                           ) 
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 기각 ,
				
				    /* 국민 각하 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, 
				    (SELECT T2.AUD_YR , T2.AUD_NO, T1.TSK_KEY1, T1.TSK_KEY2, T1.TSK_KEY3  FROM TBBADDED030L T1, TBBADDED001M T2 WHERE T1.AUD_YR = T2.AUD_YR 
				                          AND T1.AUD_NO = T2.AUD_NO AND SUBSTR(T2.AUD_KND_CD,'3','1') <> '5') C ,
				
				    TBBADDED003M D
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND A.REQ_DVSN_CD = C.TSK_KEY2(+)
				               AND A.ACP_YR      = C.TSK_KEY1(+)
				               AND A.CVPT_ACP_NO = C.TSK_KEY3(+)
				               AND C.AUD_YR = D.AUD_YR(+)
				               AND C.AUD_NO = D.AUD_NO(+)
				               AND A.REQ_DVSN_CD = '2' 
				               
				                                    AND CASE WHEN B.AUD_RSLT_CD IS NULL AND B.REQ_EXAM_RSLT_CD = '03'
				
				                      THEN 1
				                               WHEN B.AUD_RSLT_CD IS NOT NULL AND B.AUD_RSLT_CD = '03' AND B.AUD_RSLT_RPL_DT IS NOT NULL THEN 1
				                                ELSE 0
				                                END = 1
				                                        AND (B.EXAM_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR B.AUD_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'
				                           OR B.EXAM_RPT_APV_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR 
				                           (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO AND D1.RPRT_CD = 'C10220300' AND D1.APV_STA_CD = '30')
				                           >= TO_CHAR(SYSDATE, 'YYYY') 
				                           ) 
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 각하 ,
				
				    /* 국민 기각/각하 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, 
				    (SELECT T2.AUD_YR , T2.AUD_NO, T1.TSK_KEY1, T1.TSK_KEY2, T1.TSK_KEY3  FROM TBBADDED030L T1, TBBADDED001M T2 WHERE T1.AUD_YR = T2.AUD_YR 
				                          AND T1.AUD_NO = T2.AUD_NO AND SUBSTR(T2.AUD_KND_CD,'3','1') <> '5') C ,
				
				    TBBADDED003M D
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND A.REQ_DVSN_CD = C.TSK_KEY2(+)
				               AND A.ACP_YR      = C.TSK_KEY1(+)
				               AND A.CVPT_ACP_NO = C.TSK_KEY3(+)
				               AND C.AUD_YR = D.AUD_YR(+)
				               AND C.AUD_NO = D.AUD_NO(+)
				               AND A.REQ_DVSN_CD = '2' 
				                      AND CASE WHEN B.AUD_RSLT_CD IS NULL AND B.REQ_EXAM_RSLT_CD = '03'
				                            AND 
				                     (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO AND D1.RPRT_CD = 'C10220100' AND D1.APV_STA_CD = '30')
				                                                         >= TO_CHAR(SYSDATE, 'YYYY')
				                      
				                      THEN 1
				                               WHEN B.AUD_RSLT_CD IS NOT NULL AND B.AUD_RSLT_CD = '03' AND B.AUD_RSLT_RPL_DT IS NOT NULL THEN 1
				                                ELSE 0
				                                END = 1
				                                        AND (B.EXAM_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR B.AUD_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'
				                           OR B.EXAM_RPT_APV_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR 
				                           (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO AND D1.RPRT_CD = 'C10220300' AND D1.APV_STA_CD = '30')
				                           >= TO_CHAR(SYSDATE, 'YYYY')
				                           ) 
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 기각각하 ,
				
				    /* 국민 취하 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B
				                    WHERE 1=1
				                      AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
				                      AND A.ACP_YR = B.ACP_YR(+)
				                      AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
				                      AND A.REQ_DVSN_CD = '2'
				                      AND (A.CVPT_WDW_DH IS NOT NULL OR AUD_RSLT_CD = '08')
				                      AND TO_CHAR(A.CVPT_WDW_DH, 'YYYY') = TO_CHAR(SYSDATE, 'YYYY')
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 취하 ,
				
				    /* 국민 이첩 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B
				                    WHERE 1=1
				                      AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				                      AND A.ACP_YR = B.ACP_YR
				                      AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				                      AND A.REQ_DVSN_CD = '2'
				                      AND (B.REQ_EXAM_RSLT_CD = '05' OR AUD_RSLT_CD = '05')
				                      AND (B.EXAM_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR B.AUD_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'
				                           OR B.EXAM_RPT_APV_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101')
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 이첩
				
				
				    FROM DUAL
				
				    UNION ALL                  
				
				    SELECT
				
				    '공익' AS DVSN_CD,--'공익' AS DVSN_NM,
				   
				
				    /* 공익 입건 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E
				
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND C.TSK_KEY2 = A.REQ_DVSN_CD
				               AND C.TSK_KEY1 = A.ACP_YR
				               AND C.TSK_KEY3 = A.CVPT_ACP_NO
				               AND D.AUD_YR = C.AUD_YR
				               AND D.AUD_NO = C.AUD_NO
				               AND D.AUD_YR = E.AUD_YR
				               AND D.AUD_NO = E.AUD_NO
				               AND A.REQ_DVSN_CD = '3'
				               AND SUBSTR(D.AUD_KND_CD,'3','1') <> '5'
				               AND E.ENF_APV_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 입건 ,
				
				    /* 공익 불문 */
				
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E,
				    (SELECT AUD_YR, AUD_NO, APV_RQS_ID FROM TBBADDED103M WHERE RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050'
				                     AND RPRT_NM LIKE '%종료%') F,
				    (SELECT APV_DOC_NO, APVR_PST_CD, APVR_STA_CD, APV_DH FROM TBDCMACM023L WHERE APVR_PST_CD IN ('0045900','0055600') AND APVR_STA_CD = '203') G,
				    (SELECT AUD_YR, AUD_NO, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10951400' AND AUD_STEP_CD = 'A1060'
				                     AND RPRT_NM LIKE '%불문%' AND APV_STA_CD = '30') H
				
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND C.TSK_KEY2 = A.REQ_DVSN_CD
				               AND C.TSK_KEY1 = A.ACP_YR
				               AND C.TSK_KEY3 = A.CVPT_ACP_NO
				               AND D.AUD_YR = C.AUD_YR
				               AND D.AUD_NO = C.AUD_NO
				               AND D.AUD_YR = E.AUD_YR
				               AND D.AUD_NO = E.AUD_NO
				               AND E.AUD_YR = F.AUD_YR
				               AND E.AUD_NO = F.AUD_NO
				               AND F.APV_RQS_ID = G.APV_DOC_NO(+)
				               AND E.AUD_YR = H.AUD_YR(+)
				               AND E.AUD_NO = H.AUD_NO(+)        
				               AND A.REQ_DVSN_CD = '3' 
				               
				               
				               
				               AND (((TO_CHAR(G.APV_DH,'YYYY') >= TO_CHAR(SYSDATE, 'YYYY') OR TO_CHAR(H.FNL_MDF_DH,'YYYY') >= TO_CHAR(SYSDATE, 'YYYY')) AND B.AUD_RSLT_CD IS NULL) 
				                    OR (B.AUD_RSLT_CD = '07'
				                       AND B.AUD_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'))
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 불문 ,
				
				    /* 공익 기각 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, 
				    (SELECT T2.AUD_YR , T2.AUD_NO, T1.TSK_KEY1, T1.TSK_KEY2, T1.TSK_KEY3  FROM TBBADDED030L T1, TBBADDED001M T2 WHERE T1.AUD_YR = T2.AUD_YR 
				                          AND T1.AUD_NO = T2.AUD_NO AND SUBSTR(T2.AUD_KND_CD,'3','1') <> '5') C ,
				
				    TBBADDED003M D
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND A.REQ_DVSN_CD = C.TSK_KEY2(+)
				               AND A.ACP_YR      = C.TSK_KEY1(+)
				               AND A.CVPT_ACP_NO = C.TSK_KEY3(+)
				               AND C.AUD_YR = D.AUD_YR(+)
				               AND C.AUD_NO = D.AUD_NO(+)
				               AND A.REQ_DVSN_CD = '3' 
				               AND CASE WHEN B.AUD_RSLT_CD IS NULL AND B.REQ_EXAM_RSLT_CD = '02'
				                    AND C.AUD_YR IS NULL
				                    AND (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 
				                                                          WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                            AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO 
				                                                            AND D1.RPRT_CD = 'C10330100' AND D1.APV_STA_CD = '30') >= TO_CHAR(SYSDATE, 'YYYY')
				                    THEN 1
				                    WHEN B.AUD_RSLT_CD IS NOT NULL AND B.AUD_RSLT_CD = '02' AND B.AUD_RSLT_RPL_DT IS NOT NULL THEN 1
				                    ELSE 0
				                     END = 1 
				                                        
				               AND (B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') OR B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')
				                    OR B.EXAM_RPT_APV_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') OR 
				                           (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO 
				                                                         AND D1.RPRT_CD = 'C10330300' AND D1.APV_STA_CD = '30') >= TO_CHAR(SYSDATE, 'YYYY')
				                   )  
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 기각 ,
				
				    /* 공익 각하 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, 
				    (SELECT T2.AUD_YR , T2.AUD_NO, T1.TSK_KEY1, T1.TSK_KEY2, T1.TSK_KEY3  FROM TBBADDED030L T1, TBBADDED001M T2 WHERE T1.AUD_YR = T2.AUD_YR 
				                          AND T1.AUD_NO = T2.AUD_NO AND SUBSTR(T2.AUD_KND_CD,'3','1') <> '5') C ,
				
				    TBBADDED003M D
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND A.REQ_DVSN_CD = C.TSK_KEY2(+)
				               AND A.ACP_YR      = C.TSK_KEY1(+)
				               AND A.CVPT_ACP_NO = C.TSK_KEY3(+)
				               AND C.AUD_YR = D.AUD_YR(+)
				               AND C.AUD_NO = D.AUD_NO(+)
				               AND A.REQ_DVSN_CD = '3' 
				                                    AND CASE WHEN B.AUD_RSLT_CD IS NULL AND B.REQ_EXAM_RSLT_CD = '03'
				                            AND 
				                     (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO AND D1.RPRT_CD = 'C10330100' AND D1.APV_STA_CD = '30')
				                                                         >= TO_CHAR(SYSDATE, 'YYYY') 
				                      
				                      THEN 1
				                               WHEN B.AUD_RSLT_CD IS NOT NULL AND B.AUD_RSLT_CD = '03' AND B.AUD_RSLT_RPL_DT IS NOT NULL THEN 1
				                                ELSE 0
				                                END = 1
				                                        AND (B.EXAM_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR B.AUD_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'
				                           OR B.EXAM_RPT_APV_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR 
				                           (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO AND D1.RPRT_CD = 'C10330300' AND D1.APV_STA_CD = '30')
				                           >= TO_CHAR(SYSDATE, 'YYYY') 
				                           ) 
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 각하 ,
				
				    /* 공익 기각/각하 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B, 
				    (SELECT T2.AUD_YR , T2.AUD_NO, T1.TSK_KEY1, T1.TSK_KEY2, T1.TSK_KEY3  FROM TBBADDED030L T1, TBBADDED001M T2 WHERE T1.AUD_YR = T2.AUD_YR 
				                          AND T1.AUD_NO = T2.AUD_NO AND SUBSTR(T2.AUD_KND_CD,'3','1') <> '5') C ,
				
				    TBBADDED003M D
				                    WHERE 1=1
				               AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				               AND A.ACP_YR = B.ACP_YR
				               AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				               AND A.REQ_DVSN_CD = C.TSK_KEY2(+)
				               AND A.ACP_YR      = C.TSK_KEY1(+)
				               AND A.CVPT_ACP_NO = C.TSK_KEY3(+)
				               AND C.AUD_YR = D.AUD_YR(+)
				               AND C.AUD_NO = D.AUD_NO(+)
				               AND A.REQ_DVSN_CD = '3' 
				               
				                      AND CASE WHEN B.AUD_RSLT_CD IS NULL AND B.REQ_EXAM_RSLT_CD = '04'
				                            AND 
				                     (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO AND D1.RPRT_CD = 'C10330100' AND D1.APV_STA_CD = '30')
				                                                         >= TO_CHAR(SYSDATE, 'YYYY')
				                      
				                      THEN 1
				                               WHEN B.AUD_RSLT_CD IS NOT NULL AND B.AUD_RSLT_CD = '04' AND B.AUD_RSLT_RPL_DT IS NOT NULL THEN 1
				                                ELSE 0
				                                END = 1
				                                        AND (B.EXAM_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR B.AUD_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'
				                           OR B.EXAM_RPT_APV_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR 
				                           (SELECT MAX(TO_CHAR(FNL_MDF_DH,'YYYY')) FROM TBCSPDCP603M D1 WHERE D1.REQ_DVSN_CD = A.REQ_DVSN_CD 
				                                                         AND D1.ACP_YR = A.ACP_YR AND D1.CVPT_ACP_NO = A.CVPT_ACP_NO AND D1.RPRT_CD = 'C10330300' AND D1.APV_STA_CD = '30')
				                           >= TO_CHAR(SYSDATE, 'YYYY')
				                           ) 
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 기각각하 ,
				
				    /* 공익 취하 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B
				                    WHERE 1=1
				                      AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
				                      AND A.ACP_YR = B.ACP_YR(+)
				                      AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
				                      AND A.REQ_DVSN_CD = '3'
				                      AND (A.CVPT_WDW_DH IS NOT NULL OR AUD_RSLT_CD = '08')
				                      AND TO_CHAR(A.CVPT_WDW_DH, 'YYYY') = TO_CHAR(SYSDATE, 'YYYY')
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 취하 ,
				
				    /* 공익 이첩 */
				    (SELECT COUNT(*) FROM TBCSPDCP101M A, TBCSPEAR001M B
				                    WHERE 1=1
				                      AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
				                      AND A.ACP_YR = B.ACP_YR
				                      AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
				                      AND A.REQ_DVSN_CD = '3'
				                      AND (B.REQ_EXAM_RSLT_CD = '05' OR AUD_RSLT_CD = '05')
				                      AND (B.EXAM_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101' OR B.AUD_RSLT_RPL_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101'
				                           OR B.EXAM_RPT_APV_DT >= TO_CHAR(SYSDATE, 'YYYY') || '0101')
						]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
			 			<![CDATA[
				    ) AS 이첩
				
				    FROM DUAL
				
				    )
				), 
				DVSN_T AS 
				    (
				          SELECT '0' AS DVSN_CD, '계' AS DVSN_NM FROM DUAL
				          UNION ALL
				          SELECT '2' AS DVSN_CD, '국민' AS DVSN_NM  FROM DUAL
				          UNION ALL
				          SELECT '3' AS DVSN_CD, '공익' AS DVSN_NM  FROM DUAL
				    )
				SELECT 
				NVL(REQ_DVSN_NM,'전체') AS REQ_DVSN_NM,SUM(CNT1) AS CNT1,SUM(CNT2) AS CNT2,SUM(CNT3) AS CNT3,SUM(CNT4) AS CNT4,SUM(CNT5) AS CNT5,SUM(CNT6) AS CNT6,SUM(CNT7) AS CNT7 FROM BASE 
				GROUP BY ROLLUP(REQ_DVSN_NM)
				
				ORDER BY REQ_DVSN_NM DESC
		 ]]>
	</select>
	
	<select id="selectReqDptCd" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectReqDptCd*/
		<![CDATA[
			SELECT 'reqDptCd' || ROWNUM AS REQ_DPT_CD, GRP_ID
				 FROM (SELECT ROW_NUMBER() OVER( ORDER BY A.GRP_ID ASC) AS NUM,
			              A.*
			         FROM TBDCMIAM009M A, TBDCMIAM003M B
			        WHERE A.ROLE_ID = B.ROLE_ID
                    AND A.GRP_ID IN (SELECT DPT_CD FROM EAMDEPT_VIEW)
                    AND B.ROLE_NM = 'REQ_SEARCH_DPT_CD'
			        ORDER BY A.GRP_ID ASC)
		 ]]>
		 <if test="btnNum != null and btnNum != '' ">
			WHERE NUM = #{btnNum}
		 </if>
		<![CDATA[
			ORDER BY GRP_ID ASC
		 ]]>
	</select>
	<select id="selectSttcChartList2" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectSttcChartList2*/
		<![CDATA[
    		WITH BASE AS 
								(
								
								SELECT	 A.REQ_DVSN_CD
								        ,TO_CHAR(B.ACP_DH, 'YYYY-MM-DD')                                  AS ACP_DH
								        ,TO_CHAR(SYSDATE,'YYYY-MM-DD')                                    AS CURENT_DT
								        ,TO_CHAR(TO_DATE(A.EXAM_RPT_APV_DT),'YYYY-MM-DD')               AS PRC_DT            
								        ,CASE WHEN A.REQ_DVSN_CD = '2'
								        	THEN TO_CHAR(B.ACP_DH+30+ F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YYYY-MM-DD') 
								         	ELSE TO_CHAR(ADD_MONTHS(B.ACP_DH ,1)+ F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YYYY-MM-DD')
								         END AS RULE_ST_DT
                                        ,A.FNL_MDF_DH
                                        ,A.AUD_RSLT_RPL_DT
								    FROM TBCSPEAR001M A
								        ,TBCSPDCP101M B
								        ,(SELECT sum(nvl(AUD_DCN,0)) BZT_DCN, D.TSK_KEY1 , D.TSK_KEY2, D.TSK_KEY3
								                FROM TBBADDED001M A
								                LEFT OUTER JOIN TBBADDED101L B
								                        ON A.AUD_YR = B.AUD_YR
								                       AND A.AUD_NO = B.AUD_NO
								                       AND B.AUD_STEP_CD != 'A1030'                          
								                INNER JOIN TBBADDED002M C
								                        ON A.AUD_YR  = C.REL_AUD_YR
								                       AND A.AUD_NO = C.REL_AUD_NO
								                INNER JOIN TBBADDED030L D ON A.AUD_YR = D.AUD_YR AND A.AUD_NO = D.AUD_NO
								                LEFT OUTER JOIN TBCSPDCP101M E
						                                ON D.TSK_KEY1 = E.ACP_YR
						                                AND D.TSK_KEY2 = E.REQ_DVSN_CD
						                                AND D.TSK_KEY3 = E.CVPT_ACP_NO
						                        LEFT OUTER JOIN TBCSPEAR001M F
						                                ON E.ACP_YR = F.ACP_YR
						                                AND E.REQ_DVSN_CD = F.REQ_DVSN_CD
						                                AND E.CVPT_ACP_NO = F.CVPT_ACP_NO
						                        WHERE 
						                             NVL(CASE WHEN F.AUD_RSLT_CD = '08' THEN TO_CHAR(E.CVPT_WDW_DH,'YYYY-MM-DD')        
						                                ELSE  
						                                    CASE WHEN E.REQ_DVSN_CD = '3' 
						                                         THEN NVL(TO_CHAR(TO_DATE(F.EXAM_RPT_APV_DT),'YYYY-MM-DD'),( 
						                                            SELECT TO_CHAR(MAX(C1.APV_DH),'YYYY-MM-DD') 
						                                                FROM TBBADDED030L A1,TBBADDED103M B1, TBDCMACM023L C1
						                                                 WHERE A1.TSK_KEY1(+)=E.ACP_YR 
						                                                    AND A1.TSK_KEY2(+)=E.REQ_DVSN_CD 
						                                                    AND A1.TSK_KEY3(+) =E.CVPT_ACP_NO
						                                                    AND A1.AUD_YR=B1.AUD_YR 
						                                                    AND A1.AUD_NO=B1.AUD_NO 
						                                                    AND B1.APV_RQS_ID = C1.APV_DOC_NO 
						                                                    AND B1.RPRT_CD = 'A10300100' 
						                                                    AND B1.APV_STA_CD ='30' 
						                                            )
						                                         )    
						                                     ELSE (SELECT TO_CHAR(TO_DATE(MAX(B.CMT_OEN_DT)),'YYYY-MM-DD') 
						                                                FROM TBCSPEAR011M A , TBCSPEAR010M B 
						                                                    WHERE A.ACP_YR(+) = E.ACP_YR 
						                                                        AND A.REQ_DVSN_CD(+) = E.REQ_DVSN_CD  
						                                                        AND A.CVPT_ACP_NO(+) = E.CVPT_ACP_NO 
						                                                        AND A.CMT_DVSN_CD = B.CMT_DVSN_CD 
						                                                        AND A.CMT_OEN_YE = B.CMT_OEN_YE 
						                                                        AND A.CMT_DGE = B.CMT_DGE
						                                                        AND A.CMT_RSLT_CD != '09'
						                                                        )  
						                                    END
						                                END,'9999-99-99') > TO_CHAR(TO_DATE(C.AUD_STR_DT),'YYYY-MM-DD')  
								                GROUP BY D.TSK_KEY1, D.TSK_KEY2, D.TSK_KEY3 
								                ) DDD
								   WHERE A.ACP_YR = B.ACP_YR 
								     AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
								     AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
								     AND A.ACP_YR      = DDD.TSK_KEY1(+) 
								     AND A.CVPT_ACP_NO = DDD.TSK_KEY3(+) 
								     AND A.REQ_DVSN_CD = DDD.TSK_KEY2(+) 
								     AND B.CVPT_HNDL_STA_CD = '170'
				 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
				 			<![CDATA[
								), 
								DVSN_T AS 
								(   
								      SELECT '2' AS REQ_DVSN_CD, '국민' AS REQ_DVSN_NM  FROM DUAL
								      UNION ALL
								      SELECT '3' AS REQ_DVSN_CD, '공익' AS REQ_DVSN_NM  FROM DUAL  
								)
															
								                            
								SELECT NVL(REQ_DVSN_NM,'전체') AS REQ_DVSN_NM
								     ,SUM(AAA.RULE_U) AS RULE_U
								     ,SUM(AAA.DAY_30) AS DAY_30
								     ,SUM(AAA.RULE_O) AS RULE_O
								 FROM (
								                     SELECT A.REQ_DVSN_NM     AS REQ_DVSN_NM
								                            ,NVL(B.DAY_30,0)   AS DAY_30
								                            ,NVL(B.RULE_U,0)   AS RULE_U
								                            ,NVL(B.RULE_O,0)   AS RULE_O
								                  FROM  DVSN_T A 
								                       ,(
								                            SELECT NVL(REQ_DVSN_CD,0) AS REQ_DVSN_CD
								                                  ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND (TO_DATE(PRC_DT) - TO_DATE(ACP_DH))  < 30 THEN 1 ELSE 0 END)   AS DAY_30
								                                  ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PRC_DT <= RULE_ST_DT                      THEN 1 ELSE 0 END)   AS RULE_U
								                                  ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PRC_DT >  RULE_ST_DT                      THEN 1 ELSE 0 END)   AS RULE_O
								                              FROM BASE B
								                             WHERE PRC_DT IS NOT NULL
								                             GROUP BY ROLLUP(REQ_DVSN_CD)
								                       ) B
								                 WHERE 1=1
								                   AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
								                 ORDER BY A.REQ_DVSN_CD
								      ) AAA
								GROUP BY ROLLUP(REQ_DVSN_NM)
								ORDER BY REQ_DVSN_NM DESC 
		 ]]>
	</select>
	
	<select id="selectSttcChartAvr" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectSttcChartAvr*/
		<![CDATA[
    			WITH BASE AS
							(
							    SELECT 
							           A.AUD_RSLT_CD
							           ,B.REQ_DVSN_CD
                                       ,A.FNL_MDF_DH
                                       ,A.AUD_RSLT_RPL_DT
							      FROM TBCSPEAR001M A 
							         , TBCSPDCP101M B
							     WHERE 1=1
							       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD 
							       AND A.ACP_YR      = B.ACP_YR 
							       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO 
							       AND B.CVPT_HNDL_STA_CD = '170'
							       AND A.AUD_RSLT_CD IS NOT NULL
				 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
				 			<![CDATA[
							       
							)                         
							                                
						SELECT CASE WHEN CNT5 > 0 THEN ROUND(CNT5/(CNT1+CNT2+CNT3+CNT4+CNT5+CNT6+CNT7)*100,1)
                                    ELSE 0
                                    END AS AVR
					      FROM (SELECT 
							                  SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND AUD_RSLT_CD = '02' THEN 1 ELSE 0 END)   AS CNT1
							                 ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND AUD_RSLT_CD = '03' THEN 1 ELSE 0 END)   AS CNT2
							                 ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND AUD_RSLT_CD = '04' THEN 1 ELSE 0 END)   AS CNT3
							                 ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND AUD_RSLT_CD = '05' THEN 1 ELSE 0 END)   AS CNT4
							                 ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND AUD_RSLT_CD = '06' THEN 1 ELSE 0 END)   AS CNT5
							                 ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND AUD_RSLT_CD = '07' THEN 1 ELSE 0 END)   AS CNT6
							                 ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND AUD_RSLT_CD = '08' THEN 1 ELSE 0 END)   AS CNT7
							              FROM BASE A
                                          ) 
		 ]]>
	</select>
	
	<select id="selectSttcChartAvr2" parameterType="paramMap" resultType="egovMap">
	/*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectSttcChartAvr2*/
		<![CDATA[
    			WITH BASE AS 
								(
								SELECT	 A.REQ_DVSN_CD
								        ,TO_CHAR(B.ACP_DH, 'YYYY-MM-DD')                                  AS ACP_DH
								        ,TO_CHAR(SYSDATE,'YYYY-MM-DD')                                    AS CURENT_DT
								        ,TO_CHAR(TO_DATE(A.EXAM_RPT_APV_DT),'YYYY-MM-DD')               AS PRC_DT
								        ,CASE WHEN A.REQ_DVSN_CD = '2'
                                                THEN TO_CHAR(B.ACP_DH+30+ F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YYYY-MM-DD')
                                            ELSE TO_CHAR(ADD_MONTHS(B.ACP_DH ,1)+F_SPMT_RQ_DAY_COUNT(A.REQ_DVSN_CD,A.ACP_YR,A.CVPT_ACP_NO)+NVL(DDD.BZT_DCN,0),'YYYY-MM-DD')
                                        END AS RULE_ST_DT
                                        ,A.FNL_MDF_DH
                                        ,A.AUD_RSLT_RPL_DT
								    FROM TBCSPEAR001M A
								        ,TBCSPDCP101M B
								        ,(SELECT sum(nvl(AUD_DCN,0)) BZT_DCN, D.TSK_KEY1 , D.TSK_KEY2, D.TSK_KEY3
								                FROM TBBADDED001M A
								                LEFT OUTER JOIN TBBADDED101L B
								                        ON A.AUD_YR = B.AUD_YR
								                       AND A.AUD_NO = B.AUD_NO
								                       AND B.AUD_STEP_CD != 'A1030'                          
								                INNER JOIN TBBADDED002M C
								                        ON A.AUD_YR  = C.REL_AUD_YR
								                       AND A.AUD_NO = C.REL_AUD_NO
								                INNER JOIN TBBADDED030L D ON A.AUD_YR = D.AUD_YR AND A.AUD_NO = D.AUD_NO  
								                LEFT OUTER JOIN TBCSPDCP101M E
                                ON D.TSK_KEY1 = E.ACP_YR
                                AND D.TSK_KEY2 = E.REQ_DVSN_CD
                                AND D.TSK_KEY3 = E.CVPT_ACP_NO
                        LEFT OUTER JOIN TBCSPEAR001M F
                                ON E.ACP_YR = F.ACP_YR
                                AND E.REQ_DVSN_CD = F.REQ_DVSN_CD
                                AND E.CVPT_ACP_NO = F.CVPT_ACP_NO
                        WHERE 
                             NVL(CASE WHEN F.AUD_RSLT_CD = '08' THEN TO_CHAR(E.CVPT_WDW_DH,'YYYY-MM-DD')        
                                ELSE  
                                    CASE WHEN E.REQ_DVSN_CD = '3' 
                                         THEN NVL(TO_CHAR(TO_DATE(F.EXAM_RPT_APV_DT),'YYYY-MM-DD'),( 
                                            SELECT TO_CHAR(MAX(C1.APV_DH),'YYYY-MM-DD') 
                                                FROM TBBADDED030L A1,TBBADDED103M B1, TBDCMACM023L C1
                                                 WHERE A1.TSK_KEY1(+)=E.ACP_YR 
                                                    AND A1.TSK_KEY2(+)=E.REQ_DVSN_CD 
                                                    AND A1.TSK_KEY3(+) =E.CVPT_ACP_NO
                                                    AND A1.AUD_YR=B1.AUD_YR 
                                                    AND A1.AUD_NO=B1.AUD_NO 
                                                    AND B1.APV_RQS_ID = C1.APV_DOC_NO 
                                                    AND B1.RPRT_CD = 'A10300100' 
                                                    AND B1.APV_STA_CD ='30' 
                                            )
                                         )    
                                     ELSE (SELECT TO_CHAR(TO_DATE(MAX(B.CMT_OEN_DT)),'YYYY-MM-DD') 
                                                FROM TBCSPEAR011M A , TBCSPEAR010M B 
                                                    WHERE A.ACP_YR(+) = E.ACP_YR 
                                                        AND A.REQ_DVSN_CD(+) = E.REQ_DVSN_CD  
                                                        AND A.CVPT_ACP_NO(+) = E.CVPT_ACP_NO 
                                                        AND A.CMT_DVSN_CD = B.CMT_DVSN_CD 
                                                        AND A.CMT_OEN_YE = B.CMT_OEN_YE 
                                                        AND A.CMT_DGE = B.CMT_DGE
                                                        AND A.CMT_RSLT_CD != '09'
                                                        )  
                                    END
                                END,'9999-99-99') > TO_CHAR(TO_DATE(C.AUD_STR_DT),'YYYY-MM-DD')
								                GROUP BY D.TSK_KEY1, D.TSK_KEY2, D.TSK_KEY3 
								                ) DDD
								   WHERE A.ACP_YR = B.ACP_YR 
								     AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
								     AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
								     AND A.ACP_YR      = DDD.TSK_KEY1(+) 
								     AND A.CVPT_ACP_NO = DDD.TSK_KEY3(+) 
								     AND A.REQ_DVSN_CD = DDD.TSK_KEY2(+) 
								     AND B.CVPT_HNDL_STA_CD = '170'
				 			]]>
	 				<choose>
				    	<when test="schDeptCd != null and schDeptCd != '' ">
							<![CDATA[
								AND B.HNDL_DPT_CD IN (#{schDeptCd}) 
							]]>
				    	</when>
				    	<otherwise>
							<if test="schSpvBrdvCd != null and schSpvBrdvCd != '' ">
								<![CDATA[
				 					AND B.HNDL_DPT_CD IN (#{schSpvBrdvCd},(SELECT DPT_CD FROM TBDCMACM002M WHERE HIRK_DPT_CD =#{schSpvBrdvCd} )) 
								]]>
			   				</if>
				    	</otherwise>
				    </choose>
				 			<![CDATA[
								)
									
                            SELECT CASE WHEN RULE_O > 0 THEN ROUND(RULE_O/(RULE_O+RULE_U+DAY_30)*100,1)
                                      ELSE 0
                                  END AS AVR2
							   FROM (
                                            SELECT  SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND (TO_DATE(PRC_DT) - TO_DATE(ACP_DH))  < 30 THEN 1 ELSE 0 END)   AS DAY_30
								                   ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PRC_DT <= RULE_ST_DT                      THEN 1 ELSE 0 END)   AS RULE_U
								                   ,SUM(CASE WHEN TO_CHAR(TO_DATE(AUD_RSLT_RPL_DT),'YYYY') = TO_CHAR(SYSDATE,'YYYY') AND PRC_DT >  RULE_ST_DT                      THEN 1 ELSE 0 END)   AS RULE_O
								              FROM BASE B
								             WHERE PRC_DT IS NOT NULL      
                                      ) 
		 ]]>
	</select>

    <!-- 시스템 변경 내역 및 유의사항 조회 -->
    <select id="selectMainBoard" parameterType="paramMap" resultType="egovMap">
    /* kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectMainBoard */
	<![CDATA[
	SELECT CASE WHEN LENGTH(REPLACE(TITLE, '&quot;', '')) > 35 THEN SUBSTR(TITLE, 0, 35)||'...'
	            ELSE TITLE
	        END AS TITLE
         , POST_SEQ
         , CRE_DT
         , NEW_YN
      FROM (SELECT TITLE /* 제목 */
	             , POST_SEQ /* 글번호 */
	             , TO_CHAR(TO_DATE(LPAD(CRE_DT,8),'yyyyMMdd'),'yyyy-MM-dd') AS CRE_DT /* 작성일자 */
	             , CASE WHEN TO_DATE(LPAD(CRE_DT,8),'yyyy/MM/dd') < TO_DATE(SYSDATE - 13) THEN 'N'
	             	    ELSE 'Y' 
	                END AS NEW_YN	/* 신규여부 (작성 후 2주) - 2019.05.15 chm*/
		      FROM CTT_POST /* 게시판 */
		     WHERE 1=1
		       AND BOARD_ID = '1636'
		       AND DEL_YN   = 'N' 
             ORDER BY CASE WHEN NOTICE_YN = 'Y'        THEN 1 ELSE 2 END
                    , CASE WHEN PERIOD_NOTICE_YN = 'Y' THEN 1 ELSE 2 END
                    , NOTICE_END_DT DESC
                    , NOTICE_START_DT DESC
                    , POST_SEQ DESC) A
     WHERE 1=1
       AND ROWNUM < 4
    ]]>
    </select>	
    
    
    
    
    
    
    
    
    
    
    
    <!-- 부패행위 현황 쿼리 시작 : 쿼리는 동일하나 추후 업무상 변동을 감안하여 쿼리 분리 생산-2020.09.25.HBY -->
    <!--  -->
    <select id="selectCorCorSituList" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectCorCorSituList */
        <![CDATA[
       SELECT T1.DPT_CD
     , NVL(F_DPT_INFO(T1.DPT_CD, '1'), '합계')       AS DPT_NM
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1'
                             THEN CNT1   ELSE 0
                         END), '999,999,999,999'))     AS CNT1
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1'
                             THEN CNT1_1 ELSE 0
                         END), '999,999,999,999'))     AS CNT2
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1'
                             THEN CNT1_2 ELSE 0
                         END), '999,999,999,999'))     AS CNT3
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1'
                             THEN CNT2   ELSE 0
                         END), '999,999,999,999'))     AS CNT4
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3   ELSE 0
                         END), '999,999,999,999'))     AS CNT5
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3_1 ELSE 0
                         END), '999,999,999,999'))     AS CNT6
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3_2 ELSE 0
                         END), '999,999,999,999'))     AS CNT7
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3_3 ELSE 0
                         END), '999,999,999,999'))     AS CNT8
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3_4 ELSE 0
                         END), '999,999,999,999'))     AS CNT9
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT4   ELSE 0
                         END), '999,999,999,999'))     AS CNT10
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT4_1 ELSE 0
                         END), '999,999,999,999'))||' ('||
     TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT4_3 ELSE 0
                         END),'999,999,999,999'))||')' AS CNT11
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT4_2 ELSE 0
                         END), '999,999,999,999'))     AS CNT12
  FROM (SELECT '1'           AS DVSN_CD
             , T1.ACP_DPT_CD AS DPT_CD
             , 1             AS CNT1
             , CASE WHEN TO_CHAR(T1.ACP_DH, 'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')
                    THEN 1 ELSE 0
                END          AS CNT1_1
             , CASE WHEN TO_CHAR(T1.ACP_DH, 'YYYY')   = TO_CHAR(SYSDATE, 'YYYY')
                    THEN 1 ELSE 0
                END          AS CNT1_2
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('20', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NULL
                    THEN 1 ELSE 0
                END          AS CNT2
             , 0             AS CNT3 
             , 0             AS CNT3_1
             , 0             AS CNT3_2
             , 0             AS CNT3_3
             , 0             AS CNT3_4
             , 0             AS CNT4
             , 0             AS CNT4_1
             , 0             AS CNT4_2
             , 0             AS CNT4_3
          FROM TBCORCOR101M T1 /* 부패행위민원접수기본 */
             , TBCORCOR201M T2 /* 부패행위민원처리기본 */
         WHERE 1=1
           AND T1.REQ_DVSN_CD     = '5'
           AND T1.RM_CVPT_ACP_NO IS NOT NULL
           AND T1.REQ_DVSN_CD     = T2.REQ_DVSN_CD(+)
           AND T1.ACP_YR          = T2.ACP_YR(+)
           AND T1.CVPT_ACP_NO     = T2.CVPT_ACP_NO(+)
           AND T1.ACP_DPT_CD     IS NOT NULL
           AND T1.ACP_DH         IS NOT NULL 
         UNION ALL
        SELECT '2'           AS DVSN_CD
             , NVL(T2.HNDL_DPT_CD, T1.ACP_DPT_CD)
                             AS DPT_CD
             , 0             AS CNT1
             , 0             AS CNT1_1
             , 0             AS CNT1_2
             , 0             AS CNT2
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL
                    THEN 1 ELSE 0
                END          AS CNT3
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL 
                     AND TRUNC(SYSDATE - ACP_DH - (SELECT COUNT(*)
                                                     FROM TBBADDED013B S1 /* 휴일기준관리 */
                                                    WHERE 1=1
                                                      AND S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH, 'YYYYMMDD')
                                                                           AND TO_CHAR(SYSDATE, 'YYYYMMDD')))+1 <= 20
                    THEN 1 ELSE 0
                END          AS CNT3_1
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL 
                     AND TRUNC(SYSDATE - ACP_DH - (SELECT COUNT(*)
                                                     FROM TBBADDED013B S1 /* 휴일기준관리 */
                                                    WHERE 1=1
                                                      AND S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH, 'YYYYMMDD')
                                                                           AND TO_CHAR(SYSDATE, 'YYYYMMDD')))+1 BETWEEN 21
                                                                                                                    AND 30
                    THEN 1 ELSE 0
                END          AS CNT3_2
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL 
                     AND TRUNC(SYSDATE - ACP_DH - (SELECT COUNT(*)
                                                     FROM TBBADDED013B S1 /* 휴일기준관리 */
                                                    WHERE 1=1
                                                      AND S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH, 'YYYYMMDD')
                                                                           AND TO_CHAR(SYSDATE, 'YYYYMMDD')))+1 BETWEEN 31
                                                                                                                    AND 40
                    THEN 1 ELSE 0
                END          AS CNT3_3
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL 
                     AND TRUNC(SYSDATE - ACP_DH - (SELECT COUNT(*)
                                                     FROM TBBADDED013B S1 /* 휴일기준관리 */
                                                    WHERE 1=1
                                                      AND S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH, 'YYYYMMDD')
                                                                           AND TO_CHAR(SYSDATE, 'YYYYMMDD')))+1 > 40
                    THEN 1 ELSE 0
                END          AS CNT3_4
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('50', '60', '80', '21', '70')
                    THEN 1
                    ELSE 0
                END          AS CNT4
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('50', '60', '80')
                    THEN 1 ELSE 0
                END          AS CNT4_1
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('70', '21')
                    THEN 1 ELSE 0
                END          AS CNT4_2
             , CASE WHEN T1.CVPT_HNDL_STA_CD = '60'
                     AND TO_CHAR(T2.FNL_HNDL_DH) = TO_CHAR(SYSDATE, 'YYYY')
                    THEN 1 ELSE 0
                END          AS CNT4_3
          FROM TBCORCOR101M T1 /* 부패행위민원접수기본 */
             , TBCORCOR201M T2 /* 부패행위민원처리기본 */
         WHERE 1=1
           AND T1.REQ_DVSN_CD     = '5'
           AND T1.RM_CVPT_ACP_NO IS NOT NULL
           AND T1.REQ_DVSN_CD     = T2.REQ_DVSN_CD(+)
           AND T1.ACP_YR          = T2.ACP_YR(+)
           AND T1.CVPT_ACP_NO     = T2.CVPT_ACP_NO(+)
           AND T1.ACP_DH         IS NOT NULL
       ) T1
   GROUP BY ROLLUP(T1.DPT_CD)
   ORDER BY CASE WHEN T1.DPT_CD = '0L0100' THEN 1 
                 WHEN T1.DPT_CD = '071110' THEN 2 
                 WHEN T1.DPT_CD = '0L0200' THEN 3
                 WHEN T1.DPT_CD = '0L0300' THEN 4
                 WHEN T1.DPT_CD = '062600' THEN 5
                 WHEN T1.DPT_CD = '062700' THEN 6
                 WHEN T1.DPT_CD = '062800' THEN 7 ELSE 0
             END DESC
  ]]>
	</select>


    <select id="selectCorCorSituList2" parameterType="paramMap" resultType="egovMap">
	/* kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectCorCorSituList2 */
    <![CDATA[
	SELECT CASE WHEN CVPT_HNDL_DVSN_CD = '990' THEN '반송'
	WHEN CVPT_HNDL_DVSN_CD = '991' THEN '취하'

	ELSE F_CODE_NM('1000945',CVPT_HNDL_DVSN_CD) END AS TITL
	, SUM(CNT1) AS SUM1
	, SUM(CNT2) AS TITL1
	, SUM(CNT3) AS TITL2
	, SUM(CNT4) AS TITL3
	, SUM(CNT5) AS TITL4
	, SUM(CNT6) AS TITL5
	, SUM(CNT7) AS TITL6
	, SUM(CNT8) AS TITL7
	FROM (
	SELECT CASE /* WHEN  T1.CVPT_HNDL_STA_CD = '80' THEN '990' */
	WHEN T1.CVPT_HNDL_STA_CD IN ('70','21') THEN '991'
	/* WHEN T3.CVPT_HNDL_DVSN_CD IN ('30','40') THEN '90' */
	ELSE T3.CVPT_HNDL_DVSN_CD END AS CVPT_HNDL_DVSN_CD
	,1 CNT1
	,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '0L0100' THEN 1 ELSE 0 END AS
	CNT2
	,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '071110' THEN 1 ELSE 0 END AS
	CNT3
	,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '0L0200' THEN 1 ELSE 0 END AS
	CNT4
	,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '0L0300' THEN 1 ELSE 0 END AS
	CNT5
	,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '062600' THEN 1 ELSE 0 END AS
	CNT6
	,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '062700' THEN 1 ELSE 0 END AS
	CNT7
	,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '062800' THEN 1 ELSE 0 END AS
	CNT8
	FROM TBCORCOR101M T1 /* 부패행위민원접수기본 */
	,TBCORCOR201M T2 /* 부패행위민원처리기본 */
	,(SELECT *
	FROM TBCORCOR205L T3 /* 부패행위민원처리결과내역 */
	WHERE (T3.REQ_DVSN_CD, T3.ACP_YR, T3.CVPT_ACP_NO, T3.SRNO) IN (SELECT
	S1.REQ_DVSN_CD, S1.ACP_YR, S1.CVPT_ACP_NO, MIN(S1.SRNO)
	FROM TBCORCOR205L S1 /* 부패행위민원처리결과내역 */
	GROUP BY S1.REQ_DVSN_CD, S1.ACP_YR, S1.CVPT_ACP_NO)
	) T3
	WHERE T1.REQ_DVSN_CD = '5'
	AND T1.REQ_DVSN_CD = T2.REQ_DVSN_CD(+)
	AND T1.ACP_YR = T2.ACP_YR(+)
	AND T1.CVPT_ACP_NO = T2.CVPT_ACP_NO(+)
	AND T1.REQ_DVSN_CD = T3.REQ_DVSN_CD(+)
	AND T1.ACP_YR = T3.ACP_YR(+)
	AND T1.CVPT_ACP_NO = T3.CVPT_ACP_NO(+)
	AND T1.RM_CVPT_ACP_NO IS NOT NULL
	AND T1.ACP_DH IS NOT NULL
	AND T1.CVPT_HNDL_STA_CD IN ('21','60','70','80','50')
	)
	GROUP BY CVPT_HNDL_DVSN_CD
	ORDER BY TO_NUMBER(CASE WHEN CVPT_HNDL_DVSN_CD = '90' THEN '30'
	WHEN CVPT_HNDL_DVSN_CD = '70' THEN '101'
	WHEN CVPT_HNDL_DVSN_CD IS NULL THEN '00'
	ELSE CVPT_HNDL_DVSN_CD END ) 
	]]>
    </select>

	<select id="selectCorCorSituList3" parameterType="paramMap" resultType="egovMap">
    /* kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectCorCorSituList3 */
    <![CDATA[
	    SELECT AA.* 
	,
	CASE WHEN AA.CVPT_HNDL_DVSN_CD IN ('21','22') AND AA.APV_STA_CD = '30'  THEN '대내이송(권익위, 처리중)' 
           WHEN AA.CVPT_HNDL_DVSN_CD IN ('20') AND AA.APV_STA_CD = '30'  THEN '대내이송(감사원, 처리중)'  ELSE AA.HNDL_LIMIT_DT1 END AS HNDL_LIMIT_DT
	,
	CASE WHEN AA.CVPT_HNDL_DVSN_CD IN ('21','22') AND AA.APV_STA_CD = '30'  THEN '대내이송(권익위, 처리중)' 
           WHEN AA.CVPT_HNDL_DVSN_CD IN ('20') AND AA.APV_STA_CD = '30'  THEN '대내이송(감사원, 처리중)' ELSE AA.HNDL_LIMIT_DT_PRCS1 END AS HNDL_LIMIT_DT_PRCS
	
	FROM 
	
	(SELECT ROWNUM AS ROW_NUM
            , REQ_DVSN_CD
						, ACP_YR
						, CVPT_ACP_NO
						, ACP_NO_NM
						, ACP_DH
						, TIT_NM
						, CVPT_SBT
						, CVPTR_NM
						, HNDL_CHGR_NM
						, CASE WHEN HNDL_LIMIT_CNT < 0 THEN HNDL_LIMIT_DT        || '(기한초과:' || HNDL_LIMIT_CNT || '일)' ELSE HNDL_LIMIT_DT        || '(D-' || HNDL_LIMIT_CNT || '일)'
						   END      AS HNDL_LIMIT_DT1
						, CASE WHEN HNDL_LIMIT_CNT < 0 THEN HNDL_LIMIT_DT_PRCS || '(기한초과:' || HNDL_LIMIT_CNT || '일)' ELSE HNDL_LIMIT_DT_PRCS || '(D-' || HNDL_LIMIT_CNT || '일)'
						   END      AS HNDL_LIMIT_DT_PRCS1
						, PRC_CNT
						, AUD_YN
						, DELAY_YN
						, WDW_RQS_YN
						, CVPT_HNDL_STA_CD
						, CVPT_HNDL_STA_NM
						, DOC_TYPE
						, HNDL_LIMIT_CNT
						, CVPT_HNDL_DVSN_CD
						, APV_STA_CD
     FROM (SELECT A.REQ_DVSN_CD
											, A.ACP_YR
											, A.CVPT_ACP_NO
											, A.ACP_YR || '-부감-' || A.RM_CVPT_ACP_NO      AS ACP_NO_NM
											, TO_CHAR(A.ACP_DH, 'YYYY-MM-DD HH24:MM') AS ACP_DH
											, CASE WHEN (SELECT COUNT(*)
                                         FROM TBCORCOR105L S1 /*  */
                                        WHERE 1=1
                                           AND S1.REQ_DVSN_CD = A.REQ_DVSN_CD
                                           AND S1.ACP_YR          = A.ACP_YR
AND S1.CVPT_ACP_NO = A.CVPT_ACP_NO
) > 0 THEN A.TIT_NM||'(합건 : '||A.RM_CVPT_ACP_NO||', '||( SELECT
AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
FROM TBCORCOR105L S2, TBCORCOR101M S3
WHERE A.REQ_DVSN_CD = S2.REQ_DVSN_CD
AND A.ACP_YR = S2.ACP_YR
AND A.CVPT_ACP_NO = S2.CVPT_ACP_NO
AND S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
AND S2.SUC_ACP_YR = S3.ACP_YR
AND S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO)
ELSE A.TIT_NM END AS TIT_NM
,D.CVPT_SBT
,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM)
AS CVPTR_NM
,F_USR_INFO_BY_ID(B.HNDL_CHGR_ID,'2') AS HNDL_CHGR_NM
,TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYY-MM-DD') AS HNDL_LIMIT_DT
,TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYY-MM-DD') AS HNDL_LIMIT_DT_PRCS
,(SELECT COUNT(CVPT_ACP_NO)
FROM TBCORCOR601M
WHERE ACP_YR = A.ACP_YR
AND REQ_DVSN_CD = A.REQ_DVSN_CD
AND CVPT_ACP_NO = A.CVPT_ACP_NO) AS PRC_CNT
, DECODE((SELECT
SUM(to_date(Z2.AUD_END_DT) - to_date(Z2.AUD_STR_DT) + 1) AS EDT /*출장종료일*/
FROM TBCORCOR207L Z1
INNER JOIN TBBADDED002M Z2 ON (Z1.AUD_YR = Z2.REL_AUD_YR
AND Z1.AUD_NO = Z2.REL_AUD_NO
AND Z1.AUD_STEP_SNO = Z2.AUD_STEP_SNO)
WHERE Z1.ACP_YR = A.ACP_YR
AND Z1.REQ_DVSN_CD = A.REQ_DVSN_CD
AND Z1.CVPT_ACP_NO = A.CVPT_ACP_NO),NULL,'N','Y') AS AUD_YN
,DECODE((
SELECT NVL(SUM(DECODE(NVL(Z3.APV_STA_CD,'0'), '30', '1', '0')),0)
FROM TBCORCOR603M Z3
WHERE Z3.ACP_YR = A.ACP_YR
AND Z3.REQ_DVSN_CD = A.REQ_DVSN_CD
AND Z3.CVPT_ACP_NO = A.CVPT_ACP_NO
AND Z3.RPRT_CD = 'F10200100'),0,'N','Y') AS DELAY_YN
,A.WDW_RQS_YN
,A.CVPT_HNDL_STA_CD
,F_CODE_NM('1000361',A.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
,F_CODE_NM('1000894', DOC_WRIT_KND_CD) AS DOC_TYPE
,TRUNC((TO_DATE(A.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'))))
AS HNDL_LIMIT_CNT
, E.CVPT_HNDL_DVSN_CD
,(SELECT Z4.APV_STA_CD
    FROM TBCORCOR603M Z4
   WHERE 1=1
     AND Z4.RPRT_CD = 'F10200400'
     AND Z4.ACP_YR = A.ACP_YR
     AND Z4.CVPT_ACP_NO = A.CVPT_ACP_NO
     AND Z4.REQ_DVSN_CD = A.REQ_DVSN_CD
     ) AS APV_STA_CD
FROM TBCORCOR101M A
,TBCORCOR201M B
,TBCORCOR102M D
,TBCORCOR205L E
WHERE 1=1
AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
AND A.ACP_YR = B.ACP_YR
AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
AND A.REQ_DVSN_CD = D.REQ_DVSN_CD
AND A.ACP_YR = D.ACP_YR
AND A.CVPT_ACP_NO = D.CVPT_ACP_NO
AND A.REQ_DVSN_CD = E.REQ_DVSN_CD(+)
AND A.ACP_YR = E.ACP_YR(+)
AND A.CVPT_ACP_NO = E.CVPT_ACP_NO(+)
AND E.SRNO(+) = '1'
AND A.REQ_DVSN_CD = '5'
AND A.CVPT_HNDL_STA_CD IN ('30','40','41')
AND (A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO)
NOT IN (
SELECT SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
FROM TBCORCOR105L
)
            ]]>
            <if test="hndlChgrId != null and hndlChgrId != ''">
            AND B.HNDL_CHGR_ID = #{hndlChgrId}
            </if>
            ORDER BY ACP_YR DESC, TO_NUMBER(CVPT_ACP_NO) DESC
        ) ) AA
		</select>
		
		
		<!-- 부패행위 현황 쿼리 종료 : 쿼리는 동일하나 추후 업무상 변동을 감안하여 쿼리 분리 생산-2020.09.25.HBY -->
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		<!-- 청탁금지 현황 쿼리 시작 : 쿼리는 동일하나 추후 업무상 변동을 감안하여 쿼리 분리 생산-2020.09.25.HBY -->
    <!--  -->
    <select id="selectDcpDcpSituList" parameterType="paramMap" resultType="egovMap">
        /* kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectDcpDcpSituList */
    <![CDATA[
       SELECT T1.DPT_CD
     , NVL(F_DPT_INFO(T1.DPT_CD, '1'), '합계')       AS DPT_NM
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1'
                             THEN CNT1   ELSE 0
                         END), '999,999,999,999'))     AS CNT1
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1'
                             THEN CNT1_1 ELSE 0
                         END), '999,999,999,999'))     AS CNT2
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1'
                             THEN CNT1_2 ELSE 0
                         END), '999,999,999,999'))     AS CNT3
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '1'
                             THEN CNT2   ELSE 0
                         END), '999,999,999,999'))     AS CNT4
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3   ELSE 0
                         END), '999,999,999,999'))     AS CNT5
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3_1 ELSE 0
                         END), '999,999,999,999'))     AS CNT6
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3_2 ELSE 0
                         END), '999,999,999,999'))     AS CNT7
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3_3 ELSE 0
                         END), '999,999,999,999'))     AS CNT8
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT3_4 ELSE 0
                         END), '999,999,999,999'))     AS CNT9
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT4   ELSE 0
                         END), '999,999,999,999'))     AS CNT10
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT4_1 ELSE 0
                         END), '999,999,999,999'))||' ('||
     TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT4_3 ELSE 0
                         END),'999,999,999,999'))||')' AS CNT11
   , TRIM(TO_CHAR(SUM(CASE WHEN DVSN_CD = '2'
                             THEN CNT4_2 ELSE 0
                         END), '999,999,999,999'))     AS CNT12
  FROM (SELECT '1'           AS DVSN_CD
             , T1.ACP_DPT_CD AS DPT_CD
             , 1             AS CNT1
             , CASE WHEN TO_CHAR(T1.ACP_DH, 'YYYYMM') = TO_CHAR(SYSDATE, 'YYYYMM')
                    THEN 1 ELSE 0
                END          AS CNT1_1
             , CASE WHEN TO_CHAR(T1.ACP_DH, 'YYYY')   = TO_CHAR(SYSDATE, 'YYYY')
                    THEN 1 ELSE 0
                END          AS CNT1_2
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('20', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NULL
                    THEN 1 ELSE 0
                END          AS CNT2
             , 0             AS CNT3 
             , 0             AS CNT3_1
             , 0             AS CNT3_2
             , 0             AS CNT3_3
             , 0             AS CNT3_4
             , 0             AS CNT4
             , 0             AS CNT4_1
             , 0             AS CNT4_2
             , 0             AS CNT4_3
          FROM TBDCPDCP101M T1 /* 청탁금지민원접수기본 */
             , TBDCPDCP201M T2 /* 청탁금지민원처리기본 */
         WHERE 1=1
           AND T1.REQ_DVSN_CD     = '6'
           AND T1.RM_CVPT_ACP_NO IS NOT NULL
           AND T1.REQ_DVSN_CD     = T2.REQ_DVSN_CD(+)
           AND T1.ACP_YR          = T2.ACP_YR(+)
           AND T1.CVPT_ACP_NO     = T2.CVPT_ACP_NO(+)
           AND T1.ACP_DPT_CD     IS NOT NULL
           AND T1.ACP_DH         IS NOT NULL 
           AND T1.ACP_DPT_CD     IS NOT NULL
         UNION ALL
        SELECT '2'           AS DVSN_CD
             , NVL(T2.HNDL_DPT_CD, T1.ACP_DPT_CD)
                             AS DPT_CD
             , 0             AS CNT1
             , 0             AS CNT1_1
             , 0             AS CNT1_2
             , 0             AS CNT2
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL
                    THEN 1 ELSE 0
                END          AS CNT3
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL 
                     AND TRUNC(SYSDATE - ACP_DH - (SELECT COUNT(*)
                                                     FROM TBBADDED013B S1 /* 휴일기준관리 */
                                                    WHERE 1=1
                                                      AND S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH, 'YYYYMMDD')
                                                                           AND TO_CHAR(SYSDATE, 'YYYYMMDD')))+1 <= 20
                    THEN 1 ELSE 0
                END          AS CNT3_1
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL 
                     AND TRUNC(SYSDATE - ACP_DH - (SELECT COUNT(*)
                                                     FROM TBBADDED013B S1 /* 휴일기준관리 */
                                                    WHERE 1=1
                                                      AND S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH, 'YYYYMMDD')
                                                                           AND TO_CHAR(SYSDATE, 'YYYYMMDD')))+1 BETWEEN 21
                                                                                                                    AND 30
                    THEN 1 ELSE 0
                END          AS CNT3_2
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL 
                     AND TRUNC(SYSDATE - ACP_DH - (SELECT COUNT(*)
                                                     FROM TBBADDED013B S1 /* 휴일기준관리 */
                                                    WHERE 1=1
                                                      AND S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH, 'YYYYMMDD')
                                                                           AND TO_CHAR(SYSDATE, 'YYYYMMDD')))+1 BETWEEN 31
                                                                                                                    AND 40
                    THEN 1 ELSE 0
                END          AS CNT3_3
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('40', '41', '30', '31')
                     AND T2.HNDL_CHGR_ID IS NOT NULL 
                     AND TRUNC(SYSDATE - ACP_DH - (SELECT COUNT(*)
                                                     FROM TBBADDED013B S1 /* 휴일기준관리 */
                                                    WHERE 1=1
                                                      AND S1.YE||S1.MD BETWEEN TO_CHAR(ACP_DH, 'YYYYMMDD')
                                                                           AND TO_CHAR(SYSDATE, 'YYYYMMDD')))+1 > 40
                    THEN 1 ELSE 0
                END          AS CNT3_4
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('50', '60', '80', '21', '70')
                    THEN 1
                    ELSE 0
                END          AS CNT4
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('50', '60', '80')
                    THEN 1 ELSE 0
                END          AS CNT4_1
             , CASE WHEN T1.CVPT_HNDL_STA_CD IN ('70', '21')
                    THEN 1 ELSE 0
                END          AS CNT4_2
             , CASE WHEN T1.CVPT_HNDL_STA_CD = '60'
                     AND TO_CHAR(T2.FNL_HNDL_DH) = TO_CHAR(SYSDATE, 'YYYY')
                    THEN 1 ELSE 0
                END          AS CNT4_3
          FROM TBDCPDCP101M T1 /* 청탁금지민원접수기본 */
             , TBDCPDCP201M T2 /* 청탁금지민원처리기본 */
         WHERE 1=1
           AND T1.REQ_DVSN_CD     = '6'
           AND T1.RM_CVPT_ACP_NO IS NOT NULL
           AND T1.REQ_DVSN_CD     = T2.REQ_DVSN_CD(+)
           AND T1.ACP_YR          = T2.ACP_YR(+)
           AND T1.CVPT_ACP_NO     = T2.CVPT_ACP_NO(+)
           AND T1.ACP_DH         IS NOT NULL
           AND T1.ACP_DPT_CD     IS NOT NULL
       ) T1
   GROUP BY ROLLUP(T1.DPT_CD)
   ORDER BY CASE WHEN T1.DPT_CD = '0L0100' THEN 1 
                 WHEN T1.DPT_CD = '071110' THEN 2 
                 WHEN T1.DPT_CD = '0L0200' THEN 3
                 WHEN T1.DPT_CD = '0L0300' THEN 4
                 WHEN T1.DPT_CD = '062600' THEN 5
                 WHEN T1.DPT_CD = '062700' THEN 6
                 WHEN T1.DPT_CD = '062800' THEN 7 ELSE 0
             END DESC
  ]]>
  </select>


    <select id="selectDcpDcpSituList2" parameterType="paramMap" resultType="egovMap">
  /* kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectDcpDcpSituList2 */
    <![CDATA[
    SELECT CASE WHEN CVPT_HNDL_DVSN_CD = '990' THEN '반송' 
            WHEN CVPT_HNDL_DVSN_CD = '991' THEN '취하'
            
            ELSE F_CODE_NM('1000943',CVPT_HNDL_DVSN_CD) END AS TITL
      , SUM(CNT1) AS SUM1
      , SUM(CNT2) AS TITL1
      , SUM(CNT3) AS TITL2
      , SUM(CNT4) AS TITL3
      , SUM(CNT5) AS TITL4
      , SUM(CNT6) AS TITL5
      , SUM(CNT7) AS TITL6
      , SUM(CNT8) AS TITL7 
 FROM (
    SELECT CASE /* WHEN T1.CVPT_HNDL_STA_CD = '80' THEN '990' */
                WHEN T1.CVPT_HNDL_STA_CD IN ('70','21') THEN '991'
               /* --WHEN T3.CVPT_HNDL_DVSN_CD IN ('30','40') THEN '90' */
                ELSE T3.CVPT_HNDL_DVSN_CD END  AS CVPT_HNDL_DVSN_CD
         ,1 CNT1
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '0L0100' THEN 1 ELSE 0 END   AS CNT2 
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '071110' THEN 1 ELSE 0 END   AS CNT3
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '0L0200' THEN 1 ELSE 0 END   AS CNT4
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '0L0300' THEN 1 ELSE 0 END   AS CNT5
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '062600' THEN 1 ELSE 0 END   AS CNT6
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '062700' THEN 1 ELSE 0 END   AS CNT7
         ,CASE WHEN NVL(T2.HNDL_DPT_CD,T1.ACP_DPT_CD) = '062800' THEN 1 ELSE 0 END   AS CNT8
      FROM TBDCPDCP101M T1 /* 부패행위민원접수기본 */ 
          ,TBDCPDCP201M T2 /* 부패행위민원처리기본 */
          ,(SELECT * 
              FROM TBDCPDCP205L T3 /* 부패행위민원처리결과내역 */
             WHERE (T3.REQ_DVSN_CD, T3.ACP_YR, T3.CVPT_ACP_NO, T3.SRNO) IN (SELECT S1.REQ_DVSN_CD, S1.ACP_YR, S1.CVPT_ACP_NO, MIN(S1.SRNO)
                                                                              FROM TBDCPDCP205L S1 /* 부패행위민원처리결과내역 */
                                                                             GROUP BY S1.REQ_DVSN_CD, S1.ACP_YR, S1.CVPT_ACP_NO)
           ) T3
          
     WHERE T1.REQ_DVSN_CD = '6'
       AND T1.REQ_DVSN_CD = T2.REQ_DVSN_CD(+)
       AND T1.ACP_YR = T2.ACP_YR(+)
       AND T1.CVPT_ACP_NO = T2.CVPT_ACP_NO(+)
       AND T1.REQ_DVSN_CD = T3.REQ_DVSN_CD(+)
       AND T1.ACP_YR = T3.ACP_YR(+)
       AND T1.CVPT_ACP_NO = T3.CVPT_ACP_NO(+)
       AND T1.RM_CVPT_ACP_NO IS NOT NULL
       AND T1.ACP_DH IS NOT NULL
       AND T1.CVPT_HNDL_STA_CD IN ('21','60','70','80','50')
      )
   GROUP BY CVPT_HNDL_DVSN_CD
   ORDER BY TO_NUMBER(CASE WHEN CVPT_HNDL_DVSN_CD = '90' THEN '30'
            WHEN CVPT_HNDL_DVSN_CD = '70' THEN '101'
            WHEN CVPT_HNDL_DVSN_CD IS NULL THEN '00'
            ELSE CVPT_HNDL_DVSN_CD END )
  ]]>
    </select>

  <select id="selectDcpDcpSituList3" parameterType="paramMap" resultType="egovMap">
    /* kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectDcpDcpSituList3 */
    <![CDATA[
    SELECT ROWNUM AS ROW_NUM
        , REQ_DVSN_CD
        , ACP_YR
        , CVPT_ACP_NO
        , ACP_NO_NM, ACP_DH
        , TIT_NM, CVPT_SBT
        , CVPTR_NM
        , HNDL_CHGR_NM
        , CASE WHEN HNDL_LIMIT_CNT < 0 THEN HNDL_LIMIT_DT||' (기한초과:'||HNDL_LIMIT_CNT||'일)' ELSE HNDL_LIMIT_DT||' (D-'||HNDL_LIMIT_CNT||'일)' END HNDL_LIMIT_DT  
        , CASE WHEN HNDL_LIMIT_CNT < 0 THEN HNDL_LIMIT_DT_PRCS||' (기한초과:'||HNDL_LIMIT_CNT||'일)' ELSE HNDL_LIMIT_DT_PRCS||' (D-'||HNDL_LIMIT_CNT||'일)' END HNDL_LIMIT_DT_PRCS
        , PRC_CNT, AUD_YN, DELAY_YN, WDW_RQS_YN
        , CVPT_HNDL_STA_CD,CVPT_HNDL_STA_NM
        , DOC_TYPE
        , HNDL_LIMIT_CNT
    FROM (
      SELECT  A.REQ_DVSN_CD
          ,A.ACP_YR
          ,A.CVPT_ACP_NO
          ,CASE WHEN A.REQ_DVSN_CD = '9' THEN A.ACP_YR||'-이해-'||A.RM_CVPT_ACP_NO
   			    ELSE A.ACP_YR||'-청금-'||A.RM_CVPT_ACP_NO 
   		        END AS ACP_NO_NM
          ,TO_CHAR(A.ACP_DH, 'YYYY-MM-DD HH24:MM') AS ACP_DH
          ,CASE WHEN (  SELECT COUNT(*)
                      FROM TBDCPDCP105L S1
                      WHERE S1.REQ_DVSN_CD = A.REQ_DVSN_CD
                      AND S1.ACP_YR = A.ACP_YR
                      AND S1.CVPT_ACP_NO = A.CVPT_ACP_NO
                    ) > 0 THEN A.TIT_NM||'(합건 : '||A.RM_CVPT_ACP_NO||', '||(  SELECT  AGGR_CONCAT( S3.RM_CVPT_ACP_NO, ', ')||' )'
                                                  FROM  TBDCPDCP105L S2, TBDCPDCP101M S3
                                                  WHERE A.REQ_DVSN_CD = S2.REQ_DVSN_CD
                                                  AND   A.ACP_YR = S2.ACP_YR
                                                  AND   A.CVPT_ACP_NO = S2.CVPT_ACP_NO
                                                  AND   S2.SUC_REQ_DVSN_CD = S3.REQ_DVSN_CD
                                                  AND   S2.SUC_ACP_YR = S3.ACP_YR
                                                  AND   S2.SUC_CVPT_ACP_NO = S3.CVPT_ACP_NO)
                ELSE A.TIT_NM END AS TIT_NM
          ,D.CVPT_SBT
          ,DECODE(A.REQR_KND_CD,'1',A.CVPTR_NM,'2',A.RPST_PEN_NM,'3',A.RPST_PEN_NM,'4',A.CVPTR_NM) AS CVPTR_NM
                    ,F_USR_INFO_BY_ID(B.HNDL_CHGR_ID,'2') AS HNDL_CHGR_NM
                    ,TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYY-MM-DD') AS HNDL_LIMIT_DT
                     ,TO_CHAR(TO_DATE(A.HNDL_DDLN_DT),'YYYY-MM-DD') AS HNDL_LIMIT_DT_PRCS
                     ,(SELECT COUNT(CVPT_ACP_NO)
             FROM TBDCPDCP601M
            WHERE ACP_YR = A.ACP_YR
               AND REQ_DVSN_CD = A.REQ_DVSN_CD
               AND CVPT_ACP_NO = A.CVPT_ACP_NO) AS PRC_CNT
           , DECODE((SELECT
                                  SUM(to_date(Z2.AUD_END_DT) - to_date(Z2.AUD_STR_DT) + 1) AS EDT /*출장종료일*/
                            FROM  TBDCPDCP207L Z1
                            INNER JOIN TBBADDED002M Z2 ON (Z1.AUD_YR = Z2.REL_AUD_YR
                                                         AND Z1.AUD_NO = Z2.REL_AUD_NO
                                                         AND Z1.AUD_STEP_SNO = Z2.AUD_STEP_SNO)
                            WHERE Z1.ACP_YR = A.ACP_YR
                            AND Z1.REQ_DVSN_CD = A.REQ_DVSN_CD
                            AND Z1.CVPT_ACP_NO = A.CVPT_ACP_NO),NULL,'N','Y') AS AUD_YN
                     ,DECODE((
                            SELECT NVL(SUM(DECODE(NVL(Z3.APV_STA_CD,'0'), '30', '1', '0')),0)
                             FROM TBDCPDCP603M Z3
                             WHERE Z3.ACP_YR = A.ACP_YR
                               AND Z3.REQ_DVSN_CD = A.REQ_DVSN_CD
                               AND Z3.CVPT_ACP_NO = A.CVPT_ACP_NO
                               AND Z3.RPRT_CD = 'G10200100'),0,'N','Y') AS DELAY_YN
                     ,A.WDW_RQS_YN
                     ,A.CVPT_HNDL_STA_CD
                     ,F_CODE_NM('1000361',A.CVPT_HNDL_STA_CD) AS CVPT_HNDL_STA_NM
                     ,F_CODE_NM('1000894', DOC_WRIT_KND_CD) AS DOC_TYPE
                     ,TRUNC((TO_DATE(A.HNDL_DDLN_DT)-TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD')))) AS HNDL_LIMIT_CNT
      FROM  TBDCPDCP101M A
          ,TBDCPDCP201M B
          ,TBDCPDCP102M D
      WHERE 1=1
      AND   A.REQ_DVSN_CD = B.REQ_DVSN_CD
      AND   A.ACP_YR = B.ACP_YR
      AND   A.CVPT_ACP_NO = B.CVPT_ACP_NO
      AND   A.REQ_DVSN_CD = D.REQ_DVSN_CD
      AND   A.ACP_YR = D.ACP_YR
      AND   A.CVPT_ACP_NO = D.CVPT_ACP_NO
      AND   A.REQ_DVSN_CD IN ('6','9')
            AND   A.CVPT_HNDL_STA_CD IN ('30','40','41')
            AND   (A.REQ_DVSN_CD, A.ACP_YR, A.CVPT_ACP_NO)
            NOT IN (
              SELECT  SUC_REQ_DVSN_CD,SUC_ACP_YR,SUC_CVPT_ACP_NO
              FROM  TBDCPDCP105L
            )
      ]]>
      <if test="hndlChgrId != null and hndlChgrId != ''">
      AND B.HNDL_CHGR_ID = #{hndlChgrId}
      </if>
      ORDER BY ACP_YR DESC, TO_NUMBER(CVPT_ACP_NO) DESC
    )
  
    </select>
    
     
    <!-- 청탁금지 현황 쿼리 종료 : 쿼리는 동일하나 추후 업무상 변동을 감안하여 쿼리 분리 생산-2020.09.25.HBY -->
    
    <!-- 메인화면 감사사무처리지시 항목 - 2020.12.21 -->
    <select id="selectMainBoard2" parameterType="paramMap" resultType="egovMap">
    /* kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectMainBoard2 */
    <![CDATA[
    SELECT T1.CONT_ID
	     , CONT_SID
	     , CASE WHEN LENGTH(REPLACE(CONT_NM, '&quot;', '')) > 35 THEN SUBSTR(CONT_NM, 0, 35)||'...'
                ELSE CONT_NM
            END AS CONT_NM
	     , DOCREVTYPE_NM
	     , PROM_DT_STR
	     , CASE WHEN REGI_DH BETWEEN  TO_CHAR(SYSDATE-7,'YYYYMMDD') AND TO_CHAR(SYSDATE,'YYYYMMDD')  THEN 'Y'
             	ELSE 'N'
            END AS REGI_DH
	  FROM (SELECT ROW_NUMBER() OVER(ORDER BY PROM_DT DESC) AS NUM
			     , T1.CONT_ID
			     , CONT_SID
			     , CONT_NM
			     , DOCREVTYPE_NM
			     , PROM_DT_STR
                 , REPLACE(PROM_DT_STR,'.') AS REGI_DH
			  FROM VWRCTPROMINFO T1
			 WHERE 1=1
			   AND DOCMAP_CD = 'DMG40_40') T1
	 WHERE 1=1
	   AND NUM BETWEEN 1 AND 3
    ]]>
    </select>

	<select id="selectEarSituReqDptExamList" parameterType="paramMap" resultType="egovMap">
        /*kr.go.bai.eip.dashBoard.dao.DashBoardMapper.selectEarSituReqDptExamList*/
        <![CDATA[
	        WITH BASE AS(
			    SELECT '검토중' AS STA_DVSN
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd1},1,0)) AS DPT1
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd2},1,0)) AS DPT2
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd3},1,0)) AS DPT3
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd4},1,0)) AS DPT4
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd5},1,0)) AS DPT5
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd1},1,#{reqDptCd2},1,#{reqDptCd3},1,#{reqDptCd4},1,#{reqDptCd5},1,0)) AS TOTAL_CNT 
			        FROM (
			            SELECT DISTINCT B.HNDL_DPT_CD,B.REQ_DVSN_CD,B.ACP_YR,B.CVPT_ACP_NO 
			                FROM TBCSPDCP101M A
			                      ,TBCSPEAR001M B 
			                      ,TBBADDED030L C 
			                      ,TBBADDED001M D 
			                      ,TBBADDED003M E 
			                      ,TBCSPDCP104L F 
			                      ,TBBADDED002M G
			                      ,(SELECT D.TSK_KEY1 , D.TSK_KEY2, D.TSK_KEY3, sum(nvl(AUD_DCN,0)) BZT_DCN
			                              FROM TBBADDED001M A,TBBADDED101L B , TBBADDED002M C, TBBADDED030L D,TBCSPDCP101M E, TBCSPEAR001M F       
			                                    WHERE 
			                                        A.AUD_YR = B.AUD_YR(+)
			                                        AND A.AUD_NO = B.AUD_NO(+)
			                                        AND B.AUD_STEP_CD != 'A1030'
			                                        AND A.AUD_YR  = C.REL_AUD_YR
			                                        AND A.AUD_NO = C.REL_AUD_NO
			                                        AND A.AUD_YR = D.AUD_YR 
			                                        AND A.AUD_NO = D.AUD_NO  
			                                        AND D.TSK_KEY1 = E.ACP_YR(+)
			                                        AND D.TSK_KEY2 = E.REQ_DVSN_CD(+)
			                                        AND D.TSK_KEY3 = E.CVPT_ACP_NO(+)
			                                        AND E.ACP_YR = F.ACP_YR(+)
			                                        AND E.REQ_DVSN_CD = F.REQ_DVSN_CD(+)
			                                        AND E.CVPT_ACP_NO = F.CVPT_ACP_NO(+)
			                                        AND NVL(CASE WHEN F.AUD_RSLT_CD = '08' THEN TO_CHAR(E.CVPT_WDW_DH,'YYYY-MM-DD')        
			                                                        ELSE  
			                                                            CASE WHEN E.REQ_DVSN_CD = '3' 
			                                                                THEN NVL(TO_CHAR(TO_DATE(F.EXAM_RPT_APV_DT),'YYYY-MM-DD'),( 
			                                                                            SELECT TO_CHAR(MAX(C1.APV_DH),'YYYY-MM-DD') 
			                                                                                FROM TBBADDED030L A1,TBBADDED103M B1, TBDCMACM023L C1
			                                                                                 WHERE A1.TSK_KEY1(+)=E.ACP_YR 
			                                                                                    AND A1.TSK_KEY2(+)=E.REQ_DVSN_CD 
			                                                                                    AND A1.TSK_KEY3(+) =E.CVPT_ACP_NO
			                                                                                    AND A1.AUD_YR=B1.AUD_YR 
			                                                                                    AND A1.AUD_NO=B1.AUD_NO 
			                                                                                    AND B1.APV_RQS_ID = C1.APV_DOC_NO 
			                                                                                    AND B1.RPRT_CD = 'A10300100' 
			                                                                                    AND B1.APV_STA_CD ='30')
			                                                                          )    
			                                                                ELSE (SELECT TO_CHAR(TO_DATE(MAX(B.CMT_OEN_DT)),'YYYY-MM-DD') 
			                                                                    FROM TBCSPEAR011M A , TBCSPEAR010M B 
			                                                                        WHERE A.ACP_YR(+) = E.ACP_YR 
			                                                                            AND A.REQ_DVSN_CD(+) = E.REQ_DVSN_CD  
			                                                                            AND A.CVPT_ACP_NO(+) = E.CVPT_ACP_NO 
			                                                                            AND A.CMT_DVSN_CD = B.CMT_DVSN_CD 
			                                                                            AND A.CMT_OEN_YE = B.CMT_OEN_YE 
			                                                                            AND A.CMT_DGE = B.CMT_DGE
			                                                                            AND A.CMT_RSLT_CD != '09'
			                                                                            )  
			                                                                END
			                                                        END,'9999-99-99') > TO_CHAR(TO_DATE(C.AUD_STR_DT),'YYYY-MM-DD')
			                                                      GROUP BY D.TSK_KEY1, D.TSK_KEY2, D.TSK_KEY3
			                            ) DDD
			                WHERE 1=1
			                    AND A.REQ_DVSN_CD = F.REQ_DVSN_CD(+)
			                    AND A.ACP_YR     = F.ACP_YR(+)
			                    AND A.CVPT_ACP_NO = F.CVPT_ACP_NO(+)
			                    AND G.REL_AUD_YR(+) = C.AUD_YR
			                    AND G.REL_AUD_NO(+) = C.AUD_NO
			                    AND G.AUD_BZT_KND_CD(+) ='02'              
			                    AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)
			                    AND A.ACP_YR = B.ACP_YR(+)
			                    AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			                    AND B.CVPT_ACP_NO = D.CVPT_ACP_NO(+)        
			                    AND D.AUD_YR = C.AUD_YR(+)
			                    AND D.AUD_NO = C.AUD_NO(+)
			                    AND D.AUD_YR = E.AUD_YR(+)
			                    AND D.AUD_NO = E.AUD_NO(+)       
			                    AND A.ACP_YR      = DDD.TSK_KEY1(+) 
			                    AND A.CVPT_ACP_NO = DDD.TSK_KEY3(+) 
			                    AND A.REQ_DVSN_CD = DDD.TSK_KEY2(+)
			                    AND A.REQ_DVSN_CD IN ('2','3') 
			                    AND A.CVPT_HNDL_STA_CD != '170'
			                    AND A.CVPT_WDW_DH IS NULL   
			                    AND (B.PREI_APV_DT IS NULL OR B.EXAM_RPT_APV_DT IS NULL OR (B.REQ_EXAM_RSLT_CD IS NULL OR B.REQ_EXAM_RSLT_CD != '01') 
			                          OR (SELECT COUNT(*) FROM TBCSPDCP603M                                         
			                                                WHERE REQ_DVSN_CD = A.REQ_DVSN_CD AND ACP_YR = A.ACP_YR AND CVPT_ACP_NO = A.CVPT_ACP_NO 
			                                                    AND RPRT_CD IN ('C10220100','C10330100','A10300100') AND APV_STA_CD = '30') < 1 )
			                    AND (CASE WHEN (SELECT COUNT(*)
			                                  FROM TBBADDED030L D2, 
			                                       TBBADDED001M D3,
			                                       TBBADDED003M D4
			                                 WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD
			                                   AND D2.TSK_KEY1 = A.ACP_YR
			                                   AND D2.TSK_KEY3 = A.CVPT_ACP_NO
			                                   AND D3.AUD_YR = D2.AUD_YR
			                                   AND D3.AUD_NO = D2.AUD_NO
			                                   AND D3.AUD_YR = D4.AUD_YR
			                                   AND D3.AUD_NO = D4.AUD_NO
			                                   AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5') < 1 
			                            THEN 1
			                            ELSE CASE WHEN (SELECT COUNT(*) FROM TBBADDED030L C, TBBADDED103M D
			                                                   WHERE C.TSK_KEY2 = A.REQ_DVSN_CD
			                                                   AND C.TSK_KEY1 = A.ACP_YR
			                                                   AND C.TSK_KEY3 = A.CVPT_ACP_NO
			                                                   AND D.AUD_YR = C.AUD_YR
			                                                   AND D.AUD_NO = C.AUD_NO
			                                                   AND D.AUD_STEP_CD = 'A1030' 
			                                                   AND D.RPRT_CD = 'A10300100'
			                                                   AND D.APV_STA_CD = '30') < 1
			                                      THEN 1 ELSE 0 END
			                            END = 1
			                        ) 
			            )
			            
			    UNION ALL
			
			    SELECT 
			        '감사중' AS STA_DVSN, SUM(DECODE(HNDL_DPT_CD,#{reqDptCd1},1,0)) AS DPT1 
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd2},1,0)) AS DPT2
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd3},1,0)) AS DPT3
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd4},1,0)) AS DPT4
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd5},1,0)) AS DPT5
			        ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd1},1,#{reqDptCd2},1,#{reqDptCd3},1,#{reqDptCd4},1,#{reqDptCd5},1,0)) AS TOTAL_CNT
			        FROM (
			                SELECT DISTINCT B.HNDL_DPT_CD,B.REQ_DVSN_CD,B.ACP_YR,B.CVPT_ACP_NO 
			                      FROM TBCSPDCP101M A,TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E, TBCSPDCP104L F         
			                           ,(SELECT sum(nvl(AUD_DCN,0)) AUD_DCN, C.REL_AUD_YR,	C.REL_AUD_NO, C.AUD_BZT_KND_CD
			                                FROM TBBADDED001M A,TBBADDED101L B , TBBADDED002M C, TBBADDED030L D,TBCSPDCP101M E, TBCSPEAR001M F       
			                                    WHERE 
			                                        A.AUD_YR = B.AUD_YR(+)
			                                        AND A.AUD_NO = B.AUD_NO(+)
			                                        AND B.AUD_STEP_CD != 'A1030'
			                                        AND A.AUD_YR  = C.REL_AUD_YR
			                                        AND A.AUD_NO = C.REL_AUD_NO
			                                        AND A.AUD_YR = D.AUD_YR 
			                                        AND A.AUD_NO = D.AUD_NO  
			                                        AND D.TSK_KEY1 = E.ACP_YR(+)
			                                        AND D.TSK_KEY2 = E.REQ_DVSN_CD(+)
			                                        AND D.TSK_KEY3 = E.CVPT_ACP_NO(+)
			                                        AND E.ACP_YR = F.ACP_YR(+)
			                                        AND E.REQ_DVSN_CD = F.REQ_DVSN_CD(+)
			                                        AND E.CVPT_ACP_NO = F.CVPT_ACP_NO(+)
			                                        AND NVL(CASE WHEN F.AUD_RSLT_CD = '08' THEN TO_CHAR(E.CVPT_WDW_DH,'YYYY-MM-DD')        
			                                                        ELSE  
			                                                            CASE WHEN E.REQ_DVSN_CD = '3' 
			                                                                 THEN NVL(TO_CHAR(TO_DATE(F.EXAM_RPT_APV_DT),'YYYY-MM-DD'),( 
			                                                                    SELECT TO_CHAR(MAX(C1.APV_DH),'YYYY-MM-DD') 
			                                                                        FROM TBBADDED030L A1,TBBADDED103M B1, TBDCMACM023L C1
			                                                                         WHERE A1.TSK_KEY1(+)=E.ACP_YR 
			                                                                            AND A1.TSK_KEY2(+)=E.REQ_DVSN_CD 
			                                                                            AND A1.TSK_KEY3(+) =E.CVPT_ACP_NO
			                                                                            AND A1.AUD_YR=B1.AUD_YR 
			                                                                            AND A1.AUD_NO=B1.AUD_NO 
			                                                                            AND B1.APV_RQS_ID = C1.APV_DOC_NO 
			                                                                            AND B1.RPRT_CD = 'A10300100' 
			                                                                            AND B1.APV_STA_CD ='30')
			                                                                            )    
			                                                                 ELSE (SELECT TO_CHAR(TO_DATE(MAX(B.CMT_OEN_DT)),'YYYY-MM-DD') 
			                                                                        FROM TBCSPEAR011M A , TBCSPEAR010M B 
			                                                                            WHERE A.ACP_YR(+) = E.ACP_YR 
			                                                                                AND A.REQ_DVSN_CD(+) = E.REQ_DVSN_CD  
			                                                                                AND A.CVPT_ACP_NO(+) = E.CVPT_ACP_NO 
			                                                                                AND A.CMT_DVSN_CD = B.CMT_DVSN_CD 
			                                                                                AND A.CMT_OEN_YE = B.CMT_OEN_YE 
			                                                                                AND A.CMT_DGE = B.CMT_DGE
			                                                                                AND A.CMT_RSLT_CD != '09'
			                                                                       )  
			                                                                 END
			                                                        END,'9999-99-99') > TO_CHAR(TO_DATE(C.AUD_STR_DT),'YYYY-MM-DD')
			                                        GROUP BY C.REL_AUD_YR,	C.REL_AUD_NO, C.AUD_BZT_KND_CD ) G  
			         WHERE 1=1
			           AND A.REQ_DVSN_CD(+) = F.REQ_DVSN_CD 
			           AND A.ACP_YR(+)     = F.ACP_YR
			           AND A.CVPT_ACP_NO(+) = F.CVPT_ACP_NO
			           AND G.REL_AUD_YR(+) = C.AUD_YR
			           AND G.REL_AUD_NO(+) = C.AUD_NO
			           AND G.AUD_BZT_KND_CD(+) ='02'
			           AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
			           AND A.ACP_YR = B.ACP_YR
			           AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
			           AND A.REQ_DVSN_CD IN ('2','3')
			           AND C.TSK_KEY2 = A.REQ_DVSN_CD
			           AND C.TSK_KEY1 = A.ACP_YR
			           AND C.TSK_KEY3 = A.CVPT_ACP_NO
			           AND D.AUD_YR = C.AUD_YR
			           AND D.AUD_NO = C.AUD_NO
			           AND D.AUD_YR = E.AUD_YR(+)
			           AND D.AUD_NO = E.AUD_NO(+)
			           AND A.CVPT_HNDL_STA_CD != '170'
			           AND A.CVPT_WDW_DH IS NULL       
			           AND ((SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'
			                   AND E.FLD_AUD_STR_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD')
			                   AND (SELECT COUNT(DOC_ID) FROM TBBADDED103M WHERE AUD_YR = D.AUD_YR AND AUD_NO = D.AUD_NO AND RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050' 
			                            AND (RPRT_NM LIKE '%종료%' OR RPRT_CD IN ('A10500200', 'A10500210'))) = 0)
			                 OR B.AUD_RSLT_RPL_DT IS NULL    
			                   AND (B.REQ_EXAM_RSLT_CD = '01' OR B.EXAM_RPT_APV_DT IS NOT NULL)
			                   AND (CASE WHEN 
			                                (SELECT COUNT(*)
			                                  FROM TBBADDED030L D2,
			                                       TBBADDED001M D3, 
			                                       TBBADDED003M D4  
			                                 WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD 
			                                   AND D2.TSK_KEY1 = A.ACP_YR
			                                   AND D2.TSK_KEY3 = A.CVPT_ACP_NO
			                                   AND D3.AUD_YR = D2.AUD_YR
			                                   AND D3.AUD_NO = D2.AUD_NO
			                                   AND D3.AUD_YR = D4.AUD_YR
			                                   AND D3.AUD_NO = D4.AUD_NO
			                                   AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5'
			                               ) < 1  
			                            THEN CASE WHEN B.REQ_EXAM_RSLT_CD = '01'      
			                                           AND (SELECT COUNT(*) FROM TBCSPDCP603M                                         
			                                                    WHERE REQ_DVSN_CD = A.REQ_DVSN_CD AND ACP_YR = A.ACP_YR AND CVPT_ACP_NO = A.CVPT_ACP_NO 
			                                                        AND RPRT_CD IN ('C10220100','C10330100','A10300100') AND APV_STA_CD = '30') > 0
			                                      THEN 1 ELSE 0 END 
			                                      ELSE CASE WHEN (TO_CHAR(SYSDATE, 'YYYYMMDD') < (SELECT MAX(FLD_AUD_STR_DT)
			                                                                                          FROM TBBADDED030L D2, 
			                                                                                               TBBADDED001M D3,
			                                                                                               TBBADDED003M D4  
			                                                                                         WHERE D2.TSK_KEY2 = A.REQ_DVSN_CD 
			                                                                                           AND D2.TSK_KEY1 = A.ACP_YR
			                                                                                           AND D2.TSK_KEY3 = A.CVPT_ACP_NO
			                                                                                           AND D3.AUD_YR = D2.AUD_YR
			                                                                                           AND D3.AUD_NO = D2.AUD_NO
			                                                                                           AND D3.AUD_YR = D4.AUD_YR
			                                                                                           AND D3.AUD_NO = D4.AUD_NO
			                                                                                           AND SUBSTR(D3.AUD_KND_CD, '3', '1') <> '5'
			                                                                                    )OR (SELECT COUNT(*) FROM TBBADDED030L C, TBBADDED103M D
			                                                                                           WHERE C.TSK_KEY2 = A.REQ_DVSN_CD
			                                                                                           AND C.TSK_KEY1 = A.ACP_YR
			                                                                                           AND C.TSK_KEY3 = A.CVPT_ACP_NO
			                                                                                           AND D.AUD_YR = C.AUD_YR
			                                                                                           AND D.AUD_NO = C.AUD_NO
			                                                                                           AND D.AUD_STEP_CD = 'A1030' 
			                                                                                           AND D.RPRT_CD = 'A10300100'
			                                                                                           AND D.APV_STA_CD = '30') = 0
			                                                    )
			                                            THEN 1 ELSE 0 END
			                                      END = 1 
			                    )  
			                )                                           
			            )
			            
			    UNION ALL
			
			    SELECT '처리중' AS STA_DVSN, SUM(DECODE(HNDL_DPT_CD,#{reqDptCd1},1,0)) AS DPT1 
			          ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd2},1,0)) AS DPT2
			          ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd3},1,0)) AS DPT3
			          ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd4},1,0)) AS DPT4
			          ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd5},1,0)) AS DPT5
			          ,SUM(DECODE(HNDL_DPT_CD,#{reqDptCd1},1,#{reqDptCd2},1,#{reqDptCd3},1,#{reqDptCd4},1,#{reqDptCd5},1,0)) AS TOTAL_CNT
			          FROM (SELECT DISTINCT B.HNDL_DPT_CD,B.REQ_DVSN_CD,B.ACP_YR,B.CVPT_ACP_NO 
			                      FROM TBCSPDCP101M A,TBCSPEAR001M B, TBBADDED030L C, TBBADDED001M D, TBBADDED003M E, TBCSPDCP104L F         
			                           ,( SELECT sum(nvl(AUD_DCN,0)) AUD_DCN, C.REL_AUD_YR,	C.REL_AUD_NO, C.AUD_BZT_KND_CD
			                                     FROM TBBADDED001M A,TBBADDED101L B , TBBADDED002M C, TBBADDED030L D,TBCSPDCP101M E, TBCSPEAR001M F       
			                                          WHERE A.AUD_YR = B.AUD_YR(+)
			                                            AND A.AUD_NO = B.AUD_NO(+)
			                                            AND B.AUD_STEP_CD != 'A1030'
			                                            AND A.AUD_YR  = C.REL_AUD_YR
			                                            AND A.AUD_NO = C.REL_AUD_NO
			                                            AND A.AUD_YR = D.AUD_YR 
			                                            AND A.AUD_NO = D.AUD_NO  
			                                            AND D.TSK_KEY1 = E.ACP_YR(+)
			                                            AND D.TSK_KEY2 = E.REQ_DVSN_CD(+)
			                                            AND D.TSK_KEY3 = E.CVPT_ACP_NO(+)
			                                            AND E.ACP_YR = F.ACP_YR(+)
			                                            AND E.REQ_DVSN_CD = F.REQ_DVSN_CD(+)
			                                            AND E.CVPT_ACP_NO = F.CVPT_ACP_NO(+)
			                                            AND NVL(CASE WHEN F.AUD_RSLT_CD = '08' THEN TO_CHAR(E.CVPT_WDW_DH,'YYYY-MM-DD')        
			                                                            ELSE  
			                                                                CASE WHEN E.REQ_DVSN_CD = '3' 
			                                                                     THEN NVL(TO_CHAR(TO_DATE(F.EXAM_RPT_APV_DT),'YYYY-MM-DD'),( 
			                                                                        SELECT TO_CHAR(MAX(C1.APV_DH),'YYYY-MM-DD') 
			                                                                            FROM TBBADDED030L A1,TBBADDED103M B1, TBDCMACM023L C1
			                                                                             WHERE A1.TSK_KEY1(+)=E.ACP_YR 
			                                                                                AND A1.TSK_KEY2(+)=E.REQ_DVSN_CD 
			                                                                                AND A1.TSK_KEY3(+) =E.CVPT_ACP_NO
			                                                                                AND A1.AUD_YR=B1.AUD_YR 
			                                                                                AND A1.AUD_NO=B1.AUD_NO 
			                                                                                AND B1.APV_RQS_ID = C1.APV_DOC_NO 
			                                                                                AND B1.RPRT_CD = 'A10300100' 
			                                                                                AND B1.APV_STA_CD ='30' 
			                                                                        )
			                                                                     )    
			                                                        ELSE (SELECT TO_CHAR(TO_DATE(MAX(B.CMT_OEN_DT)),'YYYY-MM-DD') 
			                                                                FROM TBCSPEAR011M A , TBCSPEAR010M B 
			                                                                    WHERE A.ACP_YR(+) = E.ACP_YR 
			                                                                        AND A.REQ_DVSN_CD(+) = E.REQ_DVSN_CD  
			                                                                        AND A.CVPT_ACP_NO(+) = E.CVPT_ACP_NO 
			                                                                        AND A.CMT_DVSN_CD = B.CMT_DVSN_CD 
			                                                                        AND A.CMT_OEN_YE = B.CMT_OEN_YE 
			                                                                        AND A.CMT_DGE = B.CMT_DGE
			                                                                        AND A.CMT_RSLT_CD != '09'
			                                                                        )  
			                                                        END
			                                                    END,'9999-99-99') > TO_CHAR(TO_DATE(C.AUD_STR_DT),'YYYY-MM-DD')
			                                    GROUP BY C.REL_AUD_YR, C.REL_AUD_NO, C.AUD_BZT_KND_CD ) G  
			                            , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050') J2
			                            , (SELECT AUD_YR, AUD_NO, RPRT_CD, APV_RQS_ID, FNL_MDF_DH FROM TBBADDED103M WHERE RPRT_CD = 'A10600200' AND AUD_STEP_CD = 'A1060') J3
			                     WHERE 1=1
			                       AND A.REQ_DVSN_CD(+) = F.REQ_DVSN_CD 
			                       AND A.ACP_YR(+)     = F.ACP_YR
			                       AND A.CVPT_ACP_NO(+) = F.CVPT_ACP_NO
			                       AND G.REL_AUD_YR(+) = C.AUD_YR
			                       AND G.REL_AUD_NO(+) = C.AUD_NO
			                       AND G.AUD_BZT_KND_CD(+) ='02'
			                       AND A.REQ_DVSN_CD = B.REQ_DVSN_CD
			                       AND A.ACP_YR = B.ACP_YR
			                       AND A.CVPT_ACP_NO = B.CVPT_ACP_NO
			                       AND A.REQ_DVSN_CD IN ('2','3')
			                       AND C.TSK_KEY2 = A.REQ_DVSN_CD
			                       AND C.TSK_KEY1 = A.ACP_YR
			                       AND C.TSK_KEY3 = A.CVPT_ACP_NO
			                       AND D.AUD_YR = C.AUD_YR
			                       AND D.AUD_NO = C.AUD_NO
			                       AND D.AUD_YR = E.AUD_YR
			                       AND D.AUD_NO = E.AUD_NO
			                       AND E.AUD_YR = J2.AUD_YR(+)
			                       AND E.AUD_NO = J2.AUD_NO(+)
			                       AND E.AUD_YR = J3.AUD_YR(+)
			                       AND E.AUD_NO = J3.AUD_NO(+)
			                       AND A.CVPT_HNDL_STA_CD != '170'
			                       AND A.CVPT_WDW_DH IS NULL        
			                       AND SUBSTR(D.AUD_KND_CD, '3', '1') <> '5'     
			                       AND (
			                            (E.FLD_AUD_STR_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD')                         
			                               AND ((SELECT COUNT(*) FROM TBBADDED103M WHERE AUD_YR = D.AUD_YR AND AUD_NO = D.AUD_NO                
			                                   AND RPRT_CD = 'A10500200' AND AUD_STEP_CD = 'A1050' AND (RPRT_NM LIKE '%종료%' OR RPRT_CD IN ('A10500200', 'A10500210')) AND APV_STA_CD != '30'
			                                ) > 0)
			                            )OR
			                            ( B.AUD_RSLT_CD IS NULL        
			                               AND D.PRSS_STEP_CD = 'A1060'                                        
			                               AND ((SELECT MIN(APVR_PST_CD) FROM TBDCMACM023L WHERE APV_DOC_NO = J3.APV_RQS_ID AND APV_DH IS NULL) IN ('0013600','0015800','0055700','0045900','0055600') 
			                                    OR (
			                                        J3.APV_RQS_ID IS NULL                                                                                  
			                                        AND (SELECT COUNT(*) FROM TBDCMACM023L WHERE APV_DOC_NO = J2.APV_RQS_ID                                
			                                                    AND APVR_PST_CD IN ('0045900','0055600') AND APVR_STA_CD = '203') < 1 
			                                        AND D.PRSS_STEP_CD = 'A1060'  
			                                       )            
			                                   )
			                            )OR (B.AUD_RSLT_CD IS NULL AND D.PRSS_STEP_CD IN ('A1070','A1080')))
			    )
			)
			SELECT 1 AS DVSN_SORT
			      ,'이월' AS DVSN_NM
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd1},1,0)),0)) AS DPT1 
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd2},1,0)),0)) AS DPT2
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd3},1,0)),0)) AS DPT3
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd4},1,0)),0)) AS DPT4
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd5},1,0)),0)) AS DPT5
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd1},1,#{reqDptCd2},1,#{reqDptCd3},1,#{reqDptCd4},1,#{reqDptCd5},1,0)),0)) AS TOTAL_CNT
			  FROM TBCSPDCP101M A , 
			       TBCSPEAR001M B 
			 WHERE 1=1
			   AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)     
			   AND A.ACP_YR = B.ACP_YR(+)
			   AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			   AND A.REQ_DVSN_CD IN ('2','3')          
			   AND A.ACP_YR < TO_CHAR(SYSDATE, 'YYYY') 
			   AND (    A.CVPT_HNDL_STA_CD != '170'               
			        OR                                             
			            (B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')    
			             OR B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')   
			             OR TO_CHAR(A.CVPT_WDW_DH, 'YYYY') = TO_CHAR(SYSDATE, 'YYYY')
			            )
			        )
			        
			UNION ALL
			
			SELECT 2 AS DVSN_SORT
			      ,'신규접수' AS DVSN_NM
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd1},1,0)),0)) AS DPT1 
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd2},1,0)),0)) AS DPT2
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd3},1,0)),0)) AS DPT3
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd4},1,0)),0)) AS DPT4
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd5},1,0)),0)) AS DPT5
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd1},1,#{reqDptCd2},1,#{reqDptCd3},1,#{reqDptCd4},1,#{reqDptCd5},1,0)),0)) AS TOTAL_CNT
			  FROM TBCSPDCP101M A , 
			       TBCSPEAR001M B 
			 WHERE 1=1
			   AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)     
			   AND A.ACP_YR = B.ACP_YR(+)
			   AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			   AND A.REQ_DVSN_CD IN ('2','3')       
			   AND A.ACP_YR = TO_CHAR(SYSDATE, 'YYYY') 
			
			UNION ALL
			
			SELECT 3 AS DVSN_SORT
			      ,'접수 계' AS DVSN_NM
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd1},1,0)),0)) AS DPT1 
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd2},1,0)),0)) AS DPT2
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd3},1,0)),0)) AS DPT3
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd4},1,0)),0)) AS DPT4
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd5},1,0)),0)) AS DPT5
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd1},1,#{reqDptCd2},1,#{reqDptCd3},1,#{reqDptCd4},1,#{reqDptCd5},1,0)),0)) AS TOTAL_CNT
			  FROM TBCSPDCP101M A , 
			       TBCSPEAR001M B 
			 WHERE 1=1
			   AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)     
			   AND A.ACP_YR = B.ACP_YR(+)
			   AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			   AND A.REQ_DVSN_CD IN ('2','3')       
			   AND (A.ACP_YR = TO_CHAR(SYSDATE, 'YYYY')
			        OR ( A.ACP_YR < TO_CHAR(SYSDATE, 'YYYY') 
			               AND (    A.CVPT_HNDL_STA_CD != '170'               
			                    OR (B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')    
			                         OR B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101')   
			                         OR TO_CHAR(A.CVPT_WDW_DH, 'YYYY') = TO_CHAR(SYSDATE, 'YYYY'))
			                    )
			           )
			       )
			
			UNION ALL
			
			SELECT 4 AS DVSN_SORT
			      ,'처리완료' AS DVSN_NM
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd1},1,0)),0)) AS DPT1 
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd2},1,0)),0)) AS DPT2
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd3},1,0)),0)) AS DPT3
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd4},1,0)),0)) AS DPT4
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd5},1,0)),0)) AS DPT5
			      ,TO_CHAR(NVL(SUM(DECODE(B.HNDL_DPT_CD,#{reqDptCd1},1,#{reqDptCd2},1,#{reqDptCd3},1,#{reqDptCd4},1,#{reqDptCd5},1,0)),0)) AS TOTAL_CNT
			  FROM TBCSPDCP101M A , 
			       TBCSPEAR001M B 
			 WHERE 1=1
			   AND A.REQ_DVSN_CD = B.REQ_DVSN_CD(+)     
			   AND A.ACP_YR = B.ACP_YR(+)
			   AND A.CVPT_ACP_NO = B.CVPT_ACP_NO(+)
			   AND A.REQ_DVSN_CD IN ('2','3')      
			   AND (CASE WHEN B.AUD_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND AUD_RSLT_CD IS NOT NULL     
			            THEN 1 
			            ELSE CASE WHEN B.EXAM_RSLT_RPL_DT >= (TO_CHAR(SYSDATE, 'YYYY') || '0101') AND REQ_EXAM_RSLT_CD IS NOT NULL
			                        THEN 1 ELSE 0 END
			            END = 1
			        OR (A.CVPT_WDW_DH IS NOT NULL OR AUD_RSLT_CD = '08') 
			          AND TO_CHAR(A.CVPT_WDW_DH, 'YYYY') = TO_CHAR(SYSDATE, 'YYYY'))
			   AND A.CVPT_HNDL_STA_CD = '170'
			    
			UNION ALL
			--검토 중(접수~감사실시 검토보고):감사실시여부검토, 감사 중(감사실시 결정일~실지감사 완료):감사실시확정/실지감사, 처리 중(실지감사 종료보고~감사결과 시행·공개):종료보고~부의대기등
			SELECT 5 AS DVSN_SORT
			      ,'진행 중'||CHR(13)||CHR(10)||'(검토 중/감사 중/처리 중)' AS DVSN_NM
			      ,TO_CHAR(NVL(SUM(DPT1),0)) ||CHR(13)||CHR(10)
			      ||'('||(SELECT DPT1 FROM BASE WHERE STA_DVSN = '검토중')
			      ||'/'||(SELECT DPT1 FROM BASE WHERE STA_DVSN = '감사중')
			      ||'/'||(SELECT DPT1 FROM BASE WHERE STA_DVSN = '처리중')
			      ||')'AS DPT1
			      ,TO_CHAR(NVL(SUM(DPT2),0)) ||CHR(13)||CHR(10)
			      ||'('||(SELECT DPT2 FROM BASE WHERE STA_DVSN = '검토중')
			      ||'/'||(SELECT DPT2 FROM BASE WHERE STA_DVSN = '감사중')
			      ||'/'||(SELECT DPT2 FROM BASE WHERE STA_DVSN = '처리중')
			      ||')'AS DPT2
			      ,TO_CHAR(NVL(SUM(DPT3),0)) ||CHR(13)||CHR(10)
			      ||'('||(SELECT DPT3 FROM BASE WHERE STA_DVSN = '검토중')
			      ||'/'||(SELECT DPT3 FROM BASE WHERE STA_DVSN = '감사중')
			      ||'/'||(SELECT DPT3 FROM BASE WHERE STA_DVSN = '처리중')
			      ||')'AS DPT3
			      ,TO_CHAR(NVL(SUM(DPT4),0)) ||CHR(13)||CHR(10)
			      ||'('||(SELECT DPT4 FROM BASE WHERE STA_DVSN = '검토중')
			      ||'/'||(SELECT DPT4 FROM BASE WHERE STA_DVSN = '감사중')
			      ||'/'||(SELECT DPT4 FROM BASE WHERE STA_DVSN = '처리중')
			      ||')'AS DPT4
			      ,TO_CHAR(NVL(SUM(DPT5),0)) ||CHR(13)||CHR(10)
			      ||'('||(SELECT DPT5 FROM BASE WHERE STA_DVSN = '검토중')
			      ||'/'||(SELECT DPT5 FROM BASE WHERE STA_DVSN = '감사중')
			      ||'/'||(SELECT DPT5 FROM BASE WHERE STA_DVSN = '처리중')
			      ||')'AS DPT5
			      ,TO_CHAR(NVL(SUM(DPT1+DPT2+DPT3+DPT4+DPT5),0)) ||CHR(13)||CHR(10)
			      ||'('||(SELECT DPT1+DPT2+DPT3+DPT4+DPT5 FROM BASE WHERE STA_DVSN = '검토중')
			      ||'/'||(SELECT DPT1+DPT2+DPT3+DPT4+DPT5 FROM BASE WHERE STA_DVSN = '감사중')
			      ||'/'||(SELECT DPT1+DPT2+DPT3+DPT4+DPT5 FROM BASE WHERE STA_DVSN = '처리중')
			      ||')'AS TOTAL_CNT
			FROM BASE
			ORDER BY DVSN_SORT ASC
        ]]>
    </select>

</mapper>
